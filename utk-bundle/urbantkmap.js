import * as React$1 from 'react';
import React__default, { useRef, useEffect, useState, forwardRef, useContext } from 'react';
import require$$2 from 'react-dom';
import { jsx, jsxs, Fragment } from 'react/jsx-runtime';
import { Button, Row, Col, Form } from 'react-bootstrap';
import PropTypes from 'prop-types';

/**
 * Layer types definition
 */
var LayerType;
(function (LayerType) {
    LayerType["POINTS_LAYER"] = "POINTS_LAYER";
    LayerType["LINES_2D_LAYER"] = "LINES_2D_LAYER";
    LayerType["LINES_3D_LAYER"] = "LINES_3D_LAYER";
    LayerType["TRIANGLES_2D_LAYER"] = "TRIANGLES_2D_LAYER";
    LayerType["TRIANGLES_3D_LAYER"] = "TRIANGLES_3D_LAYER";
    LayerType["BUILDINGS_LAYER"] = "BUILDINGS_LAYER";
    LayerType["HEATMAP_LAYER"] = "HEATMAP_LAYER";
})(LayerType || (LayerType = {}));
/**
 * Render styles definition
 */
var RenderStyle;
(function (RenderStyle) {
    RenderStyle["FLAT_COLOR"] = "FLAT_COLOR";
    RenderStyle["FLAT_COLOR_MAP"] = "FLAT_COLOR_MAP";
    RenderStyle["FLAT_COLOR_POINTS"] = "FLAT_COLOR_POINTS";
    RenderStyle["SMOOTH_COLOR"] = "SMOOTH_COLOR";
    RenderStyle["SMOOTH_COLOR_MAP"] = "SMOOTH_COLOR_MAP";
    RenderStyle["SMOOTH_COLOR_MAP_TEX"] = "SMOOTH_COLOR_MAP_TEX";
    RenderStyle["PICKING"] = "PICKING";
    RenderStyle["ABSTRACT_SURFACES"] = "ABSTRACT_SURFACES";
    RenderStyle["OUTLINE"] = "OUTLINE";
    RenderStyle["COLOR_POINTS"] = "COLOR_POINTS";
})(RenderStyle || (RenderStyle = {}));
/**
 * Supported aggregations for layer linking
 */
var OperationType;
(function (OperationType) {
    OperationType["MAX"] = "MAX";
    OperationType["MIN"] = "MIN";
    OperationType["AVG"] = "AVG";
    OperationType["SUM"] = "SUM";
    OperationType["COUNT"] = "COUNT";
    OperationType["NONE"] = "NONE";
    OperationType["DISCARD"] = "DISCARD"; // keeps the first element of the join
})(OperationType || (OperationType = {}));
var ViewArrangementType;
(function (ViewArrangementType) {
    ViewArrangementType["LINKED"] = "LINKED";
    ViewArrangementType["EMBEDDED"] = "EMBEDDED";
})(ViewArrangementType || (ViewArrangementType = {}));
var PlotArrangementType;
(function (PlotArrangementType) {
    PlotArrangementType["LINKED"] = "LINKED";
    PlotArrangementType["SUR_EMBEDDED"] = "SUR_EMBEDDED";
    PlotArrangementType["FOOT_EMBEDDED"] = "FOOT_EMBEDDED";
})(PlotArrangementType || (PlotArrangementType = {}));
var SpatialRelationType;
(function (SpatialRelationType) {
    SpatialRelationType["INTERSECTS"] = "INTERSECTS";
    SpatialRelationType["CONTAINS"] = "CONTAINS";
    SpatialRelationType["WITHIN"] = "WITHIN";
    SpatialRelationType["TOUCHES"] = "TOUCHES";
    SpatialRelationType["CROSSES"] = "CROSSES";
    SpatialRelationType["OVERLAPS"] = "OVERLAPS";
    SpatialRelationType["NEAREST"] = "NEAREST";
    SpatialRelationType["DIRECT"] = "DIRECT";
    SpatialRelationType["INNERAGG"] = "INNERAGG"; // used when chaging geometry levels inside the same layer
})(SpatialRelationType || (SpatialRelationType = {}));
var LevelType;
(function (LevelType) {
    LevelType["COORDINATES"] = "COORDINATES";
    LevelType["OBJECTS"] = "OBJECTS";
    LevelType["COORDINATES3D"] = "COORDINATES3D";
})(LevelType || (LevelType = {}));
var InteractionType;
(function (InteractionType) {
    InteractionType["BRUSHING"] = "BRUSHING";
    InteractionType["PICKING"] = "PICKING";
    InteractionType["NONE"] = "NONE";
})(InteractionType || (InteractionType = {}));
var PlotInteractionType;
(function (PlotInteractionType) {
    PlotInteractionType["CLICK"] = "CLICK";
    PlotInteractionType["HOVER"] = "HOVER";
    PlotInteractionType["BRUSH"] = "BRUSH";
})(PlotInteractionType || (PlotInteractionType = {}));
var ComponentIdentifier;
(function (ComponentIdentifier) {
    ComponentIdentifier["MAP"] = "MAP";
    ComponentIdentifier["WIDGET"] = "WIDGET";
})(ComponentIdentifier || (ComponentIdentifier = {}));
var WidgetType;
(function (WidgetType) {
    WidgetType["TOGGLE_KNOT"] = "TOGGLE_KNOT";
    WidgetType["RESOLUTION"] = "RESOLUTION";
    WidgetType["GRAMMAR"] = "GRAMMAR";
    WidgetType["SEARCH"] = "SEARCH";
})(WidgetType || (WidgetType = {}));
/**
 * Mapview interaction status
 */
class MapViewStatu {
    static IDLE = 0;
    static DRAG = 1; // left click dragging
    static DRAG_RIGHT = 2;
}

/**
 * Half-Edge mesh component
 */
class MeshComponent {
    dimension;
    coordinates = [];
    normals = [];
    functions = []; // all attached abtract data must come from a knot. functions always contain values between [0,1]
    ids = [];
    heights = [];
    minHeights = [];
    orientedEnvelope = [];
    sectionFootprint = [];
    uv = [];
    width = [];
    heightInSection = []; // the height of the coordinate inside a specific section of the building
    sectionHeight = []; // the height of the section where the coordinate is
    pointsPerSection = [];
    discardFuncInterval = [-1, -1]; // indicates which coordinates of the mesh to discard in the redering process based on the function values
    varyOpByFunc; // if the opacity should vary according to the function value
    vertHe = [];
    vTable = [];
    oTable = [];
    constructor(dimension) {
        this.dimension = dimension;
    }
    nVertex() {
        return this.coordinates.length / this.dimension;
    }
    nHalfEdge() {
        return this.vTable.length;
    }
    nTriangle() {
        return this.vTable.length / 3;
    }
    trig(he) {
        return Math.floor(he / 3);
    }
    next(he) {
        return 3 * Math.floor(he / 3) + (he + 1) % 3;
    }
    prev(he) {
        return 3 * Math.floor(he / 3) + (he + 2) % 3;
    }
}
class Mesh {
    _dimension;
    _zOrder;
    _components;
    _allCoordinates;
    _allIds;
    _allIndices;
    _allNormals;
    _allFunctions;
    _filtered; // filtered by coordinate
    /**
     * Mesh default constructor
     * @param dimension number of dimensions of the input vertices
     */
    constructor(dimension = 2, zOrder = 0) {
        // number of dimensions
        this._dimension = dimension;
        // z order
        this._zOrder = zOrder;
        // erases the components
        this._components = [];
        this._allCoordinates = [];
        this._allIds = [];
        this._allIndices = [];
        this._allNormals = [];
        this._allFunctions = [];
        this._filtered = [];
    }
    /**
     * Get the dimension of the vertices
     */
    get dimension() {
        return this._dimension;
    }
    get filtered() {
        return this._filtered;
    }
    /**
     * Converts the local component id to the global mesh id
     * @param cId Component Id
     * @param vId Vertex component Id
     */
    vMeshId(cId, vId) {
        let total = 0;
        for (let cId = 0; cId < cId; cId++) {
            total += this._components[cId].nVertex();
        }
        return total + vId;
    }
    /**
     * Converts the global mesh id to the local component id
     * @param vId Vertex mesh Id
     */
    vCompId(vId) {
        let cId = 0;
        while (vId > this._components[cId].nVertex()) {
            vId -= this._components[cId].nVertex();
            cId++;
        }
        return [cId, vId];
    }
    /**
     * Converts the local component id to the global mesh id
     * @param cId Component Id
     * @param vId Vertex component Id
     */
    hMeshId(comp, heId) {
        return 0;
    }
    /**
     * Converts the global mesh id to the local component id
     * @param hId Vertex mesh Id
     */
    hCompId(hId) {
        return [0, 0];
    }
    tMeshId(comp, tId) {
        return 0;
    }
    tCompId(tId) {
        return [0, 0];
    }
    /**
     *
     * @param data Layer data
     * @param updateNormals Force normals computation
     */
    load(data, updateNormals = false, centroid = [0, 0, 0]) {
        // boolean
        let computeNormals = false;
        // load each feature
        for (const feature of data) {
            const geometry = feature.geometry;
            this.addComponent(geometry, centroid);
            // if a component doesnt have normals
            if (!('normals' in geometry)) {
                computeNormals = true;
            }
        }
        // builds the data structure
        this.buildOpposites();
        this.buildVertexHe();
        this.fixOrientation();
        // recomputes the normals
        if (!computeNormals && !updateNormals) {
            return;
        }
        this.computeNormals();
        this._filtered = Array(this.getTotalNumberOfCoords()).fill(1);
    }
    // this function override all timesteps
    setFunctionValues(functionValues, knotId, comp) {
        for (const funcVer of comp.functions) {
            if (funcVer.knot == knotId) {
                funcVer.timesteps = functionValues;
                return;
            }
        }
        comp.functions.push({ "knot": knotId, "timesteps": functionValues });
    }
    getFunctionValues(knotId, comp) {
        for (const funcVer of comp.functions) {
            if (funcVer.knot == knotId) {
                return funcVer.timesteps;
            }
        }
        return null;
    }
    loadFunctionData(functionValues = null, knotId) {
        let functionIndex = 0;
        // load each feature
        for (const comp of this._components) {
            let coordinates = comp.coordinates;
            let functionValuesCurrentGeometry = [];
            if (functionValues != null) {
                let coordsByThree = Math.trunc(coordinates.length / 3);
                for (let i = 0; i < coordsByThree; i++) {
                    functionValuesCurrentGeometry.push(functionValues[functionIndex]);
                    functionIndex += 1;
                }
                this.setFunctionValues([functionValuesCurrentGeometry], knotId, comp); // TODO: give support to different timesteps
            }
        }
    }
    /**
     * Adds a new component to the mesh.
     * @param geometry triangulation of the feature
     */
    // addComponent(geometry: IFeatureGeometry | IFeatureGeometry[], centroid : any) {
    addComponent(geometry, centroid) {
        // new component
        const comp = new MeshComponent(this._dimension);
        // check if an array was provided
        // const _geometry = (!Array.isArray(geometry)) ? [geometry] : geometry;
        const _geometry = [geometry];
        let nv = 0;
        // iterate over the geometry parts
        for (const part of _geometry) {
            part.coordinates.forEach((v, i) => {
                if (i % 3 == 0) {
                    comp.coordinates.push(v - centroid[0]);
                }
                else if (i % 3 == 1) {
                    comp.coordinates.push(v - centroid[1]);
                }
                else if (i % 3 === 2) {
                    // comp.coordinates.push(v + this._zOrder);
                    comp.coordinates.push(v);
                }
                // } else {
                // comp.coordinates.push(v)
                // }
            });
            if (part['varyOpByFunc'] !== undefined) {
                comp.varyOpByFunc = part.varyOpByFunc;
            }
            if (part['discardFuncInterval'] !== undefined) {
                comp.discardFuncInterval = part.discardFuncInterval;
            }
            if (part['normals'] !== undefined) {
                part.normals.forEach(v => comp.normals.push(v));
            }
            // if (part['function'] !== undefined) {
            //     part.function.forEach( v => comp.function.push(v) );
            // }else {
            //     comp.function.push([]);
            //     for(let vid = 0; vid < part.coordinates.length / this._dimension; vid++) {
            //         comp.function[0].push(this._components.length);
            //     }
            // }
            if (part['indices'] !== undefined) {
                part.indices.forEach(v => comp.vTable.push(v + nv));
            }
            if (part['ids'] !== undefined) {
                part.ids.forEach(v => comp.ids.push(v + nv)); // add the ids to the component turning them into in relation to the other parts of this geometry
            }
            if (part['heights'] !== undefined) {
                // part.heights.forEach( v => comp.heights.push(v + this._zOrder));
                part.heights.forEach(v => comp.heights.push(v));
            }
            if (part['minHeights'] !== undefined) {
                // part.minHeights.forEach( v => comp.minHeights.push(v + this._zOrder));
                part.minHeights.forEach(v => comp.minHeights.push(v));
            }
            if (part['uv'] !== undefined) {
                comp.uv = comp.uv.concat(part.uv);
            }
            if (part['width'] !== undefined) {
                comp.width = comp.width.concat(part.width);
            }
            if (part['pointsPerSection'] !== undefined) {
                comp.pointsPerSection = comp.pointsPerSection.concat(part.pointsPerSection);
            }
            if (part['orientedEnvelope'] !== undefined) {
                part.orientedEnvelope.forEach((envelope) => {
                    comp.orientedEnvelope.push([]);
                    envelope.forEach((v, i) => {
                        let index = comp.orientedEnvelope.length - 1;
                        if (i % 2 == 0) {
                            comp.orientedEnvelope[index].push(v - centroid[0]);
                        }
                        else if (i % 2 == 1) {
                            comp.orientedEnvelope[index].push(v - centroid[1]);
                        }
                    });
                });
            }
            if (part['sectionFootprint'] !== undefined) {
                part.sectionFootprint.forEach((footprint) => {
                    comp.sectionFootprint.push([]);
                    footprint.forEach((v, i) => {
                        let index = comp.sectionFootprint.length - 1;
                        if (i % 2 == 0) {
                            comp.sectionFootprint[index].push(v - centroid[0]);
                        }
                        else if (i % 2 == 1) {
                            comp.sectionFootprint[index].push(v - centroid[1]);
                        }
                    });
                });
            }
            nv += part.coordinates.length / this._dimension;
        }
        // activate to make the outline work
        // let readPoints = 0;
        // for(let i = 0; i < comp.pointsPerSection.length; i++){
        //     for(let j = 0; j < comp.pointsPerSection[i]; j++){
        //         comp.heightInSection.push(comp.coordinates[(j+readPoints)*3+2] - comp.minHeights[i]);
        //         comp.sectionHeight.push(comp.heights[i] - comp.minHeights[i]);
        //     }
        //     readPoints += comp.pointsPerSection[i];
        // }
        // saves the component
        this._components.push(comp);
    }
    buildOpposites() {
        for (const comp of this._components) {
            // number of half-edges
            const len = comp.nHalfEdge();
            // fills with invalid
            comp.oTable = new Array(len).fill(-1);
            // edges map
            const edges = new Map();
            // iterates over the base half-edges
            for (let he = 0; he < len; he++) {
                const nhe = comp.next(he);
                const e = [comp.vTable[he], comp.vTable[nhe]].sort().join();
                if (edges.has(e)) {
                    const op = edges.get(e);
                    comp.oTable[op] = he;
                    comp.oTable[he] = op;
                    edges.delete(e);
                }
                else {
                    edges.set(e, he);
                }
            }
        }
    }
    buildVertexHe() {
        for (const comps of this._components) {
            //  gets the number of vertices
            const len = comps.coordinates.length / this._dimension;
            // fills with invalid
            comps.vertHe = new Array(len).fill(-1);
            // computes the table
            comps.vTable.forEach((v, he) => {
                // current half-edge associated to vertex v
                const vhe = comps.vertHe[v];
                // updates if still invalid or not at the boundary
                if (vhe === -1 || comps.oTable[vhe] !== -1) {
                    comps.vertHe[v] = he;
                }
            });
        }
    }
    fixOrientation() {
        for (const comp of this._components) {
            const stack = [];
            const visited = new Array(comp.nTriangle()).fill(false);
            // adds the half-edges of the first triangle
            stack.push(0, 1, 2);
            while (stack.length) {
                const he = stack.pop();
                // boundary he
                const op = comp.oTable[he];
                if (op < 0) {
                    continue;
                }
                // already visited
                const trig = comp.trig(op);
                if (visited[trig]) {
                    continue;
                }
                // get the vertices of he
                const v1 = comp.vTable[he];
                const v2 = comp.vTable[comp.next(he)];
                // get the vertices of the opposite
                const v3 = comp.vTable[op];
                const v4 = comp.vTable[comp.next(op)];
                // orientation is not correct
                if (!(v1 === v4 && v2 === v3)) {
                    // gets the next and prev
                    const no = comp.next(op);
                    const po = comp.prev(op);
                    // vertices of next and pref
                    const vNo = comp.vTable[no];
                    const vOp = comp.vTable[op];
                    // changes the vTable
                    comp.vTable[no] = vOp;
                    comp.vTable[op] = vNo;
                    // opposites of next and prev
                    const oNo = comp.oTable[no];
                    const oPo = comp.oTable[po];
                    // changes the oTable
                    comp.oTable[no] = oPo;
                    comp.oTable[po] = oNo;
                    if (oPo >= 0) {
                        comp.oTable[oPo] = no;
                    }
                    if (oNo >= 0) {
                        comp.oTable[oNo] = po;
                    }
                }
                // mark as visited
                visited[trig] = true;
                // add the half-edges to the stack
                stack.push(op, comp.next(op), comp.prev(op));
            }
        }
    }
    computeNormals() {
        for (const comp of this._components) {
            //  gets the number of vertices
            const len = comp.coordinates.length;
            // gets the dimension
            const dim = comp.dimension;
            // fills with invalid
            comp.normals = new Array(len).fill(0);
            // iterate over the triangles
            for (let che = 0; che < comp.nHalfEdge(); che += 3) {
                // half-edges of the face
                const phe = comp.prev(che);
                const nhe = comp.next(che);
                // vertices of the face
                const vaId = dim * comp.vTable[che];
                const vbId = dim * comp.vTable[nhe];
                const vcId = dim * comp.vTable[phe];
                // coordinates of the vertices of the face
                const va = comp.coordinates.slice(vaId, 3);
                const vb = comp.coordinates.slice(vbId, 3);
                const vc = comp.coordinates.slice(vcId, 3);
                // face vectors
                const ab = [vb[0] - va[0], vb[1] - va[1], vb[2] - va[2]];
                const ac = [vc[0] - va[0], vc[1] - va[1], vc[2] - va[2]];
                // cross product
                const cross = [ab[1] * ac[2] - ab[2] * ac[1], ab[2] * ac[0] - ab[0] * ac[2], ab[0] * ac[1] - ab[1] * ac[0]];
                // accumulate
                for (let i = 0; i < 3; i++) {
                    comp.normals[vaId + i] += cross[i];
                    comp.normals[vbId + i] += cross[i];
                    comp.normals[vcId + i] += cross[i];
                }
            }
            // normalization
            for (let vid = 0; vid < comp.normals.length; vid += 3) {
                const nrm = comp.normals.slice(vid, 3);
                const size = Math.sqrt(nrm[0] * nrm[0] + nrm[1] * nrm[1] + nrm[2] * nrm[2]);
                // divide each coordinate
                for (let i = 0; i < 3; i++) {
                    comp.normals[vid + i] /= size;
                    comp.normals[vid + i] /= size;
                    comp.normals[vid + i] /= size;
                }
            }
        }
    }
    getCoordinatesVBO() {
        // const vbo: number[] = [];
        // for (const comp of this._components) {
        //     comp.coordinates.forEach( v => vbo.push(v) );
        // }
        if (this._allCoordinates.length == 0) {
            for (const comp of this._components) {
                comp.coordinates.forEach(v => this._allCoordinates.push(v));
            }
        }
        return this._allCoordinates;
        // return vbo;
    }
    getNormalsVBO() {
        // const vbo: number[] = [];
        // for (const comp of this._components) {
        //     comp.normals.forEach( v => vbo.push(v) );
        // }
        // return vbo;
        if (this._allNormals.length == 0) {
            for (const comp of this._components) {
                comp.normals.forEach(v => this._allNormals.push(v));
            }
        }
        return this._allNormals;
    }
    getFunctionVBO(knotId) {
        const vbo = [];
        if (this._components.length > 0) {
            let timesteps = this.getFunctionValues(knotId, this._components[0]);
            if (timesteps == null) {
                return vbo;
            }
            for (let i = 0; i < timesteps.length; i++) { // all components must have the same number of functions
                // let min =  Infinity;
                // let max = -Infinity;
                // for (const comp of this._components) {
                //     // max value
                //     max = comp.function[i].reduce(function(a, b) {
                //         return Math.max(a, b);
                //     }, max);
                //     // min value
                //     min = comp.function[i].reduce(function(a, b) {
                //         return Math.min(a, b);
                //     }, min);
                // };
                let currentFunctionVbo = [];
                for (const comp of this._components) {
                    // if((max - min) == 0){
                    //     comp.function[i].forEach( v => currentFunctionVbo.push( v ) );
                    // }else{
                    //     comp.function[i].forEach( v => currentFunctionVbo.push( (v - min) / (max - min) ) );
                    // }
                    let currentTimesteps = this.getFunctionValues(knotId, comp);
                    if (currentTimesteps == null) {
                        throw new Error("Knot id not found while trying to recover function values");
                    }
                    currentTimesteps[i].forEach(v => currentFunctionVbo.push(v));
                }
                vbo.push(currentFunctionVbo);
            }
        }
        return vbo;
    }
    getIndicesVBO() {
        // const vbo: number[] = [];
        // let nv = 0;
        // for (const comp of this._components) {
        //     comp.vTable.forEach( v => vbo.push(v + nv) );
        //     nv += comp.nVertex();
        // }
        // return vbo;
        let nv = 0;
        if (this._allIndices.length == 0) {
            for (const comp of this._components) {
                comp.vTable.forEach(v => this._allIndices.push(v + nv)); // turn ids into global in relation to all geometries
                nv += comp.nVertex();
            }
        }
        return this._allIndices;
    }
    getIdsVBO() {
        // const vbo: number[] = [];
        // let nv = 0;
        // for (const comp of this._components) {
        //     comp.ids.forEach( v => vbo.push(v + nv) ); // turn ids into global in relation to all geometries
        //     nv += comp.nVertex();
        // }
        // return vbo;
        let nv = 0;
        if (this._allIds.length == 0) {
            for (const comp of this._components) {
                comp.ids.forEach(v => this._allIds.push(v + nv)); // turn ids into global in relation to all geometries
                nv += comp.nVertex();
            }
        }
        return this._allIds;
    }
    getHeightsVBO() {
        let vbo = [];
        for (const comp of this._components) {
            vbo.push(comp.heights);
        }
        return vbo;
    }
    getMinHeightsVBO() {
        let vbo = [];
        for (const comp of this._components) {
            vbo.push(comp.minHeights);
        }
        return vbo;
    }
    getOrientedEnvelopesVBO() {
        let vbo = [];
        for (const comp of this._components) {
            vbo.push(comp.orientedEnvelope);
        }
        return vbo;
    }
    getSectionFootprintVBO() {
        let vbo = [];
        for (const comp of this._components) {
            vbo.push(comp.sectionFootprint);
        }
        return vbo;
    }
    getuvVBO() {
        let vbo = [];
        for (const comp of this._components) {
            vbo = vbo.concat(comp.uv);
        }
        return vbo;
    }
    getWidthVBO() {
        let vbo = [];
        for (const comp of this._components) {
            vbo = vbo.concat(comp.width);
        }
        return vbo;
    }
    getHeightInSectionVBO() {
        let vbo = [];
        for (const comp of this._components) {
            vbo = vbo.concat(comp.heightInSection);
        }
        return vbo;
    }
    getSectionHeightVBO() {
        let vbo = [];
        for (const comp of this._components) {
            vbo = vbo.concat(comp.sectionHeight);
        }
        return vbo;
    }
    getDiscardFuncIntervalVBO() {
        let vbo = [];
        for (const comp of this._components) {
            for (let i = 0; i < comp.coordinates.length / this._dimension; i++) {
                vbo.push(comp.discardFuncInterval[0]);
                vbo.push(comp.discardFuncInterval[1]);
            }
        }
        return vbo;
    }
    // getVaryOpByFuncVBO(){
    //     let vbo: number[] = [];
    //     for(const comp of this._components){
    //         for(let i = 0; i < comp.coordinates.length/this._dimension; i++){
    //             vbo.push(comp.varyOpByFunc);
    //         }
    //     }
    //     return vbo;
    // }
    /**
     * Returns the amount of cells in the mesh
     */
    idsLength() {
        let count = 0;
        for (const comp of this._components) {
            count += comp.ids.length;
        }
        return count;
    }
    /**
     * Returns the cells ids of all coordinates in the mesh. The cells ids are separated by component of the mesh. But in the context of each component each position stores the cell id of the corresponding coordinate as if the whole vector was flat.
     */
    getIdsCoordinates() {
        let coordsLength = this.getTotalNumberOfCoords();
        let ids = this.getIdsVBO();
        let indices = this.getIndicesVBO();
        let idsCoordinates = new Array(coordsLength);
        // get the cell id of each coordinate
        indices.forEach((elem, indexIndices) => {
            let triangleIndex = Math.floor(indexIndices / this.dimension);
            idsCoordinates[elem] = ids[triangleIndex];
        });
        let idsCoodinatesPerComponent = [];
        let indexOffset = 0;
        // separate the vector considering the components
        for (const comp of this._components) {
            idsCoodinatesPerComponent.push([]);
            for (let i = 0; i < comp.coordinates.length / comp.dimension; i++) {
                let shiftedIndex = i + indexOffset;
                idsCoodinatesPerComponent[idsCoodinatesPerComponent.length - 1].push(idsCoordinates[shiftedIndex]);
            }
            indexOffset += comp.coordinates.length / comp.dimension;
        }
        return idsCoodinatesPerComponent;
    }
    /**
     * Returns the number of coordinates per component of the mesh
     */
    getCoordsPerComp() {
        let coordsPerComp = [];
        // separate the vector considering the components
        for (const comp of this._components) {
            coordsPerComp.push(comp.coordinates.length / this._dimension);
        }
        return coordsPerComp;
    }
    /**
     * Returns the number of ids per component of the mesh
     */
    getNumIdsPerComp() {
        let idsPerComp = [];
        for (const comp of this._components) {
            idsPerComp.push(comp.ids.length);
        }
        return idsPerComp;
    }
    /**
     *
     * @returns total number of coordinates considering all components
     */
    getTotalNumberOfCoords() {
        let numberOfCoords = 0;
        for (const comp of this._components) {
            numberOfCoords += comp.nVertex();
        }
        return numberOfCoords;
    }
    setFiltered(bbox) {
        // let include = [91,109,42,108,168,2,125,137,78,80,90,152,92,94,74,77,123,151,95,21,124,41,1,81,11,73,82,75,172,126,93,12,3,79,119];
        if (bbox.length != 0) {
            this._filtered = Array(this.getTotalNumberOfCoords()).fill(0);
            let readCoords = 0;
            for (let i = 0; i < this._components.length; i++) {
                let comp = this._components[i];
                let inside = false;
                for (let j = 0; j < comp.coordinates.length / comp.dimension; j++) {
                    let x = comp.coordinates[j * comp.dimension];
                    let y = comp.coordinates[j * comp.dimension + 1];
                    // check if coordinate is inside bbox
                    if (x >= bbox[0] && x <= bbox[2] && y >= bbox[1] && y <= bbox[3]) {
                        inside = true;
                        break;
                    }
                }
                if (inside) {
                    for (let j = 0; j < comp.coordinates.length / comp.dimension; j++) {
                        this._filtered[readCoords + j] = 1;
                    }
                }
                // if(include.includes(i)){
                //     for(let j = 0; j < comp.coordinates.length/comp.dimension; j++){
                //         this._filtered[readCoords+j] = 1;
                //     }
                // }
                readCoords += comp.coordinates.length / comp.dimension;
            }
        }
        else {
            this._filtered = Array(this.getTotalNumberOfCoords()).fill(1);
        }
    }
    // get ids of all attached knots
    getAttachedKnots() {
        let knots = [];
        for (const functionValues of this._components[0].functions) {
            knots.push(functionValues.knot);
        }
        return knots;
    }
}

/// <reference types="@types/webgl2" />
class Layer {
    // layer id
    _id;
    // layer type
    _type;
    // style key used to color the layer
    _styleKey;
    // render styles available
    _renderStyle;
    // store link information with other layers
    _joinedLayers;
    _joinedObjects;
    // layer's camera
    _camera;
    _centroid;
    _mesh;
    constructor(id, type, styleKey, renderStyle = [], centroid = [0, 0, 0], dimension, zOrder) {
        this._id = id;
        this._type = type;
        this._styleKey = styleKey;
        // this._colorMap = colorMap;
        this._renderStyle = renderStyle;
        this._centroid = centroid;
        this._mesh = new Mesh(dimension, zOrder);
    }
    setJoinedJson(joinedJson) {
        this._joinedLayers = joinedJson.joinedLayers;
        this._joinedObjects = joinedJson.joinedObjects;
    }
    /**
     * Accessor for the layer id
     */
    get id() {
        return this._id;
    }
    /**
     * Accessor for the layer style
     */
    get style() {
        return this._styleKey;
    }
    get joinedLayers() {
        return this._joinedLayers;
    }
    get joinedObjects() {
        return this._joinedObjects;
    }
    /**
     * Sends the camera to the layer
     */
    set camera(camera) {
        this._camera = camera;
    }
    get mesh() {
        return this._mesh;
    }
    set mesh(mesh) {
        this._mesh = mesh;
    }
    get centroid() {
        return this._centroid;
    }
    get renderStyle() {
        return this._renderStyle;
    }
}

class Shader {
    // layer's shader
    _shaderProgram;
    _currentKnot; // current knot supplying abstract data for this layer
    /**
     * Default constructor
     * @param vsSource
     * @param fsSource
     * @param glContext
     */
    constructor(vsSource, fsSource, glContext) {
        this.initShaderProgram(vsSource, fsSource, glContext);
    }
    get currentKnot() {
        return this._currentKnot;
    }
    /**
    * Inits the layer's shader program
    * @param {string} vsSource Vertex shader source
    * @param {string} fsSource Fragment shader source
    * @param {WebGL2RenderingContext} glContext WebGL context
    */
    initShaderProgram(vsSource, fsSource, glContext) {
        // load the shaders
        const vertexShader = this.buildShader(glContext.VERTEX_SHADER, vsSource, glContext);
        const fragmentShader = this.buildShader(glContext.FRAGMENT_SHADER, fsSource, glContext);
        // Create the shader program
        const shader = glContext.createProgram();
        // There was a problem loading the shaders
        if (!shader || !vertexShader || !fragmentShader) {
            return;
        }
        glContext.attachShader(shader, vertexShader);
        glContext.attachShader(shader, fragmentShader);
        glContext.linkProgram(shader);
        // If creating the shader program failed, alert
        if (!glContext.getProgramParameter(shader, glContext.LINK_STATUS)) {
            throw new Error('Unable to initialize the shader program: ' + glContext.getProgramInfoLog(shader));
        }
        // stores the shader
        this._shaderProgram = shader;
    }
    /**
     * Builds the layer shader
     * @param {number} type The shader type
     * @param {string} source The shader source string
     * @param {WebGL2RenderingContext} glContext The WebGL context
     * @returns {WebGLShader} The shader object
     */
    buildShader(type, source, glContext) {
        // creates the shader
        const shader = glContext.createShader(type);
        if (!shader) {
            return null;
        }
        // Send the source to the shader object
        glContext.shaderSource(shader, source);
        // Compile the shader program
        glContext.compileShader(shader);
        // See if it compiled successfully
        if (!glContext.getShaderParameter(shader, glContext.COMPILE_STATUS)) {
            console.error('An error occurred compiling the shaders: ');
            console.error(source);
            console.error(glContext.getShaderInfoLog(shader));
            glContext.deleteShader(shader);
            throw new Error('Unable to load the shader');
        }
        return shader;
    }
}

/**
 * Abstract class for the picking auxiliary shaders
 */
class AuxiliaryShader extends Shader {
}

function colors(specifier) {
  var n = specifier.length / 6 | 0, colors = new Array(n), i = 0;
  while (i < n) colors[i] = "#" + specifier.slice(i * 6, ++i * 6);
  return colors;
}

var category10 = colors("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");

var Accent = colors("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666");

var Dark2 = colors("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666");

var Paired = colors("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");

var Pastel1 = colors("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2");

var Pastel2 = colors("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc");

var Set1 = colors("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999");

var Set2 = colors("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3");

var Set3 = colors("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");

var Tableau10 = colors("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");

function define(constructor, factory, prototype) {
  constructor.prototype = factory.prototype = prototype;
  prototype.constructor = constructor;
}

function extend(parent, definition) {
  var prototype = Object.create(parent.prototype);
  for (var key in definition) prototype[key] = definition[key];
  return prototype;
}

function Color() {}

var darker = 0.7;
var brighter = 1 / darker;

var reI = "\\s*([+-]?\\d+)\\s*",
    reN = "\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",
    reP = "\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",
    reHex = /^#([0-9a-f]{3,8})$/,
    reRgbInteger = new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),
    reRgbPercent = new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),
    reRgbaInteger = new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),
    reRgbaPercent = new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),
    reHslPercent = new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),
    reHslaPercent = new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`);

var named = {
  aliceblue: 0xf0f8ff,
  antiquewhite: 0xfaebd7,
  aqua: 0x00ffff,
  aquamarine: 0x7fffd4,
  azure: 0xf0ffff,
  beige: 0xf5f5dc,
  bisque: 0xffe4c4,
  black: 0x000000,
  blanchedalmond: 0xffebcd,
  blue: 0x0000ff,
  blueviolet: 0x8a2be2,
  brown: 0xa52a2a,
  burlywood: 0xdeb887,
  cadetblue: 0x5f9ea0,
  chartreuse: 0x7fff00,
  chocolate: 0xd2691e,
  coral: 0xff7f50,
  cornflowerblue: 0x6495ed,
  cornsilk: 0xfff8dc,
  crimson: 0xdc143c,
  cyan: 0x00ffff,
  darkblue: 0x00008b,
  darkcyan: 0x008b8b,
  darkgoldenrod: 0xb8860b,
  darkgray: 0xa9a9a9,
  darkgreen: 0x006400,
  darkgrey: 0xa9a9a9,
  darkkhaki: 0xbdb76b,
  darkmagenta: 0x8b008b,
  darkolivegreen: 0x556b2f,
  darkorange: 0xff8c00,
  darkorchid: 0x9932cc,
  darkred: 0x8b0000,
  darksalmon: 0xe9967a,
  darkseagreen: 0x8fbc8f,
  darkslateblue: 0x483d8b,
  darkslategray: 0x2f4f4f,
  darkslategrey: 0x2f4f4f,
  darkturquoise: 0x00ced1,
  darkviolet: 0x9400d3,
  deeppink: 0xff1493,
  deepskyblue: 0x00bfff,
  dimgray: 0x696969,
  dimgrey: 0x696969,
  dodgerblue: 0x1e90ff,
  firebrick: 0xb22222,
  floralwhite: 0xfffaf0,
  forestgreen: 0x228b22,
  fuchsia: 0xff00ff,
  gainsboro: 0xdcdcdc,
  ghostwhite: 0xf8f8ff,
  gold: 0xffd700,
  goldenrod: 0xdaa520,
  gray: 0x808080,
  green: 0x008000,
  greenyellow: 0xadff2f,
  grey: 0x808080,
  honeydew: 0xf0fff0,
  hotpink: 0xff69b4,
  indianred: 0xcd5c5c,
  indigo: 0x4b0082,
  ivory: 0xfffff0,
  khaki: 0xf0e68c,
  lavender: 0xe6e6fa,
  lavenderblush: 0xfff0f5,
  lawngreen: 0x7cfc00,
  lemonchiffon: 0xfffacd,
  lightblue: 0xadd8e6,
  lightcoral: 0xf08080,
  lightcyan: 0xe0ffff,
  lightgoldenrodyellow: 0xfafad2,
  lightgray: 0xd3d3d3,
  lightgreen: 0x90ee90,
  lightgrey: 0xd3d3d3,
  lightpink: 0xffb6c1,
  lightsalmon: 0xffa07a,
  lightseagreen: 0x20b2aa,
  lightskyblue: 0x87cefa,
  lightslategray: 0x778899,
  lightslategrey: 0x778899,
  lightsteelblue: 0xb0c4de,
  lightyellow: 0xffffe0,
  lime: 0x00ff00,
  limegreen: 0x32cd32,
  linen: 0xfaf0e6,
  magenta: 0xff00ff,
  maroon: 0x800000,
  mediumaquamarine: 0x66cdaa,
  mediumblue: 0x0000cd,
  mediumorchid: 0xba55d3,
  mediumpurple: 0x9370db,
  mediumseagreen: 0x3cb371,
  mediumslateblue: 0x7b68ee,
  mediumspringgreen: 0x00fa9a,
  mediumturquoise: 0x48d1cc,
  mediumvioletred: 0xc71585,
  midnightblue: 0x191970,
  mintcream: 0xf5fffa,
  mistyrose: 0xffe4e1,
  moccasin: 0xffe4b5,
  navajowhite: 0xffdead,
  navy: 0x000080,
  oldlace: 0xfdf5e6,
  olive: 0x808000,
  olivedrab: 0x6b8e23,
  orange: 0xffa500,
  orangered: 0xff4500,
  orchid: 0xda70d6,
  palegoldenrod: 0xeee8aa,
  palegreen: 0x98fb98,
  paleturquoise: 0xafeeee,
  palevioletred: 0xdb7093,
  papayawhip: 0xffefd5,
  peachpuff: 0xffdab9,
  peru: 0xcd853f,
  pink: 0xffc0cb,
  plum: 0xdda0dd,
  powderblue: 0xb0e0e6,
  purple: 0x800080,
  rebeccapurple: 0x663399,
  red: 0xff0000,
  rosybrown: 0xbc8f8f,
  royalblue: 0x4169e1,
  saddlebrown: 0x8b4513,
  salmon: 0xfa8072,
  sandybrown: 0xf4a460,
  seagreen: 0x2e8b57,
  seashell: 0xfff5ee,
  sienna: 0xa0522d,
  silver: 0xc0c0c0,
  skyblue: 0x87ceeb,
  slateblue: 0x6a5acd,
  slategray: 0x708090,
  slategrey: 0x708090,
  snow: 0xfffafa,
  springgreen: 0x00ff7f,
  steelblue: 0x4682b4,
  tan: 0xd2b48c,
  teal: 0x008080,
  thistle: 0xd8bfd8,
  tomato: 0xff6347,
  turquoise: 0x40e0d0,
  violet: 0xee82ee,
  wheat: 0xf5deb3,
  white: 0xffffff,
  whitesmoke: 0xf5f5f5,
  yellow: 0xffff00,
  yellowgreen: 0x9acd32
};

define(Color, color$1, {
  copy(channels) {
    return Object.assign(new this.constructor, this, channels);
  },
  displayable() {
    return this.rgb().displayable();
  },
  hex: color_formatHex, // Deprecated! Use color.formatHex.
  formatHex: color_formatHex,
  formatHex8: color_formatHex8,
  formatHsl: color_formatHsl,
  formatRgb: color_formatRgb,
  toString: color_formatRgb
});

function color_formatHex() {
  return this.rgb().formatHex();
}

function color_formatHex8() {
  return this.rgb().formatHex8();
}

function color_formatHsl() {
  return hslConvert(this).formatHsl();
}

function color_formatRgb() {
  return this.rgb().formatRgb();
}

function color$1(format) {
  var m, l;
  format = (format + "").trim().toLowerCase();
  return (m = reHex.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn(m) // #ff0000
      : l === 3 ? new Rgb((m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), ((m & 0xf) << 4) | (m & 0xf), 1) // #f00
      : l === 8 ? rgba(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000
      : l === 4 ? rgba((m >> 12 & 0xf) | (m >> 8 & 0xf0), (m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), (((m & 0xf) << 4) | (m & 0xf)) / 0xff) // #f000
      : null) // invalid hex
      : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) // rgb(255, 0, 0)
      : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)
      : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)
      : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)
      : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)
      : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)
      : named.hasOwnProperty(format) ? rgbn(named[format]) // eslint-disable-line no-prototype-builtins
      : format === "transparent" ? new Rgb(NaN, NaN, NaN, 0)
      : null;
}

function rgbn(n) {
  return new Rgb(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);
}

function rgba(r, g, b, a) {
  if (a <= 0) r = g = b = NaN;
  return new Rgb(r, g, b, a);
}

function rgbConvert(o) {
  if (!(o instanceof Color)) o = color$1(o);
  if (!o) return new Rgb;
  o = o.rgb();
  return new Rgb(o.r, o.g, o.b, o.opacity);
}

function rgb(r, g, b, opacity) {
  return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b, opacity == null ? 1 : opacity);
}

function Rgb(r, g, b, opacity) {
  this.r = +r;
  this.g = +g;
  this.b = +b;
  this.opacity = +opacity;
}

define(Rgb, rgb, extend(Color, {
  brighter(k) {
    k = k == null ? brighter : Math.pow(brighter, k);
    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);
  },
  darker(k) {
    k = k == null ? darker : Math.pow(darker, k);
    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);
  },
  rgb() {
    return this;
  },
  clamp() {
    return new Rgb(clampi(this.r), clampi(this.g), clampi(this.b), clampa(this.opacity));
  },
  displayable() {
    return (-0.5 <= this.r && this.r < 255.5)
        && (-0.5 <= this.g && this.g < 255.5)
        && (-0.5 <= this.b && this.b < 255.5)
        && (0 <= this.opacity && this.opacity <= 1);
  },
  hex: rgb_formatHex, // Deprecated! Use color.formatHex.
  formatHex: rgb_formatHex,
  formatHex8: rgb_formatHex8,
  formatRgb: rgb_formatRgb,
  toString: rgb_formatRgb
}));

function rgb_formatHex() {
  return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}`;
}

function rgb_formatHex8() {
  return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity) ? 1 : this.opacity) * 255)}`;
}

function rgb_formatRgb() {
  const a = clampa(this.opacity);
  return `${a === 1 ? "rgb(" : "rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${a === 1 ? ")" : `, ${a})`}`;
}

function clampa(opacity) {
  return isNaN(opacity) ? 1 : Math.max(0, Math.min(1, opacity));
}

function clampi(value) {
  return Math.max(0, Math.min(255, Math.round(value) || 0));
}

function hex(value) {
  value = clampi(value);
  return (value < 16 ? "0" : "") + value.toString(16);
}

function hsla(h, s, l, a) {
  if (a <= 0) h = s = l = NaN;
  else if (l <= 0 || l >= 1) h = s = NaN;
  else if (s <= 0) h = NaN;
  return new Hsl(h, s, l, a);
}

function hslConvert(o) {
  if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);
  if (!(o instanceof Color)) o = color$1(o);
  if (!o) return new Hsl;
  if (o instanceof Hsl) return o;
  o = o.rgb();
  var r = o.r / 255,
      g = o.g / 255,
      b = o.b / 255,
      min = Math.min(r, g, b),
      max = Math.max(r, g, b),
      h = NaN,
      s = max - min,
      l = (max + min) / 2;
  if (s) {
    if (r === max) h = (g - b) / s + (g < b) * 6;
    else if (g === max) h = (b - r) / s + 2;
    else h = (r - g) / s + 4;
    s /= l < 0.5 ? max + min : 2 - max - min;
    h *= 60;
  } else {
    s = l > 0 && l < 1 ? 0 : h;
  }
  return new Hsl(h, s, l, o.opacity);
}

function hsl(h, s, l, opacity) {
  return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity == null ? 1 : opacity);
}

function Hsl(h, s, l, opacity) {
  this.h = +h;
  this.s = +s;
  this.l = +l;
  this.opacity = +opacity;
}

define(Hsl, hsl, extend(Color, {
  brighter(k) {
    k = k == null ? brighter : Math.pow(brighter, k);
    return new Hsl(this.h, this.s, this.l * k, this.opacity);
  },
  darker(k) {
    k = k == null ? darker : Math.pow(darker, k);
    return new Hsl(this.h, this.s, this.l * k, this.opacity);
  },
  rgb() {
    var h = this.h % 360 + (this.h < 0) * 360,
        s = isNaN(h) || isNaN(this.s) ? 0 : this.s,
        l = this.l,
        m2 = l + (l < 0.5 ? l : 1 - l) * s,
        m1 = 2 * l - m2;
    return new Rgb(
      hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2),
      hsl2rgb(h, m1, m2),
      hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2),
      this.opacity
    );
  },
  clamp() {
    return new Hsl(clamph(this.h), clampt(this.s), clampt(this.l), clampa(this.opacity));
  },
  displayable() {
    return (0 <= this.s && this.s <= 1 || isNaN(this.s))
        && (0 <= this.l && this.l <= 1)
        && (0 <= this.opacity && this.opacity <= 1);
  },
  formatHsl() {
    const a = clampa(this.opacity);
    return `${a === 1 ? "hsl(" : "hsla("}${clamph(this.h)}, ${clampt(this.s) * 100}%, ${clampt(this.l) * 100}%${a === 1 ? ")" : `, ${a})`}`;
  }
}));

function clamph(value) {
  value = (value || 0) % 360;
  return value < 0 ? value + 360 : value;
}

function clampt(value) {
  return Math.max(0, Math.min(1, value || 0));
}

/* From FvD 13.37, CSS Color Module Level 3 */
function hsl2rgb(h, m1, m2) {
  return (h < 60 ? m1 + (m2 - m1) * h / 60
      : h < 180 ? m2
      : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60
      : m1) * 255;
}

const radians$1 = Math.PI / 180;
const degrees$1 = 180 / Math.PI;

var A$1 = -0.14861,
    B$1 = +1.78277,
    C$1 = -0.29227,
    D$1 = -0.90649,
    E$1 = +1.97294,
    ED$1 = E$1 * D$1,
    EB$1 = E$1 * B$1,
    BC_DA = B$1 * C$1 - D$1 * A$1;

function cubehelixConvert(o) {
  if (o instanceof Cubehelix) return new Cubehelix(o.h, o.s, o.l, o.opacity);
  if (!(o instanceof Rgb)) o = rgbConvert(o);
  var r = o.r / 255,
      g = o.g / 255,
      b = o.b / 255,
      l = (BC_DA * b + ED$1 * r - EB$1 * g) / (BC_DA + ED$1 - EB$1),
      bl = b - l,
      k = (E$1 * (g - l) - C$1 * bl) / D$1,
      s = Math.sqrt(k * k + bl * bl) / (E$1 * l * (1 - l)), // NaN if l=0 or l=1
      h = s ? Math.atan2(k, bl) * degrees$1 - 120 : NaN;
  return new Cubehelix(h < 0 ? h + 360 : h, s, l, o.opacity);
}

function cubehelix$2(h, s, l, opacity) {
  return arguments.length === 1 ? cubehelixConvert(h) : new Cubehelix(h, s, l, opacity == null ? 1 : opacity);
}

function Cubehelix(h, s, l, opacity) {
  this.h = +h;
  this.s = +s;
  this.l = +l;
  this.opacity = +opacity;
}

define(Cubehelix, cubehelix$2, extend(Color, {
  brighter(k) {
    k = k == null ? brighter : Math.pow(brighter, k);
    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);
  },
  darker(k) {
    k = k == null ? darker : Math.pow(darker, k);
    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);
  },
  rgb() {
    var h = isNaN(this.h) ? 0 : (this.h + 120) * radians$1,
        l = +this.l,
        a = isNaN(this.s) ? 0 : this.s * l * (1 - l),
        cosh = Math.cos(h),
        sinh = Math.sin(h);
    return new Rgb(
      255 * (l + a * (A$1 * cosh + B$1 * sinh)),
      255 * (l + a * (C$1 * cosh + D$1 * sinh)),
      255 * (l + a * (E$1 * cosh)),
      this.opacity
    );
  }
}));

function basis(t1, v0, v1, v2, v3) {
  var t2 = t1 * t1, t3 = t2 * t1;
  return ((1 - 3 * t1 + 3 * t2 - t3) * v0
      + (4 - 6 * t2 + 3 * t3) * v1
      + (1 + 3 * t1 + 3 * t2 - 3 * t3) * v2
      + t3 * v3) / 6;
}

function basis$1(values) {
  var n = values.length - 1;
  return function(t) {
    var i = t <= 0 ? (t = 0) : t >= 1 ? (t = 1, n - 1) : Math.floor(t * n),
        v1 = values[i],
        v2 = values[i + 1],
        v0 = i > 0 ? values[i - 1] : 2 * v1 - v2,
        v3 = i < n - 1 ? values[i + 2] : 2 * v2 - v1;
    return basis((t - i / n) * n, v0, v1, v2, v3);
  };
}

var constant$1 = x => () => x;

function linear(a, d) {
  return function(t) {
    return a + t * d;
  };
}

function exponential(a, b, y) {
  return a = Math.pow(a, y), b = Math.pow(b, y) - a, y = 1 / y, function(t) {
    return Math.pow(a + t * b, y);
  };
}

function hue(a, b) {
  var d = b - a;
  return d ? linear(a, d > 180 || d < -180 ? d - 360 * Math.round(d / 360) : d) : constant$1(isNaN(a) ? b : a);
}

function gamma(y) {
  return (y = +y) === 1 ? nogamma : function(a, b) {
    return b - a ? exponential(a, b, y) : constant$1(isNaN(a) ? b : a);
  };
}

function nogamma(a, b) {
  var d = b - a;
  return d ? linear(a, d) : constant$1(isNaN(a) ? b : a);
}

var interpolateRgb = (function rgbGamma(y) {
  var color = gamma(y);

  function rgb$1(start, end) {
    var r = color((start = rgb(start)).r, (end = rgb(end)).r),
        g = color(start.g, end.g),
        b = color(start.b, end.b),
        opacity = nogamma(start.opacity, end.opacity);
    return function(t) {
      start.r = r(t);
      start.g = g(t);
      start.b = b(t);
      start.opacity = opacity(t);
      return start + "";
    };
  }

  rgb$1.gamma = rgbGamma;

  return rgb$1;
})(1);

function rgbSpline(spline) {
  return function(colors) {
    var n = colors.length,
        r = new Array(n),
        g = new Array(n),
        b = new Array(n),
        i, color;
    for (i = 0; i < n; ++i) {
      color = rgb(colors[i]);
      r[i] = color.r || 0;
      g[i] = color.g || 0;
      b[i] = color.b || 0;
    }
    r = spline(r);
    g = spline(g);
    b = spline(b);
    color.opacity = 1;
    return function(t) {
      color.r = r(t);
      color.g = g(t);
      color.b = b(t);
      return color + "";
    };
  };
}

var rgbBasis = rgbSpline(basis$1);

function interpolateNumber(a, b) {
  return a = +a, b = +b, function(t) {
    return a * (1 - t) + b * t;
  };
}

var reA = /[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,
    reB = new RegExp(reA.source, "g");

function zero(b) {
  return function() {
    return b;
  };
}

function one(b) {
  return function(t) {
    return b(t) + "";
  };
}

function interpolateString(a, b) {
  var bi = reA.lastIndex = reB.lastIndex = 0, // scan index for next number in b
      am, // current match in a
      bm, // current match in b
      bs, // string preceding current number in b, if any
      i = -1, // index in s
      s = [], // string constants and placeholders
      q = []; // number interpolators

  // Coerce inputs to strings.
  a = a + "", b = b + "";

  // Interpolate pairs of numbers in a & b.
  while ((am = reA.exec(a))
      && (bm = reB.exec(b))) {
    if ((bs = bm.index) > bi) { // a string precedes the next number in b
      bs = b.slice(bi, bs);
      if (s[i]) s[i] += bs; // coalesce with previous string
      else s[++i] = bs;
    }
    if ((am = am[0]) === (bm = bm[0])) { // numbers in a & b match
      if (s[i]) s[i] += bm; // coalesce with previous string
      else s[++i] = bm;
    } else { // interpolate non-matching numbers
      s[++i] = null;
      q.push({i: i, x: interpolateNumber(am, bm)});
    }
    bi = reB.lastIndex;
  }

  // Add remains of b.
  if (bi < b.length) {
    bs = b.slice(bi);
    if (s[i]) s[i] += bs; // coalesce with previous string
    else s[++i] = bs;
  }

  // Special optimization for only a single match.
  // Otherwise, interpolate each of the numbers and rejoin the string.
  return s.length < 2 ? (q[0]
      ? one(q[0].x)
      : zero(b))
      : (b = q.length, function(t) {
          for (var i = 0, o; i < b; ++i) s[(o = q[i]).i] = o.x(t);
          return s.join("");
        });
}

var degrees = 180 / Math.PI;

var identity$1 = {
  translateX: 0,
  translateY: 0,
  rotate: 0,
  skewX: 0,
  scaleX: 1,
  scaleY: 1
};

function decompose(a, b, c, d, e, f) {
  var scaleX, scaleY, skewX;
  if (scaleX = Math.sqrt(a * a + b * b)) a /= scaleX, b /= scaleX;
  if (skewX = a * c + b * d) c -= a * skewX, d -= b * skewX;
  if (scaleY = Math.sqrt(c * c + d * d)) c /= scaleY, d /= scaleY, skewX /= scaleY;
  if (a * d < b * c) a = -a, b = -b, skewX = -skewX, scaleX = -scaleX;
  return {
    translateX: e,
    translateY: f,
    rotate: Math.atan2(b, a) * degrees,
    skewX: Math.atan(skewX) * degrees,
    scaleX: scaleX,
    scaleY: scaleY
  };
}

var svgNode;

/* eslint-disable no-undef */
function parseCss(value) {
  const m = new (typeof DOMMatrix === "function" ? DOMMatrix : WebKitCSSMatrix)(value + "");
  return m.isIdentity ? identity$1 : decompose(m.a, m.b, m.c, m.d, m.e, m.f);
}

function parseSvg(value) {
  if (value == null) return identity$1;
  if (!svgNode) svgNode = document.createElementNS("http://www.w3.org/2000/svg", "g");
  svgNode.setAttribute("transform", value);
  if (!(value = svgNode.transform.baseVal.consolidate())) return identity$1;
  value = value.matrix;
  return decompose(value.a, value.b, value.c, value.d, value.e, value.f);
}

function interpolateTransform(parse, pxComma, pxParen, degParen) {

  function pop(s) {
    return s.length ? s.pop() + " " : "";
  }

  function translate(xa, ya, xb, yb, s, q) {
    if (xa !== xb || ya !== yb) {
      var i = s.push("translate(", null, pxComma, null, pxParen);
      q.push({i: i - 4, x: interpolateNumber(xa, xb)}, {i: i - 2, x: interpolateNumber(ya, yb)});
    } else if (xb || yb) {
      s.push("translate(" + xb + pxComma + yb + pxParen);
    }
  }

  function rotate(a, b, s, q) {
    if (a !== b) {
      if (a - b > 180) b += 360; else if (b - a > 180) a += 360; // shortest path
      q.push({i: s.push(pop(s) + "rotate(", null, degParen) - 2, x: interpolateNumber(a, b)});
    } else if (b) {
      s.push(pop(s) + "rotate(" + b + degParen);
    }
  }

  function skewX(a, b, s, q) {
    if (a !== b) {
      q.push({i: s.push(pop(s) + "skewX(", null, degParen) - 2, x: interpolateNumber(a, b)});
    } else if (b) {
      s.push(pop(s) + "skewX(" + b + degParen);
    }
  }

  function scale(xa, ya, xb, yb, s, q) {
    if (xa !== xb || ya !== yb) {
      var i = s.push(pop(s) + "scale(", null, ",", null, ")");
      q.push({i: i - 4, x: interpolateNumber(xa, xb)}, {i: i - 2, x: interpolateNumber(ya, yb)});
    } else if (xb !== 1 || yb !== 1) {
      s.push(pop(s) + "scale(" + xb + "," + yb + ")");
    }
  }

  return function(a, b) {
    var s = [], // string constants and placeholders
        q = []; // number interpolators
    a = parse(a), b = parse(b);
    translate(a.translateX, a.translateY, b.translateX, b.translateY, s, q);
    rotate(a.rotate, b.rotate, s, q);
    skewX(a.skewX, b.skewX, s, q);
    scale(a.scaleX, a.scaleY, b.scaleX, b.scaleY, s, q);
    a = b = null; // gc
    return function(t) {
      var i = -1, n = q.length, o;
      while (++i < n) s[(o = q[i]).i] = o.x(t);
      return s.join("");
    };
  };
}

var interpolateTransformCss = interpolateTransform(parseCss, "px, ", "px)", "deg)");
var interpolateTransformSvg = interpolateTransform(parseSvg, ", ", ")", ")");

function cubehelix$1(hue) {
  return (function cubehelixGamma(y) {
    y = +y;

    function cubehelix(start, end) {
      var h = hue((start = cubehelix$2(start)).h, (end = cubehelix$2(end)).h),
          s = nogamma(start.s, end.s),
          l = nogamma(start.l, end.l),
          opacity = nogamma(start.opacity, end.opacity);
      return function(t) {
        start.h = h(t);
        start.s = s(t);
        start.l = l(Math.pow(t, y));
        start.opacity = opacity(t);
        return start + "";
      };
    }

    cubehelix.gamma = cubehelixGamma;

    return cubehelix;
  })(1);
}

cubehelix$1(hue);
var cubehelixLong = cubehelix$1(nogamma);

var ramp$1 = scheme => rgbBasis(scheme[scheme.length - 1]);

var scheme$q = new Array(3).concat(
  "d8b365f5f5f55ab4ac",
  "a6611adfc27d80cdc1018571",
  "a6611adfc27df5f5f580cdc1018571",
  "8c510ad8b365f6e8c3c7eae55ab4ac01665e",
  "8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e",
  "8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e",
  "8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e",
  "5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30",
  "5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30"
).map(colors);

var BrBG = ramp$1(scheme$q);

var scheme$p = new Array(3).concat(
  "af8dc3f7f7f77fbf7b",
  "7b3294c2a5cfa6dba0008837",
  "7b3294c2a5cff7f7f7a6dba0008837",
  "762a83af8dc3e7d4e8d9f0d37fbf7b1b7837",
  "762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837",
  "762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837",
  "762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837",
  "40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b",
  "40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b"
).map(colors);

var PRGn = ramp$1(scheme$p);

var scheme$o = new Array(3).concat(
  "e9a3c9f7f7f7a1d76a",
  "d01c8bf1b6dab8e1864dac26",
  "d01c8bf1b6daf7f7f7b8e1864dac26",
  "c51b7de9a3c9fde0efe6f5d0a1d76a4d9221",
  "c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221",
  "c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221",
  "c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221",
  "8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419",
  "8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419"
).map(colors);

var PiYG = ramp$1(scheme$o);

var scheme$n = new Array(3).concat(
  "998ec3f7f7f7f1a340",
  "5e3c99b2abd2fdb863e66101",
  "5e3c99b2abd2f7f7f7fdb863e66101",
  "542788998ec3d8daebfee0b6f1a340b35806",
  "542788998ec3d8daebf7f7f7fee0b6f1a340b35806",
  "5427888073acb2abd2d8daebfee0b6fdb863e08214b35806",
  "5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806",
  "2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08",
  "2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08"
).map(colors);

var PuOr = ramp$1(scheme$n);

var scheme$m = new Array(3).concat(
  "ef8a62f7f7f767a9cf",
  "ca0020f4a58292c5de0571b0",
  "ca0020f4a582f7f7f792c5de0571b0",
  "b2182bef8a62fddbc7d1e5f067a9cf2166ac",
  "b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac",
  "b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac",
  "b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac",
  "67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061",
  "67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061"
).map(colors);

var RdBu = ramp$1(scheme$m);

var scheme$l = new Array(3).concat(
  "ef8a62ffffff999999",
  "ca0020f4a582bababa404040",
  "ca0020f4a582ffffffbababa404040",
  "b2182bef8a62fddbc7e0e0e09999994d4d4d",
  "b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d",
  "b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d",
  "b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d",
  "67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a",
  "67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a"
).map(colors);

var RdGy = ramp$1(scheme$l);

var scheme$k = new Array(3).concat(
  "fc8d59ffffbf91bfdb",
  "d7191cfdae61abd9e92c7bb6",
  "d7191cfdae61ffffbfabd9e92c7bb6",
  "d73027fc8d59fee090e0f3f891bfdb4575b4",
  "d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4",
  "d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4",
  "d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4",
  "a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695",
  "a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695"
).map(colors);

var RdYlBu = ramp$1(scheme$k);

var scheme$j = new Array(3).concat(
  "fc8d59ffffbf91cf60",
  "d7191cfdae61a6d96a1a9641",
  "d7191cfdae61ffffbfa6d96a1a9641",
  "d73027fc8d59fee08bd9ef8b91cf601a9850",
  "d73027fc8d59fee08bffffbfd9ef8b91cf601a9850",
  "d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850",
  "d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850",
  "a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837",
  "a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837"
).map(colors);

var RdYlGn = ramp$1(scheme$j);

var scheme$i = new Array(3).concat(
  "fc8d59ffffbf99d594",
  "d7191cfdae61abdda42b83ba",
  "d7191cfdae61ffffbfabdda42b83ba",
  "d53e4ffc8d59fee08be6f59899d5943288bd",
  "d53e4ffc8d59fee08bffffbfe6f59899d5943288bd",
  "d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd",
  "d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd",
  "9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2",
  "9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2"
).map(colors);

var Spectral = ramp$1(scheme$i);

var scheme$h = new Array(3).concat(
  "e5f5f999d8c92ca25f",
  "edf8fbb2e2e266c2a4238b45",
  "edf8fbb2e2e266c2a42ca25f006d2c",
  "edf8fbccece699d8c966c2a42ca25f006d2c",
  "edf8fbccece699d8c966c2a441ae76238b45005824",
  "f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824",
  "f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b"
).map(colors);

var BuGn = ramp$1(scheme$h);

var scheme$g = new Array(3).concat(
  "e0ecf49ebcda8856a7",
  "edf8fbb3cde38c96c688419d",
  "edf8fbb3cde38c96c68856a7810f7c",
  "edf8fbbfd3e69ebcda8c96c68856a7810f7c",
  "edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b",
  "f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b",
  "f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b"
).map(colors);

var BuPu = ramp$1(scheme$g);

var scheme$f = new Array(3).concat(
  "e0f3dba8ddb543a2ca",
  "f0f9e8bae4bc7bccc42b8cbe",
  "f0f9e8bae4bc7bccc443a2ca0868ac",
  "f0f9e8ccebc5a8ddb57bccc443a2ca0868ac",
  "f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e",
  "f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e",
  "f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081"
).map(colors);

var GnBu = ramp$1(scheme$f);

var scheme$e = new Array(3).concat(
  "fee8c8fdbb84e34a33",
  "fef0d9fdcc8afc8d59d7301f",
  "fef0d9fdcc8afc8d59e34a33b30000",
  "fef0d9fdd49efdbb84fc8d59e34a33b30000",
  "fef0d9fdd49efdbb84fc8d59ef6548d7301f990000",
  "fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000",
  "fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000"
).map(colors);

var OrRd = ramp$1(scheme$e);

var scheme$d = new Array(3).concat(
  "ece2f0a6bddb1c9099",
  "f6eff7bdc9e167a9cf02818a",
  "f6eff7bdc9e167a9cf1c9099016c59",
  "f6eff7d0d1e6a6bddb67a9cf1c9099016c59",
  "f6eff7d0d1e6a6bddb67a9cf3690c002818a016450",
  "fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450",
  "fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636"
).map(colors);

var PuBuGn = ramp$1(scheme$d);

var scheme$c = new Array(3).concat(
  "ece7f2a6bddb2b8cbe",
  "f1eef6bdc9e174a9cf0570b0",
  "f1eef6bdc9e174a9cf2b8cbe045a8d",
  "f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d",
  "f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b",
  "fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b",
  "fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858"
).map(colors);

var PuBu = ramp$1(scheme$c);

var scheme$b = new Array(3).concat(
  "e7e1efc994c7dd1c77",
  "f1eef6d7b5d8df65b0ce1256",
  "f1eef6d7b5d8df65b0dd1c77980043",
  "f1eef6d4b9dac994c7df65b0dd1c77980043",
  "f1eef6d4b9dac994c7df65b0e7298ace125691003f",
  "f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f",
  "f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f"
).map(colors);

var PuRd = ramp$1(scheme$b);

var scheme$a = new Array(3).concat(
  "fde0ddfa9fb5c51b8a",
  "feebe2fbb4b9f768a1ae017e",
  "feebe2fbb4b9f768a1c51b8a7a0177",
  "feebe2fcc5c0fa9fb5f768a1c51b8a7a0177",
  "feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177",
  "fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177",
  "fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a"
).map(colors);

var RdPu = ramp$1(scheme$a);

var scheme$9 = new Array(3).concat(
  "edf8b17fcdbb2c7fb8",
  "ffffcca1dab441b6c4225ea8",
  "ffffcca1dab441b6c42c7fb8253494",
  "ffffccc7e9b47fcdbb41b6c42c7fb8253494",
  "ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84",
  "ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84",
  "ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58"
).map(colors);

var YlGnBu = ramp$1(scheme$9);

var scheme$8 = new Array(3).concat(
  "f7fcb9addd8e31a354",
  "ffffccc2e69978c679238443",
  "ffffccc2e69978c67931a354006837",
  "ffffccd9f0a3addd8e78c67931a354006837",
  "ffffccd9f0a3addd8e78c67941ab5d238443005a32",
  "ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32",
  "ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529"
).map(colors);

var YlGn = ramp$1(scheme$8);

var scheme$7 = new Array(3).concat(
  "fff7bcfec44fd95f0e",
  "ffffd4fed98efe9929cc4c02",
  "ffffd4fed98efe9929d95f0e993404",
  "ffffd4fee391fec44ffe9929d95f0e993404",
  "ffffd4fee391fec44ffe9929ec7014cc4c028c2d04",
  "ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04",
  "ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506"
).map(colors);

var YlOrBr = ramp$1(scheme$7);

var scheme$6 = new Array(3).concat(
  "ffeda0feb24cf03b20",
  "ffffb2fecc5cfd8d3ce31a1c",
  "ffffb2fecc5cfd8d3cf03b20bd0026",
  "ffffb2fed976feb24cfd8d3cf03b20bd0026",
  "ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026",
  "ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026",
  "ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026"
).map(colors);

var YlOrRd = ramp$1(scheme$6);

var scheme$5 = new Array(3).concat(
  "deebf79ecae13182bd",
  "eff3ffbdd7e76baed62171b5",
  "eff3ffbdd7e76baed63182bd08519c",
  "eff3ffc6dbef9ecae16baed63182bd08519c",
  "eff3ffc6dbef9ecae16baed64292c62171b5084594",
  "f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594",
  "f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b"
).map(colors);

var Blues = ramp$1(scheme$5);

var scheme$4 = new Array(3).concat(
  "e5f5e0a1d99b31a354",
  "edf8e9bae4b374c476238b45",
  "edf8e9bae4b374c47631a354006d2c",
  "edf8e9c7e9c0a1d99b74c47631a354006d2c",
  "edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32",
  "f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32",
  "f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b"
).map(colors);

var Greens = ramp$1(scheme$4);

var scheme$3 = new Array(3).concat(
  "f0f0f0bdbdbd636363",
  "f7f7f7cccccc969696525252",
  "f7f7f7cccccc969696636363252525",
  "f7f7f7d9d9d9bdbdbd969696636363252525",
  "f7f7f7d9d9d9bdbdbd969696737373525252252525",
  "fffffff0f0f0d9d9d9bdbdbd969696737373525252252525",
  "fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000"
).map(colors);

var Greys = ramp$1(scheme$3);

var scheme$2 = new Array(3).concat(
  "efedf5bcbddc756bb1",
  "f2f0f7cbc9e29e9ac86a51a3",
  "f2f0f7cbc9e29e9ac8756bb154278f",
  "f2f0f7dadaebbcbddc9e9ac8756bb154278f",
  "f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486",
  "fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486",
  "fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d"
).map(colors);

var Purples = ramp$1(scheme$2);

var scheme$1 = new Array(3).concat(
  "fee0d2fc9272de2d26",
  "fee5d9fcae91fb6a4acb181d",
  "fee5d9fcae91fb6a4ade2d26a50f15",
  "fee5d9fcbba1fc9272fb6a4ade2d26a50f15",
  "fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d",
  "fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d",
  "fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d"
).map(colors);

var Reds = ramp$1(scheme$1);

var scheme = new Array(3).concat(
  "fee6cefdae6be6550d",
  "feeddefdbe85fd8d3cd94701",
  "feeddefdbe85fd8d3ce6550da63603",
  "feeddefdd0a2fdae6bfd8d3ce6550da63603",
  "feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04",
  "fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04",
  "fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704"
).map(colors);

var Oranges = ramp$1(scheme);

function cividis(t) {
  t = Math.max(0, Math.min(1, t));
  return "rgb("
      + Math.max(0, Math.min(255, Math.round(-4.54 - t * (35.34 - t * (2381.73 - t * (6402.7 - t * (7024.72 - t * 2710.57))))))) + ", "
      + Math.max(0, Math.min(255, Math.round(32.49 + t * (170.73 + t * (52.82 - t * (131.46 - t * (176.58 - t * 67.37))))))) + ", "
      + Math.max(0, Math.min(255, Math.round(81.24 + t * (442.36 - t * (2482.43 - t * (6167.24 - t * (6614.94 - t * 2475.67)))))))
      + ")";
}

var cubehelix = cubehelixLong(cubehelix$2(300, 0.5, 0.0), cubehelix$2(-240, 0.5, 1.0));

var warm = cubehelixLong(cubehelix$2(-100, 0.75, 0.35), cubehelix$2(80, 1.50, 0.8));

var cool = cubehelixLong(cubehelix$2(260, 0.75, 0.35), cubehelix$2(80, 1.50, 0.8));

var c$2 = cubehelix$2();

function rainbow(t) {
  if (t < 0 || t > 1) t -= Math.floor(t);
  var ts = Math.abs(t - 0.5);
  c$2.h = 360 * t - 100;
  c$2.s = 1.5 - 1.5 * ts;
  c$2.l = 0.8 - 0.9 * ts;
  return c$2 + "";
}

var c$1 = rgb(),
    pi_1_3 = Math.PI / 3,
    pi_2_3 = Math.PI * 2 / 3;

function sinebow(t) {
  var x;
  t = (0.5 - t) * Math.PI;
  c$1.r = 255 * (x = Math.sin(t)) * x;
  c$1.g = 255 * (x = Math.sin(t + pi_1_3)) * x;
  c$1.b = 255 * (x = Math.sin(t + pi_2_3)) * x;
  return c$1 + "";
}

function turbo(t) {
  t = Math.max(0, Math.min(1, t));
  return "rgb("
      + Math.max(0, Math.min(255, Math.round(34.61 + t * (1172.33 - t * (10793.56 - t * (33300.12 - t * (38394.49 - t * 14825.05))))))) + ", "
      + Math.max(0, Math.min(255, Math.round(23.31 + t * (557.33 + t * (1225.33 - t * (3574.96 - t * (1073.77 + t * 707.56))))))) + ", "
      + Math.max(0, Math.min(255, Math.round(27.2 + t * (3211.1 - t * (15327.97 - t * (27814 - t * (22569.18 - t * 6838.66)))))))
      + ")";
}

function ramp(range) {
  var n = range.length;
  return function(t) {
    return range[Math.max(0, Math.min(n - 1, Math.floor(t * n)))];
  };
}

var viridis = ramp(colors("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));

var magma = ramp(colors("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf"));

var inferno = ramp(colors("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4"));

var plasma = ramp(colors("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));

var d3$4 = /*#__PURE__*/Object.freeze({
    __proto__: null,
    interpolateBlues: Blues,
    interpolateBrBG: BrBG,
    interpolateBuGn: BuGn,
    interpolateBuPu: BuPu,
    interpolateCividis: cividis,
    interpolateCool: cool,
    interpolateCubehelixDefault: cubehelix,
    interpolateGnBu: GnBu,
    interpolateGreens: Greens,
    interpolateGreys: Greys,
    interpolateInferno: inferno,
    interpolateMagma: magma,
    interpolateOrRd: OrRd,
    interpolateOranges: Oranges,
    interpolatePRGn: PRGn,
    interpolatePiYG: PiYG,
    interpolatePlasma: plasma,
    interpolatePuBu: PuBu,
    interpolatePuBuGn: PuBuGn,
    interpolatePuOr: PuOr,
    interpolatePuRd: PuRd,
    interpolatePurples: Purples,
    interpolateRainbow: rainbow,
    interpolateRdBu: RdBu,
    interpolateRdGy: RdGy,
    interpolateRdPu: RdPu,
    interpolateRdYlBu: RdYlBu,
    interpolateRdYlGn: RdYlGn,
    interpolateReds: Reds,
    interpolateSinebow: sinebow,
    interpolateSpectral: Spectral,
    interpolateTurbo: turbo,
    interpolateViridis: viridis,
    interpolateWarm: warm,
    interpolateYlGn: YlGn,
    interpolateYlGnBu: YlGnBu,
    interpolateYlOrBr: YlOrBr,
    interpolateYlOrRd: YlOrRd,
    schemeAccent: Accent,
    schemeBlues: scheme$5,
    schemeBrBG: scheme$q,
    schemeBuGn: scheme$h,
    schemeBuPu: scheme$g,
    schemeCategory10: category10,
    schemeDark2: Dark2,
    schemeGnBu: scheme$f,
    schemeGreens: scheme$4,
    schemeGreys: scheme$3,
    schemeOrRd: scheme$e,
    schemeOranges: scheme,
    schemePRGn: scheme$p,
    schemePaired: Paired,
    schemePastel1: Pastel1,
    schemePastel2: Pastel2,
    schemePiYG: scheme$o,
    schemePuBu: scheme$c,
    schemePuBuGn: scheme$d,
    schemePuOr: scheme$n,
    schemePuRd: scheme$b,
    schemePurples: scheme$2,
    schemeRdBu: scheme$m,
    schemeRdGy: scheme$l,
    schemeRdPu: scheme$a,
    schemeRdYlBu: scheme$k,
    schemeRdYlGn: scheme$j,
    schemeReds: scheme$1,
    schemeSet1: Set1,
    schemeSet2: Set2,
    schemeSet3: Set3,
    schemeSpectral: scheme$i,
    schemeTableau10: Tableau10,
    schemeYlGn: scheme$8,
    schemeYlGnBu: scheme$9,
    schemeYlOrBr: scheme$7,
    schemeYlOrRd: scheme$6
});

class ColorMap {
    static interpolator;
    static getColor(value, color) {
        // @ts-ignore
        if (d3$4[color] == undefined) {
            throw Error("Color scale does not exist (refer to d3-scale-chromatic)");
        }
        // @ts-ignore
        ColorMap.interpolator = d3$4[color];
        const numberPattern = /\d+/g;
        const rgbStr = ColorMap.interpolator(value).match(numberPattern);
        if (rgbStr === null) {
            return [0, 0, 0];
        }
        return rgbStr.map(el => +el / 255);
    }
    static getColorMap(color, res = 256) {
        const tex = [];
        for (let id = 0; id < res; id++) {
            const val = id / (res - 1);
            const col = ColorMap.getColor(val, color);
            tex.push(...col);
        }
        return tex;
    }
}

var vsSmoothColorMap$1 = "#version 300 es\nconst float pi=3.1415926535897932384626433832795;const float pi_180=0.017453292519943295769236907684886127134428718885417254560;const float pi_4=12.56637061435917295385057353311801153678867759750042328389;uniform highp mat4 uModelViewMatrix;uniform highp mat4 uProjectionMatrix;uniform highp vec2 uWorldOrigin;in highp vec3 vertCoords;in highp vec3 vertNormals;in highp float inFootprintPlaneHeight;in highp vec2 funcValues;in lowp float inColorOrPicked;in lowp float inFiltered;out highp vec2 texCoords;out highp vec3 fragNormals;out lowp float vColorOrPicked;out lowp float filtered;out highp float footprintPlaneHeight;out highp vec3 vsCoords;vec2 latLngToPixel(highp float latitude,highp float longitude){highp float sinLatitude=sin(latitude*pi_180);highp float pixelY=256.0-((0.5-log((1.0+sinLatitude)/(1.0-sinLatitude))/(pi_4))*256.0);highp float pixelX=((longitude+180.0)/360.0)*256.0;return vec2(pixelX,pixelY);}void main(){highp vec3 finalPos=vertCoords;texCoords=funcValues;fragNormals=vertNormals;vColorOrPicked=inColorOrPicked;filtered=inFiltered;footprintPlaneHeight=inFootprintPlaneHeight;vsCoords=vertCoords;gl_Position=uProjectionMatrix*uModelViewMatrix*vec4(finalPos,1.0);}";

var fsSmoothColorMap$1 = "#version 300 es\nuniform sampler2D uColorMap;uniform highp sampler2D u_texture;in highp vec2 texCoords;in highp vec3 fragNormals;in lowp float vColorOrPicked;in highp float footprintPlaneHeight;in highp vec3 vsCoords;in lowp float filtered;out highp vec4 fragColor;void main(){highp vec3 texColor=texture(uColorMap,texCoords).rgb;highp vec3 light=normalize(vec3(1.0,0.0,1.0));highp vec3 normal=normalize(fragNormals);highp float diffuse=max(dot(normal,light)*0.7,0.0);highp float ambient=0.6;highp vec3 shade=texColor*(diffuse+ambient);if(filtered<=0.5){fragColor=vec4(0.5,0.5,0.5,0.7);}else{if(vColorOrPicked>0.5){fragColor=vec4(0,1,0,1);}else{if(footprintPlaneHeight>=0.0&&vsCoords[2]>=footprintPlaneHeight){fragColor=vec4(1,1,1,0.3);}else{fragColor=vec4(shade,1);}}}}";

/**
 * Multiply matrices of any dimensions given compatible columns and rows.
 */
function multiplyMatrices(A, B) {
    var result = new Array(A.length).fill(0).map(row => new Array(B[0].length).fill(0));
    return result.map((row, i) => {
        return row.map((val, j) => {
            return A[i].reduce((sum, elm, k) => sum + (elm * B[k][j]), 0);
        });
    });
}
function rotateYMatrix(a) {
    var cos = Math.cos;
    var sin = Math.sin;
    return [[cos(a), 0, sin(a), 0], [0, 1, 0, 0], [-sin(a), 0, cos(a), 0], [0, 0, 0, 1]];
}
function rotateZMatrix(a) {
    var cos = Math.cos;
    var sin = Math.sin;
    return [[cos(a), -sin(a), 0, 0], [sin(a), cos(a), 0, 0], [0, 0, 1, 0], [0, 0, 0, 1]];
}
function translateMatrix(x, y, z) {
    return [[1, 0, 0, x], [0, 1, 0, y], [0, 0, 1, z], [0, 0, 0, 1]];
}
function dot(v1, v2) {
    if (v1.length != v2.length) {
        throw new Error("v1 and v2 have different number of dimensions");
    }
    let result = 0;
    for (let i = 0; i < v1.length; i++) {
        result += v1[i] * v2[i];
    }
    return result;
}
function angle(v1, v2) {
    if (v1.length != v2.length) {
        throw new Error("v1 and v2 have different number of dimensions");
    }
    let zero = true;
    for (let i = 0; i < v1.length; i++) {
        if (v1[i] != 0) {
            zero = false;
            break;
        }
    }
    if (zero)
        return 0;
    zero = true;
    for (let i = 0; i < v2.length; i++) {
        if (v2[i] != 0) {
            zero = false;
            break;
        }
    }
    if (zero)
        return 0;
    let unit_1 = normalize$1(v1);
    let unit_2 = normalize$1(v2);
    let dot_product = dot(unit_1, unit_2);
    let angle_vectors = Math.acos(dot_product) * 180.0 / Math.PI;
    return angle_vectors;
}
function radians(angle) {
    return angle * Math.PI / 180;
}
// From glMatrix
function cross$1(a, b) {
    var out = [0, 0, 0];
    let ax = a[0], ay = a[1], az = a[2];
    let bx = b[0], by = b[1], bz = b[2];
    out[0] = ay * bz - az * by;
    out[1] = az * bx - ax * bz;
    out[2] = ax * by - ay * bx;
    return out;
}
// From glMatrix
function normalize$1(a) {
    let out = [];
    let len = 0;
    for (let i = 0; i < a.length; i++) {
        len += a[i] * a[i];
    }
    if (len > 0) {
        len = 1 / Math.sqrt(len);
    }
    for (let i = 0; i < a.length; i++) {
        out.push(a[i] * len);
    }
    return out;
}
function euclideanDistance(p1, p2) {
    if (p1.length != p2.length) {
        throw new Error("p1 and p2 have different number of dimensions");
    }
    let result = 0;
    for (let i = 0; i < p1.length; i++) {
        result += Math.pow(p1[i] - p2[i], 2);
    }
    return Math.sqrt(result);
}

require('mathjs');
const d3$3 = require('d3');
/**
 * This shader should only be used with the buildings layer
 */
class ShaderSmoothColorMapTex extends AuxiliaryShader {
    // Data to be rendered
    _coords = [];
    _normals = [];
    _function = []; // function values that will be sent to the frag shader
    _unchangedFunction = []; // original function value for each coordinate
    _indices = [];
    _idsLength;
    _heights = [];
    _minHeights = [];
    _orientedEnvelope = [];
    _sectionFootprint = [];
    _footprintPlaneHeightByCoord = []; // for each coordinate stores, if there is any, the height of the footprint plot that intersects the building
    _lastCode = -1; // last code used to identify a plot
    // TODO decide which function to use
    _functionToUse = 0;
    // Color map definition
    _colorMap = null;
    _colorMapReverse = false;
    // Data loaction on GPU
    _glCoords = null;
    _glNormals = null;
    _glFunction = null;
    _glIndices = null;
    _glColorOrPicked = null;
    _glFootprintPlaneHeight = null;
    _glFiltered = null;
    // Data has chaged
    _coordsDirty = false;
    _functionDirty = false;
    _colorMapDirty = false;
    _colorOrPickedDirty = false;
    _planeHeightDirty = false;
    _filteredDirty = false;
    // Id of each property in the VAO
    _coordsId = -1;
    _normalsId = -1;
    _functionId = -1;
    _colorOrPickedId = -1;
    _planeHeightId = -1;
    _filteredId = -1;
    // Uniforms location
    _uModelViewMatrix = null;
    _uProjectionMatrix = null;
    _uWorldOrigin = null;
    _uColorMap = null;
    _textureLocation = null;
    // Color map texture
    _texColorMap;
    // Picking
    _colorOrPicked = [];
    _cellIdsByCoordinates = []; // stores the cell id of each coordinate grouped by mesh component
    _pickedCoordinates = []; // store index of coordinates not the coordinates themselves
    // Footprint plot
    _footprintCoords;
    _currentBuildingCoords;
    _coordinatesById;
    _currentFootprintBuildingId;
    _currentPickedBuildingId;
    _footprintCodesPerBuilding = []; // stores the unique identifier of the footprint plot of the building
    _auxCoords = [];
    _auxIndices = [];
    _auxNormals = [];
    _auxFunction = [];
    _filtered = [];
    constructor(glContext, colorMap = "interpolateReds", colorMapReverse = false) {
        super(vsSmoothColorMap$1, fsSmoothColorMap$1, glContext);
        // saves the layer color
        this._colorMap = colorMap;
        this._colorMapReverse = colorMapReverse;
        // create the shader variables    
        this.createUniforms(glContext);
        this.createVertexArrayObject(glContext);
        this.createTextures(glContext);
    }
    get colorOrPicked() {
        return this._colorOrPicked;
    }
    get currentFootPrintBuildingId() {
        return this._currentFootprintBuildingId;
    }
    get currentPickedBuildingId() {
        return this._currentPickedBuildingId;
    }
    updateShaderGeometry(mesh) {
        this._coordsDirty = true;
        this._planeHeightDirty = true;
        this._filteredDirty = true;
        this._coords = mesh.getCoordinatesVBO();
        this._normals = mesh.getNormalsVBO();
        this._indices = mesh.getIndicesVBO();
        this._heights = mesh.getHeightsVBO();
        this._minHeights = mesh.getMinHeightsVBO();
        this._orientedEnvelope = mesh.getOrientedEnvelopesVBO();
        this._sectionFootprint = mesh.getSectionFootprintVBO();
        this._idsLength = mesh.idsLength();
        // start showing only colors by default
        for (let i = 0; i < this._coords.length / 3; i++) { // TODO considers that coords is always 3d (dont know if it is true)
            this._colorOrPicked.push(0.0);
            this._filtered.push(1.0); // 1 true to include
        }
        for (let i = 0; i < this._coords.length / 3; i++) {
            this._footprintPlaneHeightByCoord.push(-1.0);
        }
    }
    setFiltered(filtered) {
        if (filtered.length == 0) {
            this._filtered = Array(this._filtered.length).fill(1.0);
        }
        else {
            this._filtered = filtered;
        }
        this._filteredDirty = true;
    }
    updateShaderData(mesh, knot) {
        this._currentKnot = knot;
        this._functionDirty = true;
        this._colorOrPickedDirty = true;
        let tempFunction = mesh.getFunctionVBO(knot.id);
        for (let j = 0; j < tempFunction.length; j++) {
            let scale = d3$3.scaleLinear().domain(d3$3.extent(tempFunction[j])).range([0, 1]);
            for (let i = 0; i < tempFunction[j].length; i++) {
                tempFunction[j][i] = scale(tempFunction[j][i]);
            }
        }
        this._function = [];
        this._unchangedFunction = [];
        for (let i = 0; i < tempFunction.length; i++) {
            this._function.push([]);
            this._unchangedFunction.push([]);
            tempFunction[i].forEach((elem) => {
                this._unchangedFunction[i].push(elem);
                this._function[i].push(elem);
                this._function[i].push(0);
            });
        }
    }
    updateShaderUniforms(data) {
        this._colorMapDirty = true;
        this._colorMap = data;
    }
    createUniforms(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        this._uModelViewMatrix = glContext.getUniformLocation(this._shaderProgram, 'uModelViewMatrix');
        this._uProjectionMatrix = glContext.getUniformLocation(this._shaderProgram, 'uProjectionMatrix');
        this._uWorldOrigin = glContext.getUniformLocation(this._shaderProgram, 'uWorldOrigin');
        this._textureLocation = glContext.getUniformLocation(this._shaderProgram, "u_texture");
    }
    bindUniforms(glContext, camera) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.uniformMatrix4fv(this._uModelViewMatrix, false, camera.getModelViewMatrix());
        glContext.uniformMatrix4fv(this._uProjectionMatrix, false, camera.getProjectionMatrix());
        glContext.uniform2fv(this._uWorldOrigin, camera.getWorldOrigin());
    }
    createTextures(glContext) {
        if (!this._colorMap) {
            return;
        }
        this._uColorMap = glContext.getUniformLocation(this._shaderProgram, 'uColorMap');
        this._texColorMap = glContext.createTexture();
        glContext.bindTexture(glContext.TEXTURE_2D, this._texColorMap);
        // // Set the parameters so we can render any size image.
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.NEAREST);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MAG_FILTER, glContext.NEAREST);
        // Upload the image into the texture.
        const texData = ColorMap.getColorMap(this._colorMap);
        const size = [256, 1];
        glContext.texImage2D(glContext.TEXTURE_2D, 0, glContext.RGB32F, size[0], size[1], 0, glContext.RGB, glContext.FLOAT, new Float32Array(texData));
    }
    bindTextures(glContext) {
        glContext.uniform1i(this._uColorMap, 0); // texture unit 0
        glContext.activeTexture(glContext.TEXTURE0);
        glContext.bindTexture(glContext.TEXTURE_2D, this._texColorMap);
    }
    createVertexArrayObject(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        // Creates the coords id.
        this._coordsId = glContext.getAttribLocation(this._shaderProgram, 'vertCoords');
        // Create a buffer for the positions.
        this._glCoords = glContext.createBuffer();
        // Creates the coords id.
        this._normalsId = glContext.getAttribLocation(this._shaderProgram, 'vertNormals');
        // Create a buffer for the positions.
        this._glNormals = glContext.createBuffer();
        // Creates the function id.
        this._functionId = glContext.getAttribLocation(this._shaderProgram, 'funcValues');
        this._glFunction = glContext.createBuffer();
        this._colorOrPickedId = glContext.getAttribLocation(this._shaderProgram, 'inColorOrPicked');
        this._glColorOrPicked = glContext.createBuffer();
        this._filteredId = glContext.getAttribLocation(this._shaderProgram, 'inFiltered');
        this._glFiltered = glContext.createBuffer();
        this._planeHeightId = glContext.getAttribLocation(this._shaderProgram, 'inFootprintPlaneHeight');
        this._glFootprintPlaneHeight = glContext.createBuffer();
        // Creates the elements buffer
        this._glIndices = glContext.createBuffer();
    }
    bindVertexArrayObject(glContext, mesh) {
        if (!this._shaderProgram) {
            return;
        }
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glCoords);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._coords), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._coordsId, mesh.dimension, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._coordsId);
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glNormals);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._normals), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._normalsId, mesh.dimension, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._normalsId);
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glFunction);
        // send data to gpu
        if (this._functionDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._function[this._functionToUse]), glContext.STATIC_DRAW);
        }
        glContext.vertexAttribPointer(this._functionId, 2, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._functionId);
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glColorOrPicked);
        if (this._colorOrPickedDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._colorOrPicked), glContext.STATIC_DRAW);
        }
        glContext.vertexAttribPointer(this._colorOrPickedId, 1, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._colorOrPickedId);
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glFiltered);
        if (this._filteredDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._filtered), glContext.STATIC_DRAW);
        }
        glContext.vertexAttribPointer(this._filteredId, 1, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._filteredId);
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glFootprintPlaneHeight);
        if (this._planeHeightDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._footprintPlaneHeightByCoord), glContext.STATIC_DRAW);
        }
        glContext.vertexAttribPointer(this._planeHeightId, 1, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._planeHeightId);
        // binds the indices buffer
        glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndices);
        // send data to g4pu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ELEMENT_ARRAY_BUFFER, new Uint32Array(this._indices), glContext.STATIC_DRAW);
        }
        this._planeHeightDirty = false;
        this._colorOrPickedDirty = false;
        this._coordsDirty = false;
        this._functionDirty = false;
        this._filteredDirty = false;
    }
    setIdsCoordinates(cellIdsByCoordinates) {
        this._cellIdsByCoordinates = cellIdsByCoordinates;
        this._coordinatesById = new Array(this._idsLength);
        // builds the array of coordinates per cell id
        let coordinateIndexOffset = 0;
        for (let i = 0; i < this._cellIdsByCoordinates.length; i++) {
            let compElement = this._cellIdsByCoordinates[i];
            for (let j = 0; j < compElement.length; j++) {
                if (!this._coordinatesById[compElement[j]]) {
                    this._coordinatesById[compElement[j]] = [];
                }
                this._coordinatesById[compElement[j]].push(coordinateIndexOffset + j);
            }
            coordinateIndexOffset += compElement.length;
        }
    }
    setPickedCells(pickedCells) {
        this._colorOrPickedDirty = true;
        this._pickedCoordinates = [];
        let readElements = 0;
        this._cellIdsByCoordinates.forEach((compElement) => {
            compElement.forEach((cellId, index) => {
                let coordinateIndex = index + readElements;
                if (pickedCells.has(cellId)) {
                    this._pickedCoordinates.push(coordinateIndex);
                    this._colorOrPicked[coordinateIndex] = 1.0;
                }
                else {
                    this._colorOrPicked[coordinateIndex] = 0.0;
                }
            });
            readElements += compElement.length;
        });
    }
    /**
     * Return all the coordinates indices of a specific building given that the this._coords array is grouped by building
     * @param buildingId id of the building in the coords array
     */
    getBuildingCoords(buildingId) {
        let readCoords = 0;
        for (let i = 0; i < buildingId; i++) {
            readCoords += this._cellIdsByCoordinates[i].length; // this list has the ids separated by building
        }
        let buildingCoords = [];
        for (let i = 0; i < this._cellIdsByCoordinates[buildingId].length; i++) {
            buildingCoords.push(readCoords + i);
        }
        return buildingCoords;
    }
    /**
     * Calculates footprint coords based on the building coords
     * @param buildingCoords
     */
    calcFootprintCoords(buildingCoords) {
        this._footprintCoords = [];
        for (let i = 0; i < buildingCoords.length; i++) {
            let coordIndex = buildingCoords[i] * 3;
            if (this._coords[coordIndex + 2] == 0) { // if z == 0 it belongs to the footprint
                this._footprintCoords.push(buildingCoords[i]);
            }
        }
    }
    /**
     * Calculates the surface mesh for the footprint plot.
     * It uses Principal Component Analysis to create a oriented bounding plane
     *
     * @param {number} deltaHeight how much to shift the height if it is updating a surface
     * @param {boolean} update if a footprint plot is being updated
     * @param {number} plotType the type of d3 plot to show (-1 in case of update to maintain the plot type)
     * @param {string} specType d3 for d3 plots and vega for vega-lite plots
     */
    async applyFootprintPlot(spec, update, plotType = 1, deltaHeight = 0, specType = 'd3') {
        if (this._currentFootprintBuildingId == -1) { // a building was not picked
            return;
        }
        /**
         * @param {number} nBins total number of bins (circle is divided equally)
         */
        function defineBins(nBins) {
            let binData = [];
            let increment = (2 * Math.PI) / nBins; // the angles go from 0 to 2pi (radians)
            // adding the angles that define each bin
            for (let i = 0; i < nBins + 1; i++) {
                binData.push(i * increment);
            }
            return binData;
        }
        /**
         * Generate the radial data in the format expected by D3 TODO: get rid of this external dependence
         *
         * @param {number[]} peripherals 8 numbers describing the peripherals (auxiliary lines)
         * @param {number[]} bins array describing the start and end of each bin (in radians)
         * @param {number} nTimeSteps number of timesteps to be considered
         * @param {number[]} timeStepData data for each timestep (length = nBins * nTimeSteps)
         */
        function genRadialData(peripherals, bins, timeStepData) {
            if (timeStepData.length % (bins.length - 1) != 0) {
                throw new Error("There is a mismatch between the size of bins and size of timeStepData");
            }
            if (peripherals.length != 8) {
                throw new Error("The number of peripherals is different than 8");
            }
            let radialData = [];
            let nTimeSteps = timeStepData.length / (bins.length - 1);
            let nBins = bins.length - 1;
            radialData = radialData.concat(peripherals);
            radialData.push(nBins);
            radialData = radialData.concat(bins);
            radialData.push(nTimeSteps);
            radialData = radialData.concat(timeStepData);
            return JSON.stringify(radialData);
        }
        /**
         *
         * Given a polar coordinate in the world coordinates corverts to pixel coordinates inside the plane
         *
         * @param planeWidthWorld width of the plane in the world coords
         * @param planeHeightWorld height of the plane in the world coords
         * @param angle in degrees. considering 0 between top left and top right. growing clock wise3
         * @param distanceToCenterWorld distance of the coordinate to the center of the plane in world coords
         * @param conversionFactor the scale used to generate the resolution of the image on the plane
         */
        function worldToPixel(planeWidthWorld, planeHeightWorld, angle, distanceToCenterWorld, conversionFactor) {
            let planeWidthPixel = planeWidthWorld * conversionFactor;
            let planeHeightPixel = planeHeightWorld * conversionFactor;
            let centerPlanePixel = [planeWidthPixel / 2, planeHeightPixel / 2];
            let distanceToCenterPixel = distanceToCenterWorld * conversionFactor;
            let pixelXRefCenter = Math.sin(radians(angle)) * distanceToCenterPixel;
            let pixelYRefCenter = Math.cos(radians(angle)) * distanceToCenterPixel;
            // converting from coord system with center in the origin to coord system with top left in the origin
            let pixelXRefOrigin = centerPlanePixel[0] + pixelXRefCenter;
            let pixelYRefOrigin = centerPlanePixel[1] - pixelYRefCenter;
            return [pixelXRefOrigin, pixelYRefOrigin];
        }
        /**
         *
         * @param centroidsWorldCoords the centroid positions (flat 3d) of all cells that are project into the plot (The coordinates are ordered according to the position of the cell in the building)
         * @param centroidsPixelCoords the centroid positions (flat 2d) in the image coordinate system (The coordinates are ordered according to the position of the cell in the building)
         * @param normalsPixelCoords the normals (flat 2d) of the cells in the image coordinate system
         * @param functionsPerTimestep each position stores all the timesteps for that specific cell (the indices of all arrays with cell info match)
         * @param planeCenterWorld center of the plane in world coordinates
         * @param anglePerCentroid angle of each centroid
         */
        function genPlotData(centroidsWorldCoords, centroidsPixelCoords, normalsPixelCoords, functionsPerTimestep, functionIndices, planeCenterWorld, anglePerCentroid) {
            let info = {
                planeCenterWorld: planeCenterWorld,
                pointData: []
            };
            for (let i = 0; i < centroidsWorldCoords.length / 3; i++) {
                let point = {};
                point.worldCoord = [centroidsWorldCoords[i * 3], centroidsWorldCoords[i * 3 + 1], centroidsWorldCoords[i * 3 + 2]];
                point.pixelCoord = [centroidsPixelCoords[i * 2], centroidsPixelCoords[i * 2 + 1]];
                point.normal = [normalsPixelCoords[i * 2], normalsPixelCoords[i * 2 + 1]];
                point.functions = functionsPerTimestep[i];
                point.angle = anglePerCentroid[i];
                point.functionIndex = functionIndices[i];
                info.pointData.push(point);
            }
            return JSON.stringify(info);
        }
        /**
         * @param vec0 vector from center to 0 degrees
         * @param vec270 vector from center to 270 degrees
         * @param point coordinate to be evaluated
         * @param center center of the circle
         * @returns returns the angle of a point in a circle
         */
        function getAnglePoint(vec0, vec270, point, center) {
            let vecPoint = [point[0] - center[0], point[1] - center[1], point[2] - center[2]];
            // Determine the position of the centroid in relation to the orientation of the radial plot
            let angle0 = angle(vecPoint, vec0);
            let angle270 = angle(vecPoint, vec270);
            // Considering angles in the D3 format (0 correspond to 12 oclock and grows clock-wise)
            if (angle0 >= 0 && angle0 < 90 && angle270 >= 90 && angle270 < 180) { // quadrant 1
                return angle0;
            }
            else if (angle0 >= 90 && angle0 < 180 && angle270 > 90 && angle270 <= 180) { // quadrant 2
                return angle0;
            }
            else if (angle0 > 90 && angle0 <= 180 && angle270 > 0 && angle270 <= 90) { // quadrant 3
                return 180 + (90 - angle270);
            }
            else if (angle0 > 0 && angle0 <= 90 && angle270 >= 0 && angle270 < 90) { // quadrant 4
                return 270 + angle270;
            }
        }
        /**
         * Given the indices of a set of points calculate the average of the points
         */
        function avgPoints(indicesPoints, coords) {
            let avgX = 0;
            let avgY = 0;
            let avgZ = 0;
            for (let i = 0; i < indicesPoints.length; i++) {
                let coordinateIndex = indicesPoints[i];
                avgX += coords[coordinateIndex * 3];
                avgY += coords[coordinateIndex * 3 + 1];
                avgZ += coords[coordinateIndex * 3 + 2];
            }
            avgX /= indicesPoints.length;
            avgY /= indicesPoints.length;
            avgZ /= indicesPoints.length;
            return [avgX, avgY, avgZ];
        }
        if (!this._footprintCoords) {
            return { indices: [], coords: [], functionValues: [], image: undefined };
        }
        let footprintCode = -1;
        let surfaceHeight = 1;
        let plotNumber = plotType;
        if (update) {
            surfaceHeight += deltaHeight;
        }
        this._footprintCodesPerBuilding.forEach((elem) => {
            if (elem.buildingId == this._currentFootprintBuildingId) {
                footprintCode = elem.code;
                if (update) {
                    plotNumber = elem.plotType;
                    surfaceHeight += elem.plotHeight;
                    let buildingCoords = this.getBuildingCoords(this._currentFootprintBuildingId);
                    this._planeHeightDirty = true;
                    // update _footprintPlaneHeightByCoord with new footprint plot heights for the coordinates of the added building
                    buildingCoords.forEach((coordIndex) => {
                        this._footprintPlaneHeightByCoord[coordIndex] = surfaceHeight;
                    });
                }
                else {
                    surfaceHeight = elem.plotHeight;
                }
                elem.plotHeight = surfaceHeight;
            }
        });
        if (footprintCode == -1) {
            this._lastCode += 1;
            footprintCode = this._lastCode;
            this._footprintCodesPerBuilding.push({ buildingId: this._currentFootprintBuildingId, code: this._lastCode, plotHeight: surfaceHeight, plotType: plotNumber });
            let buildingCoords = this.getBuildingCoords(this._currentFootprintBuildingId);
            this._planeHeightDirty = true;
            // update _footprintPlaneHeightByCoord with new footprint plot heights for the coordinates of the added building
            buildingCoords.forEach((coordIndex) => {
                this._footprintPlaneHeightByCoord[coordIndex] = surfaceHeight;
            });
        }
        let envelope = this._orientedEnvelope[this._currentFootprintBuildingId];
        let nodes = [envelope[0][0], envelope[0][1], surfaceHeight, envelope[0][2], envelope[0][3], surfaceHeight, envelope[0][4], envelope[0][5], surfaceHeight, envelope[0][6], envelope[0][7], surfaceHeight];
        let centerPlane = [0, 0, 0];
        for (let i = 0; i < nodes.length / 3; i++) {
            centerPlane[0] += nodes[i * 3];
            centerPlane[1] += nodes[i * 3 + 1];
            centerPlane[2] += nodes[i * 3 + 2];
        }
        centerPlane[0] /= nodes.length / 3;
        centerPlane[1] /= nodes.length / 3;
        centerPlane[2] /= nodes.length / 3;
        // let radiusBSphere = getRadiusBSphere(nodes, centerPlane);
        let v1 = [nodes[3] - nodes[0], nodes[4] - nodes[1], nodes[5] - nodes[2]];
        let v2 = [nodes[6] - nodes[0], nodes[7] - nodes[1], nodes[8] - nodes[2]];
        let surfaceNormal = normalize$1(cross$1(v1, v2));
        let indices = [3, 0, 2, 2, 0, 1];
        // let indices = [0, 3, 1, 1, 3, 2];
        // let functionValues = [0,1, 0,0, 1,0, 1,1];
        let functionValues = [1, 1, 1, 0, 0, 0, 0, 1];
        // storing coordinates to calculate euclidean distances
        let topLeft = [];
        let bottomLeft = [];
        let topRight = [];
        let bottomRight = [];
        // figure out height and width of the surface
        for (let i = 0; i < 4; i++) {
            let value1 = functionValues[i * 2];
            let value2 = functionValues[i * 2 + 1];
            if (value1 == 0 && value2 == 0) {
                topLeft.push(nodes[i * 3]);
                topLeft.push(nodes[i * 3 + 1]);
                topLeft.push(nodes[i * 3 + 2]);
            }
            else if (value1 == 0 && value2 == 1) {
                bottomLeft.push(nodes[i * 3]);
                bottomLeft.push(nodes[i * 3 + 1]);
                bottomLeft.push(nodes[i * 3 + 2]);
            }
            else if (value1 == 1 && value2 == 0) {
                topRight.push(nodes[i * 3]);
                topRight.push(nodes[i * 3 + 1]);
                topRight.push(nodes[i * 3 + 2]);
            }
            else if (value1 == 1 && value2 == 1) {
                bottomRight.push(nodes[i * 3]);
                bottomRight.push(nodes[i * 3 + 1]);
                bottomRight.push(nodes[i * 3 + 2]);
            }
        }
        let width = Math.sqrt(Math.pow(topLeft[0] - topRight[0], 2) + Math.pow(topLeft[1] - topRight[1], 2) + Math.pow(topLeft[2] - topRight[2], 2));
        let height = Math.sqrt(Math.pow(topLeft[0] - bottomLeft[0], 2) + Math.pow(topLeft[1] - bottomLeft[1], 2) + Math.pow(topLeft[2] - bottomLeft[2], 2));
        let projectedCentroids = [];
        let cellsToCheck = new Set(); // cells that belong to the currently picked building
        this._cellIdsByCoordinates[this._currentFootprintBuildingId].forEach((cellIndex) => {
            cellsToCheck.add(cellIndex);
        });
        Array.from(cellsToCheck).forEach((cellIndex) => {
            let cellCoordinates = this._coordinatesById[cellIndex];
            // for a cell to intersect a plane it needs to have at least one point in each side of the plane and be in the range of the plane
            let above = false;
            let under = false;
            // let inRange = false;
            for (let i = 0; i < cellCoordinates.length; i++) {
                let coordIndex = cellCoordinates[i];
                let x = this._coords[coordIndex * 3];
                let y = this._coords[coordIndex * 3 + 1];
                let z = this._coords[coordIndex * 3 + 2];
                let p0p = [x - nodes[0], y - nodes[1], z - nodes[2]]; // vector from a point in the plane to the analyzed point
                let dotProduct = dot(surfaceNormal, p0p);
                if (dotProduct > 0) {
                    above = true;
                }
                else if (dotProduct < 0) {
                    under = true;
                }
                else { // the point lies on the plane, no need to check other points
                    above = true;
                    under = true;
                    break;
                }
            }
            // if(above && under && inRange){
            if (above && under) {
                // cellCoordinates.forEach((coordIndex) => { // configure the shader to show coordinate as picked
                //     this._colorOrTexValues[coordIndex*2] = 1;
                //     this._colorOrTexValues[coordIndex*2+1] = 1;
                // });
                let centroid = avgPoints(cellCoordinates, this._coords);
                let allFunctionsCentroid = [];
                for (let i = 0; i < this._function.length; i++) {
                    allFunctionsCentroid.push(this._unchangedFunction[i][cellCoordinates[0]]); // the value is equal to all cellcoordinates
                }
                let normal = [this._normals[cellCoordinates[0] * 3], this._normals[cellCoordinates[0] * 3 + 1], this._normals[cellCoordinates[0] * 3 + 2]];
                projectedCentroids.push({ point: [centroid[0], centroid[1], surfaceHeight], function: allFunctionsCentroid, functionIndex: cellCoordinates[0], normal: normal });
            }
        });
        this._colorOrPickedDirty = true;
        let dataRange = [-5, 5]; // buffer around the surface from where the data should be collected. It is in meters. The surface begins at 0 height
        this._currentBuildingCoords.forEach((coordIndex) => {
            if (this._coords[coordIndex * 3 + 2] >= dataRange[0] && this._coords[coordIndex * 3 + 2] <= dataRange[1]) ;
        });
        // the middle points that represent 0 and 270 degrees in the circle
        let degree0 = [(topLeft[0] + topRight[0]) / 2, (topLeft[1] + topRight[1]) / 2, (topLeft[2] + topRight[2]) / 2];
        let degree270 = [(topLeft[0] + bottomLeft[0]) / 2, (topLeft[1] + bottomLeft[1]) / 2, (topLeft[2] + bottomLeft[2]) / 2];
        let vec0 = [degree0[0] - centerPlane[0], degree0[1] - centerPlane[1], degree0[2] - centerPlane[2]];
        let vec270 = [degree270[0] - centerPlane[0], degree270[1] - centerPlane[1], degree270[2] - centerPlane[2]];
        let binsDescription = defineBins(32);
        /**
         * Returns the index of the bin the angle belongs to
         * @param bins Array describing the beginning and end of all bins
         * @param angle angle in radians
         */
        function checkBin(bins, angle) {
            for (let i = 0; i < bins.length - 1; i++) {
                let start = bins[i];
                let end = bins[i + 1];
                if (angle >= start && angle <= end) {
                    return i;
                }
            }
            return -1; // returns -1 if it does not belong to any bin
        }
        let timestepsData = Array(binsDescription.length - 1); // each position stores all timesteps for one bin
        let centroidsInEachBin = Array(binsDescription.length - 1); // stores how many centroids fall into each bin in each timestep
        for (let i = 0; i < timestepsData.length; i++) {
            timestepsData[i] = Array(this._function.length).fill(0);
            centroidsInEachBin[i] = Array(this._function.length).fill(0);
        }
        let centroidsWorldCoords = [];
        let centroidsPixelCoords = [];
        let normalsPixelCoords = [];
        let functionsPerTimeStep = [];
        let functionIndices = [];
        let centerPlanePixel = [width * 8 / 2, height * 8 / 2];
        let anglePerCentroid = [];
        projectedCentroids.forEach((centroid) => {
            functionsPerTimeStep.push(centroid.function);
            functionIndices.push(centroid.functionIndex); // the index of the function so values can be later retrieved from various knots
            centroidsWorldCoords.push(centroid.point[0], centroid.point[1], centroid.point[2]);
            let pixelCoord = [0, 0];
            let normalPointWorld = [centroid.normal[0] + centerPlane[0], centroid.normal[1] + centerPlane[1], centroid.normal[2] + centerPlane[2]];
            let angleNormalPoint = getAnglePoint(vec0, vec270, normalPointWorld, centerPlane);
            let normalPointPixel = [0, 0];
            if (angleNormalPoint != undefined) {
                normalPointPixel = worldToPixel(width, height, angleNormalPoint, euclideanDistance(normalPointWorld, centerPlane), 8);
            }
            let normalPixel = normalize$1([normalPointPixel[0] - centerPlanePixel[0], normalPointPixel[1] - centerPlanePixel[1]]);
            normalsPixelCoords.push(normalPixel[0], normalPixel[1]);
            // let vecCentroid = [centroid.point[0] - centerPlane[0], centroid.point[1] - centerPlane[1], centroid.point[2] - centerPlane[2]];
            // Determine the position of the centroid in relation to the orientation of the radial plot
            // let angle0 = angle(vecCentroid, vec0);
            // let angle270 = angle(vecCentroid, vec270);
            let binIndex = -1;
            let angleCentroid = getAnglePoint(vec0, vec270, centroid.point, centerPlane);
            anglePerCentroid.push(angleCentroid);
            if (angleCentroid != undefined) {
                binIndex = checkBin(binsDescription, radians(angleCentroid));
                pixelCoord = worldToPixel(width, height, angleCentroid, euclideanDistance(centroid.point, centerPlane), 8);
            }
            if (binIndex != -1) { // if the centroid belongs to any of the quadrants
                centroid.function.forEach((value, index) => {
                    timestepsData[binIndex][index] += value;
                    centroidsInEachBin[binIndex][index] += 1;
                });
            }
            centroidsPixelCoords.push(pixelCoord[0], pixelCoord[1]);
        });
        let biggestAvg = -1;
        // taking the avg of all timesteps of each bin
        for (let i = 0; i < timestepsData.length; i++) {
            for (let j = 0; j < timestepsData[i].length; j++) {
                if (centroidsInEachBin[i][j] != 0) {
                    timestepsData[i][j] /= centroidsInEachBin[i][j];
                }
                if (timestepsData[i][j] > biggestAvg) {
                    biggestAvg = timestepsData[i][j];
                }
            }
        }
        let flatTimestepData = [];
        // normalizing the avg of all timesteps of each bin
        for (let i = 0; i < timestepsData.length; i++) {
            for (let j = 0; j < timestepsData[i].length; j++) {
                if (biggestAvg != 0) {
                    timestepsData[i][j] /= biggestAvg;
                }
                flatTimestepData.push(timestepsData[i][j]);
            }
        }
        let plotData;
        if (plotNumber == 0) { // TODO: make radial plot deal with generic data
            plotData = genRadialData([-1, -1, -1, -1, -1, -1, -1, -1], binsDescription, flatTimestepData);
        }
        else {
            plotData = genPlotData(centroidsWorldCoords, centroidsPixelCoords, normalsPixelCoords, functionsPerTimeStep, functionIndices, centerPlane, anglePerCentroid); // generic data format that feed all plot types
        }
        // let texImage = await this.generateCustomTextureFoot(spec, radialData, width, height, plotNumber);
        let texImage = await this.generateCustomTextureFoot(spec, plotData, width, height, 8, plotNumber, specType);
        return { indices: indices, coords: nodes, functionValues: functionValues, image: texImage, code: footprintCode };
    }
    setPickedFoot(cellId, pickingForUpdate) {
        let buildingCoords = [];
        let keepSearching = true;
        for (let i = 0; i < this._cellIdsByCoordinates.length; i++) {
            let compElement = this._cellIdsByCoordinates[i];
            for (let j = 0; j < compElement.length; j++) {
                if (cellId == compElement[j]) {
                    let hasPlot = false;
                    this._footprintCodesPerBuilding.forEach((value) => {
                        if (value.buildingId == i) {
                            hasPlot = true;
                        }
                    });
                    if (pickingForUpdate) {
                        if (hasPlot) { // for the update only proceeds if the building already has a footprint plot
                            this._currentFootprintBuildingId = i;
                            buildingCoords = this.getBuildingCoords(i);
                            this._currentBuildingCoords = buildingCoords;
                            this.calcFootprintCoords(buildingCoords);
                        }
                        else {
                            this._currentFootprintBuildingId = -1;
                            keepSearching = false;
                        }
                    }
                    else {
                        this._currentFootprintBuildingId = i;
                        buildingCoords = this.getBuildingCoords(i);
                        this._currentBuildingCoords = buildingCoords;
                        this.calcFootprintCoords(buildingCoords);
                    }
                    break;
                }
            }
            if (buildingCoords.length > 0 || !keepSearching) { // already found the building or there is no need to keep searching
                break;
            }
        }
    }
    setPickedObject(cellId) {
        let buildingCoords = [];
        let keepSearching = true;
        for (let i = 0; i < this._cellIdsByCoordinates.length; i++) {
            let compElement = this._cellIdsByCoordinates[i];
            for (let j = 0; j < compElement.length; j++) {
                if (cellId == compElement[j]) {
                    this._currentPickedBuildingId = i;
                    buildingCoords = this.getBuildingCoords(i);
                    keepSearching = false;
                    break;
                }
            }
            if (!keepSearching) { // already found the building 
                break;
            }
        }
        if (buildingCoords.length > 0) { // a building was found
            // toggle the highlight in the coordinates of the building
            for (const coordId of buildingCoords) {
                if (this._colorOrPicked[coordId] == 1) {
                    this._colorOrPicked[coordId] = 0;
                }
                else if (this._colorOrPicked[coordId] == 0) {
                    this._colorOrPicked[coordId] = 1;
                }
            }
            this._colorOrPickedDirty = true;
        }
    }
    setHighlightElements(coordinates, value) {
        for (const coordIndex of coordinates) {
            if (value)
                this._colorOrPicked[coordIndex] = 1;
            else
                this._colorOrPicked[coordIndex] = 0;
        }
        this._colorOrPickedDirty = true;
    }
    /**
     * Determines the center and radius of smallest sphere that contains the picked coordinates
     */
    bSpherePickedCoords() {
        let maxX = -1;
        let maxY = -1;
        let maxZ = -1;
        let minX = -1;
        let minY = -1;
        let minZ = -1;
        this._pickedCoordinates.forEach((coordIndex) => {
            let x = this._coords[coordIndex * 3];
            let y = this._coords[coordIndex * 3 + 1];
            let z = this._coords[coordIndex * 3 + 2];
            if (minX == -1) {
                minX = x;
            }
            else if (x < minX) {
                minX = x;
            }
            if (minY == -1) {
                minY = y;
            }
            else if (y < minY) {
                minY = y;
            }
            if (minZ == -1) {
                minZ = z;
            }
            else if (z < minZ) {
                minZ = z;
            }
            if (maxX == -1) {
                maxX = x;
            }
            else if (x > maxX) {
                maxX = x;
            }
            if (maxY == -1) {
                maxY = y;
            }
            else if (y > maxY) {
                maxY = y;
            }
            if (maxZ == -1) {
                maxZ = z;
            }
            else if (z > maxZ) {
                maxZ = z;
            }
        });
        let radius = -1;
        let center = [(minX + maxX) / 2, (minY + maxY) / 2, (minZ + maxZ) / 2];
        this._pickedCoordinates.forEach((coordIndex) => {
            let x = this._coords[coordIndex * 3];
            let y = this._coords[coordIndex * 3 + 1];
            let z = this._coords[coordIndex * 3 + 2];
            let distance = Math.sqrt(Math.pow(x - center[0], 2) + Math.pow(y - center[1], 2) + Math.pow(z - center[2], 2)); // euclidean distance
            if (distance > radius) {
                radius = distance;
            }
        });
        let radiusAdjustingStep = 0.015;
        let radiusAdjustingFactor = 1;
        // adjusting radius according to the number of coordinates
        radiusAdjustingFactor -= (this._pickedCoordinates.length / 3) * radiusAdjustingStep;
        if (radiusAdjustingFactor < 0.15) {
            radiusAdjustingFactor = 0.15;
        }
        return { "center": center, "radius": radius * radiusAdjustingFactor }; // tweak the radius to make it closer or further from the building
    }
    /**
     * Handles the generation of a custom texture defined by the user.
     */
    async generateCustomTexture(spec, specType, data, width, height) {
        // let shadowAvg = 0;
        // this._pickedCoordinates.forEach((coordinateIndex) => {
        //     shadowAvg += this._function[this._functionToUse][coordinateIndex*2];
        // });
        // shadowAvg = shadowAvg/this._pickedCoordinates.length;
        let image;
        if (specType == 'vega') {
            image = await spec.getSurEmbeddedSvg(data, width * 8, height * 8);
        }
        else {
            image = await spec.run(data, width * 8, height * 8, 1);
        }
        return image;
    }
    /**
     * Handles the generation of a custom texture defined by the user.
     */
    // async generateCustomTextureFoot(d3Expec: any, coords: number[], width: number, height: number){
    async generateCustomTextureFoot(spec, data, width, height, conversionFactor, plotNumber, specType) {
        let image;
        if (specType == 'd3') {
            image = await spec.run(data, width * conversionFactor, height * conversionFactor, plotNumber);
        }
        else {
            image = await spec.getFootEmbeddedSvg(data, width * conversionFactor, height * conversionFactor); // grammar manager
        }
        return image;
    }
    /**
     * Defines transformations necessary to make a surface flat having a z = 0 and to undo it
     *
     * @param {boolean} centerPlane center point of the plane
     * @param {boolean} normal the normal of the plane
     *
     */
    absSurfaceTrans(centerPlane, normal) {
        let zRotation;
        let yRotation;
        // calculating do transformation
        // When x(+), y(-) or x(-), y(-)
        if ((normal[0] > 0 && normal[1] < 0) || (normal[0] < 0 && normal[1] < 0)) {
            zRotation = radians(angle([1, 0, 0], [normal[0], normal[1], 0])); // z component does not matter in this rotation
        }
        else if ((normal[0] > 0 && normal[1] > 0) || (normal[0] < 0 && normal[1] > 0)) { // When x(+), y(+) or x(-), y(+)
            zRotation = -1 * radians(angle([1, 0, 0], [normal[0], normal[1], 0])); // z component does not matter in this rotation
        }
        else {
            zRotation = radians(angle([1, 0, 0], [normal[0], normal[1], 0])); // when one of the axis is 0 it does not matter the direction of rotation // z component does not matter in this rotation
        }
        // When x(+), z(-) or x(-), z(-)
        if ((normal[0] > 0 && normal[2] < 0) || (normal[0] < 0 && normal[2] < 0)) {
            yRotation = radians(angle([0, 0, 1], normal));
        }
        else if ((normal[0] > 0 && normal[2] > 0) || (normal[0] < 0 && normal[2] > 0)) { // When x(+), z(+) or x(-), z(+)
            yRotation = -1 * radians(angle([0, 0, 1], normal));
        }
        else {
            yRotation = radians(angle([0, 0, 1], normal)); // when one of the axis is 0 it does not matter the direction of rotation
        }
        let transformations = translateMatrix(-1 * centerPlane[0], -1 * centerPlane[1], -1 * centerPlane[2]); // translate plane to origin
        transformations = multiplyMatrices(rotateZMatrix(zRotation), transformations);
        transformations = multiplyMatrices(rotateYMatrix(yRotation), transformations);
        // calculating undo transformation
        let undoTrans = rotateYMatrix(-1 * yRotation); // undo the Y rotation
        undoTrans = multiplyMatrices(rotateZMatrix(-1 * zRotation), undoTrans); // undo the Z rotation
        undoTrans = multiplyMatrices(translateMatrix(centerPlane[0], centerPlane[1], centerPlane[2]), undoTrans); // translate plane back to original position
        return { "do": transformations, "undo": undoTrans };
    }
    /**
     * Get a flat list of numbers and converts to a column matrix
     * @param {number[]} flatArray flat list of nummbers
     * @param {number} dim number of rows in the matrix
     */
    flatArrayToMatrix(flatArray, dim) {
        let matrix = [];
        for (let i = 0; i < dim; i++) { // one iteration for each row
            let row = [];
            for (let j = 0; j < flatArray.length / dim; j++) {
                row.push(flatArray[j * dim + i]);
            }
            matrix.push(row);
        }
        return matrix;
    }
    async applyTexSelectedCells(camera, spec, specType) {
        /**
         *
         * @param {number[]} point 3D point
         * @param {object} plane Attributes: center (number[]) and unit normal (number[])
         */
        let projectPointOntoPlane = (point, plane) => {
            let v = [point[0] - plane.center[0], point[1] - plane.center[1], point[2] - plane.center[2]]; // vector from plane "center" to the point of interest
            let dist = plane.normal[0] * v[0] + plane.normal[1] * v[1] + plane.normal[2] * v[2]; // scalar distance from point to plane along normal (dot product between v and normal)
            let normalXDist = [plane.normal[0] * dist, plane.normal[1] * dist, plane.normal[2] * dist];
            return [point[0] - normalXDist[0], point[1] - normalXDist[1], point[2] - normalXDist[2]];
        };
        if (this._pickedCoordinates.length == 0) {
            return;
        }
        let abs_surface_indices = [];
        let abs_surface_coords = [];
        let abs_surface_normals = [];
        let abs_surface_function = [];
        let bSphere = this.bSpherePickedCoords();
        let sumNormals = this.sumPickedNormals();
        if (sumNormals.length == 0) {
            return;
        }
        let shiftVector = [sumNormals[0] * bSphere.radius, sumNormals[1] * bSphere.radius, sumNormals[2] * bSphere.radius]; // vector from center of sphere to surface
        let centerPlane = [bSphere.center[0] + shiftVector[0], bSphere.center[1] + shiftVector[1], bSphere.center[2] + shiftVector[2]]; // center of texture plane. This point is tangent to the sphere in the direction of the sumNormals
        let projectedPoints = [];
        this._pickedCoordinates.forEach((coordIndex) => {
            let x = this._coords[coordIndex * 3];
            let y = this._coords[coordIndex * 3 + 1];
            let z = this._coords[coordIndex * 3 + 2];
            let projectedPoint = projectPointOntoPlane([x, y, z], { "center": centerPlane, "normal": sumNormals });
            let projectedX = projectedPoint[0];
            let projectedY = projectedPoint[1];
            let projectedZ = projectedPoint[2];
            projectedPoints.push(projectedX, projectedY, projectedZ);
        });
        let transformations = this.absSurfaceTrans(centerPlane, sumNormals);
        let doTrans = transformations.do;
        let undoTrans = transformations.undo;
        let pointsMatrix = this.flatArrayToMatrix(projectedPoints, 3);
        // one last row with 1's is needed to complete the matrix
        let row = [];
        for (let j = 0; j < projectedPoints.length / 3; j++) {
            row.push(1);
        }
        pointsMatrix.push(row);
        let transformedPoints = multiplyMatrices(doTrans, pointsMatrix);
        // from homogeneous coordinates back to normal
        for (let rowIndex = 0; rowIndex < pointsMatrix.length; rowIndex++) {
            for (let columnIndex = 0; columnIndex < pointsMatrix[0].length; columnIndex++) {
                transformedPoints[rowIndex][columnIndex] = transformedPoints[rowIndex][columnIndex] / transformedPoints[transformedPoints.length - 1][columnIndex];
            }
        }
        let transformedPointsList = []; // each position represents a point
        for (let columnIndex = 0; columnIndex < pointsMatrix[0].length; columnIndex++) {
            let point = [];
            for (let rowIndex = 0; rowIndex < pointsMatrix.length - 1; rowIndex++) { // desconsider last row of homogenous coordinates
                point.push(transformedPoints[rowIndex][columnIndex]);
            }
            transformedPointsList.push(point);
        }
        // definition of the boundaries of the plane
        let maxX = -1;
        let maxY = -1;
        let minX = -1;
        let minY = -1;
        transformedPointsList.forEach((elem) => {
            let x = elem[0];
            let y = elem[1];
            if (minX == -1) {
                minX = x;
            }
            else if (x < minX) {
                minX = x;
            }
            if (minY == -1) {
                minY = y;
            }
            else if (y < minY) {
                minY = y;
            }
            if (maxX == -1) {
                maxX = x;
            }
            else if (x > maxX) {
                maxX = x;
            }
            if (maxY == -1) {
                maxY = y;
            }
            else if (y > maxY) {
                maxY = y;
            }
        });
        let bPlane = [minX, minY, maxX, maxY]; // bounding plane that will receive the texture. After the transformations the bounding plane is parallel to x and y, thus z = 0 to all cordinates
        this._coordsDirty = true;
        this._functionDirty = true;
        this._colorOrPickedDirty = true;
        // Each column is a point
        let nodes = [[bPlane[0], bPlane[2], bPlane[2], bPlane[0]],
            [bPlane[1], bPlane[1], bPlane[3], bPlane[3]],
            [0, 0, 0, 0],
            [1, 1, 1, 1]];
        nodes = multiplyMatrices(undoTrans, nodes);
        // from homogeneous coordinates back to normal
        for (let rowIndex = 0; rowIndex < nodes.length; rowIndex++) {
            for (let columnIndex = 0; columnIndex < nodes[0].length; columnIndex++) {
                nodes[rowIndex][columnIndex] = nodes[rowIndex][columnIndex] / nodes[nodes.length - 1][columnIndex];
            }
        }
        let flat_nodes = [];
        // flattening nodes form number[][] to number[]
        for (let columnIndex = 0; columnIndex < nodes[0].length; columnIndex++) {
            for (let rowIndex = 0; rowIndex < nodes.length - 1; rowIndex++) { // no need to consider the last row used for homogeneous coordinates
                flat_nodes.push(nodes[rowIndex][columnIndex]);
            }
        }
        // TODO dont know if this is the best solution
        if (sumNormals[2] > 0) { // if the normal of the plane is facing top or corner top
            let aux = [flat_nodes[3], flat_nodes[4], flat_nodes[5]]; // coordinate of index 1
            flat_nodes[3] = flat_nodes[9]; // swapping index 1 with 3
            flat_nodes[4] = flat_nodes[10]; // swapping index 1 with 3
            flat_nodes[5] = flat_nodes[11]; // swapping index 1 with 3
            flat_nodes[9] = aux[0]; // swapping index 1 with 4
            flat_nodes[10] = aux[1]; // swapping index 1 with 4
            flat_nodes[11] = aux[2]; // swapping index 1 with 4
        }
        // let indices = [3, 0, 2, 2, 0, 1];
        let indices = [0, 3, 1, 1, 3, 2];
        abs_surface_indices = indices;
        abs_surface_coords = abs_surface_coords.concat(flat_nodes);
        for (let i = 0; i < 4; i++) { // since there is four new coordinates we need four new normals
            abs_surface_normals.push(sumNormals[0]);
            abs_surface_normals.push(sumNormals[1]);
            abs_surface_normals.push(sumNormals[2]);
        }
        let rightVector = camera.getRightVector();
        let upVector = camera.getUpVector();
        let rightPoint = [centerPlane[0] + rightVector[0], centerPlane[1] + rightVector[1], centerPlane[2] + rightVector[2]]; // auxiliary point to represent the right direction
        let upPoint = [centerPlane[0] + upVector[0], centerPlane[1] + upVector[1], centerPlane[2] + upVector[2]]; // auxiliary point to represent the up direction
        let cornerDistances = []; // stores the distance of the corners of the plane to each vector
        let maxMinDistances = []; // stores if the flat_node has a min or max up or right
        for (let i = 0; i < flat_nodes.length / 3; i++) {
            let distanceRight = Math.sqrt(Math.pow(flat_nodes[i * 3] - rightPoint[0], 2) + Math.pow(flat_nodes[i * 3 + 1] - rightPoint[1], 2) + Math.pow(flat_nodes[i * 3 + 2] - rightPoint[2], 2)); // euclidean distance
            let distanceUp = Math.sqrt(Math.pow(flat_nodes[i * 3] - upPoint[0], 2) + Math.pow(flat_nodes[i * 3 + 1] - upPoint[1], 2) + Math.pow(flat_nodes[i * 3 + 2] - upPoint[2], 2)); // euclidean distance
            cornerDistances.push([distanceRight, distanceUp, i]);
            maxMinDistances.push({ minRight: false, minUp: false, maxRight: false, maxUp: false }); // initialize vector with all positions false
        }
        // minUp, maxRight: 0,0
        // minUp, minRight: 1,0
        // maxUp, maxRight: 0,1
        // maxUp, minRight: 1,1
        // sort by crescent order of right distance
        cornerDistances.sort((a, b) => {
            return a[0] - b[0];
        });
        for (let i = 0; i < 4; i++) {
            if (i == 0 || i == 1) {
                maxMinDistances[cornerDistances[i][2]].minRight = true;
            }
            else {
                maxMinDistances[cornerDistances[i][2]].maxRight = true;
            }
        }
        // sort by crescent order of up distance
        cornerDistances.sort((a, b) => {
            return a[1] - b[1];
        });
        for (let i = 0; i < 4; i++) {
            if (i == 0 || i == 1) {
                maxMinDistances[cornerDistances[i][2]].minUp = true;
            }
            else {
                maxMinDistances[cornerDistances[i][2]].maxUp = true;
            }
        }
        let function_sequence = [];
        let sequenceChecker = [0, 0, 0, 0]; // Each position represents one corner of the image and the number, the amount of times that corner was attached to a point 
        maxMinDistances.forEach((elem) => {
            if (elem.minUp && elem.maxRight) {
                sequenceChecker[0] += 1;
                function_sequence.push(0); // 0
                function_sequence.push(0);
            }
            else if (elem.minUp && elem.minRight) {
                sequenceChecker[1] += 1;
                function_sequence.push(1); // 1
                function_sequence.push(0);
            }
            else if (elem.maxUp && elem.maxRight) {
                sequenceChecker[2] += 1;
                function_sequence.push(0); // 0
                function_sequence.push(1);
            }
            else if (elem.maxUp && elem.minRight) {
                sequenceChecker[3] += 1;
                function_sequence.push(1); // 1
                function_sequence.push(1);
            }
        });
        let validSequence = true;
        sequenceChecker.forEach((elem) => {
            if (elem != 1) {
                validSequence = false;
            }
        });
        if (validSequence) {
            abs_surface_function = abs_surface_function.concat(function_sequence);
        }
        else { // backup sequence
            // abs_surface_function = abs_surface_function.concat([0,1, 0,0, 1,0, 1,1]);
            abs_surface_function = abs_surface_function.concat([0, 1, 0, 0, 1, 0, 1, 1]);
        }
        // storing coordinates to calculate euclidean distances
        let topLeft = [];
        let bottomLeft = [];
        let topRight = [];
        // figure out height and width of the surface
        for (let i = 0; i < 4; i++) {
            let value1 = abs_surface_function[i * 2];
            let value2 = abs_surface_function[i * 2 + 1];
            if (value1 == 0 && value2 == 0) {
                topLeft.push(abs_surface_coords[i * 3]);
                topLeft.push(abs_surface_coords[i * 3 + 1]);
                topLeft.push(abs_surface_coords[i * 3 + 2]);
            }
            else if (value1 == 0 && value2 == 1) {
                bottomLeft.push(abs_surface_coords[i * 3]);
                bottomLeft.push(abs_surface_coords[i * 3 + 1]);
                bottomLeft.push(abs_surface_coords[i * 3 + 2]);
            }
            else if (value1 == 1 && value2 == 0) {
                topRight.push(abs_surface_coords[i * 3]);
                topRight.push(abs_surface_coords[i * 3 + 1]);
                topRight.push(abs_surface_coords[i * 3 + 2]);
            }
        }
        let width = Math.sqrt(Math.pow(topLeft[0] - topRight[0], 2) + Math.pow(topLeft[1] - topRight[1], 2) + Math.pow(topLeft[2] - topRight[2], 2));
        let height = Math.sqrt(Math.pow(topLeft[0] - bottomLeft[0], 2) + Math.pow(topLeft[1] - bottomLeft[1], 2) + Math.pow(topLeft[2] - bottomLeft[2], 2));
        // calculate function index. Which is the same thing as index. Also retrieve highligh info.
        let plotDataElements = [];
        this._pickedCoordinates.forEach((coordIndex) => {
            let elem = {};
            elem.index = coordIndex; // considers the geometry level
            elem.functionIndex = coordIndex;
            plotDataElements.push(elem);
        });
        let texImage = await this.generateCustomTexture(spec, specType, JSON.stringify(plotDataElements), width, height);
        this._lastCode += 1;
        this._pickedCoordinates = [];
        return { indices: abs_surface_indices, coords: abs_surface_coords, functionValues: abs_surface_function, image: texImage, code: this._lastCode };
    }
    /**
     * Reset the data structures that keep track of instantiated surfaces
     */
    clearSurfaces() {
        this._footprintPlaneHeightByCoord = [];
        for (let i = 0; i < this._coords.length / 3; i++) {
            this._footprintPlaneHeightByCoord.push(-1.0);
        }
        this._planeHeightDirty = true;
        this._footprintCodesPerBuilding = [];
    }
    /**
     * Calculate the sum of normals of the picked coordinates
     */
    sumPickedNormals() {
        if (this._pickedCoordinates.length == 0) {
            return [];
        }
        let sumNormals = [0, 0, 0];
        this._pickedCoordinates.forEach((indexCoord) => {
            let x = this._normals[indexCoord * 3]; // TODO considering that normals are in 3D (dont know if it is always true)
            let y = this._normals[(indexCoord * 3) + 1];
            let z = this._normals[(indexCoord * 3) + 2];
            sumNormals = [sumNormals[0] + x, sumNormals[1] + y, sumNormals[2] + z];
        });
        let x = sumNormals[0];
        let y = sumNormals[1];
        let z = sumNormals[2];
        // convert result to unit vector
        let nrm = Math.sqrt(x * x + y * y + z * z);
        return [x / nrm, y / nrm, z / nrm];
    }
    renderPass(glContext, glPrimitive, camera, mesh, zOrder) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.enable(glContext.BLEND);
        glContext.blendFunc(glContext.SRC_ALPHA, glContext.ONE_MINUS_SRC_ALPHA);
        glContext.useProgram(this._shaderProgram);
        // binds data
        this.bindUniforms(glContext, camera);
        // was used for the outline
        // glContext.stencilFunc(
        //     glContext.EQUAL,     // the test
        //     0,            // reference value
        //     0xFF,         // mask
        // );
        glContext.stencilFunc(glContext.GEQUAL, // the test
        zOrder, // reference value
        0xFF);
        glContext.stencilOp(glContext.KEEP, // what to do if the stencil test fails
        glContext.KEEP, // what to do if the depth test fails
        glContext.REPLACE);
        this.bindVertexArrayObject(glContext, mesh);
        this.bindTextures(glContext);
        // draw the geometry
        glContext.drawElements(glPrimitive, this._indices.length, glContext.UNSIGNED_INT, 0);
        glContext.disable(glContext.BLEND);
    }
}

var vsAbsSurface = "#version 300 es\nconst float pi=3.1415926535897932384626433832795;const float pi_180=0.017453292519943295769236907684886127134428718885417254560;const float pi_4=12.56637061435917295385057353311801153678867759750042328389;uniform highp mat4 uModelViewMatrix;uniform highp mat4 uProjectionMatrix;uniform highp vec2 uWorldOrigin;in highp vec3 vertCoords;in highp vec2 funcValues;out highp vec2 texCoords;vec2 latLngToPixel(highp float latitude,highp float longitude){highp float sinLatitude=sin(latitude*pi_180);highp float pixelY=256.0-((0.5-log((1.0+sinLatitude)/(1.0-sinLatitude))/(pi_4))*256.0);highp float pixelX=((longitude+180.0)/360.0)*256.0;return vec2(pixelX,pixelY);}void main(){highp vec3 finalPos=vertCoords;texCoords=funcValues;gl_Position=uProjectionMatrix*uModelViewMatrix*vec4(finalPos,1.0);}";

var fsAbsSurface = "#version 300 es\nuniform highp sampler2D u_texture;in highp vec2 texCoords;out highp vec4 fragColor;void main(){fragColor=texture(u_texture,texCoords);if(fragColor==vec4(0,1,0,1)){discard;}}";

class TextureComponent {
    _glContext;
    _texImage = null;
    _htmlImage = null;
    constructor(glContext) {
        this._glContext = glContext;
    }
    get texImage() {
        return this._texImage;
    }
    get htmlImage() {
        return this._htmlImage;
    }
    // load image from html image element
    loadTextureFromHtml(img) {
        this._htmlImage = img;
        this._texImage = this._glContext.createTexture();
        // Now that the image has loaded make copy it to the texture.
        this._glContext.bindTexture(this._glContext.TEXTURE_2D, this._texImage);
        // Set the parameters so we can render any size image.
        this._glContext.texParameteri(this._glContext.TEXTURE_2D, this._glContext.TEXTURE_WRAP_S, this._glContext.CLAMP_TO_EDGE);
        this._glContext.texParameteri(this._glContext.TEXTURE_2D, this._glContext.TEXTURE_WRAP_T, this._glContext.CLAMP_TO_EDGE);
        this._glContext.texParameteri(this._glContext.TEXTURE_2D, this._glContext.TEXTURE_MIN_FILTER, this._glContext.NEAREST);
        this._glContext.texParameteri(this._glContext.TEXTURE_2D, this._glContext.TEXTURE_MAG_FILTER, this._glContext.NEAREST);
        // Upload the image into the texture
        this._glContext.texImage2D(this._glContext.TEXTURE_2D, 0, this._glContext.RGBA, this._glContext.RGBA, this._glContext.UNSIGNED_BYTE, img);
        this._glContext.generateMipmap(this._glContext.TEXTURE_2D);
    }
}

/**
 * This shader should only be used with the buildings layer
 */
class ShaderAbstractSurface extends Shader {
    // Data loaction on GPU
    _glCoords = null;
    _glFunction = null;
    _glIndices = null;
    // Data has chaged
    _coordsDirty = false;
    _functionDirty = false;
    // Id of each property in the VAO
    _coordsId = -1;
    _functionId = -1;
    // Uniforms location
    _uModelViewMatrix = null;
    _uProjectionMatrix = null;
    _uWorldOrigin = null;
    _textureLocation = null;
    // Image textures
    // protected _texComponentsGliphs: TextureComponent[];
    // Surface abstraction
    _absSurfaces = [];
    _currentIndexTexture;
    // Footprint surface
    _footprintSurfaces = [];
    // If a abs surface ("abs") or a footprint plot is being rendered ("foot")
    _currentSurfaceType;
    _filtered = [];
    constructor(glContext) {
        super(vsAbsSurface, fsAbsSurface, glContext);
        // create the shader variables    
        this.createUniforms(glContext);
        this.createVertexArrayObject(glContext);
        this.createTextures();
    }
    /**
     * Get a HTMLImageElement[] containing all the images used in the abstract surfaces
     */
    getAbsSurfacesImages() {
        let images = [];
        this._absSurfaces.forEach((surface) => {
            if (surface.texComponent.htmlImage) {
                images.push(surface.texComponent.htmlImage);
            }
        });
        return images;
    }
    setHighlightElements(coordinates, value) {
        throw Error("The abstract surface shader can not highlight elements");
    }
    // TODO: get income data from a mesh object not a list
    updateShaderGeometry(mesh) {
        let totalNumberOfCoords = mesh.getTotalNumberOfCoords();
        for (let i = 0; i < totalNumberOfCoords; i++) {
            this._filtered.push(1.0); // 1 true to include
        }
    }
    updateShaderData(mesh, knot) {
    }
    updateShaderUniforms(data) {
    }
    createTextures() {
    }
    setFiltered(filtered) {
        if (filtered.length == 0) {
            this._filtered = Array(this._filtered.length).fill(1.0);
        }
        else {
            this._filtered = filtered;
        }
        // this._filteredDirty = true;
    }
    createUniforms(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        this._uModelViewMatrix = glContext.getUniformLocation(this._shaderProgram, 'uModelViewMatrix');
        this._uProjectionMatrix = glContext.getUniformLocation(this._shaderProgram, 'uProjectionMatrix');
        this._uWorldOrigin = glContext.getUniformLocation(this._shaderProgram, 'uWorldOrigin');
        this._textureLocation = glContext.getUniformLocation(this._shaderProgram, "u_texture");
    }
    bindUniforms(glContext, camera) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.uniformMatrix4fv(this._uModelViewMatrix, false, camera.getModelViewMatrix());
        glContext.uniformMatrix4fv(this._uProjectionMatrix, false, camera.getProjectionMatrix());
        glContext.uniform2fv(this._uWorldOrigin, camera.getWorldOrigin());
    }
    bindTextures(glContext) {
        glContext.uniform1i(this._textureLocation, 0); // texture unit 0
        glContext.activeTexture(glContext.TEXTURE0);
        let surfaces = [];
        if (this._currentSurfaceType == "abs") {
            surfaces = this._absSurfaces;
        }
        else if (this._currentSurfaceType == "foot") {
            surfaces = this._footprintSurfaces;
        }
        else {
            throw new Error("Type " + this._currentSurfaceType + " does not exist");
        }
        let texComponent = surfaces[this._currentIndexTexture].texComponent;
        glContext.bindTexture(glContext.TEXTURE_2D, texComponent.texImage);
    }
    createVertexArrayObject(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        // Creates the coords id.
        this._coordsId = glContext.getAttribLocation(this._shaderProgram, 'vertCoords');
        // Create a buffer for the positions.
        this._glCoords = glContext.createBuffer();
        // Creates the function id.
        this._functionId = glContext.getAttribLocation(this._shaderProgram, 'funcValues');
        this._glFunction = glContext.createBuffer();
        // Creates the elements buffer
        this._glIndices = glContext.createBuffer();
    }
    bindVertexArrayObject(glContext, mesh) {
        if (!this._shaderProgram) {
            return;
        }
        let surfaces = [];
        if (this._currentSurfaceType == "abs") {
            surfaces = this._absSurfaces;
        }
        else if (this._currentSurfaceType == "foot") {
            surfaces = this._footprintSurfaces;
        }
        else {
            throw new Error("Type " + this._currentSurfaceType + " does not exist");
        }
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glCoords);
        // send data to gpu
        glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(surfaces[this._currentIndexTexture].coords), glContext.STATIC_DRAW);
        // binds the VAO
        glContext.vertexAttribPointer(this._coordsId, mesh.dimension, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._coordsId);
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glFunction);
        // send data to gpu
        glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(surfaces[this._currentIndexTexture].functionValues), glContext.STATIC_DRAW);
        glContext.vertexAttribPointer(this._functionId, 2, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._functionId);
        // binds the indices buffer
        glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndices);
        // send data to g4pu
        glContext.bufferData(glContext.ELEMENT_ARRAY_BUFFER, new Uint32Array(surfaces[this._currentIndexTexture].indices), glContext.STATIC_DRAW);
    }
    /**
     *
     * @param glContext WebGL context
     * @param image HTMLImageElement for the surface texture
     * @param coords coordinates of the four corners of the surface
     * @param indices indices of the triangles of the surface
     * @param functionValues texture coordinates
     * @param type "abs" for abstract surfaces, "foot" for footprint plot
     * @param code a unique code that identify the surface
     */
    addSurface(glContext, image, coords, indices, functionValues, type = "abs", code) {
        let newTextureComponent = new TextureComponent(glContext);
        newTextureComponent.loadTextureFromHtml(image);
        if (type == "abs") {
            this._absSurfaces.push({ indices: indices, coords: coords, functionValues: functionValues, texComponent: newTextureComponent, code: code });
        }
        else if (type == "foot") {
            this._footprintSurfaces.push({ indices: indices, coords: coords, functionValues: functionValues, texComponent: newTextureComponent, code: code });
        }
        else {
            throw new Error("Type " + type + " does not exist");
        }
    }
    /**
     * Updates the a specific surface previouly created
     *
     * @param glContext WebGL context
     * @param image HTMLImageElement for the surface texture
     * @param coords coordinates of the four corners of the surface
     * @param indices indices of the triangles of the surface
     * @param functionValues texture coordinates
     * @param type "abs" for abstract surfaces, "foot" for footprint plot
     * @param code a unique code that identify the surface
     */
    updateSurface(glContext, image, coords, indices, functionValues, type = "abs", code) {
        let surfaces = [];
        let newTextureComponent = new TextureComponent(glContext);
        newTextureComponent.loadTextureFromHtml(image);
        if (type == "abs") {
            surfaces = this._absSurfaces;
        }
        else if (type == "foot") {
            surfaces = this._footprintSurfaces;
        }
        for (let i = 0; i < surfaces.length; i++) {
            if (surfaces[i].code == code) {
                surfaces[i] = { indices: indices, coords: coords, functionValues: functionValues, texComponent: newTextureComponent, code: code };
            }
        }
    }
    clearSurfaces() {
        this.clearFootprintPlots();
        this.clearAbsSurfaces();
    }
    clearFootprintPlots() {
        this._footprintSurfaces = [];
    }
    clearAbsSurfaces() {
        this._absSurfaces = [];
    }
    renderPass(glContext, glPrimitive, camera, mesh, zOrder) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.useProgram(this._shaderProgram);
        this.bindUniforms(glContext, camera);
        glContext.stencilFunc(glContext.ALWAYS, // the test
        2, // reference value
        0xFF);
        glContext.stencilOp(glContext.KEEP, // what to do if the stencil test fails
        glContext.KEEP, // what to do if the depth test fails
        glContext.REPLACE);
        // render footprint plots first
        for (let i = 0; i < this._footprintSurfaces.length; i++) {
            // binds data
            this._currentIndexTexture = i; // used in bindVertexArrayObject and bindTextures (bypassing function signature defined in shader.ts)
            this._currentSurfaceType = "foot";
            this.bindVertexArrayObject(glContext, mesh);
            this.bindTextures(glContext);
            // draw the geometry
            glContext.drawElements(glPrimitive, 6, glContext.UNSIGNED_INT, 0); // each surface has 6 indices elements
        }
        // // Only passes when stencil == 0 (there is no abstract surface)
        glContext.stencilFunc(glContext.EQUAL, // the test
        0, // reference value
        0xFF);
        glContext.stencilOp(glContext.KEEP, // what to do if the stencil test fails
        glContext.KEEP, // what to do if the depth test fails
        glContext.KEEP);
        // render the surfaces later
        for (let i = 0; i < this._absSurfaces.length; i++) {
            // binds data
            this._currentIndexTexture = i; // used in bindVertexArrayObject and bindTextures (bypassing function signature defined in shader.ts)
            this._currentSurfaceType = "abs";
            this.bindVertexArrayObject(glContext, mesh);
            this.bindTextures(glContext);
            // draw the geometry
            glContext.drawElements(glPrimitive, 6, glContext.UNSIGNED_INT, 0); // each surface has 6 indices elements
        }
    }
}

class Environment {
    // App environment parameters
    static backend = 'localhost';
    // public static dataFolder = '../data'
    /**
     * Set environment parameters
     * @param {{backend: string}} env Environment parameters
     */
    // public static setEnvironment(env: {backend: string, dataFolder: string}): void {
    static setEnvironment(env) {
        Environment.backend = env.backend;
        // Environment.dataFolder = env.dataFolder;
    }
}

class DataLoader {
    /**
     * Loads a json file
     * @param {string} url json file url
     * @returns {Promise<unknown>} The load json promise
     */
    static async getJsonData(url) {
        function parseFile(file, callback) {
            var fileSize = file.size;
            var chunkSize = 64 * 1024; // bytes
            var offset = 0;
            // var self:any = this; // we need a reference to the current object
            var chunkReaderBlock = null;
            var readEventHandler = function (evt) {
                if (evt.target.error == null) {
                    offset += evt.target.result.length;
                    callback.add(evt.target.result); // callback for handling read chunk
                }
                else {
                    console.log("Read error: " + evt.target.error);
                    return;
                }
                if (offset >= fileSize) {
                    callback.done(undefined);
                    return;
                }
                // of to the next chunk
                chunkReaderBlock(offset, chunkSize, file);
            };
            chunkReaderBlock = function (_offset, length, _file) {
                var r = new FileReader();
                var blob = _file.slice(_offset, length + _offset);
                r.onload = readEventHandler;
                r.readAsText(blob);
            };
            // now let's start the read with the first block
            chunkReaderBlock(offset, chunkSize, file);
        }
        // Return a new promise.
        const response = await fetch(url, {
            headers: {
                'Accept-Encoding': 'gzip',
                'Accept': 'application/json'
            }
        });
        if (!response.ok) {
            return null;
        }
        let json = {};
        let jsonString = '';
        const contentEncoding = response.headers.get('Content-Encoding');
        if (contentEncoding && contentEncoding.includes('gzip')) { // if the response is encoded
            const blob = await response.blob();
            await new Promise((resolve, reject) => {
                const addFunc = (value) => {
                    jsonString += value;
                };
                parseFile(blob, { add: addFunc, done: resolve }); // Read in chunks
            });
            json = JSON.parse(jsonString);
        }
        else {
            json = await response.json();
        }
        return json;
    }
    static async getBinaryData(url, type) {
        function readFile(blob) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => {
                    resolve(reader.result);
                };
                reader.onerror = reject;
                reader.readAsArrayBuffer(blob);
            });
        }
        // Return a new promise.
        const response = await fetch(url, {
            headers: {
                'Accept-Encoding': 'gzip'
            }
        });
        if (!response.ok)
            throw Error("Loading binary data failed");
        const blob = await response.blob();
        let arrayResult = await readFile(blob);
        if (type == 'f') {
            return new Float32Array(arrayResult);
        }
        if (type == 'd') {
            return new Float64Array(arrayResult);
        }
        if (type == 'I') {
            return new Uint32Array(arrayResult);
        }
        return null;
    }
    /**
     * Loads a text file
     * @param {string} url text file url
     * @returns {Promise<string>} The load text promise
     */
    static async getTextData(url) {
        // Return a new promise.
        const response = await fetch(url);
        const txt = await response.text();
        return txt;
    }
}

class DataApi {
    /**
     * Load all layers
     * @param {string} index The layers index file
     */
    static async getMapData(index) {
        const url = `${Environment.backend}/files/${index}`;
        const datasets = await DataLoader.getJsonData(url);
        return datasets;
    }
    /**
     * Load a custom style
     * @param {string} style The style file
     */
    static async getCustomStyle(style) {
        const url = `${Environment.backend}/files/${style}.json`;
        const custom = await DataLoader.getJsonData(url);
        return custom;
    }
    /**
     * Load the camera
     * @param {string} camera The camera file
     */
    static async getCameraParameters(camera) {
        const url = `${Environment.backend}/files/${camera}.json`;
        const params = await DataLoader.getJsonData(url);
        return params;
    }
    /**
     * Gets the layer data
     * @param {string} layerId the layer data
     */
    static async getLayer(layerId) {
        const url_base = `${Environment.backend}/files/${layerId}.json`;
        const url_coordinates = `${Environment.backend}/files/${layerId}_coordinates.data`;
        const url_indices = `${Environment.backend}/files/${layerId}_indices.data`;
        const url_normals = `${Environment.backend}/files/${layerId}_normals.data`;
        const url_ids = `${Environment.backend}/files/${layerId}_ids.data`;
        const base_feature = await DataLoader.getJsonData(url_base);
        let coordinates;
        let indices;
        let normals;
        let ids;
        if (base_feature.data != undefined) {
            if (base_feature.data[0].geometry.coordinates != undefined) {
                console.log(url_coordinates);
                coordinates = await DataLoader.getBinaryData(url_coordinates, 'd');
            }
            if (base_feature.data[0].geometry.indices != undefined) {
                console.log(url_indices);
                indices = await DataLoader.getBinaryData(url_indices, 'I');
            }
            if (base_feature.data[0].geometry.normals != undefined) {
                console.log(url_normals);
                normals = await DataLoader.getBinaryData(url_normals, 'f');
            }
            if (base_feature.data[0].geometry.ids != undefined) {
                console.log(url_ids);
                ids = await DataLoader.getBinaryData(url_ids, 'I');
            }
            for (let i = 0; i < base_feature.data.length; i++) {
                if (coordinates != undefined) {
                    let startAndSize = base_feature.data[i].geometry.coordinates;
                    base_feature.data[i].geometry.coordinates = Array.from(coordinates.slice(startAndSize[0], startAndSize[0] + startAndSize[1]));
                }
                if (indices != undefined) {
                    let startAndSize = base_feature.data[i].geometry.indices;
                    base_feature.data[i].geometry.indices = Array.from(indices.slice(startAndSize[0], startAndSize[0] + startAndSize[1]));
                }
                if (normals != undefined) {
                    let startAndSize = base_feature.data[i].geometry.normals;
                    base_feature.data[i].geometry.normals = Array.from(normals.slice(startAndSize[0], startAndSize[0] + startAndSize[1]));
                }
                if (ids != undefined) {
                    let startAndSize = base_feature.data[i].geometry.ids;
                    base_feature.data[i].geometry.ids = Array.from(ids.slice(startAndSize[0], startAndSize[0] + startAndSize[1]));
                }
            }
        }
        return base_feature;
    }
    /**
     * Gets the layer data
     * @param {string} layerId the layer data
     */
    static async getLayerFeature(layerId) {
        const url = `${Environment.backend}/files/${layerId}.json`;
        const feature = await DataLoader.getJsonData(url);
        return feature;
    }
    /**
     * Gets the layer function
     * @param {string} layerId the layer data
     */
    static async getLayerFunction(layerId) {
        // TODO
        const url = `${Environment.backend}/files/${layerId}.json`;
        const feature = await DataLoader.getJsonData(url);
        return feature;
    }
    /**
     * Gets the layer function
     * @param {string} layerId the layer data
     */
    static async getLayerHighlight(layerId) {
        // TODO
        const url = `${Environment.backend}/files/${layerId}.json`;
        const feature = await DataLoader.getJsonData(url);
        return feature;
    }
    static async getJoinedJson(layerId) {
        const url = `${Environment.backend}/files/${layerId + "_joined"}.json`;
        const joinedJson = await DataLoader.getJsonData(url);
        return joinedJson;
    }
}

var land$1 = "#F6F6F4";
var roads$1 = "#FFFFFF";
var parks$1 = "#cccccd";
var water$1 = "#cad2d4";
var sky$1 = "#FFFFFF";
var building$1 = "#DFDFDF";
var light$1 = {
	land: land$1,
	roads: roads$1,
	parks: parks$1,
	water: water$1,
	sky: sky$1,
	building: building$1
};

var land = "#343331";
var roads = "#454545";
var parks = "#191b1a";
var water = "#191b1a";
var sky = "#000000";
var building = "#DFDFDF";
var dark$1 = {
	land: land,
	roads: roads,
	parks: parks,
	water: water,
	sky: sky,
	building: building
};

class MapStyle {
    // default color map
    static default = {
        land: '#DFDFDF',
        roads: '#d9b504',
        parks: '#C3D0B2',
        water: '#BED2D7',
        sky: '#ffffff',
        building: '#DFDFDF'
    };
    // sky: '#BED2D7',
    // default color for unknown layers
    static notFound = "#FFFFFF";
    // default highlight color
    static highlight = "#FFDD00";
    // custom style
    static custom = MapStyle.default;
    /**
     * Converts from hex colors to rgb colors
     * @param hex
     * @returns
     */
    static hexToRgb(hex) {
        const str = hex.slice(1, 7);
        const rgb = [0, 2, 4].map((start) => {
            return parseInt(str.slice(start, start + 2), 16) / 255;
        });
        return rgb;
    }
    /**
     * Get the feature color
     * @param {string} type Feature type
     */
    static getColor(type) {
        // uses the default style if available
        const style = MapStyle.custom || MapStyle.default;
        const hex = style[type] || MapStyle.notFound;
        return MapStyle.hexToRgb(hex);
    }
    /**
     * Set the feature color
     * @param {any} style new map style in id: #rrggbb format
     */
    // @ts-ignore
    static async setColor(style) {
        let styleObj = MapStyle.default;
        if (typeof style === 'string' && style === 'light') {
            // @ts-ignore
            styleObj = light$1;
        }
        else if (typeof style === 'string' && style === 'dark') {
            // @ts-ignore
            styleObj = dark$1;
        }
        else if (typeof style === 'string') {
            // Load style from path
            const custom = await DataApi.getCustomStyle(style);
            styleObj = custom;
        }
        else {
            styleObj = style;
        }
        MapStyle.custom = styleObj;
    }
    static getHighlightColor() {
        return MapStyle.hexToRgb(MapStyle.highlight);
    }
}

var vsPicking$1 = "#version 300 es\nconst float pi=3.1415926535897932384626433832795;const float pi_180=0.017453292519943295769236907684886127134428718885417254560;const float pi_4=12.56637061435917295385057353311801153678867759750042328389;uniform highp mat4 uModelViewMatrix;uniform highp mat4 uProjectionMatrix;uniform highp vec2 uWorldOrigin;in highp vec3 vertCoords;in highp vec4 cellIds;out highp vec4 idColors;vec2 latLngToPixel(highp float latitude,highp float longitude){highp float sinLatitude=sin(latitude*pi_180);highp float pixelY=256.0-((0.5-log((1.0+sinLatitude)/(1.0-sinLatitude))/(pi_4))*256.0);highp float pixelX=((longitude+180.0)/360.0)*256.0;return vec2(pixelX,pixelY);}void main(){highp vec3 finalPos=vertCoords;idColors=cellIds;gl_Position=uProjectionMatrix*uModelViewMatrix*vec4(finalPos,1.0);}";

var fsPicking$1 = "#version 300 es\nin highp vec4 idColors;out highp vec4 fragColor;void main(){fragColor=idColors;}";

/**
 * This shader should only be used with the buildings layer
 */
class ShaderPicking extends Shader {
    // Data to be rendered
    _coords = [];
    _indices = [];
    _cellIds = [];
    // Data loaction on GPU
    _glCoords = null;
    _glIndices = null;
    _glCellIds = null;
    // Data has chaged
    _coordsDirty = false;
    _cellIdsDirty = false;
    _resizeDirty = true;
    _clickDirty = false;
    _pickFilterDirty = false;
    _footDirty = false;
    _pickObjectDirty = false;
    _pickingForUpdate = false;
    // Id of each property in the VAO
    _coordsId = -1;
    _cellIdsId = -1;
    // Uniforms location
    _uModelViewMatrix = null;
    _uProjectionMatrix = null;
    _uWorldOrigin = null;
    _uColorMap = null;
    // Texture to support picking
    _texPicking = null;
    _depthBuffer = null;
    _frameBuffer = null;
    // Picking positions
    _pixelX;
    _pixelY;
    _pixelXFilter;
    _pixelYFilter;
    _pickingWidth;
    _pickingHeight;
    _pickingFilterWidth;
    _pickingFilterHeight;
    _selectedFiltered; // ids of elements selected by the user to build the filtering bbox
    _cellIdsByCoordinates = []; // stores the cell id of each coordinate grouped by mesh component
    // Footprint picking position
    _footPixelX;
    _footPixelY;
    _currentPickedFoot;
    _filtered = []; // coordinates to disconsider in further interactions
    _objectPixelX;
    _objectPixelY;
    _pickedCells = new Set();
    _currentPickedCells = new Set(); // store the current brushed cells while the brushing is still happening
    _auxiliaryShader;
    _coordsPerComp;
    /**
     *
     * @param {AuxiliaryShader} auxiliaryShader The shader responsible for receiving picking data
     */
    constructor(glContext, auxiliaryShader) {
        super(vsPicking$1, fsPicking$1, glContext);
        this._auxiliaryShader = auxiliaryShader;
        // creathe the shader variables    
        this.createUniforms(glContext);
        this.createVertexArrayObject(glContext);
        this.createTextures(glContext);
    }
    /**
     * Sets the resize dirty information
     */
    set resizeDirty(resizeDirty) {
        this._resizeDirty = resizeDirty;
    }
    get selectedFiltered() {
        return this._selectedFiltered;
    }
    updateShaderGeometry(mesh) {
        this._coordsDirty = true;
        this._cellIdsDirty = true;
        this._coords = mesh.getCoordinatesVBO();
        this._indices = mesh.getIndicesVBO();
        this._coordsPerComp = mesh.getCoordsPerComp();
        this._cellIds = [];
        this._cellIdsByCoordinates = mesh.getIdsCoordinates();
        this._auxiliaryShader.setIdsCoordinates(this._cellIdsByCoordinates);
        for (const componentElem of this._cellIdsByCoordinates) {
            for (const elem of componentElem) {
                this._cellIds.push(((elem >> 0) & 0xFF) / 0xFF);
                this._cellIds.push(((elem >> 8) & 0xFF) / 0xFF);
                this._cellIds.push(((elem >> 16) & 0xFF) / 0xFF);
                this._cellIds.push(((elem >> 24) & 0xFF) / 0xFF);
            }
        }
        let totalNumberOfCoords = mesh.getTotalNumberOfCoords();
        for (let i = 0; i < totalNumberOfCoords; i++) {
            this._filtered.push(1.0); // 1 true to include
        }
    }
    setFiltered(filtered) {
        if (filtered.length == 0) {
            this._filtered = Array(this._filtered.length).fill(1.0);
        }
        else {
            this._filtered = filtered;
        }
        // this._filteredDirty = true;
    }
    updatePickPosition(pixelX, pixelY, width, height) {
        this._clickDirty = true;
        this._pixelX = pixelX;
        this._pixelY = pixelY;
        if (width == 0) {
            this._pickingWidth = 1;
        }
        else {
            this._pickingWidth = width;
        }
        if (height == 0) {
            this._pickingHeight = 1;
        }
        else {
            this._pickingHeight = height;
        }
    }
    updatePickFilterPosition(pixelX, pixelY, width, height) {
        this._pickFilterDirty = true;
        this._pixelXFilter = pixelX;
        this._pixelYFilter = pixelY;
        if (width == 0) {
            this._pickingFilterWidth = 1;
        }
        else {
            this._pickingFilterWidth = width;
        }
        if (height == 0) {
            this._pickingFilterHeight = 1;
        }
        else {
            this._pickingFilterHeight = height;
        }
    }
    /**
     *
     * @param pixelX
     * @param pixelY
     * @param update indicates if this picking is for creating a new plot or updating
     */
    updateFootPosition(pixelX, pixelY, update) {
        this._footDirty = true;
        this._footPixelX = pixelX;
        this._footPixelY = pixelY;
        this._pickingForUpdate = update;
    }
    // when the brushing action ended
    applyBrushing() {
        for (const id of Array.from(this._currentPickedCells)) {
            this._pickedCells.add(id);
        }
        this._currentPickedCells = new Set();
    }
    isFilteredIn(objectId) {
        if (this._filtered.length == 0) {
            return true;
        }
        else {
            let readCoords = 0;
            for (let i = 0; i < this._coordsPerComp.length; i++) {
                let countCoords = this._coordsPerComp[i];
                if (i == objectId) {
                    if (this._filtered[readCoords] == 1) {
                        return true;
                    }
                    else {
                        return false;
                    }
                }
                readCoords += countCoords;
            }
        }
        return false;
    }
    pickPixel(glContext) {
        const data = new Uint8Array(Math.ceil(Math.abs(this._pickingHeight) * Math.abs(this._pickingWidth) * 4));
        for (let i = 0; i < data.length; i++) { // initializing data array with 255 to recognize not used positions
            data[i] = 255;
        }
        glContext.readPixels(this._pixelX, // x
        this._pixelY, // y
        this._pickingWidth, // width
        this._pickingHeight, // height
        glContext.RGBA, // format
        glContext.UNSIGNED_BYTE, // type
        data); // typed array to hold result
        let ids = new Set();
        let dataByFour = Math.floor(data.length / 4);
        for (let i = 0; i < dataByFour; i++) {
            if (data[i * 4] == 255 && data[i * 4 + 1] == 255 && data[i * 4 + 2] == 255 && data[i * 4 + 3] == 255) { // some portions of the data array are not used
                continue;
            }
            else {
                ids.add(data[i * 4] + (data[i * 4 + 1] << 8) + (data[i * 4 + 2] << 16) + (data[i * 4 + 3] << 24));
            }
        }
        this._currentPickedCells = new Set();
        let arrayFromIds = Array.from(ids);
        for (const id of arrayFromIds) {
            let idBuildingLevel = this.objectFromCell(id);
            if (this.isFilteredIn(idBuildingLevel)) { // it is filtered in, therefore can interact
                this._currentPickedCells.add(id);
            }
        }
        this._auxiliaryShader.setPickedCells(new Set([...Array.from(this._pickedCells), ...Array.from(this._currentPickedCells)]));
    }
    getBboxFiltered(mesh) {
        let coordsPerComp = mesh.getCoordsPerComp();
        let minX = null;
        let minY = null;
        let maxX = null;
        let maxY = null;
        let readCoords = 0;
        for (let i = 0; i < coordsPerComp.length; i++) {
            if (this._selectedFiltered.includes(i)) {
                for (let j = 0; j < coordsPerComp[i]; j++) {
                    let x = this._coords[(readCoords + j) * mesh.dimension];
                    let y = this._coords[(readCoords + j) * mesh.dimension + 1];
                    if (minX == null) {
                        minX = x;
                    }
                    else if (x < minX) {
                        minX = x;
                    }
                    if (minY == null) {
                        minY = y;
                    }
                    else if (y < minY) {
                        minY = y;
                    }
                    if (maxX == null) {
                        maxX = x;
                    }
                    else if (x > maxX) {
                        maxX = x;
                    }
                    if (maxY == null) {
                        maxY = y;
                    }
                    else if (y > maxY) {
                        maxY = y;
                    }
                }
            }
            readCoords += coordsPerComp[i];
        }
        if (minX == null) {
            minX = 0;
        }
        if (minY == null) {
            minY = 0;
        }
        if (maxX == null) {
            maxX = 0;
        }
        if (maxY == null) {
            maxY = 0;
        }
        return [minX, minY, maxX, maxY];
    }
    objectFromCell = (cellId) => {
        for (let i = 0; i < this._cellIdsByCoordinates.length; i++) {
            let compElement = this._cellIdsByCoordinates[i];
            for (let j = 0; j < compElement.length; j++) {
                if (cellId == compElement[j]) {
                    return i;
                }
            }
        }
        return -1;
    };
    pickPixelFilter(glContext) {
        const data = new Uint8Array(Math.ceil(Math.abs(this._pickingFilterHeight) * Math.abs(this._pickingFilterWidth) * 4));
        for (let i = 0; i < data.length; i++) { // initializing data array with 255 to recognize not used positions
            data[i] = 255;
        }
        glContext.readPixels(this._pixelXFilter, // x
        this._pixelYFilter, // y
        this._pickingFilterWidth, // width
        this._pickingFilterHeight, // height
        glContext.RGBA, // format
        glContext.UNSIGNED_BYTE, // type
        data); // typed array to hold result
        let ids = new Set();
        let dataByFour = Math.floor(data.length / 4);
        for (let i = 0; i < dataByFour; i++) {
            if (data[i * 4] == 255 && data[i * 4 + 1] == 255 && data[i * 4 + 2] == 255 && data[i * 4 + 3] == 255) { // some portions of the data array are not used
                continue;
            }
            else {
                ids.add(data[i * 4] + (data[i * 4 + 1] << 8) + (data[i * 4 + 2] << 16) + (data[i * 4 + 3] << 24));
            }
        }
        let idsBuildingsLevel = new Set();
        let idsArray = Array.from(ids);
        for (const id of idsArray) {
            idsBuildingsLevel.add(this.objectFromCell(id));
        }
        this._selectedFiltered = Array.from(idsBuildingsLevel);
    }
    pickFoot(glContext) {
        const data = new Uint8Array(4);
        glContext.readPixels(this._footPixelX, // x
        this._footPixelY, // y
        1, // width
        1, // height
        glContext.RGBA, // format
        glContext.UNSIGNED_BYTE, // type
        data); // typed array to hold result
        let id = data[0] + (data[1] << 8) + (data[2] << 16) + (data[3] << 24);
        let idBuildingLevel = this.objectFromCell(id);
        if (this.isFilteredIn(idBuildingLevel)) { // filtered in, therefore can be interacted
            this._currentPickedFoot = id;
            this._auxiliaryShader.setPickedFoot(this._currentPickedFoot, this._pickingForUpdate);
        }
    }
    pickObject(glContext) {
        const data = new Uint8Array(4);
        glContext.readPixels(this._objectPixelX, // x
        this._objectPixelY, // y
        1, // width
        1, // height
        glContext.RGBA, // format
        glContext.UNSIGNED_BYTE, // type
        data); // typed array to hold result
        let id = data[0] + (data[1] << 8) + (data[2] << 16) + (data[3] << 24);
        let idBuildingLevel = this.objectFromCell(id);
        if (this.isFilteredIn(idBuildingLevel)) { // filtered in, therefore can be interacted
            this._auxiliaryShader.setPickedObject(id);
        }
    }
    updatePickObjectPosition(pixelX, pixelY) {
        this._pickObjectDirty = true;
        this._objectPixelX = pixelX;
        this._objectPixelY = pixelY;
    }
    clearPicking() {
        this._currentPickedCells = new Set();
        this._pickedCells = new Set();
        this._auxiliaryShader.setPickedCells(this._pickedCells);
    }
    updateShaderData(mesh, knot) {
        return;
    }
    updateShaderUniforms(data) {
        return;
    }
    setHighlightElements(coordinates, value) {
        this._auxiliaryShader.setHighlightElements(coordinates, value);
    }
    createUniforms(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        this._uModelViewMatrix = glContext.getUniformLocation(this._shaderProgram, 'uModelViewMatrix');
        this._uProjectionMatrix = glContext.getUniformLocation(this._shaderProgram, 'uProjectionMatrix');
        this._uWorldOrigin = glContext.getUniformLocation(this._shaderProgram, 'uWorldOrigin');
        // this._textureLocation = glContext.getUniformLocation(this._shaderProgram, "u_texture");
    }
    bindUniforms(glContext, camera) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.uniformMatrix4fv(this._uModelViewMatrix, false, camera.getModelViewMatrix());
        glContext.uniformMatrix4fv(this._uProjectionMatrix, false, camera.getProjectionMatrix());
        glContext.uniform2fv(this._uWorldOrigin, camera.getWorldOrigin());
    }
    setFramebufferAttachmentSizes(glContext, width, height) {
        glContext.bindTexture(glContext.TEXTURE_2D, this._texPicking);
        // define size and format of level 0
        const level = 0;
        const internalFormat = glContext.RGBA;
        const border = 0;
        const format = glContext.RGBA;
        const type = glContext.UNSIGNED_BYTE;
        const data = null;
        glContext.texImage2D(glContext.TEXTURE_2D, level, internalFormat, width, height, border, format, type, data);
        glContext.bindRenderbuffer(glContext.RENDERBUFFER, this._depthBuffer);
        glContext.renderbufferStorage(glContext.RENDERBUFFER, glContext.DEPTH_COMPONENT16, width, height);
    }
    createTextures(glContext) {
        // Create a texture to render to
        this._texPicking = glContext.createTexture();
        glContext.bindTexture(glContext.TEXTURE_2D, this._texPicking);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.LINEAR);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);
        // create a depth renderbuffer
        this._depthBuffer = glContext.createRenderbuffer();
        glContext.bindRenderbuffer(glContext.RENDERBUFFER, this._depthBuffer);
        // Create and bind the framebuffer
        this._frameBuffer = glContext.createFramebuffer();
        glContext.bindFramebuffer(glContext.FRAMEBUFFER, this._frameBuffer);
        // attach the texture as the first color attachment
        const attachmentPoint = glContext.COLOR_ATTACHMENT0;
        const level = 0;
        glContext.framebufferTexture2D(glContext.FRAMEBUFFER, attachmentPoint, glContext.TEXTURE_2D, this._texPicking, level);
        glContext.framebufferRenderbuffer(glContext.FRAMEBUFFER, glContext.DEPTH_ATTACHMENT, glContext.RENDERBUFFER, this._depthBuffer);
        glContext.bindFramebuffer(glContext.FRAMEBUFFER, null);
    }
    bindTextures(glContext) {
        glContext.bindFramebuffer(glContext.FRAMEBUFFER, this._frameBuffer);
    }
    createVertexArrayObject(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        // Creates the coords id.
        this._coordsId = glContext.getAttribLocation(this._shaderProgram, 'vertCoords');
        // Create a buffer for the positions.
        this._glCoords = glContext.createBuffer();
        this._cellIdsId = glContext.getAttribLocation(this._shaderProgram, 'cellIds');
        this._glCellIds = glContext.createBuffer();
        // Creates the elements buffer
        this._glIndices = glContext.createBuffer();
    }
    bindVertexArrayObject(glContext, mesh) {
        if (!this._shaderProgram) {
            return;
        }
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glCoords);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._coords), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._coordsId, mesh.dimension, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._coordsId);
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glCellIds);
        // send data to gpu
        if (this._cellIdsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._cellIds), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._cellIdsId, 4, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._cellIdsId);
        // binds the indices buffer
        glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndices);
        // send data to g4pu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ELEMENT_ARRAY_BUFFER, new Uint32Array(this._indices), glContext.STATIC_DRAW);
        }
        // this._colorOrTexDirty = false;
        this._coordsDirty = false;
        this._cellIdsDirty = false;
        // this._functionDirty = false;
    }
    renderPass(glContext, glPrimitive, camera, mesh, zOrder) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.useProgram(this._shaderProgram);
        if (this._resizeDirty) {
            this.setFramebufferAttachmentSizes(glContext, glContext.canvas.width, glContext.canvas.height);
            this._resizeDirty = false;
        }
        // binds data
        this.bindTextures(glContext);
        this.bindUniforms(glContext, camera);
        this.bindVertexArrayObject(glContext, mesh);
        // draw the geometry
        glContext.drawElements(glPrimitive, this._indices.length, glContext.UNSIGNED_INT, 0);
        if (this._pickFilterDirty) {
            this.pickPixelFilter(glContext);
            this._pickFilterDirty = false;
        }
        if (this._clickDirty) {
            this.pickPixel(glContext);
            this._clickDirty = false;
        }
        if (this._footDirty) {
            this.pickFoot(glContext);
            this._footDirty = false;
            this._pickingForUpdate = false;
        }
        if (this._pickObjectDirty) {
            this.pickObject(glContext);
            this._pickObjectDirty = false;
        }
        MapStyle.getColor('sky').concat([1.0]);
        let blankColorRGBA = [];
        blankColorRGBA.push(255);
        blankColorRGBA.push(255);
        blankColorRGBA.push(255);
        blankColorRGBA.push(255);
        glContext.clearColor(blankColorRGBA[0], blankColorRGBA[1], blankColorRGBA[2], blankColorRGBA[3]);
        glContext.clear(glContext.COLOR_BUFFER_BIT | glContext.DEPTH_BUFFER_BIT);
        glContext.bindFramebuffer(glContext.FRAMEBUFFER, null);
    }
}

var vsOutline = "#version 300 es\nconst float pi=3.1415926535897932384626433832795;const float pi_180=0.017453292519943295769236907684886127134428718885417254560;const float pi_4=12.56637061435917295385057353311801153678867759750042328389;uniform highp mat4 uModelViewMatrix;uniform highp mat4 uProjectionMatrix;uniform highp vec2 uWorldOrigin;in highp vec3 vertCoords;in highp float cornerValues;in highp float inWallWidth;in highp float inSectionHeight;in highp float inHeightInSection;in lowp float inFiltered;out highp float cornerBool;out highp float wallWidth;out highp float surfaceHeight;out highp float heightInSection;out lowp float filtered;void main(){highp vec3 finalPos=vertCoords;cornerBool=cornerValues;wallWidth=inWallWidth;surfaceHeight=inSectionHeight;heightInSection=inHeightInSection;filtered=inFiltered;gl_Position=uProjectionMatrix*uModelViewMatrix*vec4(finalPos,1.0);}";

var fsOutline = "#version 300 es\nin highp float cornerBool;in highp float wallWidth;in highp float surfaceHeight;in highp float heightInSection;in lowp float filtered;out highp vec4 fragColor;void main(){if(filtered<=0.5){discard;}else{if(cornerBool>=-0.1&&((cornerBool<=0.4||cornerBool>=(wallWidth-0.4))||(heightInSection<=0.4||heightInSection>=(surfaceHeight-0.4)))){fragColor=vec4(0,0,0,1);}else{discard;}}}";

/**
 * This shader should only be used with the buildings layer
 */
class ShaderOutline extends Shader {
    // Data to be rendered
    _coords = [];
    _normals = [];
    _indices = [];
    _heights = [];
    _minHeights = [];
    _uv = [];
    _heightInSection = [];
    _sectionHeight = [];
    _width = [];
    // Data loaction on GPU
    _glCoords = null;
    _glNormals = null;
    _glFunction = null;
    _glIndices = null;
    _glColorOrTex = null;
    _glUV = null;
    _glWidth = null;
    _glHeightInSection = null;
    _glSectionHeight = null;
    _glFiltered = null;
    // Data has chaged
    _coordsDirty = false;
    _filteredDirty = false;
    // Id of each property in the VAO
    _coordsId = -1;
    _normalsId = -1;
    _functionId = -1;
    _colorOrTexId = -1;
    _uvId = -1;
    _widthId = -1;
    _heightInSectionId = -1;
    _sectionHeightId = -1;
    _filteredId = -1;
    // Uniforms location
    _uModelViewMatrix = null;
    _uProjectionMatrix = null;
    _uWorldOrigin = null;
    _textureLocation = null;
    // Color map texture
    _texColorMap;
    // Picking
    _colorOrTexValues = [];
    _cellIdsByCoordinates = [];
    _pickedCoordinates = []; // store index of coordinates not the coordinates themselves
    _auxCoords = [];
    _auxIndices = [];
    _auxNormals = [];
    _auxFunction = [];
    _auxColorOrTexValues = [];
    _filtered = [];
    constructor(glContext) {
        super(vsOutline, fsOutline, glContext);
        // create the shader variables    
        this.createUniforms(glContext);
        this.createVertexArrayObject(glContext);
        this.createTextures(glContext);
    }
    updateShaderGeometry(mesh) {
        this._coordsDirty = true;
        this._filteredDirty = true;
        this._coords = mesh.getCoordinatesVBO();
        this._normals = mesh.getNormalsVBO();
        this._indices = mesh.getIndicesVBO();
        this._heights = mesh.getHeightsVBO();
        this._minHeights = mesh.getMinHeightsVBO();
        this._uv = mesh.getuvVBO();
        this._width = mesh.getWidthVBO();
        this._heightInSection = mesh.getHeightInSectionVBO();
        this._sectionHeight = mesh.getSectionHeightVBO();
        let totalNumberOfCoords = mesh.getTotalNumberOfCoords();
        for (let i = 0; i < totalNumberOfCoords; i++) {
            this._filtered.push(1.0); // 1 true to include
        }
    }
    updateShaderData(mesh, knot) {
    }
    updateShaderUniforms(data) {
    }
    setFiltered(filtered) {
        if (filtered.length == 0) {
            this._filtered = Array(this._filtered.length).fill(1.0);
        }
        else {
            this._filtered = filtered;
        }
        this._filteredDirty = true;
    }
    createUniforms(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        this._uModelViewMatrix = glContext.getUniformLocation(this._shaderProgram, 'uModelViewMatrix');
        this._uProjectionMatrix = glContext.getUniformLocation(this._shaderProgram, 'uProjectionMatrix');
        this._uWorldOrigin = glContext.getUniformLocation(this._shaderProgram, 'uWorldOrigin');
        this._textureLocation = glContext.getUniformLocation(this._shaderProgram, "u_texture");
    }
    bindUniforms(glContext, camera) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.uniformMatrix4fv(this._uModelViewMatrix, false, camera.getModelViewMatrix());
        glContext.uniformMatrix4fv(this._uProjectionMatrix, false, camera.getProjectionMatrix());
        glContext.uniform2fv(this._uWorldOrigin, camera.getWorldOrigin());
    }
    createTextures(glContext) {
    }
    bindTextures(glContext) {
    }
    createVertexArrayObject(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        this._coordsId = glContext.getAttribLocation(this._shaderProgram, 'vertCoords');
        this._glCoords = glContext.createBuffer();
        this._uvId = glContext.getAttribLocation(this._shaderProgram, 'cornerValues');
        this._glUV = glContext.createBuffer();
        this._widthId = glContext.getAttribLocation(this._shaderProgram, 'inWallWidth');
        this._glWidth = glContext.createBuffer();
        this._filteredId = glContext.getAttribLocation(this._shaderProgram, 'inFiltered');
        this._glFiltered = glContext.createBuffer();
        this._sectionHeightId = glContext.getAttribLocation(this._shaderProgram, 'inSectionHeight');
        this._glSectionHeight = glContext.createBuffer();
        this._heightInSectionId = glContext.getAttribLocation(this._shaderProgram, 'inHeightInSection');
        this._glHeightInSection = glContext.createBuffer();
        this._glIndices = glContext.createBuffer();
    }
    bindVertexArrayObject(glContext, mesh) {
        if (!this._shaderProgram) {
            return;
        }
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glCoords);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._coords), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._coordsId, mesh.dimension, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._coordsId);
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glHeightInSection);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._heightInSection), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._heightInSectionId, 1, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._heightInSectionId);
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glFiltered);
        if (this._filteredDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._filtered), glContext.STATIC_DRAW);
        }
        glContext.vertexAttribPointer(this._filteredId, 1, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._filteredId);
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glSectionHeight);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._sectionHeight), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._sectionHeightId, 1, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._sectionHeightId);
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glUV);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._uv), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._uvId, 1, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._uvId);
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glWidth);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._width), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._widthId, 1, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._widthId);
        // binds the indices buffer
        glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndices);
        // send data to g4pu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ELEMENT_ARRAY_BUFFER, new Uint32Array(this._indices), glContext.STATIC_DRAW);
        }
        this._coordsDirty = false;
        this._filteredDirty = false;
    }
    setHighlightElements(coordinates, value) {
        throw Error("The outline shader can not highlight elements");
    }
    renderPass(glContext, glPrimitive, camera, mesh, zOrder) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.disable(glContext.CULL_FACE);
        glContext.useProgram(this._shaderProgram);
        // binds data
        this.bindUniforms(glContext, camera);
        // Always pass. Setting the reference value to 1
        glContext.stencilFunc(glContext.ALWAYS, // the test
        1, // reference value
        0xFF);
        // Set stencil to the reference value when both the stencil and depth tests pass
        glContext.stencilOp(glContext.KEEP, // what to do if the stencil test fails
        glContext.KEEP, // what to do if the depth test fails
        glContext.REPLACE);
        this.bindVertexArrayObject(glContext, mesh);
        this.bindTextures(glContext);
        // draw the geometry
        glContext.drawElements(glPrimitive, this._indices.length, glContext.UNSIGNED_INT, 0);
        glContext.enable(glContext.CULL_FACE);
    }
}

class BuildingsLayer extends Layer {
    _zOrder;
    _coordsByCOORDINATES = [];
    _coordsByCOORDINATES3D = [];
    _coordsByOBJECTS = [];
    _highlightByCOORDINATES = [];
    _highlightByCOORDINATES3D = [];
    _highlightByOBJECTS = [];
    constructor(info, zOrder = 0, centroid, geometryData) {
        super(info.id, info.type, info.styleKey, info.renderStyle !== undefined ? info.renderStyle : [], centroid, 3, zOrder // TODO: set correct zOrder
        );
        console.log("buildings", zOrder);
        this._zOrder = zOrder;
        this.updateMeshGeometry(geometryData);
        // this._zOrder = 10; // TODO: set correct zOrder
    }
    supportInteraction(eventName) {
        return true;
    }
    updateMeshGeometry(data) {
        // loads the data
        this._mesh.load(data, false, this._centroid);
    }
    updateShaders(shaders) {
        // updates the shader references
        for (const shader of shaders) {
            shader.updateShaderGeometry(this._mesh);
        }
    }
    // bypass the data extraction from link and injects it directly
    directAddMeshFunction(functionValues, knotId) {
        let distributedValues = this.distributeFunctionValues(functionValues);
        this._mesh.loadFunctionData(distributedValues, knotId);
    }
    updateFunction(knot, shaders) {
        // updates the shader references
        for (const shader of shaders) {
            shader.updateShaderData(this._mesh, knot);
        }
    }
    setHighlightElements(elements, level, value, shaders) {
        let coords = this.getCoordsByLevel(level);
        for (let i = 0; i < elements.length; i++) {
            let offsetCoords = 0;
            let coordsIndex = [];
            let elementIndex = elements[i];
            for (let j = 0; j < elementIndex; j++) {
                offsetCoords += (coords[j].length) / 3;
            }
            for (let k = 0; k < (coords[elementIndex].length) / 3; k++) {
                coordsIndex.push(offsetCoords + k);
            }
            for (const shader of shaders) {
                if (shader instanceof ShaderPicking) {
                    shader.setHighlightElements(coordsIndex, value);
                }
            }
        }
    }
    getSelectedFiltering(shaders) {
        for (const shader of shaders) {
            if (shader instanceof ShaderPicking) {
                return shader.getBboxFiltered(this._mesh);
            }
        }
        return null;
    }
    /**
     * Layer render function signature
     * @param {WebGL2RenderingContext} glContext WebGL context
     */
    render(glContext, shaders) {
        // enables the depth test
        glContext.enable(glContext.DEPTH_TEST);
        glContext.depthFunc(glContext.LEQUAL);
        // enable culling
        glContext.frontFace(glContext.CCW);
        glContext.enable(glContext.CULL_FACE);
        glContext.cullFace(glContext.BACK);
        // enables stencil
        glContext.enable(glContext.STENCIL_TEST);
        // clear stencil
        glContext.clearStencil(0);
        glContext.clear(glContext.STENCIL_BUFFER_BIT);
        // the abs surfaces are loaded first to update the stencil
        for (const shader of shaders) {
            if (shader instanceof ShaderAbstractSurface) {
                shader.renderPass(glContext, glContext.TRIANGLES, this._camera, this._mesh, this._zOrder);
            }
        }
        for (const shader of shaders) {
            if (shader instanceof ShaderAbstractSurface || shader instanceof ShaderOutline) {
                continue;
            }
            else {
                shader.renderPass(glContext, glContext.TRIANGLES, this._camera, this._mesh, this._zOrder);
            }
        }
        // for (const shader of shaders) {
        //     if(shader instanceof ShaderOutline){
        //         shader.renderPass(glContext, glContext.TRIANGLES, this._camera, this._mesh, this._zOrder);
        //     }
        // }
        // clear stencil
        // glContext.clearStencil(0);
        // glContext.clear(glContext.STENCIL_BUFFER_BIT);
        // disables stencil
        glContext.disable(glContext.STENCIL_TEST);
        // disables the depth test
        glContext.disable(glContext.DEPTH_TEST);
        // disables culling
        glContext.disable(glContext.CULL_FACE);
    }
    async applyTexSelectedCells(glContext, spec, specType, shaders) {
        for (const shader of shaders) {
            if (shader instanceof ShaderSmoothColorMapTex) {
                let meshAbsSurfaces = await shader.applyTexSelectedCells(this._camera, spec, specType);
                if (meshAbsSurfaces != undefined) {
                    for (const secondShader of shaders) {
                        if (secondShader instanceof ShaderAbstractSurface && meshAbsSurfaces) {
                            if (!meshAbsSurfaces.code) {
                                meshAbsSurfaces.code = -1;
                            }
                            secondShader.addSurface(glContext, meshAbsSurfaces.image, meshAbsSurfaces.coords, meshAbsSurfaces.indices, meshAbsSurfaces.functionValues, "abs", meshAbsSurfaces.code);
                        }
                    }
                }
            }
        }
    }
    clearAbsSurface(shaders) {
        for (const shader of shaders) {
            if (shader instanceof ShaderAbstractSurface) {
                shader.clearSurfaces();
            }
            if (shader instanceof ShaderSmoothColorMapTex) {
                shader.clearSurfaces();
            }
        }
    }
    createFootprintPlot(glContext, x, y, update, shaders) {
        if (!glContext.canvas || !(glContext.canvas instanceof HTMLCanvasElement)) {
            return;
        }
        let pixelX = x * glContext.canvas.width / glContext.canvas.clientWidth;
        let pixelY = glContext.canvas.height - y * glContext.canvas.height / glContext.canvas.clientHeight - 1;
        for (const shader of shaders) {
            if (shader instanceof ShaderPicking) {
                shader.updateFootPosition(pixelX, pixelY, update);
            }
        }
    }
    async applyFootprintPlot(glContext, spec, plotNumber, specType, shaders) {
        let buildingId = -1;
        for (const shader of shaders) {
            if (shader instanceof ShaderSmoothColorMapTex) {
                let footPrintMesh = await shader.applyFootprintPlot(spec, false, plotNumber, 0, specType);
                buildingId = shader.currentFootPrintBuildingId;
                if (!footPrintMesh)
                    return;
                if (footPrintMesh.coords.length == 0) { // the mesh could not be created
                    continue;
                }
                for (const secondShader of shaders) {
                    if (secondShader instanceof ShaderAbstractSurface && footPrintMesh) {
                        if (footPrintMesh.code != undefined)
                            secondShader.addSurface(glContext, footPrintMesh.image, footPrintMesh.coords, footPrintMesh.indices, footPrintMesh.functionValues, "foot", footPrintMesh.code);
                    }
                }
            }
        }
        return buildingId;
    }
    async updateFootprintPlot(glContext, d3Expec, plotNumber, deltaHeight, specType, shaders) {
        for (const shader of shaders) {
            if (shader instanceof ShaderSmoothColorMapTex) {
                let footPrintMesh = await shader.applyFootprintPlot(d3Expec, true, plotNumber, deltaHeight, specType);
                if (!footPrintMesh)
                    return;
                if (footPrintMesh.coords.length == 0) { // the mesh could not be updated
                    continue;
                }
                for (const secondShader of shaders) {
                    if (secondShader instanceof ShaderAbstractSurface && footPrintMesh) {
                        if (footPrintMesh.code != undefined)
                            secondShader.updateSurface(glContext, footPrintMesh.image, footPrintMesh.coords, footPrintMesh.indices, footPrintMesh.functionValues, "foot", footPrintMesh.code);
                    }
                }
            }
        }
    }
    perFaceAvg(functionValues, indices, ids) {
        let maxId = -1;
        for (const id of ids) {
            if (id > maxId) {
                maxId = id;
            }
        }
        let avg_accumulation_triangle = new Array(Math.trunc(indices.length / 3)).fill(0);
        let avg_accumulation_cell = new Array(maxId + 1).fill(0);
        let indicesByThree = Math.trunc(indices.length / 3);
        // calculate acc by triangle
        for (let i = 0; i < indicesByThree; i++) {
            let value = 0;
            value += functionValues[indices[i * 3]];
            value += functionValues[indices[i * 3 + 1]];
            value += functionValues[indices[i * 3 + 2]];
            avg_accumulation_triangle[i] = value / 3; // TODO: /3 or not? (distribute and accumulate?)
        }
        // calculate acc by cell based on the triangles that compose it
        let count_acc_cell = new Array(maxId + 1).fill(0);
        indicesByThree = Math.trunc(indices.length / 3);
        for (let i = 0; i < indicesByThree; i++) {
            let cell = ids[i];
            avg_accumulation_cell[cell] += avg_accumulation_triangle[i];
            count_acc_cell[cell] += 1;
        }
        indicesByThree = Math.trunc(indices.length / 3);
        for (let i = 0; i < indicesByThree; i++) {
            let cell = ids[i];
            avg_accumulation_triangle[i] = avg_accumulation_cell[cell] / count_acc_cell[cell];
        }
        return avg_accumulation_triangle;
    }
    /**
     * Distributes triangle avg to the coordinates that composes the triangle.
     * The coordinates need to be duplicated, meaning that there are unique indices.
     */
    perCoordinatesAvg(avg_accumulation_triangle, coordsLength, indices) {
        let avg_accumulation_per_coordinates = new Array(coordsLength).fill(0);
        for (let i = 0; i < avg_accumulation_triangle.length; i++) {
            let elem = avg_accumulation_triangle[i];
            avg_accumulation_per_coordinates[indices[i * 3]] = elem;
            avg_accumulation_per_coordinates[indices[i * 3 + 1]] = elem;
            avg_accumulation_per_coordinates[indices[i * 3 + 2]] = elem;
        }
        return avg_accumulation_per_coordinates;
    }
    distributeFunctionValues(functionValues) {
        if (functionValues == null) {
            return null;
        }
        let ids = this._mesh.getIdsVBO();
        let indices = this._mesh.getIndicesVBO();
        let coordsLength = this._mesh.getTotalNumberOfCoords();
        let per_face_avg_accum = this.perFaceAvg(functionValues, indices, ids);
        let avg_accumulation_per_coordinates = this.perCoordinatesAvg(per_face_avg_accum, coordsLength, indices);
        return avg_accumulation_per_coordinates;
    }
    innerAggFunc(functionValues, startLevel, endLevel, operation) {
        if (endLevel != LevelType.OBJECTS || startLevel == LevelType.OBJECTS) {
            throw new Error('Only operations that end in the Object level are currently supported for the buildings layer');
        }
        if (startLevel == LevelType.COORDINATES) {
            throw new Error('Operations with the COORDINATES level are currently not support for the buildings layer. Since the COORDINATES level refers to the buildings footprints.');
        }
        if (functionValues == null)
            return null;
        let coordsPerComp = this._mesh.getCoordsPerComp(); // in the buildings layer the components are the buildings
        let acc_functions_per_buildings = [];
        let readCoords = 0;
        for (const numberCoords of coordsPerComp) {
            let values = [];
            for (let i = 0; i < numberCoords; i++) {
                values.push(functionValues[i + readCoords]);
            }
            readCoords += numberCoords;
            acc_functions_per_buildings.push(values);
        }
        let agg_functions_per_buildings = new Array(acc_functions_per_buildings.length).fill(0);
        for (let i = 0; i < acc_functions_per_buildings.length; i++) {
            if (operation == OperationType.MAX) {
                agg_functions_per_buildings[i] = acc_functions_per_buildings[i].reduce((a, b) => Math.max(a, b), -Infinity);
            }
            else if (operation == OperationType.MIN) {
                agg_functions_per_buildings[i] = acc_functions_per_buildings[i].reduce((a, b) => Math.min(a, b), Infinity);
            }
            else if (operation == OperationType.AVG) {
                let sum = acc_functions_per_buildings[i].reduce((partialSum, value) => partialSum + value, 0);
                agg_functions_per_buildings[i] = sum / acc_functions_per_buildings[i].length;
            }
            else if (operation == OperationType.SUM) {
                agg_functions_per_buildings[i] = acc_functions_per_buildings[i].reduce((partialSum, value) => partialSum + value, 0);
            }
            else if (operation == OperationType.COUNT) {
                agg_functions_per_buildings[i] = acc_functions_per_buildings[i].length;
            }
            else if (operation == OperationType.DISCARD) { // keep the first value of the join
                agg_functions_per_buildings[i] = acc_functions_per_buildings[i][0];
            }
            else if (operation == OperationType.NONE) {
                throw new Error('NONE operation cannot be used with the spatial_relation INNERAGG in the buildings layer');
            }
        }
        readCoords = 0;
        for (let i = 0; i < agg_functions_per_buildings.length; i++) {
            for (let j = 0; j < coordsPerComp[i]; j++) {
                functionValues[j + readCoords] = agg_functions_per_buildings[i];
            }
            readCoords += coordsPerComp[i];
        }
        return functionValues;
    }
    getFunctionValueIndexOfId(id, level) {
        if (level == LevelType.COORDINATES) {
            throw Error("The buildings layer does not have function values attached to COORDINATES");
        }
        if (level == LevelType.OBJECTS) {
            let readCoords = 0;
            let coordsPerComp = this._mesh.getCoordsPerComp();
            for (let i = 0; i < coordsPerComp.length; i++) {
                if (i == id) { // assumes that all coordinates of the same object have the same function value
                    return readCoords;
                }
                readCoords += coordsPerComp[i];
            }
        }
        if (level == LevelType.COORDINATES3D) {
            return id;
        }
        return null;
    }
    getCoordsByLevel(level) {
        let coordByLevel = [];
        if (level == LevelType.COORDINATES) {
            if (this._coordsByCOORDINATES.length == 0) {
                let sectionFootPrint = this._mesh.getSectionFootprintVBO();
                for (const footPrintsElement of sectionFootPrint) {
                    for (let i = 0; i < footPrintsElement[0].length / 2; i++) {
                        coordByLevel.push([footPrintsElement[0][i * 2], footPrintsElement[0][i * 2 + 1], 0]);
                    }
                }
                this._coordsByCOORDINATES = coordByLevel;
            }
            else {
                coordByLevel = this._coordsByCOORDINATES;
            }
        }
        if (level == LevelType.COORDINATES3D) {
            if (this._coordsByCOORDINATES3D.length == 0) {
                let coords = this._mesh.getCoordinatesVBO();
                for (let i = 0; i < coords.length / 3; i++) {
                    coordByLevel.push([coords[i * 3], coords[i * 3 + 1], coords[i * 3 + 2]]);
                }
                this._coordsByCOORDINATES3D = coordByLevel;
            }
            else {
                coordByLevel = this._coordsByCOORDINATES3D;
            }
        }
        if (level == LevelType.OBJECTS) {
            if (this._coordsByOBJECTS.length == 0) {
                let coords = this._mesh.getCoordinatesVBO();
                let readCoords = 0;
                let coordsPerComp = this._mesh.getCoordsPerComp();
                for (const numCoords of coordsPerComp) {
                    let groupedCoords = [];
                    for (let i = 0; i < numCoords; i++) {
                        groupedCoords.push(coords[i * 3 + (readCoords * 3)]);
                        groupedCoords.push(coords[i * 3 + 1 + (readCoords * 3)]);
                        groupedCoords.push(coords[i * 3 + 2 + (readCoords * 3)]);
                    }
                    readCoords += numCoords;
                    coordByLevel.push(groupedCoords);
                }
                this._coordsByOBJECTS = coordByLevel;
            }
            else {
                coordByLevel = this._coordsByOBJECTS;
            }
        }
        return coordByLevel;
    }
    getFunctionByLevel(level, knotId) {
        let functionByLevel = [];
        if (level == LevelType.COORDINATES) {
            throw Error("It is not possible to get abstract data from COORDINATES level in the building layer");
        }
        if (level == LevelType.COORDINATES3D) {
            let functionValues = this._mesh.getFunctionVBO(knotId)[0].map(x => [x]); // TODO: give support to more then one timestamps
            functionByLevel = functionValues;
        }
        if (level == LevelType.OBJECTS) {
            let functionValues = this._mesh.getFunctionVBO(knotId)[0];
            let readFunctions = 0;
            let coordsPerComp = this._mesh.getCoordsPerComp();
            for (const numCoords of coordsPerComp) {
                let groupedFunctions = [];
                for (let i = 0; i < numCoords; i++) {
                    groupedFunctions.push(functionValues[i + readFunctions]);
                }
                readFunctions += numCoords;
                functionByLevel.push(groupedFunctions);
            }
        }
        return functionByLevel;
    }
    getHighlightsByLevel(level, shaders) {
        let highlightArray = [];
        let booleanHighlights = [];
        let highlightsByLevel = [];
        if (level == LevelType.COORDINATES) {
            throw Error("It is not possible to highlight COORDINATES in the building layer");
        }
        for (const shader of shaders) {
            if (shader instanceof ShaderSmoothColorMapTex) {
                highlightArray = shader.colorOrPicked;
            }
        }
        for (const value of highlightArray) {
            if (value == 0) {
                booleanHighlights.push(false);
            }
            else {
                booleanHighlights.push(true);
            }
        }
        if (level == LevelType.COORDINATES3D) {
            if (this._highlightByCOORDINATES3D.length == 0) {
                highlightsByLevel = booleanHighlights.map(x => [x]);
                this._highlightByCOORDINATES3D = highlightsByLevel;
            }
            else {
                highlightsByLevel = this._highlightByCOORDINATES3D;
            }
        }
        if (level == LevelType.OBJECTS) {
            if (this._highlightByOBJECTS.length == 0) {
                let readHighlights = 0;
                let coordsPerComp = this._mesh.getCoordsPerComp();
                for (const numCoords of coordsPerComp) {
                    let groupedHighlights = [];
                    for (let i = 0; i < numCoords; i++) {
                        groupedHighlights.push(booleanHighlights[i + readHighlights]);
                    }
                    readHighlights += numCoords;
                    highlightsByLevel.push(groupedHighlights);
                }
                this._highlightByOBJECTS = highlightsByLevel;
            }
            else {
                highlightsByLevel = this._highlightByOBJECTS;
            }
        }
        let flattenedHighlights = [];
        // flattening the highlight data
        for (const elemHighlights of highlightsByLevel) {
            let allHighlighted = true;
            for (const value of elemHighlights) {
                if (!value) {
                    allHighlighted = false;
                }
            }
            if (allHighlighted) // all the coordinates of the element must be highlighted for it to be considered highlighted
                flattenedHighlights.push(true);
            else
                flattenedHighlights.push(false);
        }
        return flattenedHighlights;
    }
    getIdLastHighlightedBuilding(shaders) {
        for (const shader of shaders) {
            if (shader instanceof ShaderSmoothColorMapTex) {
                return shader.currentPickedBuildingId;
            }
        }
    }
    highlightBuilding(glContext, x, y, shaders) {
        if (!glContext.canvas || !(glContext.canvas instanceof HTMLCanvasElement)) {
            return;
        }
        let pixelX = x * glContext.canvas.width / glContext.canvas.clientWidth;
        let pixelY = glContext.canvas.height - y * glContext.canvas.height / glContext.canvas.clientHeight - 1;
        for (const shader of shaders) {
            if (shader instanceof ShaderPicking) {
                shader.updatePickObjectPosition(pixelX, pixelY);
            }
        }
    }
}

class GeoUtils {
    static res = 256.0;
    static wLevel = 22;
    /**
     * Converts from lat, lng to world coordinates
     * @param {number} latitude the latitude of the point
     * @param {number} longitude the longitude of the point
     */
    static latLng2Coord_old(latitude, longitude) {
        const pi_4 = 12.56637061435917295385057353311801153678867759750042328389;
        const pi_180 = 0.017453292519943295769236907684886127134428718885417254560;
        const sinLatitude = Math.sin(latitude * pi_180);
        const pixelY = 256.0 - ((0.5 - Math.log((1.0 + sinLatitude) / (1.0 - sinLatitude)) / (pi_4)) * 256.0);
        const pixelX = ((longitude + 180.0) / 360.0) * 256.0;
        return [pixelX, pixelY];
    }
    static latLng2Coord(latitude, longitude) {
        let y = 0;
        if (latitude == 90.0) {
            y = GeoUtils.res;
        }
        else if (latitude == -90.0) {
            y = 0.0;
        }
        else {
            y = (Math.PI - Math.atanh(Math.sin(latitude * Math.PI / 180))) / Math.PI * GeoUtils.res / 2.0;
        }
        return [
            y * Math.pow(2, GeoUtils.wLevel),
            -(longitude + 180.0) / 360.0 * GeoUtils.res * Math.pow(2, GeoUtils.wLevel),
        ];
    }
    /**
     * Converts from world coordinates to lat, lng
     * @param {number} x the x coordinate of the point
     * @param {number} y the y coordinate of the point
     */
    static coord2LatLng_old(x, y) {
        const pi_4 = 12.56637061435917295385057353311801153678867759750042328389;
        const pi_180 = 0.017453292519943295769236907684886127134428718885417254560;
        const longitude = ((x / GeoUtils.res) * 360.0) - 180.0;
        let latitude = (256.0 - y) / GeoUtils.res;
        latitude = Math.exp((0.5 - latitude) * pi_4);
        latitude = (latitude - 1.0) / (1.0 + latitude);
        latitude = Math.asin(latitude) / pi_180;
        return [latitude, longitude];
    }
    static coord2LatLng(x, y) {
        return [
            Math.atan(Math.sinh(Math.PI * (1 - y / GeoUtils.wLevel / 128))) * 180 / Math.PI,
            x * 360 / GeoUtils.wLevel / GeoUtils.res - 180
        ];
    }
    /**
     * Computes the ground resolution
     * @param {number} lat the latitude value
     * @param {number} lng the longitude value
     * @param {number} zoom the zoom leevl
     */
    static groundResolution(lat, lng, zoom) {
        return Math.cos(lat * Math.PI / 180) * 6378137 * 2 * Math.PI / Math.pow(2, zoom);
    }
}

/**
 * Common utilities
 * @module glMatrix
 */
// Configuration Constants
var EPSILON = 0.000001;
var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;
if (!Math.hypot) Math.hypot = function () {
  var y = 0,
      i = arguments.length;

  while (i--) {
    y += arguments[i] * arguments[i];
  }

  return Math.sqrt(y);
};

/**
 * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.
 * @module mat4
 */

/**
 * Creates a new identity mat4
 *
 * @returns {mat4} a new 4x4 matrix
 */

function create$3() {
  var out = new ARRAY_TYPE(16);

  if (ARRAY_TYPE != Float32Array) {
    out[1] = 0;
    out[2] = 0;
    out[3] = 0;
    out[4] = 0;
    out[6] = 0;
    out[7] = 0;
    out[8] = 0;
    out[9] = 0;
    out[11] = 0;
    out[12] = 0;
    out[13] = 0;
    out[14] = 0;
  }

  out[0] = 1;
  out[5] = 1;
  out[10] = 1;
  out[15] = 1;
  return out;
}
/**
 * Set the components of a mat4 to the given values
 *
 * @param {mat4} out the receiving matrix
 * @param {Number} m00 Component in column 0, row 0 position (index 0)
 * @param {Number} m01 Component in column 0, row 1 position (index 1)
 * @param {Number} m02 Component in column 0, row 2 position (index 2)
 * @param {Number} m03 Component in column 0, row 3 position (index 3)
 * @param {Number} m10 Component in column 1, row 0 position (index 4)
 * @param {Number} m11 Component in column 1, row 1 position (index 5)
 * @param {Number} m12 Component in column 1, row 2 position (index 6)
 * @param {Number} m13 Component in column 1, row 3 position (index 7)
 * @param {Number} m20 Component in column 2, row 0 position (index 8)
 * @param {Number} m21 Component in column 2, row 1 position (index 9)
 * @param {Number} m22 Component in column 2, row 2 position (index 10)
 * @param {Number} m23 Component in column 2, row 3 position (index 11)
 * @param {Number} m30 Component in column 3, row 0 position (index 12)
 * @param {Number} m31 Component in column 3, row 1 position (index 13)
 * @param {Number} m32 Component in column 3, row 2 position (index 14)
 * @param {Number} m33 Component in column 3, row 3 position (index 15)
 * @returns {mat4} out
 */

function set$2(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {
  out[0] = m00;
  out[1] = m01;
  out[2] = m02;
  out[3] = m03;
  out[4] = m10;
  out[5] = m11;
  out[6] = m12;
  out[7] = m13;
  out[8] = m20;
  out[9] = m21;
  out[10] = m22;
  out[11] = m23;
  out[12] = m30;
  out[13] = m31;
  out[14] = m32;
  out[15] = m33;
  return out;
}
/**
 * Set a mat4 to the identity matrix
 *
 * @param {mat4} out the receiving matrix
 * @returns {mat4} out
 */

function identity(out) {
  out[0] = 1;
  out[1] = 0;
  out[2] = 0;
  out[3] = 0;
  out[4] = 0;
  out[5] = 1;
  out[6] = 0;
  out[7] = 0;
  out[8] = 0;
  out[9] = 0;
  out[10] = 1;
  out[11] = 0;
  out[12] = 0;
  out[13] = 0;
  out[14] = 0;
  out[15] = 1;
  return out;
}
/**
 * Multiplies two mat4s
 *
 * @param {mat4} out the receiving matrix
 * @param {ReadonlyMat4} a the first operand
 * @param {ReadonlyMat4} b the second operand
 * @returns {mat4} out
 */

function multiply(out, a, b) {
  var a00 = a[0],
      a01 = a[1],
      a02 = a[2],
      a03 = a[3];
  var a10 = a[4],
      a11 = a[5],
      a12 = a[6],
      a13 = a[7];
  var a20 = a[8],
      a21 = a[9],
      a22 = a[10],
      a23 = a[11];
  var a30 = a[12],
      a31 = a[13],
      a32 = a[14],
      a33 = a[15]; // Cache only the current line of the second matrix

  var b0 = b[0],
      b1 = b[1],
      b2 = b[2],
      b3 = b[3];
  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;
  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;
  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;
  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;
  b0 = b[4];
  b1 = b[5];
  b2 = b[6];
  b3 = b[7];
  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;
  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;
  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;
  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;
  b0 = b[8];
  b1 = b[9];
  b2 = b[10];
  b3 = b[11];
  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;
  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;
  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;
  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;
  b0 = b[12];
  b1 = b[13];
  b2 = b[14];
  b3 = b[15];
  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;
  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;
  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;
  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;
  return out;
}
/**
 * Creates a matrix from a vector scaling
 * This is equivalent to (but much faster than):
 *
 *     mat4.identity(dest);
 *     mat4.scale(dest, dest, vec);
 *
 * @param {mat4} out mat4 receiving operation result
 * @param {ReadonlyVec3} v Scaling vector
 * @returns {mat4} out
 */

function fromScaling(out, v) {
  out[0] = v[0];
  out[1] = 0;
  out[2] = 0;
  out[3] = 0;
  out[4] = 0;
  out[5] = v[1];
  out[6] = 0;
  out[7] = 0;
  out[8] = 0;
  out[9] = 0;
  out[10] = v[2];
  out[11] = 0;
  out[12] = 0;
  out[13] = 0;
  out[14] = 0;
  out[15] = 1;
  return out;
}
/**
 * Generates a perspective projection matrix with the given bounds.
 * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],
 * which matches WebGL/OpenGL's clip volume.
 * Passing null/undefined/no value for far will generate infinite projection matrix.
 *
 * @param {mat4} out mat4 frustum matrix will be written into
 * @param {number} fovy Vertical field of view in radians
 * @param {number} aspect Aspect ratio. typically viewport width/height
 * @param {number} near Near bound of the frustum
 * @param {number} far Far bound of the frustum, can be null or Infinity
 * @returns {mat4} out
 */

function perspectiveNO(out, fovy, aspect, near, far) {
  var f = 1.0 / Math.tan(fovy / 2),
      nf;
  out[0] = f / aspect;
  out[1] = 0;
  out[2] = 0;
  out[3] = 0;
  out[4] = 0;
  out[5] = f;
  out[6] = 0;
  out[7] = 0;
  out[8] = 0;
  out[9] = 0;
  out[11] = -1;
  out[12] = 0;
  out[13] = 0;
  out[15] = 0;

  if (far != null && far !== Infinity) {
    nf = 1 / (near - far);
    out[10] = (far + near) * nf;
    out[14] = 2 * far * near * nf;
  } else {
    out[10] = -1;
    out[14] = -2 * near;
  }

  return out;
}
/**
 * Alias for {@link mat4.perspectiveNO}
 * @function
 */

var perspective = perspectiveNO;
/**
 * Generates a look-at matrix with the given eye position, focal point, and up axis.
 * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.
 *
 * @param {mat4} out mat4 frustum matrix will be written into
 * @param {ReadonlyVec3} eye Position of the viewer
 * @param {ReadonlyVec3} center Point the viewer is looking at
 * @param {ReadonlyVec3} up vec3 pointing up
 * @returns {mat4} out
 */

function lookAt(out, eye, center, up) {
  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;
  var eyex = eye[0];
  var eyey = eye[1];
  var eyez = eye[2];
  var upx = up[0];
  var upy = up[1];
  var upz = up[2];
  var centerx = center[0];
  var centery = center[1];
  var centerz = center[2];

  if (Math.abs(eyex - centerx) < EPSILON && Math.abs(eyey - centery) < EPSILON && Math.abs(eyez - centerz) < EPSILON) {
    return identity(out);
  }

  z0 = eyex - centerx;
  z1 = eyey - centery;
  z2 = eyez - centerz;
  len = 1 / Math.hypot(z0, z1, z2);
  z0 *= len;
  z1 *= len;
  z2 *= len;
  x0 = upy * z2 - upz * z1;
  x1 = upz * z0 - upx * z2;
  x2 = upx * z1 - upy * z0;
  len = Math.hypot(x0, x1, x2);

  if (!len) {
    x0 = 0;
    x1 = 0;
    x2 = 0;
  } else {
    len = 1 / len;
    x0 *= len;
    x1 *= len;
    x2 *= len;
  }

  y0 = z1 * x2 - z2 * x1;
  y1 = z2 * x0 - z0 * x2;
  y2 = z0 * x1 - z1 * x0;
  len = Math.hypot(y0, y1, y2);

  if (!len) {
    y0 = 0;
    y1 = 0;
    y2 = 0;
  } else {
    len = 1 / len;
    y0 *= len;
    y1 *= len;
    y2 *= len;
  }

  out[0] = x0;
  out[1] = y0;
  out[2] = z0;
  out[3] = 0;
  out[4] = x1;
  out[5] = y1;
  out[6] = z1;
  out[7] = 0;
  out[8] = x2;
  out[9] = y2;
  out[10] = z2;
  out[11] = 0;
  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);
  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);
  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);
  out[15] = 1;
  return out;
}
/**
 * Alias for {@link mat4.multiply}
 * @function
 */

var mul = multiply;

/**
 * 3 Dimensional Vector
 * @module vec3
 */

/**
 * Creates a new, empty vec3
 *
 * @returns {vec3} a new 3D vector
 */

function create$2() {
  var out = new ARRAY_TYPE(3);

  if (ARRAY_TYPE != Float32Array) {
    out[0] = 0;
    out[1] = 0;
    out[2] = 0;
  }

  return out;
}
/**
 * Calculates the length of a vec3
 *
 * @param {ReadonlyVec3} a vector to calculate length of
 * @returns {Number} length of a
 */

function length$1(a) {
  var x = a[0];
  var y = a[1];
  var z = a[2];
  return Math.hypot(x, y, z);
}
/**
 * Creates a new vec3 initialized with the given values
 *
 * @param {Number} x X component
 * @param {Number} y Y component
 * @param {Number} z Z component
 * @returns {vec3} a new 3D vector
 */

function fromValues$1(x, y, z) {
  var out = new ARRAY_TYPE(3);
  out[0] = x;
  out[1] = y;
  out[2] = z;
  return out;
}
/**
 * Adds two vec3's
 *
 * @param {vec3} out the receiving vector
 * @param {ReadonlyVec3} a the first operand
 * @param {ReadonlyVec3} b the second operand
 * @returns {vec3} out
 */

function add(out, a, b) {
  out[0] = a[0] + b[0];
  out[1] = a[1] + b[1];
  out[2] = a[2] + b[2];
  return out;
}
/**
 * Subtracts vector b from vector a
 *
 * @param {vec3} out the receiving vector
 * @param {ReadonlyVec3} a the first operand
 * @param {ReadonlyVec3} b the second operand
 * @returns {vec3} out
 */

function subtract(out, a, b) {
  out[0] = a[0] - b[0];
  out[1] = a[1] - b[1];
  out[2] = a[2] - b[2];
  return out;
}
/**
 * Scales a vec3 by a scalar number
 *
 * @param {vec3} out the receiving vector
 * @param {ReadonlyVec3} a the vector to scale
 * @param {Number} b amount to scale the vector by
 * @returns {vec3} out
 */

function scale(out, a, b) {
  out[0] = a[0] * b;
  out[1] = a[1] * b;
  out[2] = a[2] * b;
  return out;
}
/**
 * Adds two vec3's after scaling the second operand by a scalar value
 *
 * @param {vec3} out the receiving vector
 * @param {ReadonlyVec3} a the first operand
 * @param {ReadonlyVec3} b the second operand
 * @param {Number} scale the amount to scale b by before adding
 * @returns {vec3} out
 */

function scaleAndAdd(out, a, b, scale) {
  out[0] = a[0] + b[0] * scale;
  out[1] = a[1] + b[1] * scale;
  out[2] = a[2] + b[2] * scale;
  return out;
}
/**
 * Normalize a vec3
 *
 * @param {vec3} out the receiving vector
 * @param {ReadonlyVec3} a vector to normalize
 * @returns {vec3} out
 */

function normalize(out, a) {
  var x = a[0];
  var y = a[1];
  var z = a[2];
  var len = x * x + y * y + z * z;

  if (len > 0) {
    //TODO: evaluate use of glm_invsqrt here?
    len = 1 / Math.sqrt(len);
  }

  out[0] = a[0] * len;
  out[1] = a[1] * len;
  out[2] = a[2] * len;
  return out;
}
/**
 * Computes the cross product of two vec3's
 *
 * @param {vec3} out the receiving vector
 * @param {ReadonlyVec3} a the first operand
 * @param {ReadonlyVec3} b the second operand
 * @returns {vec3} out
 */

function cross(out, a, b) {
  var ax = a[0],
      ay = a[1],
      az = a[2];
  var bx = b[0],
      by = b[1],
      bz = b[2];
  out[0] = ay * bz - az * by;
  out[1] = az * bx - ax * bz;
  out[2] = ax * by - ay * bx;
  return out;
}
/**
 * Rotate a 3D vector around the z-axis
 * @param {vec3} out The receiving vec3
 * @param {ReadonlyVec3} a The vec3 point to rotate
 * @param {ReadonlyVec3} b The origin of the rotation
 * @param {Number} rad The angle of rotation in radians
 * @returns {vec3} out
 */

function rotateZ(out, a, b, rad) {
  var p = [],
      r = []; //Translate point to the origin

  p[0] = a[0] - b[0];
  p[1] = a[1] - b[1];
  p[2] = a[2] - b[2]; //perform rotation

  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);
  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);
  r[2] = p[2]; //translate to correct position

  out[0] = r[0] + b[0];
  out[1] = r[1] + b[1];
  out[2] = r[2] + b[2];
  return out;
}
/**
 * Alias for {@link vec3.subtract}
 * @function
 */

var sub = subtract;
/**
 * Perform some operation over an array of vec3s.
 *
 * @param {Array} a the array of vectors to iterate over
 * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed
 * @param {Number} offset Number of elements to skip at the beginning of the array
 * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array
 * @param {Function} fn Function to call for each vector in the array
 * @param {Object} [arg] additional argument to pass to fn
 * @returns {Array} a
 * @function
 */

(function () {
  var vec = create$2();
  return function (a, stride, offset, count, fn, arg) {
    var i, l;

    if (!stride) {
      stride = 3;
    }

    if (!offset) {
      offset = 0;
    }

    if (count) {
      l = Math.min(count * stride + offset, a.length);
    } else {
      l = a.length;
    }

    for (i = offset; i < l; i += stride) {
      vec[0] = a[i];
      vec[1] = a[i + 1];
      vec[2] = a[i + 2];
      fn(vec, vec, arg);
      a[i] = vec[0];
      a[i + 1] = vec[1];
      a[i + 2] = vec[2];
    }

    return a;
  };
})();

/**
 * 2 Dimensional Vector
 * @module vec2
 */

/**
 * Creates a new, empty vec2
 *
 * @returns {vec2} a new 2D vector
 */

function create$1() {
  var out = new ARRAY_TYPE(2);

  if (ARRAY_TYPE != Float32Array) {
    out[0] = 0;
    out[1] = 0;
  }

  return out;
}
/**
 * Creates a new vec2 initialized with the given values
 *
 * @param {Number} x X component
 * @param {Number} y Y component
 * @returns {vec2} a new 2D vector
 */

function fromValues(x, y) {
  var out = new ARRAY_TYPE(2);
  out[0] = x;
  out[1] = y;
  return out;
}
/**
 * Perform some operation over an array of vec2s.
 *
 * @param {Array} a the array of vectors to iterate over
 * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed
 * @param {Number} offset Number of elements to skip at the beginning of the array
 * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array
 * @param {Function} fn Function to call for each vector in the array
 * @param {Object} [arg] additional argument to pass to fn
 * @returns {Array} a
 * @function
 */

(function () {
  var vec = create$1();
  return function (a, stride, offset, count, fn, arg) {
    var i, l;

    if (!stride) {
      stride = 2;
    }

    if (!offset) {
      offset = 0;
    }

    if (count) {
      l = Math.min(count * stride + offset, a.length);
    } else {
      l = a.length;
    }

    for (i = offset; i < l; i += stride) {
      vec[0] = a[i];
      vec[1] = a[i + 1];
      fn(vec, vec, arg);
      a[i] = vec[0];
      a[i + 1] = vec[1];
    }

    return a;
  };
})();

/**
 * 3D Camera representation
 */
class Camera {
    // View parameters
    wOrigin = create$1();
    wEye = create$2();
    wEyeDir = create$2();
    wEyeLength;
    wLookAt = create$2();
    wUp = create$2();
    wNear;
    wFar;
    // 1 unit in worldspace equals to {groundRes} meters in the z-axis
    groundRes;
    fovy = 45 * Math.PI / 180.0;
    // Transformation matrices
    mProjectionMatrix = create$3();
    mViewMatrix = create$3();
    mModelMatrix = create$3();
    _updateStatusCallback;
    // view resolution
    viewportWidth;
    viewportHeight;
    resetCamera(initialPosition, wUp, wLookAt, wEye, updateStatusCallback) {
        this.wEyeDir = create$2();
        this.fovy = 45 * Math.PI / 180.0;
        this.mProjectionMatrix = create$3();
        this.mViewMatrix = create$3();
        this.mModelMatrix = create$3();
        this._updateStatusCallback = updateStatusCallback;
        // z-values start from here are in meters
        this.wNear = 1;
        // this.wFar = 1e5;
        this.wFar = 1e10;
        this.groundRes = 1;
        this.wOrigin = fromValues(initialPosition[0], initialPosition[1]);
        this.wLookAt = fromValues$1(wLookAt[0], wLookAt[1], wLookAt[2]);
        this.wEye = fromValues$1(wEye[0], wEye[1], wEye[2]);
        this.zScaling(1);
        // meter is no longer used in the remaining code
        this.wUp = fromValues$1(wUp[0], wUp[1], wUp[2]);
        // ============ manhattan
        // this.wEye = vec3.fromValues(3373.32275390625, -3327.14892578125, 4355.8701171875);
        // this.wLookAt = vec3.fromValues(2775.06201171875, -2736.633056640625, 3814.228759765625);
        // this.wUp = vec3.fromValues(-0.3854859173297882, 0.38049426674842834, 0.8406097292900085);
        // ============ manhattan
        // this.wEye = vec3.fromValues(25.537822723388672, 44.76106262207031, 1299.8607177734375);
        // this.wLookAt = vec3.fromValues(572.3938598632812, -504.5278625488281, 668.0140380859375);
        // this.wUp = vec3.fromValues(0.4457886517047882, -0.4477752149105072, 0.7750934362411499);
        // ============ chicago
        // this.wEye = vec3.fromValues(-18.267929077148438, 759.4937744140625, 3000);
        // this.wLookAt = vec3.fromValues(-18.316102981567383, 747.6268310546875, 0.023424625396728516);
        // this.wUp = vec3.fromValues(0.004059492610394955, 0.9999839067459106, -0.0039556859992444515);
    }
    getProjectionMatrix() {
        return this.mProjectionMatrix;
    }
    getViewMatrix() {
        return this.mViewMatrix;
    }
    getModelViewMatrix() {
        const modelViewMatrix = mul(create$3(), this.mViewMatrix, this.mModelMatrix);
        return modelViewMatrix;
    }
    getWorldOrigin() {
        return this.wOrigin;
    }
    getEye() {
        return this.wEye;
    }
    getGroundResolution() {
        return this.groundRes;
    }
    setViewportResolution(x, y) {
        this.viewportWidth = x;
        this.viewportHeight = y;
    }
    getViewportResolution() {
        return [
            this.viewportWidth,
            this.viewportHeight
        ];
    }
    updateEyeDirAndLen() {
        sub(this.wEyeDir, this.wLookAt, this.wEye);
        this.wEyeLength = length$1(this.wEyeDir);
        normalize(this.wEyeDir, this.wEyeDir);
    }
    zScaling(scale) {
        this.wEye[2] = this.wEye[2] * scale;
        this.wLookAt[2] = this.wLookAt[2] * scale;
        this.updateEyeDirAndLen();
    }
    zoom(delta, x, y) {
        delta = delta < 0 ? 100 * (this.wEye[2] * 0.001) : -100 * (this.wEye[2] * 0.001);
        const dir = this.screenCoordToWorldDir(x, y);
        scaleAndAdd(this.wEye, this.wEye, dir, delta);
        scaleAndAdd(this.wLookAt, this.wEye, this.wEyeDir, this.wEyeLength);
    }
    translate(dx, dy) {
        const scale$1 = this.wEye[2];
        const X = create$2();
        normalize(X, cross(X, this.wEyeDir, this.wUp));
        const D = add(create$2(), scale(create$2(), X, dx * scale$1), scale(create$2(), this.wUp, dy * scale$1));
        add(this.wEye, this.wEye, D);
        scaleAndAdd(this.wLookAt, this.wEye, this.wEyeDir, this.wEyeLength);
    }
    yaw(delta) {
        rotateZ(this.wEyeDir, this.wEyeDir, fromValues$1(0, 0, 0), delta);
        rotateZ(this.wUp, this.wUp, fromValues$1(0, 0, 0), delta);
        scaleAndAdd(this.wLookAt, this.wEye, this.wEyeDir, this.wEyeLength);
    }
    pitch(delta) {
        delta = -delta;
        add(this.wEyeDir, scale(create$2(), this.wUp, Math.sin(delta)), scale(create$2(), this.wEyeDir, Math.cos(delta)));
        normalize(this.wEyeDir, this.wEyeDir);
        scaleAndAdd(this.wLookAt, this.wEye, this.wEyeDir, this.wEyeLength);
        cross(this.wUp, cross(create$2(), this.wEyeDir, this.wUp), this.wEyeDir);
        normalize(this.wUp, this.wUp);
    }
    update() {
        // model matrix
        this.mModelMatrix = fromScaling(create$3(), fromValues$1(1, 1, 1 / this.groundRes));
        // view matrix
        lookAt(this.mViewMatrix, this.wEye, this.wLookAt, this.wUp);
        // TODO: get the aspect ratio from canvas?
        // mat4.ortho(this.mProjectionMatrix, -4500, 4500, -4500, 4500, -1500, this.wFar);
        perspective(this.mProjectionMatrix, this.fovy, 1, this.wNear, this.wFar);
        this._updateStatusCallback("camera", { position: [this.wOrigin[0], this.wOrigin[1], this.wEye[2] / 1000], direction: { right: [this.wEye[0], this.wEye[1], this.wEye[2]], lookAt: [this.wLookAt[0], this.wLookAt[1], this.wLookAt[2]], up: [this.wUp[0], this.wUp[1], this.wUp[2]] } });
    }
    getZoomLevel() {
        return this.wEye[2] / 1000;
    }
    loadPosition(state) {
        const stateObj = JSON.parse(state);
        const viewData = Object.values(stateObj.mViewMatrix);
        const modelData = Object.values(stateObj.mModelMatrix);
        const projData = Object.values(stateObj.mProjectionMatrix);
        const oData = Object.values(stateObj.wOrigin);
        this.mViewMatrix = create$3();
        set$2(this.mViewMatrix, viewData[0], viewData[1], viewData[2], viewData[3], viewData[4], viewData[5], viewData[6], viewData[7], viewData[8], viewData[9], viewData[10], viewData[11], viewData[12], viewData[13], viewData[14], viewData[15]);
        this.mModelMatrix = create$3();
        set$2(this.mModelMatrix, modelData[0], modelData[1], modelData[2], modelData[3], modelData[4], modelData[5], modelData[6], modelData[7], modelData[8], modelData[9], modelData[10], modelData[11], modelData[12], modelData[13], modelData[14], modelData[15]);
        this.mProjectionMatrix = create$3();
        set$2(this.mProjectionMatrix, projData[0], projData[1], projData[2], projData[3], projData[4], projData[5], projData[6], projData[7], projData[8], projData[9], projData[10], projData[11], projData[12], projData[13], projData[14], projData[15]);
        this.wOrigin = fromValues(oData[0], oData[1]);
    }
    screenCoordToWorldDir(x, y) {
        const wRight = create$2();
        normalize(wRight, cross(wRight, this.wEyeDir, this.wUp));
        const upOffset = scale(create$2(), this.wUp, Math.tan(this.fovy / 2) * (y - 0.5) * 2);
        const rightOffset = scale(create$2(), wRight, Math.tan(this.fovy / 2) * (x - 0.5) * 2);
        const offset = add(create$2(), upOffset, rightOffset);
        const dir = add(create$2(), this.wEyeDir, offset);
        normalize(dir, dir);
        return dir;
    }
    getUpVector() {
        return this.wUp;
    }
    // Calculates the right vector of the camera
    getRightVector() {
        const wRight = create$2();
        normalize(wRight, cross(wRight, this.wEyeDir, this.wUp));
        return wRight;
    }
    screenCoordToLatLng(x, y) {
        const dir = this.screenCoordToWorldDir(x, y);
        const t = -this.wEye[2] / dir[2];
        if (t > 0) {
            const intersectPoint = scaleAndAdd(create$2(), this.wEye, dir, t);
            const originCoord = GeoUtils.latLng2Coord(this.wOrigin[0], this.wOrigin[1]);
            const latLng = GeoUtils.coord2LatLng(intersectPoint[0] + originCoord[0], intersectPoint[1] + originCoord[1]);
            return latLng;
        }
        return null;
    }
    setPosition(x, y) {
        let newEye = [x - this.wOrigin[0], y - this.wOrigin[1]];
        add(this.wEye, this.wEye, [newEye[0] - this.wEye[0], newEye[1] - this.wEye[1], 0]);
        scaleAndAdd(this.wLookAt, this.wEye, this.wEyeDir, this.wEyeLength);
    }
    activateBirdsEye() {
        throw Error("BirdsEye view not implemented yet");
    }
}
var CameraFactory = (function () {
    var instance;
    return {
        getInstance: function () {
            if (instance == null) {
                instance = new Camera();
            }
            return instance;
        }
    };
})();

class KeyEvents {
    // div to attach the events
    _map;
    setMap(map) {
        this._map = map;
    }
    bindEvents() {
        // sets the key listeners
        window.addEventListener('keyup', this.keyUp.bind(this), false);
    }
    /**
    * Handles key up event
    * @param {KeyboardEvent} event The fired event
    */
    async keyUp(event) {
        // plot texture based of brush
        if (event.key == "Enter") {
            for (const knot of this._map.knotManager.knots) {
                knot.interact(this._map.glContext, "enter");
            }
            this._map.render();
        }
        // clean abstract surfaces
        if (event.key == "r") {
            for (const knot of this._map.knotManager.knots) {
                knot.interact(this._map.glContext, "r");
            }
            this._map.render();
        }
        // select a building to do the footprint plot
        if (event.key == "t") {
            for (const knot of this._map.knotManager.knots) {
                knot.interact(this._map.glContext, "t", this._map.mouse.currentPoint);
            }
        }
        if (event.key == "q") {
            this._map.layerManager.filterBbox = []; // reset filter
            this._map.updateGrammarPlotsData();
            this._map.render();
        }
    }
}
var KeyEventsFactory = (function () {
    var instance;
    return {
        getInstance: function () {
            if (instance == null) {
                instance = new KeyEvents();
                instance.bindEvents();
            }
            return instance;
        }
    };
})();

var vsFlatColorMap = "#version 300 es\nconst float pi=3.1415926535897932384626433832795;const float pi_180=0.017453292519943295769236907684886127134428718885417254560;const float pi_4=12.56637061435917295385057353311801153678867759750042328389;uniform highp mat4 uModelViewMatrix;uniform highp mat4 uProjectionMatrix;uniform highp vec2 uWorldOrigin;in highp vec3 vertCoords;in highp float funcValues;in lowp float inFiltered;out highp vec2 texCoords;out lowp float filtered;vec2 latLngToPixel(highp float latitude,highp float longitude){highp float sinLatitude=sin(latitude*pi_180);highp float pixelY=256.0-((0.5-log((1.0+sinLatitude)/(1.0-sinLatitude))/(pi_4))*256.0);highp float pixelX=((longitude+180.0)/360.0)*256.0;return vec2(pixelX,pixelY);}void main(){highp vec3 finalPos=vertCoords;filtered=inFiltered;texCoords=vec2(funcValues,0);gl_Position=uProjectionMatrix*uModelViewMatrix*vec4(finalPos,1.0);}";

var fsFlatColorMap = "#version 300 es\nuniform sampler2D uColorMap;in highp vec2 texCoords;in lowp float filtered;out highp vec4 fragColor;void main(){if(filtered<=0.5){fragColor=vec4(0.5,0.5,0.5,0.7);}else{fragColor=vec4(texture(uColorMap,texCoords).rgb,1.0);}}";

class ShaderFlatColorMap extends Shader {
    // Data to be rendered
    _coords = [];
    _function = [];
    _indices = [];
    // TODO decide which function to use
    _functionToUse = 0;
    // Color map definition
    _colorMap = null;
    // Data loaction on GPU
    _glCoords = null;
    _glFunction = null;
    _glIndices = null;
    _glFiltered = null;
    // Data has chaged
    _coordsDirty = false;
    _functionDirty = false;
    _colorMapDirty = false;
    _filteredDirty = false;
    // Id of each property in the VAO
    _coordsId = -1;
    _functionId = -1;
    _filteredId = -1;
    // Uniforms location
    _uModelViewMatrix = null;
    _uProjectionMatrix = null;
    _uWorldOrigin = null;
    _uColorMap = null;
    _filtered = [];
    // Color map texture
    _texColorMap;
    constructor(glContext, colorMap = "interpolateReds") {
        super(vsFlatColorMap, fsFlatColorMap, glContext);
        // saves the layer color
        this._colorMap = colorMap;
        // creathe dhe shader variables    
        this.createUniforms(glContext);
        this.createVertexArrayObject(glContext);
        this.createTextures(glContext);
    }
    updateShaderGeometry(mesh) {
        this._coordsDirty = true;
        this._filteredDirty = true;
        this._coords = mesh.getCoordinatesVBO();
        this._indices = mesh.getIndicesVBO();
        let totalNumberOfCoords = mesh.getTotalNumberOfCoords();
        for (let i = 0; i < totalNumberOfCoords; i++) {
            this._filtered.push(1.0); // 1 true to include
        }
    }
    updateShaderData(mesh, knot) {
        this._currentKnot = knot;
        this._functionDirty = true;
        this._function = mesh.getFunctionVBO(knot.id);
        let maxFuncValue = null;
        let minFuncValue = null;
        for (let i = 0; i < this._function[this._functionToUse].length; i++) {
            let value = this._function[this._functionToUse][i];
            // get param for min max normalization only for filtered elements
            if (this._filtered.length == 0 || this._filtered[i] == 1) {
                if (maxFuncValue == null) {
                    maxFuncValue = value;
                }
                else if (value > maxFuncValue) {
                    maxFuncValue = value;
                }
                if (minFuncValue == null) {
                    minFuncValue = value;
                }
                else if (value < minFuncValue) {
                    minFuncValue = value;
                }
            }
        }
        // min max normalization
        if (maxFuncValue != null && minFuncValue != null && maxFuncValue - minFuncValue != 0 && maxFuncValue >= 0 && minFuncValue >= 0) {
            for (let i = 0; i < this._function[this._functionToUse].length; i++) {
                this._function[this._functionToUse][i] = (this._function[this._functionToUse][i] - minFuncValue) / (maxFuncValue - minFuncValue);
            }
        }
    }
    updateShaderUniforms(data) {
        this._colorMapDirty = true;
        this._colorMap = data;
    }
    createUniforms(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        this._uModelViewMatrix = glContext.getUniformLocation(this._shaderProgram, 'uModelViewMatrix');
        this._uProjectionMatrix = glContext.getUniformLocation(this._shaderProgram, 'uProjectionMatrix');
        this._uWorldOrigin = glContext.getUniformLocation(this._shaderProgram, 'uWorldOrigin');
    }
    bindUniforms(glContext, camera) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.uniformMatrix4fv(this._uModelViewMatrix, false, camera.getModelViewMatrix());
        glContext.uniformMatrix4fv(this._uProjectionMatrix, false, camera.getProjectionMatrix());
        glContext.uniform2fv(this._uWorldOrigin, camera.getWorldOrigin());
    }
    setFiltered(filtered) {
        if (filtered.length == 0) {
            this._filtered = Array(this._filtered.length).fill(1.0);
        }
        else {
            this._filtered = filtered;
        }
        this._filteredDirty = true;
    }
    createTextures(glContext) {
        if (!this._colorMap) {
            return;
        }
        this._uColorMap = glContext.getUniformLocation(this._shaderProgram, 'uColorMap');
        this._texColorMap = glContext.createTexture();
        glContext.bindTexture(glContext.TEXTURE_2D, this._texColorMap);
        // Set the parameters so we can render any size image.
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.NEAREST);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MAG_FILTER, glContext.NEAREST);
        // Upload the image into the texture.
        const texData = ColorMap.getColorMap(this._colorMap);
        const size = [256, 1];
        glContext.texImage2D(glContext.TEXTURE_2D, 0, glContext.RGB32F, size[0], size[1], 0, glContext.RGB, glContext.FLOAT, new Float32Array(texData));
    }
    bindTextures(glContext) {
        // set which texture units to render with.
        glContext.uniform1i(this._uColorMap, 0);
        glContext.activeTexture(glContext.TEXTURE0);
        glContext.bindTexture(glContext.TEXTURE_2D, this._texColorMap);
    }
    createVertexArrayObject(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        // Creates the coords id.
        this._coordsId = glContext.getAttribLocation(this._shaderProgram, 'vertCoords');
        // Create a buffer for the positions.
        this._glCoords = glContext.createBuffer();
        this._filteredId = glContext.getAttribLocation(this._shaderProgram, 'inFiltered');
        this._glFiltered = glContext.createBuffer();
        // Creates the coords id.
        this._functionId = glContext.getAttribLocation(this._shaderProgram, 'funcValues');
        // Creates the function id
        this._glFunction = glContext.createBuffer();
        // Creates the elements buffer
        this._glIndices = glContext.createBuffer();
    }
    bindVertexArrayObject(glContext, mesh) {
        if (!this._shaderProgram) {
            return;
        }
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glCoords);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._coords), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._coordsId, mesh.dimension, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._coordsId);
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glFiltered);
        if (this._filteredDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._filtered), glContext.STATIC_DRAW);
        }
        glContext.vertexAttribPointer(this._filteredId, 1, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._filteredId);
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glFunction);
        // send data to gpu
        if (this._functionDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._function[this._functionToUse]), glContext.STATIC_DRAW);
        }
        glContext.vertexAttribPointer(this._functionId, 1, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._functionId);
        // binds the indices buffer
        glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndices);
        // send data to g4pu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ELEMENT_ARRAY_BUFFER, new Uint32Array(this._indices), glContext.STATIC_DRAW);
        }
        this._coordsDirty = false;
        this._functionDirty = false;
        this._filteredDirty = false;
    }
    setHighlightElements(coordinates, value) {
        throw Error("The shader flat color map can not highlight elements yet");
    }
    renderPass(glContext, glPrimitive, camera, mesh, zOrder) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.useProgram(this._shaderProgram);
        // binds data
        this.bindUniforms(glContext, camera);
        glContext.stencilFunc(glContext.GEQUAL, // the test
        zOrder, // reference value
        0xFF);
        glContext.stencilOp(glContext.KEEP, // what to do if the stencil test fails
        glContext.KEEP, // what to do if the depth test fails
        glContext.REPLACE);
        this.bindVertexArrayObject(glContext, mesh);
        this.bindTextures(glContext);
        // draw the geometry
        glContext.drawElements(glPrimitive, this._indices.length, glContext.UNSIGNED_INT, 0);
    }
}

var vsSmoothColorMap = "#version 300 es\nconst float pi=3.1415926535897932384626433832795;const float pi_180=0.017453292519943295769236907684886127134428718885417254560;const float pi_4=12.56637061435917295385057353311801153678867759750042328389;uniform highp mat4 uModelViewMatrix;uniform highp mat4 uProjectionMatrix;uniform highp vec2 uWorldOrigin;in highp vec3 vertCoords;in highp vec3 vertNormals;in highp float funcValues;in lowp float inColorOrPicked;in highp vec2 inDiscardFuncInterval;in lowp float inFiltered;out highp vec2 texCoords;out highp vec3 fragNormals;out lowp float vColorOrPicked;out lowp float filtered;out highp vec2 discardFuncInterval;vec2 latLngToPixel(highp float latitude,highp float longitude){highp float sinLatitude=sin(latitude*pi_180);highp float pixelY=256.0-((0.5-log((1.0+sinLatitude)/(1.0-sinLatitude))/(pi_4))*256.0);highp float pixelX=((longitude+180.0)/360.0)*256.0;return vec2(pixelX,pixelY);}void main(){highp vec3 finalPos=vertCoords;texCoords=vec2(funcValues,0);fragNormals=vertNormals;vColorOrPicked=inColorOrPicked;filtered=inFiltered;discardFuncInterval=inDiscardFuncInterval;gl_Position=uProjectionMatrix*uModelViewMatrix*vec4(finalPos,1.0);}";

var fsSmoothColorMap = "#version 300 es\nuniform sampler2D uColorMap;in highp vec2 texCoords;in highp vec3 fragNormals;in highp vec2 discardFuncInterval;in highp float varyOpByFunc;in lowp float vColorOrPicked;in lowp float filtered;out highp vec4 fragColor;void main(){highp vec3 texColor=texture(uColorMap,texCoords).rgb;highp vec3 light=normalize(vec3(1.0,0.0,1.0));highp vec3 normal=normalize(fragNormals);highp float diffuse=max(dot(normal,light)*0.7,0.0);highp float ambient=0.25;highp vec3 shade=vec3(1.0,1.0,1.0)*(diffuse+ambient);if((discardFuncInterval[0]!=-1.0||discardFuncInterval[1]!=-1.0)&&(texCoords[0]>=discardFuncInterval[0]&&texCoords[0]<=discardFuncInterval[1])){discard;}else if(filtered<=0.5){fragColor=vec4(0.5,0.5,0.5,0.7);}else{if(vColorOrPicked>0.5){fragColor=vec4(0,0,1,1);}else{fragColor=vec4(texColor,1.0);}}}";

/**
 * Abstract class for the picking auxiliary shaders
 */
class AuxiliaryShaderTriangles extends Shader {
}

const d3$2 = require('d3');
class ShaderSmoothColorMap extends AuxiliaryShaderTriangles {
    // Data to be rendered
    _coords = [];
    _normals = [];
    _function = [];
    _indices = [];
    _discardFuncInterval = [];
    _coordsPerComp = [];
    // protected _varyOpByFunc: number[] = [];
    // TODO remove
    _functionToUse = 0;
    // Color map definition
    _colorMap = null;
    _colorMapReverse = false;
    // Data loaction on GPU
    _glCoords = null;
    _glNormals = null;
    _glFunction = null;
    _glIndices = null;
    _gldiscardFuncInterval = null;
    _glColorOrPicked = null;
    _glFiltered = null;
    // protected _glVaryOpByFunc: WebGLBuffer | null = null;
    // Data has chaged
    _coordsDirty = false;
    _functionDirty = false;
    _colorMapDirty = false;
    _colorOrPickedDirty = false;
    _filteredDirty = false;
    // Id of each property in the VAO
    _coordsId = -1;
    _normalsId = -1;
    _functionId = -1;
    _discardFuncIntervalId = -1;
    _colorOrPickedId = -1;
    _filteredId = -1;
    // protected _varyOpByFuncId = -1;
    // Uniforms location
    _uModelViewMatrix = null;
    _uProjectionMatrix = null;
    _uWorldOrigin = null;
    _uColorMap = null;
    // Color map texture
    _texColorMap;
    //Picking
    _colorOrPicked = [];
    _currentPickedElement; // stores the index of the currently picked element
    _filtered = [];
    constructor(glContext, colorMap = "interpolateReds") {
        super(vsSmoothColorMap, fsSmoothColorMap, glContext);
        // saves the layer color
        this._colorMap = colorMap;
        // creathe dhe shader variables    
        this.createUniforms(glContext);
        this.createVertexArrayObject(glContext);
        this.createTextures(glContext);
    }
    get currentPickedElement() {
        return this._currentPickedElement;
    }
    updateShaderGeometry(mesh) {
        this._coordsDirty = true;
        this._filteredDirty = true;
        this._coords = mesh.getCoordinatesVBO();
        this._normals = mesh.getNormalsVBO();
        this._indices = mesh.getIndicesVBO();
        this._discardFuncInterval = mesh.getDiscardFuncIntervalVBO();
        this._coordsPerComp = mesh.getCoordsPerComp();
        let totalNumberOfCoords = mesh.getTotalNumberOfCoords();
        // start showing only colors without filters by default
        for (let i = 0; i < totalNumberOfCoords; i++) {
            this._colorOrPicked.push(0.0);
            this._filtered.push(1.0); // 1 true to include
        }
        // this._varyOpByFunc = mesh.getVaryOpByFuncVBO();
    }
    setFiltered(filtered) {
        if (filtered.length == 0) {
            this._filtered = Array(this._filtered.length).fill(1.0);
        }
        else {
            this._filtered = filtered;
        }
        this._filteredDirty = true;
    }
    updateShaderData(mesh, knot) {
        this._currentKnot = knot;
        this._functionDirty = true;
        this._colorOrPickedDirty = true;
        this._function = mesh.getFunctionVBO(knot.id);
        let scale = d3$2.scaleLinear().domain(d3$2.extent(this._function[this._functionToUse])).range([0, 1]);
        for (let i = 0; i < this._function[this._functionToUse].length; i++) {
            this._function[this._functionToUse][i] = scale(this._function[this._functionToUse][i]);
        }
    }
    updateShaderUniforms(data) {
        this._colorMapDirty = true;
        this._colorMap = data;
    }
    createUniforms(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        this._uModelViewMatrix = glContext.getUniformLocation(this._shaderProgram, 'uModelViewMatrix');
        this._uProjectionMatrix = glContext.getUniformLocation(this._shaderProgram, 'uProjectionMatrix');
        this._uWorldOrigin = glContext.getUniformLocation(this._shaderProgram, 'uWorldOrigin');
    }
    bindUniforms(glContext, camera) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.uniformMatrix4fv(this._uModelViewMatrix, false, camera.getModelViewMatrix());
        glContext.uniformMatrix4fv(this._uProjectionMatrix, false, camera.getProjectionMatrix());
        glContext.uniform2fv(this._uWorldOrigin, camera.getWorldOrigin());
    }
    createTextures(glContext) {
        if (!this._colorMap) {
            return;
        }
        this._uColorMap = glContext.getUniformLocation(this._shaderProgram, 'uColorMap');
        this._texColorMap = glContext.createTexture();
        glContext.bindTexture(glContext.TEXTURE_2D, this._texColorMap);
        // Set the parameters so we can render any size image.
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.NEAREST);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MAG_FILTER, glContext.NEAREST);
        // Upload the image into the texture.
        const texData = ColorMap.getColorMap(this._colorMap);
        const size = [256, 1];
        glContext.texImage2D(glContext.TEXTURE_2D, 0, glContext.RGB32F, size[0], size[1], 0, glContext.RGB, glContext.FLOAT, new Float32Array(texData));
    }
    bindTextures(glContext) {
        // set which texture units to render with.
        glContext.uniform1i(this._uColorMap, 0);
        glContext.activeTexture(glContext.TEXTURE0);
        glContext.bindTexture(glContext.TEXTURE_2D, this._texColorMap);
    }
    createVertexArrayObject(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        // Creates the coords id.
        this._coordsId = glContext.getAttribLocation(this._shaderProgram, 'vertCoords');
        // Create a buffer for the positions.
        this._glCoords = glContext.createBuffer();
        // Creates the coords id.
        this._normalsId = glContext.getAttribLocation(this._shaderProgram, 'vertNormals');
        // Create a buffer for the positions.
        this._glNormals = glContext.createBuffer();
        this._colorOrPickedId = glContext.getAttribLocation(this._shaderProgram, 'inColorOrPicked');
        this._glColorOrPicked = glContext.createBuffer();
        this._filteredId = glContext.getAttribLocation(this._shaderProgram, 'inFiltered');
        this._glFiltered = glContext.createBuffer();
        // Creates the coords id.
        this._functionId = glContext.getAttribLocation(this._shaderProgram, 'funcValues');
        // Creates the function id
        this._glFunction = glContext.createBuffer();
        this._discardFuncIntervalId = glContext.getAttribLocation(this._shaderProgram, 'inDiscardFuncInterval');
        this._gldiscardFuncInterval = glContext.createBuffer();
        // this._varyOpByFuncId = glContext.getAttribLocation(this._shaderProgram, 'varyOpByFunc');
        // this._glVaryOpByFunc = glContext.createBuffer();
        // Creates the elements buffer
        this._glIndices = glContext.createBuffer();
    }
    bindVertexArrayObject(glContext, mesh) {
        if (!this._shaderProgram) {
            return;
        }
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glCoords);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._coords), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._coordsId, mesh.dimension, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._coordsId);
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glNormals);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._normals), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._normalsId, mesh.dimension, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._normalsId);
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glFunction);
        // send data to gpu
        if (this._functionDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._function[this._functionToUse]), glContext.STATIC_DRAW);
        }
        glContext.vertexAttribPointer(this._functionId, 1, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._functionId);
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glColorOrPicked);
        if (this._colorOrPickedDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._colorOrPicked), glContext.STATIC_DRAW);
        }
        glContext.vertexAttribPointer(this._colorOrPickedId, 1, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._colorOrPickedId);
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glFiltered);
        if (this._filteredDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._filtered), glContext.STATIC_DRAW);
        }
        glContext.vertexAttribPointer(this._filteredId, 1, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._filteredId);
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._gldiscardFuncInterval);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._discardFuncInterval), glContext.STATIC_DRAW);
        }
        glContext.vertexAttribPointer(this._discardFuncIntervalId, 2, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._discardFuncIntervalId);
        // binds the position buffer
        // glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glVaryOpByFunc);
        // // send data to gpu
        // if (this._coordsDirty) {
        //     glContext.bufferData(
        //         glContext.ARRAY_BUFFER, new Float32Array(this._varyOpByFunc), glContext.STATIC_DRAW
        //     );
        // }
        // glContext.vertexAttribPointer(this._varyOpByFuncId, 1, glContext.FLOAT, false, 0, 0);
        // glContext.enableVertexAttribArray(this._varyOpByFuncId);    
        // binds the indices buffer
        glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndices);
        // send data to g4pu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ELEMENT_ARRAY_BUFFER, new Uint32Array(this._indices), glContext.STATIC_DRAW);
        }
        this._coordsDirty = false;
        this._functionDirty = false;
        this._colorOrPickedDirty = false;
        this._filteredDirty = false;
    }
    setHighlightElements(coordinates, value) {
        for (const coordIndex of coordinates) {
            if (value)
                this._colorOrPicked[coordIndex] = 1;
            else
                this._colorOrPicked[coordIndex] = 0;
        }
        this._colorOrPickedDirty = true;
    }
    clearPicking() {
        for (let i = 0; i < this._colorOrPicked.length; i++) {
            this._colorOrPicked[i] = 0;
        }
        this._colorOrPickedDirty = true;
    }
    setPickedObject(objectId) {
        this._currentPickedElement = objectId;
        let readCoords = 0;
        for (let i = 0; i < this._coordsPerComp.length; i++) {
            if (objectId == i) {
                break;
            }
            readCoords += this._coordsPerComp[i];
        }
        for (let i = 0; i < this._coordsPerComp[objectId]; i++) {
            if (this._colorOrPicked[readCoords + i] == 1) {
                this._colorOrPicked[readCoords + i] = 0;
            }
            else if (this._colorOrPicked[readCoords + i] == 0) {
                this._colorOrPicked[readCoords + i] = 1;
            }
        }
        this._colorOrPickedDirty = true;
    }
    renderPass(glContext, glPrimitive, camera, mesh, zOrder) {
        if (!this._shaderProgram) {
            return;
        }
        // glContext.enable(glContext.BLEND);
        // glContext.blendFunc(glContext.SRC_ALPHA, glContext.ONE_MINUS_SRC_ALPHA);
        glContext.useProgram(this._shaderProgram);
        // binds data
        this.bindUniforms(glContext, camera);
        if (glPrimitive != glContext.POINTS) {
            glContext.stencilFunc(glContext.GEQUAL, // the test
            zOrder, // reference value
            0xFF);
            glContext.stencilOp(glContext.KEEP, // what to do if the stencil test fails
            glContext.KEEP, // what to do if the depth test fails
            glContext.REPLACE);
        }
        this.bindVertexArrayObject(glContext, mesh);
        this.bindTextures(glContext);
        glContext.drawElements(glPrimitive, this._indices.length, glContext.UNSIGNED_INT, 0);
        // glContext.disable(glContext.BLEND);
    }
}

var vsPicking = "#version 300 es\nconst float pi=3.1415926535897932384626433832795;const float pi_180=0.017453292519943295769236907684886127134428718885417254560;const float pi_4=12.56637061435917295385057353311801153678867759750042328389;uniform highp mat4 uModelViewMatrix;uniform highp mat4 uProjectionMatrix;uniform highp vec2 uWorldOrigin;in highp vec3 vertCoords;in highp vec4 objectsIds;out highp vec4 idColors;vec2 latLngToPixel(highp float latitude,highp float longitude){highp float sinLatitude=sin(latitude*pi_180);highp float pixelY=256.0-((0.5-log((1.0+sinLatitude)/(1.0-sinLatitude))/(pi_4))*256.0);highp float pixelX=((longitude+180.0)/360.0)*256.0;return vec2(pixelX,pixelY);}void main(){highp vec3 finalPos=vertCoords;idColors=objectsIds;gl_Position=uProjectionMatrix*uModelViewMatrix*vec4(finalPos,1.0);}";

var fsPicking = "#version 300 es\nin highp vec4 idColors;out highp vec4 fragColor;void main(){fragColor=idColors;}";

/**
 * This shader should only be used with the buildings layer
 */
class ShaderPickingTriangles extends Shader {
    // Data to be rendered
    _coords = [];
    _indices = [];
    _objectsIds = [];
    // Data loaction on GPU
    _glCoords = null;
    _glIndices = null;
    _glObjectsIds = null;
    // Data has chaged
    _coordsDirty = false;
    _resizeDirty = true;
    _pickObjectDirty = false;
    _objectsIdsDirty = false;
    _pickFilterDirty = false;
    // Id of each property in the VAO
    _coordsId = -1;
    _objectsIdsId = -1;
    // Uniforms location
    _uModelViewMatrix = null;
    _uProjectionMatrix = null;
    _uWorldOrigin = null;
    _uColorMap = null;
    // Texture to support picking
    _texPicking = null;
    _depthBuffer = null;
    _frameBuffer = null;
    // Picking positions
    _pixelX;
    _pixelY;
    _pixelXFilter;
    _pixelYFilter;
    _pickingWidth;
    _pickingHeight;
    _pickingFilterWidth;
    _pickingFilterHeight;
    _selectedFiltered; // ids of elements selected by the user to build the filtering bbox
    _filtered = []; // coordinates to disconsider in further interactions
    _objectPixelX;
    _objectPixelY;
    _auxiliaryShader;
    _coordsPerComp;
    /**
     *
     * @param {AuxiliaryShaderTriangles} auxiliaryShaderTriangles The shader responsible for receiving picking data
     */
    constructor(glContext, auxiliaryShaderTriangles) {
        super(vsPicking, fsPicking, glContext);
        this._auxiliaryShader = auxiliaryShaderTriangles;
        // creathe the shader variables    
        this.createUniforms(glContext);
        this.createVertexArrayObject(glContext);
        this.createTextures(glContext);
    }
    /**
     * Sets the resize dirty information
     */
    set resizeDirty(resizeDirty) {
        this._resizeDirty = resizeDirty;
    }
    get selectedFiltered() {
        return this._selectedFiltered;
    }
    getBboxFiltered(mesh) {
        let coordsPerComp = mesh.getCoordsPerComp();
        let minX = null;
        let minY = null;
        let maxX = null;
        let maxY = null;
        let readCoords = 0;
        for (let i = 0; i < coordsPerComp.length; i++) {
            if (this._selectedFiltered.includes(i)) {
                for (let j = 0; j < coordsPerComp[i]; j++) {
                    let x = this._coords[(readCoords + j) * mesh.dimension];
                    let y = this._coords[(readCoords + j) * mesh.dimension + 1];
                    if (minX == null) {
                        minX = x;
                    }
                    else if (x < minX) {
                        minX = x;
                    }
                    if (minY == null) {
                        minY = y;
                    }
                    else if (y < minY) {
                        minY = y;
                    }
                    if (maxX == null) {
                        maxX = x;
                    }
                    else if (x > maxX) {
                        maxX = x;
                    }
                    if (maxY == null) {
                        maxY = y;
                    }
                    else if (y > maxY) {
                        maxY = y;
                    }
                }
            }
            readCoords += coordsPerComp[i];
        }
        if (minX == null) {
            minX = 0;
        }
        if (minY == null) {
            minY = 0;
        }
        if (maxX == null) {
            maxX = 0;
        }
        if (maxY == null) {
            maxY = 0;
        }
        return [minX, minY, maxX, maxY];
    }
    updateShaderGeometry(mesh) {
        this._coordsDirty = true;
        this._objectsIdsDirty = true;
        this._coords = mesh.getCoordinatesVBO();
        this._indices = mesh.getIndicesVBO();
        this._objectsIds = [];
        this._coordsPerComp = mesh.getCoordsPerComp();
        for (let i = 0; i < this._coordsPerComp.length; i++) {
            for (let k = 0; k < this._coordsPerComp[i]; k++) {
                this._objectsIds.push(((i >> 0) & 0xFF) / 0xFF);
                this._objectsIds.push(((i >> 8) & 0xFF) / 0xFF);
                this._objectsIds.push(((i >> 16) & 0xFF) / 0xFF);
                this._objectsIds.push(((i >> 24) & 0xFF) / 0xFF);
            }
        }
        let totalNumberOfCoords = mesh.getTotalNumberOfCoords();
        for (let i = 0; i < totalNumberOfCoords; i++) {
            this._filtered.push(1.0); // 1 true to include
        }
    }
    setFiltered(filtered) {
        if (filtered.length == 0) {
            this._filtered = Array(this._filtered.length).fill(1.0);
        }
        else {
            this._filtered = filtered;
        }
        // this._filteredDirty = true;
    }
    updatePickPosition(pixelX, pixelY, width, height) {
        this._pixelX = pixelX;
        this._pixelY = pixelY;
        if (width == 0) {
            this._pickingWidth = 1;
        }
        else {
            this._pickingWidth = width;
        }
        if (height == 0) {
            this._pickingHeight = 1;
        }
        else {
            this._pickingHeight = height;
        }
    }
    updatePickFilterPosition(pixelX, pixelY, width, height) {
        this._pickFilterDirty = true;
        this._pixelXFilter = pixelX;
        this._pixelYFilter = pixelY;
        if (width == 0) {
            this._pickingFilterWidth = 1;
        }
        else {
            this._pickingFilterWidth = width;
        }
        if (height == 0) {
            this._pickingFilterHeight = 1;
        }
        else {
            this._pickingFilterHeight = height;
        }
    }
    pickPixelFilter(glContext) {
        const data = new Uint8Array(Math.ceil(Math.abs(this._pickingFilterHeight) * Math.abs(this._pickingFilterWidth) * 4));
        for (let i = 0; i < data.length; i++) { // initializing data array with 255 to recognize not used positions
            data[i] = 255;
        }
        glContext.readPixels(this._pixelXFilter, // x
        this._pixelYFilter, // y
        this._pickingFilterWidth, // width
        this._pickingFilterHeight, // height
        glContext.RGBA, // format
        glContext.UNSIGNED_BYTE, // type
        data); // typed array to hold result
        let ids = new Set();
        let dataByFour = Math.floor(data.length / 4);
        for (let i = 0; i < dataByFour; i++) {
            if (data[i * 4] == 255 && data[i * 4 + 1] == 255 && data[i * 4 + 2] == 255 && data[i * 4 + 3] == 255) { // some portions of the data array are not used
                continue;
            }
            else {
                ids.add(data[i * 4] + (data[i * 4 + 1] << 8) + (data[i * 4 + 2] << 16) + (data[i * 4 + 3] << 24));
            }
        }
        this._selectedFiltered = Array.from(ids);
    }
    isFilteredIn(objectId) {
        if (this._filtered.length == 0) {
            return true;
        }
        else {
            let readCoords = 0;
            for (let i = 0; i < this._coordsPerComp.length; i++) {
                let countCoords = this._coordsPerComp[i];
                if (i == objectId) {
                    if (this._filtered[readCoords] == 1) {
                        return true;
                    }
                    else {
                        return false;
                    }
                }
                readCoords += countCoords;
            }
        }
        return false;
    }
    pickObject(glContext) {
        const data = new Uint8Array(4);
        glContext.readPixels(this._objectPixelX, // x
        this._objectPixelY, // y
        1, // width
        1, // height
        glContext.RGBA, // format
        glContext.UNSIGNED_BYTE, // type
        data); // typed array to hold result
        let id = data[0] + (data[1] << 8) + (data[2] << 16) + (data[3] << 24);
        if (this.isFilteredIn(id)) { // filtered in so can be interacted
            this._auxiliaryShader.setPickedObject(id);
        }
    }
    updatePickObjectPosition(pixelX, pixelY) {
        this._pickObjectDirty = true;
        this._objectPixelX = pixelX;
        this._objectPixelY = pixelY;
    }
    clearPicking() {
        this._auxiliaryShader.clearPicking();
    }
    updateShaderData(mesh, knot) {
        return;
    }
    updateShaderUniforms(data) {
        return;
    }
    setHighlightElements(coordinates, value) {
        this._auxiliaryShader.setHighlightElements(coordinates, value);
    }
    createUniforms(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        this._uModelViewMatrix = glContext.getUniformLocation(this._shaderProgram, 'uModelViewMatrix');
        this._uProjectionMatrix = glContext.getUniformLocation(this._shaderProgram, 'uProjectionMatrix');
        this._uWorldOrigin = glContext.getUniformLocation(this._shaderProgram, 'uWorldOrigin');
    }
    bindUniforms(glContext, camera) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.uniformMatrix4fv(this._uModelViewMatrix, false, camera.getModelViewMatrix());
        glContext.uniformMatrix4fv(this._uProjectionMatrix, false, camera.getProjectionMatrix());
        glContext.uniform2fv(this._uWorldOrigin, camera.getWorldOrigin());
    }
    setFramebufferAttachmentSizes(glContext, width, height) {
        glContext.bindTexture(glContext.TEXTURE_2D, this._texPicking);
        // define size and format of level 0
        const level = 0;
        const internalFormat = glContext.RGBA;
        const border = 0;
        const format = glContext.RGBA;
        const type = glContext.UNSIGNED_BYTE;
        const data = null;
        glContext.texImage2D(glContext.TEXTURE_2D, level, internalFormat, width, height, border, format, type, data);
        glContext.bindRenderbuffer(glContext.RENDERBUFFER, this._depthBuffer);
        glContext.renderbufferStorage(glContext.RENDERBUFFER, glContext.DEPTH_COMPONENT16, width, height);
    }
    createTextures(glContext) {
        // Create a texture to render to
        this._texPicking = glContext.createTexture();
        glContext.bindTexture(glContext.TEXTURE_2D, this._texPicking);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.LINEAR);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);
        // create a depth renderbuffer
        this._depthBuffer = glContext.createRenderbuffer();
        glContext.bindRenderbuffer(glContext.RENDERBUFFER, this._depthBuffer);
        // Create and bind the framebuffer
        this._frameBuffer = glContext.createFramebuffer();
        glContext.bindFramebuffer(glContext.FRAMEBUFFER, this._frameBuffer);
        // attach the texture as the first color attachment
        const attachmentPoint = glContext.COLOR_ATTACHMENT0;
        const level = 0;
        glContext.framebufferTexture2D(glContext.FRAMEBUFFER, attachmentPoint, glContext.TEXTURE_2D, this._texPicking, level);
        glContext.framebufferRenderbuffer(glContext.FRAMEBUFFER, glContext.DEPTH_ATTACHMENT, glContext.RENDERBUFFER, this._depthBuffer);
        glContext.bindFramebuffer(glContext.FRAMEBUFFER, null);
    }
    bindTextures(glContext) {
        glContext.bindFramebuffer(glContext.FRAMEBUFFER, this._frameBuffer);
    }
    createVertexArrayObject(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        this._objectsIdsId = glContext.getAttribLocation(this._shaderProgram, 'objectsIds');
        this._glObjectsIds = glContext.createBuffer();
        // Creates the coords id.
        this._coordsId = glContext.getAttribLocation(this._shaderProgram, 'vertCoords');
        // Create a buffer for the positions.
        this._glCoords = glContext.createBuffer();
        // Creates the elements buffer
        this._glIndices = glContext.createBuffer();
    }
    bindVertexArrayObject(glContext, mesh) {
        if (!this._shaderProgram) {
            return;
        }
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glObjectsIds);
        // send data to gpu
        if (this._objectsIdsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._objectsIds), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._objectsIdsId, 4, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._objectsIdsId);
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glCoords);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._coords), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._coordsId, mesh.dimension, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._coordsId);
        // binds the indices buffer
        glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndices);
        // send data to g4pu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ELEMENT_ARRAY_BUFFER, new Uint32Array(this._indices), glContext.STATIC_DRAW);
        }
        this._coordsDirty = false;
        this._objectsIdsDirty = false;
    }
    renderPass(glContext, glPrimitive, camera, mesh, zOrder) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.useProgram(this._shaderProgram);
        if (this._resizeDirty) {
            this.setFramebufferAttachmentSizes(glContext, glContext.canvas.width, glContext.canvas.height);
            this._resizeDirty = false;
        }
        // binds data
        this.bindTextures(glContext);
        this.bindUniforms(glContext, camera);
        this.bindVertexArrayObject(glContext, mesh);
        // draw the geometry
        glContext.drawElements(glPrimitive, this._indices.length, glContext.UNSIGNED_INT, 0);
        if (this._pickFilterDirty) {
            this.pickPixelFilter(glContext);
            this._pickFilterDirty = false;
        }
        if (this._pickObjectDirty) {
            this.pickObject(glContext);
            this._pickObjectDirty = false;
        }
        MapStyle.getColor('sky').concat([1.0]);
        let blankColorRGBA = [];
        blankColorRGBA.push(255);
        blankColorRGBA.push(255);
        blankColorRGBA.push(255);
        blankColorRGBA.push(255);
        glContext.clearColor(blankColorRGBA[0], blankColorRGBA[1], blankColorRGBA[2], blankColorRGBA[3]);
        glContext.clear(glContext.COLOR_BUFFER_BIT | glContext.DEPTH_BUFFER_BIT);
        glContext.bindFramebuffer(glContext.FRAMEBUFFER, null);
    }
}

class LinesLayer extends Layer {
    // protected _mesh: Mesh;
    _zOrder;
    _coordsByCOORDINATES = [];
    _coordsByCOORDINATES3D = [];
    _coordsByOBJECTS = [];
    _highlightByCOORDINATES = [];
    _highlightByCOORDINATES3D = [];
    _highlightByOBJECTS = [];
    constructor(info, dimensions = 2, order = 0, centroid, geometryData) {
        super(info.id, info.type, info.styleKey, info.renderStyle !== undefined ? info.renderStyle : [], centroid, dimensions, order);
        this.updateMeshGeometry(geometryData);
        // this._mesh = new Mesh(dimensions, order);
        this._zOrder = order;
    }
    supportInteraction(eventName) {
        return true;
    }
    updateMeshGeometry(data) {
        this._mesh.load(data, false, this._centroid);
    }
    getSelectedFiltering() {
        throw Error("Filtering not supported for line layer");
    }
    updateShaders(shaders) {
        // updates the shader references
        for (const shader of shaders) {
            shader.updateShaderGeometry(this._mesh);
        }
    }
    directAddMeshFunction(functionValues, knotId) {
        let distributedValues = this.distributeFunctionValues(functionValues);
        this._mesh.loadFunctionData(distributedValues, knotId);
    }
    updateFunction(knot, shaders) {
        // updates the shader references
        for (const shader of shaders) {
            shader.updateShaderData(this._mesh, knot);
        }
    }
    distributeFunctionValues(functionValues) {
        return functionValues;
    }
    innerAggFunc(functionValues, startLevel, endLevel, operation) {
        throw new Error("The layer lines only have the COORDINATES level, so no INNERAGG is possible");
    }
    setHighlightElements(elements, level, value) {
        throw new Error("Element highlighting not support for line layer yet");
    }
    getFunctionValueIndexOfId(id, level) {
        if (level == LevelType.COORDINATES3D) {
            throw new Error("COORDINATES3D level is not supported for layer lines");
        }
        if (level == LevelType.COORDINATES) {
            return id;
        }
        if (level == LevelType.OBJECTS) {
            let readCoords = 0;
            let coordsPerComp = this._mesh.getCoordsPerComp();
            for (let i = 0; i < coordsPerComp.length; i++) {
                if (i == id) { // assumes that all coordinates of the same object have the same function value
                    return readCoords;
                }
                readCoords += coordsPerComp[i];
            }
        }
        return null;
    }
    getCoordsByLevel(level) {
        let coordByLevel = [];
        if (level == LevelType.COORDINATES3D) {
            throw Error("Cannot get COORDINATES3D attached to line layer because it does not have a 3D representation");
        }
        if (level == LevelType.COORDINATES) {
            if (this._coordsByCOORDINATES.length == 0) {
                let coords = this._mesh.getCoordinatesVBO();
                for (let i = 0; i < coords.length / 3; i++) {
                    coordByLevel.push([coords[i * 3], coords[i * 3 + 1], coords[i * 3 + 2]]);
                }
                this._coordsByCOORDINATES = coordByLevel;
            }
            else {
                coordByLevel = this._coordsByCOORDINATES;
            }
        }
        if (level == LevelType.OBJECTS) {
            if (this._coordsByOBJECTS.length == 0) {
                let coords = this._mesh.getCoordinatesVBO();
                let readCoords = 0;
                let coordsPerComp = this._mesh.getCoordsPerComp();
                for (const numCoords of coordsPerComp) {
                    let groupedCoords = [];
                    for (let i = 0; i < numCoords; i++) {
                        groupedCoords.push(coords[i * 3 + (readCoords * 3)]);
                        groupedCoords.push(coords[i * 3 + 1 + (readCoords * 3)]);
                        groupedCoords.push(coords[i * 3 + 2 + (readCoords * 3)]);
                    }
                    readCoords += numCoords;
                    coordByLevel.push(groupedCoords);
                }
                this._coordsByOBJECTS = coordByLevel;
            }
            else {
                coordByLevel = this._coordsByOBJECTS;
            }
        }
        return coordByLevel;
    }
    getFunctionByLevel(level, knotId) {
        let functionByLevel = [];
        if (level == LevelType.COORDINATES3D) {
            throw Error("It is not possible to get abstract data from COORDINATES3D level in the line layer");
        }
        if (level == LevelType.COORDINATES) {
            let functionValues = this._mesh.getFunctionVBO(knotId)[0].map(x => [x]); // TODO: give support to more then one timestamps
            functionByLevel = functionValues;
        }
        if (level == LevelType.OBJECTS) {
            let functionValues = this._mesh.getFunctionVBO(knotId)[0];
            let readFunctions = 0;
            let coordsPerComp = this._mesh.getCoordsPerComp();
            for (const numCoords of coordsPerComp) {
                let groupedFunctions = [];
                for (let i = 0; i < numCoords; i++) {
                    groupedFunctions.push(functionValues[i + readFunctions]);
                }
                readFunctions += numCoords;
                functionByLevel.push(groupedFunctions);
            }
        }
        return functionByLevel;
    }
    getHighlightsByLevel(level) {
        let booleanHighlights = [];
        let highlightsByLevel = [];
        if (level == LevelType.COORDINATES3D) {
            throw Error("It is not possible to highlight COORDINATES3D in the line layer");
        }
        let totalNumberOfCoords = this._mesh.getTotalNumberOfCoords();
        for (let i = 0; i < totalNumberOfCoords; i++) {
            booleanHighlights.push(false);
        }
        if (level == LevelType.COORDINATES) {
            if (this._highlightByCOORDINATES.length == 0) {
                highlightsByLevel = booleanHighlights.map(x => [x]);
                this._highlightByCOORDINATES = highlightsByLevel;
            }
            else {
                highlightsByLevel = this._highlightByCOORDINATES;
            }
        }
        if (level == LevelType.OBJECTS) {
            if (this._highlightByOBJECTS.length == 0) {
                let readHighlights = 0;
                let coordsPerComp = this._mesh.getCoordsPerComp();
                for (const numCoords of coordsPerComp) {
                    let groupedHighlights = [];
                    for (let i = 0; i < numCoords; i++) {
                        groupedHighlights.push(booleanHighlights[i + readHighlights]);
                    }
                    readHighlights += numCoords;
                    highlightsByLevel.push(groupedHighlights);
                }
                this._highlightByOBJECTS = highlightsByLevel;
            }
            else {
                highlightsByLevel = this._highlightByOBJECTS;
            }
        }
        let flattenedHighlights = [];
        // flattening the highlight data
        for (const elemHighlights of highlightsByLevel) {
            let allHighlighted = true;
            for (const value of elemHighlights) {
                if (!value) {
                    allHighlighted = false;
                }
            }
            if (allHighlighted) // all the coordinates of the element must be highlighted for it to be considered highlighted
                flattenedHighlights.push(true);
            else
                flattenedHighlights.push(false);
        }
        return flattenedHighlights;
    }
    /**
     * Layer render function signature
     * @param {WebGL2RenderingContext} glContext WebGL context
     */
    render(glContext, shaders) {
        for (const shader of shaders) {
            if (shader instanceof ShaderFlatColorMap) {
                throw new Error("FLAT_COLOR_MAP is not suitable for line layers");
            }
            if (shader instanceof ShaderSmoothColorMap) {
                throw new Error("SMOOTH_COLOR_MAP is not suitable for line layers");
            }
            if (shader instanceof ShaderSmoothColorMapTex) {
                throw new Error("SMOOTH_COLOR_MAP_TEX is not suitable for line layers");
            }
            if (shader instanceof ShaderPicking || shader instanceof ShaderPickingTriangles) {
                throw new Error("PICKING is not suitable for line layers");
            }
            if (shader instanceof ShaderAbstractSurface) {
                throw new Error("ABSTRACT_SURFACES is not suitable for line layers");
            }
        }
        // enables the depth test
        glContext.enable(glContext.DEPTH_TEST);
        glContext.depthFunc(glContext.LEQUAL);
        // enable culling
        glContext.frontFace(glContext.CCW);
        glContext.enable(glContext.CULL_FACE);
        glContext.cullFace(glContext.BACK);
        // enables stencil
        glContext.enable(glContext.STENCIL_TEST);
        for (const shader of shaders) {
            shader.renderPass(glContext, glContext.LINE_STRIP, this._camera, this._mesh, this._zOrder);
        }
        // disables stencil
        glContext.disable(glContext.STENCIL_TEST);
        // disables the depth test
        glContext.disable(glContext.DEPTH_TEST);
        // disables culling
        glContext.disable(glContext.CULL_FACE);
    }
}

var vsFlatColor = "#version 300 es\nconst float pi=3.1415926535897932384626433832795;const float pi_180=0.017453292519943295769236907684886127134428718885417254560;const float pi_4=12.56637061435917295385057353311801153678867759750042328389;uniform highp mat4 uModelViewMatrix;uniform highp mat4 uProjectionMatrix;uniform highp vec2 uWorldOrigin;in highp vec3 vertCoords;vec2 latLngToPixel(highp float latitude,highp float longitude){highp float sinLatitude=sin(latitude*pi_180);highp float pixelY=256.0-((0.5-log((1.0+sinLatitude)/(1.0-sinLatitude))/(pi_4))*256.0);highp float pixelX=((longitude+180.0)/360.0)*256.0;return vec2(pixelX,pixelY);}void main(){highp vec3 finalPos=vertCoords;gl_Position=uProjectionMatrix*uModelViewMatrix*vec4(finalPos,1.0);}";

var fsFlatColor = "#version 300 es\nuniform highp vec3 uGlobalColor;out highp vec4 fragColor;void main(){fragColor=vec4(uGlobalColor,1.0);}";

class ShaderFlatColor extends Shader {
    // Data to be rendered
    _coords = [];
    _indices = [];
    _coordsPerComp = [];
    // Global color used on the layer
    _globalColor = [];
    // Data loaction on GPU
    _glCoords = null;
    _glIndices = null;
    // Data has chaged
    _coordsDirty = false;
    // Id of each property in the VAO
    _coordsId = -1;
    // Uniforms location
    _uModelViewMatrix = null;
    _uProjectionMatrix = null;
    _uWorldOrigin = null;
    _uGlobalColor = null;
    _filtered = [];
    constructor(glContext, color) {
        super(vsFlatColor, fsFlatColor, glContext);
        // saves the layer color
        this._globalColor = color;
        // creathe dhe shader variables
        this.createUniforms(glContext);
        this.createVertexArrayObject(glContext);
    }
    updateShaderGeometry(mesh) {
        this._coordsDirty = true;
        this._coords = mesh.getCoordinatesVBO();
        this._indices = mesh.getIndicesVBO();
        this._coordsPerComp = mesh.getCoordsPerComp();
        let totalNumberOfCoords = mesh.getTotalNumberOfCoords();
        for (let i = 0; i < totalNumberOfCoords; i++) {
            this._filtered.push(1.0); // 1 true to include
        }
    }
    updateShaderData(mesh, knot) {
        return;
    }
    updateShaderUniforms(data) {
        this._globalColor = data;
    }
    setHighlightElements(coordinates, value) {
        throw Error("The flat color shader can not highlight elements yet");
    }
    setFiltered(filtered) {
        if (filtered.length == 0) {
            this._filtered = Array(this._filtered.length).fill(1.0);
        }
        else {
            this._filtered = filtered;
        }
        // this._filteredDirty = true;
    }
    createUniforms(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        this._uModelViewMatrix = glContext.getUniformLocation(this._shaderProgram, 'uModelViewMatrix');
        this._uProjectionMatrix = glContext.getUniformLocation(this._shaderProgram, 'uProjectionMatrix');
        this._uWorldOrigin = glContext.getUniformLocation(this._shaderProgram, 'uWorldOrigin');
        this._uGlobalColor = glContext.getUniformLocation(this._shaderProgram, 'uGlobalColor');
    }
    bindUniforms(glContext, camera) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.uniformMatrix4fv(this._uModelViewMatrix, false, camera.getModelViewMatrix());
        glContext.uniformMatrix4fv(this._uProjectionMatrix, false, camera.getProjectionMatrix());
        glContext.uniform2fv(this._uWorldOrigin, camera.getWorldOrigin());
        glContext.uniform3fv(this._uGlobalColor, this._globalColor);
    }
    createTextures(glContext) {
        throw new Error("Method not implemented.");
    }
    bindTextures(glContext) {
        throw new Error("Method not implemented.");
    }
    createVertexArrayObject(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        // Creates the coords id.
        this._coordsId = glContext.getAttribLocation(this._shaderProgram, 'vertCoords');
        // Create a buffer for the positions.
        this._glCoords = glContext.createBuffer();
        // Creates the elements buffer
        this._glIndices = glContext.createBuffer();
    }
    bindVertexArrayObject(glContext, mesh) {
        if (!this._shaderProgram) {
            return;
        }
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glCoords);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._coords), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._coordsId, mesh.dimension, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._coordsId);
        // binds the indices buffer
        glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndices);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ELEMENT_ARRAY_BUFFER, new Uint32Array(this._indices), glContext.STATIC_DRAW);
        }
        this._coordsDirty = false;
    }
    renderPass(glContext, glPrimitive, camera, mesh, zOrder) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.useProgram(this._shaderProgram);
        this.bindUniforms(glContext, camera);
        glContext.stencilFunc(glContext.GEQUAL, // the test
        zOrder, // reference value
        0xFF);
        glContext.stencilOp(glContext.KEEP, // what to do if the stencil test fails
        glContext.KEEP, // what to do if the depth test fails
        glContext.REPLACE);
        this.bindVertexArrayObject(glContext, mesh);
        if (glPrimitive == glContext.LINE_STRIP) {
            let alreadyDrawn = 0;
            glContext.lineWidth(1);
            for (let i = 0; i < this._coordsPerComp.length; i++) { // draw each component individually
                glContext.drawArrays(glPrimitive, alreadyDrawn, this._coordsPerComp[i]);
                alreadyDrawn += this._coordsPerComp[i];
            }
        }
        else {
            // draw the geometry
            glContext.drawElements(glPrimitive, this._indices.length, glContext.UNSIGNED_INT, 0);
        }
    }
}

var vsSmoothColor = "#version 300 es\nconst float pi=3.1415926535897932384626433832795;const float pi_180=0.017453292519943295769236907684886127134428718885417254560;const float pi_4=12.56637061435917295385057353311801153678867759750042328389;uniform highp mat4 uModelViewMatrix;uniform highp mat4 uProjectionMatrix;uniform highp vec2 uWorldOrigin;in highp vec3 vertCoords;in highp vec3 vertNormals;in lowp float inFiltered;out highp vec3 fragNormals;out lowp float filtered;vec2 latLngToPixel(highp float latitude,highp float longitude){highp float sinLatitude=sin(latitude*pi_180);highp float pixelY=256.0-((0.5-log((1.0+sinLatitude)/(1.0-sinLatitude))/(pi_4))*256.0);highp float pixelX=((longitude+180.0)/360.0)*256.0;return vec2(pixelX,pixelY);}void main(){highp vec3 finalPos=vertCoords;filtered=inFiltered;fragNormals=vertNormals;gl_Position=uProjectionMatrix*uModelViewMatrix*vec4(finalPos,1.0);}";

var fsSmoothColor = "#version 300 es\nuniform highp vec3 uGlobalColor;in highp vec3 fragNormals;in lowp float filtered;out highp vec4 fragColor;void main(){if(filtered<=0.5){fragColor=vec4(0.5,0.5,0.5,0.7);}else{highp vec3 light=normalize(vec3(1.0,1.0,1.0));highp vec3 normal=normalize(fragNormals);highp float diffuse=max(dot(normal,light)*0.7,0.0);highp float ambient=0.25;highp vec3 shade=vec3(1.0,1.0,1.0)*(diffuse+ambient);fragColor=vec4(0.6*shade+0.4*uGlobalColor,1.0);}}";

class ShaderSmoothColor extends Shader {
    // Data to be rendered
    _coords = [];
    _normals = [];
    _indices = [];
    _coordsPerComp = [];
    // Global color used on the layer
    _globalColor = [];
    // Data loaction on GPU
    _glCoords = null;
    _glNormals = null;
    _glIndices = null;
    _glFiltered = null;
    // Data has chaged
    _coordsDirty = false;
    _filteredDirty = false;
    // Id of each property in the VAO
    _coordsId = -1;
    _normalsId = -1;
    _filteredId = -1;
    // Uniforms location
    _uModelViewMatrix = null;
    _uProjectionMatrix = null;
    _uWorldOrigin = null;
    _uGlobalColor = null;
    _filtered = [];
    constructor(glContext, color) {
        super(vsSmoothColor, fsSmoothColor, glContext);
        // saves the layer color
        this._globalColor = color;
        // creathe dhe shader variables
        this.createUniforms(glContext);
        this.createVertexArrayObject(glContext);
    }
    updateShaderGeometry(mesh) {
        this._coordsDirty = true;
        this._filteredDirty = true;
        this._coords = mesh.getCoordinatesVBO();
        this._normals = mesh.getNormalsVBO();
        this._indices = mesh.getIndicesVBO();
        this._coordsPerComp = mesh.getCoordsPerComp();
        let totalNumberOfCoords = mesh.getTotalNumberOfCoords();
        for (let i = 0; i < totalNumberOfCoords; i++) {
            this._filtered.push(1.0); // 1 true to include
        }
    }
    updateShaderData(mesh, knot) {
        return;
    }
    updateShaderUniforms(data) {
        this._globalColor = data;
    }
    createUniforms(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        this._uModelViewMatrix = glContext.getUniformLocation(this._shaderProgram, 'uModelViewMatrix');
        this._uProjectionMatrix = glContext.getUniformLocation(this._shaderProgram, 'uProjectionMatrix');
        this._uWorldOrigin = glContext.getUniformLocation(this._shaderProgram, 'uWorldOrigin');
        this._uGlobalColor = glContext.getUniformLocation(this._shaderProgram, 'uGlobalColor');
    }
    bindUniforms(glContext, camera) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.uniformMatrix4fv(this._uModelViewMatrix, false, camera.getModelViewMatrix());
        glContext.uniformMatrix4fv(this._uProjectionMatrix, false, camera.getProjectionMatrix());
        glContext.uniform2fv(this._uWorldOrigin, camera.getWorldOrigin());
        glContext.uniform3fv(this._uGlobalColor, this._globalColor);
    }
    createTextures(glContext) {
        throw new Error("Method not implemented.");
    }
    bindTextures(glContext) {
        throw new Error("Method not implemented.");
    }
    createVertexArrayObject(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        // Creates the coords id.
        this._coordsId = glContext.getAttribLocation(this._shaderProgram, 'vertCoords');
        // Create a buffer for the positions.
        this._glCoords = glContext.createBuffer();
        // Creates the coords id.
        this._normalsId = glContext.getAttribLocation(this._shaderProgram, 'vertNormals');
        // Create a buffer for the positions.
        this._glNormals = glContext.createBuffer();
        this._filteredId = glContext.getAttribLocation(this._shaderProgram, 'inFiltered');
        this._glFiltered = glContext.createBuffer();
        // Creates the elements buffer
        this._glIndices = glContext.createBuffer();
    }
    bindVertexArrayObject(glContext, mesh) {
        if (!this._shaderProgram) {
            return;
        }
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glCoords);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._coords), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._coordsId, mesh.dimension, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._coordsId);
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glFiltered);
        if (this._filteredDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._filtered), glContext.STATIC_DRAW);
        }
        glContext.vertexAttribPointer(this._filteredId, 1, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._filteredId);
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glNormals);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._normals), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._normalsId, mesh.dimension, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._normalsId);
        // binds the indices buffer
        glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndices);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ELEMENT_ARRAY_BUFFER, new Uint32Array(this._indices), glContext.STATIC_DRAW);
        }
        this._coordsDirty = false;
        this._filteredDirty = false;
    }
    setFiltered(filtered) {
        if (filtered.length == 0) {
            this._filtered = Array(this._filtered.length).fill(1.0);
        }
        else {
            this._filtered = filtered;
        }
        this._filteredDirty = true;
    }
    setHighlightElements(coordinates, value) {
        throw Error("The smooth color shader can not highlight elements yet");
    }
    renderPass(glContext, glPrimitive, camera, mesh, zOrder) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.useProgram(this._shaderProgram);
        this.bindUniforms(glContext, camera);
        if (glPrimitive != glContext.POINTS) {
            glContext.stencilFunc(glContext.GEQUAL, // the test
            zOrder, // reference value
            0xFF);
            glContext.stencilOp(glContext.KEEP, // what to do if the stencil test fails
            glContext.KEEP, // what to do if the depth test fails
            glContext.REPLACE);
        }
        this.bindVertexArrayObject(glContext, mesh);
        if (glPrimitive == glContext.LINE_STRIP) {
            let alreadyDrawn = 0;
            for (let i = 0; i < this._coordsPerComp.length; i++) { // draw each component individually
                glContext.drawArrays(glPrimitive, alreadyDrawn, this._coordsPerComp[i]);
                alreadyDrawn += this._coordsPerComp[i];
            }
        }
        else if (glPrimitive == glContext.POINTS) {
            glContext.drawElements(glPrimitive, this._coords.length / 3, glContext.UNSIGNED_INT, 0);
        }
        else {
            // draw the geometry
            glContext.drawElements(glPrimitive, this._indices.length, glContext.UNSIGNED_INT, 0);
        }
    }
}

class PointsLayer extends Layer {
    // protected _zOrder: number;
    _coordsByCOORDINATES3D = [];
    constructor(info, zOrder = 0, centroid, geometryData) {
        super(info.id, info.type, info.styleKey, info.renderStyle !== undefined ? info.renderStyle : [], centroid, 3, zOrder);
        this.updateMeshGeometry(geometryData);
        // this._zOrder = zOrder;
    }
    supportInteraction(eventName) {
        return true;
    }
    updateMeshGeometry(data) {
        this._mesh.load(data, false, this._centroid);
    }
    updateShaders(shaders) {
        // updates the shader references
        for (const shader of shaders) {
            shader.updateShaderGeometry(this._mesh);
        }
    }
    getSelectedFiltering() {
        throw Error("Filtering not supported for point layer");
    }
    directAddMeshFunction(functionValues, knotId) {
        let distributedValues = this.distributeFunctionValues(functionValues);
        this._mesh.loadFunctionData(distributedValues, knotId);
    }
    updateFunction(knot, shaders) {
        // updates the shader references
        for (const shader of shaders) {
            shader.updateShaderData(this._mesh, knot);
        }
    }
    render(glContext, shaders) {
        for (const shader of shaders) {
            if (shader instanceof ShaderFlatColor) {
                throw Error("FLAT_COLOR not supported for point cloud layer");
            }
            if (shader instanceof ShaderFlatColorMap) {
                throw Error("FLAT_COLOR_MAP not supported for point cloud layer");
            }
            if (shader instanceof ShaderSmoothColor) {
                throw Error("SMOOTH_COLOR not supported for point cloud layer");
            }
            if (shader instanceof ShaderSmoothColorMap) {
                throw Error("SMOOTH_COLOR_MAP not supported for point cloud layer");
            }
            if (shader instanceof ShaderSmoothColorMapTex) {
                throw Error("SMOOTH_COLOR_MAP_TEX not supported for point cloud layer");
            }
            if (shader instanceof ShaderPicking || shader instanceof ShaderPickingTriangles) {
                throw Error("PICKING not supported for point cloud layer");
            }
            if (shader instanceof ShaderAbstractSurface) {
                throw Error("ABSTRACT_SURFACES not supported for point cloud layer");
            }
        }
        // enables the depth test
        glContext.enable(glContext.DEPTH_TEST);
        glContext.depthFunc(glContext.LEQUAL);
        // enable culling
        glContext.frontFace(glContext.CCW);
        glContext.enable(glContext.CULL_FACE);
        glContext.cullFace(glContext.BACK);
        // enables stencil
        // glContext.enable(glContext.STENCIL_TEST);
        // the abs surfaces are loaded first to update the stencil
        for (const shader of shaders) {
            shader.renderPass(glContext, glContext.POINTS, this._camera, this._mesh, -1);
        }
        // disables stencil
        // glContext.disable(glContext.STENCIL_TEST);
        // disables the depth test
        glContext.disable(glContext.DEPTH_TEST);
        // disables culling
        glContext.disable(glContext.CULL_FACE);
    }
    setHighlightElements(elements, level, value) {
        throw new Error("Method not implemented.");
    }
    distributeFunctionValues(functionValues) {
        return functionValues;
    }
    innerAggFunc(functionValues, startLevel, endLevel, operation) {
        throw new Error("Method not implemented.");
    }
    getFunctionValueIndexOfId(id, level) {
        throw new Error("Method not implemented.");
    }
    getCoordsByLevel(level) {
        let coordByLevel = [];
        if (level == LevelType.COORDINATES) {
            throw Error("Cannot get COORDINATES attached to the layer because it does not have a 2D representation");
        }
        if (level == LevelType.COORDINATES3D) {
            if (this._coordsByCOORDINATES3D.length == 0) {
                let coords = this._mesh.getCoordinatesVBO();
                for (let i = 0; i < coords.length / 3; i++) {
                    coordByLevel.push([coords[i * 3], coords[i * 3 + 1], coords[i * 3 + 2]]);
                }
                this._coordsByCOORDINATES3D = coordByLevel;
            }
            else {
                coordByLevel = this._coordsByCOORDINATES3D;
            }
        }
        if (level == LevelType.OBJECTS) {
            throw Error("Cannot get OBJECTS attached to the layer because it does not have a 2D representation");
        }
        return coordByLevel;
    }
    getFunctionByLevel(level, knotId) {
        let functionByLevel = [];
        if (level == LevelType.COORDINATES) {
            throw Error("Cannot get abstract information attached to COORDINATES because the layer does not have a 2D representation");
        }
        if (level == LevelType.COORDINATES3D) {
            let functionValues = this._mesh.getFunctionVBO(knotId)[0].map(x => [x]);
            functionByLevel = functionValues;
        }
        if (level == LevelType.OBJECTS) {
            throw Error("Cannot get abstract information attached to OBJECTS because the layer does not have a 2D representation");
        }
        return functionByLevel;
    }
    getHighlightsByLevel(level) {
        throw new Error("Method not implemented.");
    }
}

class TrianglesLayer extends Layer {
    // protected _mesh: Mesh;
    _zOrder;
    _dimensions;
    _coordsByCOORDINATES = [];
    _coordsByCOORDINATES3D = [];
    _coordsByOBJECTS = [];
    _highlightByCOORDINATES = [];
    _highlightByCOORDINATES3D = [];
    _highlightByOBJECTS = [];
    constructor(info, dimensions = 2, zOrder = 0, centroid, geometryData) {
        super(info.id, info.type, info.styleKey, info.renderStyle !== undefined ? info.renderStyle : [], centroid, dimensions, zOrder);
        this._zOrder = zOrder;
        this._dimensions = dimensions;
        this.updateMeshGeometry(geometryData);
    }
    supportInteraction(eventName) {
        return true;
    }
    updateMeshGeometry(data) {
        // loads the data
        this._mesh.load(data, false, this._centroid);
    }
    updateShaders(shaders) {
        // updates the shader references
        for (const shader of shaders) {
            shader.updateShaderGeometry(this._mesh);
        }
    }
    directAddMeshFunction(functionValues, knotId) {
        let distributedValues = this.distributeFunctionValues(functionValues);
        this._mesh.loadFunctionData(distributedValues, knotId);
    }
    updateFunction(knot, shaders) {
        // updates the shader references
        for (const shader of shaders) {
            shader.updateShaderData(this._mesh, knot);
        }
    }
    setHighlightElements(elements, level, value, shaders) {
        if (elements[0] == undefined)
            return;
        let coords = this.getCoordsByLevel(level);
        for (let i = 0; i < elements.length; i++) {
            let offsetCoords = 0;
            let coordsIndex = [];
            let elementIndex = elements[i];
            for (let j = 0; j < elementIndex; j++) {
                offsetCoords += (coords[j].length) / this._dimensions;
            }
            for (let k = 0; k < (coords[elementIndex].length) / this._dimensions; k++) {
                coordsIndex.push(offsetCoords + k);
            }
            for (const shader of shaders) {
                if (shader instanceof ShaderPickingTriangles) {
                    shader.setHighlightElements(coordsIndex, value);
                }
            }
        }
    }
    getSelectedFiltering(shaders) {
        for (const shader of shaders) {
            if (shader instanceof ShaderPickingTriangles) {
                return shader.getBboxFiltered(this._mesh);
            }
        }
        return null;
    }
    /**
     * Layer render function signature
     * @param {WebGL2RenderingContext} glContext WebGL context
     */
    render(glContext, shaders) {
        // enables the depth test
        // glContext.enable(glContext.DEPTH_TEST);
        glContext.depthFunc(glContext.LEQUAL);
        // enable culling
        glContext.frontFace(glContext.CCW);
        glContext.enable(glContext.CULL_FACE);
        glContext.cullFace(glContext.BACK);
        // enables stencil
        glContext.enable(glContext.STENCIL_TEST);
        // the abs surfaces are loaded first to update the stencil
        for (const shader of shaders) {
            if (shader instanceof ShaderAbstractSurface) {
                shader.renderPass(glContext, glContext.TRIANGLES, this._camera, this._mesh, this._zOrder);
            }
        }
        for (const shader of shaders) {
            if (shader instanceof ShaderAbstractSurface) {
                continue;
            }
            else {
                shader.renderPass(glContext, glContext.TRIANGLES, this._camera, this._mesh, this._zOrder);
            }
        }
        // // clear stencil
        // glContext.clearStencil(0);
        // glContext.clear(glContext.STENCIL_BUFFER_BIT);
        // disables stencil
        glContext.disable(glContext.STENCIL_TEST);
        // disables the depth test
        // glContext.disable(glContext.DEPTH_TEST);
        // disables culling
        glContext.disable(glContext.CULL_FACE);
    }
    highlightElement(glContext, x, y, shaders) {
        if (!glContext.canvas || !(glContext.canvas instanceof HTMLCanvasElement)) {
            return;
        }
        let pixelX = x * glContext.canvas.width / glContext.canvas.clientWidth;
        let pixelY = glContext.canvas.height - y * glContext.canvas.height / glContext.canvas.clientHeight - 1;
        for (const shader of shaders) {
            if (shader instanceof ShaderPickingTriangles) {
                shader.updatePickObjectPosition(pixelX, pixelY);
            }
        }
    }
    getIdLastHighlightedElement(shaders) {
        for (const shader of shaders) {
            if (shader instanceof ShaderSmoothColorMap) {
                return shader.currentPickedElement;
            }
        }
    }
    distributeFunctionValues(functionValues) {
        return functionValues;
    }
    innerAggFunc(functionValues, startLevel, endLevel, operation) {
        if (startLevel == LevelType.COORDINATES && this._dimensions != 2) {
            throw new Error('The start level is COORDINATES but the dimensions of the layer is not 2 (COORDINATES are 2D)');
        }
        if (startLevel == LevelType.COORDINATES3D && this._dimensions != 3) {
            // TODO: maybe there could have support for two representations of coordinates for the triangle layer
            throw new Error('The start level is COORDINATES but the dimensions of the layer is not 3 (COORDINATES3D are 3D)');
        }
        if (endLevel != LevelType.OBJECTS || startLevel == LevelType.OBJECTS) {
            throw new Error('Only operations that end in the Object level are currently supported for the triangle layer');
        }
        if (functionValues == null)
            return null;
        let coordsPerComp = this._mesh.getCoordsPerComp(); // components in the triangle layer can be any set of coordinates semantically grouped (i.e a whole zip code in a zip code layer)
        let acc_functions_per_object = new Array(coordsPerComp.length).fill(null);
        let readCoords = 0;
        for (const numberCoords of coordsPerComp) {
            for (let i = 0; i < numberCoords; i++) {
                if (acc_functions_per_object[i] == null) {
                    acc_functions_per_object[i] = [functionValues[i + readCoords]];
                }
            }
            readCoords += numberCoords;
        }
        for (let i = 0; i < acc_functions_per_object.length; i++) {
            if (operation == OperationType.MAX) {
                acc_functions_per_object[i] = acc_functions_per_object[i].reduce((a, b) => Math.max(a, b), -Infinity);
            }
            else if (operation == OperationType.MIN) {
                acc_functions_per_object[i] = acc_functions_per_object[i].reduce((a, b) => Math.min(a, b), Infinity);
            }
            else if (operation == OperationType.AVG) {
                let sum = acc_functions_per_object[i].reduce((partialSum, value) => partialSum + value, 0);
                acc_functions_per_object[i] = sum / acc_functions_per_object[i].length;
            }
            else if (operation == OperationType.SUM) {
                acc_functions_per_object[i] = acc_functions_per_object[i].reduce((partialSum, value) => partialSum + value, 0);
            }
            else if (operation == OperationType.COUNT) {
                acc_functions_per_object[i] = acc_functions_per_object[i].length;
            }
            else if (operation == OperationType.DISCARD) { // keep the first element of the join
                acc_functions_per_object[i] = acc_functions_per_object[i][0];
            }
            else if (operation == OperationType.NONE) {
                throw new Error('NONE operation cannot be used with the spatial_relation INNERAGG in the triangle layer');
            }
        }
        readCoords = 0;
        for (let i = 0; i < acc_functions_per_object.length; i++) {
            for (let j = 0; j < coordsPerComp[i]; j++) {
                functionValues[j + readCoords] = acc_functions_per_object[i];
            }
            readCoords += coordsPerComp[i];
        }
        return functionValues;
    }
    getFunctionValueIndexOfId(id, level) {
        if (level == LevelType.COORDINATES) {
            if (this._dimensions != 2) {
                throw Error("The level specified is COORDINATES but the triangle layer does not have 2 dimensions");
            }
            return id;
        }
        if (level == LevelType.COORDINATES3D) {
            if (this._dimensions != 3) {
                throw Error("The level specified is COORDINATES3D but the triangle layer does not have 3 dimensions");
            }
            return id;
        }
        if (level == LevelType.OBJECTS) {
            let readCoords = 0;
            let coordsPerComp = this._mesh.getCoordsPerComp();
            for (let i = 0; i < coordsPerComp.length; i++) {
                if (i == id) { // assumes that all coordinates of the same object have the same function value
                    return readCoords;
                }
                readCoords += coordsPerComp[i];
            }
        }
        return null;
    }
    /**
     *
     * @returns each position of the array contains an element of that level
     */
    getCoordsByLevel(level) {
        let coordByLevel = [];
        if (level == LevelType.COORDINATES) {
            if (this._dimensions != 2) {
                throw Error("Cannot get COORDINATES attached to the layer because it does not have a 2D representation");
            }
            if (this._coordsByCOORDINATES.length == 0) {
                let coords = this._mesh.getCoordinatesVBO();
                for (let i = 0; i < coords.length / 2; i++) {
                    coordByLevel.push([coords[i * 2], coords[i * 2 + 1], 0]);
                }
                this._coordsByCOORDINATES = coordByLevel;
            }
            else {
                coordByLevel = this._coordsByCOORDINATES;
            }
        }
        if (level == LevelType.COORDINATES3D) {
            if (this._dimensions != 3) {
                throw Error("Cannot get COORDINATES3D attached to the layer because it does not have a 3D representation");
            }
            if (this._coordsByCOORDINATES3D.length == 0) {
                let coords = this._mesh.getCoordinatesVBO();
                for (let i = 0; i < coords.length / 3; i++) {
                    coordByLevel.push([coords[i * 3], coords[i * 3 + 1], coords[i * 3 + 2]]);
                }
                this._coordsByCOORDINATES3D = coordByLevel;
            }
            else {
                coordByLevel = this._coordsByCOORDINATES3D;
            }
        }
        if (level == LevelType.OBJECTS) {
            if (this._coordsByOBJECTS.length == 0) {
                let coords = this._mesh.getCoordinatesVBO();
                let readCoords = 0;
                let coordsPerComp = this._mesh.getCoordsPerComp();
                for (const numCoords of coordsPerComp) {
                    let groupedCoords = [];
                    for (let i = 0; i < numCoords; i++) {
                        groupedCoords.push(coords[(i * 3) + (readCoords * 3)]);
                        groupedCoords.push(coords[(i * 3) + 1 + (readCoords * 3)]);
                        groupedCoords.push(coords[(i * 3) + 2 + (readCoords * 3)]);
                    }
                    readCoords += numCoords;
                    coordByLevel.push(groupedCoords);
                }
                this._coordsByOBJECTS = coordByLevel;
            }
            else {
                coordByLevel = this._coordsByOBJECTS;
            }
        }
        return coordByLevel;
    }
    getFunctionByLevel(level, knotId) {
        let functionByLevel = [];
        if (level == LevelType.COORDINATES) {
            if (this._dimensions != 2) {
                throw Error("Cannot get abstract information attached to COORDINATES because the layer does not have a 2D representation");
            }
            let functionValues = this._mesh.getFunctionVBO(knotId)[0].map(x => [x]);
            functionByLevel = functionValues;
        }
        if (level == LevelType.COORDINATES3D) {
            if (this._dimensions != 3) {
                throw Error("Cannot get abstract information attached to COORDINATES3D because the layer does not have a 3D representation");
            }
            let functionValues = this._mesh.getFunctionVBO(knotId)[0].map(x => [x]);
            functionByLevel = functionValues;
        }
        if (level == LevelType.OBJECTS) {
            let functionValues = this._mesh.getFunctionVBO(knotId)[0];
            let readFunctions = 0;
            let coordsPerComp = this._mesh.getCoordsPerComp();
            for (const numCoords of coordsPerComp) {
                let groupedFunctions = [];
                for (let i = 0; i < numCoords; i++) {
                    groupedFunctions.push(functionValues[i + readFunctions]);
                }
                readFunctions += numCoords;
                functionByLevel.push(groupedFunctions);
            }
        }
        return functionByLevel;
    }
    getHighlightsByLevel(level) {
        let booleanHighlights = [];
        let highlightsByLevel = [];
        let totalNumberOfCoords = this._mesh.getTotalNumberOfCoords();
        for (let i = 0; i < totalNumberOfCoords; i++) {
            booleanHighlights.push(false);
        }
        if (level == LevelType.COORDINATES) {
            if (this._dimensions != 2) {
                throw Error("Cannot get highlight information related to COORDINATES because the layer does not have a 2D representation");
            }
            if (this._highlightByCOORDINATES.length == 0) {
                highlightsByLevel = booleanHighlights.map(x => [x]);
                this._highlightByCOORDINATES = highlightsByLevel;
            }
            else {
                highlightsByLevel = this._highlightByCOORDINATES;
            }
        }
        if (level == LevelType.COORDINATES3D) {
            if (this._dimensions != 3) {
                throw Error("Cannot get highlight information related to COORDINATES3D because the layer does not have a 3D representation");
            }
            if (this._highlightByCOORDINATES3D.length == 0) {
                highlightsByLevel = booleanHighlights.map(x => [x]);
                this._highlightByCOORDINATES3D = highlightsByLevel;
            }
            else {
                highlightsByLevel = this._highlightByCOORDINATES3D;
            }
        }
        if (level == LevelType.OBJECTS) {
            if (this._highlightByOBJECTS.length == 0) {
                let readHighlights = 0;
                let coordsPerComp = this._mesh.getCoordsPerComp();
                for (const numCoords of coordsPerComp) {
                    let groupedHighlights = [];
                    for (let i = 0; i < numCoords; i++) {
                        groupedHighlights.push(booleanHighlights[i + readHighlights]);
                    }
                    readHighlights += numCoords;
                    highlightsByLevel.push(groupedHighlights);
                }
                this._highlightByOBJECTS = highlightsByLevel;
            }
            else {
                highlightsByLevel = this._highlightByOBJECTS;
            }
        }
        let flattenedHighlights = [];
        // flattening the highlight data
        for (const elemHighlights of highlightsByLevel) {
            let allHighlighted = true;
            for (const value of elemHighlights) {
                if (!value) {
                    allHighlighted = false;
                }
            }
            if (allHighlighted) // all the coordinates of the element must be highlighted for it to be considered highlighted
                flattenedHighlights.push(true);
            else
                flattenedHighlights.push(false);
        }
        return flattenedHighlights;
    }
}

class HeatmapLayer extends Layer {
    _zOrder;
    _dimensions;
    _coordsByCOORDINATES = [];
    _coordsByCOORDINATES3D = [];
    _coordsByOBJECTS = [];
    _highlightByCOORDINATES = [];
    _highlightByCOORDINATES3D = [];
    _highlightByOBJECTS = [];
    constructor(info, zOrder = 0, centroid, geometryData) {
        super(info.id, info.type, info.styleKey, info.renderStyle !== undefined ? info.renderStyle : [], centroid, 3, zOrder);
        console.log("heatmap", zOrder);
        this._zOrder = zOrder;
        this.updateMeshGeometry(geometryData);
    }
    updateMeshGeometry(data) {
        this._mesh.load(data, false, this._centroid);
    }
    updateShaders(shaders) {
        // updates the shader references
        for (const shader of shaders) {
            shader.updateShaderGeometry(this._mesh);
        }
    }
    directAddMeshFunction(functionValues, knotId) {
        let distributedValues = this.distributeFunctionValues(functionValues);
        this._mesh.loadFunctionData(distributedValues, knotId);
    }
    getSelectedFiltering() {
        throw Error("Filtering not supported for heatmap layer");
    }
    updateFunction(knot, shaders) {
        // updates the shader references
        for (const shader of shaders) {
            shader.updateShaderData(this._mesh, knot);
        }
    }
    supportInteraction(interaction) {
        return true;
    }
    setHighlightElements(elements, level, value, shaders) {
        throw Error("It is not possible to highlight a heatmap layer");
    }
    render(glContext, shaders) {
        for (const shader of shaders) {
            if (shader instanceof ShaderSmoothColorMapTex) {
                throw Error("SMOOTH_COLOR_MAP_TEX shader is not supported for the heatmap layer");
            }
            if (shader instanceof ShaderPicking) {
                throw Error("PICKING shader is not supported for the heatmap layer");
            }
            if (shader instanceof ShaderAbstractSurface) {
                throw Error("ABSTRACT_SURFACES shader is not supported for the heatmap layer");
            }
        }
        // enables the depth test
        // glContext.enable(glContext.DEPTH_TEST);
        glContext.depthFunc(glContext.LEQUAL);
        // enable culling
        glContext.frontFace(glContext.CCW);
        glContext.enable(glContext.CULL_FACE);
        glContext.cullFace(glContext.BACK);
        // enables stencil
        glContext.enable(glContext.STENCIL_TEST);
        // the abs surfaces are loaded first to update the stencil
        for (const shader of shaders) {
            if (shader instanceof ShaderAbstractSurface) {
                shader.renderPass(glContext, glContext.TRIANGLES, this._camera, this._mesh, this._zOrder);
            }
        }
        for (const shader of shaders) {
            if (shader instanceof ShaderAbstractSurface) {
                continue;
            }
            else {
                shader.renderPass(glContext, glContext.TRIANGLES, this._camera, this._mesh, this._zOrder);
            }
        }
        // disables stencil
        glContext.disable(glContext.STENCIL_TEST);
        // disables the depth test
        // glContext.disable(glContext.DEPTH_TEST);
        // disables culling
        glContext.disable(glContext.CULL_FACE);
    }
    perFaceAvg(functionValues, indices, ids) {
        let maxId = -1;
        for (const id of ids) {
            if (id > maxId) {
                maxId = id;
            }
        }
        let avg_accumulation_triangle = new Array(Math.trunc(indices.length / 3)).fill(0);
        let avg_accumulation_cell = new Array(maxId + 1).fill(0);
        let indicesByThree = Math.trunc(indices.length / 3);
        // calculate acc by triangle
        for (let i = 0; i < indicesByThree; i++) {
            let value = 0;
            value += functionValues[indices[i * 3]];
            value += functionValues[indices[i * 3 + 1]];
            value += functionValues[indices[i * 3 + 2]];
            avg_accumulation_triangle[i] = value / 3; // TODO: /3 or not? (distribute and accumulate?)
        }
        // calculate acc by cell based on the triangles that compose it
        let count_acc_cell = new Array(maxId + 1).fill(0);
        indicesByThree = Math.trunc(indices.length / 3);
        for (let i = 0; i < indicesByThree; i++) {
            let cell = ids[i];
            avg_accumulation_cell[cell] += avg_accumulation_triangle[i];
            count_acc_cell[cell] += 1;
        }
        indicesByThree = Math.trunc(indices.length / 3);
        for (let i = 0; i < indicesByThree; i++) {
            let cell = ids[i];
            avg_accumulation_triangle[i] = avg_accumulation_cell[cell] / count_acc_cell[cell];
        }
        return avg_accumulation_triangle;
    }
    /**
     * Distributes triangle avg to the coordinates that composes the triangle.
     * The coordinates need to be duplicated, meaning that there are unique indices.
     */
    perCoordinatesAvg(avg_accumulation_triangle, coordsLength, indices) {
        let avg_accumulation_per_coordinates = new Array(coordsLength).fill(0);
        for (let i = 0; i < avg_accumulation_triangle.length; i++) {
            let elem = avg_accumulation_triangle[i];
            avg_accumulation_per_coordinates[indices[i * 3]] = elem;
            avg_accumulation_per_coordinates[indices[i * 3 + 1]] = elem;
            avg_accumulation_per_coordinates[indices[i * 3 + 2]] = elem;
        }
        return avg_accumulation_per_coordinates;
    }
    distributeFunctionValues(functionValues) {
        if (functionValues == null) {
            return null;
        }
        let ids = this._mesh.getIdsVBO();
        let indices = this._mesh.getIndicesVBO();
        let coordsLength = this._mesh.getTotalNumberOfCoords();
        let per_face_avg_accum = this.perFaceAvg(functionValues, indices, ids);
        let avg_accumulation_per_coordinates = this.perCoordinatesAvg(per_face_avg_accum, coordsLength, indices);
        return avg_accumulation_per_coordinates;
    }
    innerAggFunc(functionValues, startLevel, endLevel, operation) {
        throw Error("Inner operation is not supported for the heatmap layer");
    }
    getFunctionValueIndexOfId(id, level) {
        if (level == LevelType.COORDINATES3D) {
            throw Error("The heatmap layer does not have function values attached to COORDINATES3D");
        }
        if (level == LevelType.COORDINATES) {
            return id;
        }
        if (level == LevelType.OBJECTS) {
            let readCoords = 0;
            let coordsPerComp = this._mesh.getCoordsPerComp();
            for (let i = 0; i < coordsPerComp.length; i++) {
                if (i == id) { // assumes that all coordinates of the same object have the same function value
                    return readCoords;
                }
                readCoords += coordsPerComp[i];
            }
        }
        return null;
    }
    /**
     *
     * @returns each position of the array contains an element of that level
     */
    getCoordsByLevel(level) {
        let coordByLevel = [];
        if (level == LevelType.COORDINATES || level == LevelType.OBJECTS) {
            throw Error("The heatmap layer can only be operated in the COORDINATES3D level");
        }
        if (level == LevelType.COORDINATES3D) {
            if (this._coordsByCOORDINATES3D.length == 0) {
                let coords = this._mesh.getCoordinatesVBO();
                for (let i = 0; i < coords.length / 3; i++) {
                    coordByLevel.push([coords[i * 3], coords[i * 3 + 1], coords[i * 3 + 2]]);
                }
                this._coordsByCOORDINATES3D = coordByLevel;
            }
            else {
                coordByLevel = this._coordsByCOORDINATES3D;
            }
        }
        return coordByLevel;
    }
    getFunctionByLevel(level, knotId) {
        let functionByLevel = [];
        if (level == LevelType.COORDINATES || level == LevelType.OBJECTS) {
            throw Error("The heatmap layer can only be operated in the COORDINATES3D level");
        }
        if (level == LevelType.COORDINATES3D) {
            let functionValues = this._mesh.getFunctionVBO(knotId)[0].map(x => [x]);
            functionByLevel = functionValues;
        }
        return functionByLevel;
    }
    getHighlightsByLevel(level) {
        throw Error("The heatmap layer has no highlight attributes");
    }
}

class LayerManager {
    // Loaded layers
    _layers = [];
    _filterBbox = []; // minx, miny, maxx, maxy
    _updateStatusCallback;
    _map;
    constructor(updateStatusCallback = null, map) {
        this._updateStatusCallback = updateStatusCallback;
        this._map = map;
    }
    /**
     * Layers vector accessor
     * @returns {Layer[]} The array of layers
     */
    get layers() {
        return this._layers;
    }
    set filterBbox(bbox) {
        this._updateStatusCallback("filterKnots", bbox);
        this._filterBbox = bbox;
        for (const knot of this._map.knotManager.knots) {
            knot.physicalLayer.mesh.setFiltered(bbox);
            for (const shader of knot.shaders) {
                shader.setFiltered(knot.physicalLayer.mesh.filtered);
                if (shader.currentKnot != undefined) { // if layer is being rendered
                    shader.updateShaderData(knot.physicalLayer.mesh, shader.currentKnot); // recalculating normalization
                }
            }
        }
    }
    /**
    * Creates a layer from the server
    * @param {string} layerType layer type
    * @param {string} layerId layer identifier
    * @returns {Layer | null} The load layer promise
    */
    createLayer(layerInfo, centroid, features) {
        // loaded layer
        let layer = null;
        // z order
        let zOrder = this._layers.length + 1;
        // loads based on type
        switch (layerInfo.type) {
            case LayerType.TRIANGLES_2D_LAYER:
                layer = new TrianglesLayer(layerInfo, 2, zOrder, centroid, features);
                break;
            case LayerType.TRIANGLES_3D_LAYER:
                layer = new TrianglesLayer(layerInfo, 3, zOrder, centroid, features);
                break;
            case LayerType.LINES_2D_LAYER:
                layer = new LinesLayer(layerInfo, 2, zOrder, centroid, features);
                break;
            case LayerType.LINES_3D_LAYER:
                layer = new LinesLayer(layerInfo, 3, zOrder, centroid, features);
                break;
            case LayerType.BUILDINGS_LAYER:
                layer = new BuildingsLayer(layerInfo, zOrder, centroid, features);
                break;
            case LayerType.HEATMAP_LAYER:
                layer = new HeatmapLayer(layerInfo, zOrder, centroid, features);
                break;
            case LayerType.POINTS_LAYER:
                layer = new PointsLayer(layerInfo, zOrder, centroid, features);
                break;
            default:
                console.error(`File ${layerInfo.id}.json has an unknown layer type: ${layerInfo.type}.`);
                break;
        }
        if (layer) {
            // adds the the list of layers
            this._layers.push(layer);
        }
        // returns the layer
        return layer;
    }
    getJoinedObjects(layer, linkDescription) {
        let targetLinkId = -1;
        let idCounter = 0;
        for (const joinedLayer of layer.joinedLayers) {
            if (joinedLayer.abstract == linkDescription.abstract && linkDescription.in != undefined && joinedLayer.layerId == linkDescription.in.name && linkDescription.in.level == joinedLayer.inLevel
                && linkDescription.spatial_relation == joinedLayer.spatial_relation && linkDescription.out.level == joinedLayer.outLevel) {
                targetLinkId = idCounter;
            }
            idCounter += 1;
        }
        if (targetLinkId == -1) {
            return null;
        }
        for (const joinedObject of layer.joinedObjects) {
            if (joinedObject.joinedLayerIndex == targetLinkId) {
                return joinedObject;
            }
        }
        return null;
    }
    getAbstractDataFromLink(linkScheme) {
        if (linkScheme.length < 1) {
            throw new Error("Can not get abstract data from link. Link scheme must have at least one element");
        }
        let functionValues = null; // always in the coordinate level
        if (linkScheme[0].abstract == false) {
            throw new Error("The first link in the link scheme must be between an abstract and physical layer");
        }
        for (let i = 0; i < linkScheme.length; i++) {
            let left_side = this.searchByLayerId(linkScheme[i].out.name);
            if (left_side == null) {
                throw new Error("Layer " + linkScheme[i].out.name + " not found while trying to get abstract data from the link");
            }
            if (linkScheme[i].abstract == true) {
                let joinedObjects = this.getJoinedObjects(left_side, linkScheme[i]);
                if (joinedObjects == null) {
                    throw new Error("Joined objects not found in " + linkScheme[i].out.name);
                }
                if (joinedObjects != null && joinedObjects.inValues != undefined) {
                    functionValues = [];
                    if (linkScheme[i].out.level == LevelType.COORDINATES || linkScheme[i].out.level == LevelType.COORDINATES3D) {
                        for (const value of joinedObjects.inValues) {
                            functionValues.push(value);
                        }
                    }
                    else if (linkScheme[i].out.level == LevelType.OBJECTS) { // distributing the values to the coordinates of the object
                        let coordsPerComp = left_side.mesh.getCoordsPerComp();
                        let distributedValues = [];
                        for (let j = 0; j < joinedObjects.inValues.length; j++) {
                            for (let k = 0; k < coordsPerComp[j]; k++) {
                                distributedValues.push(joinedObjects.inValues[j]);
                            }
                        }
                        functionValues = distributedValues;
                    }
                }
            }
            // if(linkScheme[i].abstract == undefined){
            //     throw new Error("abstract field cannot be undefined when extracting function values");
            // }
            if (linkScheme[i].abstract == false) {
                // inner operation (changing geometry levels inside the same layer)
                if (linkScheme[i].spatial_relation == SpatialRelationType.INNERAGG && functionValues != null && linkScheme[i].in != undefined && linkScheme[i].out.level != undefined) {
                    functionValues = left_side.innerAggFunc(functionValues, linkScheme[i].in.level, linkScheme[i].out.level, linkScheme[i].operation);
                }
                else if (functionValues != null && linkScheme[i].in != undefined && linkScheme[i].out.level != undefined) { // sjoin with another physical layer
                    if (linkScheme[i].in.name == linkScheme[i].out.name) {
                        throw new Error("Only the spatial_relation INNERAGG can be used inside the context of the same layer");
                    }
                    let joinedObjects = this.getJoinedObjects(left_side, linkScheme[i]);
                    if (joinedObjects == null) {
                        throw new Error("Joined objects not found in " + linkScheme[i].out.name);
                    }
                    if (joinedObjects != null && joinedObjects.inIds != undefined && linkScheme[i].in != undefined) {
                        let joinedFunctionValues = [];
                        let right_side = this.searchByLayerId(linkScheme[i].in.name);
                        if (right_side == null) {
                            throw new Error("Layer " + linkScheme[i].in.name + " not found while trying to get abstract data from the link");
                        }
                        for (let j = 0; j < joinedObjects.inIds.length; j++) {
                            let idList = joinedObjects.inIds[j];
                            if (idList == null) {
                                joinedFunctionValues.push([null]);
                            }
                            else {
                                let idsFuncValues = [];
                                for (const id of idList) {
                                    let functionIndex = right_side.getFunctionValueIndexOfId(id, linkScheme[i].in.level);
                                    if (functionIndex == null) {
                                        throw Error("Function index not found");
                                    }
                                    idsFuncValues.push(functionValues[functionIndex]);
                                }
                                joinedFunctionValues.push(idsFuncValues);
                            }
                        }
                        let aggregatedValues = [];
                        // aggregate values
                        for (let j = 0; j < joinedFunctionValues.length; j++) {
                            if (joinedFunctionValues[j][0] != null) {
                                if (linkScheme[i].operation == OperationType.MAX) {
                                    aggregatedValues.push(Math.max(...joinedFunctionValues[j]));
                                }
                                else if (linkScheme[i].operation == OperationType.MIN) {
                                    aggregatedValues.push(Math.min(...joinedFunctionValues[j]));
                                }
                                else if (linkScheme[i].operation == OperationType.AVG) {
                                    let sum = joinedFunctionValues[j].reduce((partialSum, value) => partialSum + value, 0);
                                    aggregatedValues.push(sum / joinedFunctionValues[j].length);
                                }
                                else if (linkScheme[i].operation == OperationType.SUM) {
                                    aggregatedValues.push(joinedFunctionValues[j].reduce((partialSum, value) => partialSum + value, 0));
                                }
                                else if (linkScheme[i].operation == OperationType.COUNT) {
                                    aggregatedValues.push(joinedFunctionValues[j].length);
                                }
                                else if (linkScheme[i].operation == OperationType.NONE) {
                                    throw new Error('NONE operation cannot be used with when linking two physical layers');
                                }
                            }
                            else {
                                aggregatedValues.push(0); // TODO: which value to use with null joins?
                            }
                        }
                        let distributedValues = [];
                        let groupedDistributedValues = [];
                        if (linkScheme[i].out.level == LevelType.COORDINATES || linkScheme[i].out.level == LevelType.COORDINATES3D) {
                            distributedValues = aggregatedValues;
                        }
                        else if (linkScheme[i].out.level == LevelType.OBJECTS) {
                            let coordsPerComp = left_side.mesh.getCoordsPerComp();
                            for (let j = 0; j < aggregatedValues.length; j++) {
                                groupedDistributedValues.push([]);
                                for (let k = 0; k < coordsPerComp[j]; k++) {
                                    groupedDistributedValues[groupedDistributedValues.length - 1].push(aggregatedValues[j]);
                                    distributedValues.push(aggregatedValues[j]);
                                }
                            }
                        }
                        functionValues = distributedValues;
                    }
                }
            }
        }
        return functionValues;
    }
    searchByLayerInfo(layerInfo) {
        // searches the layer
        let layer = null;
        for (const lay of this.layers) {
            if (lay.id === layerInfo.id) {
                layer = lay;
                break;
            }
        }
        return layer;
    }
    searchByLayerId(layerId) {
        // searches the layer
        let layer = null;
        for (const lay of this.layers) {
            if (lay.id === layerId) {
                layer = lay;
                break;
            }
        }
        return layer;
    }
}

// import { MapView } from './mapview';
class MouseEvents {
    // div to attach the events
    _map;
    // mouse movement control.
    _status;
    _lastPoint;
    _brushing;
    _brushingPivot;
    _brushingFilter;
    _brushingFilterPivot;
    _currentPoint; // tracks the cursor current point
    get lastPoint() {
        return this._lastPoint;
    }
    get currentPoint() {
        return this._currentPoint;
    }
    setMap(map) {
        // map reference
        this._map = map;
        // default values
        this._status = MapViewStatu.IDLE;
        this._lastPoint = [0, 0];
        this._brushing = false;
        this._brushingPivot = [0, 0];
        this._brushingFilter = false;
        this._brushingFilterPivot = [0, 0];
        this._currentPoint = [];
    }
    /**
     * Mouse events binding function
     */
    bindEvents() {
        // sets the canvas listeners
        this._map.canvas.addEventListener('wheel', this.mouseWheel.bind(this), false);
        this._map.canvas.addEventListener('mousedown', this.mouseDown.bind(this), false);
        this._map.canvas.addEventListener('contextmenu', this.contextMenu.bind(this), false);
        this._map.canvas.addEventListener('mousemove', this.mouseMove.bind(this), false);
    }
    oneTimeBind() {
        // sets the document listeners
        document.addEventListener('mouseup', this.mouseUp.bind(this), false);
    }
    /**
     * Handles mouse right click event
     * @param {MouseEvent} event The fired event
     */
    contextMenu(event) {
        event.preventDefault();
        event.stopPropagation();
        return;
    }
    /**
     * Handles mouse down event
     * @param {MouseEvent} event The fired event
     */
    mouseDown(event) {
        // captures the event.
        event.preventDefault();
        event.stopPropagation();
        if (event.button == 0 || event.button == 1) { // left click
            this._lastPoint = [event.offsetX, event.offsetY];
            if (event.ctrlKey) {
                // mouseX and mouseY are in CSS pixels in display space 
                const rect = this._map.canvas.getBoundingClientRect();
                let mouseX = event.clientX - rect.left;
                let mouseY = event.clientY - rect.top;
                // left click + ctrlKey
                for (const knot of this._map.knotManager.knots) {
                    knot.interact(this._map.glContext, "left+ctrl", [mouseX, mouseY]);
                }
            }
            else {
                this._status = MapViewStatu.DRAG;
            }
        }
        else if (event.button == 2) { // right click
            // right click - altKey
            if (!event.altKey) {
                for (const knot of this._map.knotManager.knots) {
                    knot.interact(this._map.glContext, 'right-alt');
                }
            }
            this._status = MapViewStatu.DRAG_RIGHT;
        }
        this._map.render();
    }
    /**
     * Handles mouse move event
     * @param {MouseEvent} event The fired event
     */
    mouseMove(event) {
        // captures the event.
        event.preventDefault();
        event.stopPropagation();
        const rect = this._map.canvas.getBoundingClientRect();
        this._currentPoint[0] = event.clientX - rect.left;
        this._currentPoint[1] = event.clientY - rect.top;
        // left click drag
        if (this._status === MapViewStatu.DRAG) {
            if (event.altKey) {
                let mouseX = this._currentPoint[0];
                let mouseY = this._currentPoint[1];
                if (!this._brushing) {
                    // left click + drag + alt - brushing
                    for (const knot of this._map.knotManager.knots) {
                        knot.interact(this._map.glContext, "left+drag+alt-brushing", [mouseX, mouseY], [mouseX, mouseY]);
                    }
                    this._brushingPivot[0] = mouseX;
                    this._brushingPivot[1] = mouseY;
                    this._brushing = true;
                }
                else {
                    // left click + drag + alt + brushing
                    for (const knot of this._map.knotManager.knots) {
                        knot.interact(this._map.glContext, "left+drag+alt+brushing", [mouseX, mouseY], [this._brushingPivot[0], this._brushingPivot[1]]);
                    }
                }
            }
            else {
                if (this._brushing) {
                    // left click + drag - alt + brushing
                    // brush ended, need to apply it
                    for (const knot of this._map.knotManager.knots) {
                        knot.interact(this._map.glContext, "left+drag-alt+brushing");
                    }
                    this._brushing = false;
                }
                const dx = (-event.offsetX + this._lastPoint[0]);
                const dy = event.offsetY - this._lastPoint[1];
                if (event.buttons === 1 && event.shiftKey) { // left button
                    this._map.camera.yaw(dx / this._map.canvas.clientWidth);
                    this._map.camera.pitch(dy / this._map.canvas.clientHeight);
                }
                else {
                    this._map.camera.translate(dx / this._map.canvas.clientWidth, dy / this._map.canvas.clientHeight);
                }
                this._lastPoint = [event.offsetX, event.offsetY];
            }
            this._map.render();
        }
        else {
            if (this._brushing) {
                // -drag-alt+brushing
                // brush ended, need to apply it
                for (const knot of this._map.knotManager.knots) {
                    knot.interact(this._map.glContext, "-drag-alt+brushing");
                }
                this._map.render();
            }
            this._brushing = false;
        }
        // right click drag
        if (this._status === MapViewStatu.DRAG_RIGHT) {
            if (event.altKey) {
                let mouseX = this._currentPoint[0];
                let mouseY = this._currentPoint[1];
                if (!this._brushingFilter) {
                    // right click + drag - brushingFilter
                    for (const knot of this._map.knotManager.knots) {
                        knot.interact(this._map.glContext, "right+drag-brushingFilter", [mouseX, mouseY], [mouseX, mouseY]);
                    }
                    this._brushingFilterPivot[0] = mouseX;
                    this._brushingFilterPivot[1] = mouseY;
                    this._brushingFilter = true;
                }
                else {
                    // right click + drag + brushingFilter
                    for (const knot of this._map.knotManager.knots) {
                        knot.interact(this._map.glContext, "right+drag+brushingFilter", [mouseX, mouseY], [this._brushingFilterPivot[0], this._brushingFilterPivot[1]]);
                    }
                }
            }
            else {
                if (this._brushingFilter) {
                    let largerBbox = [null, null, null, null];
                    for (const knot of this._map.knotManager.knots) {
                        if (knot.physicalLayer instanceof BuildingsLayer || knot.physicalLayer instanceof TrianglesLayer) {
                            let bbox = knot.physicalLayer.getSelectedFiltering(knot.shaders);
                            if (bbox != null) {
                                if (largerBbox[0] == null) {
                                    largerBbox[0] = bbox[0];
                                }
                                else if (bbox[0] < largerBbox[0]) {
                                    largerBbox[0] = bbox[0];
                                }
                                if (largerBbox[1] == null) {
                                    largerBbox[1] = bbox[1];
                                }
                                else if (bbox[1] < largerBbox[1]) {
                                    largerBbox[1] = bbox[1];
                                }
                                if (largerBbox[2] == null) {
                                    largerBbox[2] = bbox[2];
                                }
                                else if (bbox[2] > largerBbox[2]) {
                                    largerBbox[2] = bbox[2];
                                }
                                if (largerBbox[3] == null) {
                                    largerBbox[3] = bbox[3];
                                }
                                else if (bbox[3] > largerBbox[3]) {
                                    largerBbox[3] = bbox[3];
                                }
                            }
                        }
                    }
                    this._map.layerManager.filterBbox = largerBbox;
                    this._map.updateGrammarPlotsData();
                    this._brushingFilter = false;
                }
            }
            this._map.render();
        }
        else {
            if (this._brushingFilter) {
                let largerBbox = [null, null, null, null];
                for (const knot of this._map.knotManager.knots) {
                    if (knot.physicalLayer instanceof BuildingsLayer || knot.physicalLayer instanceof TrianglesLayer) {
                        let bbox = knot.physicalLayer.getSelectedFiltering(knot.shaders);
                        if (bbox != null) {
                            if (largerBbox[0] == null) {
                                largerBbox[0] = bbox[0];
                            }
                            else if (bbox[0] < largerBbox[0]) {
                                largerBbox[0] = bbox[0];
                            }
                            if (largerBbox[1] == null) {
                                largerBbox[1] = bbox[1];
                            }
                            else if (bbox[1] < largerBbox[1]) {
                                largerBbox[1] = bbox[1];
                            }
                            if (largerBbox[2] == null) {
                                largerBbox[2] = bbox[2];
                            }
                            else if (bbox[2] > largerBbox[2]) {
                                largerBbox[2] = bbox[2];
                            }
                            if (largerBbox[3] == null) {
                                largerBbox[3] = bbox[3];
                            }
                            else if (bbox[3] > largerBbox[3]) {
                                largerBbox[3] = bbox[3];
                            }
                        }
                    }
                }
                this._map.layerManager.filterBbox = largerBbox;
                this._map.updateGrammarPlotsData();
                this._map.render();
            }
            this._brushingFilter = false;
        }
    }
    /**
     * Handles mouse up event
     */
    mouseUp(event) {
        // captures the event.
        event.preventDefault();
        event.stopPropagation();
        // changes the values
        this._status = MapViewStatu.IDLE;
        this._map.render();
    }
    /**
     * Handles mouse down event
     * @param {WheelEvent} event The fired event
     */
    async mouseWheel(event) {
        // captures the event.
        event.preventDefault();
        event.stopPropagation();
        if (event.altKey) {
            // wheel + alt
            for (const knot of this._map.knotManager.knots) {
                let currentPoint = this._currentPoint;
                knot.interact(this._map.glContext, "wheel+alt", [currentPoint[0], currentPoint[1]], null, event);
            }
            this._map.render();
        }
        else {
            // changes the values
            const maxAxisLength = Math.max(this._map.canvas.clientWidth, this._map.canvas.clientHeight);
            const x = event.offsetX / maxAxisLength;
            const y = (this._map.canvas.height - event.offsetY) / maxAxisLength;
            this._map.camera.zoom(event.deltaY * 0.01, x, y);
            this._map.render();
        }
    }
}
var MouseEventsFactory = (function () {
    var instance;
    return {
        getInstance: function () {
            if (instance == null) {
                instance = new MouseEvents();
                instance.oneTimeBind();
                // instance.constructor = null;
            }
            return instance;
        }
    };
})();

var noop = {value: () => {}};

function dispatch() {
  for (var i = 0, n = arguments.length, _ = {}, t; i < n; ++i) {
    if (!(t = arguments[i] + "") || (t in _) || /[\s.]/.test(t)) throw new Error("illegal type: " + t);
    _[t] = [];
  }
  return new Dispatch(_);
}

function Dispatch(_) {
  this._ = _;
}

function parseTypenames$1(typenames, types) {
  return typenames.trim().split(/^|\s+/).map(function(t) {
    var name = "", i = t.indexOf(".");
    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);
    if (t && !types.hasOwnProperty(t)) throw new Error("unknown type: " + t);
    return {type: t, name: name};
  });
}

Dispatch.prototype = dispatch.prototype = {
  constructor: Dispatch,
  on: function(typename, callback) {
    var _ = this._,
        T = parseTypenames$1(typename + "", _),
        t,
        i = -1,
        n = T.length;

    // If no callback was specified, return the callback of the given type and name.
    if (arguments.length < 2) {
      while (++i < n) if ((t = (typename = T[i]).type) && (t = get$1(_[t], typename.name))) return t;
      return;
    }

    // If a type was specified, set the callback for the given type and name.
    // Otherwise, if a null callback was specified, remove callbacks of the given name.
    if (callback != null && typeof callback !== "function") throw new Error("invalid callback: " + callback);
    while (++i < n) {
      if (t = (typename = T[i]).type) _[t] = set$1(_[t], typename.name, callback);
      else if (callback == null) for (t in _) _[t] = set$1(_[t], typename.name, null);
    }

    return this;
  },
  copy: function() {
    var copy = {}, _ = this._;
    for (var t in _) copy[t] = _[t].slice();
    return new Dispatch(copy);
  },
  call: function(type, that) {
    if ((n = arguments.length - 2) > 0) for (var args = new Array(n), i = 0, n, t; i < n; ++i) args[i] = arguments[i + 2];
    if (!this._.hasOwnProperty(type)) throw new Error("unknown type: " + type);
    for (t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);
  },
  apply: function(type, that, args) {
    if (!this._.hasOwnProperty(type)) throw new Error("unknown type: " + type);
    for (var t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);
  }
};

function get$1(type, name) {
  for (var i = 0, n = type.length, c; i < n; ++i) {
    if ((c = type[i]).name === name) {
      return c.value;
    }
  }
}

function set$1(type, name, callback) {
  for (var i = 0, n = type.length; i < n; ++i) {
    if (type[i].name === name) {
      type[i] = noop, type = type.slice(0, i).concat(type.slice(i + 1));
      break;
    }
  }
  if (callback != null) type.push({name: name, value: callback});
  return type;
}

var xhtml = "http://www.w3.org/1999/xhtml";

var namespaces = {
  svg: "http://www.w3.org/2000/svg",
  xhtml: xhtml,
  xlink: "http://www.w3.org/1999/xlink",
  xml: "http://www.w3.org/XML/1998/namespace",
  xmlns: "http://www.w3.org/2000/xmlns/"
};

function namespace(name) {
  var prefix = name += "", i = prefix.indexOf(":");
  if (i >= 0 && (prefix = name.slice(0, i)) !== "xmlns") name = name.slice(i + 1);
  return namespaces.hasOwnProperty(prefix) ? {space: namespaces[prefix], local: name} : name; // eslint-disable-line no-prototype-builtins
}

function creatorInherit(name) {
  return function() {
    var document = this.ownerDocument,
        uri = this.namespaceURI;
    return uri === xhtml && document.documentElement.namespaceURI === xhtml
        ? document.createElement(name)
        : document.createElementNS(uri, name);
  };
}

function creatorFixed(fullname) {
  return function() {
    return this.ownerDocument.createElementNS(fullname.space, fullname.local);
  };
}

function creator(name) {
  var fullname = namespace(name);
  return (fullname.local
      ? creatorFixed
      : creatorInherit)(fullname);
}

function none() {}

function selector(selector) {
  return selector == null ? none : function() {
    return this.querySelector(selector);
  };
}

function selection_select(select) {
  if (typeof select !== "function") select = selector(select);

  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {
      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {
        if ("__data__" in node) subnode.__data__ = node.__data__;
        subgroup[i] = subnode;
      }
    }
  }

  return new Selection$1(subgroups, this._parents);
}

// Given something array like (or null), returns something that is strictly an
// array. This is used to ensure that array-like objects passed to d3.selectAll
// or selection.selectAll are converted into proper arrays when creating a
// selection; we dont ever want to create a selection backed by a live
// HTMLCollection or NodeList. However, note that selection.selectAll will use a
// static NodeList as a group, since it safely derived from querySelectorAll.
function array(x) {
  return x == null ? [] : Array.isArray(x) ? x : Array.from(x);
}

function empty() {
  return [];
}

function selectorAll(selector) {
  return selector == null ? empty : function() {
    return this.querySelectorAll(selector);
  };
}

function arrayAll(select) {
  return function() {
    return array(select.apply(this, arguments));
  };
}

function selection_selectAll(select) {
  if (typeof select === "function") select = arrayAll(select);
  else select = selectorAll(select);

  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {
      if (node = group[i]) {
        subgroups.push(select.call(node, node.__data__, i, group));
        parents.push(node);
      }
    }
  }

  return new Selection$1(subgroups, parents);
}

function matcher(selector) {
  return function() {
    return this.matches(selector);
  };
}

function childMatcher(selector) {
  return function(node) {
    return node.matches(selector);
  };
}

var find = Array.prototype.find;

function childFind(match) {
  return function() {
    return find.call(this.children, match);
  };
}

function childFirst() {
  return this.firstElementChild;
}

function selection_selectChild(match) {
  return this.select(match == null ? childFirst
      : childFind(typeof match === "function" ? match : childMatcher(match)));
}

var filter = Array.prototype.filter;

function children() {
  return Array.from(this.children);
}

function childrenFilter(match) {
  return function() {
    return filter.call(this.children, match);
  };
}

function selection_selectChildren(match) {
  return this.selectAll(match == null ? children
      : childrenFilter(typeof match === "function" ? match : childMatcher(match)));
}

function selection_filter(match) {
  if (typeof match !== "function") match = matcher(match);

  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {
      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {
        subgroup.push(node);
      }
    }
  }

  return new Selection$1(subgroups, this._parents);
}

function sparse(update) {
  return new Array(update.length);
}

function selection_enter() {
  return new Selection$1(this._enter || this._groups.map(sparse), this._parents);
}

function EnterNode(parent, datum) {
  this.ownerDocument = parent.ownerDocument;
  this.namespaceURI = parent.namespaceURI;
  this._next = null;
  this._parent = parent;
  this.__data__ = datum;
}

EnterNode.prototype = {
  constructor: EnterNode,
  appendChild: function(child) { return this._parent.insertBefore(child, this._next); },
  insertBefore: function(child, next) { return this._parent.insertBefore(child, next); },
  querySelector: function(selector) { return this._parent.querySelector(selector); },
  querySelectorAll: function(selector) { return this._parent.querySelectorAll(selector); }
};

function constant(x) {
  return function() {
    return x;
  };
}

function bindIndex(parent, group, enter, update, exit, data) {
  var i = 0,
      node,
      groupLength = group.length,
      dataLength = data.length;

  // Put any non-null nodes that fit into update.
  // Put any null nodes into enter.
  // Put any remaining data into enter.
  for (; i < dataLength; ++i) {
    if (node = group[i]) {
      node.__data__ = data[i];
      update[i] = node;
    } else {
      enter[i] = new EnterNode(parent, data[i]);
    }
  }

  // Put any non-null nodes that dont fit into exit.
  for (; i < groupLength; ++i) {
    if (node = group[i]) {
      exit[i] = node;
    }
  }
}

function bindKey(parent, group, enter, update, exit, data, key) {
  var i,
      node,
      nodeByKeyValue = new Map,
      groupLength = group.length,
      dataLength = data.length,
      keyValues = new Array(groupLength),
      keyValue;

  // Compute the key for each node.
  // If multiple nodes have the same key, the duplicates are added to exit.
  for (i = 0; i < groupLength; ++i) {
    if (node = group[i]) {
      keyValues[i] = keyValue = key.call(node, node.__data__, i, group) + "";
      if (nodeByKeyValue.has(keyValue)) {
        exit[i] = node;
      } else {
        nodeByKeyValue.set(keyValue, node);
      }
    }
  }

  // Compute the key for each datum.
  // If there a node associated with this key, join and add it to update.
  // If there is not (or the key is a duplicate), add it to enter.
  for (i = 0; i < dataLength; ++i) {
    keyValue = key.call(parent, data[i], i, data) + "";
    if (node = nodeByKeyValue.get(keyValue)) {
      update[i] = node;
      node.__data__ = data[i];
      nodeByKeyValue.delete(keyValue);
    } else {
      enter[i] = new EnterNode(parent, data[i]);
    }
  }

  // Add any remaining nodes that were not bound to data to exit.
  for (i = 0; i < groupLength; ++i) {
    if ((node = group[i]) && (nodeByKeyValue.get(keyValues[i]) === node)) {
      exit[i] = node;
    }
  }
}

function datum(node) {
  return node.__data__;
}

function selection_data(value, key) {
  if (!arguments.length) return Array.from(this, datum);

  var bind = key ? bindKey : bindIndex,
      parents = this._parents,
      groups = this._groups;

  if (typeof value !== "function") value = constant(value);

  for (var m = groups.length, update = new Array(m), enter = new Array(m), exit = new Array(m), j = 0; j < m; ++j) {
    var parent = parents[j],
        group = groups[j],
        groupLength = group.length,
        data = arraylike(value.call(parent, parent && parent.__data__, j, parents)),
        dataLength = data.length,
        enterGroup = enter[j] = new Array(dataLength),
        updateGroup = update[j] = new Array(dataLength),
        exitGroup = exit[j] = new Array(groupLength);

    bind(parent, group, enterGroup, updateGroup, exitGroup, data, key);

    // Now connect the enter nodes to their following update node, such that
    // appendChild can insert the materialized enter node before this node,
    // rather than at the end of the parent node.
    for (var i0 = 0, i1 = 0, previous, next; i0 < dataLength; ++i0) {
      if (previous = enterGroup[i0]) {
        if (i0 >= i1) i1 = i0 + 1;
        while (!(next = updateGroup[i1]) && ++i1 < dataLength);
        previous._next = next || null;
      }
    }
  }

  update = new Selection$1(update, parents);
  update._enter = enter;
  update._exit = exit;
  return update;
}

// Given some data, this returns an array-like view of it: an object that
// exposes a length property and allows numeric indexing. Note that unlike
// selectAll, this isnt worried about live collections because the resulting
// array will only be used briefly while data is being bound. (It is possible to
// cause the data to change while iterating by using a key function, but please
// dont; wed rather avoid a gratuitous copy.)
function arraylike(data) {
  return typeof data === "object" && "length" in data
    ? data // Array, TypedArray, NodeList, array-like
    : Array.from(data); // Map, Set, iterable, string, or anything else
}

function selection_exit() {
  return new Selection$1(this._exit || this._groups.map(sparse), this._parents);
}

function selection_join(onenter, onupdate, onexit) {
  var enter = this.enter(), update = this, exit = this.exit();
  if (typeof onenter === "function") {
    enter = onenter(enter);
    if (enter) enter = enter.selection();
  } else {
    enter = enter.append(onenter + "");
  }
  if (onupdate != null) {
    update = onupdate(update);
    if (update) update = update.selection();
  }
  if (onexit == null) exit.remove(); else onexit(exit);
  return enter && update ? enter.merge(update).order() : update;
}

function selection_merge(context) {
  var selection = context.selection ? context.selection() : context;

  for (var groups0 = this._groups, groups1 = selection._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {
    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {
      if (node = group0[i] || group1[i]) {
        merge[i] = node;
      }
    }
  }

  for (; j < m0; ++j) {
    merges[j] = groups0[j];
  }

  return new Selection$1(merges, this._parents);
}

function selection_order() {

  for (var groups = this._groups, j = -1, m = groups.length; ++j < m;) {
    for (var group = groups[j], i = group.length - 1, next = group[i], node; --i >= 0;) {
      if (node = group[i]) {
        if (next && node.compareDocumentPosition(next) ^ 4) next.parentNode.insertBefore(node, next);
        next = node;
      }
    }
  }

  return this;
}

function selection_sort(compare) {
  if (!compare) compare = ascending;

  function compareNode(a, b) {
    return a && b ? compare(a.__data__, b.__data__) : !a - !b;
  }

  for (var groups = this._groups, m = groups.length, sortgroups = new Array(m), j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, sortgroup = sortgroups[j] = new Array(n), node, i = 0; i < n; ++i) {
      if (node = group[i]) {
        sortgroup[i] = node;
      }
    }
    sortgroup.sort(compareNode);
  }

  return new Selection$1(sortgroups, this._parents).order();
}

function ascending(a, b) {
  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;
}

function selection_call() {
  var callback = arguments[0];
  arguments[0] = this;
  callback.apply(null, arguments);
  return this;
}

function selection_nodes() {
  return Array.from(this);
}

function selection_node() {

  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {
    for (var group = groups[j], i = 0, n = group.length; i < n; ++i) {
      var node = group[i];
      if (node) return node;
    }
  }

  return null;
}

function selection_size() {
  let size = 0;
  for (const node of this) ++size; // eslint-disable-line no-unused-vars
  return size;
}

function selection_empty() {
  return !this.node();
}

function selection_each(callback) {

  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {
    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {
      if (node = group[i]) callback.call(node, node.__data__, i, group);
    }
  }

  return this;
}

function attrRemove$1(name) {
  return function() {
    this.removeAttribute(name);
  };
}

function attrRemoveNS$1(fullname) {
  return function() {
    this.removeAttributeNS(fullname.space, fullname.local);
  };
}

function attrConstant$1(name, value) {
  return function() {
    this.setAttribute(name, value);
  };
}

function attrConstantNS$1(fullname, value) {
  return function() {
    this.setAttributeNS(fullname.space, fullname.local, value);
  };
}

function attrFunction$1(name, value) {
  return function() {
    var v = value.apply(this, arguments);
    if (v == null) this.removeAttribute(name);
    else this.setAttribute(name, v);
  };
}

function attrFunctionNS$1(fullname, value) {
  return function() {
    var v = value.apply(this, arguments);
    if (v == null) this.removeAttributeNS(fullname.space, fullname.local);
    else this.setAttributeNS(fullname.space, fullname.local, v);
  };
}

function selection_attr(name, value) {
  var fullname = namespace(name);

  if (arguments.length < 2) {
    var node = this.node();
    return fullname.local
        ? node.getAttributeNS(fullname.space, fullname.local)
        : node.getAttribute(fullname);
  }

  return this.each((value == null
      ? (fullname.local ? attrRemoveNS$1 : attrRemove$1) : (typeof value === "function"
      ? (fullname.local ? attrFunctionNS$1 : attrFunction$1)
      : (fullname.local ? attrConstantNS$1 : attrConstant$1)))(fullname, value));
}

function defaultView(node) {
  return (node.ownerDocument && node.ownerDocument.defaultView) // node is a Node
      || (node.document && node) // node is a Window
      || node.defaultView; // node is a Document
}

function styleRemove$1(name) {
  return function() {
    this.style.removeProperty(name);
  };
}

function styleConstant$1(name, value, priority) {
  return function() {
    this.style.setProperty(name, value, priority);
  };
}

function styleFunction$1(name, value, priority) {
  return function() {
    var v = value.apply(this, arguments);
    if (v == null) this.style.removeProperty(name);
    else this.style.setProperty(name, v, priority);
  };
}

function selection_style(name, value, priority) {
  return arguments.length > 1
      ? this.each((value == null
            ? styleRemove$1 : typeof value === "function"
            ? styleFunction$1
            : styleConstant$1)(name, value, priority == null ? "" : priority))
      : styleValue(this.node(), name);
}

function styleValue(node, name) {
  return node.style.getPropertyValue(name)
      || defaultView(node).getComputedStyle(node, null).getPropertyValue(name);
}

function propertyRemove(name) {
  return function() {
    delete this[name];
  };
}

function propertyConstant(name, value) {
  return function() {
    this[name] = value;
  };
}

function propertyFunction(name, value) {
  return function() {
    var v = value.apply(this, arguments);
    if (v == null) delete this[name];
    else this[name] = v;
  };
}

function selection_property(name, value) {
  return arguments.length > 1
      ? this.each((value == null
          ? propertyRemove : typeof value === "function"
          ? propertyFunction
          : propertyConstant)(name, value))
      : this.node()[name];
}

function classArray(string) {
  return string.trim().split(/^|\s+/);
}

function classList(node) {
  return node.classList || new ClassList(node);
}

function ClassList(node) {
  this._node = node;
  this._names = classArray(node.getAttribute("class") || "");
}

ClassList.prototype = {
  add: function(name) {
    var i = this._names.indexOf(name);
    if (i < 0) {
      this._names.push(name);
      this._node.setAttribute("class", this._names.join(" "));
    }
  },
  remove: function(name) {
    var i = this._names.indexOf(name);
    if (i >= 0) {
      this._names.splice(i, 1);
      this._node.setAttribute("class", this._names.join(" "));
    }
  },
  contains: function(name) {
    return this._names.indexOf(name) >= 0;
  }
};

function classedAdd(node, names) {
  var list = classList(node), i = -1, n = names.length;
  while (++i < n) list.add(names[i]);
}

function classedRemove(node, names) {
  var list = classList(node), i = -1, n = names.length;
  while (++i < n) list.remove(names[i]);
}

function classedTrue(names) {
  return function() {
    classedAdd(this, names);
  };
}

function classedFalse(names) {
  return function() {
    classedRemove(this, names);
  };
}

function classedFunction(names, value) {
  return function() {
    (value.apply(this, arguments) ? classedAdd : classedRemove)(this, names);
  };
}

function selection_classed(name, value) {
  var names = classArray(name + "");

  if (arguments.length < 2) {
    var list = classList(this.node()), i = -1, n = names.length;
    while (++i < n) if (!list.contains(names[i])) return false;
    return true;
  }

  return this.each((typeof value === "function"
      ? classedFunction : value
      ? classedTrue
      : classedFalse)(names, value));
}

function textRemove() {
  this.textContent = "";
}

function textConstant$1(value) {
  return function() {
    this.textContent = value;
  };
}

function textFunction$1(value) {
  return function() {
    var v = value.apply(this, arguments);
    this.textContent = v == null ? "" : v;
  };
}

function selection_text(value) {
  return arguments.length
      ? this.each(value == null
          ? textRemove : (typeof value === "function"
          ? textFunction$1
          : textConstant$1)(value))
      : this.node().textContent;
}

function htmlRemove() {
  this.innerHTML = "";
}

function htmlConstant(value) {
  return function() {
    this.innerHTML = value;
  };
}

function htmlFunction(value) {
  return function() {
    var v = value.apply(this, arguments);
    this.innerHTML = v == null ? "" : v;
  };
}

function selection_html(value) {
  return arguments.length
      ? this.each(value == null
          ? htmlRemove : (typeof value === "function"
          ? htmlFunction
          : htmlConstant)(value))
      : this.node().innerHTML;
}

function raise() {
  if (this.nextSibling) this.parentNode.appendChild(this);
}

function selection_raise() {
  return this.each(raise);
}

function lower() {
  if (this.previousSibling) this.parentNode.insertBefore(this, this.parentNode.firstChild);
}

function selection_lower() {
  return this.each(lower);
}

function selection_append(name) {
  var create = typeof name === "function" ? name : creator(name);
  return this.select(function() {
    return this.appendChild(create.apply(this, arguments));
  });
}

function constantNull() {
  return null;
}

function selection_insert(name, before) {
  var create = typeof name === "function" ? name : creator(name),
      select = before == null ? constantNull : typeof before === "function" ? before : selector(before);
  return this.select(function() {
    return this.insertBefore(create.apply(this, arguments), select.apply(this, arguments) || null);
  });
}

function remove() {
  var parent = this.parentNode;
  if (parent) parent.removeChild(this);
}

function selection_remove() {
  return this.each(remove);
}

function selection_cloneShallow() {
  var clone = this.cloneNode(false), parent = this.parentNode;
  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;
}

function selection_cloneDeep() {
  var clone = this.cloneNode(true), parent = this.parentNode;
  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;
}

function selection_clone(deep) {
  return this.select(deep ? selection_cloneDeep : selection_cloneShallow);
}

function selection_datum(value) {
  return arguments.length
      ? this.property("__data__", value)
      : this.node().__data__;
}

function contextListener(listener) {
  return function(event) {
    listener.call(this, event, this.__data__);
  };
}

function parseTypenames(typenames) {
  return typenames.trim().split(/^|\s+/).map(function(t) {
    var name = "", i = t.indexOf(".");
    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);
    return {type: t, name: name};
  });
}

function onRemove(typename) {
  return function() {
    var on = this.__on;
    if (!on) return;
    for (var j = 0, i = -1, m = on.length, o; j < m; ++j) {
      if (o = on[j], (!typename.type || o.type === typename.type) && o.name === typename.name) {
        this.removeEventListener(o.type, o.listener, o.options);
      } else {
        on[++i] = o;
      }
    }
    if (++i) on.length = i;
    else delete this.__on;
  };
}

function onAdd(typename, value, options) {
  return function() {
    var on = this.__on, o, listener = contextListener(value);
    if (on) for (var j = 0, m = on.length; j < m; ++j) {
      if ((o = on[j]).type === typename.type && o.name === typename.name) {
        this.removeEventListener(o.type, o.listener, o.options);
        this.addEventListener(o.type, o.listener = listener, o.options = options);
        o.value = value;
        return;
      }
    }
    this.addEventListener(typename.type, listener, options);
    o = {type: typename.type, name: typename.name, value: value, listener: listener, options: options};
    if (!on) this.__on = [o];
    else on.push(o);
  };
}

function selection_on(typename, value, options) {
  var typenames = parseTypenames(typename + ""), i, n = typenames.length, t;

  if (arguments.length < 2) {
    var on = this.node().__on;
    if (on) for (var j = 0, m = on.length, o; j < m; ++j) {
      for (i = 0, o = on[j]; i < n; ++i) {
        if ((t = typenames[i]).type === o.type && t.name === o.name) {
          return o.value;
        }
      }
    }
    return;
  }

  on = value ? onAdd : onRemove;
  for (i = 0; i < n; ++i) this.each(on(typenames[i], value, options));
  return this;
}

function dispatchEvent(node, type, params) {
  var window = defaultView(node),
      event = window.CustomEvent;

  if (typeof event === "function") {
    event = new event(type, params);
  } else {
    event = window.document.createEvent("Event");
    if (params) event.initEvent(type, params.bubbles, params.cancelable), event.detail = params.detail;
    else event.initEvent(type, false, false);
  }

  node.dispatchEvent(event);
}

function dispatchConstant(type, params) {
  return function() {
    return dispatchEvent(this, type, params);
  };
}

function dispatchFunction(type, params) {
  return function() {
    return dispatchEvent(this, type, params.apply(this, arguments));
  };
}

function selection_dispatch(type, params) {
  return this.each((typeof params === "function"
      ? dispatchFunction
      : dispatchConstant)(type, params));
}

function* selection_iterator() {
  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {
    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {
      if (node = group[i]) yield node;
    }
  }
}

var root = [null];

function Selection$1(groups, parents) {
  this._groups = groups;
  this._parents = parents;
}

function selection() {
  return new Selection$1([[document.documentElement]], root);
}

function selection_selection() {
  return this;
}

Selection$1.prototype = selection.prototype = {
  constructor: Selection$1,
  select: selection_select,
  selectAll: selection_selectAll,
  selectChild: selection_selectChild,
  selectChildren: selection_selectChildren,
  filter: selection_filter,
  data: selection_data,
  enter: selection_enter,
  exit: selection_exit,
  join: selection_join,
  merge: selection_merge,
  selection: selection_selection,
  order: selection_order,
  sort: selection_sort,
  call: selection_call,
  nodes: selection_nodes,
  node: selection_node,
  size: selection_size,
  empty: selection_empty,
  each: selection_each,
  attr: selection_attr,
  style: selection_style,
  property: selection_property,
  classed: selection_classed,
  text: selection_text,
  html: selection_html,
  raise: selection_raise,
  lower: selection_lower,
  append: selection_append,
  insert: selection_insert,
  remove: selection_remove,
  clone: selection_clone,
  datum: selection_datum,
  on: selection_on,
  dispatch: selection_dispatch,
  [Symbol.iterator]: selection_iterator
};

function select(selector) {
  return typeof selector === "string"
      ? new Selection$1([[document.querySelector(selector)]], [document.documentElement])
      : new Selection$1([[selector]], root);
}

var frame = 0, // is an animation frame pending?
    timeout$1 = 0, // is a timeout pending?
    interval = 0, // are any timers active?
    pokeDelay = 1000, // how frequently we check for clock skew
    taskHead,
    taskTail,
    clockLast = 0,
    clockNow = 0,
    clockSkew = 0,
    clock = typeof performance === "object" && performance.now ? performance : Date,
    setFrame = typeof window === "object" && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function(f) { setTimeout(f, 17); };

function now() {
  return clockNow || (setFrame(clearNow), clockNow = clock.now() + clockSkew);
}

function clearNow() {
  clockNow = 0;
}

function Timer() {
  this._call =
  this._time =
  this._next = null;
}

Timer.prototype = timer.prototype = {
  constructor: Timer,
  restart: function(callback, delay, time) {
    if (typeof callback !== "function") throw new TypeError("callback is not a function");
    time = (time == null ? now() : +time) + (delay == null ? 0 : +delay);
    if (!this._next && taskTail !== this) {
      if (taskTail) taskTail._next = this;
      else taskHead = this;
      taskTail = this;
    }
    this._call = callback;
    this._time = time;
    sleep();
  },
  stop: function() {
    if (this._call) {
      this._call = null;
      this._time = Infinity;
      sleep();
    }
  }
};

function timer(callback, delay, time) {
  var t = new Timer;
  t.restart(callback, delay, time);
  return t;
}

function timerFlush() {
  now(); // Get the current time, if not already set.
  ++frame; // Pretend weve set an alarm, if we havent already.
  var t = taskHead, e;
  while (t) {
    if ((e = clockNow - t._time) >= 0) t._call.call(undefined, e);
    t = t._next;
  }
  --frame;
}

function wake() {
  clockNow = (clockLast = clock.now()) + clockSkew;
  frame = timeout$1 = 0;
  try {
    timerFlush();
  } finally {
    frame = 0;
    nap();
    clockNow = 0;
  }
}

function poke() {
  var now = clock.now(), delay = now - clockLast;
  if (delay > pokeDelay) clockSkew -= delay, clockLast = now;
}

function nap() {
  var t0, t1 = taskHead, t2, time = Infinity;
  while (t1) {
    if (t1._call) {
      if (time > t1._time) time = t1._time;
      t0 = t1, t1 = t1._next;
    } else {
      t2 = t1._next, t1._next = null;
      t1 = t0 ? t0._next = t2 : taskHead = t2;
    }
  }
  taskTail = t0;
  sleep(time);
}

function sleep(time) {
  if (frame) return; // Soonest alarm already set, or will be.
  if (timeout$1) timeout$1 = clearTimeout(timeout$1);
  var delay = time - clockNow; // Strictly less than if we recomputed clockNow.
  if (delay > 24) {
    if (time < Infinity) timeout$1 = setTimeout(wake, time - clock.now() - clockSkew);
    if (interval) interval = clearInterval(interval);
  } else {
    if (!interval) clockLast = clock.now(), interval = setInterval(poke, pokeDelay);
    frame = 1, setFrame(wake);
  }
}

function timeout(callback, delay, time) {
  var t = new Timer;
  delay = delay == null ? 0 : +delay;
  t.restart(elapsed => {
    t.stop();
    callback(elapsed + delay);
  }, delay, time);
  return t;
}

var emptyOn = dispatch("start", "end", "cancel", "interrupt");
var emptyTween = [];

var CREATED = 0;
var SCHEDULED = 1;
var STARTING = 2;
var STARTED = 3;
var RUNNING = 4;
var ENDING = 5;
var ENDED = 6;

function schedule(node, name, id, index, group, timing) {
  var schedules = node.__transition;
  if (!schedules) node.__transition = {};
  else if (id in schedules) return;
  create(node, id, {
    name: name,
    index: index, // For context during callback.
    group: group, // For context during callback.
    on: emptyOn,
    tween: emptyTween,
    time: timing.time,
    delay: timing.delay,
    duration: timing.duration,
    ease: timing.ease,
    timer: null,
    state: CREATED
  });
}

function init(node, id) {
  var schedule = get(node, id);
  if (schedule.state > CREATED) throw new Error("too late; already scheduled");
  return schedule;
}

function set(node, id) {
  var schedule = get(node, id);
  if (schedule.state > STARTED) throw new Error("too late; already running");
  return schedule;
}

function get(node, id) {
  var schedule = node.__transition;
  if (!schedule || !(schedule = schedule[id])) throw new Error("transition not found");
  return schedule;
}

function create(node, id, self) {
  var schedules = node.__transition,
      tween;

  // Initialize the self timer when the transition is created.
  // Note the actual delay is not known until the first callback!
  schedules[id] = self;
  self.timer = timer(schedule, 0, self.time);

  function schedule(elapsed) {
    self.state = SCHEDULED;
    self.timer.restart(start, self.delay, self.time);

    // If the elapsed delay is less than our first sleep, start immediately.
    if (self.delay <= elapsed) start(elapsed - self.delay);
  }

  function start(elapsed) {
    var i, j, n, o;

    // If the state is not SCHEDULED, then we previously errored on start.
    if (self.state !== SCHEDULED) return stop();

    for (i in schedules) {
      o = schedules[i];
      if (o.name !== self.name) continue;

      // While this element already has a starting transition during this frame,
      // defer starting an interrupting transition until that transition has a
      // chance to tick (and possibly end); see d3/d3-transition#54!
      if (o.state === STARTED) return timeout(start);

      // Interrupt the active transition, if any.
      if (o.state === RUNNING) {
        o.state = ENDED;
        o.timer.stop();
        o.on.call("interrupt", node, node.__data__, o.index, o.group);
        delete schedules[i];
      }

      // Cancel any pre-empted transitions.
      else if (+i < id) {
        o.state = ENDED;
        o.timer.stop();
        o.on.call("cancel", node, node.__data__, o.index, o.group);
        delete schedules[i];
      }
    }

    // Defer the first tick to end of the current frame; see d3/d3#1576.
    // Note the transition may be canceled after start and before the first tick!
    // Note this must be scheduled before the start event; see d3/d3-transition#16!
    // Assuming this is successful, subsequent callbacks go straight to tick.
    timeout(function() {
      if (self.state === STARTED) {
        self.state = RUNNING;
        self.timer.restart(tick, self.delay, self.time);
        tick(elapsed);
      }
    });

    // Dispatch the start event.
    // Note this must be done before the tween are initialized.
    self.state = STARTING;
    self.on.call("start", node, node.__data__, self.index, self.group);
    if (self.state !== STARTING) return; // interrupted
    self.state = STARTED;

    // Initialize the tween, deleting null tween.
    tween = new Array(n = self.tween.length);
    for (i = 0, j = -1; i < n; ++i) {
      if (o = self.tween[i].value.call(node, node.__data__, self.index, self.group)) {
        tween[++j] = o;
      }
    }
    tween.length = j + 1;
  }

  function tick(elapsed) {
    var t = elapsed < self.duration ? self.ease.call(null, elapsed / self.duration) : (self.timer.restart(stop), self.state = ENDING, 1),
        i = -1,
        n = tween.length;

    while (++i < n) {
      tween[i].call(node, t);
    }

    // Dispatch the end event.
    if (self.state === ENDING) {
      self.on.call("end", node, node.__data__, self.index, self.group);
      stop();
    }
  }

  function stop() {
    self.state = ENDED;
    self.timer.stop();
    delete schedules[id];
    for (var i in schedules) return; // eslint-disable-line no-unused-vars
    delete node.__transition;
  }
}

function interrupt(node, name) {
  var schedules = node.__transition,
      schedule,
      active,
      empty = true,
      i;

  if (!schedules) return;

  name = name == null ? null : name + "";

  for (i in schedules) {
    if ((schedule = schedules[i]).name !== name) { empty = false; continue; }
    active = schedule.state > STARTING && schedule.state < ENDING;
    schedule.state = ENDED;
    schedule.timer.stop();
    schedule.on.call(active ? "interrupt" : "cancel", node, node.__data__, schedule.index, schedule.group);
    delete schedules[i];
  }

  if (empty) delete node.__transition;
}

function selection_interrupt(name) {
  return this.each(function() {
    interrupt(this, name);
  });
}

function tweenRemove(id, name) {
  var tween0, tween1;
  return function() {
    var schedule = set(this, id),
        tween = schedule.tween;

    // If this node shared tween with the previous node,
    // just assign the updated shared tween and were done!
    // Otherwise, copy-on-write.
    if (tween !== tween0) {
      tween1 = tween0 = tween;
      for (var i = 0, n = tween1.length; i < n; ++i) {
        if (tween1[i].name === name) {
          tween1 = tween1.slice();
          tween1.splice(i, 1);
          break;
        }
      }
    }

    schedule.tween = tween1;
  };
}

function tweenFunction(id, name, value) {
  var tween0, tween1;
  if (typeof value !== "function") throw new Error;
  return function() {
    var schedule = set(this, id),
        tween = schedule.tween;

    // If this node shared tween with the previous node,
    // just assign the updated shared tween and were done!
    // Otherwise, copy-on-write.
    if (tween !== tween0) {
      tween1 = (tween0 = tween).slice();
      for (var t = {name: name, value: value}, i = 0, n = tween1.length; i < n; ++i) {
        if (tween1[i].name === name) {
          tween1[i] = t;
          break;
        }
      }
      if (i === n) tween1.push(t);
    }

    schedule.tween = tween1;
  };
}

function transition_tween(name, value) {
  var id = this._id;

  name += "";

  if (arguments.length < 2) {
    var tween = get(this.node(), id).tween;
    for (var i = 0, n = tween.length, t; i < n; ++i) {
      if ((t = tween[i]).name === name) {
        return t.value;
      }
    }
    return null;
  }

  return this.each((value == null ? tweenRemove : tweenFunction)(id, name, value));
}

function tweenValue(transition, name, value) {
  var id = transition._id;

  transition.each(function() {
    var schedule = set(this, id);
    (schedule.value || (schedule.value = {}))[name] = value.apply(this, arguments);
  });

  return function(node) {
    return get(node, id).value[name];
  };
}

function interpolate(a, b) {
  var c;
  return (typeof b === "number" ? interpolateNumber
      : b instanceof color$1 ? interpolateRgb
      : (c = color$1(b)) ? (b = c, interpolateRgb)
      : interpolateString)(a, b);
}

function attrRemove(name) {
  return function() {
    this.removeAttribute(name);
  };
}

function attrRemoveNS(fullname) {
  return function() {
    this.removeAttributeNS(fullname.space, fullname.local);
  };
}

function attrConstant(name, interpolate, value1) {
  var string00,
      string1 = value1 + "",
      interpolate0;
  return function() {
    var string0 = this.getAttribute(name);
    return string0 === string1 ? null
        : string0 === string00 ? interpolate0
        : interpolate0 = interpolate(string00 = string0, value1);
  };
}

function attrConstantNS(fullname, interpolate, value1) {
  var string00,
      string1 = value1 + "",
      interpolate0;
  return function() {
    var string0 = this.getAttributeNS(fullname.space, fullname.local);
    return string0 === string1 ? null
        : string0 === string00 ? interpolate0
        : interpolate0 = interpolate(string00 = string0, value1);
  };
}

function attrFunction(name, interpolate, value) {
  var string00,
      string10,
      interpolate0;
  return function() {
    var string0, value1 = value(this), string1;
    if (value1 == null) return void this.removeAttribute(name);
    string0 = this.getAttribute(name);
    string1 = value1 + "";
    return string0 === string1 ? null
        : string0 === string00 && string1 === string10 ? interpolate0
        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));
  };
}

function attrFunctionNS(fullname, interpolate, value) {
  var string00,
      string10,
      interpolate0;
  return function() {
    var string0, value1 = value(this), string1;
    if (value1 == null) return void this.removeAttributeNS(fullname.space, fullname.local);
    string0 = this.getAttributeNS(fullname.space, fullname.local);
    string1 = value1 + "";
    return string0 === string1 ? null
        : string0 === string00 && string1 === string10 ? interpolate0
        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));
  };
}

function transition_attr(name, value) {
  var fullname = namespace(name), i = fullname === "transform" ? interpolateTransformSvg : interpolate;
  return this.attrTween(name, typeof value === "function"
      ? (fullname.local ? attrFunctionNS : attrFunction)(fullname, i, tweenValue(this, "attr." + name, value))
      : value == null ? (fullname.local ? attrRemoveNS : attrRemove)(fullname)
      : (fullname.local ? attrConstantNS : attrConstant)(fullname, i, value));
}

function attrInterpolate(name, i) {
  return function(t) {
    this.setAttribute(name, i.call(this, t));
  };
}

function attrInterpolateNS(fullname, i) {
  return function(t) {
    this.setAttributeNS(fullname.space, fullname.local, i.call(this, t));
  };
}

function attrTweenNS(fullname, value) {
  var t0, i0;
  function tween() {
    var i = value.apply(this, arguments);
    if (i !== i0) t0 = (i0 = i) && attrInterpolateNS(fullname, i);
    return t0;
  }
  tween._value = value;
  return tween;
}

function attrTween(name, value) {
  var t0, i0;
  function tween() {
    var i = value.apply(this, arguments);
    if (i !== i0) t0 = (i0 = i) && attrInterpolate(name, i);
    return t0;
  }
  tween._value = value;
  return tween;
}

function transition_attrTween(name, value) {
  var key = "attr." + name;
  if (arguments.length < 2) return (key = this.tween(key)) && key._value;
  if (value == null) return this.tween(key, null);
  if (typeof value !== "function") throw new Error;
  var fullname = namespace(name);
  return this.tween(key, (fullname.local ? attrTweenNS : attrTween)(fullname, value));
}

function delayFunction(id, value) {
  return function() {
    init(this, id).delay = +value.apply(this, arguments);
  };
}

function delayConstant(id, value) {
  return value = +value, function() {
    init(this, id).delay = value;
  };
}

function transition_delay(value) {
  var id = this._id;

  return arguments.length
      ? this.each((typeof value === "function"
          ? delayFunction
          : delayConstant)(id, value))
      : get(this.node(), id).delay;
}

function durationFunction(id, value) {
  return function() {
    set(this, id).duration = +value.apply(this, arguments);
  };
}

function durationConstant(id, value) {
  return value = +value, function() {
    set(this, id).duration = value;
  };
}

function transition_duration(value) {
  var id = this._id;

  return arguments.length
      ? this.each((typeof value === "function"
          ? durationFunction
          : durationConstant)(id, value))
      : get(this.node(), id).duration;
}

function easeConstant(id, value) {
  if (typeof value !== "function") throw new Error;
  return function() {
    set(this, id).ease = value;
  };
}

function transition_ease(value) {
  var id = this._id;

  return arguments.length
      ? this.each(easeConstant(id, value))
      : get(this.node(), id).ease;
}

function easeVarying(id, value) {
  return function() {
    var v = value.apply(this, arguments);
    if (typeof v !== "function") throw new Error;
    set(this, id).ease = v;
  };
}

function transition_easeVarying(value) {
  if (typeof value !== "function") throw new Error;
  return this.each(easeVarying(this._id, value));
}

function transition_filter(match) {
  if (typeof match !== "function") match = matcher(match);

  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {
      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {
        subgroup.push(node);
      }
    }
  }

  return new Transition(subgroups, this._parents, this._name, this._id);
}

function transition_merge(transition) {
  if (transition._id !== this._id) throw new Error;

  for (var groups0 = this._groups, groups1 = transition._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {
    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {
      if (node = group0[i] || group1[i]) {
        merge[i] = node;
      }
    }
  }

  for (; j < m0; ++j) {
    merges[j] = groups0[j];
  }

  return new Transition(merges, this._parents, this._name, this._id);
}

function start(name) {
  return (name + "").trim().split(/^|\s+/).every(function(t) {
    var i = t.indexOf(".");
    if (i >= 0) t = t.slice(0, i);
    return !t || t === "start";
  });
}

function onFunction(id, name, listener) {
  var on0, on1, sit = start(name) ? init : set;
  return function() {
    var schedule = sit(this, id),
        on = schedule.on;

    // If this node shared a dispatch with the previous node,
    // just assign the updated shared dispatch and were done!
    // Otherwise, copy-on-write.
    if (on !== on0) (on1 = (on0 = on).copy()).on(name, listener);

    schedule.on = on1;
  };
}

function transition_on(name, listener) {
  var id = this._id;

  return arguments.length < 2
      ? get(this.node(), id).on.on(name)
      : this.each(onFunction(id, name, listener));
}

function removeFunction(id) {
  return function() {
    var parent = this.parentNode;
    for (var i in this.__transition) if (+i !== id) return;
    if (parent) parent.removeChild(this);
  };
}

function transition_remove() {
  return this.on("end.remove", removeFunction(this._id));
}

function transition_select(select) {
  var name = this._name,
      id = this._id;

  if (typeof select !== "function") select = selector(select);

  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {
      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {
        if ("__data__" in node) subnode.__data__ = node.__data__;
        subgroup[i] = subnode;
        schedule(subgroup[i], name, id, i, subgroup, get(node, id));
      }
    }
  }

  return new Transition(subgroups, this._parents, name, id);
}

function transition_selectAll(select) {
  var name = this._name,
      id = this._id;

  if (typeof select !== "function") select = selectorAll(select);

  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {
      if (node = group[i]) {
        for (var children = select.call(node, node.__data__, i, group), child, inherit = get(node, id), k = 0, l = children.length; k < l; ++k) {
          if (child = children[k]) {
            schedule(child, name, id, k, children, inherit);
          }
        }
        subgroups.push(children);
        parents.push(node);
      }
    }
  }

  return new Transition(subgroups, parents, name, id);
}

var Selection = selection.prototype.constructor;

function transition_selection() {
  return new Selection(this._groups, this._parents);
}

function styleNull(name, interpolate) {
  var string00,
      string10,
      interpolate0;
  return function() {
    var string0 = styleValue(this, name),
        string1 = (this.style.removeProperty(name), styleValue(this, name));
    return string0 === string1 ? null
        : string0 === string00 && string1 === string10 ? interpolate0
        : interpolate0 = interpolate(string00 = string0, string10 = string1);
  };
}

function styleRemove(name) {
  return function() {
    this.style.removeProperty(name);
  };
}

function styleConstant(name, interpolate, value1) {
  var string00,
      string1 = value1 + "",
      interpolate0;
  return function() {
    var string0 = styleValue(this, name);
    return string0 === string1 ? null
        : string0 === string00 ? interpolate0
        : interpolate0 = interpolate(string00 = string0, value1);
  };
}

function styleFunction(name, interpolate, value) {
  var string00,
      string10,
      interpolate0;
  return function() {
    var string0 = styleValue(this, name),
        value1 = value(this),
        string1 = value1 + "";
    if (value1 == null) string1 = value1 = (this.style.removeProperty(name), styleValue(this, name));
    return string0 === string1 ? null
        : string0 === string00 && string1 === string10 ? interpolate0
        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));
  };
}

function styleMaybeRemove(id, name) {
  var on0, on1, listener0, key = "style." + name, event = "end." + key, remove;
  return function() {
    var schedule = set(this, id),
        on = schedule.on,
        listener = schedule.value[key] == null ? remove || (remove = styleRemove(name)) : undefined;

    // If this node shared a dispatch with the previous node,
    // just assign the updated shared dispatch and were done!
    // Otherwise, copy-on-write.
    if (on !== on0 || listener0 !== listener) (on1 = (on0 = on).copy()).on(event, listener0 = listener);

    schedule.on = on1;
  };
}

function transition_style(name, value, priority) {
  var i = (name += "") === "transform" ? interpolateTransformCss : interpolate;
  return value == null ? this
      .styleTween(name, styleNull(name, i))
      .on("end.style." + name, styleRemove(name))
    : typeof value === "function" ? this
      .styleTween(name, styleFunction(name, i, tweenValue(this, "style." + name, value)))
      .each(styleMaybeRemove(this._id, name))
    : this
      .styleTween(name, styleConstant(name, i, value), priority)
      .on("end.style." + name, null);
}

function styleInterpolate(name, i, priority) {
  return function(t) {
    this.style.setProperty(name, i.call(this, t), priority);
  };
}

function styleTween(name, value, priority) {
  var t, i0;
  function tween() {
    var i = value.apply(this, arguments);
    if (i !== i0) t = (i0 = i) && styleInterpolate(name, i, priority);
    return t;
  }
  tween._value = value;
  return tween;
}

function transition_styleTween(name, value, priority) {
  var key = "style." + (name += "");
  if (arguments.length < 2) return (key = this.tween(key)) && key._value;
  if (value == null) return this.tween(key, null);
  if (typeof value !== "function") throw new Error;
  return this.tween(key, styleTween(name, value, priority == null ? "" : priority));
}

function textConstant(value) {
  return function() {
    this.textContent = value;
  };
}

function textFunction(value) {
  return function() {
    var value1 = value(this);
    this.textContent = value1 == null ? "" : value1;
  };
}

function transition_text(value) {
  return this.tween("text", typeof value === "function"
      ? textFunction(tweenValue(this, "text", value))
      : textConstant(value == null ? "" : value + ""));
}

function textInterpolate(i) {
  return function(t) {
    this.textContent = i.call(this, t);
  };
}

function textTween(value) {
  var t0, i0;
  function tween() {
    var i = value.apply(this, arguments);
    if (i !== i0) t0 = (i0 = i) && textInterpolate(i);
    return t0;
  }
  tween._value = value;
  return tween;
}

function transition_textTween(value) {
  var key = "text";
  if (arguments.length < 1) return (key = this.tween(key)) && key._value;
  if (value == null) return this.tween(key, null);
  if (typeof value !== "function") throw new Error;
  return this.tween(key, textTween(value));
}

function transition_transition() {
  var name = this._name,
      id0 = this._id,
      id1 = newId();

  for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {
      if (node = group[i]) {
        var inherit = get(node, id0);
        schedule(node, name, id1, i, group, {
          time: inherit.time + inherit.delay + inherit.duration,
          delay: 0,
          duration: inherit.duration,
          ease: inherit.ease
        });
      }
    }
  }

  return new Transition(groups, this._parents, name, id1);
}

function transition_end() {
  var on0, on1, that = this, id = that._id, size = that.size();
  return new Promise(function(resolve, reject) {
    var cancel = {value: reject},
        end = {value: function() { if (--size === 0) resolve(); }};

    that.each(function() {
      var schedule = set(this, id),
          on = schedule.on;

      // If this node shared a dispatch with the previous node,
      // just assign the updated shared dispatch and were done!
      // Otherwise, copy-on-write.
      if (on !== on0) {
        on1 = (on0 = on).copy();
        on1._.cancel.push(cancel);
        on1._.interrupt.push(cancel);
        on1._.end.push(end);
      }

      schedule.on = on1;
    });

    // The selection was empty, resolve end immediately
    if (size === 0) resolve();
  });
}

var id$1 = 0;

function Transition(groups, parents, name, id) {
  this._groups = groups;
  this._parents = parents;
  this._name = name;
  this._id = id;
}

function newId() {
  return ++id$1;
}

var selection_prototype = selection.prototype;

Transition.prototype = {
  constructor: Transition,
  select: transition_select,
  selectAll: transition_selectAll,
  selectChild: selection_prototype.selectChild,
  selectChildren: selection_prototype.selectChildren,
  filter: transition_filter,
  merge: transition_merge,
  selection: transition_selection,
  transition: transition_transition,
  call: selection_prototype.call,
  nodes: selection_prototype.nodes,
  node: selection_prototype.node,
  size: selection_prototype.size,
  empty: selection_prototype.empty,
  each: selection_prototype.each,
  on: transition_on,
  attr: transition_attr,
  attrTween: transition_attrTween,
  style: transition_style,
  styleTween: transition_styleTween,
  text: transition_text,
  textTween: transition_textTween,
  remove: transition_remove,
  tween: transition_tween,
  delay: transition_delay,
  duration: transition_duration,
  ease: transition_ease,
  easeVarying: transition_easeVarying,
  end: transition_end,
  [Symbol.iterator]: selection_prototype[Symbol.iterator]
};

function cubicInOut(t) {
  return ((t *= 2) <= 1 ? t * t * t : (t -= 2) * t * t + 2) / 2;
}

var defaultTiming = {
  time: null, // Set on use.
  delay: 0,
  duration: 250,
  ease: cubicInOut
};

function inherit(node, id) {
  var timing;
  while (!(timing = node.__transition) || !(timing = timing[id])) {
    if (!(node = node.parentNode)) {
      throw new Error(`transition ${id} not found`);
    }
  }
  return timing;
}

function selection_transition(name) {
  var id,
      timing;

  if (name instanceof Transition) {
    id = name._id, name = name._name;
  } else {
    id = newId(), (timing = defaultTiming).time = now(), name = name == null ? null : name + "";
  }

  for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {
      if (node = group[i]) {
        schedule(node, name, id, i, group, timing || inherit(node, id));
      }
    }
  }

  return new Transition(groups, this._parents, name, id);
}

selection.prototype.interrupt = selection_interrupt;
selection.prototype.transition = selection_transition;

function Transform(k, x, y) {
  this.k = k;
  this.x = x;
  this.y = y;
}

Transform.prototype = {
  constructor: Transform,
  scale: function(k) {
    return k === 1 ? this : new Transform(this.k * k, this.x, this.y);
  },
  translate: function(x, y) {
    return x === 0 & y === 0 ? this : new Transform(this.k, this.x + this.k * x, this.y + this.k * y);
  },
  apply: function(point) {
    return [point[0] * this.k + this.x, point[1] * this.k + this.y];
  },
  applyX: function(x) {
    return x * this.k + this.x;
  },
  applyY: function(y) {
    return y * this.k + this.y;
  },
  invert: function(location) {
    return [(location[0] - this.x) / this.k, (location[1] - this.y) / this.k];
  },
  invertX: function(x) {
    return (x - this.x) / this.k;
  },
  invertY: function(y) {
    return (y - this.y) / this.k;
  },
  rescaleX: function(x) {
    return x.copy().domain(x.range().map(this.invertX, this).map(x.invert, x));
  },
  rescaleY: function(y) {
    return y.copy().domain(y.range().map(this.invertY, this).map(y.invert, y));
  },
  toString: function() {
    return "translate(" + this.x + "," + this.y + ") scale(" + this.k + ")";
  }
};

Transform.prototype;

const vega = require('vega');
const lite = require('vega-lite');
class LockFlag {
    _flag;
    constructor() {
        this._flag = false;
    }
    set() {
        this._flag = true;
    }
    get flag() {
        return this._flag;
    }
}
// TODO: Generalize grammar manager to work with several components
class GrammarManager {
    _viewData; // TODO: only one active view is currently supported
    _grammarSpec;
    _updateStatusCallback;
    _setGrammarUpdateCallback;
    _plotsKnotsData;
    _setHighlightElementCallback;
    _plotsReferences;
    _needToUnHighlight;
    _highlightedVegaElements = [];
    /**
     *
     * @param viewData
     * @param setGrammarUpdateCallback Function that sets the callback that will be called in the frontend to update the grammar
     */
    constructor(grammar, updateStatusCallback, plotsKnotsData, setHighlightElementCallback) {
        for (const component of grammar['components']) {
            if ("map" in component) {
                this._viewData = component;
            }
        }
        this._updateStatusCallback = updateStatusCallback;
        this._setHighlightElementCallback = setHighlightElementCallback;
        this._plotsReferences = new Array(this._viewData.plots.length);
        this._needToUnHighlight = false;
        this.updateGrammarPlotsData(plotsKnotsData);
    }
    async updateGrammarPlotsData(plotsKnotsData) {
        this._plotsKnotsData = plotsKnotsData;
        let processedKnotData = this.proccessKnotData();
        this.attachPlots(processedKnotData);
    }
    proccessKnotData() {
        let processedKnotData = {};
        for (let i = 0; i < this._plotsKnotsData.length; i++) {
            let knotData = this._plotsKnotsData[i];
            processedKnotData[knotData.knotId] = { 'values': [] };
            for (let j = 0; j < knotData.elements.length; j++) {
                let element = knotData.elements[j];
                let value = {};
                value[knotData.knotId + "_index"] = element.index;
                value[knotData.knotId + "_abstract"] = element.abstract;
                value[knotData.knotId + "_highlight"] = element.highlighted;
                processedKnotData[knotData.knotId].values.push(value);
            }
        }
        return processedKnotData;
    }
    clearHighlightsLocally(knotsIds) {
        // update local data
        for (const plotKnotData of this._plotsKnotsData) {
            if (knotsIds.includes(plotKnotData.knotId)) {
                for (const element of plotKnotData.elements) {
                    element.highlighted = false;
                }
            }
        }
        // update plots data
        for (let i = 0; i < this._viewData.plots.length; i++) {
            let elem = this._viewData.plots[i];
            if (elem.plot.data != undefined) {
                for (const value of elem.plot.data.values) {
                    for (const knotId of knotsIds) {
                        if (value[knotId + "_index"] != undefined) {
                            value[knotId + "_highlight"] = false;
                        }
                    }
                }
                let valuesCopy = [];
                for (const value of elem.plot.data.values) {
                    let valueCopy = {};
                    let valueKeys = Object.keys(value);
                    for (const key of valueKeys) {
                        if (key != "Symbol(vega_id)") {
                            valueCopy[key] = value[key];
                        }
                    }
                    valuesCopy.push(valueCopy);
                }
                let changeset = vega.changeset().remove(() => true).insert(valuesCopy);
                if (this._plotsReferences[i] != undefined) {
                    this._plotsReferences[i].change('source_0', changeset).runAsync();
                }
            }
        }
    }
    // if toggle if activate ignore the truth value and just toggle the highlight
    setHighlightElementsLocally(elements, truthValue, toggle = false) {
        // update local data
        for (const plotKnotData of this._plotsKnotsData) {
            if (elements[plotKnotData.knotId] != undefined) {
                for (const element of plotKnotData.elements) {
                    if (element.index == elements[plotKnotData.knotId]) {
                        if (toggle) {
                            element.highlighted = !element.highlighted;
                        }
                        else {
                            element.highlighted = truthValue;
                        }
                        break;
                    }
                }
            }
        }
        // update plots data
        for (let i = 0; i < this._viewData.plots.length; i++) {
            let elem = this._viewData.plots[i];
            if (elem.plot.data != undefined) {
                for (const value of elem.plot.data.values) {
                    let elementsKeys = Object.keys(elements);
                    for (const knotId of elementsKeys) {
                        if (value[knotId + "_index"] != undefined && value[knotId + "_index"] == elements[knotId]) {
                            if (toggle) {
                                value[knotId + "_highlight"] = !value[knotId + "_highlight"];
                            }
                            else {
                                value[knotId + "_highlight"] = truthValue;
                            }
                        }
                    }
                }
                let valuesCopy = [];
                for (const value of elem.plot.data.values) {
                    let valueCopy = {};
                    let valueKeys = Object.keys(value);
                    for (const key of valueKeys) {
                        if (key != "Symbol(vega_id)") {
                            valueCopy[key] = value[key];
                        }
                    }
                    valuesCopy.push(valueCopy);
                }
                let changeset = vega.changeset().remove(() => true).insert(valuesCopy);
                if (this._plotsReferences[i] != undefined) {
                    this._plotsReferences[i].change('source_0', changeset).runAsync();
                }
            }
        }
    }
    async attachPlots(processedKnotData) {
        function mergeKnotData(values1, values2) {
            let values3 = [];
            if (values1.length != values2.length) {
                throw Error("The knots of a plot must have the same number of elements"); // TODO: enforce that knots of the same plot must end in the same layer and geometry level
            }
            for (let i = 0; i < values1.length; i++) {
                let currentObj = {};
                let values1Keys = Object.keys(values1[0]);
                for (const key of values1Keys) {
                    currentObj[key] = values1[i][key];
                }
                let values2Keys = Object.keys(values2[0]);
                for (const key of values2Keys) {
                    currentObj[key] = values2[i][key];
                }
                values3.push(currentObj);
            }
            return { "values": values3 };
        }
        let linkedPlots = [];
        let names = [];
        for (let i = 0; i < this._viewData.plots.length; i++) {
            if (this._viewData.plots[i].arrangement == PlotArrangementType.LINKED) {
                linkedPlots.push(this._viewData.plots[i]);
                if (this._viewData.plots[i].name != undefined) {
                    names.push(this._viewData.plots[i].name);
                }
                else {
                    names.push('');
                }
            }
        }
        let ids = await this._updateStatusCallback("containerGenerator", linkedPlots.length, names);
        for (let i = 0; i < linkedPlots.length; i++) {
            // TODO: this checking can be done earlier to avoid unecesary calculations
            if (linkedPlots[i].arrangement != PlotArrangementType.LINKED) {
                continue;
            }
            let elem = linkedPlots[i];
            let plotId = ids[i];
            let mergedKnots = processedKnotData[elem.knots[0]];
            for (let j = 1; j < elem.knots.length; j++) {
                mergedKnots = mergeKnotData(mergedKnots.values, processedKnotData[elem.knots[j]].values);
            }
            elem.plot.data = mergedKnots;
            let vegaspec = lite.compile(elem.plot).spec;
            var view = new vega.View(vega.parse(vegaspec))
                .logLevel(vega.Warn) // set view logging level
                .renderer('svg')
                .initialize("#" + plotId)
                .hover();
            this._plotsReferences[i] = view;
            if (elem.interaction != undefined) {
                if (elem.interaction == PlotInteractionType.HOVER) {
                    let _this = this;
                    view.addEventListener('mouseover', function (event, item) {
                        if (item != undefined && item.datum != undefined) {
                            let elementsToHighlight = {};
                            for (const key of elem.knots) {
                                if (item.datum[key + '_highlight'] == false) {
                                    _this._setHighlightElementCallback.function(key, item.datum[key + '_index'], true, _this._setHighlightElementCallback.arg);
                                    elementsToHighlight[key] = item.datum[key + "_index"];
                                }
                            }
                            if (Object.keys(elementsToHighlight).length > 0) {
                                _this.setHighlightElementsLocally(elementsToHighlight, true);
                                _this._needToUnHighlight = true;
                                _this._highlightedVegaElements.push(item);
                            }
                        }
                    });
                    view.addEventListener('mouseout', function (event, item) {
                        if (item != undefined && item.datum != undefined) {
                            let elementsToUnHighlight = {};
                            for (const key of elem.knots) {
                                _this._setHighlightElementCallback.function(key, item.datum[key + '_index'], false, _this._setHighlightElementCallback.arg);
                                elementsToUnHighlight[key] = item.datum[key + "_index"];
                            }
                            _this.setHighlightElementsLocally(elementsToUnHighlight, false);
                        }
                        for (const highlightedItem of _this._highlightedVegaElements) {
                            let elementsToUnHighlight = {};
                            for (const key of elem.knots) {
                                _this._setHighlightElementCallback.function(key, highlightedItem.datum[key + '_index'], false, _this._setHighlightElementCallback.arg);
                                elementsToUnHighlight[key] = highlightedItem.datum[key + "_index"];
                            }
                            _this.setHighlightElementsLocally(elementsToUnHighlight, false);
                        }
                        _this._highlightedVegaElements = [];
                    });
                }
                if (elem.interaction == PlotInteractionType.BRUSH) {
                    throw Error("Plot " + PlotInteractionType.BRUSH + " not implemented yet");
                }
                if (elem.interaction == PlotInteractionType.CLICK) {
                    let _this = this;
                    view.addEventListener('click', function (event, item) {
                        if (item == undefined || item.datum == undefined) {
                            let elementsToUnHighlight = {};
                            for (const key of elem.knots) {
                                // unhighlight all elements of this plot
                                for (const value of elem.plot.data.values) {
                                    if (value[key + '_index'] != undefined) {
                                        _this._setHighlightElementCallback.function(key, value[key + '_index'], false, _this._setHighlightElementCallback.arg);
                                        elementsToUnHighlight[key] = value[key + '_index'];
                                    }
                                }
                            }
                            _this.setHighlightElementsLocally(elementsToUnHighlight, false);
                        }
                        else {
                            let unhighlight = false;
                            for (const key of elem.knots) {
                                if (item.datum[key + "_highlight"] == true) {
                                    unhighlight = true;
                                    break;
                                }
                            }
                            if (unhighlight) {
                                let elementsToUnHighlight = {};
                                // highlight the clicked element
                                for (const key of elem.knots) {
                                    _this._setHighlightElementCallback.function(key, item.datum[key + '_index'], false, _this._setHighlightElementCallback.arg);
                                    elementsToUnHighlight[key] = item.datum[key + "_index"];
                                }
                                _this.setHighlightElementsLocally(elementsToUnHighlight, false);
                            }
                            else {
                                let elementsToHighlight = {};
                                // highlight the clicked element
                                for (const key of elem.knots) {
                                    _this._setHighlightElementCallback.function(key, item.datum[key + '_index'], true, _this._setHighlightElementCallback.arg);
                                    elementsToHighlight[key] = item.datum[key + "_index"];
                                }
                                _this.setHighlightElementsLocally(elementsToHighlight, true);
                            }
                        }
                    });
                }
            }
            view.runAsync();
            select("#" + plotId).style("background-color", "white");
        }
    }
    getAbstractValues(functionIndex, knotsId, plotsKnotsData) {
        let abstractValues = {};
        for (const knotId of knotsId) {
            for (const knotData of plotsKnotsData) {
                if (knotId == knotData.knotId) {
                    let readCoords = 0;
                    for (let i = 0; i < knotData.elements.length; i++) {
                        if (functionIndex >= readCoords && functionIndex < (knotData.elements[i].coordinates.length / 3) + readCoords) {
                            abstractValues[knotId] = knotData.elements[i].abstract;
                            break;
                        }
                        readCoords += knotData.elements[i].coordinates.length / 3;
                    }
                    break;
                }
            }
        }
        return abstractValues;
    }
    async getHTMLFromVega(plot) {
        // generate HTMLImageElement from vega-spec
        let vegaspec = lite.compile(plot).spec;
        let view = new vega.View(vega.parse(vegaspec), { renderer: 'none' }); // create a Vega view based on the spec
        if (view == undefined) {
            throw Error("There is no plot defined for this embedding interaction");
        }
        let svgStringElement = await view.toSVG();
        let parser = new DOMParser();
        let svgElement = parser.parseFromString(svgStringElement, "image/svg+xml").querySelector('svg');
        if (svgElement == null)
            throw Error("Error while creating svg element from vega-lite plot spec");
        // creating a blob object
        let outerHTML = svgElement.outerHTML;
        let blob = new Blob([outerHTML], { type: 'image/svg+xml;charset=utf-8' });
        // creating URL from the blob Object
        let urlCreator = window.URL || window.webkitURL || window;
        let blobURL = urlCreator.createObjectURL(blob);
        let lockFlag = new LockFlag(); // flag to indicate if the image was loaded
        // loading image to html image element
        let image = new Image();
        image.addEventListener('load', function () {
            urlCreator.revokeObjectURL(blobURL);
            lockFlag.set();
        });
        image.src = blobURL;
        let checkFlag = async () => {
            if (lockFlag.flag == false) {
                await new Promise(r => setTimeout(r, 100));
                checkFlag();
            }
        };
        await checkFlag();
        return image;
    }
    async getFootEmbeddedSvg(data, plotWidth, plotHeight) {
        console.log("data", data);
        /**
         * @param {number} nBins total number of bins (circle is divided equally)
         */
        function defineBins(nBins) {
            let binData = [];
            let increment = (2 * Math.PI) / nBins; // the angles go from 0 to 2pi (radians)
            // adding the angles that define each bin
            for (let i = 0; i < nBins + 1; i++) {
                binData.push(i * increment);
            }
            return binData;
        }
        /**
         * Returns the index of the bin the angle belongs to
         * @param bins Array describing the beginning and end of all bins
         * @param angle angle in radians
         */
        function checkBin(bins, angle) {
            for (let i = 0; i < bins.length - 1; i++) {
                let start = bins[i];
                let end = bins[i + 1];
                if (angle >= start && angle <= end) {
                    return i;
                }
            }
            return -1; // returns -1 if it does not belong to any bin
        }
        let bins = 0;
        let selectedPlot;
        for (let i = 0; i < this._viewData.plots.length; i++) { // TODO: support multiple embedded plots
            if (this._viewData.plots[i].arrangement == PlotArrangementType.FOOT_EMBEDDED) {
                if (this._viewData.plots[i].args != undefined) {
                    bins = this._viewData.plots[i].args.bins;
                }
                selectedPlot = this._viewData.plots[i];
            }
        }
        let data_arr = JSON.parse(data);
        let vegaValues = [];
        let binsDescription;
        if (bins == 0) {
            binsDescription = [0, 360];
        }
        else {
            binsDescription = defineBins(bins);
        }
        for (let i = 0; i < data_arr.pointData.length; i++) {
            let point = data_arr.pointData[i];
            let value = {};
            value.x = point.pixelCoord[0];
            value.y = point.pixelCoord[1];
            value.bin = checkBin(binsDescription, radians(point.angle));
            value.normalX = point.normal[0];
            value.normalY = point.normal[1];
            let abstractValues = this.getAbstractValues(point.functionIndex, selectedPlot.knots, this._plotsKnotsData);
            let abstractValuesKeys = Object.keys(abstractValues);
            for (const key of abstractValuesKeys) {
                value[key + "_abstract"] = abstractValues[key];
            }
            vegaValues.push(value);
        }
        console.log("vegaValues", vegaValues);
        selectedPlot.plot.data = { "values": vegaValues };
        selectedPlot.plot.width = plotWidth;
        selectedPlot.plot.height = plotHeight;
        let image = await this.getHTMLFromVega(selectedPlot.plot);
        return image;
    }
    async getSurEmbeddedSvg(data, plotWidth, plotHeight) {
        let selectedPlot;
        for (let i = 0; i < this._viewData.plots.length; i++) { // TODO: support multiple embedded plots
            if (this._viewData.plots[i].arrangement == PlotArrangementType.SUR_EMBEDDED) {
                selectedPlot = this._viewData.plots[i];
            }
        }
        let data_arr = JSON.parse(data);
        let vegaValues = [];
        for (let i = 0; i < data_arr.length; i++) {
            let point = data_arr[i];
            let value = {};
            let abstractValues = this.getAbstractValues(point.functionIndex, selectedPlot.knots, this._plotsKnotsData);
            let abstractValuesKeys = Object.keys(abstractValues);
            for (const key of abstractValuesKeys) {
                value[key + "_abstract"] = abstractValues[key];
                value[key + "_index"] = point.index;
            }
            vegaValues.push(value);
        }
        selectedPlot.plot.data = { "values": vegaValues };
        selectedPlot.plot.width = plotWidth;
        selectedPlot.plot.height = plotHeight;
        let image = await this.getHTMLFromVega(selectedPlot.plot);
        return image;
    }
}

var vsColorPoints = "#version 300 es\nconst float pi=3.1415926535897932384626433832795;const float pi_180=0.017453292519943295769236907684886127134428718885417254560;const float pi_4=12.56637061435917295385057353311801153678867759750042328389;uniform highp mat4 uModelViewMatrix;uniform highp mat4 uProjectionMatrix;uniform highp vec2 uWorldOrigin;in highp vec3 vertCoords;in highp float funcValues;out highp vec2 texCoords;vec2 latLngToPixel(highp float latitude,highp float longitude){highp float sinLatitude=sin(latitude*pi_180);highp float pixelY=256.0-((0.5-log((1.0+sinLatitude)/(1.0-sinLatitude))/(pi_4))*256.0);highp float pixelX=((longitude+180.0)/360.0)*256.0;return vec2(pixelX,pixelY);}void main(){texCoords=vec2(funcValues,0);highp vec3 finalPos=vertCoords;gl_Position=uProjectionMatrix*uModelViewMatrix*vec4(finalPos,1.0);gl_PointSize=10.0;}";

var fsColorPoints = "#version 300 es\nuniform sampler2D uColorMap;in highp vec2 texCoords;out highp vec4 fragColor;void main(){highp vec3 texColor=texture(uColorMap,texCoords).rgb;fragColor=vec4(texColor,1.0);}";

const d3$1 = require('d3');
class ShaderColorPoints extends Shader {
    // Data to be rendered
    _coords = [];
    _function = [];
    // Color map definition
    _colorMap = null;
    // Global color used on the layer
    // protected _globalColor: number[] = [];
    // Data loaction on GPU
    _glCoords = null;
    _glFunction = null;
    // Data has chaged
    _coordsDirty = false;
    _functionDirty = false;
    _colorMapDirty = false;
    // Id of each property in the VAO
    _coordsId = -1;
    _functionId = -1;
    // Uniforms location
    _uModelViewMatrix = null;
    _uProjectionMatrix = null;
    _uWorldOrigin = null;
    // protected _uGlobalColor: WebGLUniformLocation | null = null;
    _uColorMap = null;
    // Color map texture
    _texColorMap;
    constructor(glContext, colorMap = "interpolateReds") {
        super(vsColorPoints, fsColorPoints, glContext);
        // saves the layer color
        // this._globalColor = color;
        // saves the layer color
        this._colorMap = colorMap;
        // creathe dhe shader variables
        this.createUniforms(glContext);
        this.createVertexArrayObject(glContext);
        this.createTextures(glContext);
    }
    updateShaderGeometry(mesh) {
        this._coordsDirty = true;
        this._coords = mesh.getCoordinatesVBO();
    }
    updateShaderData(mesh, knot) {
        this._currentKnot = knot;
        this._functionDirty = true;
        this._function = mesh.getFunctionVBO(knot.id);
        let scale = d3$1.scaleLinear().domain(d3$1.extent(this._function[0])).range([0, 1]);
        for (let i = 0; i < this._function[0].length; i++) {
            // this._function[0][i] = (this._function[0][i] - minFuncValue)/(maxFuncValue - minFuncValue);
            this._function[0][i] = scale(this._function[0][i]);
        }
    }
    updateShaderUniforms(data) {
        // this._globalColor = <number[]> data;
        this._colorMapDirty = true;
        this._colorMap = data;
    }
    createUniforms(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        this._uModelViewMatrix = glContext.getUniformLocation(this._shaderProgram, 'uModelViewMatrix');
        this._uProjectionMatrix = glContext.getUniformLocation(this._shaderProgram, 'uProjectionMatrix');
        this._uWorldOrigin = glContext.getUniformLocation(this._shaderProgram, 'uWorldOrigin');
        // this._uGlobalColor = glContext.getUniformLocation(this._shaderProgram, 'uGlobalColor');
    }
    bindUniforms(glContext, camera) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.uniformMatrix4fv(this._uModelViewMatrix, false, camera.getModelViewMatrix());
        glContext.uniformMatrix4fv(this._uProjectionMatrix, false, camera.getProjectionMatrix());
        glContext.uniform2fv(this._uWorldOrigin, camera.getWorldOrigin());
        // glContext.uniform3fv(this._uGlobalColor, this._globalColor);
    }
    createTextures(glContext) {
        if (!this._colorMap) {
            return;
        }
        this._uColorMap = glContext.getUniformLocation(this._shaderProgram, 'uColorMap');
        this._texColorMap = glContext.createTexture();
        glContext.bindTexture(glContext.TEXTURE_2D, this._texColorMap);
        // Set the parameters so we can render any size image.
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.NEAREST);
        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MAG_FILTER, glContext.NEAREST);
        // Upload the image into the texture.
        const texData = ColorMap.getColorMap(this._colorMap);
        const size = [256, 1];
        glContext.texImage2D(glContext.TEXTURE_2D, 0, glContext.RGB32F, size[0], size[1], 0, glContext.RGB, glContext.FLOAT, new Float32Array(texData));
    }
    bindTextures(glContext) {
        // set which texture units to render with.
        glContext.uniform1i(this._uColorMap, 0);
        glContext.activeTexture(glContext.TEXTURE0);
        glContext.bindTexture(glContext.TEXTURE_2D, this._texColorMap);
    }
    createVertexArrayObject(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        // Creates the coords id.
        this._coordsId = glContext.getAttribLocation(this._shaderProgram, 'vertCoords');
        // Create a buffer for the positions.
        this._glCoords = glContext.createBuffer();
        // Creates the coords id.
        this._functionId = glContext.getAttribLocation(this._shaderProgram, 'funcValues');
        // Creates the function id
        this._glFunction = glContext.createBuffer();
    }
    bindVertexArrayObject(glContext, mesh) {
        if (!this._shaderProgram) {
            return;
        }
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glCoords);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._coords), glContext.STATIC_DRAW);
        }
        // binds the VAO
        glContext.vertexAttribPointer(this._coordsId, mesh.dimension, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._coordsId);
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glFunction);
        // send data to gpu
        if (this._functionDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._function[0]), glContext.STATIC_DRAW);
        }
        glContext.vertexAttribPointer(this._functionId, 1, glContext.FLOAT, false, 0, 0);
        glContext.enableVertexAttribArray(this._functionId);
        this._coordsDirty = false;
        this._functionDirty = false;
    }
    setFiltered(filtered) {
    }
    setHighlightElements(coordinates, value) {
        throw Error("Method not implemented yet");
    }
    renderPass(glContext, glPrimitive, camera, mesh, zOrder) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.useProgram(this._shaderProgram);
        this.bindUniforms(glContext, camera);
        this.bindVertexArrayObject(glContext, mesh);
        // glContext.drawElements(glPrimitive, this._coords.length/3, glContext.UNSIGNED_INT, 0);
        glContext.drawArrays(glPrimitive, 0, this._coords.length / 3);
    }
}

var vsFlatColorPoints = "#version 300 es\nconst float pi=3.1415926535897932384626433832795;const float pi_180=0.017453292519943295769236907684886127134428718885417254560;const float pi_4=12.56637061435917295385057353311801153678867759750042328389;uniform highp mat4 uModelViewMatrix;uniform highp mat4 uProjectionMatrix;uniform highp vec2 uWorldOrigin;in highp vec3 vertCoords;vec2 latLngToPixel(highp float latitude,highp float longitude){highp float sinLatitude=sin(latitude*pi_180);highp float pixelY=256.0-((0.5-log((1.0+sinLatitude)/(1.0-sinLatitude))/(pi_4))*256.0);highp float pixelX=((longitude+180.0)/360.0)*256.0;return vec2(pixelX,pixelY);}void main(){highp vec3 finalPos=vertCoords;gl_Position=uProjectionMatrix*uModelViewMatrix*vec4(finalPos,1.0);gl_PointSize=10.0;}";

var fsFlatColorPoints = "#version 300 es\nuniform highp vec3 uGlobalColor;out highp vec4 fragColor;void main(){fragColor=vec4(uGlobalColor,1.0);}";

require('d3');
class ShaderFlatColorPoints extends Shader {
    // Data to be rendered
    _coords = [];
    _function = [];
    // Global color used on the layer
    _globalColor = [];
    // Data loaction on GPU
    _glCoords = null;
    _glFunction = null;
    // Data has chaged
    _coordsDirty = false;
    _functionDirty = false;
    // Id of each property in the VAO
    _coordsId = -1;
    // Uniforms location
    _uModelViewMatrix = null;
    _uProjectionMatrix = null;
    _uWorldOrigin = null;
    _uGlobalColor = null;
    constructor(glContext, color) {
        super(vsFlatColorPoints, fsFlatColorPoints, glContext);
        // saves the layer color
        this._globalColor = color;
        // creathe dhe shader variables
        this.createUniforms(glContext);
        this.createVertexArrayObject(glContext);
    }
    updateShaderGeometry(mesh) {
        this._coordsDirty = true;
        this._coords = mesh.getCoordinatesVBO();
    }
    updateShaderData(mesh, knot) {
        return;
    }
    updateShaderUniforms(data) {
        this._globalColor = data;
    }
    createUniforms(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        this._uModelViewMatrix = glContext.getUniformLocation(this._shaderProgram, 'uModelViewMatrix');
        this._uProjectionMatrix = glContext.getUniformLocation(this._shaderProgram, 'uProjectionMatrix');
        this._uWorldOrigin = glContext.getUniformLocation(this._shaderProgram, 'uWorldOrigin');
        this._uGlobalColor = glContext.getUniformLocation(this._shaderProgram, 'uGlobalColor');
    }
    bindUniforms(glContext, camera) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.uniformMatrix4fv(this._uModelViewMatrix, false, camera.getModelViewMatrix());
        glContext.uniformMatrix4fv(this._uProjectionMatrix, false, camera.getProjectionMatrix());
        glContext.uniform2fv(this._uWorldOrigin, camera.getWorldOrigin());
        glContext.uniform3fv(this._uGlobalColor, this._globalColor);
    }
    createTextures(glContext) {
        throw new Error("Method not implemented.");
    }
    bindTextures(glContext) {
        throw new Error("Method not implemented.");
    }
    createVertexArrayObject(glContext) {
        if (!this._shaderProgram) {
            return;
        }
        // Creates the coords id.
        this._coordsId = glContext.getAttribLocation(this._shaderProgram, 'vertCoords');
        // Create a buffer for the positions.
        this._glCoords = glContext.createBuffer();
    }
    bindVertexArrayObject(glContext, mesh) {
        if (!this._shaderProgram) {
            return;
        }
        // binds the position buffer
        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glCoords);
        // send data to gpu
        if (this._coordsDirty) {
            glContext.bufferData(glContext.ARRAY_BUFFER, new Float32Array(this._coords), glContext.STATIC_DRAW);
        }
        this._coordsDirty = false;
    }
    setFiltered(filtered) {
    }
    setHighlightElements(coordinates, value) {
        throw Error("Method not implemented yet");
    }
    renderPass(glContext, glPrimitive, camera, mesh, zOrder) {
        if (!this._shaderProgram) {
            return;
        }
        glContext.useProgram(this._shaderProgram);
        this.bindUniforms(glContext, camera);
        this.bindVertexArrayObject(glContext, mesh);
        // glContext.drawElements(glPrimitive, this._coords.length/3, glContext.UNSIGNED_INT, 0);
        glContext.drawArrays(glPrimitive, 0, this._coords.length / 3);
    }
}

class Knot {
    _physicalLayer; // the physical format the data will assume
    _thematicData;
    _knotSpecification;
    _id;
    _shaders = [];
    _visible;
    _grammarInterpreter;
    _viewId;
    _map;
    constructor(id, physicalLayer, knotSpecification, grammarInterpreter, viewId, visible, map) {
        this._physicalLayer = physicalLayer;
        this._knotSpecification = knotSpecification;
        this._id = id;
        this._visible = visible;
        this._grammarInterpreter = grammarInterpreter;
        this._viewId = viewId;
        this._map = map;
    }
    get id() {
        return this._id;
    }
    get visible() {
        return this._visible;
    }
    get shaders() {
        return this._shaders;
    }
    get physicalLayer() {
        return this._physicalLayer;
    }
    get knotSpecification() {
        return this._knotSpecification;
    }
    set visible(visible) {
        this._visible = visible;
    }
    set thematicData(thematicData) {
        this._thematicData = thematicData;
    }
    render(glContext, camera) {
        if (!this._visible) {
            return;
        }
        this._physicalLayer.camera = camera;
        this._physicalLayer.render(glContext, this._shaders);
    }
    loadShaders(glContext) {
        this._shaders = [];
        const color = MapStyle.getColor(this._physicalLayer.style);
        let cmap = 'interpolateReds';
        if (this._knotSpecification['colorMap'] != undefined) {
            cmap = this._knotSpecification['colorMap'];
        }
        for (const type of this._physicalLayer.renderStyle) {
            let shader = undefined;
            switch (type) {
                case RenderStyle.FLAT_COLOR:
                    shader = new ShaderFlatColor(glContext, color);
                    break;
                case RenderStyle.FLAT_COLOR_MAP:
                    shader = new ShaderFlatColorMap(glContext, cmap);
                    break;
                case RenderStyle.SMOOTH_COLOR:
                    shader = new ShaderSmoothColor(glContext, color);
                    break;
                case RenderStyle.SMOOTH_COLOR_MAP:
                    shader = new ShaderSmoothColorMap(glContext, cmap);
                    break;
                case RenderStyle.SMOOTH_COLOR_MAP_TEX:
                    shader = new ShaderSmoothColorMapTex(glContext, cmap);
                    break;
                case RenderStyle.PICKING:
                    if (this._physicalLayer instanceof TrianglesLayer) {
                        let auxShader = undefined;
                        if (this._shaders.length > 0) {
                            auxShader = this._shaders[this._shaders.length - 1];
                        }
                        if (auxShader && auxShader instanceof AuxiliaryShaderTriangles) {
                            shader = new ShaderPickingTriangles(glContext, auxShader);
                        }
                        else {
                            throw new Error("The shader picking needs an auxiliary shader. The auxiliary shader is the one right before (order matters) shader picking in renderStyle array. SMOOTH_COLOR_MAP can be used as an auxiliary array");
                        }
                    }
                    else if (this._physicalLayer instanceof BuildingsLayer) {
                        let auxShader = undefined;
                        if (this._shaders.length > 0) {
                            auxShader = this._shaders[this._shaders.length - 1];
                        }
                        if (auxShader && auxShader instanceof AuxiliaryShader) {
                            shader = new ShaderPicking(glContext, auxShader);
                        }
                        else {
                            throw new Error("The shader picking needs an auxiliary shader. The auxiliary shader is the one right before (order matters) shader picking in renderStyle array.");
                        }
                    }
                    break;
                case RenderStyle.ABSTRACT_SURFACES:
                    shader = new ShaderAbstractSurface(glContext);
                    break;
                case RenderStyle.COLOR_POINTS:
                    shader = new ShaderColorPoints(glContext, cmap);
                    break;
                case RenderStyle.FLAT_COLOR_POINTS:
                    shader = new ShaderFlatColorPoints(glContext, color);
                    break;
                default:
                    shader = new ShaderFlatColor(glContext, color);
                    break;
            }
            this._shaders.push(shader);
            // // load message
            // console.log("------------------------------------------------------");
            // console.log(`Layer ${this._id} of type ${this._type}.`);
            // console.log(`Render styles: ${this._renderStyle.join(", ")}`);
            // console.log(`Successfully loaded ${this._shaders.length} shader(s).`);
            // console.log("------------------------------------------------------");
        }
        this._physicalLayer.updateShaders(this._shaders); // send mesh data to the shaders
        this._physicalLayer.updateFunction(this._knotSpecification, this._shaders);
    }
    // send function values to the mesh of the layer
    addMeshFunction(layerManager) {
        let functionValues = null;
        if (this._knotSpecification.integration_scheme != null) {
            functionValues = layerManager.getAbstractDataFromLink(this._knotSpecification.integration_scheme);
        }
        this._thematicData = functionValues;
        let distributedValues = this._physicalLayer.distributeFunctionValues(functionValues);
        this._physicalLayer.mesh.loadFunctionData(distributedValues, this._knotSpecification.id);
    }
    processThematicData(layerManager) {
        if (this._knotSpecification.knotOp != true) {
            this.addMeshFunction(layerManager);
        }
        else { // TODO: knot should not have to retrieve the subknots they should be given
            let functionsPerKnot = {};
            for (const scheme of this._knotSpecification.integration_scheme) {
                if (functionsPerKnot[scheme.out.name] == undefined) {
                    let knot = this._grammarInterpreter.getKnotById(scheme.out.name, this._viewId);
                    if (knot == undefined) {
                        throw Error("Could not retrieve knot that composes knotOp " + this._knotSpecification.id);
                    }
                    functionsPerKnot[scheme.out.name] = layerManager.getAbstractDataFromLink(knot.integration_scheme);
                }
                if (scheme.in != undefined && functionsPerKnot[scheme.in.name] == undefined) {
                    let knot = this._grammarInterpreter.getKnotById(scheme.in.name, this._viewId);
                    if (knot == undefined) {
                        throw Error("Could not retrieve knot that composes knotOp " + this._knotSpecification.id);
                    }
                    functionsPerKnot[scheme.in.name] = layerManager.getAbstractDataFromLink(knot.integration_scheme);
                }
            }
            let functionSize = -1;
            let functionsPerKnotsKeys = Object.keys(functionsPerKnot);
            for (const key of functionsPerKnotsKeys) {
                if (functionSize == -1) {
                    functionSize = functionsPerKnot[key].length;
                }
                else if (functionSize != functionsPerKnot[key].length) {
                    throw Error("All knots used in knotOp must have the same length");
                }
            }
            if (functionSize == -1) {
                throw Error("Could not retrieve valid function values for knotOp " + this._knotSpecification.id);
            }
            let prevResult = new Array(functionSize);
            let linkIndex = 0;
            for (const scheme of this._knotSpecification.integration_scheme) {
                if (linkIndex == 0 && scheme.op.includes("prevResult")) {
                    throw Error("It is not possible to access a previous result (prevResult) for the first link");
                }
                let functionValue0 = functionsPerKnot[scheme.out.name];
                let functionValue1 = functionsPerKnot[scheme.in.name];
                for (let j = 0; j < functionValue0.length; j++) {
                    let operation = scheme.op.replaceAll(scheme.out.name, functionValue0[j] + '').replaceAll(scheme.in.name, functionValue1[j] + '');
                    if (linkIndex != 0) {
                        operation = operation.replaceAll("prevResult", prevResult[j] + '');
                    }
                    prevResult[j] = eval(operation); // TODO deal with security problem
                }
                linkIndex += 1;
            }
            this._physicalLayer.directAddMeshFunction(prevResult, this._knotSpecification.id);
        }
    }
    _getPickingArea(glContext, x, y, anchorX, anchorY) {
        if (!glContext.canvas || !(glContext.canvas instanceof HTMLCanvasElement)) {
            return {
                pixelAnchorX: 0,
                pixelAnchorY: 0,
                width: 0,
                height: 0
            };
        }
        // Converting mouse position in the CSS pixels display into pixel coordinate
        let pixelX = x * glContext.canvas.width / glContext.canvas.clientWidth;
        let pixelY = glContext.canvas.height - y * glContext.canvas.height / glContext.canvas.clientHeight - 1;
        let pixelAnchorX = anchorX * glContext.canvas.width / glContext.canvas.clientWidth;
        let pixelAnchorY = glContext.canvas.height - anchorY * glContext.canvas.height / glContext.canvas.clientHeight - 1;
        let width = 0;
        let height = 0;
        if (pixelX - pixelAnchorX > 0 && pixelY - pixelAnchorY < 0) { //bottom right
            width = Math.abs(pixelX - pixelAnchorX);
            height = Math.abs(pixelY - pixelAnchorY);
            pixelAnchorY = pixelY; // shift the anchor point for the width and height be always positive
        }
        else if (pixelX - pixelAnchorX < 0 && pixelY - pixelAnchorY < 0) { //  bottom left
            width = Math.abs(pixelX - pixelAnchorX);
            height = Math.abs(pixelY - pixelAnchorY);
            pixelAnchorY = pixelY; // shift the anchor point for the width and height be always positive
            pixelAnchorX = pixelX; // shift the anchor point for the width and height be always positive
        }
        else if (pixelX - pixelAnchorX > 0 && pixelY - pixelAnchorY > 0) { // top right
            width = Math.abs(pixelX - pixelAnchorX);
            height = Math.abs(pixelY - pixelAnchorY);
        }
        else if (pixelX - pixelAnchorX < 0 && pixelY - pixelAnchorY > 0) { // top left
            width = Math.abs(pixelX - pixelAnchorX);
            height = Math.abs(pixelY - pixelAnchorY);
            pixelAnchorX = pixelX; // shift the anchor point for the width and height be always positive
        }
        return {
            pixelAnchorX: pixelAnchorX,
            pixelAnchorY: pixelAnchorY,
            width: width,
            height: height
        };
    }
    // handles map interaction with the knot
    async interact(glContext, eventName, cursorPosition = null, brushingPivot = null, eventObject = null) {
        if (!this._visible || !this._physicalLayer.supportInteraction(eventName)) {
            return;
        }
        let mapGrammar = this._grammarInterpreter.getMap();
        let interaction = '';
        for (let i = 0; i < mapGrammar.knots.length; i++) {
            if (mapGrammar.knots[i] == this._id) {
                interaction = mapGrammar.interactions[i];
                break;
            }
        }
        if (interaction == '') {
            return;
        }
        let plotsGrammar = this._grammarInterpreter.getPlots();
        let plotArrangements = [];
        for (const plot of plotsGrammar) {
            if (plot.knots.includes(this._id)) {
                plotArrangements.push(plot.arrangement);
            }
        }
        let embedFootInteraction = false;
        let highlightCellInteraction = false;
        let highlightBuildingInteraction = false;
        let embedSurfaceInteraction = false;
        let highlightTriangleObject = false;
        if (interaction == InteractionType.BRUSHING) {
            highlightCellInteraction = true;
            if (plotArrangements.includes(PlotArrangementType.SUR_EMBEDDED)) {
                embedSurfaceInteraction = true;
            }
        }
        if (interaction == InteractionType.PICKING) {
            if (plotArrangements.includes(PlotArrangementType.FOOT_EMBEDDED)) {
                embedFootInteraction = true;
            }
            if (plotArrangements.includes(PlotArrangementType.LINKED)) {
                highlightBuildingInteraction = true;
                highlightTriangleObject = true;
            }
            if (plotArrangements.length == 0) {
                highlightBuildingInteraction = true;
                highlightTriangleObject = true;
            }
        }
        // mouse down
        if (eventName == "left+ctrl" && cursorPosition != null) {
            let result = this._getPickingArea(glContext, cursorPosition[0], cursorPosition[1], cursorPosition[0], cursorPosition[1]);
            for (const shader of this._shaders) {
                if (shader instanceof ShaderPicking || shader instanceof ShaderPickingTriangles) {
                    shader.clearPicking();
                    if (highlightCellInteraction)
                        shader.updatePickPosition(result.pixelAnchorX, result.pixelAnchorY, result.width, result.height);
                }
            }
        }
        if (eventName == 'right-alt') {
            for (const shader of this._shaders) {
                if (shader instanceof ShaderPicking || shader instanceof ShaderPickingTriangles) {
                    shader.clearPicking();
                }
            }
            this._map.updateGrammarPlotsHighlight(this._physicalLayer.id, null, null, true); // letting plots manager know that this knot was interacted with
        }
        // mouse move
        if (eventName == "left+drag+alt-brushing" && cursorPosition != null && highlightCellInteraction) {
            let result = this._getPickingArea(glContext, cursorPosition[0], cursorPosition[1], cursorPosition[0], cursorPosition[1]);
            for (const shader of this._shaders) {
                if (shader instanceof ShaderPicking || shader instanceof ShaderPickingTriangles) {
                    shader.updatePickPosition(result.pixelAnchorX, result.pixelAnchorY, result.width, result.height);
                }
            }
        }
        if (eventName == "left+drag+alt+brushing" && cursorPosition != null && brushingPivot != null) {
            let result = this._getPickingArea(glContext, cursorPosition[0], cursorPosition[1], brushingPivot[0], brushingPivot[1]);
            for (const shader of this._shaders) {
                if (shader instanceof ShaderPicking || shader instanceof ShaderPickingTriangles) {
                    shader.updatePickPosition(result.pixelAnchorX, result.pixelAnchorY, result.width, result.height);
                }
            }
        }
        if (eventName == "left+drag-alt+brushing" || eventName == "-drag-alt+brushing") {
            for (const shader of this._shaders) {
                if (shader instanceof ShaderPicking) {
                    shader.applyBrushing();
                }
            }
        }
        if (eventName == "right+drag-brushingFilter" && cursorPosition != null) {
            let result = this._getPickingArea(glContext, cursorPosition[0], cursorPosition[1], cursorPosition[0], cursorPosition[1]);
            for (const shader of this._shaders) {
                if (shader instanceof ShaderPicking || shader instanceof ShaderPickingTriangles) {
                    shader.updatePickFilterPosition(result.pixelAnchorX, result.pixelAnchorY, result.width, result.height);
                }
            }
        }
        if (eventName == "right+drag+brushingFilter" && cursorPosition != null && brushingPivot != null) {
            let result = this._getPickingArea(glContext, cursorPosition[0], cursorPosition[1], brushingPivot[0], brushingPivot[1]);
            for (const shader of this._shaders) {
                if (shader instanceof ShaderPicking || shader instanceof ShaderPickingTriangles) {
                    shader.updatePickFilterPosition(result.pixelAnchorX, result.pixelAnchorY, result.width, result.height);
                }
            }
        }
        // mouse wheel
        if (eventName == "wheel+alt" && cursorPosition != null && embedFootInteraction) {
            if (this._physicalLayer instanceof BuildingsLayer) { // TODO: generalize this
                this._physicalLayer.createFootprintPlot(this._map.glContext, cursorPosition[0], cursorPosition[1], true, this._shaders);
                this._map.render(); // TODO: get rid of the need to render the map
                await this._physicalLayer.updateFootprintPlot(this._map.glContext, this._map.grammarManager, -1, eventObject.deltaY * 0.02, 'vega', this._shaders);
            }
        }
        if (eventName == "Enter" && highlightCellInteraction && embedSurfaceInteraction) {
            if (this._physicalLayer instanceof BuildingsLayer) { // TODO: generalize this
                await this._physicalLayer.applyTexSelectedCells(this._map.glContext, this._map.grammarManager, 'vega', this._shaders);
            }
        }
        if (eventName == "r") {
            if (this._physicalLayer instanceof BuildingsLayer) { // TODO: generalize this
                this._physicalLayer.clearAbsSurface(this._shaders);
            }
        }
        // keyUp
        if (eventName == "t") {
            if (highlightTriangleObject) {
                //triangles layer interactions
                if (this._physicalLayer instanceof TrianglesLayer) { // TODO: generalize this
                    let currentPoint = this._map.mouse.currentPoint;
                    this._physicalLayer.highlightElement(this._map.glContext, currentPoint[0], currentPoint[1], this._shaders);
                }
                this._map.render();
                this._map.render();
                if (this._physicalLayer instanceof TrianglesLayer) { // TODO: generalize this
                    let objectId = this._physicalLayer.getIdLastHighlightedElement(this._shaders);
                    this._map.updateGrammarPlotsHighlight(this._physicalLayer.id, LevelType.OBJECTS, objectId); // letting plots manager know that this knot was interacted with
                }
            }
            if (embedFootInteraction && cursorPosition != null) { // TODO: simplify this footprint plot application
                if (this._physicalLayer instanceof BuildingsLayer) {
                    this._physicalLayer.createFootprintPlot(this._map.glContext, cursorPosition[0], cursorPosition[1], false, this._shaders);
                    this._map.render();
                    await this._physicalLayer.applyFootprintPlot(this._map.glContext, this._map.grammarManager, 1, 'vega', this._shaders);
                }
                this._map.render();
            }
            if (highlightBuildingInteraction && cursorPosition != null) {
                // call functions to highlight building
                if (this._physicalLayer instanceof BuildingsLayer) {
                    this._physicalLayer.highlightBuilding(this._map.glContext, cursorPosition[0], cursorPosition[1], this._shaders);
                }
                // the two renderings are required
                this._map.render();
                this._map.render();
                if (this._physicalLayer instanceof BuildingsLayer) {
                    let buildingId = this._physicalLayer.getIdLastHighlightedBuilding(this._shaders);
                    this._map.updateGrammarPlotsHighlight(this._physicalLayer.id, LevelType.OBJECTS, buildingId); // letting plots manager know that this knot was interacted with
                }
            }
        }
        this._map.render();
    }
}

class KnotManager {
    _knots = [];
    _updateStatusCallback;
    constructor(updateStatusCallback) {
        this._updateStatusCallback = updateStatusCallback;
    }
    get knots() {
        return this._knots;
    }
    createKnot(id, physicalLayer, knotSpecification, grammarInterpreter, viewId, visible, map) {
        let knot = new Knot(id, physicalLayer, knotSpecification, grammarInterpreter, viewId, visible, map);
        this._knots.push(knot);
        this.toggleKnot(""); // just to update the knots in the view
        return knot;
    }
    toggleKnot(id, value = null) {
        let knotVisibility = {};
        for (const knot of this._knots) {
            if (knot.id == id) {
                if (value != null) {
                    knot.visible = value;
                }
                else {
                    knot.visible = !knot.visible;
                }
            }
            knotVisibility[knot.id] = knot.visible;
        }
        this._updateStatusCallback("knotVisibility", knotVisibility);
    }
    getKnotById(knotId) {
        for (const knot of this._knots) {
            if (knot.id == knotId) {
                return knot;
            }
        }
        return null;
    }
}

/// <reference types="@types/webgl2" />
class MapView {
    // Html div that will host the map
    _mapDiv;
    // Html canvas used to draw the map
    _canvas;
    // WebGL context of the canvas
    _glContext;
    // Layer manager object
    _layerManager;
    _knotManager;
    // Manages the view configuration loaded (including plots and its interactions)
    _grammarManager;
    _grammarInterpreter;
    _updateStatusCallback;
    // interaction variables
    _camera;
    // mouse events
    _mouse;
    // keyboard events
    _keyboard;
    _knotVisibilityMonitor;
    // private _mapViewData: IGrammar;
    _embeddedKnots;
    _linkedKnots;
    _viewId; // the view to which this map belongs
    resetMap(mapDiv, grammarInterpreter) {
        this._grammarInterpreter = grammarInterpreter;
    }
    get mouse() {
        return this._mouse;
    }
    /**
     * gets the map div
     */
    get div() {
        return this._mapDiv;
    }
    /**
     * gets the canvas element
     */
    get canvas() {
        return this._canvas;
    }
    /**
     * gets the opengl context
     */
    get glContext() {
        return this._glContext;
    }
    /**
     * gets the camera object
     */
    get camera() {
        return this._camera;
    }
    /**
     * gets the layers
     */
    get layerManager() {
        return this._layerManager;
    }
    get knotManager() {
        return this._knotManager;
    }
    get grammarManager() {
        return this._grammarManager;
    }
    /**
     * Map initialization function
     */
    async init(mapDivId, updateStatusCallback) {
        let mapDiv = document.getElementById(mapDivId);
        if (mapDiv == null) {
            return;
        }
        mapDiv.innerHTML = "";
        this._mapDiv = mapDiv;
        this._canvas = document.createElement('canvas');
        this._canvas.id = mapDiv.id + "_mapCanvas";
        this._canvas.className = "mapView";
        this._glContext = this._canvas.getContext('webgl2', { preserveDrawingBuffer: true, stencil: true }); // preserve drawing buffer is used to generate valid blobs for the cave
        this._mapDiv.appendChild(this._canvas);
        this._viewId = 0; // TODO: should change depending on in what view the map is
        this._updateStatusCallback = updateStatusCallback;
        this._layerManager = new LayerManager(this._updateStatusCallback, this);
        this._knotManager = new KnotManager(this._updateStatusCallback);
        if (this._knotVisibilityMonitor) {
            clearInterval(this._knotVisibilityMonitor);
        }
        // inits the mouse events
        this.initMouseEvents();
        // bind the window events
        this.initWindowEvents();
        // inits the keyboard events
        this.initKeyboardEvents();
        this.monitorKnotVisibility();
        await this.initCamera(this._grammarInterpreter.getCamera(this._viewId));
        // resizes the canvas
        this.resize();
        await this.initLayers();
        this.initKnots();
        let knotsGroups = {};
        for (const knot of this._knotManager.knots) {
            let knotSpecification = knot.knotSpecification;
            if (knotSpecification.group != undefined) {
                if (!(knotSpecification.group.group_name in knotsGroups)) {
                    knotsGroups[knotSpecification.group.group_name] = [{
                            id: knot.id,
                            position: knotSpecification.group.position
                        }];
                }
                else {
                    knotsGroups[knotSpecification.group.group_name].push({
                        id: knot.id,
                        position: knotSpecification.group.position
                    });
                }
            }
            else {
                knotsGroups[knot.id] = [knot.id]; // group of single knot
            }
        }
        for (const group of Object.keys(knotsGroups)) {
            if (knotsGroups[group].length > 1) {
                knotsGroups[group].sort((a, b) => { a.position - b.position; });
                let ids = [];
                for (const element of knotsGroups[group]) {
                    ids.push(element.id);
                }
                knotsGroups[group] = ids;
            }
        }
        this._updateStatusCallback("layersIds", knotsGroups);
        this.initGrammarManager(this._grammarInterpreter.getProcessedGrammar());
        if (this._grammarInterpreter.getFilterKnots(this._viewId) != undefined) {
            this._layerManager.filterBbox = this._grammarInterpreter.getFilterKnots(this._viewId);
        }
        else {
            this._layerManager.filterBbox = [];
        }
        this.render();
    }
    parsePlotsKnotData() {
        let plotsKnots = [];
        for (const plotAttributes of this._grammarInterpreter.getPlots(this._viewId)) {
            for (const knotId of plotAttributes.knots) {
                if (!plotsKnots.includes(knotId)) {
                    plotsKnots.push(knotId);
                }
            }
        }
        let plotsKnotData = [];
        for (const knotId of plotsKnots) {
            for (const knot of this._grammarInterpreter.getKnots(this._viewId)) {
                if (knotId == knot.id) {
                    let lastLink = this._grammarInterpreter.getKnotLastLink(knot, this._viewId);
                    let left_layer = this._layerManager.searchByLayerId(this._grammarInterpreter.getKnotOutputLayer(knot, this._viewId));
                    // let left_layer = this._layerManager.searchByLayerId(lastLink.out.name);
                    if (left_layer == null) {
                        throw Error("Layer not found while processing knot");
                    }
                    let elements = [];
                    if (lastLink.out.level == undefined) { // this is a pure knot
                        continue;
                    }
                    let coordinates = left_layer.getCoordsByLevel(lastLink.out.level);
                    let functionValues = left_layer.getFunctionByLevel(lastLink.out.level, knotId);
                    let knotStructure = this._knotManager.getKnotById(knotId);
                    let highlighted = left_layer.getHighlightsByLevel(lastLink.out.level, knotStructure.shaders);
                    let readCoords = 0;
                    let filtered = left_layer.mesh.filtered;
                    for (let i = 0; i < coordinates.length; i++) {
                        // if(elements.length >= 1000){ // preventing plot from having too many elements TODO: let the user know that plot is cropped
                        //     break;
                        // }
                        if (filtered.length == 0 || filtered[readCoords] == 1) {
                            elements.push({
                                coordinates: coordinates[i],
                                abstract: functionValues[i][0],
                                highlighted: highlighted[i],
                                index: i
                            });
                        }
                        readCoords += coordinates[i].length / left_layer.mesh.dimension;
                    }
                    let knotData = {
                        knotId: knotId,
                        elements: elements
                    };
                    plotsKnotData.push(knotData);
                }
            }
        }
        return plotsKnotData;
    }
    updateGrammarPlotsData() {
        let plotsKnotData = this.parsePlotsKnotData();
        this._grammarManager.updateGrammarPlotsData(plotsKnotData);
    }
    // if clear == true, elementIndex and level are ignored and all selections are deactivated
    updateGrammarPlotsHighlight(layerId, level, elementIndex, clear = false) {
        if (!clear) {
            let elements = {};
            for (const knot of this._grammarInterpreter.getKnots(this._viewId)) {
                let lastLink = this._grammarInterpreter.getKnotLastLink(knot, this._viewId);
                if (lastLink.out.name == layerId && lastLink.out.level == level) {
                    elements[knot.id] = elementIndex;
                }
            }
            this.grammarManager.setHighlightElementsLocally(elements, true, true);
        }
        else {
            let knotsToClear = [];
            for (const knot of this._grammarInterpreter.getKnots(this._viewId)) {
                let lastLink = this._grammarInterpreter.getKnotLastLink(knot, this._viewId);
                if (lastLink.out.name == layerId) {
                    knotsToClear.push(knot.id);
                }
            }
            this.grammarManager.clearHighlightsLocally(knotsToClear);
        }
    }
    initGrammarManager(grammar) {
        this._grammarManager = new GrammarManager(grammar, this._updateStatusCallback, this.parsePlotsKnotData(), { "function": this.setHighlightElement, "arg": this });
    }
    //TODO: not sure if mapview should contain this logic
    setHighlightElement(knotId, elementIndex, value, _this) {
        let knot = _this._grammarInterpreter.getKnotById(knotId, this._viewId);
        if (knot == undefined) {
            throw Error("Cannot highlight element knot not found");
        }
        let layerId = _this._grammarInterpreter.getKnotOutputLayer(knot, _this._viewId);
        let lastLink = _this._grammarInterpreter.getKnotLastLink(knot, _this._viewId);
        if (lastLink.out.level == undefined)
            return;
        let knotObject = _this.knotManager.getKnotById(knotId);
        let shaders = knotObject.shaders;
        // not sure if layer should be accessed directly or knot.ts be used
        for (const layer of _this._layerManager.layers) {
            if (layer.id == layerId) {
                layer.setHighlightElements([elementIndex], lastLink.out.level, value, shaders);
                break;
            }
        }
        _this.render();
    }
    toggleKnot(id, value = null) {
        this._knotManager.toggleKnot(id, value);
        this.render();
    }
    /**
     * Camera initialization function
     * @param {string | ICameraData} data Object containing the camera. If data is a string, then it loads data from disk.
     */
    async initCamera(camera) {
        // load the index file and its layers
        const params = typeof camera === 'string' ? await DataApi.getCameraParameters(camera) : camera;
        // sets the camera
        this._camera = CameraFactory.getInstance();
        this._camera.resetCamera(params.position, params.direction.up, params.direction.lookAt, params.direction.right, this._updateStatusCallback);
    }
    async initLayers() {
        let layers = [];
        let joinedList = [];
        let centroid = this.camera.getWorldOrigin();
        for (const knot of this._grammarInterpreter.getKnots(this._viewId)) {
            if (!knot.knotOp) {
                // load layers from knots if they dont already exist
                for (let i = 0; i < knot.integration_scheme.length; i++) {
                    let joined = false; // if the layers was joined with another layer
                    if (knot.integration_scheme[i].in != undefined && knot.integration_scheme[i].in.name != knot.integration_scheme[i].out) {
                        joined = true;
                    }
                    if (!layers.includes(knot.integration_scheme[i].out.name)) {
                        layers.push(knot.integration_scheme[i].out.name);
                        joinedList.push(joined);
                    }
                    else if (joined) {
                        joinedList[layers.indexOf(knot.integration_scheme[i].out.name)] = joined;
                    }
                }
            }
        }
        for (let i = 0; i < layers.length; i++) {
            let element = layers[i];
            // loads from file if not provided
            const layer = await DataApi.getLayer(element);
            // adds the new layer
            await this.addLayer(layer, centroid, joinedList[i]);
        }
    }
    /**
     * Add layer geometry and function
     */
    async addLayer(layerData, centroid, joined) {
        // gets the layer data if available
        const features = 'data' in layerData ? layerData.data : undefined;
        if (!features) {
            return;
        }
        // loads the layers data
        const layer = this._layerManager.createLayer(layerData, centroid, features);
        // not able to create the layer
        if (!layer) {
            return;
        }
        if (joined) {
            let joinedJson = await DataApi.getJoinedJson(layer.id);
            if (joinedJson)
                layer.setJoinedJson(joinedJson);
        }
        // render
        this.render();
    }
    initKnots() {
        let knotsMap = this._grammarInterpreter.getMap(this._viewId).knots;
        for (const knotGrammar of this._grammarInterpreter.getKnots(this._viewId)) {
            let layerId = this._grammarInterpreter.getKnotOutputLayer(knotGrammar, this._viewId);
            let layer = this._layerManager.searchByLayerId(layerId);
            let knot = this._knotManager.createKnot(knotGrammar.id, layer, knotGrammar, this._grammarInterpreter, this._viewId, knotsMap.includes(knotGrammar.id), this);
            knot.processThematicData(this._layerManager); // send thematic data to the mesh of the physical layer TODO: put this inside the constructor of Knot
            knot.loadShaders(this._glContext); // instantiate the shaders inside the knot TODO: put this inside the constructor of Knot
        }
    }
    /**
     * Inits the mouse events
     */
    initMouseEvents() {
        // creates the mouse events manager
        this._mouse = MouseEventsFactory.getInstance();
        this._mouse.setMap(this);
        // binds the mouse events
        this._mouse.bindEvents();
    }
    /**
     * Inits the mouse events
     */
    initKeyboardEvents() {
        // creates the mouse events manager
        this._keyboard = KeyEventsFactory.getInstance();
        this._keyboard.setMap(this);
    }
    /**
     * inits the window events
     */
    initWindowEvents() {
        // resize listener
        window.addEventListener('resize', () => {
            // resizes the canvas
            this.resize();
            this.render();
        });
    }
    setCamera(camera) {
        this._camera.setPosition(camera.position[0], camera.position[1]);
        this.render();
    }
    /**
     * Renders the map
     */
    render() {
        // no camera defined
        if (!this._camera) {
            return;
        }
        // sky definition
        const sky = MapStyle.getColor('sky').concat([1.0]);
        this._glContext.clearColor(sky[0], sky[1], sky[2], sky[3]);
        // tslint:disable-next-line:no-bitwise
        this._glContext.clear(this._glContext.COLOR_BUFFER_BIT | this._glContext.DEPTH_BUFFER_BIT);
        this._glContext.clearStencil(0);
        this._glContext.clear(this._glContext.STENCIL_BUFFER_BIT);
        // updates the camera
        this._camera.update();
        this._camera.loadPosition(JSON.stringify(this.camera));
        // // render the layers
        // for (const layer of this._layerManager.layers) {
        //     // skips based on visibility
        //     if (!layer.visible) { continue; }
        //     if(this._grammarInterpreter.evaluateLayerVisibility(layer.id, this._viewId)){
        //         // sends the camera
        //         layer.camera = this.camera;
        //         // render
        //         // layer.render(this._glContext);
        //     }
        // }
        for (const knot of this._knotManager.knots) {
            if (this._grammarInterpreter.evaluateKnotVisibility(knot, this._viewId)) {
                if (!knot.visible)
                    this._knotManager.toggleKnot(knot.id, true);
                knot.render(this._glContext, this.camera);
            }
            else {
                if (knot.visible)
                    this._knotManager.toggleKnot(knot.id, false);
            }
        }
    }
    monitorKnotVisibility() {
        let previousKnotVisibility = [];
        for (const knot of this._knotManager.knots) {
            previousKnotVisibility.push(knot.visible);
        }
        let _this = this;
        this._knotVisibilityMonitor = window.setInterval(function () {
            for (let i = 0; i < _this._knotManager.knots.length; i++) {
                let currentVisibility = _this._grammarInterpreter.evaluateKnotVisibility(_this._knotManager.knots[i], _this._viewId);
                // if visibility of some knot changed need to rerender the map
                if (previousKnotVisibility[i] != currentVisibility) {
                    previousKnotVisibility[i] = currentVisibility;
                    _this.render();
                }
            }
        }, 100);
    }
    /**
     * Resizes the html canvas
     */
    resize() {
        const targetWidth = this._mapDiv.clientWidth;
        const targetHeight = this._mapDiv.clientHeight;
        const value = Math.max(targetWidth, targetHeight);
        this._glContext.viewport(0, 0, value, value);
        this._canvas.width = targetWidth;
        this._canvas.height = targetHeight;
        // stores in the camera
        this._camera.setViewportResolution(targetWidth, targetHeight);
        for (const knot of this._knotManager.knots) {
            if (!knot.visible) {
                continue;
            }
            for (const shader of knot.shaders) {
                if (shader instanceof ShaderPicking) {
                    shader.resizeDirty = true;
                }
                if (shader instanceof ShaderPickingTriangles) {
                    shader.resizeDirty = true;
                }
            }
        }
    }
}
var MapViewFactory = (function () {
    var instance;
    return {
        getInstance: function (mapDiv, grammarInterpreter) {
            if (instance == null) {
                instance = new MapView();
            }
            instance.resetMap(mapDiv, grammarInterpreter);
            return instance;
        }
    };
})();

function getDefaultExportFromCjs (x) {
	return x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;
}

function getAugmentedNamespace(n) {
  if (n.__esModule) return n;
  var f = n.default;
	if (typeof f == "function") {
		var a = function a () {
			if (this instanceof a) {
				var args = [null];
				args.push.apply(args, arguments);
				var Ctor = Function.bind.apply(f, args);
				return new Ctor();
			}
			return f.apply(this, arguments);
		};
		a.prototype = f.prototype;
  } else a = {};
  Object.defineProperty(a, '__esModule', {value: true});
	Object.keys(n).forEach(function (k) {
		var d = Object.getOwnPropertyDescriptor(n, k);
		Object.defineProperty(a, k, d.get ? d : {
			enumerable: true,
			get: function () {
				return n[k];
			}
		});
	});
	return a;
}

var createRoot;

var m$1 = require$$2;
if (process.env.NODE_ENV === 'production') {
  createRoot = m$1.createRoot;
  m$1.hydrateRoot;
} else {
  var i$1 = m$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;
  createRoot = function(c, o) {
    i$1.usingClientEntryPoint = true;
    try {
      return m$1.createRoot(c, o);
    } finally {
      i$1.usingClientEntryPoint = false;
    }
  };
}

var e,t,n,r$1,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b,w,x,k,j,S,C,$,_,O,M,E,A,P,T,R,N,I,D,L,B,z,q,F,V,W,H,U,J,K,G,Q,Y,X,Z,ee,te,ne,re,ie,oe,ae,se,ce,ue,le,fe,he,de,ve,pe,me,ge,ye,be,we,xe,ke,je,Se,Ce,$e,_e,Oe,Me,Ee,Ae,Pe,Te,Re,Ne,Ie,De,Le,Be,ze,qe,Fe,Ve,We,He,Ue,Je,Ke,Ge,Qe,Ye,Xe,Ze,et,tt,nt,rt,it,ot,at,st,ct,ut,lt,ft,ht,dt,vt,pt,mt,gt,yt,bt,wt,xt,kt,jt,St,Ct,$t,_t,Ot,Mt,Et,At,Pt,Tt,Rt,Nt,It,Dt,Lt,Bt,zt,qt,Ft,Vt,Wt,Ht,Ut,Jt,Kt,Gt,Qt,Yt,Xt,Zt,en,tn,nn,rn,on,an,sn,cn,un,ln,fn,hn,dn,vn,pn,mn,gn,yn,bn,wn,xn,kn,jn,Sn,Cn,$n,_n,On,Mn,En,An,Pn,Tn,Rn,Nn,In,Dn,Ln,Bn,zn,qn,Fn,Vn,Wn,Hn,Un,Jn,Kn,Gn,Qn,Yn,Xn,Zn,er,tr,nr,rr,ir,or,ar,sr,cr,ur,lr,fr,hr,dr,vr,pr,mr,gr,yr,br,wr,xr,kr,jr,Sr,Cr,$r,_r,Or,Mr,Er,Ar,Pr,Tr,Rr,Nr,Ir,Dr,Lr,Br,zr,qr,Fr,Vr,Wr,Hr,Ur,Jr,Kr,Gr,Qr,Yr,Xr,Zr,ei,ti,ni,ri,ii,oi,ai,si,ci,ui,li,fi,hi,di,vi=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"],pi=["mainAxis","crossAxis","limiter"];function mi(e){var t="function"==typeof Map?new Map:void 0;return mi=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r);}function r(){return gi(e,arguments,Li(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Ti(r,e)},mi(e)}function gi(e,t,n){return gi=Di()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&Ti(i,n.prototype),i},gi.apply(null,arguments)}function yi(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function bi(e,t){if(null==e)return {};var n,r,i=function(e,t){if(null==e)return {};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n]);}return i}function wi(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Wi(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return {s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return {s:function(){n=n.call(e);},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e;},f:function(){try{a||null==n.return||n.return();}finally{if(s)throw o}}}}function xi(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */xi=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value;},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"");}catch(e){c=function(e,t,n){return e[t]=n};}function u(e,t,n,i){var o=t&&t.prototype instanceof h?t:h,a=Object.create(o.prototype),s=new C(i||[]);return r(a,"_invoke",{value:x(e,n,s)}),a}function l(e,t,n){try{return {type:"normal",arg:e.call(t,n)}}catch(e){return {type:"throw",arg:e}}}e.wrap=u;var f={};function h(){}function d(){}function v(){}var p={};c(p,o,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m($([])));g&&g!==t&&n.call(g,o)&&(p=g);var y=v.prototype=h.prototype=Object.create(p);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}));}));}function w(e,t){function i(r,o,a,s){var c=l(e[r],e,o);if("throw"!==c.type){var u=c.arg,f=u.value;return f&&"object"==Ji(f)&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){i("next",e,a,s);}),(function(e){i("throw",e,a,s);})):t.resolve(f).then((function(e){u.value=e,a(u);}),(function(e){return i("throw",e,a,s)}))}s(c.arg);}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r);}))}return o=o?o.then(r,r):r()}});}function x(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return _()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=k(a,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg);}else "return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=l(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===f)continue;return {value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg);}}}function k(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,f;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0);}function $(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return {next:_}}function _(){return {value:void 0,done:!0}}return d.prototype=v,r(y,"constructor",{value:v,configurable:!0}),r(v,"constructor",{value:d,configurable:!0}),d.displayName=c(v,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return !!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return {__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(u(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),c(y,s,"Generator"),c(y,o,(function(){return this})),c(y,"toString",(function(){return "[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=$,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0);},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else {if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return "break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n);}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:$(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},e}function ki(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value;}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i);}function ji(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){ki(o,r,i,a,s,"next",e);}function s(e){ki(o,r,i,a,s,"throw",e);}a(void 0);}))}}function Si(e,t){return $i(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1;}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,i=e;}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||Wi(e,t)||Ci()}function Ci(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $i(e){if(Array.isArray(e))return e}function _i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r);}return n}function Oi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_i(Object(n),!0).forEach((function(t){Mi(e,t,n[t]);})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t));}));}return e}function Mi(e,t,n){return (t=Fi(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ei(){return Ei="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Ai(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Ei.apply(this,arguments)}function Ai(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Li(e)););return e}function Pi(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ti(e,t);}function Ti(e,t){return Ti=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ti(e,t)}function Ri(e){var t=Di();return function(){var n,r=Li(e);if(t){var i=Li(this).constructor;n=Reflect.construct(r,arguments,i);}else n=r.apply(this,arguments);return Ni(this,n)}}function Ni(e,t){if(t&&("object"===Ji(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ii(e)}function Ii(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Di(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return !1}}function Li(e){return Li=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Li(e)}function Bi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Fi(r.key),r);}}function qi(e,t,n){return t&&zi(e.prototype,t),n&&zi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fi(e){var t=function(e,t){if("object"!==Ji(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ji(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return ("string"===t?String:Number)(e)}(e,"string");return "symbol"===Ji(t)?t:String(t)}function Vi(e){return function(e){if(Array.isArray(e))return Ui(e)}(e)||Hi(e)||Wi(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wi(e,t){if(e){if("string"==typeof e)return Ui(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return "Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ui(e,t):void 0}}function Hi(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ui(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ji(e){return Ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ji(e)}function Ki(){}var Gi=function(e){return e};function Qi(e,t){for(var n in t)e[n]=t[n];return e}function Yi(e){return e()}function Xi(){return Object.create(null)}function Zi(e){e.forEach(Yi);}function eo(e){return "function"==typeof e}function to(e,t){return e!=e?t==t:e!==t||e&&"object"===Ji(e)||"function"==typeof e}function no(e,t){return e!=e?t==t:e!==t}function ro(e,t,n,r){if(e){var i=io(e,t,n,r);return e[0](i)}}function io(e,t,n,r){return e[1]&&r?Qi(n.ctx.slice(),e[1](r(t))):n.ctx}function oo(e,t,n,r){if(e[2]&&r){var i=e[2](r(n));if(void 0===t.dirty)return i;if("object"===Ji(i)){for(var o=[],a=Math.max(t.dirty.length,i.length),s=0;s<a;s+=1)o[s]=t.dirty[s]|i[s];return o}return t.dirty|i}return t.dirty}function ao(e,t,n,r,i,o){if(i){var a=io(t,n,r,o);e.p(a,i);}}function so(e){if(e.ctx.length>32){for(var t=[],n=e.ctx.length/32,r=0;r<n;r++)t[r]=-1;return t}return -1}function co(e){var t={};for(var n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function uo(e,t){var n={};for(var r in t=new Set(t),e)t.has(r)||"$"===r[0]||(n[r]=e[r]);return n}function lo(e){return null==e?"":e}function fo(e){return e&&eo(e.destroy)?e.destroy:Ki}var ho="undefined"!=typeof window,vo=ho?function(){return window.performance.now()}:function(){return Date.now()},po=ho?function(e){return requestAnimationFrame(e)}:Ki,mo=new Set;function go(e){mo.forEach((function(t){t.c(e)||(mo.delete(t),t.f());})),0!==mo.size&&po(go);}function yo(e,t){e.appendChild(t);}function bo(e,t,n){var r=wo(e);if(!r.getElementById(t)){var i=$o("style");i.id=t,i.textContent=n,ko(r,i);}}function wo(e){if(!e)return document;var t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function xo(e){var t=$o("style");return ko(wo(e),t),t.sheet}function ko(e,t){return yo(e.head||e,t),t.sheet}function jo(e,t,n){e.insertBefore(t,n||null);}function So(e){e.parentNode&&e.parentNode.removeChild(e);}function Co(e,t){for(var n=0;n<e.length;n+=1)e[n]&&e[n].d(t);}function $o(e){return document.createElement(e)}function _o(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Oo(e){return document.createTextNode(e)}function Mo(){return Oo(" ")}function Eo(){return Oo("")}function Ao(e,t,n,r){return e.addEventListener(t,n,r),function(){return e.removeEventListener(t,n,r)}}function Po(e){return function(t){return t.preventDefault(),e.call(this,t)}}function To(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function Ro(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n);}function No(e,t){var n=Object.getOwnPropertyDescriptors(e.__proto__);for(var r in t)null==t[r]?e.removeAttribute(r):"style"===r?e.style.cssText=t[r]:"__value"===r?e.value=e[r]=t[r]:n[r]&&n[r].set?e[r]=t[r]:Ro(e,r,t[r]);}function Io(e,t){for(var n in t)Ro(e,n,t[n]);}function Do(e){return Array.from(e.childNodes)}function Lo(e,t){t=""+t,e.data!==t&&(e.data=t);}function Bo(e,t){e.value=null==t?"":t;}function zo(e,t,n,r){null===n?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"");}function qo(e,t,n){for(var r=0;r<e.options.length;r+=1){var i=e.options[r];if(i.__value===t)return void(i.selected=!0)}n&&void 0===t||(e.selectedIndex=-1);}function Fo(e,t,n){e.classList[n?"add":"remove"](t);}function Vo(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.bubbles,i=void 0!==r&&r,o=n.cancelable,a=void 0!==o&&o,s=document.createEvent("CustomEvent");return s.initCustomEvent(e,i,a,t),s}function Wo(e,t){return new e(t)}var Ho,Uo=new Map,Jo=0;function Ko(e){for(var t=5381,n=e.length;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}function Go(e,t){var n={stylesheet:xo(t),rules:{}};return Uo.set(e,n),n}function Qo(e,t,n,r,i,o,a){for(var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=16.666/r,u="{\n",l=0;l<=1;l+=c){var f=t+(n-t)*o(l);u+=100*l+"%{".concat(a(f,1-f),"}\n");}var h=u+"100% {".concat(a(n,1-n),"}\n}"),d="__svelte_".concat(Ko(h),"_").concat(s),v=wo(e),p=Uo.get(v)||Go(v,e),m=p.stylesheet,g=p.rules;g[d]||(g[d]=!0,m.insertRule("@keyframes ".concat(d," ").concat(h),m.cssRules.length));var y=e.style.animation||"";return e.style.animation="".concat(y?"".concat(y,", "):"").concat(d," ").concat(r,"ms linear ").concat(i,"ms 1 both"),Jo+=1,d}function Yo(e,t){var n=(e.style.animation||"").split(", "),r=n.filter(t?function(e){return e.indexOf(t)<0}:function(e){return -1===e.indexOf("__svelte")}),i=n.length-r.length;i&&(e.style.animation=r.join(", "),(Jo-=i)||po((function(){Jo||(Uo.forEach((function(e){var t=e.stylesheet.ownerNode;t&&So(t);})),Uo.clear());})));}function Xo(e){Ho=e;}function Zo(){if(!Ho)throw new Error("Function called outside component initialization");return Ho}function ea(e){Zo().$$.on_mount.push(e);}function ta(e){Zo().$$.on_destroy.push(e);}function na(){var e=Zo();return function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.cancelable,o=void 0!==i&&i,a=e.$$.callbacks[t];if(a){var s=Vo(t,n,{cancelable:o});return a.slice().forEach((function(t){t.call(e,s);})),!s.defaultPrevented}return !0}}function ra(e,t){return Zo().$$.context.set(e,t),t}function ia(e){return Zo().$$.context.get(e)}function oa(e,t){var n=this,r=e.$$.callbacks[t.type];r&&r.slice().forEach((function(e){return e.call(n,t)}));}var aa=[],sa=[],ca=[],ua=[],la=Promise.resolve(),fa=!1;function ha(){fa||(fa=!0,la.then(ba));}function da(){return ha(),la}function va(e){ca.push(e);}function pa(e){ua.push(e);}var ma,ga=new Set,ya=0;function ba(){if(0===ya){var e=Ho;do{try{for(;ya<aa.length;){var t=aa[ya];ya++,Xo(t),wa(t.$$);}}catch(e){throw aa.length=0,ya=0,e}for(Xo(null),aa.length=0,ya=0;sa.length;)sa.pop()();for(var n=0;n<ca.length;n+=1){var r=ca[n];ga.has(r)||(ga.add(r),r());}ca.length=0;}while(aa.length);for(;ua.length;)ua.pop()();fa=!1,ga.clear(),Xo(e);}}function wa(e){if(null!==e.fragment){e.update(),Zi(e.before_update);var t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(va);}}function xa(e,t,n){e.dispatchEvent(Vo("".concat(t?"intro":"outro").concat(n)));}var ka,ja=new Set;function Sa(){ka={r:0,c:[],p:ka};}function Ca(){ka.r||Zi(ka.c),ka=ka.p;}function $a(e,t){e&&e.i&&(ja.delete(e),e.i(t));}function _a(e,t,n,r){if(e&&e.o){if(ja.has(e))return;ja.add(e),ka.c.push((function(){ja.delete(e),r&&(n&&e.d(1),r());})),e.o(t);}else r&&r();}var Oa={duration:0};function Ma(e,t,n,r){var i={direction:"both"},o=t(e,n,i),a=r?0:1,s=null,c=null,u=null;function l(){u&&Yo(e,u);}function f(e,t){var n=e.b-a;return t*=Math.abs(n),{a:a,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function h(t){var n,r=o||Oa,i=r.delay,h=void 0===i?0:i,d=r.duration,v=void 0===d?300:d,p=r.easing,m=void 0===p?Gi:p,g=r.tick,y=void 0===g?Ki:g,b=r.css,w={start:vo()+h,b:t};t||(w.group=ka,ka.r+=1),s||c?c=w:(b&&(l(),u=Qo(e,a,t,v,h,m,b)),t&&y(0,1),s=f(w,v),va((function(){return xa(e,t,"start")})),n=function(t){if(c&&t>c.start&&(s=f(c,v),c=null,xa(e,s.b,"start"),b&&(l(),u=Qo(e,a,s.b,s.duration,0,m,o.css))),s)if(t>=s.end)y(a=s.b,1-a),xa(e,s.b,"end"),c||(s.b?l():--s.group.r||Zi(s.group.c)),s=null;else if(t>=s.start){var n=t-s.start;a=s.a+s.d*m(n/s.duration),y(a,1-a);}return !(!s&&!c)},0===mo.size&&po(go),new Promise((function(e){mo.add({c:n,f:e});})));}return {run:function(e){eo(o)?(ma||(ma=Promise.resolve()).then((function(){ma=null;})),ma).then((function(){o=o(i),h(e);})):h(e);},end:function(){l(),s=c=null;}}}var Ea="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function Aa(e,t){e.d(1),t.delete(e.key);}function Pa(e,t){_a(e,1,1,(function(){t.delete(e.key);}));}function Ta(e,t,n,r,i,o,a,s,c,u,l,f){for(var h=e.length,d=o.length,v=h,p={};v--;)p[e[v].key]=v;var m=[],g=new Map,y=new Map,b=[];v=d;for(var w=function(){var e=f(i,o,v),s=n(e),c=a.get(s);c?r&&b.push((function(){return c.p(e,t)})):(c=u(s,e)).c(),g.set(s,m[v]=c),s in p&&y.set(s,Math.abs(v-p[s]));};v--;)w();var x=new Set,k=new Set;function j(e){$a(e,1),e.m(s,l),a.set(e.key,e),l=e.first,d--;}for(;h&&d;){var S=m[d-1],C=e[h-1],$=S.key,_=C.key;S===C?(l=S.first,h--,d--):g.has(_)?!a.has($)||x.has($)?j(S):k.has(_)?h--:y.get($)>y.get(_)?(k.add($),j(S)):(x.add(_),h--):(c(C,a),h--);}for(;h--;){var O=e[h];g.has(O.key)||c(O,a);}for(;d;)j(m[d-1]);return Zi(b),m}function Ra(e,t){for(var n={},r={},i={$$scope:1},o=e.length;o--;){var a=e[o],s=t[o];if(s){for(var c in a)c in s||(r[c]=1);for(var u in s)i[u]||(n[u]=s[u],i[u]=1);e[o]=s;}else for(var l in a)i[l]=1;}for(var f in r)f in n||(n[f]=void 0);return n}function Na(e){return "object"===Ji(e)&&null!==e?e:{}}function Ia(e,t,n){var r=e.$$.props[t];void 0!==r&&(e.$$.bound[r]=n,n(e.$$.ctx[r]));}function Da(e){e&&e.c();}function La(e,t,n,r){var i=e.$$,o=i.fragment,a=i.after_update;o&&o.m(t,n),r||va((function(){var t,n=e.$$.on_mount.map(Yi).filter(eo);e.$$.on_destroy?(t=e.$$.on_destroy).push.apply(t,Vi(n)):Zi(n);e.$$.on_mount=[];})),a.forEach(va);}function Ba(e,t){var n,r,i,o=e.$$;null!==o.fragment&&(n=o.after_update,r=[],i=[],ca.forEach((function(e){return -1===n.indexOf(e)?r.push(e):i.push(e)})),i.forEach((function(e){return e()})),ca=r,Zi(o.on_destroy),o.fragment&&o.fragment.d(t),o.on_destroy=o.fragment=null,o.ctx=[]);}function za(e,t){-1===e.$$.dirty[0]&&(aa.push(e),ha(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31;}function qa(e,t,n,r,i,o,a){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[-1],c=Ho;Xo(e);var u=e.$$={fragment:null,ctx:[],props:o,update:Ki,not_equal:i,bound:Xi(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:Xi(),dirty:s,skip_bound:!1,root:t.target||c.$$.root};a&&a(u.root);var l=!1;if(u.ctx=n?n(e,t.props||{},(function(t,n){var r=!(arguments.length<=2)&&arguments.length-2?arguments.length<=2?void 0:arguments[2]:n;return u.ctx&&i(u.ctx[t],u.ctx[t]=r)&&(!u.skip_bound&&u.bound[t]&&u.bound[t](r),l&&za(e,t)),n})):[],u.update(),l=!0,Zi(u.before_update),u.fragment=!!r&&r(u.ctx),t.target){if(t.hydrate){var f=Do(t.target);u.fragment&&u.fragment.l(f),f.forEach(So);}else u.fragment&&u.fragment.c();t.intro&&$a(e.$$.fragment),La(e,t.target,t.anchor,t.customElement),ba();}Xo(c);}new Set([].concat(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]));var Fa=function(){function e(){Bi(this,e);}return qi(e,[{key:"$destroy",value:function(){Ba(this,1),this.$destroy=Ki;}},{key:"$on",value:function(e,t){if(!eo(t))return Ki;var n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1);}}},{key:"$set",value:function(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1);}}]),e}(),Va=function(e){Pi(n,Fa);var t=Ri(n);function n(e){if(Bi(this,n),!e||!e.target&&!e.$$inline)throw new Error("'target' is a required option");return t.call(this)}return qi(n,[{key:"$destroy",value:function(){Ei(Li(n.prototype),"$destroy",this).call(this),this.$destroy=function(){console.warn("Component was already destroyed");};}},{key:"$capture_state",value:function(){}},{key:"$inject_state",value:function(){}}]),n}();(function(e){Pi(n,Va);var t=Ri(n);function n(e){return Bi(this,n),t.call(this,e)}return qi(n)})();function Ha(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!!Ja("debug");if(t){var n=Ka(e);return function(){for(var t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];(t=console).log.apply(t,["%c".concat(e),"color:".concat(n)].concat(i));}}return Ua}function Ua(){}function Ja(e){try{if("undefined"!=typeof window&&void 0!==window.localStorage)return window.localStorage[e]}catch(e){}}function Ka(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return Ga[Math.abs(t)%Ga.length]}var Ga=["#0000CC","#0099FF","#009400","#8dd200","#CCCC00","#CC9933","#ae04e7","#ff35d7","#FF3333","#FF6600","#FF9933","#FFCC33"];function Qa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.delay,r=void 0===n?0:n,i=t.duration,o=void 0===i?400:i,a=t.easing,s=void 0===a?Gi:a,c=+getComputedStyle(e).opacity;return {delay:r,duration:o,easing:s,css:function(e){return "opacity: ".concat(e*c)}}}var Ya=Ea.window;function Xa(e){bo(e,"svelte-n7cvum",".svelte-n7cvum{box-sizing:border-box}.bg.svelte-n7cvum{position:fixed;z-index:1000;top:0;left:0;display:flex;flex-direction:column;justify-content:center;width:100vw;height:100vh;background:rgba(0, 0, 0, 0.66)}@supports (-webkit-touch-callout: none){}.wrap.svelte-n7cvum{position:relative;margin:2rem;max-height:100%}.window.svelte-n7cvum{position:relative;width:40rem;max-width:100%;max-height:100%;margin:2rem auto;color:black;border-radius:0.5rem;background:white}.content.svelte-n7cvum{position:relative;padding:1rem;max-height:calc(100vh - 4rem);overflow:auto}.close.svelte-n7cvum{display:block;box-sizing:border-box;position:absolute;z-index:1000;top:1rem;right:1rem;margin:0;padding:0;width:1.5rem;height:1.5rem;border:0;color:black;border-radius:1.5rem;background:white;box-shadow:0 0 0 1px black;transition:transform 0.2s cubic-bezier(0.25, 0.1, 0.25, 1),\n      background 0.2s cubic-bezier(0.25, 0.1, 0.25, 1);-webkit-appearance:none}.close.svelte-n7cvum:before,.close.svelte-n7cvum:after{content:'';display:block;box-sizing:border-box;position:absolute;top:50%;width:1rem;height:1px;background:black;transform-origin:center;transition:height 0.2s cubic-bezier(0.25, 0.1, 0.25, 1),\n      background 0.2s cubic-bezier(0.25, 0.1, 0.25, 1)}.close.svelte-n7cvum:before{-webkit-transform:translate(0, -50%) rotate(45deg);-moz-transform:translate(0, -50%) rotate(45deg);transform:translate(0, -50%) rotate(45deg);left:0.25rem}.close.svelte-n7cvum:after{-webkit-transform:translate(0, -50%) rotate(-45deg);-moz-transform:translate(0, -50%) rotate(-45deg);transform:translate(0, -50%) rotate(-45deg);left:0.25rem}.close.svelte-n7cvum:hover{background:black}.close.svelte-n7cvum:hover:before,.close.svelte-n7cvum:hover:after{height:2px;background:white}.close.svelte-n7cvum:focus{border-color:#3399ff;box-shadow:0 0 0 2px #3399ff}.close.svelte-n7cvum:active{transform:scale(0.9)}.close.svelte-n7cvum:hover,.close.svelte-n7cvum:focus,.close.svelte-n7cvum:active{outline:none}");}function Za(e){var t,n,r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b=e[1].closeButton&&es(e),w=e[2];return w&&(a=Wo(w,{})),{c:function(){t=$o("div"),n=$o("div"),r=$o("div"),b&&b.c(),i=Mo(),o=$o("div"),a&&Da(a.$$.fragment),Ro(o,"class",s=lo(e[1].classContent)+" svelte-n7cvum"),Ro(o,"style",e[9]),Fo(o,"content",!e[0]),Ro(r,"class",c=lo(e[1].classWindow)+" svelte-n7cvum"),Ro(r,"role","dialog"),Ro(r,"aria-modal","true"),Ro(r,"aria-label",u=e[1].ariaLabelledBy?null:e[1].ariaLabel||null),Ro(r,"aria-labelledby",l=e[1].ariaLabelledBy||null),Ro(r,"style",e[8]),Fo(r,"window",!e[0]),Ro(n,"class",h=lo(e[1].classWindowWrap)+" svelte-n7cvum"),Ro(n,"style",e[7]),Fo(n,"wrap",!e[0]),Ro(t,"id",d=e[1].id),Ro(t,"class",v=lo(e[1].classBg)+" svelte-n7cvum"),Ro(t,"style",e[6]),Fo(t,"bg",!e[0]);},m:function(s,c){jo(s,t,c),yo(t,n),yo(n,r),b&&b.m(r,null),yo(r,i),yo(r,o),a&&La(a,o,null),e[50](r),e[51](n),e[52](t),m=!0,g||(y=[Ao(r,"introstart",(function(){eo(e[13])&&e[13].apply(this,arguments);})),Ao(r,"outrostart",(function(){eo(e[14])&&e[14].apply(this,arguments);})),Ao(r,"introend",(function(){eo(e[15])&&e[15].apply(this,arguments);})),Ao(r,"outroend",(function(){eo(e[16])&&e[16].apply(this,arguments);})),Ao(t,"mousedown",e[20]),Ao(t,"mouseup",e[21])],g=!0);},p:function(f,p){if((e=f)[1].closeButton?b?(b.p(e,p),2&p[0]&&$a(b,1)):((b=es(e)).c(),$a(b,1),b.m(r,i)):b&&(Sa(),_a(b,1,1,(function(){b=null;})),Ca()),4&p[0]&&w!==(w=e[2])){if(a){Sa();var g=a;_a(g.$$.fragment,1,0,(function(){Ba(g,1);})),Ca();}w?(Da((a=Wo(w,{})).$$.fragment),$a(a.$$.fragment,1),La(a,o,null)):a=null;}(!m||2&p[0]&&s!==(s=lo(e[1].classContent)+" svelte-n7cvum"))&&Ro(o,"class",s),(!m||512&p[0])&&Ro(o,"style",e[9]),(!m||3&p[0])&&Fo(o,"content",!e[0]),(!m||2&p[0]&&c!==(c=lo(e[1].classWindow)+" svelte-n7cvum"))&&Ro(r,"class",c),(!m||2&p[0]&&u!==(u=e[1].ariaLabelledBy?null:e[1].ariaLabel||null))&&Ro(r,"aria-label",u),(!m||2&p[0]&&l!==(l=e[1].ariaLabelledBy||null))&&Ro(r,"aria-labelledby",l),(!m||256&p[0])&&Ro(r,"style",e[8]),(!m||3&p[0])&&Fo(r,"window",!e[0]),(!m||2&p[0]&&h!==(h=lo(e[1].classWindowWrap)+" svelte-n7cvum"))&&Ro(n,"class",h),(!m||128&p[0])&&Ro(n,"style",e[7]),(!m||3&p[0])&&Fo(n,"wrap",!e[0]),(!m||2&p[0]&&d!==(d=e[1].id))&&Ro(t,"id",d),(!m||2&p[0]&&v!==(v=lo(e[1].classBg)+" svelte-n7cvum"))&&Ro(t,"class",v),(!m||64&p[0])&&Ro(t,"style",e[6]),(!m||3&p[0])&&Fo(t,"bg",!e[0]);},i:function(n){m||($a(b),a&&$a(a.$$.fragment,n),va((function(){m&&(f||(f=Ma(r,e[12],e[1].transitionWindowProps,!0)),f.run(1));})),va((function(){m&&(p||(p=Ma(t,e[11],e[1].transitionBgProps,!0)),p.run(1));})),m=!0);},o:function(n){_a(b),a&&_a(a.$$.fragment,n),f||(f=Ma(r,e[12],e[1].transitionWindowProps,!1)),f.run(0),p||(p=Ma(t,e[11],e[1].transitionBgProps,!1)),p.run(0),m=!1;},d:function(n){n&&So(t),b&&b.d(),a&&Ba(a),e[50](null),n&&f&&f.end(),e[51](null),e[52](null),n&&p&&p.end(),g=!1,Zi(y);}}}function es(e){var t,n,r,i,o,a=[ns,ts],s=[];function c(e,n){return 2&n[0]&&(t=null),null==t&&(t=!!e[17](e[1].closeButton)),t?0:1}return n=c(e,[-1,-1,-1]),r=s[n]=a[n](e),{c:function(){r.c(),i=Eo();},m:function(e,t){s[n].m(e,t),jo(e,i,t),o=!0;},p:function(e,t){var o=n;(n=c(e,t))===o?s[n].p(e,t):(Sa(),_a(s[o],1,1,(function(){s[o]=null;})),Ca(),(r=s[n])?r.p(e,t):(r=s[n]=a[n](e)).c(),$a(r,1),r.m(i.parentNode,i));},i:function(e){o||($a(r),o=!0);},o:function(e){_a(r),o=!1;},d:function(e){s[n].d(e),e&&So(i);}}}function ts(e){var t,n,r,i;return {c:function(){Ro(t=$o("button"),"class",n=lo(e[1].classCloseButton)+" svelte-n7cvum"),Ro(t,"aria-label","Close modal"),Ro(t,"style",e[10]),Ro(t,"type","button"),Fo(t,"close",!e[0]);},m:function(n,o){jo(n,t,o),r||(i=Ao(t,"click",e[18]),r=!0);},p:function(e,r){2&r[0]&&n!==(n=lo(e[1].classCloseButton)+" svelte-n7cvum")&&Ro(t,"class",n),1024&r[0]&&Ro(t,"style",e[10]),3&r[0]&&Fo(t,"close",!e[0]);},i:Ki,o:Ki,d:function(e){e&&So(t),r=!1,i();}}}function ns(e){var t,n,r,i=e[1].closeButton;function o(e){return {props:{onClose:e[18]}}}return i&&(t=Wo(i,o(e))),{c:function(){t&&Da(t.$$.fragment),n=Eo();},m:function(e,i){t&&La(t,e,i),jo(e,n,i),r=!0;},p:function(e,r){if(2&r[0]&&i!==(i=e[1].closeButton)){if(t){Sa();var a=t;_a(a.$$.fragment,1,0,(function(){Ba(a,1);})),Ca();}i?(Da((t=Wo(i,o(e))).$$.fragment),$a(t.$$.fragment,1),La(t,n.parentNode,n)):t=null;}},i:function(e){r||(t&&$a(t.$$.fragment,e),r=!0);},o:function(e){t&&_a(t.$$.fragment,e),r=!1;},d:function(e){e&&So(n),t&&Ba(t,e);}}}function rs(e){var t,n,r,i,o=e[2]&&Za(e),a=e[49].default,s=ro(a,e,e[48],null);return {c:function(){o&&o.c(),t=Mo(),s&&s.c();},m:function(a,c){o&&o.m(a,c),jo(a,t,c),s&&s.m(a,c),n=!0,r||(i=Ao(Ya,"keydown",e[19]),r=!0);},p:function(e,r){e[2]?o?(o.p(e,r),4&r[0]&&$a(o,1)):((o=Za(e)).c(),$a(o,1),o.m(t.parentNode,t)):o&&(Sa(),_a(o,1,1,(function(){o=null;})),Ca()),s&&s.p&&(!n||131072&r[1])&&ao(s,a,e,e[48],n?oo(a,e[48],r,null):so(e[48]),null);},i:function(e){n||($a(o),$a(s,e),n=!0);},o:function(e){_a(o),_a(s,e),n=!1;},d:function(e){o&&o.d(e),e&&So(t),s&&s.d(e),r=!1,i();}}}function is(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){return new e(Oi(Oi({},n),{},{props:Oi(Oi({},t),n.props)}))}}function os(e,t,n){var r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y=t.$$slots,b=void 0===y?{}:y,w=t.$$scope,x=na(),k=ra,j=t.isTabbable,S=void 0===j?function(e){return e.tabIndex>=0&&!e.hidden&&!e.disabled&&"none"!==e.style.display&&"hidden"!==e.type&&Boolean(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}:j,C=t.show,$=void 0===C?null:C,_=t.id,O=void 0===_?null:_,M=t.key,E=void 0===M?"simple-modal":M,A=t.ariaLabel,P=void 0===A?null:A,T=t.ariaLabelledBy,R=void 0===T?null:T,N=t.closeButton,I=void 0===N||N,D=t.closeOnEsc,L=void 0===D||D,B=t.closeOnOuterClick,z=void 0===B||B,q=t.styleBg,F=void 0===q?{}:q,V=t.styleWindowWrap,W=void 0===V?{}:V,H=t.styleWindow,U=void 0===H?{}:H,J=t.styleContent,K=void 0===J?{}:J,G=t.styleCloseButton,Q=void 0===G?{}:G,Y=t.classBg,X=void 0===Y?null:Y,Z=t.classWindowWrap,ee=void 0===Z?null:Z,te=t.classWindow,ne=void 0===te?null:te,re=t.classContent,ie=void 0===re?null:re,oe=t.classCloseButton,ae=void 0===oe?null:oe,se=t.unstyled,ce=void 0!==se&&se,ue=t.setContext,le=void 0===ue?k:ue,fe=t.transitionBg,he=void 0===fe?Qa:fe,de=t.transitionBgProps,ve=void 0===de?{duration:250}:de,pe=t.transitionWindow,me=void 0===pe?he:pe,ge=t.transitionWindowProps,ye=void 0===ge?ve:ge,be=t.disableFocusTrap,we=void 0!==be&&be,xe={id:O,ariaLabel:P,ariaLabelledBy:R,closeButton:I,closeOnEsc:L,closeOnOuterClick:z,styleBg:F,styleWindowWrap:W,styleWindow:U,styleContent:K,styleCloseButton:Q,classBg:X,classWindowWrap:ee,classWindow:ne,classContent:ie,classCloseButton:ae,transitionBg:he,transitionBgProps:ve,transitionWindow:me,transitionWindowProps:ye,disableFocusTrap:we,isTabbable:S,unstyled:ce},ke=Oi({},xe),je=null,Se=function(e){return e?Object.keys(e).reduce((function(t,n){return "".concat(t,"; ").concat(function(e){return e.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()}(n),": ").concat(e[n])}),""):""},Ce=function(e){return !!(e&&e.constructor&&e.call&&e.apply)},$e=function(){n(6,s=Se(Object.assign({},{width:window.innerWidth,height:window.innerHeight},ke.styleBg))),n(7,c=Se(ke.styleWindowWrap)),n(8,u=Se(ke.styleWindow)),n(9,l=Se(ke.styleContent)),n(10,f=Se(ke.styleCloseButton)),n(11,h=ke.transitionBg),n(12,d=ke.transitionWindow);},_e=function(){},Oe=_e,Me=_e,Ee=_e,Ae=_e,Pe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};n(2,je=is(e,t)),n(1,ke=Oi(Oi({},xe),r)),$e(),Re(),n(13,Oe=function(e){i.onOpen&&i.onOpen(e),x("open"),x("opening");}),n(14,Me=function(e){i.onClose&&i.onClose(e),x("close"),x("closing");}),n(15,Ee=function(e){i.onOpened&&i.onOpened(e),x("opened");}),n(16,Ae=function(e){i.onClosed&&i.onClosed(e),x("closed");});},Te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};je&&(n(14,Me=e.onClose||Me),n(16,Ae=e.onClosed||Ae),n(2,je=null),Ne());},Re=function(){a=window.scrollY,v=document.body.style.position,p=document.body.style.overflow,m=document.body.style.width,document.body.style.position="fixed",document.body.style.top="-".concat(a,"px"),document.body.style.overflow="hidden",document.body.style.width="100%";},Ne=function(){document.body.style.position=v||"",document.body.style.top="",document.body.style.overflow=p||"",document.body.style.width=m||"",window.scrollTo({top:a,left:0,behavior:"instant"});};le(E,{open:Pe,close:Te});var Ie=!1;return ta((function(){Ie&&Te();})),ea((function(){n(47,Ie=!0);})),e.$$set=function(e){"isTabbable"in e&&n(22,S=e.isTabbable),"show"in e&&n(23,$=e.show),"id"in e&&n(24,O=e.id),"key"in e&&n(25,E=e.key),"ariaLabel"in e&&n(26,P=e.ariaLabel),"ariaLabelledBy"in e&&n(27,R=e.ariaLabelledBy),"closeButton"in e&&n(28,I=e.closeButton),"closeOnEsc"in e&&n(29,L=e.closeOnEsc),"closeOnOuterClick"in e&&n(30,z=e.closeOnOuterClick),"styleBg"in e&&n(31,F=e.styleBg),"styleWindowWrap"in e&&n(32,W=e.styleWindowWrap),"styleWindow"in e&&n(33,U=e.styleWindow),"styleContent"in e&&n(34,K=e.styleContent),"styleCloseButton"in e&&n(35,Q=e.styleCloseButton),"classBg"in e&&n(36,X=e.classBg),"classWindowWrap"in e&&n(37,ee=e.classWindowWrap),"classWindow"in e&&n(38,ne=e.classWindow),"classContent"in e&&n(39,ie=e.classContent),"classCloseButton"in e&&n(40,ae=e.classCloseButton),"unstyled"in e&&n(0,ce=e.unstyled),"setContext"in e&&n(41,le=e.setContext),"transitionBg"in e&&n(42,he=e.transitionBg),"transitionBgProps"in e&&n(43,ve=e.transitionBgProps),"transitionWindow"in e&&n(44,me=e.transitionWindow),"transitionWindowProps"in e&&n(45,ye=e.transitionWindowProps),"disableFocusTrap"in e&&n(46,we=e.disableFocusTrap),"$$scope"in e&&n(48,w=e.$$scope);},e.$$.update=function(){8388608&e.$$.dirty[0]|65536&e.$$.dirty[1]&&Ie&&(Ce($)?Pe($):Te());},[ce,ke,je,r,i,o,s,c,u,l,f,h,d,Oe,Me,Ee,Ae,Ce,Te,function(e){if(ke.closeOnEsc&&je&&"Escape"===e.key&&(e.preventDefault(),Te()),je&&"Tab"===e.key&&!ke.disableFocusTrap){var t=o.querySelectorAll("*"),n=Array.from(t).filter(ke.isTabbable).sort((function(e,t){return e.tabIndex-t.tabIndex})),r=n.indexOf(document.activeElement);-1===r&&e.shiftKey&&(r=0),r+=n.length+(e.shiftKey?-1:1),n[r%=n.length].focus(),e.preventDefault();}},function(e){!ke.closeOnOuterClick||e.target!==r&&e.target!==i||(g=e.target);},function(e){ke.closeOnOuterClick&&e.target===g&&(e.preventDefault(),Te());},S,$,O,E,P,R,I,L,z,F,W,U,K,Q,X,ee,ne,ie,ae,le,he,ve,me,ye,we,Ie,w,b,function(e){sa[e?"unshift":"push"]((function(){n(5,o=e);}));},function(e){sa[e?"unshift":"push"]((function(){n(4,i=e);}));},function(e){sa[e?"unshift":"push"]((function(){n(3,r=e);}));}]}var as,ss,cs,us,ls,fs,hs=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,os,rs,to,{isTabbable:22,show:23,id:24,key:25,ariaLabel:26,ariaLabelledBy:27,closeButton:28,closeOnEsc:29,closeOnOuterClick:30,styleBg:31,styleWindowWrap:32,styleWindow:33,styleContent:34,styleCloseButton:35,classBg:36,classWindowWrap:37,classWindow:38,classContent:39,classCloseButton:40,unstyled:0,setContext:41,transitionBg:42,transitionBgProps:43,transitionWindow:44,transitionWindowProps:45,disableFocusTrap:46},Xa,[-1,-1,-1]),r}return qi(n)}();!function(e){e.text="text",e.tree="tree",e.table="table";}(as||(as={})),function(e){e.after="after",e.inside="inside",e.key="key",e.value="value",e.multi="multi";}(ss||(ss={})),function(e){e.after="after",e.key="key",e.value="value",e.inside="inside";}(cs||(cs={})),function(e){e.info="info",e.warning="warning",e.error="error";}(us||(us={})),function(e){e.key="key",e.value="value";}(ls||(ls={})),function(e){e.asc="asc",e.desc="desc";}(fs||(fs={}));var ds=[{start:0,end:100}],vs={closeButton:!1,classBg:"jse-modal-bg",classWindow:"jse-modal-window",classWindowWrap:"jse-modal-window-wrap",classContent:"jse-modal-content"},ps=Oi(Oi({},vs),{},{classWindow:"jse-modal-window jse-modal-window-sort"}),ms=Oi(Oi({},vs),{},{classWindow:"jse-modal-window jse-modal-window-transform"}),gs=Oi(Oi({},vs),{},{classWindow:"jse-modal-window jse-modal-window-jsoneditor"}),ys="Insert or paste contents, enter [ insert a new array, enter { to insert a new object, or start typing to insert a new value",bs="Open context menu (Click here, right click on the selection, or use the context menu button or Ctrl+Q)",ws="NO",xs="SELF",ks="NEXT_INSIDE",js=(Mi(e={},fs.asc,"ascending"),Mi(e,fs.desc,"descending"),e),Ss=0;function Cs(){return ++Ss}function $s(e){return $s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$s(e)}function _s(e){return Array.isArray(e)}function Os(e){return null!==e&&"object"===$s(e)&&e.constructor===Object}function Ms(e){return !(!e||"object"!==$s(e))&&"add"===e.op}function Es(e){return !(!e||"object"!==$s(e))&&"remove"===e.op}function As(e){return !(!e||"object"!==$s(e))&&"replace"===e.op}function Ps(e){return !(!e||"object"!==$s(e))&&"copy"===e.op}function Ts(e){return !(!e||"object"!==$s(e))&&"move"===e.op}function Rs(e){return Rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rs(e)}function Ns(e,t){return e===t}function Is(e){return e.slice(0,e.length-1)}function Ds(e){return "object"===Rs(e)&&null!==e}function Ls(e){return Ls="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ls(e)}function Bs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r);}return n}function zs(e,t,n){return (t=function(e){var t=function(e,t){if("object"!==Ls(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ls(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return ("string"===t?String:Number)(e)}(e,"string");return "symbol"===Ls(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qs(e){if(_s(e)){var t=e.slice();return Object.getOwnPropertySymbols(e).forEach((function(n){t[n]=e[n];})),t}if(Os(e)){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bs(Object(n),!0).forEach((function(t){zs(e,t,n[t]);})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t));}));}return e}({},e);return Object.getOwnPropertySymbols(e).forEach((function(t){n[t]=e[t];})),n}return e}function Fs(e,t,n){if(e[t]===n)return e;var r=qs(e);return r[t]=n,r}function Vs(e,t){for(var n=e,r=0;r<t.length;)n=Os(n)?n[t[r]]:_s(n)?n[parseInt(t[r])]:void 0,r++;return n}function Ws(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(0===t.length)return n;var i=t[0],o=Ws(e?e[i]:void 0,t.slice(1),n,r);if(Os(e)||_s(e))return Fs(e,i,o);if(r){var a=Hs.test(i)?[]:{};return a[i]=o,a}throw new Error("Path does not exist")}var Hs=/^\d+$/;function Us(e,t,n){if(0===t.length)return n(e);if(!Ds(e))throw new Error("Path doesn't exist");var r=t[0];return Fs(e,r,Us(e[r],t.slice(1),n))}function Js(e,t){if(0===t.length)return e;if(!Ds(e))throw new Error("Path does not exist");if(1===t.length){var n=t[0];if(n in e){var r=qs(e);return _s(r)&&r.splice(parseInt(n),1),Os(r)&&delete r[n],r}return e}var i=t[0];return Fs(e,i,Js(e[i],t.slice(1)))}function Ks(e,t,n){var r=t.slice(0,t.length-1),i=t[t.length-1];return Us(e,r,(function(e){if(!Array.isArray(e))throw new TypeError("Array expected at path "+JSON.stringify(r));var t=qs(e);return t.splice(parseInt(i),0,n),t}))}function Gs(e,t){return void 0!==e&&(0===t.length||null!==e&&Gs(e[t[0]],t.slice(1)))}function Qs(e){var t=e.split("/");return t.shift(),t.map((function(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}))}function Ys(e){return e.map(Xs).join("")}function Xs(e){return "/"+String(e).replace(/~/g,"~0").replace(/\//g,"~1")}function Zs(e,t){return e+Xs(t)}function ec(e,t){return e.startsWith(t)&&(e.length===t.length||"/"===e[t.length])}function tc(e,t,n){for(var r=e,i=0;i<t.length;i++){uc(t[i]);var o=t[i];if(n&&n.before){var a=n.before(r,o);if(void 0!==a){if(void 0!==a.document&&(r=a.document),void 0!==a.json)throw new Error('Deprecation warning: returned object property ".json" has been renamed to ".document"');void 0!==a.operation&&(o=a.operation);}}var s=r,c=lc(r,o.path);if("add"===o.op)r=ic(r,c,o.value);else if("remove"===o.op)r=rc(r,c);else if("replace"===o.op)r=nc(r,c,o.value);else if("copy"===o.op)r=oc(r,c,fc(o.from));else if("move"===o.op)r=ac(r,c,fc(o.from));else {if("test"!==o.op)throw new Error("Unknown JSONPatch operation "+JSON.stringify(o));sc(r,c,o.value);}if(n&&n.after){var u=n.after(r,o,s);void 0!==u&&(r=u);}}return r}function nc(e,t,n){return Ws(e,t,n)}function rc(e,t){return Js(e,t)}function ic(e,t,n){return cc(e,t)?Ks(e,t,n):Ws(e,t,n)}function oc(e,t,n){var r=Vs(e,n);return cc(e,t)?Ks(e,t,r):Ws(e,t,Vs(e,n))}function ac(e,t,n){var r=Vs(e,n),i=Js(e,n);return cc(i,t)?Ks(i,t,r):Ws(i,t,r)}function sc(e,t,n){if(void 0===n)throw new Error('Test failed: no value provided (path: "'.concat(Ys(t),'")'));if(!Gs(e,t))throw new Error('Test failed: path not found (path: "'.concat(Ys(t),'")'));if(!function(e,t){return JSON.stringify(e)===JSON.stringify(t)}(Vs(e,t),n))throw new Error('Test failed, value differs (path: "'.concat(Ys(t),'")'))}function cc(e,t){if(0===t.length)return !1;var n=Vs(e,Is(t));return Array.isArray(n)}function uc(e){if(!["add","remove","replace","copy","move","test"].includes(e.op))throw new Error("Unknown JSONPatch op "+JSON.stringify(e.op));if("string"!=typeof e.path)throw new Error('Required property "path" missing or not a string in operation '+JSON.stringify(e));if(("copy"===e.op||"move"===e.op)&&"string"!=typeof e.from)throw new Error('Required property "from" missing or not a string in operation '+JSON.stringify(e))}function lc(e,t){return function(e,t){if("-"!==function(e){return e[e.length-1]}(t))return t;var n=Is(t),r=Vs(e,n);return n.concat(r.length)}(e,Qs(t))}function fc(e){return Qs(e)}function hc(e){return function(e){if(Array.isArray(e))return dc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return dc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dc(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vc(e,t,n){var r=[];return tc(e,t,{before:function(e,t){var i,o,a=lc(e,t.path);if("add"===t.op)i=gc(e,a);else if("remove"===t.op)i=mc(e,a);else if("replace"===t.op)i=pc(e,a);else if("copy"===t.op)i=function(e,t){return gc(e,t)}(e,a);else if("move"===t.op)i=function(e,t,n){if(t.length<n.length&&function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ns;if(e.length<t.length)return !1;for(var r=0;r<t.length;r++)if(!n(e[r],t[r]))return !1;return !0}(n,t))return [{op:"replace",path:Ys(t),value:e}];var r={op:"move",from:Ys(t),path:Ys(n)};return !cc(e,t)&&Gs(e,t)?[r].concat(hc(mc(e,t))):[r]}(e,a,fc(t.from));else {if("test"!==t.op)throw new Error("Unknown JSONPatch operation "+JSON.stringify(t));i=[];}if(n&&n.before){var s=n.before(e,t,i);if(s&&s.revertOperations&&(i=s.revertOperations),s&&s.document&&(o=s.document),s&&s.json)throw new Error('Deprecation warning: returned object property ".json" has been renamed to ".document"')}if(r=i.concat(r),void 0!==o)return {document:o}}}),r}function pc(e,t){return [{op:"replace",path:Ys(t),value:Vs(e,t)}]}function mc(e,t){return [{op:"add",path:Ys(t),value:Vs(e,t)}]}function gc(e,t){return cc(e,t)||!Gs(e,t)?[{op:"remove",path:Ys(t)}]:pc(e,t)}function yc(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var bc={},wc={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",'"':'"',"/":"/","\\":"\\"},xc="a".charCodeAt();bc.parse=function(e,t,n){var r={},i=0,o=0,a=0,s=n&&n.bigint&&"undefined"!=typeof BigInt;return {data:c("",!0),pointers:r};function c(t,n){var r;u(),m(t,"value");var i=h();switch(i){case"t":f("rue"),r=!0;break;case"f":f("alse"),r=!1;break;case"n":f("ull"),r=null;break;case'"':r=l();break;case"[":r=function(e){u();var t=[],n=0;if("]"==h())return t;d();for(;;){var r=e+"/"+n;t.push(c(r)),u();var i=h();if("]"==i)break;","!=i&&w(),u(),n++;}return t}(t);break;case"{":r=function(e){u();var t={};if("}"==h())return t;d();for(;;){var n=y();'"'!=h()&&w();var r=l(),i=e+"/"+Tc(r);g(i,"key",n),m(i,"keyEnd"),u(),":"!=h()&&w(),u(),t[r]=c(i),u();var o=h();if("}"==o)break;","!=o&&w(),u();}return t}(t);break;default:d(),"-0123456789".indexOf(i)>=0?r=function(){var t="",n=!0;"-"==e[a]&&(t+=h());t+="0"==e[a]?h():p(),"."==e[a]&&(t+=h()+p(),n=!1);"e"!=e[a]&&"E"!=e[a]||(t+=h(),"+"!=e[a]&&"-"!=e[a]||(t+=h()),t+=p(),n=!1);var r=+t;return s&&n&&(r>Number.MAX_SAFE_INTEGER||r<Number.MIN_SAFE_INTEGER)?BigInt(t):r}():b();}return m(t,"valueEnd"),u(),n&&a<e.length&&b(),r}function u(){e:for(;a<e.length;){switch(e[a]){case" ":o++;break;case"\t":o+=4;break;case"\r":o=0;break;case"\n":o=0,i++;break;default:break e}a++;}}function l(){for(var e,t="";'"'!=(e=h());)"\\"==e?(e=h())in wc?t+=wc[e]:"u"==e?t+=v():w():t+=e;return t}function f(e){for(var t=0;t<e.length;t++)h()!==e[t]&&w();}function h(){x();var t=e[a];return a++,o++,t}function d(){a--,o--;}function v(){for(var e=4,t=0;e--;){t<<=4;var n=h().toLowerCase();n>="a"&&n<="f"?t+=n.charCodeAt()-xc+10:n>="0"&&n<="9"?t+=+n:w();}return String.fromCharCode(t)}function p(){for(var t="";e[a]>="0"&&e[a]<="9";)t+=h();if(t.length)return t;x(),b();}function m(e,t){g(e,t,y());}function g(e,t,n){r[e]=r[e]||{},r[e][t]=n;}function y(){return {line:i,column:o,pos:a}}function b(){throw new SyntaxError("Unexpected token "+e[a]+" in JSON at position "+a)}function w(){d(),b();}function x(){if(a>=e.length)throw new SyntaxError("Unexpected end of JSON input")}},bc.stringify=function(e,t,n){if(jc(e)){var r,i,o=0,a="object"==Ji(n)?n.space:n;switch(Ji(a)){case"number":var s=a>10?10:a<0?0:Math.floor(a);a=s&&y(s," "),r=s,i=s;break;case"string":a=a.slice(0,10),r=0,i=0;for(var c=0;c<a.length;c++){switch(a[c]){case" ":i++;break;case"\t":i+=4;break;case"\r":i=0;break;case"\n":i=0,o++;break;default:throw new Error("whitespace characters not allowed in JSON")}r++;}break;default:a=void 0;}var u="",l={},f=0,h=0,d=0,v=n&&n.es6&&"function"==typeof Map;return function e(t,n,r){switch(g(r,"value"),Ji(t)){case"number":case"bigint":case"boolean":p(""+t);break;case"string":p(Ec(t));break;case"object":null===t?p("null"):"function"==typeof t.toJSON?p(Ec(t.toJSON())):Array.isArray(t)?i():v?t.constructor.BYTES_PER_ELEMENT?i():t instanceof Map?s():t instanceof Set?s(!0):o():o();}function i(){if(t.length){p("[");for(var i=n+1,o=0;o<t.length;o++){o&&p(","),m(i);var a=jc(t[o])?t[o]:null;e(a,i,r+"/"+o);}m(n),p("]");}else p("[]");}function o(){var i=Object.keys(t);if(i.length){p("{");for(var o=n+1,s=0;s<i.length;s++){var c=i[s],u=t[c];if(jc(u)){s&&p(",");var l=r+"/"+Tc(c);m(o),g(l,"key"),p(Ec(c)),g(l,"keyEnd"),p(":"),a&&p(" "),e(u,o,l);}}m(n),p("}");}else p("{}");}function s(i){if(t.size){p("{");for(var o=n+1,s=!0,c=t.entries(),u=c.next();!u.done;){var l=u.value,f=l[0],h=!!i||l[1];if(jc(h)){s||p(","),s=!1;var d=r+"/"+Tc(f);m(o),g(d,"key"),p(Ec(f)),g(d,"keyEnd"),p(":"),a&&p(" "),e(h,o,d);}u=c.next();}m(n),p("}");}else p("{}");}g(r,"valueEnd");}(e,0,""),{json:u,pointers:l}}function p(e){h+=e.length,d+=e.length,u+=e;}function m(e){if(a){for(u+="\n"+y(e,a),f++,h=0;e--;)o?(f+=o,h=i):h+=i,d+=r;d+=1;}}function g(e,t){l[e]=l[e]||{},l[e][t]={line:f,column:h,pos:d};}function y(e,t){return Array(e+1).join(t)}};var kc=["number","bigint","boolean","string","object"];function jc(e){return kc.indexOf(Ji(e))>=0}var Sc=/"|\\/g,Cc=/[\b]/g,$c=/\f/g,_c=/\n/g,Oc=/\r/g,Mc=/\t/g;function Ec(e){return '"'+(e=e.replace(Sc,"\\$&").replace($c,"\\f").replace(Cc,"\\b").replace(_c,"\\n").replace(Oc,"\\r").replace(Mc,"\\t"))+'"'}var Ac=/~/g,Pc=/\//g;function Tc(e){return e.replace(Ac,"~0").replace(Pc,"~1")}function Rc(e){return Rc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rc(e)}function Ic(e,t){if(t&&("object"===Rc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Dc(e){var t="function"==typeof Map?new Map:void 0;return Dc=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r);}function r(){return Lc(e,arguments,qc(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),zc(r,e)},Dc(e)}function Lc(e,t,n){return Lc=Bc()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&zc(i,n.prototype),i},Lc.apply(null,arguments)}function Bc(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return !1}}function zc(e,t){return zc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},zc(e,t)}function qc(e){return qc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qc(e)}var Fc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zc(e,t);}(s,Dc(Error));var t,n,r,a=(t=s,n=Bc(),function(){var e,r=qc(t);if(n){var i=qc(this).constructor;e=Reflect.construct(r,arguments,i);}else e=r.apply(this,arguments);return Ic(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(n=a.call(this,e+" at position "+t)).position=t,n}return r=s,Object.defineProperty(r,"prototype",{writable:!1}),r}();function Vc(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function Wc(e){return e>=48&&e<=57}function Hc(e){return e>=32&&e<=1114111}var Uc=/^[,:[\]{}()\n]$/;function Jc(e){return Kc.test(e)||e&&Xc(e.charCodeAt(0))}var Kc=/^[[{\w-]$/;function Gc(e){return 10===e||13===e||9===e||8===e||12===e}function Qc(e){return 32===e||10===e||9===e||13===e}function Yc(e){return 160===e||e>=8192&&e<=8202||8239===e||8287===e||12288===e}function Xc(e){return Zc(e)||tu(e)}function Zc(e){return 34===e||8220===e||8221===e}function eu(e){return 34===e}function tu(e){return 39===e||8216===e||8217===e||96===e||180===e}function nu(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.lastIndexOf(t);return -1!==r?e.substring(0,r)+(n?"":e.substring(r+1)):e}function ru(e,t){var n=e.length;if(!Qc(e.charCodeAt(n-1)))return e+t;for(;Qc(e.charCodeAt(n-1));)n--;return e.substring(0,n)+t+e.substring(n)}function iu(e,t,n){return e.substring(0,t)+e.substring(t+n)}var ou={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"},au={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function su(e){var t=0,n="";i()||function(){throw new Fc("Unexpected end of json string",e.length)}();var r=c(44);if(r&&o(),Jc(e[t])&&function(e){return /[,\n][ \t\r]*$/.test(e)}(n)?(r||(n=ru(n,",")),function(){var e=!0,t=!0;for(;t;){if(e)e=!1;else c(44)||(n=ru(n,","));t=i();}t||(n=nu(n,","));n="[\n".concat(n,"\n]");}()):r&&(n=nu(n,",")),t>=e.length)return n;function i(){o();var r=function(){if(123===e.charCodeAt(t)){n+="{",t++,o();for(var r=!0;t<e.length&&125!==e.charCodeAt(t);){if(r?(r=!1):(c(44)||(n=ru(n,",")),o()),!(l()||h())){125===e.charCodeAt(t)||123===e.charCodeAt(t)||93===e.charCodeAt(t)||91===e.charCodeAt(t)||void 0===e[t]?n=nu(n,","):m();break}o();var a=c(58);a||(Jc(e[t])?n=ru(n,":"):y()),i()||(a?g():y());}return 125===e.charCodeAt(t)?(n+="}",t++):n=ru(n,"}"),!0}return !1}()||function(){if(91===e.charCodeAt(t)){n+="[",t++,o();for(var r=!0;t<e.length&&93!==e.charCodeAt(t);){if(r)r=!1;else c(44)||(n=ru(n,","));if(!i()){n=nu(n,",");break}}return 93===e.charCodeAt(t)?(n+="]",t++):n=ru(n,"]"),!0}return !1}()||l()||function(){var r=t;if(45===e.charCodeAt(t)&&(t++,v(r)))return !0;if(48===e.charCodeAt(t))t++;else if(function(e){return e>=49&&e<=57}(e.charCodeAt(t)))for(t++;Wc(e.charCodeAt(t));)t++;if(46===e.charCodeAt(t)){if(t++,v(r))return !0;for(;Wc(e.charCodeAt(t));)t++;}if(101===e.charCodeAt(t)||69===e.charCodeAt(t)){if(t++,45!==e.charCodeAt(t)&&43!==e.charCodeAt(t)||t++,v(r))return !0;for(;Wc(e.charCodeAt(t));)t++;}if(t>r)return n+=e.slice(r,t),!0;return !1}()||f("true","true")||f("false","false")||f("null","null")||f("True","true")||f("False","false")||f("None","null")||h();return o(),r}function o(){var e=t,n=a();do{(n=s())&&(n=a());}while(n);return t>e}function a(){for(var r,i="";(r=Qc(e.charCodeAt(t)))||Yc(e.charCodeAt(t));)i+=r?e[t]:" ",t++;return i.length>0&&(n+=i,!0)}function s(){if(47===e.charCodeAt(t)&&42===e.charCodeAt(t+1)){for(;t<e.length&&!cu(e,t);)t++;return t+=2,!0}if(47===e.charCodeAt(t)&&47===e.charCodeAt(t+1)){for(;t<e.length&&10!==e.charCodeAt(t);)t++;return !0}return !1}function c(r){return e.charCodeAt(t)===r&&(n+=e[t],t++,!0)}function u(){return function(n){return e.charCodeAt(t)===n&&(t++,!0)}(92)}function l(){var r=92===e.charCodeAt(t);if(r&&(t++,r=!0),Xc(e.charCodeAt(t))){var i=tu(e.charCodeAt(t))?tu:eu(e.charCodeAt(t))?eu:Zc;for(n+='"',t++;t<e.length&&!i(e.charCodeAt(t));){if(92===e.charCodeAt(t)){var a=e[t+1];void 0!==au[a]?(n+=e.slice(t,t+2),t+=2):"u"===a?Vc(e.charCodeAt(t+2))&&Vc(e.charCodeAt(t+3))&&Vc(e.charCodeAt(t+4))&&Vc(e.charCodeAt(t+5))?(n+=e.slice(t,t+6),t+=6):b(t):(n+=a,t+=2);}else {var s=e[t],c=e.charCodeAt(t);34===c&&92!==e.charCodeAt(t-1)?(n+="\\"+s,t++):Gc(c)?(n+=ou[s],t++):(Hc(c)||p(s),n+=s,t++);}r&&u();}return Xc(e.charCodeAt(t))?(e.charCodeAt(t),n+='"',t++):n+='"',function(){o();for(;43===e.charCodeAt(t);){t++,o();var i=(n=nu(n,'"',!0)).length;l(),n=iu(n,i,1);}}(),!0}return !1}function f(r,i){return e.slice(t,t+r.length)===r&&(n+=i,t+=r.length,!0)}function h(){for(var r,o=t;t<e.length&&(r=e[t],!(Uc.test(r)||r&&Xc(r.charCodeAt(0))));)t++;if(t>o){if(40===e.charCodeAt(t))return t++,i(),41===e.charCodeAt(t)&&(t++,59===e.charCodeAt(t)&&t++),!0;for(;Qc(e.charCodeAt(t-1))&&t>0;)t--;var a=e.slice(o,t);return n+=JSON.stringify(a),!0}}function d(n){if(!Wc(e.charCodeAt(t))){var r=e.slice(n,t);throw new Fc("Invalid number '".concat(r,"', expecting a digit ").concat(e[t]?"but got '".concat(e[t],"'"):"but reached end of input"),2)}}function v(r){return t>=e.length?(n+=e.slice(r,t)+"0",!0):(d(r),!1)}function p(e){throw new Fc("Invalid character "+JSON.stringify(e),t)}function m(){throw new Fc("Object key expected",t)}function g(){throw new Fc("Object value expected",t)}function y(){throw new Fc("Colon expected",t)}function b(n){for(var r=n+2;/\w/.test(e[r]);)r++;var i=e.slice(n,r);throw new Fc('Invalid unicode character "'.concat(i,'"'),t)}!function(){throw new Fc("Unexpected character "+JSON.stringify(e[t]),t)}();}function cu(e,t){return "*"===e[t]&&"/"===e[t+1]}function uu(e){return parseInt(e,10)}function lu(e){return fu.test(e)}var fu=/^-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?$/;function hu(e){return "object"===Ji(e)&&null!==e&&e.constructor===Object}function du(e){return "object"===Ji(e)&&null!==e&&(e.constructor===Object||e.constructor===Array)}function vu(e){if("number"==typeof e)return e>9466848e5&&isFinite(e)&&Math.floor(e)===e&&!isNaN(new Date(e).valueOf());if("bigint"==typeof e)return vu(Number(e));try{var t=e?e.valueOf():e;if(t!==e)return vu(t)}catch(e){return !1}return !1}function pu(e){var t=window.document.createElement("div");t.style.color=e;var n=t.style.color;return ""!==n?n.replace(/\s+/g,"").toLowerCase():null}function mu(e,t){if("number"==typeof e||"string"==typeof e||"boolean"==typeof e||void 0===e)return Ji(e);if("bigint"==typeof e)return "number";if(null===e)return "null";if(Array.isArray(e))return "array";if(hu(e))return "object";var n=t.stringify(e);return n&&lu(n)?"number":"true"===n||"false"===n?"boolean":"null"===n?"null":"unknown"}var gu=/^https?:\/\/\S+$/;function yu(e){return "string"==typeof e&&gu.test(e)}function bu(e,t){if(""===e)return "";var n=e.trim();return "null"===n?null:"true"===n||"false"!==n&&(lu(n)?t.parse(n):e)}function wu(e){return xu.test(e)}var xu=/^-?[0-9]+$/,ku="object"==("undefined"==typeof global?"undefined":Ji(global))&&global&&global.Object===Object&&global,ju="object"==("undefined"==typeof self?"undefined":Ji(self))&&self&&self.Object===Object&&self,Su=ku||ju||Function("return this")(),Cu=Su.Symbol,$u=Object.prototype,_u=$u.hasOwnProperty,Ou=$u.toString,Mu=Cu?Cu.toStringTag:void 0;var Eu=Object.prototype.toString;var Au=Cu?Cu.toStringTag:void 0;function Pu(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Au&&Au in Object(e)?function(e){var t=_u.call(e,Mu),n=e[Mu];try{e[Mu]=void 0;var r=!0;}catch(e){}var i=Ou.call(e);return r&&(t?e[Mu]=n:delete e[Mu]),i}(e):function(e){return Eu.call(e)}(e)}function Tu(e){return null!=e&&"object"==Ji(e)}function Ru(e){return "symbol"==Ji(e)||Tu(e)&&"[object Symbol]"==Pu(e)}function Nu(e){return "number"==typeof e?e:Ru(e)?NaN:+e}function Iu(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var Du=Array.isArray,Lu=Cu?Cu.prototype:void 0,Bu=Lu?Lu.toString:void 0;function zu(e){if("string"==typeof e)return e;if(Du(e))return Iu(e,zu)+"";if(Ru(e))return Bu?Bu.call(e):"";var t=e+"";return "0"==t&&1/e==-Infinity?"-0":t}function qu(e,t){return function(n,r){var i;if(void 0===n&&void 0===r)return t;if(void 0!==n&&(i=n),void 0!==r){if(void 0===i)return r;"string"==typeof n||"string"==typeof r?(n=zu(n),r=zu(r)):(n=Nu(n),r=Nu(r)),i=e(n,r);}return i}}var Fu=qu((function(e,t){return e+t}),0),Vu=/\s/;function Wu(e){for(var t=e.length;t--&&Vu.test(e.charAt(t)););return t}var Hu=/^\s+/;function Uu(e){return e?e.slice(0,Wu(e)+1).replace(Hu,""):e}function Ju(e){var t=Ji(e);return null!=e&&("object"==t||"function"==t)}var Ku=/^[-+]0x[0-9a-f]+$/i,Gu=/^0b[01]+$/i,Qu=/^0o[0-7]+$/i,Yu=parseInt;function Xu(e){if("number"==typeof e)return e;if(Ru(e))return NaN;if(Ju(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ju(t)?t+"":t;}if("string"!=typeof e)return 0===e?e:+e;e=Uu(e);var n=Gu.test(e);return n||Qu.test(e)?Yu(e.slice(2),n?2:8):Ku.test(e)?NaN:+e}function Zu(e){return e?Infinity===(e=Xu(e))||-Infinity===e?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function el(e){var t=Zu(e),n=t%1;return t==t?n?t-n:t:0}function tl(e,t){if("function"!=typeof t)throw new TypeError("Expected a function");return e=el(e),function(){if(--e<1)return t.apply(this,arguments)}}function nl(e){return e}function rl(e){if(!Ju(e))return !1;var t=Pu(e);return "[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}var il,ol=Su["__core-js_shared__"],al=(il=/[^.]+$/.exec(ol&&ol.keys&&ol.keys.IE_PROTO||""))?"Symbol(src)_1."+il:"";var sl=Function.prototype.toString;function cl(e){if(null!=e){try{return sl.call(e)}catch(e){}try{return e+""}catch(e){}}return ""}var ul=/^\[object .+?Constructor\]$/,ll=Function.prototype,fl=Object.prototype,hl=ll.toString,dl=fl.hasOwnProperty,vl=RegExp("^"+hl.call(dl).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function pl(e){return !(!Ju(e)||function(e){return !!al&&al in e}(e))&&(rl(e)?vl:ul).test(cl(e))}function ml(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return pl(n)?n:void 0}var gl=ml(Su,"WeakMap"),yl=gl&&new gl,bl=yl?function(e,t){return yl.set(e,t),e}:nl,wl=bl,xl=Object.create,kl=function(){function e(){}return function(t){if(!Ju(t))return {};if(xl)return xl(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),jl=kl;function Sl(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=jl(e.prototype),r=e.apply(n,t);return Ju(r)?r:n}}function Cl(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var $l=Math.max;function _l(e,t,n,r){for(var i=-1,o=e.length,a=n.length,s=-1,c=t.length,u=$l(o-a,0),l=Array(c+u),f=!r;++s<c;)l[s]=t[s];for(;++i<a;)(f||i<o)&&(l[n[i]]=e[i]);for(;u--;)l[s++]=e[i++];return l}var Ol=Math.max;function Ml(e,t,n,r){for(var i=-1,o=e.length,a=-1,s=n.length,c=-1,u=t.length,l=Ol(o-s,0),f=Array(l+u),h=!r;++i<l;)f[i]=e[i];for(var d=i;++c<u;)f[d+c]=t[c];for(;++a<s;)(h||i<o)&&(f[d+n[a]]=e[i++]);return f}function El(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}function Al(){}function Pl(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[];}function Tl(){}Pl.prototype=jl(Al.prototype),Pl.prototype.constructor=Pl;var Rl=yl?function(e){return yl.get(e)}:Tl,Nl=Rl,Il={},Dl=Object.prototype.hasOwnProperty;function Ll(e){for(var t=e.name+"",n=Il[t],r=Dl.call(Il,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function Bl(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0;}function zl(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}function ql(e){if(e instanceof Pl)return e.clone();var t=new Bl(e.__wrapped__,e.__chain__);return t.__actions__=zl(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}Bl.prototype=jl(Al.prototype),Bl.prototype.constructor=Bl;var Fl=Object.prototype.hasOwnProperty;function Vl(e){if(Tu(e)&&!Du(e)&&!(e instanceof Pl)){if(e instanceof Bl)return e;if(Fl.call(e,"__wrapped__"))return ql(e)}return new Bl(e)}function Wl(e){var t=Ll(e),n=Vl[t];if("function"!=typeof n||!(t in Pl.prototype))return !1;if(e===n)return !0;var r=Nl(n);return !!r&&e===r[0]}Vl.prototype=Al.prototype,Vl.prototype.constructor=Vl;var Hl=Date.now;function Ul(e){var t=0,n=0;return function(){var r=Hl(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Jl=Ul(wl),Kl=/\{\n\/\* \[wrapped with (.+)\] \*/,Gl=/,? & /;var Ql=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function Yl(e){return function(){return e}}var Xl=function(){try{var e=ml(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Zl=Xl,ef=Zl?function(e,t){return Zl(e,"toString",{configurable:!0,enumerable:!1,value:Yl(t),writable:!0})}:nl,tf=Ul(ef);function nf(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function rf(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return -1}function of(e){return e!=e}function af(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return -1}(e,t,n):rf(e,of,n)}function sf(e,t){return !!(null==e?0:e.length)&&af(e,t,0)>-1}var cf=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];function uf(e,t,n){var r=t+"";return tf(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(Ql,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return nf(cf,(function(n){var r="_."+n[0];t&n[1]&&!sf(e,r)&&e.push(r);})),e.sort()}(function(e){var t=e.match(Kl);return t?t[1].split(Gl):[]}(r),n)))}function lf(e,t,n,r,i,o,a,s,c,u){var l=8&t;t|=l?32:64,4&(t&=~(l?64:32))||(t&=-4);var f=[e,t,i,l?o:void 0,l?a:void 0,l?void 0:o,l?void 0:a,s,c,u],h=n.apply(void 0,f);return Wl(e)&&Jl(h,f),h.placeholder=r,uf(h,e,t)}function ff(e){return e.placeholder}var hf=/^(?:0|[1-9]\d*)$/;function df(e,t){var n=Ji(e);return !!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&hf.test(e))&&e>-1&&e%1==0&&e<t}var vf=Math.min;function pf(e,t){for(var n=e.length,r=vf(t.length,n),i=zl(e);r--;){var o=t[r];e[r]=df(o,n)?i[o]:void 0;}return e}function mf(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&"__lodash_placeholder__"!==a||(e[n]="__lodash_placeholder__",o[i++]=n);}return o}function gf(e,t,n,r,i,o,a,s,c,u){var l=128&t,f=1&t,h=2&t,d=24&t,v=512&t,p=h?void 0:Sl(e);return function m(){for(var g=arguments.length,y=Array(g),b=g;b--;)y[b]=arguments[b];if(d)var w=ff(m),x=El(y,w);if(r&&(y=_l(y,r,i,d)),o&&(y=Ml(y,o,a,d)),g-=x,d&&g<u){var k=mf(y,w);return lf(e,t,gf,m.placeholder,n,y,k,s,c,u-g)}var j=f?n:this,S=h?j[e]:e;return g=y.length,s?y=pf(y,s):v&&g>1&&y.reverse(),l&&c<g&&(y.length=c),this&&this!==Su&&this instanceof m&&(S=p||Sl(S)),S.apply(j,y)}}var yf=Math.min;var bf=Math.max;function wf(e,t,n,r,i,o,a,s){var c=2&t;if(!c&&"function"!=typeof e)throw new TypeError("Expected a function");var u=r?r.length:0;if(u||(t&=-97,r=i=void 0),a=void 0===a?a:bf(el(a),0),s=void 0===s?s:el(s),u-=i?i.length:0,64&t){var l=r,f=i;r=i=void 0;}var h=c?void 0:Nl(e),d=[e,t,n,r,i,l,f,o,a,s];if(h&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,a=128==r&&8==n||128==r&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!a)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var s=t[3];if(s){var c=e[3];e[3]=c?_l(c,s,t[4]):s,e[4]=c?mf(e[3],"__lodash_placeholder__"):t[4];}(s=t[5])&&(c=e[5],e[5]=c?Ml(c,s,t[6]):s,e[6]=c?mf(e[5],"__lodash_placeholder__"):t[6]),(s=t[7])&&(e[7]=s),128&r&&(e[8]=null==e[8]?t[8]:yf(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i;}(d,h),e=d[0],t=d[1],n=d[2],r=d[3],i=d[4],!(s=d[9]=void 0===d[9]?c?0:e.length:bf(d[9]-u,0))&&24&t&&(t&=-25),t&&1!=t)v=8==t||16==t?function(e,t,n){var r=Sl(e);return function i(){for(var o=arguments.length,a=Array(o),s=o,c=ff(i);s--;)a[s]=arguments[s];var u=o<3&&a[0]!==c&&a[o-1]!==c?[]:mf(a,c);return (o-=u.length)<n?lf(e,t,gf,i.placeholder,void 0,a,u,void 0,void 0,n-o):Cl(this&&this!==Su&&this instanceof i?r:e,this,a)}}(e,t,s):32!=t&&33!=t||i.length?gf.apply(void 0,d):function(e,t,n,r){var i=1&t,o=Sl(e);return function t(){for(var a=-1,s=arguments.length,c=-1,u=r.length,l=Array(u+s),f=this&&this!==Su&&this instanceof t?o:e;++c<u;)l[c]=r[c];for(;s--;)l[c++]=arguments[++a];return Cl(f,i?n:this,l)}}(e,t,n,r);else var v=function(e,t,n){var r=1&t,i=Sl(e);return function t(){return (this&&this!==Su&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return uf((h?wl:Jl)(v,d),e,t)}function xf(e,t,n){return t=n?void 0:t,wf(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)}function kf(e,t,n){"__proto__"==t&&Zl?Zl(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n;}function jf(e,t){return e===t||e!=e&&t!=t}var Sf=Object.prototype.hasOwnProperty;function Cf(e,t,n){var r=e[t];Sf.call(e,t)&&jf(r,n)&&(void 0!==n||t in e)||kf(e,t,n);}function $f(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),i?kf(n,s,c):Cf(n,s,c);}return n}var _f=Math.max;function Of(e,t,n){return t=_f(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=_f(r.length-t,0),a=Array(o);++i<o;)a[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(a),Cl(e,this,s)}}function Mf(e,t){return tf(Of(e,t,nl),e+"")}function Ef(e){return "number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Af(e){return null!=e&&Ef(e.length)&&!rl(e)}function Pf(e,t,n){if(!Ju(n))return !1;var r=Ji(t);return !!("number"==r?Af(n)&&df(t,n.length):"string"==r&&t in n)&&jf(n[t],e)}function Tf(e){return Mf((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&Pf(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,o);}return t}))}var Rf=Object.prototype;function Nf(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Rf)}function If(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Df(e){return Tu(e)&&"[object Arguments]"==Pu(e)}var Lf=Object.prototype,Bf=Lf.hasOwnProperty,zf=Lf.propertyIsEnumerable,qf=Df(function(){return arguments}())?Df:function(e){return Tu(e)&&Bf.call(e,"callee")&&!zf.call(e,"callee")};function Ff(){return !1}var Vf="object"==("undefined"==typeof exports?"undefined":Ji(exports))&&exports&&!exports.nodeType&&exports,Wf=Vf&&"object"==("undefined"==typeof module?"undefined":Ji(module))&&module&&!module.nodeType&&module,Hf=Wf&&Wf.exports===Vf?Su.Buffer:void 0,Uf=(Hf?Hf.isBuffer:void 0)||Ff,Jf={};function Kf(e){return function(t){return e(t)}}Jf["[object Float32Array]"]=Jf["[object Float64Array]"]=Jf["[object Int8Array]"]=Jf["[object Int16Array]"]=Jf["[object Int32Array]"]=Jf["[object Uint8Array]"]=Jf["[object Uint8ClampedArray]"]=Jf["[object Uint16Array]"]=Jf["[object Uint32Array]"]=!0,Jf["[object Arguments]"]=Jf["[object Array]"]=Jf["[object ArrayBuffer]"]=Jf["[object Boolean]"]=Jf["[object DataView]"]=Jf["[object Date]"]=Jf["[object Error]"]=Jf["[object Function]"]=Jf["[object Map]"]=Jf["[object Number]"]=Jf["[object Object]"]=Jf["[object RegExp]"]=Jf["[object Set]"]=Jf["[object String]"]=Jf["[object WeakMap]"]=!1;var Gf="object"==("undefined"==typeof exports?"undefined":Ji(exports))&&exports&&!exports.nodeType&&exports,Qf=Gf&&"object"==("undefined"==typeof module?"undefined":Ji(module))&&module&&!module.nodeType&&module,Yf=Qf&&Qf.exports===Gf&&ku.process,Xf=function(){try{var e=Qf&&Qf.require&&Qf.require("util").types;return e||Yf&&Yf.binding&&Yf.binding("util")}catch(e){}}(),Zf=Xf,eh=Zf&&Zf.isTypedArray,th=eh?Kf(eh):function(e){return Tu(e)&&Ef(e.length)&&!!Jf[Pu(e)]},nh=Object.prototype.hasOwnProperty;function rh(e,t){var n=Du(e),r=!n&&qf(e),i=!n&&!r&&Uf(e),o=!n&&!r&&!i&&th(e),a=n||r||i||o,s=a?If(e.length,String):[],c=s.length;for(var u in e)!t&&!nh.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||df(u,c))||s.push(u);return s}function ih(e,t){return function(n){return e(t(n))}}var oh=ih(Object.keys,Object),ah=Object.prototype.hasOwnProperty;function sh(e){if(!Nf(e))return oh(e);var t=[];for(var n in Object(e))ah.call(e,n)&&"constructor"!=n&&t.push(n);return t}function ch(e){return Af(e)?rh(e):sh(e)}var uh=Object.prototype.hasOwnProperty,lh=Tf((function(e,t){if(Nf(t)||Af(t))$f(t,ch(t),e);else for(var n in t)uh.call(t,n)&&Cf(e,n,t[n]);})),fh=lh;var hh=Object.prototype.hasOwnProperty;function dh(e){if(!Ju(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Nf(e),n=[];for(var r in e)("constructor"!=r||!t&&hh.call(e,r))&&n.push(r);return n}function vh(e){return Af(e)?rh(e,!0):dh(e)}var ph=Tf((function(e,t){$f(t,vh(t),e);})),mh=ph,gh=Tf((function(e,t,n,r){$f(t,vh(t),e,r);})),yh=gh,bh=Tf((function(e,t,n,r){$f(t,ch(t),e,r);})),wh=bh,xh=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,kh=/^\w*$/;function jh(e,t){if(Du(e))return !1;var n=Ji(e);return !("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Ru(e))||(kh.test(e)||!xh.test(e)||null!=t&&e in Object(t))}var Sh=ml(Object,"create");var Ch=Object.prototype.hasOwnProperty;var $h=Object.prototype.hasOwnProperty;function _h(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1]);}}function Oh(e,t){for(var n=e.length;n--;)if(jf(e[n][0],t))return n;return -1}_h.prototype.clear=function(){this.__data__=Sh?Sh(null):{},this.size=0;},_h.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},_h.prototype.get=function(e){var t=this.__data__;if(Sh){var n=t[e];return "__lodash_hash_undefined__"===n?void 0:n}return Ch.call(t,e)?t[e]:void 0},_h.prototype.has=function(e){var t=this.__data__;return Sh?void 0!==t[e]:$h.call(t,e)},_h.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Sh&&void 0===t?"__lodash_hash_undefined__":t,this};var Mh=Array.prototype.splice;function Eh(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1]);}}Eh.prototype.clear=function(){this.__data__=[],this.size=0;},Eh.prototype.delete=function(e){var t=this.__data__,n=Oh(t,e);return !(n<0)&&(n==t.length-1?t.pop():Mh.call(t,n,1),--this.size,!0)},Eh.prototype.get=function(e){var t=this.__data__,n=Oh(t,e);return n<0?void 0:t[n][1]},Eh.prototype.has=function(e){return Oh(this.__data__,e)>-1},Eh.prototype.set=function(e,t){var n=this.__data__,r=Oh(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var Ah=ml(Su,"Map");function Ph(e,t){var n=e.__data__;return function(e){var t=Ji(e);return "string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function Th(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1]);}}Th.prototype.clear=function(){this.size=0,this.__data__={hash:new _h,map:new(Ah||Eh),string:new _h};},Th.prototype.delete=function(e){var t=Ph(this,e).delete(e);return this.size-=t?1:0,t},Th.prototype.get=function(e){return Ph(this,e).get(e)},Th.prototype.has=function(e){return Ph(this,e).has(e)},Th.prototype.set=function(e,t){var n=Ph(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function Rh(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Rh.Cache||Th),n}Rh.Cache=Th;var Nh=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ih=/\\(\\)?/g,Dh=function(e){var t=Rh(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Nh,(function(e,n,r,i){t.push(r?i.replace(Ih,"$1"):n||e);})),t})),Lh=Dh;function Bh(e){return null==e?"":zu(e)}function zh(e,t){return Du(e)?e:jh(e,t)?[e]:Lh(Bh(e))}function qh(e){if("string"==typeof e||Ru(e))return e;var t=e+"";return "0"==t&&1/e==-Infinity?"-0":t}function Fh(e,t){for(var n=0,r=(t=zh(t,e)).length;null!=e&&n<r;)e=e[qh(t[n++])];return n&&n==r?e:void 0}function Vh(e,t,n){var r=null==e?void 0:Fh(e,t);return void 0===r?n:r}function Wh(e,t){for(var n=-1,r=t.length,i=Array(r),o=null==e;++n<r;)i[n]=o?void 0:Vh(e,t[n]);return i}function Hh(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var Uh=Cu?Cu.isConcatSpreadable:void 0;function Jh(e){return Du(e)||qf(e)||!!(Uh&&e&&e[Uh])}function Kh(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=Jh),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?Kh(s,t-1,n,r,i):Hh(i,s):r||(i[i.length]=s);}return i}function Gh(e){return (null==e?0:e.length)?Kh(e,1):[]}function Qh(e){return tf(Of(e,void 0,Gh),e+"")}var Yh=Qh(Wh),Xh=ih(Object.getPrototypeOf,Object),Zh=Function.prototype,ed=Object.prototype,td=Zh.toString,nd=ed.hasOwnProperty,rd=td.call(Object);function id(e){if(!Tu(e)||"[object Object]"!=Pu(e))return !1;var t=Xh(e);if(null===t)return !0;var n=nd.call(t,"constructor")&&t.constructor;return "function"==typeof n&&n instanceof n&&td.call(n)==rd}function od(e){if(!Tu(e))return !1;var t=Pu(e);return "[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!id(e)}var ad=Mf((function(e,t){try{return Cl(e,void 0,t)}catch(e){return od(e)?e:new Error(e)}})),sd=ad;function cd(e,t){var n;if("function"!=typeof t)throw new TypeError("Expected a function");return e=el(e),function(){return --e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}var ud=Mf((function(e,t,n){var r=1;if(n.length){var i=mf(n,ff(ud));r|=32;}return wf(e,r,t,n,i)}));ud.placeholder={};var ld=ud,fd=Qh((function(e,t){return nf(t,(function(t){t=qh(t),kf(e,t,ld(e[t],e));})),e})),hd=fd,dd=Mf((function(e,t,n){var r=3;if(n.length){var i=mf(n,ff(dd));r|=32;}return wf(t,r,e,n,i)}));dd.placeholder={};var vd=dd;function pd(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}function md(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:pd(e,t,n)}var gd=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function yd(e){return gd.test(e)}var bd="[\\ud800-\\udfff]",wd="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",xd="\\ud83c[\\udffb-\\udfff]",kd="[^\\ud800-\\udfff]",jd="(?:\\ud83c[\\udde6-\\uddff]){2}",Sd="[\\ud800-\\udbff][\\udc00-\\udfff]",Cd="(?:"+wd+"|"+xd+")"+"?",$d="[\\ufe0e\\ufe0f]?"+Cd+("(?:\\u200d(?:"+[kd,jd,Sd].join("|")+")[\\ufe0e\\ufe0f]?"+Cd+")*"),_d="(?:"+[kd+wd+"?",wd,jd,Sd,bd].join("|")+")",Od=RegExp(xd+"(?="+xd+")|"+_d+$d,"g");function Md(e){return yd(e)?function(e){return e.match(Od)||[]}(e):function(e){return e.split("")}(e)}function Ed(e){return function(t){var n=yd(t=Bh(t))?Md(t):void 0,r=n?n[0]:t.charAt(0),i=n?md(n,1).join(""):t.slice(1);return r[e]()+i}}var Ad=Ed("toUpperCase");function Pd(e){return Ad(Bh(e).toLowerCase())}function Td(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function Rd(e){return function(t){return null==e?void 0:e[t]}}var Nd=Rd({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),Id=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Dd=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");function Ld(e){return (e=Bh(e))&&e.replace(Id,Nd).replace(Dd,"")}var Bd=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var zd=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var qd="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Fd="["+qd+"]",Vd="\\d+",Wd="[\\u2700-\\u27bf]",Hd="[a-z\\xdf-\\xf6\\xf8-\\xff]",Ud="[^\\ud800-\\udfff"+qd+Vd+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Jd="(?:\\ud83c[\\udde6-\\uddff]){2}",Kd="[\\ud800-\\udbff][\\udc00-\\udfff]",Gd="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Qd="(?:"+Hd+"|"+Ud+")",Yd="(?:"+Gd+"|"+Ud+")",Xd="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",Zd="[\\ufe0e\\ufe0f]?"+Xd+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",Jd,Kd].join("|")+")[\\ufe0e\\ufe0f]?"+Xd+")*"),ev="(?:"+[Wd,Jd,Kd].join("|")+")"+Zd,tv=RegExp([Gd+"?"+Hd+"+(?:['](?:d|ll|m|re|s|t|ve))?(?="+[Fd,Gd,"$"].join("|")+")",Yd+"+(?:['](?:D|LL|M|RE|S|T|VE))?(?="+[Fd,Gd+Qd,"$"].join("|")+")",Gd+"?"+Qd+"+(?:['](?:d|ll|m|re|s|t|ve))?",Gd+"+(?:['](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Vd,ev].join("|"),"g");function nv(e,t,n){return e=Bh(e),void 0===(t=n?void 0:t)?function(e){return zd.test(e)}(e)?function(e){return e.match(tv)||[]}(e):function(e){return e.match(Bd)||[]}(e):e.match(t)||[]}var rv=RegExp("[']","g");function iv(e){return function(t){return Td(nv(Ld(t).replace(rv,"")),e,"")}}var ov=iv((function(e,t,n){return t=t.toLowerCase(),e+(n?Pd(t):t)})),av=ov;function sv(){if(!arguments.length)return [];var e=arguments[0];return Du(e)?e:[e]}var cv=Su.isFinite,uv=Math.min;function lv(e){var t=Math[e];return function(e,n){if(e=Xu(e),(n=null==n?0:uv(el(n),292))&&cv(e)){var r=(Bh(e)+"e").split("e");return +((r=(Bh(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var fv=lv("ceil");function hv(e){var t=Vl(e);return t.__chain__=!0,t}var dv=Math.ceil,vv=Math.max;function pv(e,t,n){t=(n?Pf(e,t,n):void 0===t)?1:vv(el(t),0);var r=null==e?0:e.length;if(!r||t<1)return [];for(var i=0,o=0,a=Array(dv(r/t));i<r;)a[o++]=pd(e,i,i+=t);return a}function mv(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}function gv(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=Xu(n))==n?n:0),void 0!==t&&(t=(t=Xu(t))==t?t:0),mv(Xu(e),t,n)}function yv(e){var t=this.__data__=new Eh(e);this.size=t.size;}function bv(e,t){return e&&$f(t,ch(t),e)}yv.prototype.clear=function(){this.__data__=new Eh,this.size=0;},yv.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},yv.prototype.get=function(e){return this.__data__.get(e)},yv.prototype.has=function(e){return this.__data__.has(e)},yv.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Eh){var r=n.__data__;if(!Ah||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Th(r);}return n.set(e,t),this.size=n.size,this};var wv="object"==("undefined"==typeof exports?"undefined":Ji(exports))&&exports&&!exports.nodeType&&exports,xv=wv&&"object"==("undefined"==typeof module?"undefined":Ji(module))&&module&&!module.nodeType&&module,kv=xv&&xv.exports===wv?Su.Buffer:void 0,jv=kv?kv.allocUnsafe:void 0;function Sv(e,t){if(t)return e.slice();var n=e.length,r=jv?jv(n):new e.constructor(n);return e.copy(r),r}function Cv(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a);}return o}function $v(){return []}var _v=Object.prototype.propertyIsEnumerable,Ov=Object.getOwnPropertySymbols,Mv=Ov?function(e){return null==e?[]:(e=Object(e),Cv(Ov(e),(function(t){return _v.call(e,t)})))}:$v,Ev=Mv;var Av=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Hh(t,Ev(e)),e=Xh(e);return t}:$v,Pv=Av;function Tv(e,t,n){var r=t(e);return Du(e)?r:Hh(r,n(e))}function Rv(e){return Tv(e,ch,Ev)}function Nv(e){return Tv(e,vh,Pv)}var Iv=ml(Su,"DataView"),Dv=ml(Su,"Promise"),Lv=ml(Su,"Set"),Bv=cl(Iv),zv=cl(Ah),qv=cl(Dv),Fv=cl(Lv),Vv=cl(gl),Wv=Pu;(Iv&&"[object DataView]"!=Wv(new Iv(new ArrayBuffer(1)))||Ah&&"[object Map]"!=Wv(new Ah)||Dv&&"[object Promise]"!=Wv(Dv.resolve())||Lv&&"[object Set]"!=Wv(new Lv)||gl&&"[object WeakMap]"!=Wv(new gl))&&(Wv=function(e){var t=Pu(e),n="[object Object]"==t?e.constructor:void 0,r=n?cl(n):"";if(r)switch(r){case Bv:return "[object DataView]";case zv:return "[object Map]";case qv:return "[object Promise]";case Fv:return "[object Set]";case Vv:return "[object WeakMap]"}return t});var Hv=Wv,Uv=Object.prototype.hasOwnProperty;var Jv=Su.Uint8Array;function Kv(e){var t=new e.constructor(e.byteLength);return new Jv(t).set(new Jv(e)),t}var Gv=/\w*$/;var Qv=Cu?Cu.prototype:void 0,Yv=Qv?Qv.valueOf:void 0;function Xv(e,t){var n=t?Kv(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Zv(e,t,n){var r,i=e.constructor;switch(t){case"[object ArrayBuffer]":return Kv(e);case"[object Boolean]":case"[object Date]":return new i(+e);case"[object DataView]":return function(e,t){var n=t?Kv(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Xv(e,n);case"[object Map]":case"[object Set]":return new i;case"[object Number]":case"[object String]":return new i(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,Gv.exec(e));return t.lastIndex=e.lastIndex,t}(e);case"[object Symbol]":return r=e,Yv?Object(Yv.call(r)):{}}}function ep(e){return "function"!=typeof e.constructor||Nf(e)?{}:jl(Xh(e))}var tp=Zf&&Zf.isMap,np=tp?Kf(tp):function(e){return Tu(e)&&"[object Map]"==Hv(e)};var rp=Zf&&Zf.isSet,ip=rp?Kf(rp):function(e){return Tu(e)&&"[object Set]"==Hv(e)},op={};function ap(e,t,n,r,i,o){var a,s=1&t,c=2&t,u=4&t;if(n&&(a=i?n(e,r,i,o):n(e)),void 0!==a)return a;if(!Ju(e))return e;var l=Du(e);if(l){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Uv.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!s)return zl(e,a)}else {var f=Hv(e),h="[object Function]"==f||"[object GeneratorFunction]"==f;if(Uf(e))return Sv(e,s);if("[object Object]"==f||"[object Arguments]"==f||h&&!i){if(a=c||h?{}:ep(e),!s)return c?function(e,t){return $f(e,Pv(e),t)}(e,function(e,t){return e&&$f(t,vh(t),e)}(a,e)):function(e,t){return $f(e,Ev(e),t)}(e,bv(a,e))}else {if(!op[f])return i?e:{};a=Zv(e,f,s);}}o||(o=new yv);var d=o.get(e);if(d)return d;o.set(e,a),ip(e)?e.forEach((function(r){a.add(ap(r,t,n,r,e,o));})):np(e)&&e.forEach((function(r,i){a.set(i,ap(r,t,n,i,e,o));}));var v=l?void 0:(u?c?Nv:Rv:c?vh:ch)(e);return nf(v||e,(function(r,i){v&&(r=e[i=r]),Cf(a,i,ap(r,t,n,i,e,o));})),a}op["[object Arguments]"]=op["[object Array]"]=op["[object ArrayBuffer]"]=op["[object DataView]"]=op["[object Boolean]"]=op["[object Date]"]=op["[object Float32Array]"]=op["[object Float64Array]"]=op["[object Int8Array]"]=op["[object Int16Array]"]=op["[object Int32Array]"]=op["[object Map]"]=op["[object Number]"]=op["[object Object]"]=op["[object RegExp]"]=op["[object Set]"]=op["[object String]"]=op["[object Symbol]"]=op["[object Uint8Array]"]=op["[object Uint8ClampedArray]"]=op["[object Uint16Array]"]=op["[object Uint32Array]"]=!0,op["[object Error]"]=op["[object Function]"]=op["[object WeakMap]"]=!1;function sp(e){return ap(e,4)}function cp(e){return ap(e,5)}function up(e,t){return ap(e,5,t="function"==typeof t?t:void 0)}function lp(e,t){return ap(e,4,t="function"==typeof t?t:void 0)}function fp(){return new Bl(this.value(),this.__chain__)}function hp(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o);}return i}function dp(){var e=arguments.length;if(!e)return [];for(var t=Array(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return Hh(Du(n)?zl(n):[n],Kh(t,1))}function vp(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Th;++t<n;)this.add(e[t]);}function pp(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return !0;return !1}function mp(e,t){return e.has(t)}vp.prototype.add=vp.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},vp.prototype.has=function(e){return this.__data__.has(e)};function gp(e,t,n,r,i,o){var a=1&n,s=e.length,c=t.length;if(s!=c&&!(a&&c>s))return !1;var u=o.get(e),l=o.get(t);if(u&&l)return u==t&&l==e;var f=-1,h=!0,d=2&n?new vp:void 0;for(o.set(e,t),o.set(t,e);++f<s;){var v=e[f],p=t[f];if(r)var m=a?r(p,v,f,t,e,o):r(v,p,f,e,t,o);if(void 0!==m){if(m)continue;h=!1;break}if(d){if(!pp(t,(function(e,t){if(!mp(d,t)&&(v===e||i(v,e,n,r,o)))return d.push(t)}))){h=!1;break}}else if(v!==p&&!i(v,p,n,r,o)){h=!1;break}}return o.delete(e),o.delete(t),h}function yp(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e];})),n}function bp(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e;})),n}var wp=Cu?Cu.prototype:void 0,xp=wp?wp.valueOf:void 0;var kp=Object.prototype.hasOwnProperty;var jp="[object Object]",Sp=Object.prototype.hasOwnProperty;function Cp(e,t,n,r,i,o){var a=Du(e),s=Du(t),c=a?"[object Array]":Hv(e),u=s?"[object Array]":Hv(t),l=(c="[object Arguments]"==c?jp:c)==jp,f=(u="[object Arguments]"==u?jp:u)==jp,h=c==u;if(h&&Uf(e)){if(!Uf(t))return !1;a=!0,l=!1;}if(h&&!l)return o||(o=new yv),a||th(e)?gp(e,t,n,r,i,o):function(e,t,n,r,i,o,a){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return !1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return !(e.byteLength!=t.byteLength||!o(new Jv(e),new Jv(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return jf(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=yp;case"[object Set]":var c=1&r;if(s||(s=bp),e.size!=t.size&&!c)return !1;var u=a.get(e);if(u)return u==t;r|=2,a.set(e,t);var l=gp(s(e),s(t),r,i,o,a);return a.delete(e),l;case"[object Symbol]":if(xp)return xp.call(e)==xp.call(t)}return !1}(e,t,c,n,r,i,o);if(!(1&n)){var d=l&&Sp.call(e,"__wrapped__"),v=f&&Sp.call(t,"__wrapped__");if(d||v){var p=d?e.value():e,m=v?t.value():t;return o||(o=new yv),i(p,m,n,r,o)}}return !!h&&(o||(o=new yv),function(e,t,n,r,i,o){var a=1&n,s=Rv(e),c=s.length;if(c!=Rv(t).length&&!a)return !1;for(var u=c;u--;){var l=s[u];if(!(a?l in t:kp.call(t,l)))return !1}var f=o.get(e),h=o.get(t);if(f&&h)return f==t&&h==e;var d=!0;o.set(e,t),o.set(t,e);for(var v=a;++u<c;){var p=e[l=s[u]],m=t[l];if(r)var g=a?r(m,p,l,t,e,o):r(p,m,l,e,t,o);if(!(void 0===g?p===m||i(p,m,n,r,o):g)){d=!1;break}v||(v="constructor"==l);}if(d&&!v){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(d=!1);}return o.delete(e),o.delete(t),d}(e,t,n,r,i,o))}function $p(e,t,n,r,i){return e===t||(null==e||null==t||!Tu(e)&&!Tu(t)?e!=e&&t!=t:Cp(e,t,n,r,$p,i))}function _p(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return !o;for(e=Object(e);i--;){var s=n[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return !1}for(;++i<o;){var c=(s=n[i])[0],u=e[c],l=s[1];if(a&&s[2]){if(void 0===u&&!(c in e))return !1}else {var f=new yv;if(r)var h=r(u,l,c,e,t,f);if(!(void 0===h?$p(l,u,3,r,f):h))return !1}}return !0}function Op(e){return e==e&&!Ju(e)}function Mp(e){for(var t=ch(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Op(i)];}return t}function Ep(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}function Ap(e){var t=Mp(e);return 1==t.length&&t[0][2]?Ep(t[0][0],t[0][1]):function(n){return n===e||_p(n,e,t)}}function Pp(e,t){return null!=e&&t in Object(e)}function Tp(e,t,n){for(var r=-1,i=(t=zh(t,e)).length,o=!1;++r<i;){var a=qh(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a];}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Ef(i)&&df(a,i)&&(Du(e)||qf(e))}function Rp(e,t){return null!=e&&Tp(e,t,Pp)}function Np(e,t){return jh(e)&&Op(t)?Ep(qh(e),t):function(n){var r=Vh(n,e);return void 0===r&&r===t?Rp(n,e):$p(t,r,3)}}function Ip(e){return function(t){return null==t?void 0:t[e]}}function Dp(e){return jh(e)?Ip(qh(e)):function(e){return function(t){return Fh(t,e)}}(e)}function Lp(e){return "function"==typeof e?e:null==e?nl:"object"==Ji(e)?Du(e)?Np(e[0],e[1]):Ap(e):Dp(e)}function Bp(e){var t=null==e?0:e.length,n=Lp;return e=t?Iu(e,(function(e){if("function"!=typeof e[1])throw new TypeError("Expected a function");return [n(e[0]),e[1]]})):[],Mf((function(n){for(var r=-1;++r<t;){var i=e[r];if(Cl(i[0],this,n))return Cl(i[1],this,n)}}))}function zp(e,t,n){var r=n.length;if(null==e)return !r;for(e=Object(e);r--;){var i=n[r],o=t[i],a=e[i];if(void 0===a&&!(i in e)||!o(a))return !1}return !0}function qp(e){return function(e){var t=ch(e);return function(n){return zp(n,e,t)}}(ap(e,1))}function Fp(e,t){return null==t||zp(e,t,ch(t))}function Vp(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e);}return r}function Wp(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var c=a[e?s:++i];if(!1===n(o[c],c,o))break}return t}}var Hp=Wp();function Up(e,t){return e&&Hp(e,t,ch)}function Jp(e,t){return function(n,r){if(null==n)return n;if(!Af(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=Object(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}var Kp=Jp(Up);function Gp(e,t,n,r){return Kp(e,(function(e,i,o){t(r,e,n(e),o);})),r}function Qp(e,t){return function(n,r){var i=Du(n)?Vp:Gp,o=t?t():{};return i(n,e,Lp(r),o)}}var Yp=Object.prototype.hasOwnProperty,Xp=Qp((function(e,t,n){Yp.call(e,n)?++e[n]:kf(e,n,1);})),Zp=Xp;function em(e,t){var n=jl(e);return null==t?n:bv(n,t)}function tm(e,t,n){var r=wf(e,8,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return r.placeholder=tm.placeholder,r}tm.placeholder={};function nm(e,t,n){var r=wf(e,16,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return r.placeholder=nm.placeholder,r}nm.placeholder={};var rm=function(){return Su.Date.now()},im=Math.max,om=Math.min;function am(e,t,n){var r,i,o,a,s,c,u=0,l=!1,f=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function d(t){var n=r,o=i;return r=i=void 0,u=t,a=e.apply(o,n)}function v(e){return u=e,s=setTimeout(m,t),l?d(e):a}function p(e){var n=e-c;return void 0===c||n>=t||n<0||f&&e-u>=o}function m(){var e=rm();if(p(e))return g(e);s=setTimeout(m,function(e){var n=t-(e-c);return f?om(n,o-(e-u)):n}(e));}function g(e){return s=void 0,h&&r?d(e):(r=i=void 0,a)}function y(){var e=rm(),n=p(e);if(r=arguments,i=this,c=e,n){if(void 0===s)return v(c);if(f)return clearTimeout(s),s=setTimeout(m,t),d(c)}return void 0===s&&(s=setTimeout(m,t)),a}return t=Xu(t)||0,Ju(n)&&(l=!!n.leading,o=(f="maxWait"in n)?im(Xu(n.maxWait)||0,t):o,h="trailing"in n?!!n.trailing:h),y.cancel=function(){void 0!==s&&clearTimeout(s),u=0,r=c=i=s=void 0;},y.flush=function(){return void 0===s?a:g(rm())},y}function sm(e,t){return null==e||e!=e?t:e}var cm=Object.prototype,um=cm.hasOwnProperty,lm=Mf((function(e,t){e=Object(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&Pf(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],a=vh(o),s=-1,c=a.length;++s<c;){var u=a[s],l=e[u];(void 0===l||jf(l,cm[u])&&!um.call(e,u))&&(e[u]=o[u]);}return e})),fm=lm;function hm(e,t,n){(void 0!==n&&!jf(e[t],n)||void 0===n&&!(t in e))&&kf(e,t,n);}function dm(e){return Tu(e)&&Af(e)}function vm(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function pm(e){return $f(e,vh(e))}function mm(e,t,n,r,i){e!==t&&Hp(t,(function(o,a){if(i||(i=new yv),Ju(o))!function(e,t,n,r,i,o,a){var s=vm(e,n),c=vm(t,n),u=a.get(c);if(u)hm(e,n,u);else {var l=o?o(s,c,n+"",e,t,a):void 0,f=void 0===l;if(f){var h=Du(c),d=!h&&Uf(c),v=!h&&!d&&th(c);l=c,h||d||v?Du(s)?l=s:dm(s)?l=zl(s):d?(f=!1,l=Sv(c,!0)):v?(f=!1,l=Xv(c,!0)):l=[]:id(c)||qf(c)?(l=s,qf(s)?l=pm(s):Ju(s)&&!rl(s)||(l=ep(c))):f=!1;}f&&(a.set(c,l),i(l,c,r,o,a),a.delete(c)),hm(e,n,l);}}(e,t,a,n,mm,r,i);else {var s=r?r(vm(e,a),o,a+"",e,t,i):void 0;void 0===s&&(s=o),hm(e,a,s);}}),vh);}function gm(e,t,n,r,i,o){return Ju(e)&&Ju(t)&&(o.set(t,e),mm(e,t,void 0,gm,o),o.delete(t)),e}var ym=Tf((function(e,t,n,r){mm(e,t,n,r);})),bm=ym,wm=Mf((function(e){return e.push(void 0,gm),Cl(bm,void 0,e)}));function xm(e,t,n){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout((function(){e.apply(void 0,n);}),t)}var km=Mf((function(e,t){return xm(e,1,t)})),jm=km,Sm=Mf((function(e,t,n){return xm(e,Xu(t)||0,n)})),Cm=Sm;function $m(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return !0;return !1}function _m(e,t,n,r){var i=-1,o=sf,a=!0,s=e.length,c=[],u=t.length;if(!s)return c;n&&(t=Iu(t,Kf(n))),r?(o=$m,a=!1):t.length>=200&&(o=mp,a=!1,t=new vp(t));e:for(;++i<s;){var l=e[i],f=null==n?l:n(l);if(l=r||0!==l?l:0,a&&f==f){for(var h=u;h--;)if(t[h]===f)continue e;c.push(l);}else o(t,f,r)||c.push(l);}return c}var Om=Mf((function(e,t){return dm(e)?_m(e,Kh(t,1,dm,!0)):[]})),Mm=Om;function Em(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var Am=Mf((function(e,t){var n=Em(t);return dm(n)&&(n=void 0),dm(e)?_m(e,Kh(t,1,dm,!0),Lp(n)):[]})),Pm=Am,Tm=Mf((function(e,t){var n=Em(t);return dm(n)&&(n=void 0),dm(e)?_m(e,Kh(t,1,dm,!0),void 0,n):[]})),Rm=Tm,Nm=qu((function(e,t){return e/t}),1);function Im(e,t,n){var r=null==e?0:e.length;return r?pd(e,(t=n||void 0===t?1:el(t))<0?0:t,r):[]}function Dm(e,t,n){var r=null==e?0:e.length;return r?pd(e,0,(t=r-(t=n||void 0===t?1:el(t)))<0?0:t):[]}function Lm(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?pd(e,r?0:o,r?o+1:i):pd(e,r?o+1:0,r?i:o)}function Bm(e,t){return e&&e.length?Lm(e,Lp(t),!0,!0):[]}function zm(e,t){return e&&e.length?Lm(e,Lp(t),!0):[]}function qm(e){return "function"==typeof e?e:nl}function Fm(e,t){return (Du(e)?nf:Kp)(e,qm(t))}function Vm(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}var Wm=Wp(!0);function Hm(e,t){return e&&Wm(e,t,ch)}var Um=Jp(Hm,!0);function Jm(e,t){return (Du(e)?Vm:Um)(e,qm(t))}function Km(e,t,n){e=Bh(e),t=zu(t);var r=e.length,i=n=void 0===n?r:mv(el(n),0,r);return (n-=t.length)>=0&&e.slice(n,i)==t}function Gm(e){return function(t){var n=Hv(t);return "[object Map]"==n?yp(t):"[object Set]"==n?function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e];})),n}(t):function(e,t){return Iu(t,(function(t){return [t,e[t]]}))}(t,e(t))}}var Qm=Gm(ch),Ym=Gm(vh),Xm=Rd({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),Zm=/[&<>"']/g,eg=RegExp(Zm.source);function tg(e){return (e=Bh(e))&&eg.test(e)?e.replace(Zm,Xm):e}var ng=/[\\^$.*+?()[\]{}|]/g,rg=RegExp(ng.source);function ig(e){return (e=Bh(e))&&rg.test(e)?e.replace(ng,"\\$&"):e}function og(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return !1;return !0}function ag(e,t){var n=!0;return Kp(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function sg(e,t,n){var r=Du(e)?og:ag;return n&&Pf(e,t,n)&&(t=void 0),r(e,Lp(t))}function cg(e){return e?mv(el(e),0,4294967295):0}function ug(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&Pf(e,t,n)&&(n=0,r=i),function(e,t,n,r){var i=e.length;for((n=el(n))<0&&(n=-n>i?0:i+n),(r=void 0===r||r>i?i:el(r))<0&&(r+=i),r=n>r?0:cg(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]}function lg(e,t){var n=[];return Kp(e,(function(e,r,i){t(e,r,i)&&n.push(e);})),n}function fg(e,t){return (Du(e)?Cv:lg)(e,Lp(t))}function hg(e){return function(t,n,r){var i=Object(t);if(!Af(t)){var o=Lp(n);t=ch(t),n=function(e){return o(i[e],e,i)};}var a=e(t,n,r);return a>-1?i[o?t[a]:a]:void 0}}var dg=Math.max;function vg(e,t,n){var r=null==e?0:e.length;if(!r)return -1;var i=null==n?0:el(n);return i<0&&(i=dg(r+i,0)),rf(e,Lp(t),i)}var pg=hg(vg);function mg(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function gg(e,t){return mg(e,Lp(t),Up)}var yg=Math.max,bg=Math.min;function wg(e,t,n){var r=null==e?0:e.length;if(!r)return -1;var i=r-1;return void 0!==n&&(i=el(n),i=n<0?yg(r+i,0):bg(i,r-1)),rf(e,Lp(t),i,!0)}var xg=hg(wg);function kg(e,t){return mg(e,Lp(t),Hm)}function jg(e){return e&&e.length?e[0]:void 0}function Sg(e,t){var n=-1,r=Af(e)?Array(e.length):[];return Kp(e,(function(e,i,o){r[++n]=t(e,i,o);})),r}function Cg(e,t){return (Du(e)?Iu:Sg)(e,Lp(t))}function $g(e,t){return Kh(Cg(e,t),1)}function _g(e,t){return Kh(Cg(e,t),Infinity)}function Og(e,t,n){return n=void 0===n?1:el(n),Kh(Cg(e,t),n)}function Mg(e){return (null==e?0:e.length)?Kh(e,Infinity):[]}function Eg(e,t){return (null==e?0:e.length)?Kh(e,t=void 0===t?1:el(t)):[]}function Ag(e){return wf(e,512)}var Pg=lv("floor");function Tg(e){return Qh((function(t){var n=t.length,r=n,i=Bl.prototype.thru;for(e&&t.reverse();r--;){var o=t[r];if("function"!=typeof o)throw new TypeError("Expected a function");if(i&&!a&&"wrapper"==Ll(o))var a=new Bl([],!0);}for(r=a?r:n;++r<n;){var s=Ll(o=t[r]),c="wrapper"==s?Nl(o):void 0;a=c&&Wl(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?a[Ll(c[0])].apply(a,c[3]):1==o.length&&Wl(o)?a[s]():a.thru(o);}return function(){var e=arguments,r=e[0];if(a&&1==e.length&&Du(r))return a.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}var Rg=Tg(),Ng=Tg(!0);function Ig(e,t){return null==e?e:Hp(e,qm(t),vh)}function Dg(e,t){return null==e?e:Wm(e,qm(t),vh)}function Lg(e,t){return e&&Up(e,qm(t))}function Bg(e,t){return e&&Hm(e,qm(t))}function zg(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1];}return r}function qg(e,t){return Cv(t,(function(t){return rl(e[t])}))}function Fg(e){return null==e?[]:qg(e,ch(e))}function Vg(e){return null==e?[]:qg(e,vh(e))}var Wg=Object.prototype.hasOwnProperty,Hg=Qp((function(e,t,n){Wg.call(e,n)?e[n].push(t):kf(e,n,[t]);})),Ug=Hg;function Jg(e,t){return e>t}function Kg(e){return function(t,n){return "string"==typeof t&&"string"==typeof n||(t=Xu(t),n=Xu(n)),e(t,n)}}var Gg=Kg(Jg),Qg=Kg((function(e,t){return e>=t})),Yg=Object.prototype.hasOwnProperty;function Xg(e,t){return null!=e&&Yg.call(e,t)}function Zg(e,t){return null!=e&&Tp(e,t,Xg)}var ey=Math.max,ty=Math.min;function ny(e,t,n){return t=Zu(t),void 0===n?(n=t,t=0):n=Zu(n),function(e,t,n){return e>=ty(t,n)&&e<ey(t,n)}(e=Xu(e),t,n)}function ry(e){return "string"==typeof e||!Du(e)&&Tu(e)&&"[object String]"==Pu(e)}function iy(e,t){return Iu(t,(function(t){return e[t]}))}function oy(e){return null==e?[]:iy(e,ch(e))}var ay=Math.max;function sy(e,t,n,r){e=Af(e)?e:oy(e),n=n&&!r?el(n):0;var i=e.length;return n<0&&(n=ay(i+n,0)),ry(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&af(e,t,n)>-1}var cy=Math.max;function uy(e,t,n){var r=null==e?0:e.length;if(!r)return -1;var i=null==n?0:el(n);return i<0&&(i=cy(r+i,0)),af(e,t,i)}function ly(e){return (null==e?0:e.length)?pd(e,0,-1):[]}var fy=Math.min;function hy(e,t,n){for(var r=n?$m:sf,i=e[0].length,o=e.length,a=o,s=Array(o),c=1/0,u=[];a--;){var l=e[a];a&&t&&(l=Iu(l,Kf(t))),c=fy(l.length,c),s[a]=!n&&(t||i>=120&&l.length>=120)?new vp(a&&l):void 0;}l=e[0];var f=-1,h=s[0];e:for(;++f<i&&u.length<c;){var d=l[f],v=t?t(d):d;if(d=n||0!==d?d:0,!(h?mp(h,v):r(u,v,n))){for(a=o;--a;){var p=s[a];if(!(p?mp(p,v):r(e[a],v,n)))continue e}h&&h.push(v),u.push(d);}}return u}function dy(e){return dm(e)?e:[]}var vy=Mf((function(e){var t=Iu(e,dy);return t.length&&t[0]===e[0]?hy(t):[]})),py=Mf((function(e){var t=Em(e),n=Iu(e,dy);return t===Em(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?hy(n,Lp(t)):[]})),my=py,gy=Mf((function(e){var t=Em(e),n=Iu(e,dy);return (t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?hy(n,void 0,t):[]}));function yy(e,t){return function(n,r){return function(e,t,n,r){return Up(e,(function(e,i,o){t(r,n(e),i,o);})),r}(n,e,t(r),{})}}var by=Object.prototype.toString,wy=yy((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=by.call(t)),e[t]=n;}),Yl(nl)),xy=wy,ky=Object.prototype,jy=ky.hasOwnProperty,Sy=ky.toString,Cy=yy((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Sy.call(t)),jy.call(e,t)?e[t].push(n):e[t]=[n];}),Lp),$y=Cy;function _y(e,t){return t.length<2?e:Fh(e,pd(t,0,-1))}function Oy(e,t,n){var r=null==(e=_y(e,t=zh(t,e)))?e:e[qh(Em(t))];return null==r?void 0:Cl(r,e,n)}var My=Mf(Oy),Ey=Mf((function(e,t,n){var r=-1,i="function"==typeof t,o=Af(e)?Array(e.length):[];return Kp(e,(function(e){o[++r]=i?Cl(t,e,n):Oy(e,t,n);})),o})),Ay=Ey;var Py=Zf&&Zf.isArrayBuffer,Ty=Py?Kf(Py):function(e){return Tu(e)&&"[object ArrayBuffer]"==Pu(e)};function Ry(e){return !0===e||!1===e||Tu(e)&&"[object Boolean]"==Pu(e)}var Ny=Zf&&Zf.isDate,Iy=Ny?Kf(Ny):function(e){return Tu(e)&&"[object Date]"==Pu(e)};function Dy(e){return Tu(e)&&1===e.nodeType&&!id(e)}var Ly=Object.prototype.hasOwnProperty;function By(e){if(null==e)return !0;if(Af(e)&&(Du(e)||"string"==typeof e||"function"==typeof e.splice||Uf(e)||th(e)||qf(e)))return !e.length;var t=Hv(e);if("[object Map]"==t||"[object Set]"==t)return !e.size;if(Nf(e))return !sh(e).length;for(var n in e)if(Ly.call(e,n))return !1;return !0}function zy(e,t){return $p(e,t)}function qy(e,t,n){var r=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===r?$p(e,t,void 0,n):!!r}var Fy=Su.isFinite;function Vy(e){return "number"==typeof e&&Fy(e)}function Wy(e){return "number"==typeof e&&e==el(e)}function Hy(e,t){return e===t||_p(e,t,Mp(t))}function Uy(e,t,n){return n="function"==typeof n?n:void 0,_p(e,t,Mp(t),n)}function Jy(e){return "number"==typeof e||Tu(e)&&"[object Number]"==Pu(e)}function Ky(e){return Jy(e)&&e!=+e}var Gy=ol?rl:Ff;function Qy(e){if(Gy(e))throw new Error("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return pl(e)}function Yy(e){return null==e}function Xy(e){return null===e}var Zy=Zf&&Zf.isRegExp,eb=Zy?Kf(Zy):function(e){return Tu(e)&&"[object RegExp]"==Pu(e)};function tb(e){return Wy(e)&&e>=-9007199254740991&&e<=9007199254740991}function nb(e){return void 0===e}function rb(e){return Tu(e)&&"[object WeakMap]"==Hv(e)}function ib(e){return Tu(e)&&"[object WeakSet]"==Pu(e)}function ob(e){return Lp("function"==typeof e?e:ap(e,1))}var ab=Array.prototype.join;function sb(e,t){return null==e?"":ab.call(e,t)}var cb=iv((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),ub=cb,lb=Qp((function(e,t,n){kf(e,n,t);})),fb=lb;var hb=Math.max,db=Math.min;function vb(e,t,n){var r=null==e?0:e.length;if(!r)return -1;var i=r;return void 0!==n&&(i=(i=el(n))<0?hb(r+i,0):db(i,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,i):rf(e,of,i,!0)}var pb=iv((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),mb=pb,gb=Ed("toLowerCase");function yb(e,t){return e<t}var bb=Kg(yb),wb=Kg((function(e,t){return e<=t}));function xb(e,t){var n={};return t=Lp(t),Up(e,(function(e,r,i){kf(n,t(e,r,i),e);})),n}function kb(e,t){var n={};return t=Lp(t),Up(e,(function(e,r,i){kf(n,r,t(e,r,i));})),n}function jb(e){return Ap(ap(e,1))}function Sb(e,t){return Np(e,ap(t,1))}function Cb(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],a=t(o);if(null!=a&&(void 0===s?a==a&&!Ru(a):n(a,s)))var s=a,c=o;}return c}function $b(e){return e&&e.length?Cb(e,nl,Jg):void 0}function _b(e,t){return e&&e.length?Cb(e,Lp(t),Jg):void 0}function Ob(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);void 0!==o&&(n=void 0===n?o:n+o);}return n}function Mb(e,t){var n=null==e?0:e.length;return n?Ob(e,t)/n:NaN}function Eb(e){return Mb(e,nl)}function Ab(e,t){return Mb(e,Lp(t))}var Pb=Tf((function(e,t,n){mm(e,t,n);})),Tb=Pb,Rb=Mf((function(e,t){return function(n){return Oy(n,e,t)}})),Nb=Rb,Ib=Mf((function(e,t){return function(n){return Oy(e,n,t)}})),Db=Ib;function Lb(e){return e&&e.length?Cb(e,nl,yb):void 0}function Bb(e,t){return e&&e.length?Cb(e,Lp(t),yb):void 0}function zb(e,t,n){var r=ch(t),i=qg(t,r),o=!(Ju(n)&&"chain"in n&&!n.chain),a=rl(e);return nf(i,(function(n){var r=t[n];e[n]=r,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__),i=n.__actions__=zl(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Hh([this.value()],arguments))});})),e}var qb=qu((function(e,t){return e*t}),1);function Fb(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return !e.call(this);case 1:return !e.call(this,t[0]);case 2:return !e.call(this,t[0],t[1]);case 3:return !e.call(this,t[0],t[1],t[2])}return !e.apply(this,t)}}var Vb=Cu?Cu.iterator:void 0;function Wb(e){if(!e)return [];if(Af(e))return ry(e)?Md(e):zl(e);if(Vb&&e[Vb])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Vb]());var t=Hv(e);return ("[object Map]"==t?yp:"[object Set]"==t?bp:oy)(e)}function Hb(){void 0===this.__values__&&(this.__values__=Wb(this.value()));var e=this.__index__>=this.__values__.length;return {done:e,value:e?void 0:this.__values__[this.__index__++]}}function Ub(e,t){var n=e.length;if(n)return df(t+=t<0?n:0,n)?e[t]:void 0}function Jb(e,t){return e&&e.length?Ub(e,el(t)):void 0}function Kb(e){return e=el(e),Mf((function(t){return Ub(t,e)}))}function Gb(e,t){return null==(e=_y(e,t=zh(t,e)))||delete e[qh(Em(t))]}function Qb(e){return id(e)?void 0:e}var Yb=Qh((function(e,t){var n={};if(null==e)return n;var r=!1;t=Iu(t,(function(t){return t=zh(t,e),r||(r=t.length>1),t})),$f(e,Nv(e),n),r&&(n=ap(n,7,Qb));for(var i=t.length;i--;)Gb(n,t[i]);return n})),Xb=Yb;function Zb(e,t,n,r){if(!Ju(e))return e;for(var i=-1,o=(t=zh(t,e)).length,a=o-1,s=e;null!=s&&++i<o;){var c=qh(t[i]),u=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(i!=a){var l=s[c];void 0===(u=r?r(l,c,s):void 0)&&(u=Ju(l)?l:df(t[i+1])?[]:{});}Cf(s,c,u),s=s[c];}return e}function ew(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=Fh(e,a);n(s,a)&&Zb(o,zh(a,e),s);}return o}function tw(e,t){if(null==e)return {};var n=Iu(Nv(e),(function(e){return [e]}));return t=Lp(t),ew(e,n,(function(e,n){return t(e,n[0])}))}function nw(e,t){return tw(e,Fb(Lp(t)))}function rw(e){return cd(2,e)}function iw(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e==e,o=Ru(e),a=void 0!==t,s=null===t,c=t==t,u=Ru(t);if(!s&&!u&&!o&&e>t||o&&a&&c&&!s&&!u||r&&a&&c||!n&&c||!i)return 1;if(!r&&!o&&!u&&e<t||u&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!c)return -1}return 0}function ow(e,t,n){t=t.length?Iu(t,(function(e){return Du(e)?function(t){return Fh(t,1===e.length?e[0]:e)}:e})):[nl];var r=-1;t=Iu(t,Kf(Lp));var i=Sg(e,(function(e,n,i){var o=Iu(t,(function(t){return t(e)}));return {criteria:o,index:++r,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(i,(function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var c=iw(i[r],o[r]);if(c)return r>=s?c:c*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}function aw(e,t,n,r){return null==e?[]:(Du(t)||(t=null==t?[]:[t]),Du(n=r?void 0:n)||(n=null==n?[]:[n]),ow(e,t,n))}function sw(e){return Qh((function(t){return t=Iu(t,Kf(Lp)),Mf((function(n){var r=this;return e(t,(function(e){return Cl(e,r,n)}))}))}))}var cw=sw(Iu),uw=Mf,lw=Math.min,fw=uw((function(e,t){var n=(t=1==t.length&&Du(t[0])?Iu(t[0],Kf(Lp)):Iu(Kh(t,1),Kf(Lp))).length;return Mf((function(r){for(var i=-1,o=lw(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return Cl(e,this,r)}))})),hw=fw,dw=sw(og),vw=sw(pp),pw=Math.floor;function mw(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=pw(t/2))&&(e+=e);}while(t);return n}var gw=Ip("length"),yw="[\\ud800-\\udfff]",bw="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ww="\\ud83c[\\udffb-\\udfff]",xw="[^\\ud800-\\udfff]",kw="(?:\\ud83c[\\udde6-\\uddff]){2}",jw="[\\ud800-\\udbff][\\udc00-\\udfff]",Sw="(?:"+bw+"|"+ww+")"+"?",Cw="[\\ufe0e\\ufe0f]?"+Sw+("(?:\\u200d(?:"+[xw,kw,jw].join("|")+")[\\ufe0e\\ufe0f]?"+Sw+")*"),$w="(?:"+[xw+bw+"?",bw,kw,jw,yw].join("|")+")",_w=RegExp(ww+"(?="+ww+")|"+$w+Cw,"g");function Ow(e){return yd(e)?function(e){for(var t=_w.lastIndex=0;_w.test(e);)++t;return t}(e):gw(e)}var Mw=Math.ceil;function Ew(e,t){var n=(t=void 0===t?" ":zu(t)).length;if(n<2)return n?mw(t,e):t;var r=mw(t,Mw(e/Ow(t)));return yd(t)?md(Md(r),0,e).join(""):r.slice(0,e)}var Aw=Math.ceil,Pw=Math.floor;function Tw(e,t,n){e=Bh(e);var r=(t=el(t))?Ow(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Ew(Pw(i),n)+e+Ew(Aw(i),n)}function Rw(e,t,n){e=Bh(e);var r=(t=el(t))?Ow(e):0;return t&&r<t?e+Ew(t-r,n):e}function Nw(e,t,n){e=Bh(e);var r=(t=el(t))?Ow(e):0;return t&&r<t?Ew(t-r,n)+e:e}var Iw=/^\s+/,Dw=Su.parseInt;function Lw(e,t,n){return n||null==t?t=0:t&&(t=+t),Dw(Bh(e).replace(Iw,""),t||0)}var Bw=Mf((function(e,t){return wf(e,32,void 0,t,mf(t,ff(Bw)))}));Bw.placeholder={};var zw=Bw,qw=Mf((function(e,t){return wf(e,64,void 0,t,mf(t,ff(qw)))}));qw.placeholder={};var Fw=qw,Vw=Qp((function(e,t,n){e[n?0:1].push(t);}),(function(){return [[],[]]})),Ww=Vw;var Hw=Qh((function(e,t){return null==e?{}:function(e,t){return ew(e,t,(function(t,n){return Rp(e,n)}))}(e,t)})),Uw=Hw;function Jw(e){for(var t,n=this;n instanceof Al;){var r=ql(n);r.__index__=0,r.__values__=void 0,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__;}return i.__wrapped__=e,t}function Kw(e){return function(t){return null==e?void 0:Fh(e,t)}}function Gw(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return -1}var Qw=Array.prototype.splice;function Yw(e,t,n,r){var i=r?Gw:af,o=-1,a=t.length,s=e;for(e===t&&(t=zl(t)),n&&(s=Iu(e,Kf(n)));++o<a;)for(var c=0,u=t[o],l=n?n(u):u;(c=i(s,l,c,r))>-1;)s!==e&&Qw.call(s,c,1),Qw.call(e,c,1);return e}function Xw(e,t){return e&&e.length&&t&&t.length?Yw(e,t):e}var Zw=Mf(Xw);function ex(e,t,n){return e&&e.length&&t&&t.length?Yw(e,t,Lp(n)):e}function tx(e,t,n){return e&&e.length&&t&&t.length?Yw(e,t,void 0,n):e}var nx=Array.prototype.splice;function rx(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;df(i)?nx.call(e,i,1):Gb(e,i);}}return e}var ix=Qh((function(e,t){var n=null==e?0:e.length,r=Wh(e,t);return rx(e,Iu(t,(function(e){return df(e,n)?+e:e})).sort(iw)),r})),ox=ix,ax=Math.floor,sx=Math.random;function cx(e,t){return e+ax(sx()*(t-e+1))}var ux=parseFloat,lx=Math.min,fx=Math.random;function hx(e,t,n){if(n&&"boolean"!=typeof n&&Pf(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=Zu(e),void 0===t?(t=e,e=0):t=Zu(t)),e>t){var r=e;e=t,t=r;}if(n||e%1||t%1){var i=fx();return lx(e+i*(t-e+ux("1e-"+((i+"").length-1))),t)}return cx(e,t)}var dx=Math.ceil,vx=Math.max;function px(e){return function(t,n,r){return r&&"number"!=typeof r&&Pf(t,n,r)&&(n=r=void 0),t=Zu(t),void 0===n?(n=t,t=0):n=Zu(n),function(e,t,n,r){for(var i=-1,o=vx(dx((t-e)/(n||1)),0),a=Array(o);o--;)a[r?o:++i]=e,e+=n;return a}(t,n,r=void 0===r?t<n?1:-1:Zu(r),e)}}var mx=px(),gx=px(!0),yx=Qh((function(e,t){return wf(e,256,void 0,void 0,void 0,t)})),bx=yx;function wx(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o);})),n}function xx(e,t,n){var r=Du(e)?Td:wx,i=arguments.length<3;return r(e,Lp(t),n,i,Kp)}function kx(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function jx(e,t,n){var r=Du(e)?kx:wx,i=arguments.length<3;return r(e,Lp(t),n,i,Um)}function Sx(e,t){return (Du(e)?Cv:lg)(e,Fb(Lp(t)))}function Cx(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=Lp(t);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r));}return rx(e,i),n}function $x(e,t,n){return t=(n?Pf(e,t,n):void 0===t)?1:el(t),mw(Bh(e),t)}function _x(){var e=arguments,t=Bh(e[0]);return e.length<3?t:t.replace(e[1],e[2])}function Ox(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return Mf(e,t=void 0===t?t:el(t))}function Mx(e,t,n){var r=-1,i=(t=zh(t,e)).length;for(i||(i=1,e=void 0);++r<i;){var o=null==e?void 0:e[qh(t[r])];void 0===o&&(r=i,o=n),e=rl(o)?o.call(e):o;}return e}var Ex=Array.prototype.reverse;function Ax(e){return null==e?e:Ex.call(e)}var Px=lv("round");function Tx(e){var t=e.length;return t?e[cx(0,t-1)]:void 0}function Rx(e){return Tx(oy(e))}function Nx(e){return (Du(e)?Tx:Rx)(e)}function Ix(e,t){var n=-1,r=e.length,i=r-1;for(t=void 0===t?r:t;++n<t;){var o=cx(n,i),a=e[o];e[o]=e[n],e[n]=a;}return e.length=t,e}function Dx(e,t){return Ix(zl(e),mv(t,0,e.length))}function Lx(e,t){var n=oy(e);return Ix(n,mv(t,0,n.length))}function Bx(e,t,n){return t=(n?Pf(e,t,n):void 0===t)?1:el(t),(Du(e)?Dx:Lx)(e,t)}function zx(e,t,n){return null==e?e:Zb(e,t,n)}function qx(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:Zb(e,t,n,r)}function Fx(e){return Ix(zl(e))}function Vx(e){return Ix(oy(e))}function Wx(e){return (Du(e)?Fx:Vx)(e)}function Hx(e){if(null==e)return 0;if(Af(e))return ry(e)?Ow(e):e.length;var t=Hv(e);return "[object Map]"==t||"[object Set]"==t?e.size:sh(e).length}function Ux(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&Pf(e,t,n)?(t=0,n=r):(t=null==t?0:el(t),n=void 0===n?r:el(n)),pd(e,t,n)):[]}var Jx=iv((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()})),Kx=Jx;function Gx(e,t){var n;return Kp(e,(function(e,r,i){return !(n=t(e,r,i))})),!!n}function Qx(e,t,n){var r=Du(e)?pp:Gx;return n&&Pf(e,t,n)&&(t=void 0),r(e,Lp(t))}var Yx=Mf((function(e,t){if(null==e)return [];var n=t.length;return n>1&&Pf(e,t[0],t[1])?t=[]:n>2&&Pf(t[0],t[1],t[2])&&(t=[t[0]]),ow(e,Kh(t,1),[])})),Xx=Yx,Zx=Math.floor,ek=Math.min;function tk(e,t,n,r){var i=0,o=null==e?0:e.length;if(0===o)return 0;for(var a=(t=n(t))!=t,s=null===t,c=Ru(t),u=void 0===t;i<o;){var l=Zx((i+o)/2),f=n(e[l]),h=void 0!==f,d=null===f,v=f==f,p=Ru(f);if(a)var m=r||v;else m=u?v&&(r||h):s?v&&h&&(r||!d):c?v&&h&&!d&&(r||!p):!d&&!p&&(r?f<=t:f<t);m?i=l+1:o=l;}return ek(o,4294967294)}function nk(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!Ru(a)&&(n?a<=t:a<t)?r=o+1:i=o;}return i}return tk(e,t,nl,n)}function rk(e,t){return nk(e,t)}function ik(e,t,n){return tk(e,t,Lp(n))}function ok(e,t){var n=null==e?0:e.length;if(n){var r=nk(e,t);if(r<n&&jf(e[r],t))return r}return -1}function ak(e,t){return nk(e,t,!0)}function sk(e,t,n){return tk(e,t,Lp(n),!0)}function ck(e,t){if(null==e?0:e.length){var n=nk(e,t,!0)-1;if(jf(e[n],t))return n}return -1}function uk(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!jf(s,c)){var c=s;o[i++]=0===a?0:a;}}return o}function lk(e){return e&&e.length?uk(e):[]}function fk(e,t){return e&&e.length?uk(e,Lp(t)):[]}function hk(e,t,n){return n&&"number"!=typeof n&&Pf(e,t,n)&&(t=n=void 0),(n=void 0===n?4294967295:n>>>0)?(e=Bh(e))&&("string"==typeof t||null!=t&&!eb(t))&&!(t=zu(t))&&yd(e)?md(Md(e),0,n):e.split(t,n):[]}var dk=Math.max;function vk(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return t=null==t?0:dk(el(t),0),Mf((function(n){var r=n[t],i=md(n,0,t);return r&&Hh(i,r),Cl(e,this,i)}))}var pk=iv((function(e,t,n){return e+(n?" ":"")+Ad(t)})),mk=pk;function gk(e,t,n){return e=Bh(e),n=null==n?0:mv(el(n),0,e.length),t=zu(t),e.slice(n,n+t.length)==t}function yk(){return {}}function bk(){return ""}function wk(){return !0}var xk=qu((function(e,t){return e-t}),0);function kk(e){return e&&e.length?Ob(e,nl):0}function jk(e,t){return e&&e.length?Ob(e,Lp(t)):0}function Sk(e){var t=null==e?0:e.length;return t?pd(e,1,t):[]}function Ck(e,t,n){return e&&e.length?pd(e,0,(t=n||void 0===t?1:el(t))<0?0:t):[]}function $k(e,t,n){var r=null==e?0:e.length;return r?pd(e,(t=r-(t=n||void 0===t?1:el(t)))<0?0:t,r):[]}function _k(e,t){return e&&e.length?Lm(e,Lp(t),!1,!0):[]}function Ok(e,t){return e&&e.length?Lm(e,Lp(t)):[]}function Mk(e,t){return t(e),e}var Ek=Object.prototype,Ak=Ek.hasOwnProperty;function Pk(e,t,n,r){return void 0===e||jf(e,Ek[n])&&!Ak.call(r,n)?t:e}var Tk={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function Rk(e){return "\\"+Tk[e]}var Nk=/<%=([\s\S]+?)%>/g,Ik={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:Nk,variable:"",imports:{_:{escape:tg}}},Dk=/\b__p \+= '';/g,Lk=/\b(__p \+=) '' \+/g,Bk=/(__e\(.*?\)|\b__t\)) \+\n'';/g,zk=/[()=,{}\[\]\/\s]/,qk=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Fk=/($^)/,Vk=/['\n\r\u2028\u2029\\]/g,Wk=Object.prototype.hasOwnProperty;function Hk(e,t,n){var r=Ik.imports._.templateSettings||Ik;n&&Pf(e,t,n)&&(t=void 0),e=Bh(e),t=yh({},t,r,Pk);var i,o,a=yh({},t.imports,r.imports,Pk),s=ch(a),c=iy(a,s),u=0,l=t.interpolate||Fk,f="__p += '",h=RegExp((t.escape||Fk).source+"|"+l.source+"|"+(l===Nk?qk:Fk).source+"|"+(t.evaluate||Fk).source+"|$","g"),d=Wk.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+"\n":"";e.replace(h,(function(t,n,r,a,s,c){return r||(r=a),f+=e.slice(u,c).replace(Vk,Rk),n&&(i=!0,f+="' +\n__e("+n+") +\n'"),s&&(o=!0,f+="';\n"+s+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=c+t.length,t})),f+="';\n";var v=Wk.call(t,"variable")&&t.variable;if(v){if(zk.test(v))throw new Error("Invalid `variable` option passed into `_.template`")}else f="with (obj) {\n"+f+"\n}\n";f=(o?f.replace(Dk,""):f).replace(Lk,"$1").replace(Bk,"$1;"),f="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var p=sd((function(){return Function(s,d+"return "+f).apply(void 0,c)}));if(p.source=f,od(p))throw p;return p}function Uk(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return Ju(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),am(e,t,{leading:r,maxWait:t,trailing:i})}function Jk(e,t){return t(e)}var Kk=Math.min;function Gk(e,t){if((e=el(e))<1||e>9007199254740991)return [];var n=4294967295,r=Kk(e,4294967295);e-=4294967295;for(var i=If(r,t=qm(t));++n<e;)t(n);return i}function Qk(){return this}function Yk(e,t){var n=e;return n instanceof Pl&&(n=n.value()),Td(t,(function(e,t){return t.func.apply(t.thisArg,Hh([e],t.args))}),n)}function Xk(){return Yk(this.__wrapped__,this.__actions__)}function Zk(e){return Bh(e).toLowerCase()}function ej(e){return Du(e)?Iu(e,qh):Ru(e)?[e]:zl(Lh(Bh(e)))}function tj(e){return e?mv(el(e),-9007199254740991,9007199254740991):0===e?e:0}function nj(e){return Bh(e).toUpperCase()}function rj(e,t,n){var r=Du(e),i=r||Uf(e)||th(e);if(t=Lp(t),null==n){var o=e&&e.constructor;n=i?r?new o:[]:Ju(e)&&rl(o)?jl(Xh(e)):{};}return (i?nf:Up)(e,(function(e,r,i){return t(n,e,r,i)})),n}function ij(e,t){for(var n=e.length;n--&&af(t,e[n],0)>-1;);return n}function oj(e,t){for(var n=-1,r=e.length;++n<r&&af(t,e[n],0)>-1;);return n}function aj(e,t,n){if((e=Bh(e))&&(n||void 0===t))return Uu(e);if(!e||!(t=zu(t)))return e;var r=Md(e),i=Md(t);return md(r,oj(r,i),ij(r,i)+1).join("")}function sj(e,t,n){if((e=Bh(e))&&(n||void 0===t))return e.slice(0,Wu(e)+1);if(!e||!(t=zu(t)))return e;var r=Md(e);return md(r,0,ij(r,Md(t))+1).join("")}var cj=/^\s+/;function uj(e,t,n){if((e=Bh(e))&&(n||void 0===t))return e.replace(cj,"");if(!e||!(t=zu(t)))return e;var r=Md(e);return md(r,oj(r,Md(t))).join("")}var lj=/\w*$/;function fj(e,t){var n=30,r="...";if(Ju(t)){var i="separator"in t?t.separator:i;n="length"in t?el(t.length):n,r="omission"in t?zu(t.omission):r;}var o=(e=Bh(e)).length;if(yd(e)){var a=Md(e);o=a.length;}if(n>=o)return e;var s=n-Ow(r);if(s<1)return r;var c=a?md(a,0,s).join(""):e.slice(0,s);if(void 0===i)return c+r;if(a&&(s+=c.length-s),eb(i)){if(e.slice(s).search(i)){var u,l=c;for(i.global||(i=RegExp(i.source,Bh(lj.exec(i))+"g")),i.lastIndex=0;u=i.exec(l);)var f=u.index;c=c.slice(0,void 0===f?s:f);}}else if(e.indexOf(zu(i),s)!=s){var h=c.lastIndexOf(i);h>-1&&(c=c.slice(0,h));}return c+r}function hj(e){return xf(e,1)}var dj=Rd({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),vj=/&(?:amp|lt|gt|quot|#39);/g,pj=RegExp(vj.source);function mj(e){return (e=Bh(e))&&pj.test(e)?e.replace(vj,dj):e}var gj=Lv&&1/bp(new Lv([,-0]))[1]==1/0?function(e){return new Lv(e)}:Tl,yj=gj;function bj(e,t,n){var r=-1,i=sf,o=e.length,a=!0,s=[],c=s;if(n)a=!1,i=$m;else if(o>=200){var u=t?null:yj(e);if(u)return bp(u);a=!1,i=mp,c=new vp;}else c=t?[]:s;e:for(;++r<o;){var l=e[r],f=t?t(l):l;if(l=n||0!==l?l:0,a&&f==f){for(var h=c.length;h--;)if(c[h]===f)continue e;t&&c.push(f),s.push(l);}else i(c,f,n)||(c!==s&&c.push(f),s.push(l));}return s}var wj=Mf((function(e){return bj(Kh(e,1,dm,!0))})),xj=Mf((function(e){var t=Em(e);return dm(t)&&(t=void 0),bj(Kh(e,1,dm,!0),Lp(t))})),kj=xj,jj=Mf((function(e){var t=Em(e);return t="function"==typeof t?t:void 0,bj(Kh(e,1,dm,!0),void 0,t)}));function Sj(e){return e&&e.length?bj(e):[]}function Cj(e,t){return e&&e.length?bj(e,Lp(t)):[]}function $j(e,t){return t="function"==typeof t?t:void 0,e&&e.length?bj(e,void 0,t):[]}var _j=0;function Oj(e){var t=++_j;return Bh(e)+t}function Mj(e,t){return null==e||Gb(e,t)}var Ej=Math.max;function Aj(e){if(!e||!e.length)return [];var t=0;return e=Cv(e,(function(e){if(dm(e))return t=Ej(e.length,t),!0})),If(t,(function(t){return Iu(e,Ip(t))}))}function Pj(e,t){if(!e||!e.length)return [];var n=Aj(e);return null==t?n:Iu(n,(function(e){return Cl(t,void 0,e)}))}function Tj(e,t,n,r){return Zb(e,t,n(Fh(e,t)),r)}function Rj(e,t,n){return null==e?e:Tj(e,t,qm(n))}function Nj(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:Tj(e,t,qm(n),r)}var Ij=iv((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Dj=Ij;function Lj(e){return null==e?[]:iy(e,vh(e))}var Bj=Mf((function(e,t){return dm(e)?_m(e,t):[]})),zj=Bj;function qj(e,t){return zw(qm(t),e)}var Fj=Qh((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return Wh(t,e)};return !(t>1||this.__actions__.length)&&r instanceof Pl&&df(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:Jk,args:[i],thisArg:void 0}),new Bl(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(i)})),Vj=Fj;function Wj(){return hv(this)}function Hj(){var e=this.__wrapped__;if(e instanceof Pl){var t=e;return this.__actions__.length&&(t=new Pl(this)),(t=t.reverse()).__actions__.push({func:Jk,args:[Ax],thisArg:void 0}),new Bl(t,this.__chain__)}return this.thru(Ax)}function Uj(e,t,n){var r=e.length;if(r<2)return r?bj(e[0]):[];for(var i=-1,o=Array(r);++i<r;)for(var a=e[i],s=-1;++s<r;)s!=i&&(o[i]=_m(o[i]||a,e[s],t,n));return bj(Kh(o,1),t,n)}var Jj=Mf((function(e){return Uj(Cv(e,dm))})),Kj=Mf((function(e){var t=Em(e);return dm(t)&&(t=void 0),Uj(Cv(e,dm),Lp(t))})),Gj=Kj,Qj=Mf((function(e){var t=Em(e);return t="function"==typeof t?t:void 0,Uj(Cv(e,dm),void 0,t)})),Yj=Mf(Aj);function Xj(e,t,n){for(var r=-1,i=e.length,o=t.length,a={};++r<i;){var s=r<o?t[r]:void 0;n(a,e[r],s);}return a}function Zj(e,t){return Xj(e||[],t||[],Cf)}function eS(e,t){return Xj(e||[],t||[],Zb)}var tS=Mf((function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,Pj(e,n)})),nS=tS,rS={chunk:pv,compact:hp,concat:dp,difference:Mm,differenceBy:Pm,differenceWith:Rm,drop:Im,dropRight:Dm,dropRightWhile:Bm,dropWhile:zm,fill:ug,findIndex:vg,findLastIndex:wg,first:jg,flatten:Gh,flattenDeep:Mg,flattenDepth:Eg,fromPairs:zg,head:jg,indexOf:uy,initial:ly,intersection:vy,intersectionBy:my,intersectionWith:gy,join:sb,last:Em,lastIndexOf:vb,nth:Jb,pull:Zw,pullAll:Xw,pullAllBy:ex,pullAllWith:tx,pullAt:ox,remove:Cx,reverse:Ax,slice:Ux,sortedIndex:rk,sortedIndexBy:ik,sortedIndexOf:ok,sortedLastIndex:ak,sortedLastIndexBy:sk,sortedLastIndexOf:ck,sortedUniq:lk,sortedUniqBy:fk,tail:Sk,take:Ck,takeRight:$k,takeRightWhile:_k,takeWhile:Ok,union:wj,unionBy:kj,unionWith:jj,uniq:Sj,uniqBy:Cj,uniqWith:$j,unzip:Aj,unzipWith:Pj,without:zj,xor:Jj,xorBy:Gj,xorWith:Qj,zip:Yj,zipObject:Zj,zipObjectDeep:eS,zipWith:nS},iS={countBy:Zp,each:Fm,eachRight:Jm,every:sg,filter:fg,find:pg,findLast:xg,flatMap:$g,flatMapDeep:_g,flatMapDepth:Og,forEach:Fm,forEachRight:Jm,groupBy:Ug,includes:sy,invokeMap:Ay,keyBy:fb,map:Cg,orderBy:aw,partition:Ww,reduce:xx,reduceRight:jx,reject:Sx,sample:Nx,sampleSize:Bx,shuffle:Wx,size:Hx,some:Qx,sortBy:Xx},oS={now:rm},aS={after:tl,ary:xf,before:cd,bind:ld,bindKey:vd,curry:tm,curryRight:nm,debounce:am,defer:jm,delay:Cm,flip:Ag,memoize:Rh,negate:Fb,once:rw,overArgs:hw,partial:zw,partialRight:Fw,rearg:bx,rest:Ox,spread:vk,throttle:Uk,unary:hj,wrap:qj},sS={castArray:sv,clone:sp,cloneDeep:cp,cloneDeepWith:up,cloneWith:lp,conformsTo:Fp,eq:jf,gt:Gg,gte:Qg,isArguments:qf,isArray:Du,isArrayBuffer:Ty,isArrayLike:Af,isArrayLikeObject:dm,isBoolean:Ry,isBuffer:Uf,isDate:Iy,isElement:Dy,isEmpty:By,isEqual:zy,isEqualWith:qy,isError:od,isFinite:Vy,isFunction:rl,isInteger:Wy,isLength:Ef,isMap:np,isMatch:Hy,isMatchWith:Uy,isNaN:Ky,isNative:Qy,isNil:Yy,isNull:Xy,isNumber:Jy,isObject:Ju,isObjectLike:Tu,isPlainObject:id,isRegExp:eb,isSafeInteger:tb,isSet:ip,isString:ry,isSymbol:Ru,isTypedArray:th,isUndefined:nb,isWeakMap:rb,isWeakSet:ib,lt:bb,lte:wb,toArray:Wb,toFinite:Zu,toInteger:el,toLength:cg,toNumber:Xu,toPlainObject:pm,toSafeInteger:tj,toString:Bh},cS={add:Fu,ceil:fv,divide:Nm,floor:Pg,max:$b,maxBy:_b,mean:Eb,meanBy:Ab,min:Lb,minBy:Bb,multiply:qb,round:Px,subtract:xk,sum:kk,sumBy:jk},uS=gv,lS=ny,fS=hx,hS={assign:fh,assignIn:mh,assignInWith:yh,assignWith:wh,at:Yh,create:em,defaults:fm,defaultsDeep:wm,entries:Qm,entriesIn:Ym,extend:mh,extendWith:yh,findKey:gg,findLastKey:kg,forIn:Ig,forInRight:Dg,forOwn:Lg,forOwnRight:Bg,functions:Fg,functionsIn:Vg,get:Vh,has:Zg,hasIn:Rp,invert:xy,invertBy:$y,invoke:My,keys:ch,keysIn:vh,mapKeys:xb,mapValues:kb,merge:Tb,mergeWith:bm,omit:Xb,omitBy:nw,pick:Uw,pickBy:tw,result:Mx,set:zx,setWith:qx,toPairs:Qm,toPairsIn:Ym,transform:rj,unset:Mj,update:Rj,updateWith:Nj,values:oy,valuesIn:Lj},dS={at:Vj,chain:hv,commit:fp,lodash:Vl,next:Hb,plant:Jw,reverse:Hj,tap:Mk,thru:Jk,toIterator:Qk,toJSON:Xk,value:Xk,valueOf:Xk,wrapperChain:Wj},vS={camelCase:av,capitalize:Pd,deburr:Ld,endsWith:Km,escape:tg,escapeRegExp:ig,kebabCase:ub,lowerCase:mb,lowerFirst:gb,pad:Tw,padEnd:Rw,padStart:Nw,parseInt:Lw,repeat:$x,replace:_x,snakeCase:Kx,split:hk,startCase:mk,startsWith:gk,template:Hk,templateSettings:Ik,toLower:Zk,toUpper:nj,trim:aj,trimEnd:sj,trimStart:uj,truncate:fj,unescape:mj,upperCase:Dj,upperFirst:Ad,words:nv},pS={attempt:sd,bindAll:hd,cond:Bp,conforms:qp,constant:Yl,defaultTo:sm,flow:Rg,flowRight:Ng,identity:nl,iteratee:ob,matches:jb,matchesProperty:Sb,method:Nb,methodOf:Db,mixin:zb,noop:Tl,nthArg:Kb,over:cw,overEvery:dw,overSome:vw,property:Dp,propertyOf:Kw,range:mx,rangeRight:gx,stubArray:$v,stubFalse:Ff,stubObject:yk,stubString:bk,stubTrue:wk,times:Gk,toPath:ej,uniqueId:Oj};var mS=Math.max,gS=Math.min;var yS=Math.min;
/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var bS,wS=Array.prototype,xS=Object.prototype.hasOwnProperty,kS=Cu?Cu.iterator:void 0,jS=Math.max,SS=Math.min,CS=function(e){return function(t,n,r){if(null==r){var i=Ju(n),o=i&&ch(n),a=o&&o.length&&qg(n,o);(a?a.length:i)||(r=n,n=t,t=this);}return e(t,n,r)}}(zb);Vl.after=aS.after,Vl.ary=aS.ary,Vl.assign=hS.assign,Vl.assignIn=hS.assignIn,Vl.assignInWith=hS.assignInWith,Vl.assignWith=hS.assignWith,Vl.at=hS.at,Vl.before=aS.before,Vl.bind=aS.bind,Vl.bindAll=pS.bindAll,Vl.bindKey=aS.bindKey,Vl.castArray=sS.castArray,Vl.chain=dS.chain,Vl.chunk=rS.chunk,Vl.compact=rS.compact,Vl.concat=rS.concat,Vl.cond=pS.cond,Vl.conforms=pS.conforms,Vl.constant=pS.constant,Vl.countBy=iS.countBy,Vl.create=hS.create,Vl.curry=aS.curry,Vl.curryRight=aS.curryRight,Vl.debounce=aS.debounce,Vl.defaults=hS.defaults,Vl.defaultsDeep=hS.defaultsDeep,Vl.defer=aS.defer,Vl.delay=aS.delay,Vl.difference=rS.difference,Vl.differenceBy=rS.differenceBy,Vl.differenceWith=rS.differenceWith,Vl.drop=rS.drop,Vl.dropRight=rS.dropRight,Vl.dropRightWhile=rS.dropRightWhile,Vl.dropWhile=rS.dropWhile,Vl.fill=rS.fill,Vl.filter=iS.filter,Vl.flatMap=iS.flatMap,Vl.flatMapDeep=iS.flatMapDeep,Vl.flatMapDepth=iS.flatMapDepth,Vl.flatten=rS.flatten,Vl.flattenDeep=rS.flattenDeep,Vl.flattenDepth=rS.flattenDepth,Vl.flip=aS.flip,Vl.flow=pS.flow,Vl.flowRight=pS.flowRight,Vl.fromPairs=rS.fromPairs,Vl.functions=hS.functions,Vl.functionsIn=hS.functionsIn,Vl.groupBy=iS.groupBy,Vl.initial=rS.initial,Vl.intersection=rS.intersection,Vl.intersectionBy=rS.intersectionBy,Vl.intersectionWith=rS.intersectionWith,Vl.invert=hS.invert,Vl.invertBy=hS.invertBy,Vl.invokeMap=iS.invokeMap,Vl.iteratee=pS.iteratee,Vl.keyBy=iS.keyBy,Vl.keys=ch,Vl.keysIn=hS.keysIn,Vl.map=iS.map,Vl.mapKeys=hS.mapKeys,Vl.mapValues=hS.mapValues,Vl.matches=pS.matches,Vl.matchesProperty=pS.matchesProperty,Vl.memoize=aS.memoize,Vl.merge=hS.merge,Vl.mergeWith=hS.mergeWith,Vl.method=pS.method,Vl.methodOf=pS.methodOf,Vl.mixin=CS,Vl.negate=Fb,Vl.nthArg=pS.nthArg,Vl.omit=hS.omit,Vl.omitBy=hS.omitBy,Vl.once=aS.once,Vl.orderBy=iS.orderBy,Vl.over=pS.over,Vl.overArgs=aS.overArgs,Vl.overEvery=pS.overEvery,Vl.overSome=pS.overSome,Vl.partial=aS.partial,Vl.partialRight=aS.partialRight,Vl.partition=iS.partition,Vl.pick=hS.pick,Vl.pickBy=hS.pickBy,Vl.property=pS.property,Vl.propertyOf=pS.propertyOf,Vl.pull=rS.pull,Vl.pullAll=rS.pullAll,Vl.pullAllBy=rS.pullAllBy,Vl.pullAllWith=rS.pullAllWith,Vl.pullAt=rS.pullAt,Vl.range=pS.range,Vl.rangeRight=pS.rangeRight,Vl.rearg=aS.rearg,Vl.reject=iS.reject,Vl.remove=rS.remove,Vl.rest=aS.rest,Vl.reverse=rS.reverse,Vl.sampleSize=iS.sampleSize,Vl.set=hS.set,Vl.setWith=hS.setWith,Vl.shuffle=iS.shuffle,Vl.slice=rS.slice,Vl.sortBy=iS.sortBy,Vl.sortedUniq=rS.sortedUniq,Vl.sortedUniqBy=rS.sortedUniqBy,Vl.split=vS.split,Vl.spread=aS.spread,Vl.tail=rS.tail,Vl.take=rS.take,Vl.takeRight=rS.takeRight,Vl.takeRightWhile=rS.takeRightWhile,Vl.takeWhile=rS.takeWhile,Vl.tap=dS.tap,Vl.throttle=aS.throttle,Vl.thru=Jk,Vl.toArray=sS.toArray,Vl.toPairs=hS.toPairs,Vl.toPairsIn=hS.toPairsIn,Vl.toPath=pS.toPath,Vl.toPlainObject=sS.toPlainObject,Vl.transform=hS.transform,Vl.unary=aS.unary,Vl.union=rS.union,Vl.unionBy=rS.unionBy,Vl.unionWith=rS.unionWith,Vl.uniq=rS.uniq,Vl.uniqBy=rS.uniqBy,Vl.uniqWith=rS.uniqWith,Vl.unset=hS.unset,Vl.unzip=rS.unzip,Vl.unzipWith=rS.unzipWith,Vl.update=hS.update,Vl.updateWith=hS.updateWith,Vl.values=hS.values,Vl.valuesIn=hS.valuesIn,Vl.without=rS.without,Vl.words=vS.words,Vl.wrap=aS.wrap,Vl.xor=rS.xor,Vl.xorBy=rS.xorBy,Vl.xorWith=rS.xorWith,Vl.zip=rS.zip,Vl.zipObject=rS.zipObject,Vl.zipObjectDeep=rS.zipObjectDeep,Vl.zipWith=rS.zipWith,Vl.entries=hS.toPairs,Vl.entriesIn=hS.toPairsIn,Vl.extend=hS.assignIn,Vl.extendWith=hS.assignInWith,CS(Vl,Vl),Vl.add=cS.add,Vl.attempt=pS.attempt,Vl.camelCase=vS.camelCase,Vl.capitalize=vS.capitalize,Vl.ceil=cS.ceil,Vl.clamp=uS,Vl.clone=sS.clone,Vl.cloneDeep=sS.cloneDeep,Vl.cloneDeepWith=sS.cloneDeepWith,Vl.cloneWith=sS.cloneWith,Vl.conformsTo=sS.conformsTo,Vl.deburr=vS.deburr,Vl.defaultTo=pS.defaultTo,Vl.divide=cS.divide,Vl.endsWith=vS.endsWith,Vl.eq=sS.eq,Vl.escape=vS.escape,Vl.escapeRegExp=vS.escapeRegExp,Vl.every=iS.every,Vl.find=iS.find,Vl.findIndex=rS.findIndex,Vl.findKey=hS.findKey,Vl.findLast=iS.findLast,Vl.findLastIndex=rS.findLastIndex,Vl.findLastKey=hS.findLastKey,Vl.floor=cS.floor,Vl.forEach=iS.forEach,Vl.forEachRight=iS.forEachRight,Vl.forIn=hS.forIn,Vl.forInRight=hS.forInRight,Vl.forOwn=hS.forOwn,Vl.forOwnRight=hS.forOwnRight,Vl.get=hS.get,Vl.gt=sS.gt,Vl.gte=sS.gte,Vl.has=hS.has,Vl.hasIn=hS.hasIn,Vl.head=rS.head,Vl.identity=nl,Vl.includes=iS.includes,Vl.indexOf=rS.indexOf,Vl.inRange=lS,Vl.invoke=hS.invoke,Vl.isArguments=sS.isArguments,Vl.isArray=Du,Vl.isArrayBuffer=sS.isArrayBuffer,Vl.isArrayLike=sS.isArrayLike,Vl.isArrayLikeObject=sS.isArrayLikeObject,Vl.isBoolean=sS.isBoolean,Vl.isBuffer=sS.isBuffer,Vl.isDate=sS.isDate,Vl.isElement=sS.isElement,Vl.isEmpty=sS.isEmpty,Vl.isEqual=sS.isEqual,Vl.isEqualWith=sS.isEqualWith,Vl.isError=sS.isError,Vl.isFinite=sS.isFinite,Vl.isFunction=sS.isFunction,Vl.isInteger=sS.isInteger,Vl.isLength=sS.isLength,Vl.isMap=sS.isMap,Vl.isMatch=sS.isMatch,Vl.isMatchWith=sS.isMatchWith,Vl.isNaN=sS.isNaN,Vl.isNative=sS.isNative,Vl.isNil=sS.isNil,Vl.isNull=sS.isNull,Vl.isNumber=sS.isNumber,Vl.isObject=Ju,Vl.isObjectLike=sS.isObjectLike,Vl.isPlainObject=sS.isPlainObject,Vl.isRegExp=sS.isRegExp,Vl.isSafeInteger=sS.isSafeInteger,Vl.isSet=sS.isSet,Vl.isString=sS.isString,Vl.isSymbol=sS.isSymbol,Vl.isTypedArray=sS.isTypedArray,Vl.isUndefined=sS.isUndefined,Vl.isWeakMap=sS.isWeakMap,Vl.isWeakSet=sS.isWeakSet,Vl.join=rS.join,Vl.kebabCase=vS.kebabCase,Vl.last=Em,Vl.lastIndexOf=rS.lastIndexOf,Vl.lowerCase=vS.lowerCase,Vl.lowerFirst=vS.lowerFirst,Vl.lt=sS.lt,Vl.lte=sS.lte,Vl.max=cS.max,Vl.maxBy=cS.maxBy,Vl.mean=cS.mean,Vl.meanBy=cS.meanBy,Vl.min=cS.min,Vl.minBy=cS.minBy,Vl.stubArray=pS.stubArray,Vl.stubFalse=pS.stubFalse,Vl.stubObject=pS.stubObject,Vl.stubString=pS.stubString,Vl.stubTrue=pS.stubTrue,Vl.multiply=cS.multiply,Vl.nth=rS.nth,Vl.noop=pS.noop,Vl.now=oS.now,Vl.pad=vS.pad,Vl.padEnd=vS.padEnd,Vl.padStart=vS.padStart,Vl.parseInt=vS.parseInt,Vl.random=fS,Vl.reduce=iS.reduce,Vl.reduceRight=iS.reduceRight,Vl.repeat=vS.repeat,Vl.replace=vS.replace,Vl.result=hS.result,Vl.round=cS.round,Vl.sample=iS.sample,Vl.size=iS.size,Vl.snakeCase=vS.snakeCase,Vl.some=iS.some,Vl.sortedIndex=rS.sortedIndex,Vl.sortedIndexBy=rS.sortedIndexBy,Vl.sortedIndexOf=rS.sortedIndexOf,Vl.sortedLastIndex=rS.sortedLastIndex,Vl.sortedLastIndexBy=rS.sortedLastIndexBy,Vl.sortedLastIndexOf=rS.sortedLastIndexOf,Vl.startCase=vS.startCase,Vl.startsWith=vS.startsWith,Vl.subtract=cS.subtract,Vl.sum=cS.sum,Vl.sumBy=cS.sumBy,Vl.template=vS.template,Vl.times=pS.times,Vl.toFinite=sS.toFinite,Vl.toInteger=el,Vl.toLength=sS.toLength,Vl.toLower=vS.toLower,Vl.toNumber=sS.toNumber,Vl.toSafeInteger=sS.toSafeInteger,Vl.toString=sS.toString,Vl.toUpper=vS.toUpper,Vl.trim=vS.trim,Vl.trimEnd=vS.trimEnd,Vl.trimStart=vS.trimStart,Vl.truncate=vS.truncate,Vl.unescape=vS.unescape,Vl.uniqueId=pS.uniqueId,Vl.upperCase=vS.upperCase,Vl.upperFirst=vS.upperFirst,Vl.each=iS.forEach,Vl.eachRight=iS.forEachRight,Vl.first=rS.head,CS(Vl,(bS={},Up(Vl,(function(e,t){xS.call(Vl.prototype,t)||(bS[t]=e);})),bS),{chain:!1}),Vl.VERSION="4.17.21",(Vl.templateSettings=vS.templateSettings).imports._=Vl,nf(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Vl[e].placeholder=Vl;})),nf(["drop","take"],(function(e,t){Pl.prototype[e]=function(n){n=void 0===n?1:jS(el(n),0);var r=this.__filtered__&&!t?new Pl(this):this.clone();return r.__filtered__?r.__takeCount__=SS(n,r.__takeCount__):r.__views__.push({size:SS(n,4294967295),type:e+(r.__dir__<0?"Right":"")}),r},Pl.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()};})),nf(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Pl.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Lp(e),type:n}),t.__filtered__=t.__filtered__||r,t};})),nf(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Pl.prototype[e]=function(){return this[n](1).value()[0]};})),nf(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Pl.prototype[e]=function(){return this.__filtered__?new Pl(this):this[n](1)};})),Pl.prototype.compact=function(){return this.filter(nl)},Pl.prototype.find=function(e){return this.filter(e).head()},Pl.prototype.findLast=function(e){return this.reverse().find(e)},Pl.prototype.invokeMap=Mf((function(e,t){return "function"==typeof e?new Pl(this):this.map((function(n){return Oy(n,e,t)}))})),Pl.prototype.reject=function(e){return this.filter(Fb(Lp(e)))},Pl.prototype.slice=function(e,t){e=el(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Pl(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=el(t))<0?n.dropRight(-t):n.take(t-e)),n)},Pl.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Pl.prototype.toArray=function(){return this.take(4294967295)},Up(Pl.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=Vl[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);i&&(Vl.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,s=t instanceof Pl,c=a[0],u=s||Du(t),l=function(e){var t=i.apply(Vl,Hh([e],a));return r&&f?t[0]:t};u&&n&&"function"==typeof c&&1!=c.length&&(s=u=!1);var f=this.__chain__,h=!!this.__actions__.length,d=o&&!f,v=s&&!h;if(!o&&u){t=v?t:new Pl(this);var p=e.apply(t,a);return p.__actions__.push({func:Jk,args:[l],thisArg:void 0}),new Bl(p,f)}return d&&v?e.apply(this,a):(p=this.thru(l),d?r?p.value()[0]:p.value():p)});})),nf(["pop","push","shift","sort","splice","unshift"],(function(e){var t=wS[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Vl.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Du(i)?i:[],e)}return this[n]((function(n){return t.apply(Du(n)?n:[],e)}))};})),Up(Pl.prototype,(function(e,t){var n=Vl[t];if(n){var r=n.name+"";xS.call(Il,r)||(Il[r]=[]),Il[r].push({name:t,func:n});}})),Il[gf(void 0,2).name]=[{name:"wrapper",func:void 0}],Pl.prototype.clone=function(){var e=new Pl(this.__wrapped__);return e.__actions__=zl(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=zl(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=zl(this.__views__),e},Pl.prototype.reverse=function(){if(this.__filtered__){var e=new Pl(this);e.__dir__=-1,e.__filtered__=!0;}else (e=this.clone()).__dir__*=-1;return e},Pl.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Du(e),r=t<0,i=n?e.length:0,o=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=gS(t,e+a);break;case"takeRight":e=mS(e,t-a);}}return {start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,c=s-a,u=r?s:a-1,l=this.__iteratees__,f=l.length,h=0,d=yS(c,this.__takeCount__);if(!n||!r&&i==c&&d==c)return Yk(e,this.__actions__);var v=[];e:for(;c--&&h<d;){for(var p=-1,m=e[u+=t];++p<f;){var g=l[p],y=g.iteratee,b=g.type,w=y(m);if(2==b)m=w;else if(!w){if(1==b)continue e;break e}}v[h++]=m;}return v},Vl.prototype.at=dS.at,Vl.prototype.chain=dS.wrapperChain,Vl.prototype.commit=dS.commit,Vl.prototype.next=dS.next,Vl.prototype.plant=dS.plant,Vl.prototype.reverse=dS.reverse,Vl.prototype.toJSON=Vl.prototype.valueOf=Vl.prototype.value=dS.value,Vl.prototype.first=Vl.prototype.head,kS&&(Vl.prototype[kS]=dS.toIterator)
/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */;var _S=[];function OS(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};if(!Array.isArray(e))throw new TypeError("Array expected");function r(e,i){(!Array.isArray(e)&&!hu(e)||t&&i.length>0)&&(n[Ys(i)]=!0),hu(e)&&Object.keys(e).forEach((function(t){r(e[t],i.concat(t));}));}for(var i=Math.min(e.length,1e4),o=0;o<i;o++){var a=e[o];r(a,_S);}var s=Object.keys(n).sort();return s.map(Qs)}function MS$1(e,t,n){if(!(t<=e))for(var r=e;r<t;r++)n(r);}function ES(e,t){return e.length>t?e.slice(0,t):e}function AS(e){return Oi({},e)}function PS(e){return Object.values(e)}function TS(e,t,n,r){var i=e.slice(0),o=i.splice(t,n);return i.splice.apply(i,[t+r,0].concat(Vi(o))),i}function RS(e,t,n){if(e.length<t)e.forEach(n);else for(var r=t>1?(e.length-1)/(t-1):e.length,i=0;i<t;i++){var o=Math.floor(i*r);n(e[o],o,e);}}function NS(e,t){try{return t.parse(e)}catch(n){return t.parse(su(e))}}function IS(e,t){try{return NS(e,t)}catch(e){return}}function DS(e,t){e=e.replace(BS,"");try{return t(e)}catch(e){}try{return t("["+e+"]")}catch(e){}try{return t("{"+e+"}")}catch(e){}throw new Error("Failed to parse partial JSON")}function LS(e){e=e.replace(BS,"");try{return su(e)}catch(e){}try{var t=su("["+e+"]");return t.substring(1,t.length-1)}catch(e){}try{var n=su("{"+e+"}");return n.substring(1,n.length-1)}catch(e){}throw new Error("Failed to repair partial JSON")}var BS=/,\s*$/;function zS(e,t){var n=QS.exec(t);if(n){var r=uu(n[2]),i=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,i=0,o=n;o<r;o++)e.charAt(o)===t&&i++;return i}(e,"\n",0,r),o=r-e.lastIndexOf("\n",r)-1;return {position:r,line:i,column:o,message:t.replace(QS,(function(){return "line ".concat(i+1," column ").concat(o+1)}))}}var a=YS.exec(t),s=a?uu(a[1]):null,c=null!==s?s-1:null,u=XS.exec(t),l=u?uu(u[1]):null,f=null!==l?l-1:null,h=null!==c&&null!==f?function(e,t,n){var r=e.indexOf("\n"),i=1;for(;i<t&&-1!==r;)r=e.indexOf("\n",r+1),i++;return -1!==r?r+n+1:null}(e,c,f):null;return {position:h,line:c,column:f,message:t.replace(/^JSON.parse: /,"").replace(/ of the JSON data$/,"")}}function qS(e){return hu(e)?void 0!==e.json?void 0!==e.text?'Content must contain either a property "json" or a property "text" but not both':null:void 0===e.text?'Content must contain either a property "json" or a property "text"':"string"!=typeof e.text?'Content "text" property must be a string containing a JSON document. Did you mean to use the "json" property instead?':null:"Content must be an object"}function VS(e){return hu(e)&&"string"==typeof e.text}function WS(e){return hu(e)&&void 0!==e.json&&!VS(e)}function HS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:JSON;return VS(e)?e:{text:n.stringify(e.json,null,t)}}function US(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JSON;return WS(e)?e:{json:t.parse(e.text)}}function JS(e,t,n){return HS(e,t,n).text}function KS(e,t){return GS(e,t)>t}function GS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;if(VS(e))return e.text.length;var n=e.json,r=0;function i(e){if(Array.isArray(e)){if((r+=e.length-1+2)>t)return r;for(var n=0;n<e.length;n++){if(i(e[n]),r>t)return r}}else if(hu(e)){var o=Object.keys(e);r+=2+o.length+(o.length-1);for(var a=0;a<o.length;a++){var s=o[a],c=e[s];r+=s.length+2,i(c);}}else r+="string"==typeof e?e.length+2:String(e).length;}return i(n),r}var QS=/(position|char) (\d+)/,YS=/line (\d+)/,XS=/column (\d+)/;function ZS(e,t){return e.parse===t.parse&&e.stringify===t.stringify}function eC(e){return tC.test(e)&&e.length>2}var tC=/^[[{]\S/;function nC(e){var t=e.escapeControlCharacters,n=e.escapeUnicodeCharacters;return t?n?rC:iC:n?oC:aC}var rC={escapeValue:function(e){return sC(fC(String(e)))},unescapeValue:function(e){return hC(cC(e))}},iC={escapeValue:function(e){return fC(String(e))},unescapeValue:function(e){return hC(e)}},oC={escapeValue:function(e){return sC(String(e))},unescapeValue:function(e){return cC(e)}},aC={escapeValue:function(e){return String(e)},unescapeValue:function(e){return e}};function sC(e){return e.replace(/[^\x20-\x7F]/g,(function(e){var t;return "\b"===e||"\f"===e||"\n"===e||"\r"===e||"\t"===e?e:"\\u"+("000"+(null===(t=e.codePointAt(0))||void 0===t?void 0:t.toString(16))).slice(-4)}))}function cC(e){return e.replace(/\\u[a-fA-F0-9]{4}/g,(function(e){try{var t=JSON.parse('"'+e+'"');return uC[t]||t}catch(t){return e}}))}var uC={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"},lC={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":"\n","\\r":"\r","\\t":"\t"};function fC(e){return e.replace(/["\b\f\n\r\t\\]/g,(function(e){return uC[e]||e}))}function hC(e){return e.replace(/\\["bfnrt\\]/g,(function(e){return lC[e]||e}))}function dC(e){return "string"!=typeof e?String(e):e.endsWith("\n")?e+"\n":e}function vC(e,t){return mC(e,(function(e){return e.nodeName.toUpperCase()===t.toUpperCase()}))}function pC(e,t,n){return mC(e,(function(e){return function(e,t,n){return "function"==typeof e.getAttribute&&e.getAttribute(t)===n}(e,t,n)}))}function mC(e,t){return !!gC(e,t)}function gC(e,t){for(var n=e;n&&!t(n);)n=n.parentNode;return n||void 0}function yC(e){if(null!=e.firstChild){var t=document.createRange(),n=window.getSelection();t.setStart(e,1),t.collapse(!0),null==n||n.removeAllRanges(),null==n||n.addRange(t);}else e.focus();}function bC(e,t,n){var r=wC(e);if(r){var i=r.document.activeElement?r.document.activeElement:null;i&&i.isContentEditable&&(i.textContent=n?t:i.textContent+t,yC(i));}}function wC(e){return e&&e.ownerDocument?e.ownerDocument.defaultView:null}function xC(e){var t=wC(e),n=null==t?void 0:t.document.activeElement;return !!n&&mC(n,(function(t){return t===e}))}function kC(e,t){return gC(e,(function(e){return e.nodeName===t}))}function jC(e){return pC(e,"data-type","selectable-key")?ss.key:pC(e,"data-type","selectable-value")?ss.value:pC(e,"data-type","insert-selection-area-inside")?ss.inside:pC(e,"data-type","insert-selection-area-after")?ss.after:ss.multi}function SC(e){return encodeURIComponent(Ys(e))}function CC(e){var t=gC(e,(function(e){return !(null==e||!e.hasAttribute)&&e.hasAttribute("data-path")})),n=null==t?void 0:t.getAttribute("data-path");return n?Qs(decodeURIComponent(n)):null}function $C(e){var t=e.allElements,n=e.currentElement,r=e.direction,i=e.hasPrio,o=void 0===i?function(){return !0}:i,a=e.margin,s=void 0===a?10:a,c=Cg(t.filter((function(e){var t=e.getBoundingClientRect();return t.width>0&&t.height>0})),l),u=l(n);function l(e){var t=e.getBoundingClientRect();return {x:t.left+t.width/2,y:t.top+t.height/2,rect:t,element:e}}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=e.x-t.x,i=(e.y-t.y)*n;return Math.sqrt(r*r+i*i)}var h=function(e){return f(e,u)};if("Left"===r||"Right"===r){var d="Left"===r?c.filter((function(e){return function(e,t){return e.rect.left+s<t.rect.left}(e,u)})):c.filter((function(e){return function(e,t){return e.rect.right>t.rect.right+s}(e,u)})),v=d.filter((function(e){return function(e,t){return Math.abs(e.y-t.y)<s}(e,u)})),p=Bb(v,h)||Bb(d,(function(e){return f(e,u,10)}));return null==p?void 0:p.element}if("Up"===r||"Down"===r){var m="Up"===r?c.filter((function(e){return function(e,t){return e.y+s<t.y}(e,u)})):c.filter((function(e){return function(e,t){return e.y>t.y+s}(e,u)})),g=Bb(m.filter((function(e){return o(e.element)})),h)||Bb(m,h);return null==g?void 0:g.element}}function _C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"+",n=[];e.ctrlKey&&n.push("Ctrl"),e.metaKey&&n.push("Ctrl"),e.altKey&&n.push("Alt"),e.shiftKey&&n.push("Shift");var r=1===e.key.length?e.key.toUpperCase():e.key;return r in OC||n.push(r),n.join(t)}var OC={Ctrl:!0,Command:!0,Control:!0,Alt:!0,Option:!0,Shift:!0},MC=Ea.window;function EC(e){bo(e,"svelte-1r8q3m8",".jse-absolute-popup.svelte-1r8q3m8.svelte-1r8q3m8{position:relative;left:0;top:0;width:0;height:0;z-index:1001}.jse-absolute-popup.svelte-1r8q3m8 .jse-hidden-input.svelte-1r8q3m8{position:fixed;left:0;top:0;width:0;height:0;padding:0;margin:0;border:none;outline:none;overflow:hidden}.jse-absolute-popup.svelte-1r8q3m8 .jse-absolute-popup-content.svelte-1r8q3m8{position:absolute}");}function AC(e){var t,n,r,i,o,a,s=[e[0].props],c=e[0].component;function u(e){for(var t={},n=0;n<s.length;n+=1)t=Qi(t,s[n]);return {props:t}}return c&&(i=Wo(c,u())),{c:function(){t=$o("div"),n=$o("input"),r=Mo(),i&&Da(i.$$.fragment),Ro(n,"type","text"),n.readOnly=!0,Ro(n,"tabindex","-1"),Ro(n,"class","jse-hidden-input svelte-1r8q3m8"),Ro(t,"class","jse-absolute-popup-content svelte-1r8q3m8"),Ro(t,"style",o=RC(e[1],e[0].options));},m:function(o,s){jo(o,t,s),yo(t,n),e[7](n),yo(t,r),i&&La(i,t,null),a=!0;},p:function(e,n){var r=1&n?Ra(s,[Na(e[0].props)]):{};if(1&n&&c!==(c=e[0].component)){if(i){Sa();var l=i;_a(l.$$.fragment,1,0,(function(){Ba(l,1);})),Ca();}c?(Da((i=Wo(c,u())).$$.fragment),$a(i.$$.fragment,1),La(i,t,null)):i=null;}else c&&i.$set(r);(!a||3&n&&o!==(o=RC(e[1],e[0].options)))&&Ro(t,"style",o);},i:function(e){a||(i&&$a(i.$$.fragment,e),a=!0);},o:function(e){i&&_a(i.$$.fragment,e),a=!1;},d:function(n){n&&So(t),e[7](null),i&&Ba(i);}}}function PC(e){var t,n,r,i,o=e[1]&&AC(e);return {c:function(){t=$o("div"),o&&o.c(),Ro(t,"class","jse-absolute-popup svelte-1r8q3m8");},m:function(a,s){jo(a,t,s),o&&o.m(t,null),e[8](t),n=!0,r||(i=[Ao(MC,"mousedown",e[3],!0),Ao(MC,"keydown",e[4],!0),Ao(MC,"wheel",e[5],!0),Ao(t,"mousedown",TC),Ao(t,"keydown",e[4])],r=!0);},p:function(e,n){var r=Si(n,1)[0];e[1]?o?(o.p(e,r),2&r&&$a(o,1)):((o=AC(e)).c(),$a(o,1),o.m(t,null)):o&&(Sa(),_a(o,1,1,(function(){o=null;})),Ca());},i:function(e){n||($a(o),n=!0);},o:function(e){_a(o),n=!1;},d:function(n){n&&So(t),o&&o.d(),e[8](null),r=!1,Zi(i);}}}function TC(e){e.stopPropagation();}function RC(e,t){var n=e.getBoundingClientRect(),r=function(){if(t.anchor){var e=t.anchor,n=t.width,r=void 0===n?0:n,i=t.height,o=void 0===i?0:i,a=t.offsetTop,s=void 0===a?0:a,c=t.offsetLeft,u=void 0===c?0:c,l=t.position,f=e.getBoundingClientRect(),h=f.left,d=f.top,v=f.bottom,p=f.right,m="top"===l||d+o>window.innerHeight&&d>o,g="left"===l||h+r>window.innerWidth&&h>r;return {left:g?p-u:h+u,top:m?d-s:v+s,positionAbove:m,positionLeft:g}}if("number"==typeof t.left&&"number"==typeof t.top){var y=t.left,b=t.top,w=t.width,x=void 0===w?0:w,k=t.height,j=void 0===k?0:k;return {left:y,top:b,positionAbove:b+j>window.innerHeight&&b>j,positionLeft:y+x>window.innerWidth&&y>x}}throw new Error('Invalid config: pass either "left" and "top", or pass "anchor"')}(),i=r.left,o=r.top,a=r.positionAbove,s=r.positionLeft;return (a?"bottom: ".concat(n.top-o,"px;"):"top: ".concat(o-n.top,"px;"))+(s?"right: ".concat(n.left-i,"px;"):"left: ".concat(i-n.left,"px;"))}function NC(e,t,n){var r,i,o=t.popup,a=t.closeAbsolutePopup;function s(e){o.options&&o.options.closeOnOuterClick&&!mC(e.target,(function(e){return e===r}))&&a(o.id);}return ea((function(){i&&i.focus();})),e.$$set=function(e){"popup"in e&&n(0,o=e.popup),"closeAbsolutePopup"in e&&n(6,a=e.closeAbsolutePopup);},[o,r,i,function(e){s(e);},function(e){"Escape"===_C(e)&&a(o.id);},function(e){s(e);},a,function(e){sa[e?"unshift":"push"]((function(){n(2,i=e);}));},function(e){sa[e?"unshift":"push"]((function(){n(1,r=e);}));}]}var IC=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,NC,PC,to,{popup:0,closeAbsolutePopup:6},EC),r}return qi(n)}();function DC(e,t,n){var r=e.slice();return r[6]=t[n],r}function LC(e){var t,n;return t=new IC({props:{popup:e[6],closeAbsolutePopup:e[1]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n&&(r.popup=e[6]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function BC(e){for(var t,n,r=e[0],i=[],o=0;o<r.length;o+=1)i[o]=LC(DC(e,r,o));var a=function(e){return _a(i[e],1,1,(function(){i[e]=null;}))},s=e[3].default,c=ro(s,e,e[2],null);return {c:function(){for(var e=0;e<i.length;e+=1)i[e].c();t=Mo(),c&&c.c();},m:function(e,r){for(var o=0;o<i.length;o+=1)i[o]&&i[o].m(e,r);jo(e,t,r),c&&c.m(e,r),n=!0;},p:function(e,o){var u=Si(o,1)[0];if(3&u){var l;for(r=e[0],l=0;l<r.length;l+=1){var f=DC(e,r,l);i[l]?(i[l].p(f,u),$a(i[l],1)):(i[l]=LC(f),i[l].c(),$a(i[l],1),i[l].m(t.parentNode,t));}for(Sa(),l=r.length;l<i.length;l+=1)a(l);Ca();}c&&c.p&&(!n||4&u)&&ao(c,s,e,e[2],n?oo(s,e[2],u,null):so(e[2]),null);},i:function(e){if(!n){for(var t=0;t<r.length;t+=1)$a(i[t]);$a(c,e),n=!0;}},o:function(e){i=i.filter(Boolean);for(var t=0;t<i.length;t+=1)_a(i[t]);_a(c,e),n=!1;},d:function(e){Co(i,e),e&&So(t),c&&c.d(e);}}}function zC(e,t,n){var r=t.$$slots,i=void 0===r?{}:r,o=t.$$scope,a=Ha("jsoneditor:AbsolutePopup"),s=[];function c(e){var t=s.findIndex((function(t){return t.id===e}));if(-1!==t){var r=s[t];r.options.onClose&&r.options.onClose(),n(0,s=s.filter((function(t){return t.id!==e})));}}return ra("absolute-popup",{openAbsolutePopup:function(e,t,r){a("open...",t,r);var i={id:Cs(),component:e,props:t||{},options:r||{}};return n(0,s=[].concat(Vi(s),[i])),i.id},closeAbsolutePopup:c}),e.$$set=function(e){"$$scope"in e&&n(2,o=e.$$scope);},e.$$.update=function(){1&e.$$.dirty&&a("popups",s);},[s,c,o,i]}var qC=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,zC,BC,no,{}),r}return qi(n)}();function FC(e){return e.map((function(e,t){return KC.test(e)?"["+e+"]":/[.[\]]/.test(e)||""===e?'["'+(e.replace(/"/g,'\\"')+'"]'):(t>0?".":"")+e})).join("")}function VC(e){for(var t=[],n=0;n<e.length;)"."===e[n]&&n++,"["===e[n]?(n++,'"'===e[n]?(n++,t.push(r((function(e){return '"'===e}),!0)),i('"')):t.push(r((function(e){return "]"===e}))),i("]")):t.push(r((function(e){return "."===e||"["===e})));function r(t){for(var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i="";n<e.length&&!t(e[n]);)r&&"\\"===e[n]&&'"'===e[n+1]?(i+='"',n+=2):(i+=e[n],n++);return i}function i(t){if(e[n]!==t)throw new SyntaxError("Invalid JSON path: ".concat(t," expected at position ").concat(n));n++;}return t}function WC(e){return {value:e,label:By(e)?"(whole item)":FC(e)}}function UC(e){return e.map((function(e){return KC.test(e)?"?.[".concat(e,"]"):JC.test(e)?"?.".concat(e):"?.[".concat(JSON.stringify(e),"]")})).join("")}var JC=/^[a-zA-Z$_][a-zA-Z$_\d]*$/,KC=/^\d+$/;function GC(e,t){for(var n=new Set(t),r=e.replace(/ \(copy( \d+)?\)$/,""),i=e,o=1;n.has(i);){var a="copy"+(o>1?" "+o:"");i="".concat(r," (").concat(a,")"),o++;}return i}function QC(e,t){var n=t-"...".length;return e.length>t?e.substring(0,n)+"...":e}function YC(e){if(""===e)return "";var t=e.toLowerCase();if("null"===t)return null;if("true"===t)return !0;if("false"===t)return !1;if("undefined"!==t){var n=Number(e),r=parseFloat(e);return isNaN(n)||isNaN(r)?e:n}}var XC={id:"javascript",name:"JavaScript",description:"\n<p>\n  Enter a JavaScript function to filter, sort, or transform the data.\n</p>\n",createQuery:function(e,t){var n=t.filter,r=t.sort,i=t.projection,o=["  return data\n"];if(n&&n.path&&n.relation&&n.value){var a="item => item".concat(UC(n.path)),s=YC(n.value),c="string"==typeof s?"'".concat(n.value,"'"):wu(n.value)&&!Number.isSafeInteger(s)?"".concat(n.value,"n"):n.value;o.push("    .filter(".concat(a," ").concat(n.relation," ").concat(c,")\n"));}r&&r.path&&r.direction&&("desc"===r.direction?o.push("    .slice()\n    .sort((a, b) => {\n      // sort descending\n"+"      const valueA = a".concat(UC(r.path),"\n")+"      const valueB = b".concat(UC(r.path),"\n")+"      return valueA > valueB ? -1 : valueA < valueB ? 1 : 0\n    })\n"):o.push("    .slice()\n    .sort((a, b) => {\n      // sort ascending\n"+"      const valueA = a".concat(UC(r.path),"\n")+"      const valueB = b".concat(UC(r.path),"\n")+"      return valueA > valueB ? 1 : valueA < valueB ? -1 : 0\n    })\n"));if(i&&i.paths)if(i.paths.length>1){var u=i.paths.map((function(e){var t=e[e.length-1]||"item",n="item".concat(UC(e));return "      ".concat(JSON.stringify(t),": ").concat(n)}));o.push("    .map(item => ({\n".concat(u.join(",\n"),"})\n    )\n"));}else {var l="item".concat(UC(i.paths[0]));o.push("    .map(item => ".concat(l,")\n"));}return "function query (data) {\n".concat(o.join(""),"}")},executeQuery:function(e,t){var n=new Function('"use strict";\n\n'+t+'\n\nif (typeof query !== "function") {\n  throw new Error("Cannot execute query: expecting a function named \'query\' but is undefined")\n}\n\nreturn query;\n')()(e);return void 0!==n?n:null}};var ZC={prefix:"far",iconName:"lightbulb",icon:[384,512,[128161],"f0eb","M297.2 248.9C311.6 228.3 320 203.2 320 176c0-70.7-57.3-128-128-128S64 105.3 64 176c0 27.2 8.4 52.3 22.8 72.9c3.7 5.3 8.1 11.3 12.8 17.7l0 0c12.9 17.7 28.3 38.9 39.8 59.8c10.4 19 15.7 38.8 18.3 57.5H109c-2.2-12-5.9-23.7-11.8-34.5c-9.9-18-22.2-34.9-34.5-51.8l0 0 0 0c-5.2-7.1-10.4-14.2-15.4-21.4C27.6 247.9 16 213.3 16 176C16 78.8 94.8 0 192 0s176 78.8 176 176c0 37.3-11.6 71.9-31.4 100.3c-5 7.2-10.2 14.3-15.4 21.4l0 0 0 0c-12.3 16.8-24.6 33.7-34.5 51.8c-5.9 10.8-9.6 22.5-11.8 34.5H226.4c2.6-18.7 7.9-38.6 18.3-57.5c11.5-20.9 26.9-42.1 39.8-59.8l0 0 0 0 0 0c4.7-6.4 9-12.4 12.7-17.7zM192 128c-26.5 0-48 21.5-48 48c0 8.8-7.2 16-16 16s-16-7.2-16-16c0-44.2 35.8-80 80-80c8.8 0 16 7.2 16 16s-7.2 16-16 16zm0 384c-44.2 0-80-35.8-80-80V416H272v16c0 44.2-35.8 80-80 80z"]},e$={prefix:"far",iconName:"square-check",icon:[448,512,[9745,9989,61510,"check-square"],"f14a","M64 80c-8.8 0-16 7.2-16 16V416c0 8.8 7.2 16 16 16H384c8.8 0 16-7.2 16-16V96c0-8.8-7.2-16-16-16H64zM0 96C0 60.7 28.7 32 64 32H384c35.3 0 64 28.7 64 64V416c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V96zM337 209L209 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L303 175c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9z"]},t$={prefix:"far",iconName:"square",icon:[448,512,[9632,9723,9724,61590],"f0c8","M384 80c8.8 0 16 7.2 16 16V416c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V96c0-8.8 7.2-16 16-16H384zM64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64z"]},n$={prefix:"far",iconName:"clock",icon:[512,512,[128339,"clock-four"],"f017","M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z"]};function r$(e){var t;return {c:function(){t=_o("g");},m:function(n,r){jo(n,t,r),t.innerHTML=e[0];},p:function(e,n){1&Si(n,1)[0]&&(t.innerHTML=e[0]);},i:Ki,o:Ki,d:function(e){e&&So(t);}}}function i$(e,t,n){var r=870711;var i="",o=t.data;function a(e){if(!e||!e.raw)return "";var t=e.raw,n={};return t=t.replace(/\s(?:xml:)?id=["']?([^"')\s]+)/g,(function(e,t){var i="fa-".concat((r+=1).toString(16));return n[t]=i,' id="'.concat(i,'"')})),t=t.replace(/#(?:([^'")\s]+)|xpointer\(id\((['"]?)([^')]+)\2\)\))/g,(function(e,t,r,i){var o=t||i;return o&&n[o]?"#".concat(n[o]):e})),t}return e.$$set=function(e){"data"in e&&n(1,o=e.data);},e.$$.update=function(){2&e.$$.dirty&&n(0,i=a(o));},[i,o]}var o$=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,i$,r$,to,{data:1}),r}return qi(n)}();function a$(e){bo(e,"svelte-1mc5hvj",".fa-icon.svelte-1mc5hvj{display:inline-block;fill:currentColor}.fa-flip-horizontal.svelte-1mc5hvj{transform:scale(-1, 1)}.fa-flip-vertical.svelte-1mc5hvj{transform:scale(1, -1)}.fa-spin.svelte-1mc5hvj{animation:svelte-1mc5hvj-fa-spin 1s 0s infinite linear}.fa-inverse.svelte-1mc5hvj{color:#fff}.fa-pulse.svelte-1mc5hvj{animation:svelte-1mc5hvj-fa-spin 1s infinite steps(8)}@keyframes svelte-1mc5hvj-fa-spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}");}function s$(e){for(var t,n,r,i,o=e[12].default,a=ro(o,e,e[11],null),s=[{version:"1.1"},{class:n="fa-icon "+e[0]},{width:e[1]},{height:e[2]},{"aria-label":e[9]},{role:r=e[9]?"img":"presentation"},{viewBox:e[3]},{style:e[8]},e[10]],c={},u=0;u<s.length;u+=1)c=Qi(c,s[u]);return {c:function(){t=_o("svg"),a&&a.c(),Io(t,c),Fo(t,"fa-spin",e[4]),Fo(t,"fa-pulse",e[6]),Fo(t,"fa-inverse",e[5]),Fo(t,"fa-flip-horizontal","horizontal"===e[7]),Fo(t,"fa-flip-vertical","vertical"===e[7]),Fo(t,"svelte-1mc5hvj",!0);},m:function(e,n){jo(e,t,n),a&&a.m(t,null),i=!0;},p:function(e,u){var l=Si(u,1)[0];a&&a.p&&(!i||2048&l)&&ao(a,o,e,e[11],i?oo(o,e[11],l,null):so(e[11]),null),Io(t,c=Ra(s,[{version:"1.1"},(!i||1&l&&n!==(n="fa-icon "+e[0]))&&{class:n},(!i||2&l)&&{width:e[1]},(!i||4&l)&&{height:e[2]},(!i||512&l)&&{"aria-label":e[9]},(!i||512&l&&r!==(r=e[9]?"img":"presentation"))&&{role:r},(!i||8&l)&&{viewBox:e[3]},(!i||256&l)&&{style:e[8]},1024&l&&e[10]])),Fo(t,"fa-spin",e[4]),Fo(t,"fa-pulse",e[6]),Fo(t,"fa-inverse",e[5]),Fo(t,"fa-flip-horizontal","horizontal"===e[7]),Fo(t,"fa-flip-vertical","vertical"===e[7]),Fo(t,"svelte-1mc5hvj",!0);},i:function(e){i||($a(a,e),i=!0);},o:function(e){_a(a,e),i=!1;},d:function(e){e&&So(t),a&&a.d(e);}}}function c$(e,t,n){var r=["class","width","height","box","spin","inverse","pulse","flip","style","label"],i=uo(t,r),o=t,a=o.$$slots,s=void 0===a?{}:a,c=o.$$scope,u=t.class,l=void 0===u?"":u,f=t.width,h=t.height,d=t.box,v=void 0===d?"0 0 0 0":d,p=t.spin,m=void 0!==p&&p,g=t.inverse,y=void 0!==g&&g,b=t.pulse,w=void 0!==b&&b,x=t.flip,k=void 0===x?"none":x,j=t.style,S=void 0===j?"":j,C=t.label,$=void 0===C?"":C;return e.$$set=function(e){t=Qi(Qi({},t),co(e)),n(10,i=uo(t,r)),"class"in e&&n(0,l=e.class),"width"in e&&n(1,f=e.width),"height"in e&&n(2,h=e.height),"box"in e&&n(3,v=e.box),"spin"in e&&n(4,m=e.spin),"inverse"in e&&n(5,y=e.inverse),"pulse"in e&&n(6,w=e.pulse),"flip"in e&&n(7,k=e.flip),"style"in e&&n(8,S=e.style),"label"in e&&n(9,$=e.label),"$$scope"in e&&n(11,c=e.$$scope);},[l,f,h,v,m,y,w,k,S,$,i,c,s]}var u$=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,c$,s$,to,{class:0,width:1,height:2,box:3,spin:4,inverse:5,pulse:6,flip:7,style:8,label:9},a$),r}return qi(n)}();function l$(e,t,n){var r=e.slice();return r[24]=t[n],r}function f$(e,t,n){var r=e.slice();return r[27]=t[n],r}function h$(e){var t,n,r,i,o=e[6].paths&&d$(e),a=e[6].polygons&&p$(e),s=e[6].raw&&g$(e);return {c:function(){o&&o.c(),t=Mo(),a&&a.c(),n=Mo(),s&&s.c(),r=Eo();},m:function(e,c){o&&o.m(e,c),jo(e,t,c),a&&a.m(e,c),jo(e,n,c),s&&s.m(e,c),jo(e,r,c),i=!0;},p:function(e,i){e[6].paths?o?o.p(e,i):((o=d$(e)).c(),o.m(t.parentNode,t)):o&&(o.d(1),o=null),e[6].polygons?a?a.p(e,i):((a=p$(e)).c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null),e[6].raw?s?(s.p(e,i),64&i&&$a(s,1)):((s=g$(e)).c(),$a(s,1),s.m(r.parentNode,r)):s&&(Sa(),_a(s,1,1,(function(){s=null;})),Ca());},i:function(e){i||($a(s),i=!0);},o:function(e){_a(s),i=!1;},d:function(e){o&&o.d(e),e&&So(t),a&&a.d(e),e&&So(n),s&&s.d(e),e&&So(r);}}}function d$(e){for(var t,n=e[6].paths,r=[],i=0;i<n.length;i+=1)r[i]=v$(f$(e,n,i));return {c:function(){for(var e=0;e<r.length;e+=1)r[e].c();t=Eo();},m:function(e,n){for(var i=0;i<r.length;i+=1)r[i]&&r[i].m(e,n);jo(e,t,n);},p:function(e,i){if(64&i){var o;for(n=e[6].paths,o=0;o<n.length;o+=1){var a=f$(e,n,o);r[o]?r[o].p(a,i):(r[o]=v$(a),r[o].c(),r[o].m(t.parentNode,t));}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length;}},d:function(e){Co(r,e),e&&So(t);}}}function v$(e){for(var t,n=[e[27]],r={},i=0;i<n.length;i+=1)r=Qi(r,n[i]);return {c:function(){Io(t=_o("path"),r);},m:function(e,n){jo(e,t,n);},p:function(e,i){Io(t,r=Ra(n,[64&i&&e[27]]));},d:function(e){e&&So(t);}}}function p$(e){for(var t,n=e[6].polygons,r=[],i=0;i<n.length;i+=1)r[i]=m$(l$(e,n,i));return {c:function(){for(var e=0;e<r.length;e+=1)r[e].c();t=Eo();},m:function(e,n){for(var i=0;i<r.length;i+=1)r[i]&&r[i].m(e,n);jo(e,t,n);},p:function(e,i){if(64&i){var o;for(n=e[6].polygons,o=0;o<n.length;o+=1){var a=l$(e,n,o);r[o]?r[o].p(a,i):(r[o]=m$(a),r[o].c(),r[o].m(t.parentNode,t));}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length;}},d:function(e){Co(r,e),e&&So(t);}}}function m$(e){for(var t,n=[e[24]],r={},i=0;i<n.length;i+=1)r=Qi(r,n[i]);return {c:function(){Io(t=_o("polygon"),r);},m:function(e,n){jo(e,t,n);},p:function(e,i){Io(t,r=Ra(n,[64&i&&e[24]]));},d:function(e){e&&So(t);}}}function g$(e){var t,n,r;function i(t){e[16](t);}var o={};return void 0!==e[6]&&(o.data=e[6]),t=new o$({props:o}),sa.push((function(){return Ia(t,"data",i)})),{c:function(){Da(t.$$.fragment);},m:function(e,n){La(t,e,n),r=!0;},p:function(e,r){var i={};!n&&64&r&&(n=!0,i.data=e[6],pa((function(){return n=!1}))),t.$set(i);},i:function(e){r||($a(t.$$.fragment,e),r=!0);},o:function(e){_a(t.$$.fragment,e),r=!1;},d:function(e){Ba(t,e);}}}function y$(e){var t,n=e[15].default,r=ro(n,e,e[17],null),i=r||function(e){var t,n,r=e[6]&&h$(e);return {c:function(){r&&r.c(),t=Eo();},m:function(e,i){r&&r.m(e,i),jo(e,t,i),n=!0;},p:function(e,n){e[6]?r?(r.p(e,n),64&n&&$a(r,1)):((r=h$(e)).c(),$a(r,1),r.m(t.parentNode,t)):r&&(Sa(),_a(r,1,1,(function(){r=null;})),Ca());},i:function(e){n||($a(r),n=!0);},o:function(e){_a(r),n=!1;},d:function(e){r&&r.d(e),e&&So(t);}}}(e);return {c:function(){i&&i.c();},m:function(e,n){i&&i.m(e,n),t=!0;},p:function(e,o){r?r.p&&(!t||131072&o)&&ao(r,n,e,e[17],t?oo(n,e[17],o,null):so(e[17]),null):i&&i.p&&(!t||64&o)&&i.p(e,t?o:-1);},i:function(e){t||($a(i,e),t=!0);},o:function(e){_a(i,e),t=!1;},d:function(e){i&&i.d(e);}}}function b$(e){for(var t,n,r=[{label:e[5]},{width:e[7]},{height:e[8]},{box:e[10]},{style:e[9]},{spin:e[1]},{flip:e[4]},{inverse:e[2]},{pulse:e[3]},{class:e[0]},e[11]],i={$$slots:{default:[y$]},$$scope:{ctx:e}},o=0;o<r.length;o+=1)i=Qi(i,r[o]);return t=new u$({props:i}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var i=Si(n,1)[0],o=4031&i?Ra(r,[32&i&&{label:e[5]},128&i&&{width:e[7]},256&i&&{height:e[8]},1024&i&&{box:e[10]},512&i&&{style:e[9]},2&i&&{spin:e[1]},16&i&&{flip:e[4]},4&i&&{inverse:e[2]},8&i&&{pulse:e[3]},1&i&&{class:e[0]},2048&i&&Na(e[11])]):{};131136&i&&(o.$$scope={dirty:i,ctx:e}),t.$set(o);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function w$(e,t,n){var r,i,o,a=["class","data","scale","spin","inverse","pulse","flip","label","style"],s=uo(t,a),c=t,u=c.$$slots,l=void 0===u?{}:u,f=c.$$scope,h=t.class,d=void 0===h?"":h,v=t.data,p=t.scale,m=void 0===p?1:p,g=t.spin,y=void 0!==g&&g,b=t.inverse,w=void 0!==b&&b,x=t.pulse,k=void 0!==x&&x,j=t.flip,S=void 0===j?void 0:j,C=t.label,$=void 0===C?"":C,_=t.style,O=void 0===_?"":_,M=10,E=10;function A(){var e=1;return void 0!==m&&(e=Number(m)),isNaN(e)||e<=0?(console.warn('Invalid prop: prop "scale" should be a number over 0.'),1):1*e}function P(){return r?Math.max(r.width,r.height)/16:1}return e.$$set=function(e){t=Qi(Qi({},t),co(e)),n(11,s=uo(t,a)),"class"in e&&n(0,d=e.class),"data"in e&&n(12,v=e.data),"scale"in e&&n(13,m=e.scale),"spin"in e&&n(1,y=e.spin),"inverse"in e&&n(2,w=e.inverse),"pulse"in e&&n(3,k=e.pulse),"flip"in e&&n(4,S=e.flip),"label"in e&&n(5,$=e.label),"style"in e&&n(14,O=e.style),"$$scope"in e&&n(17,f=e.$$scope);},e.$$.update=function(){28672&e.$$.dirty&&(n(6,r=function(e){var t;if(e){if(!("definition"in e)){if("iconName"in e&&"icon"in e){e.iconName;var n=Si(e.icon,5),r=n[0],i=n[1],o=n[4];t={width:r,height:i,paths:(Array.isArray(o)?o:[o]).map((function(e){return {d:e}}))};}else t=e[Object.keys(e)[0]];return t}console.error("`import faIconName from '@fortawesome/package-name/faIconName` not supported - Please use `import { faIconName } from '@fortawesome/package-name/faIconName'` instead");}}(v)),n(7,M=r?r.width/P()*A():0),n(8,E=r?r.height/P()*A():0),n(9,i=function(){var e="";null!==O&&(e+=O);var t=A();return 1===t?0===e.length?"":e:(""===e||e.endsWith(";")||(e+="; "),"".concat(e,"font-size: ").concat(t,"em"))}()),n(10,o=r?"0 0 ".concat(r.width," ").concat(r.height):"0 0 ".concat(M," ").concat(E)));},[d,y,w,k,S,$,r,M,E,i,o,s,v,m,O,l,function(e){n(6,r=e),n(12,v),n(14,O),n(13,m);},f]}var x$=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,w$,b$,to,{class:0,data:12,scale:13,spin:1,inverse:2,pulse:3,flip:4,label:5,style:14}),r}return qi(n)}();function k$(e){bo(e,"svelte-1vj58yv",".jse-boolean-toggle.svelte-1vj58yv{padding:0;margin:1px 0 0;vertical-align:top;display:inline-flex;color:var(--jse-value-color-boolean)}.jse-boolean-toggle.svelte-1vj58yv:not(.jse-readonly){cursor:pointer}");}function j$(e){var t,n,r,i,o,a;return n=new x$({props:{data:!0===e[0]?e$:t$}}),{c:function(){t=$o("div"),Da(n.$$.fragment),Ro(t,"class","jse-boolean-toggle svelte-1vj58yv"),Ro(t,"title",r=e[1]?"Boolean value ".concat(e[0]):"Click to toggle this boolean value"),Fo(t,"jse-readonly",e[1]);},m:function(r,s){jo(r,t,s),La(n,t,null),i=!0,o||(a=Ao(t,"mousedown",e[2]),o=!0);},p:function(e,o){var a=Si(o,1)[0],s={};1&a&&(s.data=!0===e[0]?e$:t$),n.$set(s),(!i||3&a&&r!==(r=e[1]?"Boolean value ".concat(e[0]):"Click to toggle this boolean value"))&&Ro(t,"title",r),(!i||2&a)&&Fo(t,"jse-readonly",e[1]);},i:function(e){i||($a(n.$$.fragment,e),i=!0);},o:function(e){_a(n.$$.fragment,e),i=!1;},d:function(e){e&&So(t),Ba(n),o=!1,a();}}}function S$(e,t,n){var r=t.path,i=t.value,o=t.readOnly,a=t.onPatch,s=t.focus;return e.$$set=function(e){"path"in e&&n(3,r=e.path),"value"in e&&n(0,i=e.value),"readOnly"in e&&n(1,o=e.readOnly),"onPatch"in e&&n(4,a=e.onPatch),"focus"in e&&n(5,s=e.focus);},[i,o,function(e){e.stopPropagation(),o||(a([{op:"replace",path:Ys(r),value:!i}]),setTimeout(s));},r,a,s]}var C$=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,S$,j$,no,{path:3,value:0,readOnly:1,onPatch:4,focus:5},k$),r}return qi(n)}();function $$(e){bo(e,"svelte-1gn8yt9",".jse-color-picker-popup.svelte-1gn8yt9 .picker_wrapper.popup,.jse-color-picker-popup.svelte-1gn8yt9 .picker_wrapper.popup .picker_arrow::before,.jse-color-picker-popup.svelte-1gn8yt9 .picker_wrapper.popup .picker_arrow::after{background:var(--jse-color-picker-background);line-height:normal}.jse-color-picker-popup.svelte-1gn8yt9 .picker_slider,.jse-color-picker-popup.svelte-1gn8yt9 .picker_sl,.jse-color-picker-popup.svelte-1gn8yt9 .picker_editor input,.jse-color-picker-popup.svelte-1gn8yt9 .picker_sample,.jse-color-picker-popup.svelte-1gn8yt9 .picker_done button{box-shadow:var(--jse-color-picker-border-box-shadow)}.jse-color-picker-popup.svelte-1gn8yt9 .picker_editor input{background:var(--jse-background-color);color:var(--jse-text-color)}.jse-color-picker-popup.svelte-1gn8yt9 .picker_done button{background:var(--jse-button-background);color:var(--jse-button-color)}.jse-color-picker-popup.svelte-1gn8yt9 .picker_done button:hover{background:var(--jse-button-background-highlight)}");}function _$(e){var t;return {c:function(){Ro(t=$o("div"),"class","jse-color-picker-popup svelte-1gn8yt9");},m:function(n,r){jo(n,t,r),e[4](t);},p:Ki,i:Ki,o:Ki,d:function(n){n&&So(t),e[4](null);}}}function O$(e,t,n){var r,i,o=t.color,a=t.onChange,s=t.showOnTop;return ea(ji(xi().mark((function e(){var t,n;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then((function(){return w6}));case 2:if(e.t1=t=e.sent,e.t0=null===e.t1,e.t0){e.next=6;break}e.t0=void 0===t;case 6:if(!e.t0){e.next=10;break}e.t2=void 0,e.next=11;break;case 10:e.t2=t.default;case 11:n=e.t2,i=new n({parent:r,color:o,popup:s?"top":"bottom",onDone:function(e){var t=1===e.rgba[3]?e.hex.substring(0,7):e.hex;a(t);}}),i.show();case 14:case"end":return e.stop()}}),e)})))),ta((function(){i&&i.destroy();})),e.$$set=function(e){"color"in e&&n(1,o=e.color),"onChange"in e&&n(2,a=e.onChange),"showOnTop"in e&&n(3,s=e.showOnTop);},[r,o,a,s,function(e){sa[e?"unshift":"push"]((function(){n(0,r=e);}));}]}var M$=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,O$,_$,to,{color:1,onChange:2,showOnTop:3},$$),r}return qi(n)}();function E$(e){bo(e,"svelte-1nv0s05",".jse-color-picker-button.svelte-1nv0s05{font-size:var(--jse-font-size-mono);width:var(--jse-color-picker-button-size);height:var(--jse-color-picker-button-size);box-sizing:border-box;padding:0;margin:2px 0 0;display:inline-flex;vertical-align:top;border:1px solid var(--jse-text-color);border-radius:2px;background:inherit;outline:none}.jse-color-picker-button.svelte-1nv0s05:not(.jse-readonly){cursor:pointer}");}function A$(e){var t,n,r,i;return {c:function(){Ro(t=$o("button"),"type","button"),Ro(t,"class","jse-color-picker-button svelte-1nv0s05"),zo(t,"background",e[2]),Ro(t,"title",n=e[1]?"Color ".concat(e[0]):"Click to open a color picker"),Fo(t,"jse-readonly",e[1]);},m:function(n,o){jo(n,t,o),r||(i=Ao(t,"click",e[3]),r=!0);},p:function(e,r){var i=Si(r,1)[0];4&i&&zo(t,"background",e[2]),3&i&&n!==(n=e[1]?"Color ".concat(e[0]):"Click to open a color picker")&&Ro(t,"title",n),2&i&&Fo(t,"jse-readonly",e[1]);},i:Ki,o:Ki,d:function(e){e&&So(t),r=!1,i();}}}function P$(e,t,n){var r,i=ia("absolute-popup").openAbsolutePopup,o=t.path,a=t.value,s=t.readOnly,c=t.onPatch,u=t.focus;function l(e){c([{op:"replace",path:Ys(o),value:e}]),f();}function f(){u();}return e.$$set=function(e){"path"in e&&n(4,o=e.path),"value"in e&&n(0,a=e.value),"readOnly"in e&&n(1,s=e.readOnly),"onPatch"in e&&n(5,c=e.onPatch),"focus"in e&&n(6,u=e.focus);},e.$$.update=function(){1&e.$$.dirty&&n(2,r=pu(a));},[a,s,r,function(e){if(!s){var t=e.target.getBoundingClientRect().top,n=wC(e.target).innerHeight;i(M$,{color:a,onChange:l,showOnTop:n-t<300&&t>300},{anchor:e.target,closeOnOuterClick:!0,onClose:f,offsetTop:18,offsetLeft:-8,height:300});}},o,c,u]}var T$=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,P$,A$,no,{path:4,value:0,readOnly:1,onPatch:5,focus:6},E$),r}return qi(n)}();function R$(e){for(var t=Xx(e,(function(e){return e.start})),n=[t[0]],r=0;r<t.length;r++){var i=n.length-1,o=n[i],a=t[r];a.start<=o.end?n[i]={start:Math.min(o.start,a.start),end:Math.max(o.end,a.end)}:n.push(a);}return n}function N$(e,t){return e.some((function(e){return t>=e.start&&t<e.end}))}function I$(e){return D$(e)+100}function D$(e){return 100*Math.floor(e/100)}function L$(e){var t={expandedMap:{},enforceStringMap:{},visibleSectionsMap:{},selection:void 0,sortedColumn:void 0};return null!=e&&e.select&&void 0!==e.json&&(t=Oi(Oi({},t),{},{selection:e.select(e.json,t)})),null!=e&&e.expand&&(t=F$(e.json,t,[],e.expand)),t}function B$(e,t){return e.visibleSectionsMap[t]||ds}function z$(e,t,n){t.forEach((function(t){var r=t.start,i=t.end;MS$1(r,Math.min(e.length,i),n);}));}function q$(e,t,n){for(var r=Oi({},t.expandedMap),i=Oi({},t.visibleSectionsMap),o=0;o<=n.length;o++){var a=n.slice(0,o),s=Ys(a),c=Vs(e,a);if(du(c)&&(r[s]=!0),Array.isArray(c)&&o<n.length){var u=i[s]||ds,l=uu(n[o]);if(!N$(u,l)){var f=D$(l),h={start:f,end:I$(f)};i[s]=R$(u.concat(h));}}}return Oi(Oi({},t),{},{expandedMap:r,visibleSectionsMap:i})}function F$(e,t,n,r){var i=Oi({},t.expandedMap);var o=n.slice(),a=void 0!==e?Vs(e,n):e;return void 0!==a&&function e(n){var a=o.length;if(Array.isArray(n)){if(r(o)){var s=Ys(o);if(i[s]=!0,n.length>0){var c=B$(t,s);z$(n,c,(function(t){o[a]=String(t),e(n[t]);})),o.pop();}}}else if(hu(n)&&r(o)){i[Ys(o)]=!0;var u=Object.keys(n);if(u.length>0){var l,f=wi(u);try{for(f.s();!(l=f.n()).done;){var h=l.value;o[a]=h,e(n[h]);}}catch(e){f.e(e);}finally{f.f();}o.pop();}}}(a),Oi(Oi({},t),{},{expandedMap:i})}function V$(e,t){return Oi(Oi({},e),{},{expandedMap:Oi(Oi({},e.expandedMap),{},Mi({},Ys(t),!0))})}function W$(e,t){var n=G$(e.expandedMap,t),r=G$(e.enforceStringMap,t),i=G$(e.visibleSectionsMap,t);return Oi(Oi({},e),{},{expandedMap:n,enforceStringMap:r,visibleSectionsMap:i})}function H$(e,t,n){if(n){var r=Oi({},e.enforceStringMap);return r[t]=n,Oi(Oi({},e),{},{enforceStringMap:r})}if("boolean"==typeof e.enforceStringMap[t]){var i=Oi({},e.enforceStringMap);return delete i[t],Oi(Oi({},e),{},{enforceStringMap:i})}return e}function U$(e,t,n){var r=tc(e,n),i=n.reduce((function(e,t){return Ms(t)?J$(r,e,t):Es(t)?K$(r,e,t):As(t)?function(e,t,n){var r=n.path,i=e_(e,t.expandedMap),o=e_(e,t.enforceStringMap),a=e_(e,t.visibleSectionsMap);Os(n.value)||_s(n.value)||delete i[r];_s(n.value)||delete a[r];(Os(n.value)||_s(n.value))&&delete o[r];return Oi(Oi({},t),{},{expandedMap:i,enforceStringMap:o,visibleSectionsMap:a})}(r,e,t):Ps(t)||Ts(t)?function(e,t,n){if(Ts(n)&&n.from===n.path)return t;var r=function(e){return n.path+e.substring(n.from.length)},i=X$(Q$(t.expandedMap,n.from),r),o=X$(Q$(t.enforceStringMap,n.from),r),a=X$(Q$(t.visibleSectionsMap,n.from),r),s=t;Ts(n)&&(s=K$(e,s,{op:"remove",path:n.from}));var c=Y$((s=J$(e,s,{op:"add",path:n.path,value:null})).expandedMap,i),u=Y$(s.enforceStringMap,o),l=Y$(s.visibleSectionsMap,a);return Oi(Oi({},t),{},{expandedMap:c,enforceStringMap:u,visibleSectionsMap:l})}(r,e,t):e}),t);return {json:r,documentState:i}}function J$(e,t,n){var r=lc(e,n.path),i=ly(r),o=Ys(i);if(_s(Vs(e,i))){var a=uu(Em(r)),s=Z$(t.expandedMap,i,a,1),c=Z$(t.enforceStringMap,i,a,1),u=Z$(t.visibleSectionsMap,i,a,1);return u=t_(u,o,(function(e){return n_(e,a,1)})),Oi(Oi({},t),{},{expandedMap:s,enforceStringMap:c,visibleSectionsMap:u})}return t}function K$(e,t,n){var r=lc(e,n.path),i=ly(r),o=Ys(i),a=Vs(e,i),s=t.expandedMap,c=t.enforceStringMap,u=t.visibleSectionsMap;if(s=G$(s,r),c=G$(c,r),u=G$(u,r),_s(a)){var l=uu(Em(r));s=Z$(s,i,l,-1),c=Z$(c,i,l,-1),u=t_(u=Z$(u,i,l,-1),o,(function(e){return n_(e,l,-1)}));}return Oi(Oi({},t),{},{expandedMap:s,enforceStringMap:c,visibleSectionsMap:u})}function G$(e,t){var n={},r=Ys(t);return Object.keys(e).forEach((function(t){ec(t,r)||(n[t]=e[t]);})),n}function Q$(e,t){var n={};return Object.keys(e).forEach((function(r){ec(r,t)&&(n[r]=e[r]);})),n}function Y$(e,t){return Oi(Oi({},e),t)}function X$(e,t){var n={};return Object.keys(e).forEach((function(r){var i=t(r);n[i]=e[r];})),n}function Z$(e,t,n,r){for(var i=t.length,o=Ys(t),a=[],s=0,c=Object.keys(e);s<c.length;s++){var u=c[s];if(ec(u,o)){var l=Qs(u),f=uu(l[i]);f>=n&&(l[i]=String(f+r),a.push({oldPointer:u,newPointer:Ys(l),value:e[u]}));}}if(0===a.length)return e;var h=Oi({},e);return a.forEach((function(e){delete h[e.oldPointer];})),a.forEach((function(e){h[e.newPointer]=e.value;})),h}function e_(e,t){var n={};return Object.keys(t).filter((function(t){return Gs(e,lc(e,t))})).forEach((function(e){n[e]=t[e];})),n}function t_(e,t,n){var r=e[t];if(t in e){var i=n(r);if(!zy(r,i)){var o=Oi({},e);return void 0===i?delete o[t]:o[t]=i,o}}return e}function n_(e,t,n){return e.map((function(e){return {start:e.start>t?e.start+n:e.start,end:e.end>=t?e.end+n:e.end}}))}function r_(e,t,n,r){var i=t?t[n]:void 0;return "boolean"==typeof i?i:function(e,t){return "string"==typeof e&&"string"!=typeof bu(e,t)}(e,r)}function i_(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.indexOf(t);return -1!==r?n?e.slice(r):e.slice(r+1):[]}function o_(e,t){var n=[];return function e(r,i){n.push(i);var o=Ys(i);if(r&&!0===t.expandedMap[o]){if(_s(r)){var a=B$(t,o);z$(r,a,(function(t){e(r[t],i.concat(String(t)));}));}Os(r)&&Object.keys(r).forEach((function(t){e(r[t],i.concat(t));}));}}(e,[]),n}function a_(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];function i(e,o){r.push({path:o,type:cs.value});var a=Ys(o);if(e&&!0===t.expandedMap[a]){if(n&&r.push({path:o,type:cs.inside}),_s(e)){var s=B$(t,a);z$(e,s,(function(t){var a=o.concat(String(t));i(e[t],a),n&&r.push({path:a,type:cs.after});}));}if(Os(e))Object.keys(e).forEach((function(t){var a=o.concat(t);r.push({path:a,type:cs.key}),i(e[t],a),n&&r.push({path:a,type:cs.after});}));}}return i(e,[]),r}function s_(e,t,n){var r=o_(e,t),i=r.map(Ys),o=Ys(n),a=i.indexOf(o);return -1!==a&&a>0?r[a-1]:null}function c_(e,t,n){var r=o_(e,t),i=r.map(Ys).indexOf(Ys(n));return -1!==i&&i<r.length-1?r[i+1]:null}function u_(e,t,n){var r=Vs(e,n);return void 0===r?t:F$(e,t,n,!KS({json:r},10240)?f_:l_)}function l_(e){return 0===e.length||1===e.length&&"0"===e[0]}function f_(){return !0}function h_(e){return e&&e.type===ss.after||!1}function d_(e){return e&&e.type===ss.inside||!1}function v_(e){return e&&e.type===ss.key||!1}function p_(e){return e&&e.type===ss.value||!1}function m_(e){return e&&e.type===ss.multi||!1}function g_(e){return d_(e)?e.focusPath:ly(e.focusPath)}function y_(e){return m_(e)?jg(e.paths):e.focusPath}function b_(e){return m_(e)?Em(e.paths):e.focusPath}function w_(e,t){return E_(e.focusPath,t)&&(e.focusPath.length>t.length||d_(e))}function x_(e,t,n){if(!e)return !1;var r=t.slice(0);if(m_(e))for(;r.length>0;){if(!0===e.pointersMap[Ys(r)])return !0;r.pop();}if(v_(e))return n===ss.key&&zy(e.focusPath,t);if(p_(e)){if(n===ss.value&&zy(e.focusPath,t))return !0;if(E_(t,e.focusPath)&&t.length>e.focusPath.length&&(n===ss.key||n===ss.value||n===ss.multi))return !0}return !1}function k_(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t.selection;if(!i)return null;var o=!r&&m_(i)?jg(i.paths):i.focusPath,a=s_(e,t,o);if(null===a)return null;var s=a,c=a;if(n)return h_(i)||d_(i)?I_(e,i.anchorPath,i.anchorPath):I_(e,i.anchorPath,c);if(v_(i)){var u=ly(a),l=Vs(e,u);return Array.isArray(l)||By(a)?T_(a,!1):P_(a,!1)}return p_(i)?T_(a,!1):h_(i)||d_(i)?I_(e,o,o):I_(e,s,c)}function j_(e,t,n){var r=t.selection;if(!r)return {caret:null,previous:null,next:null};var i=a_(e,t,n),o=i.findIndex((function(e){return zy(e.path,r.focusPath)&&String(e.type)===String(r.type)}));return {caret:-1!==o?i[o]:null,previous:-1!==o&&o>0?i[o-1]:null,next:-1!==o&&o<i.length-1?i[o+1]:null}}function S_(e,t){for(var n=o_(e,t),r=0;r<n.length-1&&n[r+1].length>n[r].length;)r++;var i=n[r];return 0===i.length||Array.isArray(Vs(e,ly(i)))?T_(i,!1):P_(i,!1)}function C_(e,t){if(1===t.length){var n=jg(t);if("replace"===n.op||"move"===n.op)return T_(lc(e,n.path),!1)}if(!By(t)&&t.every((function(e){return "move"===e.op}))){var r=jg(t),i=t.slice(1);if((Ps(r)||Ts(r))&&r.from!==r.path&&i.every((function(e){return (Ps(e)||Ts(e))&&e.from===e.path})))return P_(lc(e,r.path),!1)}var o=t.filter((function(e){return "test"!==e.op&&"remove"!==e.op&&("move"!==e.op||e.from!==e.path)&&"string"==typeof e.path})).map((function(t){return lc(e,t.path)}));if(!By(o))return {type:ss.multi,paths:o,anchorPath:jg(o),focusPath:Em(o),pointersMap:$_(o)}}function $_(e){var t={};return e.forEach((function(e){t[Ys(e)]=!0;})),t}function __(e){return Mi({},Ys(e),!0)}function O_(e){return void 0!==e&&(v_(e)||p_(e)||m_(e)&&1===e.paths.length)}function M_(e,t){return O_(t)&&du(Vs(e,t.focusPath))?t.focusPath:ly(t.focusPath)}function E_(e,t){if(e.length<t.length)return !1;for(var n=0;n<t.length;n++)if(e[n]!==t[n])return !1;return !0}function A_(e){var t=e.selection;return (v_(t)||p_(t))&&t.edit?Oi(Oi({},e),{},{selection:Oi(Oi({},t),{},{edit:!1})}):e}function P_(e,t){return {type:ss.key,anchorPath:e,focusPath:e,pointersMap:__(e),edit:t}}function T_(e,t){return {type:ss.value,anchorPath:e,focusPath:e,pointersMap:__(e),edit:t}}function R_(e){return {type:ss.inside,anchorPath:e,focusPath:e,pointersMap:__(e)}}function N_(e){return {type:ss.after,anchorPath:e,focusPath:e,pointersMap:__(e)}}function I_(e,t,n){var r=function(e,t,n){if(zy(t,n))return [t];var r=function(e,t){for(var n=0;n<e.length&&n<t.length&&e[n]===t[n];)n++;return e.slice(0,n)}(t,n);if(t.length===r.length||n.length===r.length)return [r];var i=t[r.length],o=n[r.length],a=Vs(e,r);if(Os(a)){var s=Object.keys(a),c=s.indexOf(i),u=s.indexOf(o);if(-1!==c&&-1!==u){for(var l=Math.min(c,u),f=Math.max(c,u),h=[],d=l;d<=f;d++)h.push(r.concat(s[d]));return h}}if(_s(a)){for(var v=Math.min(uu(i),uu(o)),p=Math.max(uu(i),uu(o)),m=[],g=v;g<=p;g++)m.push(r.concat(String(g)));return m}throw new Error("Failed to create selection")}(e,t,n),i=E_(n,Em(r))||E_(t,jg(r));return {type:ss.multi,anchorPath:i?jg(r):Em(r),focusPath:i?Em(r):jg(r),paths:r,pointersMap:$_(r)}}function D_(e,t,n,r){if(v_(t))return String(Em(t.focusPath));if(p_(t)){var i=Vs(e,t.focusPath);return "string"==typeof i?i:r.stringify(i,null,n)}if(m_(t)){if(By(t.focusPath))return r.stringify(e,null,n);var o=g_(t),a=Vs(e,o);if(Array.isArray(a)){if(1===t.paths.length){var s=Vs(e,jg(t.paths)||[]);return r.stringify(s,null,n)}return t.paths.map((function(t){var i=Vs(e,t);return "".concat(r.stringify(i,null,n),",")})).join("\n")}return t.paths.map((function(t){var i=Em(t),o=Vs(e,t);return "".concat(r.stringify(i),": ").concat(r.stringify(o,null,n),",")})).join("\n")}return null}function L_(e){return m_(e)?e.paths:[e.focusPath]}function B_(e){return (v_(e)||p_(e))&&!0===e.edit}function z_(e){return m_(e)||v_(e)||p_(e)}function q_(e){return !(!v_(e)&&!p_(e))||!(!m_(e)||1!==e.paths.length)}function F_(e){switch(e.type){case cs.key:return P_(e.path,!1);case cs.value:return T_(e.path,!1);case cs.after:return N_(e.path);case cs.inside:return R_(e.path)}}function V_(e,t,n){switch(t){case ss.key:return P_(n,!1);case ss.value:return T_(n,!1);case ss.after:return N_(n);case ss.inside:return R_(n);case ss.multi:return I_(e,n,n)}}function W_(e,t){if(e)return Object.keys(e.pointersMap).some((function(e){return ec(e,t)||ec(t,e)}))?e:void 0}function H_(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];if("string"==typeof a&&e.push(a),a&&"object"===Ji(a))for(var s in a)Object.hasOwnProperty.call(a,s)&&a[s]&&e.push(s);}return e.join(" ")}function U_(e,t){return H_("jse-value","jse-"+mu(e,t),{"jse-url":yu(e),"jse-empty":"string"==typeof e&&0===e.length})}function J_(e){bo(e,"svelte-1iltvlj",".jse-value.jse-string.svelte-1iltvlj{color:var(--jse-value-color-string)}.jse-value.jse-object.svelte-1iltvlj,.jse-value.jse-array.svelte-1iltvlj{min-width:16px;color:var(--jse-delimiter-color)}.jse-value.jse-number.svelte-1iltvlj{color:var(--jse-value-color-number)}.jse-value.jse-boolean.svelte-1iltvlj{color:var(--jse-value-color-boolean)}.jse-value.jse-null.svelte-1iltvlj{color:var(--jse-value-color-null)}.jse-value.jse-invalid.svelte-1iltvlj{color:var(--jse-text-color)}.jse-value.jse-url.svelte-1iltvlj{color:var(--jse-value-color-url);text-decoration:underline}div.jse-editable-div.svelte-1iltvlj{min-width:2em;padding:0 5px;box-sizing:border-box;outline:none;border-radius:1px;vertical-align:top;cursor:text !important;word-break:normal;white-space:pre-wrap;overflow-wrap:anywhere}div.jse-editable-div.jse-short-text.svelte-1iltvlj{overflow-wrap:normal}div.jse-editable-div[contenteditable=true].svelte-1iltvlj{outline:var(--jse-edit-outline);background:inherit !important;position:relative;border-radius:0;z-index:3}div.jse-editable-div.jse-empty.svelte-1iltvlj:not(:focus){outline:1px dotted var(--jse-tag-background);-moz-outline-radius:2px}div.jse-editable-div.jse-empty.svelte-1iltvlj::after{pointer-events:none;color:var(--jse-tag-background)}");}function K_(e){var t,n,r,i;return {c:function(){Ro(t=$o("div"),"class",n=lo(H_("jse-editable-div",e[2],{"jse-short-text":e[0]}))+" svelte-1iltvlj"),Ro(t,"contenteditable","true"),Ro(t,"spellcheck","false");},m:function(n,o){jo(n,t,o),e[13](t),r||(i=[Ao(t,"input",e[3]),Ao(t,"keydown",e[4]),Ao(t,"paste",e[5]),Ao(t,"blur",e[6])],r=!0);},p:function(e,r){5&Si(r,1)[0]&&n!==(n=lo(H_("jse-editable-div",e[2],{"jse-short-text":e[0]}))+" svelte-1iltvlj")&&Ro(t,"class",n);},i:Ki,o:Ki,d:function(n){n&&So(t),e[13](null),r=!1,Zi(i);}}}function G_(e,t,n){var r,i=Ha("jsoneditor:EditableDiv"),o=t.value,a=t.shortText,s=void 0!==a&&a,c=t.onChange,u=t.onCancel,l=t.onFind,f=t.onPaste,h=void 0===f?Tl:f,d=t.onValueClass,v=void 0===d?function(){return ""}:d,p=v(o),m=!1;function g(){return r?function(e){return e.replace(/\n$/,"")}(r.innerText):""}function y(e){r&&n(1,r.innerText=dC(e),r);}return ea((function(){i("onMount",{value:o}),y(o),setTimeout((function(){r&&yC(r);}));})),ta((function(){var e=g();i("onDestroy",{closed:m,value:o,newValue:e}),m||e===o||c(e,ws);})),e.$$set=function(e){"value"in e&&n(7,o=e.value),"shortText"in e&&n(0,s=e.shortText),"onChange"in e&&n(8,c=e.onChange),"onCancel"in e&&n(9,u=e.onCancel),"onFind"in e&&n(10,l=e.onFind),"onPaste"in e&&n(11,h=e.onPaste),"onValueClass"in e&&n(12,v=e.onValueClass);},[s,r,p,function(){var e=g();""===e&&y(""),n(2,p=v(e));},function(e){e.stopPropagation();var t=_C(e);if("Escape"===t&&(m=!0,u()),"Enter"===t||"Tab"===t){m=!0;var n=g();c(n,ks);}"Ctrl+F"===t&&(e.preventDefault(),l(!1)),"Ctrl+H"===t&&(e.preventDefault(),l(!0));},function(e){if(h){var t=e.clipboardData.getData("text/plain");h(t);}},function(){var e=document.hasFocus(),t=g();i("handleBlur",{hasFocus:e,closed:m,value:o,newValue:t}),document.hasFocus()&&!m&&(m=!0,t!==o?c(t,xs):u());},o,c,u,l,h,v,function(e){sa[e?"unshift":"push"]((function(){n(1,r=e);}));}]}var Q_=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,G_,K_,no,{value:7,shortText:0,onChange:8,onCancel:9,onFind:10,onPaste:11,onValueClass:12},J_),r}return qi(n)}();function Y_(e){var t,n;return t=new Q_({props:{value:e[1].escapeValue(e[0]),onChange:e[3],onCancel:e[4],onPaste:e[5],onFind:e[2],onValueClass:e[6]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r=Si(n,1)[0],i={};3&r&&(i.value=e[1].escapeValue(e[0])),4&r&&(i.onFind=e[2]),t.$set(i);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function X_(e,t,n){var r=t.path,i=t.value,o=t.parser,a=t.normalization,s=t.enforceString,c=t.onPatch,u=t.onPasteJson,l=t.onSelect,f=t.onFind,h=t.focus,d=t.findNextInside;function v(e){return s?e:bu(e,o)}return e.$$set=function(e){"path"in e&&n(7,r=e.path),"value"in e&&n(0,i=e.value),"parser"in e&&n(8,o=e.parser),"normalization"in e&&n(1,a=e.normalization),"enforceString"in e&&n(9,s=e.enforceString),"onPatch"in e&&n(10,c=e.onPatch),"onPasteJson"in e&&n(11,u=e.onPasteJson),"onSelect"in e&&n(12,l=e.onSelect),"onFind"in e&&n(2,f=e.onFind),"focus"in e&&n(13,h=e.focus),"findNextInside"in e&&n(14,d=e.findNextInside);},[i,a,f,function(e,t){c([{op:"replace",path:Ys(r),value:v(a.unescapeValue(e))}],(function(e,n){if(zy(r,n.selection.focusPath)){var i=t===ks?d(r):T_(r,!1);return {state:Oi(Oi({},n),{},{selection:i})}}})),t!==xs&&h();},function(){l(T_(r,!1)),h();},function(e){try{var t=o.parse(e);du(t)&&u({path:r,contents:t});}catch(e){}},function(e){return U_(v(a.unescapeValue(e)),o)},r,o,s,c,u,l,h,d]}var Z_=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,X_,Y_,no,{path:7,value:0,parser:8,normalization:1,enforceString:9,onPatch:10,onPasteJson:11,onSelect:12,onFind:2,focus:13,findNextInside:14}),r}return qi(n)}();function eO(e,t,n){var r=ly(t),i=Vs(e,r);if(_s(i)){var o=uu(Em(t));return n.map((function(e,t){return {op:"add",path:Ys(r.concat(String(o+t))),value:e.value}}))}if(Os(i)){var a=Em(t),s=Object.keys(i),c=void 0!==a?i_(s,a,!0):[];return [].concat(Vi(n.map((function(e){var t=GC(e.key,s);return {op:"add",path:Ys(r.concat(t)),value:e.value}}))),Vi(c.map((function(e){return aO(r,e)}))))}throw new Error("Cannot create insert operations: parent must be an Object or Array")}function tO(e,t,n){var r=Vs(e,t);if(Array.isArray(r)){var i=r.length;return n.map((function(e,n){return {op:"add",path:Ys(t.concat(String(i+n))),value:e.value}}))}return n.map((function(e){var n=GC(e.key,Object.keys(r));return {op:"add",path:Ys(t.concat(n)),value:e.value}}))}function nO(e,t,n,r){var i=GC(r,t.filter((function(e){return e!==n}))),o=i_(t,n,!1);return [{op:"move",from:Ys(e.concat(n)),path:Ys(e.concat(i))}].concat(Vi(o.map((function(t){return aO(e,t)}))))}function rO(e,t){var n=Em(t);if(By(n))throw new Error("Cannot duplicate root object");var r=ly(n),i=Em(n),o=Vs(e,r);if(_s(o)){var a=Em(t),s=a?uu(Em(a))+1:0;return Vi(t.map((function(e,t){return {op:"copy",from:Ys(e),path:Ys(r.concat(String(t+s)))}})))}if(Os(o)){var c=Object.keys(o),u=void 0!==i?i_(c,i,!1):[];return [].concat(Vi(t.map((function(e){var t=GC(Em(e),c);return {op:"copy",from:Ys(e),path:Ys(r.concat(t))}}))),Vi(u.map((function(e){return aO(r,e)}))))}throw new Error("Cannot create duplicate operations: parent must be an Object or Array")}function iO(e,t,n,r){if(v_(t)){var i=IS(n,r),o=ly(t.focusPath),a=Vs(e,o);return nO(o,Object.keys(a),Em(t.focusPath),"string"==typeof i?i:n)}if(p_(t)||m_(t)&&By(t.focusPath))try{return [{op:"replace",path:Ys(t.focusPath),value:DS(n,(function(e){return NS(e,r)}))}]}catch(e){return [{op:"replace",path:Ys(t.focusPath),value:n}]}if(m_(t)){var s=sO(n,r);return function(e,t,n){var r=ly(jg(t)),i=Vs(e,r);if(_s(i)){var o=jg(t),a=o?uu(Em(o)):0;return [].concat(Vi(oO(t)),Vi(n.map((function(e,t){return {op:"add",path:Ys(r.concat(String(t+a))),value:e.value}}))))}if(Os(i)){var s=Em(t),c=ly(s),u=Em(s),l=Object.keys(i),f=void 0!==u?i_(l,u,!1):[],h=new Set(t.map((function(e){return Em(e)}))),d=l.filter((function(e){return !h.has(e)}));return [].concat(Vi(oO(t)),Vi(n.map((function(e){var t=GC(e.key,d);return {op:"add",path:Ys(c.concat(t)),value:e.value}}))),Vi(f.map((function(e){return aO(c,e)}))))}throw new Error("Cannot create replace operations: parent must be an Object or Array")}(e,t.paths,s)}if(h_(t)){var c=sO(n,r),u=t.focusPath,l=ly(u),f=Vs(e,l);if(_s(f)){var h=uu(Em(u));return eO(e,l.concat(String(h+1)),c)}if(Os(f)){var d=String(Em(u)),v=Object.keys(f);if(By(v)||Em(v)===d)return tO(e,l,c);var p=v.indexOf(d),m=v[p+1];return eO(e,l.concat(m),c)}throw new Error("Cannot create insert operations: parent must be an Object or Array")}if(d_(t)){var g=sO(n,r),y=t.focusPath,b=Vs(e,y);if(_s(b))return eO(e,y.concat("0"),g);if(Os(b)){var w=Object.keys(b);if(By(w))return tO(e,y,g);var x=jg(w);return eO(e,y.concat(x),g)}throw new Error("Cannot create insert operations: parent must be an Object or Array")}throw new Error("Cannot insert: unsupported type of selection "+JSON.stringify(t))}function oO(e){return e.map((function(e){return {op:"remove",path:Ys(e)}})).reverse()}function aO(e,t){return {op:"move",from:Ys(e.concat(t)),path:Ys(e.concat(t))}}function sO(e,t){var n=/^\s*{/.test(e),r=/^\s*\[/.test(e),i=IS(e,t),o=void 0!==i?i:DS(e,(function(e){return NS(e,t)}));return n&&hu(o)||r&&Array.isArray(o)?[{key:"New item",value:o}]:Array.isArray(o)?o.map((function(e,t){return {key:"New item "+t,value:e}})):hu(o)?Object.keys(o).map((function(e){return {key:e,value:o[e]}})):[{key:"New item",value:o}]}function cO(e,t){if(v_(t)){var n=ly(t.focusPath),r=Vs(e,n),i=nO(n,Object.keys(r),Em(t.focusPath),"");return {operations:i,newSelection:C_(e,i)}}if(p_(t))return {operations:[{op:"replace",path:Ys(t.focusPath),value:""}],newSelection:t};if(m_(t)){var o=oO(t.paths),a=Em(t.paths);if(By(a)){return {operations:[{op:"replace",path:"",value:""}],newSelection:T_([],!1)}}var s=ly(a),c=Vs(e,s);if(_s(c)){var u=uu(Em(jg(t.paths)));return {operations:o,newSelection:0===u?R_(s):N_(s.concat(String(u-1)))}}if(Os(c)){var l=Object.keys(c),f=Em(jg(t.paths)),h=l.indexOf(f),d=l[h-1];return {operations:o,newSelection:0===h?R_(s):N_(s.concat(d))}}throw new Error("Cannot create remove operations: parent must be an Object or Array")}throw new Error("Cannot remove: unsupported type of selection "+JSON.stringify(t))}function uO(e,t){return vc(e,t,{before:function(e,t,n){if(Es(t)){var r=Qs(t.path);return {revertOperations:[].concat(Vi(n),Vi(lO(e,r)))}}if(Ts(t)){var i=Qs(t.from);return {revertOperations:[].concat(Vi(n),Vi(lO(e,i)))}}return {revertOperations:n}}})}function lO(e,t){var n=ly(t),r=Em(t),i=Vs(e,n);return Os(i)?i_(Object.keys(i),r,!1).map((function(e){return aO(n,e)})):[]}function fO(e){var t=e.activeIndex<e.items.length-1?e.activeIndex+1:e.items.length>0?0:-1,n=e.items[t],r=e.items.map((function(e,n){return Oi(Oi({},e),{},{active:n===t})}));return Oi(Oi({},e),{},{items:r,itemsMap:Ug(r,(function(e){return Ys(e.path)})),activeItem:n,activeIndex:t})}function hO(e){var t=e.activeIndex>0?e.activeIndex-1:e.items.length-1,n=e.items[t],r=e.items.map((function(e,n){return Oi(Oi({},e),{},{active:n===t})}));return Oi(Oi({},e),{},{items:r,itemsMap:Ug(r,(function(e){return Ys(e.path)})),activeItem:n,activeIndex:t})}function dO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,r=[],i=[];function o(e){r.length<n&&r.push(e);}function a(e,t){if(_s(t)){var s=i.length;i.push("0");for(var c=0;c<t.length;c++)if(i[s]=String(c),a(e,t[c]),r.length>=n)return;i.pop();}else if(Os(t)){var u=Object.keys(t),l=i.length;i.push("");for(var f=0,h=u;f<h.length;f++){var d=h[f];if(i[l]=d,vO(d,e,i,ls.key,o),a(e,t[d]),r.length>=n)return}i.pop();}else vO(String(t),e,i,ls.value,o);}if("string"==typeof e&&""!==e){var s=e.toLowerCase();a(s,t);}return r}function vO(e,t,n,r,i){var o=e.toLowerCase(),a=0,s=-1,c=-1;do{-1!==(c=o.indexOf(t,s))&&(s=c+t.length,i({path:n.slice(0),field:r,fieldIndex:a,start:c,end:s}),a++);}while(-1!==c)}function pO(e,t,n,r){return e.substring(0,n)+t+e.substring(r)}function mO(e,t,n){var r=e;return Jm(n,(function(e){r=pO(r,t,e.start,e.end);})),r}function gO(e,t,n,r,i){var o=r.field,a=r.path,s=r.start,c=r.end;if(o===ls.key){var u=ly(a),l=Vs(e,u),f=Em(a),h=nO(u,Object.keys(l),f,pO(f,n,s,c));return {newSelection:C_(e,h),operations:h}}if(o===ls.value){var d=Vs(e,a);if(void 0===d)throw new Error("Cannot replace: path not found ".concat(Ys(a)));var v="string"==typeof d?d:String(d),p=Ys(a),m=r_(d,t.enforceStringMap,p,i),g=pO(v,n,s,c),y=[{op:"replace",path:Ys(a),value:m?g:bu(g,i)}];return {newSelection:C_(e,y),operations:y}}throw new Error("Cannot replace: unknown type of search result field ".concat(o))}function yO(e,t,n,r,i){for(var o=dO(n,e,1/0),a=[],s=0;s<o.length;s++){var c=o[s-1],u=o[s];0!==s&&u.field===c.field&&zy(u.path,c.path)?Em(a).items.push(u):a.push({path:u.path,field:u.field,items:[u]});}a.sort((function(e,t){return e.field!==t.field?e.field===ls.key?1:-1:t.path.length-e.path.length}));var l=[],f=void 0;return a.forEach((function(n){var o=n.field,a=n.path,s=n.items;if(o===ls.key){var c=ly(a),u=Vs(e,c),h=Em(a),d=nO(c,Object.keys(u),h,mO(h,r,s));l=l.concat(d),f=C_(e,d);}else {if(o!==ls.value)throw new Error("Cannot replace: unknown type of search result field ".concat(o));var v=Vs(e,a);if(void 0===v)throw new Error("Cannot replace: path not found ".concat(Ys(a)));var p="string"==typeof v?v:String(v),m=Ys(a),g=r_(v,t.enforceStringMap,m,i),y=mO(p,r,s),b=[{op:"replace",path:Ys(a),value:g?y:bu(y,i)}];l=l.concat(b),f=C_(e,b);}})),{operations:l,newSelection:f}}function bO(e){return e.path.concat(e.field,String(e.fieldIndex))}function wO(e,t){var n,r=null==e||null===(n=e[t])||void 0===n?void 0:n.filter((function(e){return e.field===ls.key}));if(r&&0!==r.length)return r}function xO(e,t){var n,r=null==e||null===(n=e[t])||void 0===n?void 0:n.filter((function(e){return e.field===ls.value}));if(r&&0!==r.length)return r}function kO(e){bo(e,"svelte-s6kbew",".jse-highlight.svelte-s6kbew{background-color:var(--jse-search-match-color);outline:var(--jse-search-match-outline)}.jse-highlight.jse-active.svelte-s6kbew{background-color:var(--jse-search-match-active-color);outline:var(--jse-search-match-active-outline)}");}function jO(e,t,n){var r=e.slice();return r[3]=t[n],r}function SO(e){var t,n,r=dC(e[3].text)+"";return {c:function(){t=$o("span"),n=Oo(r),Ro(t,"class","jse-highlight svelte-s6kbew"),Fo(t,"jse-active",e[3].active);},m:function(e,r){jo(e,t,r),yo(t,n);},p:function(e,i){1&i&&r!==(r=dC(e[3].text)+"")&&Lo(n,r),1&i&&Fo(t,"jse-active",e[3].active);},d:function(e){e&&So(t);}}}function CO(e){var t,n=e[3].text+"";return {c:function(){t=Oo(n);},m:function(e,n){jo(e,t,n);},p:function(e,r){1&r&&n!==(n=e[3].text+"")&&Lo(t,n);},d:function(e){e&&So(t);}}}function $O(e){var t;function n(e,t){return "normal"===e[3].type?CO:SO}var r=n(e),i=r(e);return {c:function(){i.c(),t=Eo();},m:function(e,n){i.m(e,n),jo(e,t,n);},p:function(e,o){r===(r=n(e))&&i?i.p(e,o):(i.d(1),(i=r(e))&&(i.c(),i.m(t.parentNode,t)));},d:function(e){i.d(e),e&&So(t);}}}function _O(e){for(var t,n=e[0],r=[],i=0;i<n.length;i+=1)r[i]=$O(jO(e,n,i));return {c:function(){for(var e=0;e<r.length;e+=1)r[e].c();t=Eo();},m:function(e,n){for(var i=0;i<r.length;i+=1)r[i]&&r[i].m(e,n);jo(e,t,n);},p:function(e,i){var o=Si(i,1)[0];if(1&o){var a;for(n=e[0],a=0;a<n.length;a+=1){var s=jO(e,n,a);r[a]?r[a].p(s,o):(r[a]=$O(s),r[a].c(),r[a].m(t.parentNode,t));}for(;a<r.length;a+=1)r[a].d(1);r.length=n.length;}},i:Ki,o:Ki,d:function(e){Co(r,e),e&&So(t);}}}function OO(e,t,n){var r,i=t.text,o=t.searchResultItems;return e.$$set=function(e){"text"in e&&n(1,i=e.text),"searchResultItems"in e&&n(2,o=e.searchResultItems);},e.$$.update=function(){6&e.$$.dirty&&n(0,r=function(e,t){var n,r=[],i=0,o=wi(t);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=e.slice(i,a.start);""!==s&&r.push({type:"normal",text:s,active:!1});var c=e.slice(a.start,a.end);r.push({type:"highlight",text:c,active:a.active}),i=a.end;}}catch(e){o.e(e);}finally{o.f();}var u=Em(t);return u&&u.end<e.length&&r.push({type:"normal",text:e.slice(u.end),active:!1}),r}(String(i),o));},[r,i,o]}var MO=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,OO,_O,to,{text:1,searchResultItems:2},kO),r}return qi(n)}();function EO(e){bo(e,"svelte-4unvg2",'.jse-value.jse-string.svelte-4unvg2{color:var(--jse-value-color-string)}.jse-value.jse-object.svelte-4unvg2,.jse-value.jse-array.svelte-4unvg2{min-width:16px;color:var(--jse-delimiter-color)}.jse-value.jse-number.svelte-4unvg2{color:var(--jse-value-color-number)}.jse-value.jse-boolean.svelte-4unvg2{color:var(--jse-value-color-boolean)}.jse-value.jse-null.svelte-4unvg2{color:var(--jse-value-color-null)}.jse-value.jse-invalid.svelte-4unvg2{color:var(--jse-text-color)}.jse-value.jse-url.svelte-4unvg2{color:var(--jse-value-color-url);text-decoration:underline}.jse-value.svelte-4unvg2{min-width:2em;padding:0 5px;box-sizing:border-box;outline:none;border-radius:1px;vertical-align:top;cursor:var(--jse-contents-cursor);word-break:normal;overflow-wrap:anywhere;white-space:pre-wrap}.jse-value.svelte-4unvg2:hover{background:var(--jse-hover-background-color)}.jse-value.jse-empty.svelte-4unvg2{min-width:4em;outline:1px dotted var(--jse-tag-background);-moz-outline-radius:2px}.jse-value.jse-empty.svelte-4unvg2::after{pointer-events:none;color:var(--jse-tag-background);content:"value"}');}function AO(e){var t,n=dC(e[1].escapeValue(e[0]))+"";return {c:function(){t=Oo(n);},m:function(e,n){jo(e,t,n);},p:function(e,r){3&r&&n!==(n=dC(e[1].escapeValue(e[0]))+"")&&Lo(t,n);},i:Ki,o:Ki,d:function(e){e&&So(t);}}}function PO(e){var t,n;return t=new MO({props:{text:e[1].escapeValue(e[0]),searchResultItems:e[3]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};3&n&&(r.text=e[1].escapeValue(e[0])),8&n&&(r.searchResultItems=e[3]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function TO(e){var t,n,r,i,o,a,s,c,u=[PO,AO],l=[];function f(e,t){return e[3]?0:1}return n=f(e),r=l[n]=u[n](e),{c:function(){t=$o("div"),r.c(),Ro(t,"data-type","selectable-value"),Ro(t,"class",i=lo(U_(e[0],e[2]))+" svelte-4unvg2"),Ro(t,"title",o=e[4]?"Ctrl+Click or Ctrl+Enter to open url in new window":null);},m:function(r,i){jo(r,t,i),l[n].m(t,null),a=!0,s||(c=[Ao(t,"click",e[5]),Ao(t,"dblclick",e[6])],s=!0);},p:function(e,s){var c=Si(s,1)[0],h=n;(n=f(e))===h?l[n].p(e,c):(Sa(),_a(l[h],1,1,(function(){l[h]=null;})),Ca(),(r=l[n])?r.p(e,c):(r=l[n]=u[n](e)).c(),$a(r,1),r.m(t,null)),(!a||5&c&&i!==(i=lo(U_(e[0],e[2]))+" svelte-4unvg2"))&&Ro(t,"class",i),(!a||16&c&&o!==(o=e[4]?"Ctrl+Click or Ctrl+Enter to open url in new window":null))&&Ro(t,"title",o);},i:function(e){a||($a(r),a=!0);},o:function(e){_a(r),a=!1;},d:function(e){e&&So(t),l[n].d(),s=!1,Zi(c);}}}function RO(e,t,n){var r,i=t.path,o=t.value,a=t.readOnly,s=t.normalization,c=t.parser,u=t.onSelect,l=t.searchResultItems;return e.$$set=function(e){"path"in e&&n(7,i=e.path),"value"in e&&n(0,o=e.value),"readOnly"in e&&n(8,a=e.readOnly),"normalization"in e&&n(1,s=e.normalization),"parser"in e&&n(2,c=e.parser),"onSelect"in e&&n(9,u=e.onSelect),"searchResultItems"in e&&n(3,l=e.searchResultItems);},e.$$.update=function(){1&e.$$.dirty&&n(4,r=yu(o));},[o,s,c,l,r,function(e){"string"==typeof o&&r&&e.ctrlKey&&(e.preventDefault(),e.stopPropagation(),window.open(o,"_blank"));},function(e){a||(e.preventDefault(),u(T_(i,!0)));},i,a,u]}var NO=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,RO,TO,no,{path:7,value:0,readOnly:8,normalization:1,parser:2,onSelect:9,searchResultItems:3},EO),r}return qi(n)}();function IO(e){bo(e,"svelte-r4omvg",".jse-tooltip.svelte-r4omvg{font-family:var(--jse-font-family);font-size:var(--jse-font-size);line-height:normal;padding:calc(0.5 * var(--jse-padding)) var(--jse-padding);border-radius:3px;background:var(--jse-context-menu-background);color:var(--jse-context-menu-color);white-space:nowrap;box-shadow:var(--jse-controls-box-shadow)}");}function DO(e){var t,n;return {c:function(){t=$o("div"),n=Oo(e[0]),Ro(t,"class","jse-tooltip svelte-r4omvg");},m:function(e,r){jo(e,t,r),yo(t,n);},p:function(e,t){1&Si(t,1)[0]&&Lo(n,e[0]);},i:Ki,o:Ki,d:function(e){e&&So(t);}}}function LO(e,t,n){var r=t.text;return e.$$set=function(e){"text"in e&&n(0,r=e.text);},[r]}var BO=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,LO,DO,to,{text:0},IO),r}return qi(n)}();function zO(e,t){var n,r=t.text,i=t.openAbsolutePopup,o=t.closeAbsolutePopup;function a(){n=i(BO,{text:r},{position:"top",width:10*r.length,offsetTop:3,anchor:e,closeOnOuterClick:!0});}function s(){o(n);}return e.addEventListener("mouseenter",a),e.addEventListener("mouseleave",s),{destroy:function(){e.removeEventListener("mouseenter",a),e.removeEventListener("mouseleave",s);}}}function qO(e){bo(e,"svelte-1w5pf7",".jse-timestamp.svelte-1w5pf7{padding:0;margin:0;vertical-align:middle;display:inline-flex;color:var(--jse-value-color-number)}");}function FO(e){var t,n,r,i,o,a;return n=new x$({props:{data:n$}}),{c:function(){t=$o("div"),Da(n.$$.fragment),Ro(t,"class","jse-timestamp svelte-1w5pf7");},m:function(s,c){jo(s,t,c),La(n,t,null),i=!0,o||(a=fo(r=zO.call(null,t,Oi({text:e[0]},e[1]))),o=!0);},p:function(e,t){var n=Si(t,1)[0];r&&eo(r.update)&&1&n&&r.update.call(null,Oi({text:e[0]},e[1]));},i:function(e){i||($a(n.$$.fragment,e),i=!0);},o:function(e){_a(n.$$.fragment,e),i=!1;},d:function(e){e&&So(t),Ba(n),o=!1,a();}}}function VO(e,t,n){var r,i=ia("absolute-popup"),o=t.value;return e.$$set=function(e){"value"in e&&n(2,o=e.value);},e.$$.update=function(){4&e.$$.dirty&&n(0,r="Time: ".concat(new Date(o).toString()));},[r,i,o]}var WO=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,VO,FO,no,{value:2},qO),r}return qi(n)}();function HO(e){var t=e.path,n=e.value,r=e.readOnly,i=e.enforceString,o=e.searchResultItems,a=e.isEditing,s=e.parser,c=e.normalization,u=e.onPatch,l=e.onPasteJson,f=e.onSelect,h=e.onFind,d=e.findNextInside,v=e.focus,p=[];return !a&&function(e){return !0===e||!1===e}(n)&&p.push({component:C$,props:{path:t,value:n,readOnly:r,onPatch:u,focus:v}}),!a&&function(e){return "string"==typeof e&&!!pu(e)}(n)&&p.push({component:T$,props:{path:t,value:n,readOnly:r,onPatch:u,focus:v}}),a&&p.push({component:Z_,props:{path:t,value:n,enforceString:i,parser:s,normalization:c,onPatch:u,onPasteJson:l,onSelect:f,onFind:h,findNextInside:d,focus:v}}),a||p.push({component:NO,props:{path:t,value:n,readOnly:r,parser:s,normalization:c,searchResultItems:o,onSelect:f}}),!a&&vu(n)&&p.push({component:WO,props:{value:n}}),p}var UO={prefix:"fas",iconName:"trash-can",icon:[448,512,[61460,"trash-alt"],"f2ed","M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"]},JO={prefix:"fas",iconName:"caret-right",icon:[256,512,[],"f0da","M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"]},KO={prefix:"fas",iconName:"paste",icon:[512,512,["file-clipboard"],"f0ea","M160 0c-23.7 0-44.4 12.9-55.4 32H48C21.5 32 0 53.5 0 80V400c0 26.5 21.5 48 48 48H192V176c0-44.2 35.8-80 80-80h48V80c0-26.5-21.5-48-48-48H215.4C204.4 12.9 183.7 0 160 0zM272 128c-26.5 0-48 21.5-48 48V448v16c0 26.5 21.5 48 48 48H464c26.5 0 48-21.5 48-48V243.9c0-12.7-5.1-24.9-14.1-33.9l-67.9-67.9c-9-9-21.2-14.1-33.9-14.1H320 272zM160 40a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"]},GO={prefix:"fas",iconName:"circle-notch",icon:[512,512,[],"f1ce","M222.7 32.1c5 16.9-4.6 34.8-21.5 39.8C121.8 95.6 64 169.1 64 256c0 106 86 192 192 192s192-86 192-192c0-86.9-57.8-160.4-137.1-184.1c-16.9-5-26.6-22.9-21.5-39.8s22.9-26.6 39.8-21.5C434.9 42.1 512 140 512 256c0 141.4-114.6 256-256 256S0 397.4 0 256C0 140 77.1 42.1 182.9 10.6c16.9-5 34.8 4.6 39.8 21.5z"]},QO={prefix:"fas",iconName:"scissors",icon:[512,512,[9984,9986,9988,"cut"],"f0c4","M256 192l-39.5-39.5c4.9-12.6 7.5-26.2 7.5-40.5C224 50.1 173.9 0 112 0S0 50.1 0 112s50.1 112 112 112c14.3 0 27.9-2.7 40.5-7.5L192 256l-39.5 39.5c-12.6-4.9-26.2-7.5-40.5-7.5C50.1 288 0 338.1 0 400s50.1 112 112 112s112-50.1 112-112c0-14.3-2.7-27.9-7.5-40.5L499.2 76.8c7.1-7.1 7.1-18.5 0-25.6c-28.3-28.3-74.1-28.3-102.4 0L256 192zm22.6 150.6L396.8 460.8c28.3 28.3 74.1 28.3 102.4 0c7.1-7.1 7.1-18.5 0-25.6L342.6 278.6l-64 64zM64 112a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm48 240a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"]},YO={prefix:"fas",iconName:"square-caret-down",icon:[448,512,["caret-square-down"],"f150","M384 480c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64L64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l320 0zM224 352c-6.7 0-13-2.8-17.6-7.7l-104-112c-6.5-7-8.2-17.2-4.4-25.9s12.5-14.4 22-14.4l208 0c9.5 0 18.2 5.7 22 14.4s2.1 18.9-4.4 25.9l-104 112c-4.5 4.9-10.9 7.7-17.6 7.7z"]},XO={prefix:"fas",iconName:"caret-left",icon:[256,512,[],"f0d9","M9.4 278.6c-12.5-12.5-12.5-32.8 0-45.3l128-128c9.2-9.2 22.9-11.9 34.9-6.9s19.8 16.6 19.8 29.6l0 256c0 12.9-7.8 24.6-19.8 29.6s-25.7 2.2-34.9-6.9l-128-128z"]},ZO={prefix:"fas",iconName:"pen-to-square",icon:[512,512,["edit"],"f044","M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"]},eM={prefix:"fas",iconName:"chevron-up",icon:[512,512,[],"f077","M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z"]},tM={prefix:"fas",iconName:"angle-right",icon:[320,512,[8250],"f105","M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"]},nM={prefix:"fas",iconName:"square-caret-up",icon:[448,512,["caret-square-up"],"f151","M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM224 160c6.7 0 13 2.8 17.6 7.7l104 112c6.5 7 8.2 17.2 4.4 25.9s-12.5 14.4-22 14.4H120c-9.5 0-18.2-5.7-22-14.4s-2.1-18.9 4.4-25.9l104-112c4.5-4.9 10.9-7.7 17.6-7.7z"]},rM={prefix:"fas",iconName:"caret-up",icon:[320,512,[],"f0d8","M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"]},iM={prefix:"fas",iconName:"filter",icon:[512,512,[],"f0b0","M3.9 54.9C10.5 40.9 24.5 32 40 32H472c15.5 0 29.5 8.9 36.1 22.9s4.6 30.5-5.2 42.5L320 320.9V448c0 12.1-6.8 23.2-17.7 28.6s-23.8 4.3-33.5-3l-64-48c-8.1-6-12.8-15.5-12.8-25.6V320.9L9 97.3C-.7 85.4-2.8 68.8 3.9 54.9z"]},oM={prefix:"fas",iconName:"code",icon:[640,512,[],"f121","M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3L562.7 256l-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"]},aM={prefix:"fas",iconName:"wrench",icon:[512,512,[128295],"f0ad","M352 320c88.4 0 160-71.6 160-160c0-15.3-2.2-30.1-6.2-44.2c-3.1-10.8-16.4-13.2-24.3-5.3l-76.8 76.8c-3 3-7.1 4.7-11.3 4.7H336c-8.8 0-16-7.2-16-16V118.6c0-4.2 1.7-8.3 4.7-11.3l76.8-76.8c7.9-7.9 5.4-21.2-5.3-24.3C382.1 2.2 367.3 0 352 0C263.6 0 192 71.6 192 160c0 19.1 3.4 37.5 9.5 54.5L19.9 396.1C7.2 408.8 0 426.1 0 444.1C0 481.6 30.4 512 67.9 512c18 0 35.3-7.2 48-19.9L297.5 310.5c17 6.2 35.4 9.5 54.5 9.5zM80 408a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"]},sM={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"]},cM={prefix:"fas",iconName:"pen",icon:[512,512,[128394],"f304","M362.7 19.3L314.3 67.7 444.3 197.7l48.4-48.4c25-25 25-65.5 0-90.5L453.3 19.3c-25-25-65.5-25-90.5 0zm-71 71L58.6 323.5c-10.4 10.4-18 23.3-22.2 37.4L1 481.2C-1.5 489.7 .8 498.8 7 505s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L421.7 220.3 291.7 90.3z"]},uM={prefix:"fas",iconName:"arrow-rotate-right",icon:[512,512,[8635,"arrow-right-rotate","arrow-rotate-forward","redo"],"f01e","M386.3 160H336c-17.7 0-32 14.3-32 32s14.3 32 32 32H464c17.7 0 32-14.3 32-32V64c0-17.7-14.3-32-32-32s-32 14.3-32 32v51.2L414.4 97.6c-87.5-87.5-229.3-87.5-316.8 0s-87.5 229.3 0 316.8s229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3s163.8-62.5 226.3 0L386.3 160z"]},lM={prefix:"fas",iconName:"arrow-rotate-left",icon:[512,512,[8634,"arrow-left-rotate","arrow-rotate-back","arrow-rotate-backward","undo"],"f0e2","M125.7 160H176c17.7 0 32 14.3 32 32s-14.3 32-32 32H48c-17.7 0-32-14.3-32-32V64c0-17.7 14.3-32 32-32s32 14.3 32 32v51.2L97.6 97.6c87.5-87.5 229.3-87.5 316.8 0s87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3s-163.8-62.5-226.3 0L125.7 160z"]},fM={prefix:"fas",iconName:"crop-simple",icon:[512,512,["crop-alt"],"f565","M128 32c0-17.7-14.3-32-32-32S64 14.3 64 32V64H32C14.3 64 0 78.3 0 96s14.3 32 32 32H64V384c0 35.3 28.7 64 64 64H352V384H128V32zM384 480c0 17.7 14.3 32 32 32s32-14.3 32-32V448h32c17.7 0 32-14.3 32-32s-14.3-32-32-32H448l0-256c0-35.3-28.7-64-64-64L160 64v64l224 0 0 352z"]},hM={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"]},dM={prefix:"fas",iconName:"caret-down",icon:[320,512,[],"f0d7","M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"]},vM={prefix:"fas",iconName:"ellipsis-vertical",icon:[128,512,["ellipsis-v"],"f142","M64 360a56 56 0 1 0 0 112 56 56 0 1 0 0-112zm0-160a56 56 0 1 0 0 112 56 56 0 1 0 0-112zM120 96A56 56 0 1 0 8 96a56 56 0 1 0 112 0z"]},pM={prefix:"fas",iconName:"arrow-right-arrow-left",icon:[448,512,[8644,"exchange"],"f0ec","M438.6 150.6c12.5-12.5 12.5-32.8 0-45.3l-96-96c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.7 96 32 96C14.3 96 0 110.3 0 128s14.3 32 32 32l306.7 0-41.4 41.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l96-96zm-333.3 352c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 416 416 416c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0 41.4-41.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3l96 96z"]},mM={prefix:"fas",iconName:"arrow-down-short-wide",icon:[576,512,["sort-amount-desc","sort-amount-down-alt"],"f884","M151.6 469.6C145.5 476.2 137 480 128 480s-17.5-3.8-23.6-10.4l-88-96c-11.9-13-11.1-33.3 2-45.2s33.3-11.1 45.2 2L96 365.7V64c0-17.7 14.3-32 32-32s32 14.3 32 32V365.7l32.4-35.4c11.9-13 32.2-13.9 45.2-2s13.9 32.2 2 45.2l-88 96zM320 32h32c17.7 0 32 14.3 32 32s-14.3 32-32 32H320c-17.7 0-32-14.3-32-32s14.3-32 32-32zm0 128h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H320c-17.7 0-32-14.3-32-32s14.3-32 32-32zm0 128H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H320c-17.7 0-32-14.3-32-32s14.3-32 32-32zm0 128H544c17.7 0 32 14.3 32 32s-14.3 32-32 32H320c-17.7 0-32-14.3-32-32s14.3-32 32-32z"]},gM={prefix:"fas",iconName:"angle-down",icon:[448,512,[8964],"f107","M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"]},yM={prefix:"fas",iconName:"arrow-down",icon:[384,512,[8595],"f063","M169.4 470.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 370.8 224 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 306.7L54.6 265.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"]},bM={prefix:"fas",iconName:"magnifying-glass",icon:[512,512,[128269,"search"],"f002","M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"]},wM={prefix:"fas",iconName:"chevron-down",icon:[512,512,[],"f078","M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"]},xM={prefix:"fas",iconName:"copy",icon:[512,512,[],"f0c5","M272 0H396.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H272c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128H192v64H64V448H256V416h64v48c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48z"]},kM={prefix:"fas",iconName:"plus",icon:[448,512,[10133,61543,"add"],"2b","M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"]},jM={prefix:"fas",iconName:"xmark",icon:[384,512,[128473,10005,10006,10060,215,"close","multiply","remove","times"],"f00d","M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"]},SM=jM,CM=jM,$M={prefix:"fas",iconName:"rotate",icon:[512,512,[128260,"sync-alt"],"f2f1","M142.9 142.9c62.2-62.2 162.7-62.5 225.3-1L327 183c-6.9 6.9-8.9 17.2-5.2 26.2s12.5 14.8 22.2 14.8H463.5c0 0 0 0 0 0H472c13.3 0 24-10.7 24-24V72c0-9.7-5.8-18.5-14.8-22.2s-19.3-1.7-26.2 5.2L413.4 96.6c-87.6-86.5-228.7-86.2-315.8 1C73.2 122 55.6 150.7 44.8 181.4c-5.9 16.7 2.9 34.9 19.5 40.8s34.9-2.9 40.8-19.5c7.7-21.8 20.2-42.3 37.8-59.8zM16 312v7.6 .7V440c0 9.7 5.8 18.5 14.8 22.2s19.3 1.7 26.2-5.2l41.6-41.6c87.6 86.5 228.7 86.2 315.8-1c24.4-24.4 42.1-53.1 52.9-83.7c5.9-16.7-2.9-34.9-19.5-40.8s-34.9 2.9-40.8 19.5c-7.7 21.8-20.2 42.3-37.8 59.8c-62.2 62.2-162.7 62.5-225.3 1L185 329c6.9-6.9 8.9-17.2 5.2-26.2s-12.5-14.8-22.2-14.8H48.4h-.7H40c-13.3 0-24 10.7-24 24z"]},_M={prefix:"fas",iconName:"clone",icon:[512,512,[],"f24d","M288 448H64V224h64V160H64c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H288c35.3 0 64-28.7 64-64V384H288v64zm-64-96H448c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H224c-35.3 0-64 28.7-64 64V288c0 35.3 28.7 64 64 64z"]},OM={prefix:"fas",iconName:"check",icon:[448,512,[10003,10004],"f00c","M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"]},MM={prefix:"fas",iconName:"triangle-exclamation",icon:[512,512,[9888,"exclamation-triangle","warning"],"f071","M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"]},EM={};function AM(e){return e.split("-")[1]}function PM(e){return "y"===e?"height":"width"}function TM(e){return e.split("-")[0]}function RM(e){return ["top","bottom"].includes(TM(e))?"x":"y"}function NM(e,t,n){var r,i=e.reference,o=e.floating,a=i.x+i.width/2-o.width/2,s=i.y+i.height/2-o.height/2,c=RM(t),u=PM(c),l=i[u]/2-o[u]/2,f="x"===c;switch(TM(t)){case"top":r={x:a,y:i.y-o.height};break;case"bottom":r={x:a,y:i.y+i.height};break;case"right":r={x:i.x+i.width,y:s};break;case"left":r={x:i.x-o.width,y:s};break;default:r={x:i.x,y:i.y};}switch(AM(t)){case"start":r[c]-=l*(n&&f?-1:1);break;case"end":r[c]+=l*(n&&f?-1:1);}return r}var IM=function(){var e=ji(xi().mark((function e(t,n,r){var i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b,w,x,k,j,S,C,$,_,O,M;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.placement,o=void 0===i?"bottom":i,a=r.strategy,s=void 0===a?"absolute":a,c=r.middleware,u=void 0===c?[]:c,l=r.platform,f=u.filter(Boolean),e.next=10,null==l.isRTL?void 0:l.isRTL(n);case 10:return h=e.sent,e.next=13,l.getElementRects({reference:t,floating:n,strategy:s});case 13:d=e.sent,v=NM(d,o,h),p=v.x,m=v.y,g=o,y={},b=0,w=0;case 21:if(!(w<f.length)){e.next=56;break}return k=f[w],j=k.name,S=k.fn,e.next=27,S({x:p,y:m,initialPlacement:o,placement:g,strategy:s,middlewareData:y,rects:d,platform:l,elements:{reference:t,floating:n}});case 27:if(C=e.sent,$=C.x,_=C.y,O=C.data,M=C.reset,p=null!=$?$:p,m=null!=_?_:m,y=Oi(Oi({},y),{},Mi({},j,Oi(Oi({},y[j]),O))),e.t0=M&&b<=50,!e.t0){e.next=53;break}if(b++,e.t1="object"==Ji(M),!e.t1){e.next=52;break}if(M.placement&&(g=M.placement),e.t2=M.rects,!e.t2){e.next=51;break}if(!0!==M.rects){e.next=49;break}return e.next=46,l.getElementRects({reference:t,floating:n,strategy:s});case 46:e.t3=e.sent,e.next=50;break;case 49:e.t3=M.rects;case 50:d=e.t3;case 51:x=NM(d,g,h),p=x.x,m=x.y;case 52:w=-1;case 53:w++,e.next=21;break;case 56:return e.abrupt("return",{x:p,y:m,placement:g,strategy:s,middlewareData:y});case 57:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function DM(e){return "number"!=typeof e?function(e){return Oi({top:0,right:0,bottom:0,left:0},e)}(e):{top:e,right:e,bottom:e,left:e}}function LM(e){return Oi(Oi({},e),{},{top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height})}function BM(e,t){return zM.apply(this,arguments)}function zM(){return zM=ji(xi().mark((function e(t,n){var r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b,w,x,k,j,S,C,$;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),i=t.x,o=t.y,a=t.platform,s=t.rects,c=t.elements,u=t.strategy,f=(l=n).boundary,h=void 0===f?"clippingAncestors":f,d=l.rootBoundary,v=void 0===d?"viewport":d,p=l.elementContext,m=void 0===p?"floating":p,g=l.altBoundary,y=void 0!==g&&g,b=l.padding,w=DM(void 0===b?0:b),x=c[y?"floating"===m?"reference":"floating":m],e.t0=LM,e.t1=a,e.next=24,null==a.isElement?void 0:a.isElement(x);case 24:if(e.t3=r=e.sent,e.t2=null==e.t3,e.t2){e.next=28;break}e.t2=r;case 28:if(!e.t2){e.next=32;break}e.t4=x,e.next=38;break;case 32:if(e.t5=x.contextElement,e.t5){e.next=37;break}return e.next=36,null==a.getDocumentElement?void 0:a.getDocumentElement(c.floating);case 36:e.t5=e.sent;case 37:e.t4=e.t5;case 38:return e.t6=e.t4,e.t7=h,e.t8=v,e.t9=u,e.t10={element:e.t6,boundary:e.t7,rootBoundary:e.t8,strategy:e.t9},e.next=45,e.t1.getClippingRect.call(e.t1,e.t10);case 45:return e.t11=e.sent,k=(0, e.t0)(e.t11),j="floating"===m?Oi(Oi({},s.floating),{},{x:i,y:o}):s.reference,e.next=50,null==a.getOffsetParent?void 0:a.getOffsetParent(c.floating);case 50:return S=e.sent,e.next=53,null==a.isElement?void 0:a.isElement(S);case 53:if(e.t13=e.sent,!e.t13){e.next=58;break}return e.next=57,null==a.getScale?void 0:a.getScale(S);case 57:e.t13=e.sent;case 58:if(e.t12=e.t13,e.t12){e.next=61;break}e.t12={x:1,y:1};case 61:if(C=e.t12,e.t14=LM,!a.convertOffsetParentRelativeRectToViewportRelativeRect){e.next=69;break}return e.next=66,a.convertOffsetParentRelativeRectToViewportRelativeRect({rect:j,offsetParent:S,strategy:u});case 66:e.t15=e.sent,e.next=70;break;case 69:e.t15=j;case 70:return e.t16=e.t15,$=(0, e.t14)(e.t16),e.abrupt("return",{top:(k.top-$.top+w.top)/C.y,bottom:($.bottom-k.bottom+w.bottom)/C.y,left:(k.left-$.left+w.left)/C.x,right:($.right-k.right+w.right)/C.x});case 73:case"end":return e.stop()}}),e)}))),zM.apply(this,arguments)}var qM=Math.min,FM=Math.max;function VM(e,t,n){return FM(e,qM(t,n))}["top","right","bottom","left"].reduce((function(e,t){return e.concat(t,t+"-start",t+"-end")}),[]);var WM={left:"right",right:"left",bottom:"top",top:"bottom"};function HM(e){return e.replace(/left|right|bottom|top/g,(function(e){return WM[e]}))}function UM(e,t,n){void 0===n&&(n=!1);var r=AM(e),i=RM(e),o=PM(i),a="x"===i?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[o]>t.floating[o]&&(a=HM(a)),{main:a,cross:HM(a)}}var JM={start:"end",end:"start"};function KM(e){return e.replace(/start|end/g,(function(e){return JM[e]}))}var GM=function(e){return void 0===e&&(e={}),{name:"flip",options:e,fn:function(t){return ji(xi().mark((function n(){var r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b,w,x,k,j,S,C,$,_,O,M,E,A,P,T,R,N,I,D,L,B,z;return xi().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.placement,o=t.middlewareData,a=t.rects,s=t.initialPlacement,c=t.platform,u=t.elements,f=(l=e).mainAxis,h=void 0===f||f,d=l.crossAxis,v=void 0===d||d,p=l.fallbackPlacements,m=l.fallbackStrategy,g=void 0===m?"bestFit":m,y=l.fallbackAxisSideDirection,b=void 0===y?"none":y,w=l.flipAlignment,x=void 0===w||w,k=bi(l,vi),j=TM(i),S=TM(s)===s,n.next=23,null==c.isRTL?void 0:c.isRTL(u.floating);case 23:return C=n.sent,$=p||(S||!x?[HM(s)]:function(e){var t=HM(e);return [KM(e),t,KM(t)]}(s)),p||"none"===b||$.push.apply($,Vi(function(e,t,n,r){var i=AM(e),o=function(e,t,n){var r=["left","right"],i=["right","left"];switch(e){case"top":case"bottom":return n?t?i:r:t?r:i;case"left":case"right":return t?["top","bottom"]:["bottom","top"];default:return []}}(TM(e),"start"===n,r);return i&&(o=o.map((function(e){return e+"-"+i})),t&&(o=o.concat(o.map(KM)))),o}(s,x,b,C))),_=[s].concat(Vi($)),n.next=29,BM(t,k);case 29:if(O=n.sent,M=[],E=(null==(r=o.flip)?void 0:r.overflows)||[],h&&M.push(O[j]),v&&(A=UM(i,a,C),P=A.main,T=A.cross,M.push(O[P],O[T])),E=[].concat(Vi(E),[{placement:i,overflows:M}]),M.every((function(e){return e<=0}))){n.next=48;break}if(I=((null==(R=o.flip)?void 0:R.index)||0)+1,!(D=_[I])){n.next=37;break}return n.abrupt("return",{data:{index:I,overflows:E},reset:{placement:D}});case 37:if(L=null==(N=E.filter((function(e){return e.overflows[0]<=0})).sort((function(e,t){return e.overflows[1]-t.overflows[1]}))[0])?void 0:N.placement,L){n.next=46;break}n.t0=g,n.next="bestFit"===n.t0?42:"initialPlacement"===n.t0?45:46;break;case 42:return z=null==(B=E.map((function(e){return [e.placement,e.overflows.filter((function(e){return e>0})).reduce((function(e,t){return e+t}),0)]})).sort((function(e,t){return e[1]-t[1]}))[0])?void 0:B[0],z&&(L=z),n.abrupt("break",46);case 45:L=s;case 46:if(i===L){n.next=48;break}return n.abrupt("return",{reset:{placement:L}});case 48:return n.abrupt("return",{});case 49:case"end":return n.stop()}}),n)})))()}}},QM=function(e){return void 0===e&&(e=0),{name:"offset",options:e,fn:function(t){return ji(xi().mark((function n(){var r,i,o;return xi().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.x,i=t.y,n.next=4,function(){var e=ji(xi().mark((function e(t,n){var r,i,o,a,s,c,u,l,f,h,d,v,p,m;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.placement,i=t.platform,o=t.elements,e.next=5,null==i.isRTL?void 0:i.isRTL(o.floating);case 5:return a=e.sent,s=TM(r),c=AM(r),u="x"===RM(r),l=["left","top"].includes(s)?-1:1,f=a&&u?-1:1,h="function"==typeof n?n(t):n,d="number"==typeof h?{mainAxis:h,crossAxis:0,alignmentAxis:null}:Oi({mainAxis:0,crossAxis:0,alignmentAxis:null},h),v=d.mainAxis,p=d.crossAxis,m=d.alignmentAxis,e.abrupt("return",(c&&"number"==typeof m&&(p="end"===c?-1*m:m),u?{x:p*f,y:v*l}:{x:v*l,y:p*f}));case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(t,e);case 4:return o=n.sent,n.abrupt("return",{x:r+o.x,y:i+o.y,data:o});case 6:case"end":return n.stop()}}),n)})))()}}};function YM(e){return "x"===e?"y":"x"}var XM=function(e){return void 0===e&&(e={}),{name:"shift",options:e,fn:function(t){return ji(xi().mark((function n(){var r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b,w,x,k,j;return xi().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.x,o=t.y,a=t.placement,c=(s=e).mainAxis,u=void 0===c||c,l=s.crossAxis,f=void 0!==l&&l,h=s.limiter,d=void 0===h?{fn:function(e){return {x:e.x,y:e.y}}}:h,v=bi(s,pi),p={x:i,y:o},n.next=14,BM(t,v);case 14:return m=n.sent,g=RM(TM(a)),y=YM(g),b=p[g],w=p[y],u&&(x="y"===g?"bottom":"right",b=VM(b+m["y"===g?"top":"left"],b,b-m[x])),f&&(k="y"===y?"bottom":"right",w=VM(w+m["y"===y?"top":"left"],w,w-m[k])),j=d.fn(Oi(Oi({},t),{},(Mi(r={},g,b),Mi(r,y,w),r))),n.abrupt("return",Oi(Oi({},j),{},{data:{x:j.x-i,y:j.y-o}}));case 22:case"end":return n.stop()}}),n)})))()}}};function ZM(e){var t;return (null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function eE(e){return ZM(e).getComputedStyle(e)}var tE,nE=Math.min,rE=Math.max,iE=Math.round;function oE(e){var t=eE(e),n=parseFloat(t.width),r=parseFloat(t.height),i=e.offsetWidth,o=e.offsetHeight,a=iE(n)!==i||iE(r)!==o;return a&&(n=i,r=o),{width:n,height:r,fallback:a}}function aE(e){return lE(e)?(e.nodeName||"").toLowerCase():""}function sE(){if(tE)return tE;var e=navigator.userAgentData;return e&&Array.isArray(e.brands)?tE=e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function cE(e){return e instanceof ZM(e).HTMLElement}function uE(e){return e instanceof ZM(e).Element}function lE(e){return e instanceof ZM(e).Node}function fE(e){return "undefined"!=typeof ShadowRoot&&(e instanceof ZM(e).ShadowRoot||e instanceof ShadowRoot)}function hE(e){var t=eE(e),n=t.overflow,r=t.overflowX,i=t.overflowY,o=t.display;return /auto|scroll|overlay|hidden|clip/.test(n+i+r)&&!["inline","contents"].includes(o)}function dE(e){return ["table","td","th"].includes(aE(e))}function vE(e){var t=/firefox/i.test(sE()),n=eE(e),r=n.backdropFilter||n.WebkitBackdropFilter;return "none"!==n.transform||"none"!==n.perspective||!!r&&"none"!==r||t&&"filter"===n.willChange||t&&!!n.filter&&"none"!==n.filter||["transform","perspective"].some((function(e){return n.willChange.includes(e)}))||["paint","layout","strict","content"].some((function(e){var t=n.contain;return null!=t&&t.includes(e)}))}function pE(){return /^((?!chrome|android).)*safari/i.test(sE())}function mE(e){return ["html","body","#document"].includes(aE(e))}function gE(e){return uE(e)?e:e.contextElement}var yE={x:1,y:1};function bE(e){var t=gE(e);if(!cE(t))return yE;var n=t.getBoundingClientRect(),r=oE(t),i=r.width,o=r.height,a=r.fallback,s=(a?iE(n.width):n.width)/i,c=(a?iE(n.height):n.height)/o;return s&&Number.isFinite(s)||(s=1),c&&Number.isFinite(c)||(c=1),{x:s,y:c}}function wE(e,t,n,r){var i,o;void 0===t&&(t=!1),void 0===n&&(n=!1);var a=e.getBoundingClientRect(),s=gE(e),c=yE;t&&(r?uE(r)&&(c=bE(r)):c=bE(e));var u=s?ZM(s):window,l=pE()&&n,f=(a.left+(l&&(null==(i=u.visualViewport)?void 0:i.offsetLeft)||0))/c.x,h=(a.top+(l&&(null==(o=u.visualViewport)?void 0:o.offsetTop)||0))/c.y,d=a.width/c.x,v=a.height/c.y;if(s)for(var p=ZM(s),m=r&&uE(r)?ZM(r):r,g=p.frameElement;g&&r&&m!==p;){var y=bE(g),b=g.getBoundingClientRect(),w=getComputedStyle(g);b.x+=(g.clientLeft+parseFloat(w.paddingLeft))*y.x,b.y+=(g.clientTop+parseFloat(w.paddingTop))*y.y,f*=y.x,h*=y.y,d*=y.x,v*=y.y,f+=b.x,h+=b.y,g=ZM(g).frameElement;}return {width:d,height:v,top:h,right:f+d,bottom:h+v,left:f,x:f,y:h}}function xE(e){return ((lE(e)?e.ownerDocument:e.document)||window.document).documentElement}function kE(e){return uE(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function jE(e){return wE(xE(e)).left+kE(e).scrollLeft}function SE(e){if("html"===aE(e))return e;var t=e.assignedSlot||e.parentNode||fE(e)&&e.host||xE(e);return fE(t)?t.host:t}function CE(e){var t=SE(e);return mE(t)?t.ownerDocument.body:cE(t)&&hE(t)?t:CE(t)}function $E(e,t){var n;void 0===t&&(t=[]);var r=CE(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),o=ZM(r);return i?t.concat(o,o.visualViewport||[],hE(r)?r:[]):t.concat(r,$E(r))}function _E(e,t,n){var r;if("viewport"===t)r=function(e,t){var n=ZM(e),r=xE(e),i=n.visualViewport,o=r.clientWidth,a=r.clientHeight,s=0,c=0;if(i){o=i.width,a=i.height;var u=pE();(!u||u&&"fixed"===t)&&(s=i.offsetLeft,c=i.offsetTop);}return {width:o,height:a,x:s,y:c}}(e,n);else if("document"===t)r=function(e){var t=xE(e),n=kE(e),r=e.ownerDocument.body,i=rE(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=rE(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight),a=-n.scrollLeft+jE(e),s=-n.scrollTop;return "rtl"===eE(r).direction&&(a+=rE(t.clientWidth,r.clientWidth)-i),{width:i,height:o,x:a,y:s}}(xE(e));else if(uE(t))r=function(e,t){var n=wE(e,!0,"fixed"===t),r=n.top+e.clientTop,i=n.left+e.clientLeft,o=cE(e)?bE(e):{x:1,y:1};return {width:e.clientWidth*o.x,height:e.clientHeight*o.y,x:i*o.x,y:r*o.y}}(t,n);else {var i=Oi({},t);if(pE()){var o,a,s=ZM(e);i.x-=(null==(o=s.visualViewport)?void 0:o.offsetLeft)||0,i.y-=(null==(a=s.visualViewport)?void 0:a.offsetTop)||0;}r=i;}return LM(r)}function OE(e,t){return cE(e)&&"fixed"!==eE(e).position?t?t(e):e.offsetParent:null}function ME(e,t){for(var n=ZM(e),r=OE(e,t);r&&dE(r)&&"static"===eE(r).position;)r=OE(r,t);return r&&("html"===aE(r)||"body"===aE(r)&&"static"===eE(r).position&&!vE(r))?n:r||function(e){for(var t=SE(e);cE(t)&&!mE(t);){if(vE(t))return t;t=SE(t);}return null}(e)||n}function EE(e,t,n){var r=cE(t),i=xE(t),o=wE(e,!0,"fixed"===n,t),a={scrollLeft:0,scrollTop:0},s={x:0,y:0};if(r||!r&&"fixed"!==n)if(("body"!==aE(t)||hE(i))&&(a=kE(t)),cE(t)){var c=wE(t,!0);s.x=c.x+t.clientLeft,s.y=c.y+t.clientTop;}else i&&(s.x=jE(i));return {x:o.left+a.scrollLeft-s.x,y:o.top+a.scrollTop-s.y,width:o.width,height:o.height}}var AE={getClippingRect:function(e){var t=e.element,n=e.boundary,r=e.rootBoundary,i=e.strategy,o="clippingAncestors"===n?function(e,t){var n=t.get(e);if(n)return n;for(var r=$E(e).filter((function(e){return uE(e)&&"body"!==aE(e)})),i=null,o="fixed"===eE(e).position,a=o?SE(e):e;uE(a)&&!mE(a);){var s=eE(a),c=vE(a);"fixed"===s.position?i=null:(o?c||i:c||"static"!==s.position||!i||!["absolute","fixed"].includes(i.position))?i=s:r=r.filter((function(e){return e!==a})),a=SE(a);}return t.set(e,r),r}(t,this._c):[].concat(n),a=[].concat(Vi(o),[r]),s=a[0],c=a.reduce((function(e,n){var r=_E(t,n,i);return e.top=rE(r.top,e.top),e.right=nE(r.right,e.right),e.bottom=nE(r.bottom,e.bottom),e.left=rE(r.left,e.left),e}),_E(t,s,i));return {width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){var t=e.rect,n=e.offsetParent,r=e.strategy,i=cE(n),o=xE(n);if(n===o)return t;var a={scrollLeft:0,scrollTop:0},s={x:1,y:1},c={x:0,y:0};if((i||!i&&"fixed"!==r)&&(("body"!==aE(n)||hE(o))&&(a=kE(n)),cE(n))){var u=wE(n);s=bE(n),c.x=u.x+n.clientLeft,c.y=u.y+n.clientTop;}return {width:t.width*s.x,height:t.height*s.y,x:t.x*s.x-a.scrollLeft*s.x+c.x,y:t.y*s.y-a.scrollTop*s.y+c.y}},isElement:uE,getDimensions:function(e){return cE(e)?oE(e):e.getBoundingClientRect()},getOffsetParent:ME,getDocumentElement:xE,getScale:bE,getElementRects:function(e){var t=this;return ji(xi().mark((function n(){var r,i,o,a,s;return xi().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.reference,i=e.floating,o=e.strategy,a=t.getOffsetParent||ME,s=t.getDimensions,n.t0=EE,n.t1=r,n.next=6,a(i);case 6:return n.t2=n.sent,n.t3=o,n.t4=(0, n.t0)(n.t1,n.t2,n.t3),n.t5=Oi,n.t6={x:0,y:0},n.next=13,s(i);case 13:return n.t7=n.sent,n.t8=(0, n.t5)(n.t6,n.t7),n.abrupt("return",{reference:n.t4,floating:n.t8});case 16:case"end":return n.stop()}}),n)})))()},getClientRects:function(e){return Array.from(e.getClientRects())},isRTL:function(e){return "rtl"===eE(e).direction}};function PE(e,t,n,r){void 0===r&&(r={});var i=r,o=i.ancestorScroll,a=void 0===o||o,s=i.ancestorResize,c=void 0===s||s,u=i.elementResize,l=void 0===u||u,f=i.animationFrame,h=void 0!==f&&f,d=a&&!h,v=d||c?[].concat(Vi(uE(e)?$E(e):e.contextElement?$E(e.contextElement):[]),Vi($E(t))):[];v.forEach((function(e){d&&e.addEventListener("scroll",n,{passive:!0}),c&&e.addEventListener("resize",n);}));var p,m=null;if(l){var g=!0;m=new ResizeObserver((function(){g||n(),g=!1;})),uE(e)&&!h&&m.observe(e),uE(e)||!e.contextElement||h||m.observe(e.contextElement),m.observe(t);}var y=h?wE(e):null;return h&&function t(){var r=wE(e);!y||r.x===y.x&&r.y===y.y&&r.width===y.width&&r.height===y.height||n(),y=r,p=requestAnimationFrame(t);}(),n(),function(){var e;v.forEach((function(e){d&&e.removeEventListener("scroll",n),c&&e.removeEventListener("resize",n);})),null==(e=m)||e.disconnect(),m=null,h&&cancelAnimationFrame(p);}}function TE(e){var t,n,r={autoUpdate:!0},i=e,o=function(t){return Oi(Oi(Oi({},r),e||{}),t||{})},a=function(e){t&&n&&(i=o(e),function(e,t,n){var r=new Map,i=Oi({platform:AE},n),o=Oi(Oi({},i.platform),{},{_c:r});return IM(e,t,Oi(Oi({},i),{},{platform:o}))}(t,n,i).then((function(e){var t;Object.assign(n.style,{position:e.strategy,left:"".concat(e.x,"px"),top:"".concat(e.y,"px")}),(null===(t=i)||void 0===t?void 0:t.onComputed)&&i.onComputed(e);})));},s=function(e){ta(e.subscribe((function(e){void 0===t?(t=e,a()):(Object.assign(t,e),a());})));};return [function(e){if("subscribe"in e)return s(e),{};t=e,a();},function(e,r){var s;n=e,i=o(r),setTimeout((function(){return a(r)}),0),a(r);var c=function(){s&&(s(),s=void 0);},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i||{},r=e.autoUpdate;if(c(),!1!==r)return PE(t,n,(function(){return a(i)}),!0===r?{}:r)};return s=u(),{update:function(e){a(e),s=u(e);},destroy:function(){c();}}},a]}function RE(e){var t=e.loadOptions,n=e.filterText,r=e.items,i=e.multiple,o=e.value,a=e.itemId,s=e.groupBy,c=e.filterSelectedItems,u=e.itemFilter,l=e.convertStringItemsToObjects,f=e.filterGroupedItems,h=e.label;if(r&&t)return r;if(!r)return [];r&&r.length>0&&"object"!==Ji(r[0])&&(r=l(r));var d=r.filter((function(e){var t=u(e[h],n,e);return t&&i&&null!=o&&o.length&&(t=!o.some((function(t){return !!c&&t[a]===e[a]}))),t}));return s&&(d=f(d)),d}function NE(e){return IE.apply(this,arguments)}function IE(){return IE=ji(xi().mark((function e(t){var n,r,i,o,a;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dispatch,r=t.loadOptions,i=t.convertStringItemsToObjects,o=t.filterText,e.next=3,r(o).catch((function(e){console.warn("svelte-select loadOptions error :>> ",e),n("error",{type:"loadOptions",details:e});}));case 3:if(!(a=e.sent)||a.cancelled){e.next=7;break}return a?(a&&a.length>0&&"object"!==Ji(a[0])&&(a=i(a)),n("loaded",{items:a})):a=[],e.abrupt("return",{filteredItems:a,loading:!1,focused:!0,listOpen:!0});case 7:case"end":return e.stop()}}),e)}))),IE.apply(this,arguments)}function DE(e){bo(e,"svelte-qbd276","svg.svelte-qbd276{width:var(--chevron-icon-width, 20px);height:var(--chevron-icon-width, 20px);color:var(--chevron-icon-colour, currentColor)}");}function LE(e){var t,n;return {c:function(){t=_o("svg"),Ro(n=_o("path"),"fill","currentColor"),Ro(n,"d","M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747\n          3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0\n          1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502\n          0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0\n          0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"),Ro(t,"width","100%"),Ro(t,"height","100%"),Ro(t,"viewBox","0 0 20 20"),Ro(t,"focusable","false"),Ro(t,"aria-hidden","true"),Ro(t,"class","svelte-qbd276");},m:function(e,r){jo(e,t,r),yo(t,n);},p:Ki,i:Ki,o:Ki,d:function(e){e&&So(t);}}}var BE=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,null,LE,to,{},DE),r}return qi(n)}();function zE(e){bo(e,"svelte-whdbu1","svg.svelte-whdbu1{width:var(--clear-icon-width, 20px);height:var(--clear-icon-width, 20px);color:var(--clear-icon-color, currentColor)}");}function qE(e){var t,n;return {c:function(){t=_o("svg"),Ro(n=_o("path"),"fill","currentColor"),Ro(n,"d","M34.923,37.251L24,26.328L13.077,37.251L9.436,33.61l10.923-10.923L9.436,11.765l3.641-3.641L24,19.047L34.923,8.124\n    l3.641,3.641L27.641,22.688L38.564,33.61L34.923,37.251z"),Ro(t,"width","100%"),Ro(t,"height","100%"),Ro(t,"viewBox","-2 -2 50 50"),Ro(t,"focusable","false"),Ro(t,"aria-hidden","true"),Ro(t,"role","presentation"),Ro(t,"class","svelte-whdbu1");},m:function(e,r){jo(e,t,r),yo(t,n);},p:Ki,i:Ki,o:Ki,d:function(e){e&&So(t);}}}var FE=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,null,qE,to,{},zE),r}return qi(n)}();function VE(e){bo(e,"svelte-1p3nqvd",".loading.svelte-1p3nqvd{width:var(--spinner-width, 20px);height:var(--spinner-height, 20px);color:var(--spinner-color, var(--icons-color));animation:svelte-1p3nqvd-rotate 0.75s linear infinite;transform-origin:center center;transform:none}.circle_path.svelte-1p3nqvd{stroke-dasharray:90;stroke-linecap:round}@keyframes svelte-1p3nqvd-rotate{100%{transform:rotate(360deg)}}");}function WE(e){var t,n;return {c:function(){t=_o("svg"),Ro(n=_o("circle"),"class","circle_path svelte-1p3nqvd"),Ro(n,"cx","50"),Ro(n,"cy","50"),Ro(n,"r","20"),Ro(n,"fill","none"),Ro(n,"stroke","currentColor"),Ro(n,"stroke-width","5"),Ro(n,"stroke-miterlimit","10"),Ro(t,"class","loading svelte-1p3nqvd"),Ro(t,"viewBox","25 25 50 50");},m:function(e,r){jo(e,t,r),yo(t,n);},p:Ki,i:Ki,o:Ki,d:function(e){e&&So(t);}}}var HE=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,null,WE,to,{},VE),r}return qi(n)}();function UE(e){bo(e,"svelte-apvs86",".svelte-select.svelte-apvs86.svelte-apvs86.svelte-apvs86{--borderRadius:var(--border-radius);--clearSelectColor:var(--clear-select-color);--clearSelectWidth:var(--clear-select-width);--disabledBackground:var(--disabled-background);--disabledBorderColor:var(--disabled-border-color);--disabledColor:var(--disabled-color);--disabledPlaceholderColor:var(--disabled-placeholder-color);--disabledPlaceholderOpacity:var(--disabled-placeholder-opacity);--errorBackground:var(--error-background);--errorBorder:var(--error-border);--groupItemPaddingLeft:var(--group-item-padding-left);--groupTitleColor:var(--group-title-color);--groupTitleFontSize:var(--group-title-font-size);--groupTitleFontWeight:var(--group-title-font-weight);--groupTitlePadding:var(--group-title-padding);--groupTitleTextTransform:var(--group-title-text-transform);--indicatorColor:var(--chevron-color);--indicatorHeight:var(--chevron-height);--indicatorWidth:var(--chevron-width);--inputColor:var(--input-color);--inputLeft:var(--input-left);--inputLetterSpacing:var(--input-letter-spacing);--inputMargin:var(--input-margin);--inputPadding:var(--input-padding);--itemActiveBackground:var(--item-active-background);--itemColor:var(--item-color);--itemFirstBorderRadius:var(--item-first-border-radius);--itemHoverBG:var(--item-hover-bg);--itemHoverColor:var(--item-hover-color);--itemIsActiveBG:var(--item-is-active-bg);--itemIsActiveColor:var(--item-is-active-color);--itemIsNotSelectableColor:var(--item-is-not-selectable-color);--itemPadding:var(--item-padding);--listBackground:var(--list-background);--listBorder:var(--list-border);--listBorderRadius:var(--list-border-radius);--listEmptyColor:var(--list-empty-color);--listEmptyPadding:var(--list-empty-padding);--listEmptyTextAlign:var(--list-empty-text-align);--listMaxHeight:var(--list-max-height);--listPosition:var(--list-position);--listShadow:var(--list-shadow);--listZIndex:var(--list-z-index);--multiItemBG:var(--multi-item-bg);--multiItemBorderRadius:var(--multi-item-border-radius);--multiItemDisabledHoverBg:var(--multi-item-disabled-hover-bg);--multiItemDisabledHoverColor:var(--multi-item-disabled-hover-color);--multiItemHeight:var(--multi-item-height);--multiItemMargin:var(--multi-item-margin);--multiItemPadding:var(--multi-item-padding);--multiSelectInputMargin:var(--multi-select-input-margin);--multiSelectInputPadding:var(--multi-select-input-padding);--multiSelectPadding:var(--multi-select-padding);--placeholderColor:var(--placeholder-color);--placeholderOpacity:var(--placeholder-opacity);--selectedItemPadding:var(--selected-item-padding);--spinnerColor:var(--spinner-color);--spinnerHeight:var(--spinner-height);--spinnerWidth:var(--spinner-width);--internal-padding:0 0 0 16px;border:var(--border, 1px solid #d8dbdf);border-radius:var(--border-radius, 6px);min-height:var(--height, 42px);position:relative;display:flex;align-items:stretch;padding:var(--padding, var(--internal-padding));background:var(--background, #fff);margin:var(--margin, 0);width:var(--width, 100%);font-size:var(--font-size, 16px);max-height:var(--max-height)}.svelte-apvs86.svelte-apvs86.svelte-apvs86{box-sizing:var(--box-sizing, border-box)}.svelte-select.svelte-apvs86.svelte-apvs86.svelte-apvs86:hover{border:var(--border-hover, 1px solid #b2b8bf)}.value-container.svelte-apvs86.svelte-apvs86.svelte-apvs86{display:flex;flex:1 1 0%;flex-wrap:wrap;align-items:center;gap:5px 10px;padding:var(--value-container-padding, 5px 0);position:relative;overflow:var(--value-container-overflow, hidden);align-self:stretch}.prepend.svelte-apvs86.svelte-apvs86.svelte-apvs86,.indicators.svelte-apvs86.svelte-apvs86.svelte-apvs86{display:flex;flex-shrink:0;align-items:center}.indicators.svelte-apvs86.svelte-apvs86.svelte-apvs86{position:var(--indicators-position);top:var(--indicators-top);right:var(--indicators-right);bottom:var(--indicators-bottom)}input.svelte-apvs86.svelte-apvs86.svelte-apvs86{position:absolute;cursor:default;border:none;color:var(--input-color, var(--item-color));padding:var(--input-padding, 0);letter-spacing:var(--input-letter-spacing, inherit);margin:var(--input-margin, 0);min-width:10px;top:0;right:0;bottom:0;left:0;background:transparent;font-size:var(--font-size, 16px)}.svelte-apvs86:not(.multi)>.value-container.svelte-apvs86>input.svelte-apvs86{width:100%;height:100%}input.svelte-apvs86.svelte-apvs86.svelte-apvs86::placeholder{color:var(--placeholder-color, #78848f);opacity:var(--placeholder-opacity, 1)}input.svelte-apvs86.svelte-apvs86.svelte-apvs86:focus{outline:none}.svelte-select.focused.svelte-apvs86.svelte-apvs86.svelte-apvs86{border:var(--border-focused, 1px solid #006fe8);border-radius:var(--border-radius-focused, var(--border-radius, 6px))}.disabled.svelte-apvs86.svelte-apvs86.svelte-apvs86{background:var(--disabled-background, #ebedef);border-color:var(--disabled-border-color, #ebedef);color:var(--disabled-color, #c1c6cc)}.disabled.svelte-apvs86 input.svelte-apvs86.svelte-apvs86::placeholder{color:var(--disabled-placeholder-color, #c1c6cc);opacity:var(--disabled-placeholder-opacity, 1)}.selected-item.svelte-apvs86.svelte-apvs86.svelte-apvs86{position:relative;overflow:var(--selected-item-overflow, hidden);padding:var(--selected-item-padding, 0 20px 0 0);text-overflow:ellipsis;white-space:nowrap;color:var(--selected-item-color, inherit);font-size:var(--font-size, 16px)}.multi.svelte-apvs86 .selected-item.svelte-apvs86.svelte-apvs86{position:absolute;line-height:var(--height, 42px);height:var(--height, 42px)}.selected-item.svelte-apvs86.svelte-apvs86.svelte-apvs86:focus{outline:none}.hide-selected-item.svelte-apvs86.svelte-apvs86.svelte-apvs86{opacity:0}.icon.svelte-apvs86.svelte-apvs86.svelte-apvs86{display:flex;align-items:center;justify-content:center}.clear-select.svelte-apvs86.svelte-apvs86.svelte-apvs86{all:unset;display:flex;align-items:center;justify-content:center;width:var(--clear-select-width, 40px);height:var(--clear-select-height, 100%);color:var(--clear-select-color, var(--icons-color));margin:var(--clear-select-margin, 0);pointer-events:all;flex-shrink:0}.clear-select.svelte-apvs86.svelte-apvs86.svelte-apvs86:focus{outline:var(--clear-select-focus-outline, 1px solid #006fe8)}.loading.svelte-apvs86.svelte-apvs86.svelte-apvs86{width:var(--loading-width, 40px);height:var(--loading-height);color:var(--loading-color, var(--icons-color));margin:var(--loading--margin, 0);flex-shrink:0}.chevron.svelte-apvs86.svelte-apvs86.svelte-apvs86{width:var(--chevron-width, 40px);height:var(--chevron-height, 40px);background:var(--chevron-background, transparent);pointer-events:var(--chevron-pointer-events, none);color:var(--chevron-color, var(--icons-color));border:var(--chevron-border, 0 0 0 1px solid #d8dbdf);flex-shrink:0}.multi.svelte-apvs86.svelte-apvs86.svelte-apvs86{padding:var(--multi-select-padding, var(--internal-padding))}.multi.svelte-apvs86 input.svelte-apvs86.svelte-apvs86{padding:var(--multi-select-input-padding, 0);position:relative;margin:var(--multi-select-input-margin, 5px 0);flex:1 1 40px}.svelte-select.error.svelte-apvs86.svelte-apvs86.svelte-apvs86{border:var(--error-border, 1px solid #ff2d55);background:var(--error-background, #fff)}.a11y-text.svelte-apvs86.svelte-apvs86.svelte-apvs86{z-index:9999;border:0px;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0px;white-space:nowrap}.multi-item.svelte-apvs86.svelte-apvs86.svelte-apvs86{background:var(--multi-item-bg, #ebedef);margin:var(--multi-item-margin, 0);outline:var(--multi-item-outline, 1px solid #ddd);border-radius:var(--multi-item-border-radius, 4px);height:var(--multi-item-height, 25px);line-height:var(--multi-item-height, 25px);display:flex;cursor:default;padding:var(--multi-item-padding, 0 5px);overflow:hidden;gap:var(--multi-item-gap, 4px);outline-offset:-1px;max-width:var(--multi-max-width, none);color:var(--multi-item-color, var(--item-color))}.multi-item.disabled.svelte-apvs86.svelte-apvs86.svelte-apvs86:hover{background:var(--multi-item-disabled-hover-bg, #ebedef);color:var(--multi-item-disabled-hover-color, #c1c6cc)}.multi-item-text.svelte-apvs86.svelte-apvs86.svelte-apvs86{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.multi-item-clear.svelte-apvs86.svelte-apvs86.svelte-apvs86{display:flex;align-items:center;justify-content:center;--clear-icon-color:var(--multi-item-clear-icon-color, #000)}.multi-item.active.svelte-apvs86.svelte-apvs86.svelte-apvs86{outline:var(--multi-item-active-outline, 1px solid #006fe8)}.svelte-select-list.svelte-apvs86.svelte-apvs86.svelte-apvs86{box-shadow:var(--list-shadow, 0 2px 3px 0 rgba(44, 62, 80, 0.24));border-radius:var(--list-border-radius, 4px);max-height:var(--list-max-height, 252px);overflow-y:auto;background:var(--list-background, #fff);position:var(--list-position, absolute);z-index:var(--list-z-index, 2);border:var(--list-border)}.prefloat.svelte-apvs86.svelte-apvs86.svelte-apvs86{opacity:0;pointer-events:none}.list-group-title.svelte-apvs86.svelte-apvs86.svelte-apvs86{color:var(--group-title-color, #8f8f8f);cursor:default;font-size:var(--group-title-font-size, 16px);font-weight:var(--group-title-font-weight, 600);height:var(--height, 42px);line-height:var(--height, 42px);padding:var(--group-title-padding, 0 20px);text-overflow:ellipsis;overflow-x:hidden;white-space:nowrap;text-transform:var(--group-title-text-transform, uppercase)}.empty.svelte-apvs86.svelte-apvs86.svelte-apvs86{text-align:var(--list-empty-text-align, center);padding:var(--list-empty-padding, 20px 0);color:var(--list-empty-color, #78848f)}.item.svelte-apvs86.svelte-apvs86.svelte-apvs86{cursor:default;height:var(--item-height, var(--height, 42px));line-height:var(--item-line-height, var(--height, 42px));padding:var(--item-padding, 0 20px);color:var(--item-color, inherit);text-overflow:ellipsis;overflow:hidden;white-space:nowrap;transition:var(--item-transition, all 0.2s);align-items:center;width:100%}.item.group-item.svelte-apvs86.svelte-apvs86.svelte-apvs86{padding-left:var(--group-item-padding-left, 40px)}.item.svelte-apvs86.svelte-apvs86.svelte-apvs86:active{background:var(--item-active-background, #b9daff)}.item.active.svelte-apvs86.svelte-apvs86.svelte-apvs86{background:var(--item-is-active-bg, #007aff);color:var(--item-is-active-color, #fff)}.item.first.svelte-apvs86.svelte-apvs86.svelte-apvs86{border-radius:var(--item-first-border-radius, 4px 4px 0 0)}.item.hover.svelte-apvs86.svelte-apvs86.svelte-apvs86:not(.active){background:var(--item-hover-bg, #e7f2ff);color:var(--item-hover-color, inherit)}.item.not-selectable.svelte-apvs86.svelte-apvs86.svelte-apvs86,.item.hover.item.not-selectable.svelte-apvs86.svelte-apvs86.svelte-apvs86,.item.active.item.not-selectable.svelte-apvs86.svelte-apvs86.svelte-apvs86,.item.not-selectable.svelte-apvs86.svelte-apvs86.svelte-apvs86:active{color:var(--item-is-not-selectable-color, #999);background:transparent}.required.svelte-apvs86.svelte-apvs86.svelte-apvs86{opacity:0;z-index:-1;position:absolute;top:0;left:0;bottom:0;right:0}");}var JE=function(e){return {value:8&e[0]}},KE=function(e){return {value:e[3]}},GE=function(e){return {value:8&e[0]}},QE=function(e){return {value:e[3]}},YE=function(e){return {listOpen:64&e[0]}},XE=function(e){return {listOpen:e[6]}},ZE=function(e){return {}},eA=function(e){return {}},tA=function(e){return {}},nA=function(e){return {}},rA=function(e){return {selection:8&e[0]}},iA=function(e){return {selection:e[3]}};function oA(e,t,n){var r=e.slice();return r[125]=t[n],r[127]=n,r}var aA=function(e){return {}},sA=function(e){return {}},cA=function(e){return {selection:8&e[0]}},uA=function(e){return {selection:e[125],index:e[127]}},lA=function(e){return {}},fA=function(e){return {}},hA=function(e){return {}},dA=function(e){return {}},vA=function(e){return {}},pA=function(e){return {}};function mA(e,t,n){var r=e.slice();return r[125]=t[n],r[127]=n,r}var gA=function(e){return {item:16777216&e[0]}},yA=function(e){return {item:e[125],index:e[127]}},bA=function(e){return {filteredItems:16777216&e[0]}},wA=function(e){return {filteredItems:e[24]}},xA=function(e){return {}},kA=function(e){return {}};function jA(e){var t,n,r,i,o,a,s,c,u=e[50]["list-prepend"]&&SA(e),l=[_A,$A,CA],f=[];function h(e,t){return e[50].list?0:e[24].length>0?1:e[19]?-1:2}~(r=h(e))&&(i=f[r]=l[r](e));var d=e[50]["list-append"]&&MA(e);return {c:function(){t=$o("div"),u&&u.c(),n=Mo(),i&&i.c(),o=Mo(),d&&d.c(),Ro(t,"class","svelte-select-list svelte-apvs86"),Fo(t,"prefloat",e[28]);},m:function(i,l){jo(i,t,l),u&&u.m(t,null),yo(t,n),~r&&f[r].m(t,null),yo(t,o),d&&d.m(t,null),e[90](t),a=!0,s||(c=[fo(e[49].call(null,t)),Ao(t,"scroll",e[41]),Ao(t,"pointerup",To(Po(e[85])))],s=!0);},p:function(e,s){e[50]["list-prepend"]?u?(u.p(e,s),524288&s[1]&&$a(u,1)):((u=SA(e)).c(),$a(u,1),u.m(t,n)):u&&(Sa(),_a(u,1,1,(function(){u=null;})),Ca());var c=r;(r=h(e))===c?~r&&f[r].p(e,s):(i&&(Sa(),_a(f[c],1,1,(function(){f[c]=null;})),Ca()),~r?((i=f[r])?i.p(e,s):(i=f[r]=l[r](e)).c(),$a(i,1),i.m(t,o)):i=null),e[50]["list-append"]?d?(d.p(e,s),524288&s[1]&&$a(d,1)):((d=MA(e)).c(),$a(d,1),d.m(t,null)):d&&(Sa(),_a(d,1,1,(function(){d=null;})),Ca()),(!a||268435456&s[0])&&Fo(t,"prefloat",e[28]);},i:function(e){a||($a(u),$a(i),$a(d),a=!0);},o:function(e){_a(u),_a(i),_a(d),a=!1;},d:function(n){n&&So(t),u&&u.d(),~r&&f[r].d(),d&&d.d(),e[90](null),s=!1,Zi(c);}}}function SA(e){var t,n=e[82]["list-prepend"],r=ro(n,e,e[81],kA);return {c:function(){r&&r.c();},m:function(e,n){r&&r.m(e,n),t=!0;},p:function(e,i){r&&r.p&&(!t||524288&i[2])&&ao(r,n,e,e[81],t?oo(n,e[81],i,xA):so(e[81]),kA);},i:function(e){t||($a(r,e),t=!0);},o:function(e){_a(r,e),t=!1;},d:function(e){r&&r.d(e);}}}function CA(e){var t,n,r=e[82].empty,i=ro(r,e,e[81],pA),o=i||{c:function(){(n=$o("div")).textContent="No options",Ro(n,"class","empty svelte-apvs86");},m:function(e,t){jo(e,n,t);},p:Ki,d:function(e){e&&So(n);}};return {c:function(){o&&o.c();},m:function(e,n){o&&o.m(e,n),t=!0;},p:function(e,n){i&&i.p&&(!t||524288&n[2])&&ao(i,r,e,e[81],t?oo(r,e[81],n,vA):so(e[81]),pA);},i:function(e){t||($a(o,e),t=!0);},o:function(e){_a(o,e),t=!1;},d:function(e){o&&o.d(e);}}}function $A(e){for(var t,n,r=e[24],i=[],o=0;o<r.length;o+=1)i[o]=OA(mA(e,r,o));var a=function(e){return _a(i[e],1,1,(function(){i[e]=null;}))};return {c:function(){for(var e=0;e<i.length;e+=1)i[e].c();t=Eo();},m:function(e,r){for(var o=0;o<i.length;o+=1)i[o]&&i[o].m(e,r);jo(e,t,r),n=!0;},p:function(e,n){if(1627402376&n[0]|28672&n[1]|524288&n[2]){var o;for(r=e[24],o=0;o<r.length;o+=1){var s=mA(e,r,o);i[o]?(i[o].p(s,n),$a(i[o],1)):(i[o]=OA(s),i[o].c(),$a(i[o],1),i[o].m(t.parentNode,t));}for(Sa(),o=r.length;o<i.length;o+=1)a(o);Ca();}},i:function(e){if(!n){for(var t=0;t<r.length;t+=1)$a(i[t]);n=!0;}},o:function(e){i=i.filter(Boolean);for(var t=0;t<i.length;t+=1)_a(i[t]);n=!1;},d:function(e){Co(i,e),e&&So(t);}}}function _A(e){var t,n=e[82].list,r=ro(n,e,e[81],wA);return {c:function(){r&&r.c();},m:function(e,n){r&&r.m(e,n),t=!0;},p:function(e,i){r&&r.p&&(!t||16777216&i[0]|524288&i[2])&&ao(r,n,e,e[81],t?oo(n,e[81],i,bA):so(e[81]),wA);},i:function(e){t||($a(r,e),t=!0);},o:function(e){_a(r,e),t=!1;},d:function(e){r&&r.d(e);}}}function OA(e){var t,n,r,i,o,a,s,c,u=e[82].item,l=ro(u,e,e[81],yA),f=l||function(e){var t,n,r=(null===(t=e[125])||void 0===t?void 0:t[e[12]])+"";return {c:function(){n=Oo(r);},m:function(e,t){jo(e,n,t);},p:function(e,t){var i;16781312&t[0]&&r!==(r=(null===(i=e[125])||void 0===i?void 0:i[e[12]])+"")&&Lo(n,r);},d:function(e){e&&So(n);}}}(e);function h(){return e[87](e[127])}function d(){return e[88](e[127])}function v(){return e[89](e[125],e[127])}return {c:function(){var r;t=$o("div"),n=$o("div"),f&&f.c(),o=Mo(),Ro(n,"class","item svelte-apvs86"),Fo(n,"list-group-title",e[125].groupHeader),Fo(n,"active",e[45](e[125],e[3],e[13])),Fo(n,"first",0===e[127]),Fo(n,"hover",e[7]===e[127]),Fo(n,"group-item",e[125].groupItem),Fo(n,"not-selectable",!1===(null===(r=e[125])||void 0===r?void 0:r.selectable)),Ro(t,"class","list-item svelte-apvs86"),Ro(t,"tabindex","-1");},m:function(u,l){jo(u,t,l),yo(t,n),f&&f.m(n,null),yo(t,o),a=!0,s||(c=[fo(r=e[46].call(null,n,{scroll:e[45](e[125],e[3],e[13]),listDom:e[30]})),fo(i=e[47].call(null,n,{scroll:e[29]===e[127],listDom:e[30]})),Ao(t,"mouseover",h),Ao(t,"focus",d),Ao(t,"click",To(v)),Ao(t,"keydown",To(Po(e[86])))],s=!0);},p:function(t,o){var s;(e=t,l?l.p&&(!a||16777216&o[0]|524288&o[2])&&ao(l,u,e,e[81],a?oo(u,e[81],o,gA):so(e[81]),yA):f&&f.p&&(!a||16781312&o[0])&&f.p(e,a?o:[-1,-1,-1,-1,-1]),r&&eo(r.update)&&1090527240&o[0]&&r.update.call(null,{scroll:e[45](e[125],e[3],e[13]),listDom:e[30]}),i&&eo(i.update)&&1610612736&o[0]&&i.update.call(null,{scroll:e[29]===e[127],listDom:e[30]}),(!a||16777216&o[0])&&Fo(n,"list-group-title",e[125].groupHeader),(!a||16785416&o[0]|16384&o[1])&&Fo(n,"active",e[45](e[125],e[3],e[13])),(!a||128&o[0])&&Fo(n,"hover",e[7]===e[127]),(!a||16777216&o[0])&&Fo(n,"group-item",e[125].groupItem),!a||16777216&o[0])&&Fo(n,"not-selectable",!1===(null===(s=e[125])||void 0===s?void 0:s.selectable));},i:function(e){a||($a(f,e),a=!0);},o:function(e){_a(f,e),a=!1;},d:function(e){e&&So(t),f&&f.d(e),s=!1,Zi(c);}}}function MA(e){var t,n=e[82]["list-append"],r=ro(n,e,e[81],dA);return {c:function(){r&&r.c();},m:function(e,n){r&&r.m(e,n),t=!0;},p:function(e,i){r&&r.p&&(!t||524288&i[2])&&ao(r,n,e,e[81],t?oo(n,e[81],i,hA):so(e[81]),dA);},i:function(e){t||($a(r,e),t=!0);},o:function(e){_a(r,e),t=!1;},d:function(e){r&&r.d(e);}}}function EA(e){var t,n,r,i,o;return {c:function(){t=$o("span"),n=Oo(e[32]),r=Mo(),i=$o("span"),o=Oo(e[31]),Ro(t,"id","aria-selection"),Ro(t,"class","svelte-apvs86"),Ro(i,"id","aria-context"),Ro(i,"class","svelte-apvs86");},m:function(e,a){jo(e,t,a),yo(t,n),jo(e,r,a),jo(e,i,a),yo(i,o);},p:function(e,t){2&t[1]&&Lo(n,e[32]),1&t[1]&&Lo(o,e[31]);},d:function(e){e&&So(t),e&&So(r),e&&So(i);}}}function AA(e){var t,n,r,i,o=[TA,PA],a=[];function s(e,t){return e[9]?0:1}return t=s(e),n=a[t]=o[t](e),{c:function(){n.c(),r=Eo();},m:function(e,n){a[t].m(e,n),jo(e,r,n),i=!0;},p:function(e,i){var c=t;(t=s(e))===c?a[t].p(e,i):(Sa(),_a(a[c],1,1,(function(){a[c]=null;})),Ca(),(n=a[t])?n.p(e,i):(n=a[t]=o[t](e)).c(),$a(n,1),n.m(r.parentNode,r));},i:function(e){i||($a(n),i=!0);},o:function(e){_a(n),i=!1;},d:function(e){a[t].d(e),e&&So(r);}}}function PA(e){var t,n,r=e[82].selection,i=ro(r,e,e[81],iA),o=i||function(e){var t,n=e[3][e[12]]+"";return {c:function(){t=Oo(n);},m:function(e,n){jo(e,t,n);},p:function(e,r){4104&r[0]&&n!==(n=e[3][e[12]]+"")&&Lo(t,n);},d:function(e){e&&So(t);}}}(e);return {c:function(){t=$o("div"),o&&o.c(),Ro(t,"class","selected-item svelte-apvs86"),Fo(t,"hide-selected-item",e[35]);},m:function(e,r){jo(e,t,r),o&&o.m(t,null),n=!0;},p:function(e,a){i?i.p&&(!n||8&a[0]|524288&a[2])&&ao(i,r,e,e[81],n?oo(r,e[81],a,rA):so(e[81]),iA):o&&o.p&&(!n||4104&a[0])&&o.p(e,n?a:[-1,-1,-1,-1,-1]),(!n||16&a[1])&&Fo(t,"hide-selected-item",e[35]);},i:function(e){n||($a(o,e),n=!0);},o:function(e){_a(o,e),n=!1;},d:function(e){e&&So(t),o&&o.d(e);}}}function TA(e){for(var t,n,r=e[3],i=[],o=0;o<r.length;o+=1)i[o]=NA(oA(e,r,o));var a=function(e){return _a(i[e],1,1,(function(){i[e]=null;}))};return {c:function(){for(var e=0;e<i.length;e+=1)i[e].c();t=Eo();},m:function(e,r){for(var o=0;o<i.length;o+=1)i[o]&&i[o].m(e,r);jo(e,t,r),n=!0;},p:function(e,n){if(67116040&n[0]|32&n[1]|524288&n[2]){var o;for(r=e[3],o=0;o<r.length;o+=1){var s=oA(e,r,o);i[o]?(i[o].p(s,n),$a(i[o],1)):(i[o]=NA(s),i[o].c(),$a(i[o],1),i[o].m(t.parentNode,t));}for(Sa(),o=r.length;o<i.length;o+=1)a(o);Ca();}},i:function(e){if(!n){for(var t=0;t<r.length;t+=1)$a(i[t]);n=!0;}},o:function(e){i=i.filter(Boolean);for(var t=0;t<i.length;t+=1)_a(i[t]);n=!1;},d:function(e){Co(i,e),e&&So(t);}}}function RA(e){var t,n,r,i,o=e[82]["multi-clear-icon"],a=ro(o,e,e[81],sA),s=a||function(e){var t,n;return t=new FE({}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}();function c(){return e[91](e[127])}return {c:function(){t=$o("div"),s&&s.c(),Ro(t,"class","multi-item-clear svelte-apvs86");},m:function(e,o){jo(e,t,o),s&&s.m(t,null),n=!0,r||(i=Ao(t,"pointerup",To(Po(c))),r=!0);},p:function(t,r){e=t,a&&a.p&&(!n||524288&r[2])&&ao(a,o,e,e[81],n?oo(o,e[81],r,aA):so(e[81]),sA);},i:function(e){n||($a(s,e),n=!0);},o:function(e){_a(s,e),n=!1;},d:function(e){e&&So(t),s&&s.d(e),r=!1,i();}}}function NA(e){var t,n,r,i,o,a,s,c=e[82].selection,u=ro(c,e,e[81],uA),l=u||function(e){var t,n=e[125][e[12]]+"";return {c:function(){t=Oo(n);},m:function(e,n){jo(e,t,n);},p:function(e,r){4104&r[0]&&n!==(n=e[125][e[12]]+"")&&Lo(t,n);},d:function(e){e&&So(t);}}}(e),f=!e[11]&&!e[10]&&FE&&RA(e);function h(){return e[92](e[127])}return {c:function(){t=$o("div"),n=$o("span"),l&&l.c(),r=Mo(),f&&f.c(),i=Mo(),Ro(n,"class","multi-item-text svelte-apvs86"),Ro(t,"class","multi-item svelte-apvs86"),Fo(t,"active",e[26]===e[127]),Fo(t,"disabled",e[11]);},m:function(c,u){jo(c,t,u),yo(t,n),l&&l.m(n,null),yo(t,r),f&&f.m(t,null),yo(t,i),o=!0,a||(s=[Ao(t,"click",Po(h)),Ao(t,"keydown",To(Po(e[84])))],a=!0);},p:function(n,r){e=n,u?u.p&&(!o||8&r[0]|524288&r[2])&&ao(u,c,e,e[81],o?oo(c,e[81],r,cA):so(e[81]),uA):l&&l.p&&(!o||4104&r[0])&&l.p(e,o?r:[-1,-1,-1,-1,-1]),e[11]||e[10]||!FE?f&&(Sa(),_a(f,1,1,(function(){f=null;})),Ca()):f?(f.p(e,r),3072&r[0]&&$a(f,1)):((f=RA(e)).c(),$a(f,1),f.m(t,i)),(!o||67108864&r[0])&&Fo(t,"active",e[26]===e[127]),(!o||2048&r[0])&&Fo(t,"disabled",e[11]);},i:function(e){o||($a(l,e),$a(f),o=!0);},o:function(e){_a(l,e),_a(f),o=!1;},d:function(e){e&&So(t),l&&l.d(e),f&&f.d(),a=!1,Zi(s);}}}function IA(e){var t,n,r=e[82]["loading-icon"],i=ro(r,e,e[81],nA),o=i||function(e){var t,n;return t=new HE({}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}();return {c:function(){t=$o("div"),o&&o.c(),Ro(t,"class","icon loading svelte-apvs86"),Ro(t,"aria-hidden","true");},m:function(e,r){jo(e,t,r),o&&o.m(t,null),n=!0;},p:function(e,t){i&&i.p&&(!n||524288&t[2])&&ao(i,r,e,e[81],n?oo(r,e[81],t,tA):so(e[81]),nA);},i:function(e){n||($a(o,e),n=!0);},o:function(e){_a(o,e),n=!1;},d:function(e){e&&So(t),o&&o.d(e);}}}function DA(e){var t,n,r,i,o=e[82]["clear-icon"],a=ro(o,e,e[81],eA),s=a||function(e){var t,n;return t=new FE({}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}();return {c:function(){t=$o("button"),s&&s.c(),Ro(t,"class","icon clear-select svelte-apvs86");},m:function(o,a){jo(o,t,a),s&&s.m(t,null),n=!0,r||(i=Ao(t,"pointerup",To(Po(e[22]))),r=!0);},p:function(e,t){a&&a.p&&(!n||524288&t[2])&&ao(a,o,e,e[81],n?oo(o,e[81],t,ZE):so(e[81]),eA);},i:function(e){n||($a(s,e),n=!0);},o:function(e){_a(s,e),n=!1;},d:function(e){e&&So(t),s&&s.d(e),r=!1,i();}}}function LA(e){var t,n,r=e[82]["chevron-icon"],i=ro(r,e,e[81],XE),o=i||function(e){var t,n;return t=new BE({}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}();return {c:function(){t=$o("div"),o&&o.c(),Ro(t,"class","icon chevron svelte-apvs86"),Ro(t,"aria-hidden","true");},m:function(e,r){jo(e,t,r),o&&o.m(t,null),n=!0;},p:function(e,t){i&&i.p&&(!n||64&t[0]|524288&t[2])&&ao(i,r,e,e[81],n?oo(r,e[81],t,YE):so(e[81]),XE);},i:function(e){n||($a(o,e),n=!0);},o:function(e){_a(o,e),n=!1;},d:function(e){e&&So(t),o&&o.d(e);}}}function BA(e){var t,n,r=e[82].required,i=ro(r,e,e[81],KE),o=i||{c:function(){Ro(n=$o("select"),"class","required svelte-apvs86"),n.required=!0,Ro(n,"tabindex","-1"),Ro(n,"aria-hidden","true");},m:function(e,t){jo(e,n,t);},p:Ki,d:function(e){e&&So(n);}};return {c:function(){o&&o.c();},m:function(e,n){o&&o.m(e,n),t=!0;},p:function(e,n){i&&i.p&&(!t||8&n[0]|524288&n[2])&&ao(i,r,e,e[81],t?oo(r,e[81],n,JE):so(e[81]),KE);},i:function(e){t||($a(o,e),t=!0);},o:function(e){_a(o,e),t=!1;},d:function(e){o&&o.d(e);}}}function zA(e){for(var t,n,r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b,w,x=e[6]&&jA(e),k=e[2]&&EA(e),j=e[82].prepend,S=ro(j,e,e[81],fA),C=e[25]&&AA(e),$=[{readOnly:l=!e[17]},e[27],{placeholder:e[33]},{style:e[18]},{disabled:e[11]}],_={},O=0;O<$.length;O+=1)_=Qi(_,$[O]);var M=e[5]&&IA(e),E=e[34]&&DA(e),A=e[20]&&LA(e),P=e[82]["input-hidden"],T=ro(P,e,e[81],QE),R=T||function(e){var t,n;return {c:function(){Ro(t=$o("input"),"name",e[8]),Ro(t,"type","hidden"),t.value=n=e[3]?JSON.stringify(e[3]):null,Ro(t,"class","svelte-apvs86");},m:function(e,n){jo(e,t,n);},p:function(e,r){256&r[0]&&Ro(t,"name",e[8]),8&r[0]&&n!==(n=e[3]?JSON.stringify(e[3]):null)&&(t.value=n);},d:function(e){e&&So(t);}}}(e),N=e[16]&&(!e[3]||0===e[3].length)&&BA(e);return {c:function(){t=$o("div"),x&&x.c(),n=Mo(),r=$o("span"),k&&k.c(),i=Mo(),o=$o("div"),S&&S.c(),a=Mo(),s=$o("div"),C&&C.c(),c=Mo(),u=$o("input"),f=Mo(),h=$o("div"),M&&M.c(),d=Mo(),E&&E.c(),v=Mo(),A&&A.c(),p=Mo(),R&&R.c(),m=Mo(),N&&N.c(),Ro(r,"aria-live","polite"),Ro(r,"aria-atomic","false"),Ro(r,"aria-relevant","additions text"),Ro(r,"class","a11y-text svelte-apvs86"),Ro(o,"class","prepend svelte-apvs86"),No(u,_),Fo(u,"svelte-apvs86",!0),Ro(s,"class","value-container svelte-apvs86"),Ro(h,"class","indicators svelte-apvs86"),Ro(t,"class",g="svelte-select "+e[21]+" svelte-apvs86"),Ro(t,"style",e[14]),Fo(t,"multi",e[9]),Fo(t,"disabled",e[11]),Fo(t,"focused",e[2]),Fo(t,"list-open",e[6]),Fo(t,"show-chevron",e[20]),Fo(t,"error",e[15]);},m:function(l,g){jo(l,t,g),x&&x.m(t,null),yo(t,n),yo(t,r),k&&k.m(r,null),yo(t,i),yo(t,o),S&&S.m(o,null),yo(t,a),yo(t,s),C&&C.m(s,null),yo(s,c),yo(s,u),u.autofocus&&u.focus(),e[93](u),Bo(u,e[4]),yo(t,f),yo(t,h),M&&M.m(h,null),yo(h,d),E&&E.m(h,null),yo(h,v),A&&A.m(h,null),yo(t,p),R&&R.m(t,null),yo(t,m),N&&N.m(t,null),e[95](t),y=!0,b||(w=[Ao(window,"click",e[42]),Ao(window,"keydown",e[37]),Ao(u,"keydown",e[37]),Ao(u,"blur",e[39]),Ao(u,"focus",e[38]),Ao(u,"input",e[94]),Ao(t,"pointerup",Po(e[40])),Ao(t,"mousedown",Po(e[83])),fo(e[48].call(null,t))],b=!0);},p:function(e,i){e[6]?x?(x.p(e,i),64&i[0]&&$a(x,1)):((x=jA(e)).c(),$a(x,1),x.m(t,n)):x&&(Sa(),_a(x,1,1,(function(){x=null;})),Ca()),e[2]?k?k.p(e,i):((k=EA(e)).c(),k.m(r,null)):k&&(k.d(1),k=null),S&&S.p&&(!y||524288&i[2])&&ao(S,j,e,e[81],y?oo(j,e[81],i,lA):so(e[81]),fA),e[25]?C?(C.p(e,i),33554432&i[0]&&$a(C,1)):((C=AA(e)).c(),$a(C,1),C.m(s,c)):C&&(Sa(),_a(C,1,1,(function(){C=null;})),Ca()),No(u,_=Ra($,[(!y||131072&i[0]&&l!==(l=!e[17]))&&{readOnly:l},134217728&i[0]&&e[27],(!y||4&i[1])&&{placeholder:e[33]},(!y||262144&i[0])&&{style:e[18]},(!y||2048&i[0])&&{disabled:e[11]}])),16&i[0]&&u.value!==e[4]&&Bo(u,e[4]),Fo(u,"svelte-apvs86",!0),e[5]?M?(M.p(e,i),32&i[0]&&$a(M,1)):((M=IA(e)).c(),$a(M,1),M.m(h,d)):M&&(Sa(),_a(M,1,1,(function(){M=null;})),Ca()),e[34]?E?(E.p(e,i),8&i[1]&&$a(E,1)):((E=DA(e)).c(),$a(E,1),E.m(h,v)):E&&(Sa(),_a(E,1,1,(function(){E=null;})),Ca()),e[20]?A?(A.p(e,i),1048576&i[0]&&$a(A,1)):((A=LA(e)).c(),$a(A,1),A.m(h,null)):A&&(Sa(),_a(A,1,1,(function(){A=null;})),Ca()),T?T.p&&(!y||8&i[0]|524288&i[2])&&ao(T,P,e,e[81],y?oo(P,e[81],i,GE):so(e[81]),QE):R&&R.p&&(!y||264&i[0])&&R.p(e,y?i:[-1,-1,-1,-1,-1]),!e[16]||e[3]&&0!==e[3].length?N&&(Sa(),_a(N,1,1,(function(){N=null;})),Ca()):N?(N.p(e,i),65544&i[0]&&$a(N,1)):((N=BA(e)).c(),$a(N,1),N.m(t,null)),(!y||2097152&i[0]&&g!==(g="svelte-select "+e[21]+" svelte-apvs86"))&&Ro(t,"class",g),(!y||16384&i[0])&&Ro(t,"style",e[14]),(!y||2097664&i[0])&&Fo(t,"multi",e[9]),(!y||2099200&i[0])&&Fo(t,"disabled",e[11]),(!y||2097156&i[0])&&Fo(t,"focused",e[2]),(!y||2097216&i[0])&&Fo(t,"list-open",e[6]),(!y||3145728&i[0])&&Fo(t,"show-chevron",e[20]),(!y||2129920&i[0])&&Fo(t,"error",e[15]);},i:function(e){y||($a(x),$a(S,e),$a(C),$a(M),$a(E),$a(A),$a(R,e),$a(N),y=!0);},o:function(e){_a(x),_a(S,e),_a(C),_a(M),_a(E),_a(A),_a(R,e),_a(N),y=!1;},d:function(n){n&&So(t),x&&x.d(),k&&k.d(),S&&S.d(n),C&&C.d(),e[93](null),M&&M.d(),E&&E.d(),A&&A.d(),R&&R.d(n),N&&N.d(),e[95](null),b=!1,Zi(w);}}}function qA(e){return e.map((function(e,t){return {index:t,value:e,label:"".concat(e)}}))}function FA(e,t,n){var r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b=t.$$slots,w=void 0===b?{}:b,x=t.$$scope,k=function(e){var t={};for(var n in e)t[n]=!0;return t}(w),j=na(),S=t.justValue,C=void 0===S?null:S,$=t.filter,_=void 0===$?RE:$,O=t.getItems,M=void 0===O?NE:O,E=t.id,A=void 0===E?null:E,P=t.name,T=void 0===P?null:P,R=t.container,N=void 0===R?void 0:R,I=t.input,D=void 0===I?void 0:I,L=t.multiple,B=void 0!==L&&L,z=t.multiFullItemClearable,q=void 0!==z&&z,F=t.disabled,V=void 0!==F&&F,W=t.focused,H=void 0!==W&&W,U=t.value,J=void 0===U?null:U,K=t.filterText,G=void 0===K?"":K,Q=t.placeholder,Y=void 0===Q?"Please select":Q,X=t.placeholderAlwaysShow,Z=void 0!==X&&X,ee=t.items,te=void 0===ee?null:ee,ne=t.label,re=void 0===ne?"label":ne,ie=t.itemFilter,oe=void 0===ie?function(e,t,n){return "".concat(e).toLowerCase().includes(t.toLowerCase())}:ie,ae=t.groupBy,se=void 0===ae?void 0:ae,ce=t.groupFilter,ue=void 0===ce?function(e){return e}:ce,le=t.groupHeaderSelectable,fe=void 0!==le&&le,he=t.itemId,de=void 0===he?"value":he,ve=t.loadOptions,pe=void 0===ve?void 0:ve,me=t.containerStyles,ge=void 0===me?"":me,ye=t.hasError,be=void 0!==ye&&ye,we=t.filterSelectedItems,xe=void 0===we||we,ke=t.required,je=void 0!==ke&&ke,Se=t.closeListOnChange,Ce=void 0===Se||Se,$e=t.createGroupHeaderItem,_e=void 0===$e?function(e,t){return Mi({value:e},re,e)}:$e,Oe=t.searchable,Me=void 0===Oe||Oe,Ee=t.inputStyles,Ae=void 0===Ee?"":Ee,Pe=t.clearable,Te=void 0===Pe||Pe,Re=t.loading,Ne=void 0!==Re&&Re,Ie=t.listOpen,De=void 0!==Ie&&Ie,Le=t.debounce,Be=void 0===Le?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;clearTimeout(h),h=setTimeout(e,t);}:Le,ze=t.debounceWait,qe=void 0===ze?300:ze,Fe=t.hideEmptyState,Ve=void 0!==Fe&&Fe,We=t.inputAttributes,He=void 0===We?{}:We,Ue=t.listAutoWidth,Je=void 0===Ue||Ue,Ke=t.showChevron,Ge=void 0!==Ke&&Ke,Qe=t.listOffset,Ye=void 0===Qe?5:Qe,Xe=t.hoverItemIndex,Ze=void 0===Xe?0:Xe,et=t.floatingConfig,tt=void 0===et?{}:et,nt=t.class,rt=void 0===nt?"":nt;function it(e){var t=[],n={};e.forEach((function(e){var r=se(e);t.includes(r)||(t.push(r),n[r]=[],r&&n[r].push(Object.assign(_e(r,e),{id:r,groupHeader:!0,selectable:fe}))),n[r].push(Object.assign({groupItem:!!r},e));}));var r=[];return ue(t).forEach((function(e){n[e]&&r.push.apply(r,Vi(n[e]));})),r}function ot(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;n(7,Ze=e<0?0:e),!t&&se&&u[Ze]&&!u[Ze].selectable&&_t(1);}function at(){var e=!0;if(J){var t=[],r=[];J.forEach((function(n){t.includes(n[de])?e=!1:(t.push(n[de]),r.push(n));})),e||n(3,J=r);}return e}function st(e){var t=e?e[de]:J[de];return te.find((function(e){return e[de]===t}))}function ct(e){return ut.apply(this,arguments)}function ut(){return ut=ji(xi().mark((function e(t){var r;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=J[t],1===J.length?n(3,J=void 0):n(3,J=J.filter((function(e){return e!==r}))),j("clear",r);case 3:case"end":return e.stop()}}),e)}))),ut.apply(this,arguments)}function lt(e){var t;H&&D===(null===(t=document)||void 0===t?void 0:t.activeElement)||(e&&j("focus",e),D.focus(),n(2,H=!0));}function ft(e){return ht.apply(this,arguments)}function ht(){return ht=ji(xi().mark((function e(t){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!jt){e.next=2;break}return e.abrupt("return");case 2:(De||H)&&(j("blur",t),dt(),n(2,H=!1),n(26,d=void 0),D.blur());case 3:case"end":return e.stop()}}),e)}))),ht.apply(this,arguments)}function dt(){n(4,G=""),n(6,De=!1);}y=ji(xi().mark((function e(){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(77,v=J),n(78,p=G),n(79,m=B);case 3:case"end":return e.stop()}}),e)}))),Zo().$$.before_update.push(y),ea((function(){De&&n(2,H=!0),H&&D&&D.focus();}));var vt=t.ariaValues,pt=void 0===vt?function(e){return "Option ".concat(e,", selected.")}:vt,mt=t.ariaListOpen,gt=void 0===mt?function(e,t){return "You are currently focused on option ".concat(e,". There are ").concat(t," results available.")}:mt,yt=t.ariaFocused,bt=void 0===yt?function(){return "Select is focused, type to refine list, press down to open the menu."}:yt;var wt,xt=null;function kt(){clearTimeout(wt),wt=setTimeout((function(){jt=!1;}),100);}ta((function(){var e;null===(e=xt)||void 0===e||e.remove();}));var jt=!1;function St(e){e&&!1!==e.selectable&&function(e){if(e){n(4,G="");var t=Object.assign({},e);if(t.groupHeader&&!t.selectable)return;n(3,J=B?J?J.concat([t]):[t]:n(3,J=t)),setTimeout((function(){Ce&&dt(),n(26,d=void 0),j("change",J),j("select",e);}));}}(e);}function Ct(e){jt||n(7,Ze=e);}function $t(e){var t=e.item,r=e.i;if(!1!==(null==t?void 0:t.selectable))return J&&!B&&J[de]===t[de]?dt():void(function(e){return e.groupHeader&&e.selectable||e.selectable||!e.hasOwnProperty("selectable")}(t)&&(n(7,Ze=r),St(t)))}function _t(e){if(0===u.filter((function(e){return !Object.hasOwn(e,"selectable")||!0===e.selectable})).length)return n(7,Ze=0);e>0&&Ze===u.length-1?n(7,Ze=0):n(7,e<0&&0===Ze?Ze=u.length-1:Ze+=e);var t=u[Ze];t&&!1===t.selectable&&(1!==e&&-1!==e||_t(e));}var Ot=Et,Mt=Et;function Et(e){return {update:function(t){t.scroll&&(kt(),e.scrollIntoView({behavior:"auto",block:"nearest"}));}}}var At={strategy:"absolute",placement:"bottom-start",middleware:[QM(Ye),GM(),XM()],autoUpdate:!1},Pt=Si(TE(At),3),Tt=Pt[0],Rt=Pt[1],Nt=Pt[2],It=!0;return e.$$set=function(e){"justValue"in e&&n(52,C=e.justValue),"filter"in e&&n(53,_=e.filter),"getItems"in e&&n(54,M=e.getItems),"id"in e&&n(55,A=e.id),"name"in e&&n(8,T=e.name),"container"in e&&n(0,N=e.container),"input"in e&&n(1,D=e.input),"multiple"in e&&n(9,B=e.multiple),"multiFullItemClearable"in e&&n(10,q=e.multiFullItemClearable),"disabled"in e&&n(11,V=e.disabled),"focused"in e&&n(2,H=e.focused),"value"in e&&n(3,J=e.value),"filterText"in e&&n(4,G=e.filterText),"placeholder"in e&&n(56,Y=e.placeholder),"placeholderAlwaysShow"in e&&n(57,Z=e.placeholderAlwaysShow),"items"in e&&n(51,te=e.items),"label"in e&&n(12,re=e.label),"itemFilter"in e&&n(58,oe=e.itemFilter),"groupBy"in e&&n(59,se=e.groupBy),"groupFilter"in e&&n(60,ue=e.groupFilter),"groupHeaderSelectable"in e&&n(61,fe=e.groupHeaderSelectable),"itemId"in e&&n(13,de=e.itemId),"loadOptions"in e&&n(62,pe=e.loadOptions),"containerStyles"in e&&n(14,ge=e.containerStyles),"hasError"in e&&n(15,be=e.hasError),"filterSelectedItems"in e&&n(63,xe=e.filterSelectedItems),"required"in e&&n(16,je=e.required),"closeListOnChange"in e&&n(64,Ce=e.closeListOnChange),"createGroupHeaderItem"in e&&n(65,_e=e.createGroupHeaderItem),"searchable"in e&&n(17,Me=e.searchable),"inputStyles"in e&&n(18,Ae=e.inputStyles),"clearable"in e&&n(67,Te=e.clearable),"loading"in e&&n(5,Ne=e.loading),"listOpen"in e&&n(6,De=e.listOpen),"debounce"in e&&n(68,Be=e.debounce),"debounceWait"in e&&n(69,qe=e.debounceWait),"hideEmptyState"in e&&n(19,Ve=e.hideEmptyState),"inputAttributes"in e&&n(70,He=e.inputAttributes),"listAutoWidth"in e&&n(71,Je=e.listAutoWidth),"showChevron"in e&&n(20,Ge=e.showChevron),"listOffset"in e&&n(72,Ye=e.listOffset),"hoverItemIndex"in e&&n(7,Ze=e.hoverItemIndex),"floatingConfig"in e&&n(73,tt=e.floatingConfig),"class"in e&&n(21,rt=e.class),"ariaValues"in e&&n(74,pt=e.ariaValues),"ariaListOpen"in e&&n(75,gt=e.ariaListOpen),"ariaFocused"in e&&n(76,bt=e.ariaFocused),"$$scope"in e&&n(81,x=e.$$scope);},e.$$.update=function(){var t,h,y,b,w;(8&e.$$.dirty[0]|1048576&e.$$.dirty[1]&&J&&function(){if("string"==typeof J){var e,t=(te||[]).find((function(e){return e[de]===J}));n(3,J=t||(Mi(e={},de,J),Mi(e,"label",J),e));}else B&&Array.isArray(J)&&J.length>0&&n(3,J=J.map((function(e){return "string"==typeof e?{value:e,label:e}:e})));}(),131072&e.$$.dirty[0]|256&e.$$.dirty[2]&&(!He&&Me||(n(27,g=Object.assign({autocapitalize:"none",autocomplete:"off",autocorrect:"off",spellcheck:!1,tabindex:0,type:"text","aria-autocomplete":"list"},He)),A&&n(27,g.id=A,g),Me||n(27,g.readonly=!0,g))),512&e.$$.dirty[0]&&B&&J&&(Array.isArray(J)?n(3,J=Vi(J)):n(3,J=[J])),512&e.$$.dirty[0]|131072&e.$$.dirty[2]&&m&&!B&&J&&n(3,J=null),520&e.$$.dirty[0]&&B&&J&&J.length>1&&at(),8&e.$$.dirty[0]&&J&&(B?JSON.stringify(J)!==JSON.stringify(v)&&at()&&j("input",J):v&&JSON.stringify(J[de])===JSON.stringify(v[de])||j("input",J)),520&e.$$.dirty[0]|32768&e.$$.dirty[2]&&!J&&B&&v&&j("input",J),6&e.$$.dirty[0]&&!H&&D&&dt(),16&e.$$.dirty[0]|65536&e.$$.dirty[2]&&G!==p&&(pe||0!==G.length)&&(pe?Be(ji(xi().mark((function e(){var t;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(5,Ne=!0),e.next=3,M({dispatch:j,loadOptions:pe,convertStringItemsToObjects:qA,filterText:G});case 3:(t=e.sent)?(n(5,Ne=t.loading),n(6,De=De?t.listOpen:G.length>0),n(2,H=De&&t.focused),n(51,te=se?it(t.filteredItems):t.filteredItems)):(n(5,Ne=!1),n(2,H=!0),n(6,De=!0));case 5:case"end":return e.stop()}}),e)}))),qe):(n(6,De=!0),B&&n(26,d=void 0))),12824&e.$$.dirty[0]|407896064&e.$$.dirty[1]|3&e.$$.dirty[2]&&n(24,u=_({loadOptions:pe,filterText:G,items:te,multiple:B,value:J,itemId:de,groupBy:se,label:re,filterSelectedItems:xe,itemFilter:oe,convertStringItemsToObjects:qA,filterGroupedItems:it})),16777800&e.$$.dirty[0]&&!B&&De&&J&&u&&(t=u.findIndex((function(e){return e[de]===J[de]})),ot(t,!0)),576&e.$$.dirty[0]&&De&&B&&n(7,Ze=0),16&e.$$.dirty[0]&&G&&n(7,Ze=0),128&e.$$.dirty[0]&&function(e){j("hoverItem",e);}(Ze),520&e.$$.dirty[0]&&n(25,r=B?J&&J.length>0:J),33554448&e.$$.dirty[0]&&n(35,i=r&&G.length>0),33556512&e.$$.dirty[0]|32&e.$$.dirty[2]&&n(34,o=r&&Te&&!V&&!Ne),520&e.$$.dirty[0]|100663296&e.$$.dirty[1])&&n(33,a=Z&&B||B&&0===(null===(h=J)||void 0===h?void 0:h.length)?Y:J?"":Y);(520&e.$$.dirty[0]&&n(32,s=J?(y=void 0,y=B&&J.length>0?J.map((function(e){return e[re]})).join(", "):J[re],pt(y)):""),16777412&e.$$.dirty[0]&&n(31,c=function(){if(!u||0===u.length)return "";var e=u[Ze];if(De&&e){var t=u?u.length:0;return gt(e[re],t)}return bt()}()),1048576&e.$$.dirty[1]&&function(e){e&&0!==e.length&&!e.some((function(e){return "object"!==Ji(e)}))&&J&&(B?!J.some((function(e){return !e||!e[de]})):J[de])&&(Array.isArray(J)?n(3,J=J.map((function(e){return st(e)||e}))):n(3,J=st()||J));}(te),8712&e.$$.dirty[0]&&n(52,C=B?J?J.map((function(e){return e[de]})):null:J?J[de]:J),520&e.$$.dirty[0]|32768&e.$$.dirty[2]&&(B||!v||J||j("input",J)),16777800&e.$$.dirty[0]&&De&&u&&!B&&!J&&ot(),16777216&e.$$.dirty[0]&&function(e){De&&j("filter",e);}(u),1&e.$$.dirty[0]|2048&e.$$.dirty[2])&&(N&&void 0===(null===(b=tt)||void 0===b?void 0:b.autoUpdate)&&n(80,At.autoUpdate=!0,At));1&e.$$.dirty[0]|264192&e.$$.dirty[2]&&N&&tt&&Nt(Object.assign(At,tt)),8388608&e.$$.dirty[0]&&n(30,l=!!xt),8388672&e.$$.dirty[0]&&function(e,t){if(!e||!t)return n(28,It=!0);setTimeout((function(){n(28,It=!1);}),0);}(xt,De),8388673&e.$$.dirty[0]&&De&&N&&xt&&(w=N.getBoundingClientRect().width,n(23,xt.style.width=Je?w+"px":"auto",xt)),128&e.$$.dirty[0]&&n(29,f=Ze),70&e.$$.dirty[0]&&D&&De&&!H&&lt();},[N,D,H,J,G,Ne,De,Ze,T,B,q,V,re,de,ge,be,je,Me,Ae,Ve,Ge,rt,function(){j("clear",J),n(3,J=void 0),dt(),lt();},xt,u,r,d,g,It,f,l,c,s,a,o,i,ct,function(e){if(H)switch(e.stopPropagation(),e.key){case"Escape":e.preventDefault(),dt();break;case"Enter":if(e.preventDefault(),De){if(0===u.length)break;var t=u[Ze];if(J&&!B&&J[de]===t[de]){dt();break}St(u[Ze]);}break;case"ArrowDown":e.preventDefault(),De?_t(1):(n(6,De=!0),n(26,d=void 0));break;case"ArrowUp":e.preventDefault(),De?_t(-1):(n(6,De=!0),n(26,d=void 0));break;case"Tab":if(De&&H){if(0===u.length||J&&J[de]===u[Ze][de])return dt();e.preventDefault(),St(u[Ze]),dt();}break;case"Backspace":if(!B||G.length>0)return;if(B&&J&&J.length>0){if(ct(void 0!==d?d:J.length-1),0===d||void 0===d)break;n(26,d=J.length>d?d-1:void 0);}break;case"ArrowLeft":if(!J||!B||G.length>0)return;void 0===d?n(26,d=J.length-1):J.length>d&&0!==d&&n(26,d-=1);break;case"ArrowRight":if(!J||!B||G.length>0||void 0===d)return;d===J.length-1?n(26,d=void 0):d<J.length-1&&n(26,d+=1);}},lt,ft,function(){V||n(6,De=!De);},kt,function(e){var t;De||H||!N||N.contains(e.target)||null!==(t=xt)&&void 0!==t&&t.contains(e.target)||ft();},Ct,$t,function(e,t,n){if(!B)return t&&t[n]===e[n]},Ot,Mt,Tt,Rt,k,te,C,_,M,A,Y,Z,oe,se,ue,fe,pe,xe,Ce,_e,function(){return u},Te,Be,qe,He,Je,Ye,tt,pt,gt,bt,v,p,m,At,x,w,function(t){oa.call(this,e,t);},function(t){oa.call(this,e,t);},function(t){oa.call(this,e,t);},function(t){oa.call(this,e,t);},function(e){return Ct(e)},function(e){return Ct(e)},function(e,t){return $t({item:e,i:t})},function(e){sa[e?"unshift":"push"]((function(){n(23,xt=e);}));},function(e){return ct(e)},function(e){return q?ct(e):{}},function(e){sa[e?"unshift":"push"]((function(){n(1,D=e);}));},function(){G=this.value,n(4,G);},function(e){sa[e?"unshift":"push"]((function(){n(0,N=e);}));}]}var VA=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,FA,zA,to,{justValue:52,filter:53,getItems:54,id:55,name:8,container:0,input:1,multiple:9,multiFullItemClearable:10,disabled:11,focused:2,value:3,filterText:4,placeholder:56,placeholderAlwaysShow:57,items:51,label:12,itemFilter:58,groupBy:59,groupFilter:60,groupHeaderSelectable:61,itemId:13,loadOptions:62,containerStyles:14,hasError:15,filterSelectedItems:63,required:16,closeListOnChange:64,createGroupHeaderItem:65,getFilteredItems:66,searchable:17,inputStyles:18,clearable:67,loading:5,listOpen:6,debounce:68,debounceWait:69,hideEmptyState:19,inputAttributes:70,listAutoWidth:71,showChevron:20,listOffset:72,hoverItemIndex:7,floatingConfig:73,class:21,handleClear:22,ariaValues:74,ariaListOpen:75,ariaFocused:76},UE,[-1,-1,-1,-1,-1]),r}return qi(n,[{key:"getFilteredItems",get:function(){return this.$$.ctx[66]}},{key:"handleClear",get:function(){return this.$$.ctx[22]}}]),n}();function WA(e){bo(e,"svelte-1kiph99","table.jse-transform-wizard.svelte-1kiph99.svelte-1kiph99{border-collapse:collapse;border-spacing:0;width:100%}table.jse-transform-wizard.svelte-1kiph99 input.svelte-1kiph99{font-family:inherit;font-size:inherit}table.jse-transform-wizard.svelte-1kiph99 tr th.svelte-1kiph99{font-weight:normal;text-align:left;width:60px}table.jse-transform-wizard.svelte-1kiph99 tr td .jse-horizontal.svelte-1kiph99{width:100%;display:flex;flex-direction:row;margin-bottom:calc(0.5 * var(--jse-padding))}table.jse-transform-wizard.svelte-1kiph99 tr td .jse-horizontal.svelte-1kiph99 .svelte-select .multi-item{align-items:center}table.jse-transform-wizard.svelte-1kiph99 tr td .jse-horizontal.svelte-1kiph99 .svelte-select .value-container{gap:0 !important}table.jse-transform-wizard.svelte-1kiph99 tr td .jse-horizontal.svelte-1kiph99 .svelte-select.jse-filter-path{flex:4;margin-right:calc(0.5 * var(--jse-padding))}table.jse-transform-wizard.svelte-1kiph99 tr td .jse-horizontal.svelte-1kiph99 .svelte-select.jse-filter-relation{flex:1.5;margin-right:calc(0.5 * var(--jse-padding))}table.jse-transform-wizard.svelte-1kiph99 tr td .jse-horizontal.svelte-1kiph99 .svelte-select.jse-sort-path{flex:3;margin-right:calc(0.5 * var(--jse-padding))}table.jse-transform-wizard.svelte-1kiph99 tr td .jse-horizontal.svelte-1kiph99 .svelte-select.jse-sort-direction{flex:1}table.jse-transform-wizard.svelte-1kiph99 tr td .jse-horizontal.svelte-1kiph99 .svelte-select.jse-projection-paths{flex:1}table.jse-transform-wizard.svelte-1kiph99 tr td .jse-horizontal.svelte-1kiph99 .svelte-select input{box-sizing:border-box}table.jse-transform-wizard.svelte-1kiph99 tr td .jse-horizontal .jse-filter-value.svelte-1kiph99{flex:4;padding:4px 8px;border:var(--jse-input-border);border-radius:var(--jse-input-radius);outline:none;background:var(--jse-input-background);color:inherit}table.jse-transform-wizard.svelte-1kiph99 tr td .jse-horizontal .jse-filter-value.svelte-1kiph99:focus{border:var(--jse-input-border-focus)}");}function HA(e){var t,n,r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b,w,x,k,j,S,C,$,_,O,M,E,A,P,T,R,N;function I(t){e[16](t);}var D={class:"jse-filter-path",showChevron:!0,items:e[7]};function L(t){e[17](t);}void 0!==e[0]&&(D.value=e[0]),s=new VA({props:D}),sa.push((function(){return Ia(s,"value",I)}));var B={class:"jse-filter-relation",showChevron:!0,items:e[8]};function z(t){e[19](t);}void 0!==e[1]&&(B.value=e[1]),l=new VA({props:B}),sa.push((function(){return Ia(l,"value",L)}));var q={class:"jse-sort-path",showChevron:!0,items:e[7]};function F(t){e[20](t);}void 0!==e[3]&&(q.value=e[3]),w=new VA({props:q}),sa.push((function(){return Ia(w,"value",z)}));var V={class:"jse-sort-direction",showChevron:!0,items:e[9]};function W(t){e[21](t);}void 0!==e[4]&&(V.value=e[4]),j=new VA({props:V}),sa.push((function(){return Ia(j,"value",F)}));var H={class:"jse-projection-paths",multiple:!0,showChevron:!0,items:e[6]};return void 0!==e[5]&&(H.value=e[5]),A=new VA({props:H}),sa.push((function(){return Ia(A,"value",W)})),{c:function(){t=$o("table"),n=$o("tr"),(r=$o("th")).textContent="Filter",i=Mo(),o=$o("td"),a=$o("div"),Da(s.$$.fragment),u=Mo(),Da(l.$$.fragment),h=Mo(),d=$o("input"),v=Mo(),p=$o("tr"),(m=$o("th")).textContent="Sort",g=Mo(),y=$o("td"),b=$o("div"),Da(w.$$.fragment),k=Mo(),Da(j.$$.fragment),C=Mo(),$=$o("tr"),(_=$o("th")).textContent="Pick",O=Mo(),M=$o("td"),E=$o("div"),Da(A.$$.fragment),Ro(r,"class","svelte-1kiph99"),Ro(d,"class","jse-filter-value svelte-1kiph99"),Ro(a,"class","jse-horizontal svelte-1kiph99"),Ro(m,"class","svelte-1kiph99"),Ro(b,"class","jse-horizontal svelte-1kiph99"),Ro(_,"class","svelte-1kiph99"),Ro(E,"class","jse-horizontal svelte-1kiph99"),Ro(t,"class","jse-transform-wizard svelte-1kiph99");},m:function(c,f){jo(c,t,f),yo(t,n),yo(n,r),yo(n,i),yo(n,o),yo(o,a),La(s,a,null),yo(a,u),La(l,a,null),yo(a,h),yo(a,d),Bo(d,e[2]),yo(t,v),yo(t,p),yo(p,m),yo(p,g),yo(p,y),yo(y,b),La(w,b,null),yo(b,k),La(j,b,null),yo(t,C),yo(t,$),yo($,_),yo($,O),yo($,M),yo(M,E),La(A,E,null),T=!0,R||(N=Ao(d,"input",e[18]),R=!0);},p:function(e,t){var n=Si(t,1)[0],r={};128&n&&(r.items=e[7]),!c&&1&n&&(c=!0,r.value=e[0],pa((function(){return c=!1}))),s.$set(r);var i={};!f&&2&n&&(f=!0,i.value=e[1],pa((function(){return f=!1}))),l.$set(i),4&n&&d.value!==e[2]&&Bo(d,e[2]);var o={};128&n&&(o.items=e[7]),!x&&8&n&&(x=!0,o.value=e[3],pa((function(){return x=!1}))),w.$set(o);var a={};!S&&16&n&&(S=!0,a.value=e[4],pa((function(){return S=!1}))),j.$set(a);var u={};64&n&&(u.items=e[6]),!P&&32&n&&(P=!0,u.value=e[5],pa((function(){return P=!1}))),A.$set(u);},i:function(e){T||($a(s.$$.fragment,e),$a(l.$$.fragment,e),$a(w.$$.fragment,e),$a(j.$$.fragment,e),$a(A.$$.fragment,e),T=!0);},o:function(e){_a(s.$$.fragment,e),_a(l.$$.fragment,e),_a(w.$$.fragment,e),_a(j.$$.fragment,e),_a(A.$$.fragment,e),T=!1;},d:function(e){e&&So(t),Ba(s),Ba(l),Ba(w),Ba(j),Ba(A),R=!1,N();}}}function UA(e,t,n){var r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b=Ha("jsoneditor:TransformWizard"),w=t.json,x=t.queryOptions,k=void 0===x?{}:x,j=t.onChange,S=["==","!=","<","<=",">",">="].map((function(e){return {value:e,label:e}})),C=[{value:"asc",label:"ascending"},{value:"desc",label:"descending"}],$=null!==(r=k)&&void 0!==r&&null!==(i=r.filter)&&void 0!==i&&i.path?WC(k.filter.path):null,_=null!==(o=k)&&void 0!==o&&null!==(a=o.filter)&&void 0!==a&&a.relation?S.find((function(e){var t;return e.value===(null===(t=k.filter)||void 0===t?void 0:t.relation)})):null,O=(null===(s=k)||void 0===s||null===(c=s.filter)||void 0===c?void 0:c.value)||"",M=null!==(u=k)&&void 0!==u&&null!==(l=u.sort)&&void 0!==l&&l.path?WC(k.sort.path):null,E=null!==(f=k)&&void 0!==f&&null!==(h=f.sort)&&void 0!==h&&h.direction?C.find((function(e){var t;return e.value===(null===(t=k.sort)||void 0===t?void 0:t.direction)})):null;return e.$$set=function(e){"json"in e&&n(11,w=e.json),"queryOptions"in e&&n(10,k=e.queryOptions),"onChange"in e&&n(12,j=e.onChange);},e.$$.update=function(){var t,r,i,o,a,s,c,u,l,f,h,x,S,C,A,P,T,R;(2048&e.$$.dirty&&n(15,d=Array.isArray(w)),34816&e.$$.dirty&&n(14,v=d?OS(w):[]),34816&e.$$.dirty&&n(13,p=d?OS(w,!0):[]),16384&e.$$.dirty&&n(7,m=v.map(WC)),8192&e.$$.dirty&&n(6,g=p?p.map(WC):[]),1088&e.$$.dirty)&&n(5,y=null!==(t=k)&&void 0!==t&&null!==(r=t.projection)&&void 0!==r&&r.paths&&g?k.projection.paths.map((function(e){return g.find((function(t){return zy(t.value,e)}))})).filter((function(e){return !!e})):null);1&e.$$.dirty&&(o=(null===(i=$)||void 0===i?void 0:i.value)||null,zy(null===(a=k)||void 0===a||null===(s=a.filter)||void 0===s?void 0:s.path,o)||(b("changeFilterPath",o),n(10,k=Ws(k,["filter","path"],o,!0)),j(k)));2&e.$$.dirty&&(u=(null===(c=_)||void 0===c?void 0:c.value)||null,zy(null===(l=k)||void 0===l||null===(f=l.filter)||void 0===f?void 0:f.relation,u)||(b("changeFilterRelation",u),n(10,k=Ws(k,["filter","relation"],u,!0)),j(k)));(4&e.$$.dirty&&(h=O||null,zy(null===(x=k)||void 0===x||null===(S=x.filter)||void 0===S?void 0:S.value,h)||(b("changeFilterValue",h),n(10,k=Ws(k,["filter","value"],h,!0)),j(k))),8&e.$$.dirty)&&function(e){var t,r;zy(null===(t=k)||void 0===t||null===(r=t.sort)||void 0===r?void 0:r.path,e)||(b("changeSortPath",e),n(10,k=Ws(k,["sort","path"],e,!0)),j(k));}((null===(C=M)||void 0===C?void 0:C.value)||null);16&e.$$.dirty&&(P=(null===(A=E)||void 0===A?void 0:A.value)||null,zy(null===(T=k)||void 0===T||null===(R=T.sort)||void 0===R?void 0:R.direction,P)||(b("changeSortDirection",P),n(10,k=Ws(k,["sort","direction"],P,!0)),j(k)));32&e.$$.dirty&&function(e){var t,r;zy(null===(t=k)||void 0===t||null===(r=t.projection)||void 0===r?void 0:r.paths,e)||(b("changeProjectionPaths",e),n(10,k=Ws(k,["projection","paths"],e,!0)),j(k));}(y?y.map((function(e){return e.value})):null);},[$,_,O,M,E,y,g,m,S,C,k,w,j,p,v,d,function(e){n(0,$=e);},function(e){n(1,_=e);},function(){O=this.value,n(2,O);},function(e){n(3,M=e);},function(e){n(4,E=e);},function(e){n(5,y=e),n(10,k),n(6,g),n(13,p),n(15,d),n(11,w);}]}var JA=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,UA,HA,no,{json:11,queryOptions:10,onChange:12},WA),r}return qi(n)}();function KA(e){bo(e,"svelte-19cxesy",".jse-select-query-language.svelte-19cxesy.svelte-19cxesy{position:relative;width:32px}.jse-select-query-language.svelte-19cxesy .jse-select-query-language-container.svelte-19cxesy{position:absolute;top:0;right:0;display:flex;flex-direction:column;box-shadow:var(--jse-controls-box-shadow)}.jse-select-query-language.svelte-19cxesy .jse-select-query-language-container .jse-query-language.svelte-19cxesy{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;text-align:left;padding:var(--jse-padding) calc(2 * var(--jse-padding));white-space:nowrap;color:var(--jse-context-menu-color);background:var(--jse-context-menu-background)}.jse-select-query-language.svelte-19cxesy .jse-select-query-language-container .jse-query-language.svelte-19cxesy:hover{background:var(--jse-context-menu-background-highlight)}");}function GA(e,t,n){var r=e.slice();return r[5]=t[n],r}function QA(e){var t,n;return t=new x$({props:{data:t$}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:Ki,i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function YA(e){var t,n;return t=new x$({props:{data:e$}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:Ki,i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function XA(e){var t,n,r,i,o,a,s,c,u,l,f=e[5].name+"",h=[YA,QA],d=[];function v(e,t){return e[5].id===e[0]?0:1}function p(){return e[4](e[5])}return n=v(e),r=d[n]=h[n](e),{c:function(){t=$o("button"),r.c(),i=Mo(),o=Oo(f),a=Mo(),Ro(t,"type","button"),Ro(t,"class","jse-query-language svelte-19cxesy"),Ro(t,"title",s="Select ".concat(e[5].name," as query language")),Fo(t,"selected",e[5].id===e[0]);},m:function(e,r){jo(e,t,r),d[n].m(t,null),yo(t,i),yo(t,o),yo(t,a),c=!0,u||(l=Ao(t,"click",p),u=!0);},p:function(a,u){var l=n;(n=v(e=a))===l?d[n].p(e,u):(Sa(),_a(d[l],1,1,(function(){d[l]=null;})),Ca(),(r=d[n])?r.p(e,u):(r=d[n]=h[n](e)).c(),$a(r,1),r.m(t,i)),(!c||2&u)&&f!==(f=e[5].name+"")&&Lo(o,f),(!c||2&u&&s!==(s="Select ".concat(e[5].name," as query language")))&&Ro(t,"title",s),(!c||3&u)&&Fo(t,"selected",e[5].id===e[0]);},i:function(e){c||($a(r),c=!0);},o:function(e){_a(r),c=!1;},d:function(e){e&&So(t),d[n].d(),u=!1,l();}}}function ZA(e){for(var t,n,r,i=e[1],o=[],a=0;a<i.length;a+=1)o[a]=XA(GA(e,i,a));var s=function(e){return _a(o[e],1,1,(function(){o[e]=null;}))};return {c:function(){t=$o("div"),n=$o("div");for(var e=0;e<o.length;e+=1)o[e].c();Ro(n,"class","jse-select-query-language-container svelte-19cxesy"),Ro(t,"class","jse-select-query-language svelte-19cxesy");},m:function(e,i){jo(e,t,i),yo(t,n);for(var a=0;a<o.length;a+=1)o[a]&&o[a].m(n,null);r=!0;},p:function(e,t){var r=Si(t,1)[0];if(7&r){var a;for(i=e[1],a=0;a<i.length;a+=1){var c=GA(e,i,a);o[a]?(o[a].p(c,r),$a(o[a],1)):(o[a]=XA(c),o[a].c(),$a(o[a],1),o[a].m(n,null));}for(Sa(),a=i.length;a<o.length;a+=1)s(a);Ca();}},i:function(e){if(!r){for(var t=0;t<i.length;t+=1)$a(o[t]);r=!0;}},o:function(e){o=o.filter(Boolean);for(var t=0;t<o.length;t+=1)_a(o[t]);r=!1;},d:function(e){e&&So(t),Co(o,e);}}}function eP(e,t,n){var r=t.queryLanguages,i=t.queryLanguageId,o=t.onChangeQueryLanguage;function a(e){n(0,i=e),o(e);}return e.$$set=function(e){"queryLanguages"in e&&n(1,r=e.queryLanguages),"queryLanguageId"in e&&n(0,i=e.queryLanguageId),"onChangeQueryLanguage"in e&&n(3,o=e.onChangeQueryLanguage);},[i,r,a,o,function(e){return a(e.id)}]}var tP=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,eP,ZA,to,{queryLanguages:1,queryLanguageId:0,onChangeQueryLanguage:3},KA),r}return qi(n)}();function nP(e){bo(e,"svelte-d01h2s",".jse-header.svelte-d01h2s.svelte-d01h2s{display:flex;background:var(--jse-theme-color);color:var(--jse-menu-color)}.jse-header.svelte-d01h2s .jse-title.svelte-d01h2s{flex:1;padding:5px;vertical-align:middle}.jse-header.svelte-d01h2s button.svelte-d01h2s{border:none;background:transparent;min-width:32px;color:inherit;cursor:pointer}.jse-header.svelte-d01h2s button.svelte-d01h2s:hover{background:rgba(255, 255, 255, 0.1)}");}function rP(e){var t,n,r,i,o;return n=new x$({props:{data:hM}}),{c:function(){t=$o("button"),Da(n.$$.fragment),Ro(t,"type","button"),Ro(t,"class","jse-config svelte-d01h2s"),Ro(t,"title","Select a query language");},m:function(a,s){jo(a,t,s),La(n,t,null),e[6](t),r=!0,i||(o=Ao(t,"click",e[3]),i=!0);},p:Ki,i:function(e){r||($a(n.$$.fragment,e),r=!0);},o:function(e){_a(n.$$.fragment,e),r=!1;},d:function(r){r&&So(t),Ba(n),e[6](null),i=!1,o();}}}function iP(e){var t,n,r,i,o,a,s,c,u,l=e[0].length>1&&rP(e);return a=new x$({props:{data:CM}}),{c:function(){t=$o("div"),(n=$o("div")).textContent="Transform",r=Mo(),l&&l.c(),i=Mo(),o=$o("button"),Da(a.$$.fragment),Ro(n,"class","jse-title svelte-d01h2s"),Ro(o,"type","button"),Ro(o,"class","jse-close svelte-d01h2s"),Ro(t,"class","jse-header svelte-d01h2s");},m:function(f,h){jo(f,t,h),yo(t,n),yo(t,r),l&&l.m(t,null),yo(t,i),yo(t,o),La(a,o,null),s=!0,c||(u=Ao(o,"click",e[2]),c=!0);},p:function(e,n){var r=Si(n,1)[0];e[0].length>1?l?(l.p(e,r),1&r&&$a(l,1)):((l=rP(e)).c(),$a(l,1),l.m(t,i)):l&&(Sa(),_a(l,1,1,(function(){l=null;})),Ca());},i:function(e){s||($a(l),$a(a.$$.fragment,e),s=!0);},o:function(e){_a(l),_a(a.$$.fragment,e),s=!1;},d:function(e){e&&So(t),l&&l.d(),Ba(a),c=!1,u();}}}function oP(e,t,n){var r,i,o=t.queryLanguages,a=t.queryLanguageId,s=t.onChangeQueryLanguage,c=ia("simple-modal").close,u=ia("absolute-popup"),l=u.openAbsolutePopup,f=u.closeAbsolutePopup;return e.$$set=function(e){"queryLanguages"in e&&n(0,o=e.queryLanguages),"queryLanguageId"in e&&n(4,a=e.queryLanguageId),"onChangeQueryLanguage"in e&&n(5,s=e.onChangeQueryLanguage);},[o,r,c,function(){i=l(tP,{queryLanguages:o,queryLanguageId:a,onChangeQueryLanguage:function(e){f(i),s(e);}},{position:"bottom",offsetTop:-2,offsetLeft:0,anchor:r,closeOnOuterClick:!0});},a,s,function(e){sa[e?"unshift":"push"]((function(){n(1,r=e);}));}]}var aP=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,oP,iP,no,{queryLanguages:0,queryLanguageId:4,onChangeQueryLanguage:5},nP),r}return qi(n)}(),sP=Ha("jsoneditor:AutoScrollHandler");var cP=function(e,t,n,r){return (e/=r/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},uP=function(){var e,t,n,r,i,o,a,s,c,u,l,f,h;function d(){return e.scrollTop}function v(t){return t.getBoundingClientRect().top-(e.getBoundingClientRect?e.getBoundingClientRect().top:0)+n}function p(t){e.scrollTo?e.scrollTo(e.scrollLeft,t):e.scrollTop=t;}function m(e){u||(u=e),p(o(l=e-u,n,s,c)),h=!0,l<c?requestAnimationFrame(m):function(){if(p(n+s),t&&a){t.setAttribute("tabindex","-1"),t.focus();}"function"==typeof f&&f();u=0,h=!1;}();}return function(l){var p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(c=1e3,i=p.offset||0,f=p.callback,o=p.easing||cP,a=p.a11y||!1,Ji(p.container)){case"object":e=p.container;break;case"string":e=document.querySelector(p.container);break;default:e=window.document.documentElement;}switch(n=d(),Ji(l)){case"number":t=void 0,a=!1,r=n+l;break;case"object":r=v(t=l);break;case"string":t=document.querySelector(l),r=v(t);}switch(s=r-n+i,Ji(p.duration)){case"number":c=p.duration;break;case"function":c=p.duration(s);}h?u=0:requestAnimationFrame(m);}},lP=Ha("jsoneditor:History");function fP(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.maxItems||1e3,n=[],r=0;function i(){return r<n.length}function o(){return r>0}function a(){return {canUndo:i(),canRedo:o(),length:n.length}}function s(){e.onChange&&e.onChange(a());}function c(e){lP("add",e),n=[e].concat(n.slice(r)).slice(0,t),r=0,s();}function u(){lP("clear"),n=[],r=0,s();}function l(){if(i()){var e=n[r];return r+=1,lP("undo",e),s(),e}}function f(){if(o())return lP("redo",n[r-=1]),s(),n[r]}return {add:c,clear:u,getState:a,undo:l,redo:f}}function hP(e,t){var n=Date.now(),r=e();return t(Date.now()-n),r}var dP=Ha("validation");function vP(e,t,n,r){return dP("validateJSON"),t?t(n!==r?r.parse(n.stringify(e)):e):[]}function pP(e,t,n,r){if(dP("validateText"),e.length>104857600)return {validationErrors:[{path:[],message:"Validation turned off: the document is too large",severity:us.info}]};if(0===e.length)return null;try{var i=hP((function(){return n.parse(e)}),(function(e){return dP("validate: parsed json in ".concat(e," ms"))}));if(!t)return null;var o=n===r?i:hP((function(){return r.parse(e)}),(function(e){return dP("validate: parsed json with the validationParser in ".concat(e," ms"))})),a=hP((function(){return t(o)}),(function(e){return dP("validate: validated json in ".concat(e," ms"))}));return By(a)?null:{validationErrors:a}}catch(t){var s=hP((function(){return function(e,t){if(e.length>1048576)return !1;try{return t.parse(su(e)),!0}catch(e){return !1}}(e,n)}),(function(e){return dP("validate: checked whether repairable in ".concat(e," ms"))}));return {parseError:zS(e,t.message||t.toString()),isRepairable:s}}}var mP=Ha("jsoneditor:FocusTracker");function gP(e){var t,n=e.onMount,r=e.onDestroy,i=e.getWindow,o=e.hasFocus,a=e.onFocus,s=e.onBlur,c=!1;function u(){var e=o();e&&(clearTimeout(t),c||(mP("focus"),a(),c=e));}function l(){c&&(clearTimeout(t),t=setTimeout((function(){mP("blur"),c=!1,s();})));}n((function(){mP("mount FocusTracker");var e=i();e&&(e.addEventListener("focusin",u,!0),e.addEventListener("focusout",l,!0));})),r((function(){mP("destroy FocusTracker");var e=i();e&&(e.removeEventListener("focusin",u,!0),e.removeEventListener("focusout",l,!0));}));}function yP(e){bo(e,"svelte-fqu1ku",".jse-message.svelte-fqu1ku.svelte-fqu1ku{font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);padding:var(--jse-padding);display:flex;gap:var(--jse-padding);flex-wrap:wrap;align-items:stretch}.jse-message.jse-success.svelte-fqu1ku.svelte-fqu1ku{background:var(--jse-message-success-background);color:var(--jse-message-success-color)}.jse-message.svelte-fqu1ku .jse-text.svelte-fqu1ku{display:flex;flex:1;min-width:60%;align-items:center}.jse-message.svelte-fqu1ku .jse-text.jse-clickable.svelte-fqu1ku{cursor:pointer}.jse-message.svelte-fqu1ku .jse-text.jse-clickable.svelte-fqu1ku:hover{background-color:rgba(255, 255, 255, 0.1)}.jse-message.jse-error.svelte-fqu1ku.svelte-fqu1ku{background:var(--jse-message-error-background);color:var(--jse-message-error-color)}.jse-message.jse-warning.svelte-fqu1ku.svelte-fqu1ku{background:var(--jse-message-warning-background);color:var(--jse-message-warning-color)}.jse-message.jse-info.svelte-fqu1ku.svelte-fqu1ku{background:var(--jse-message-info-background);color:var(--jse-message-info-color)}.jse-message.svelte-fqu1ku .jse-actions.svelte-fqu1ku{display:flex;gap:var(--jse-padding)}.jse-message.svelte-fqu1ku .jse-actions button.jse-action.svelte-fqu1ku{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;background:var(--jse-message-action-background);color:inherit;padding:calc(0.5 * var(--jse-padding)) var(--jse-padding)}.jse-message.svelte-fqu1ku .jse-actions button.jse-action.svelte-fqu1ku:hover{background:var(--jse-message-action-background-highlight)}");}function bP(e,t,n){var r=e.slice();return r[8]=t[n],r}function wP(e){var t,n;return t=new x$({props:{data:e[1]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};2&n&&(r.data=e[1]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function xP(e){var t,n;return t=new x$({props:{data:e[8].icon}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};8&n&&(r.data=e[8].icon),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function kP(e){var t,n,r,i,o,a,s,c,u,l=e[8].text+"",f=e[8].icon&&xP(e);function h(){return e[6](e[8])}function d(){return e[7](e[8])}return {c:function(){t=$o("button"),f&&f.c(),n=Mo(),r=Oo(l),i=Mo(),Ro(t,"type","button"),Ro(t,"class","jse-button jse-action jse-primary svelte-fqu1ku"),Ro(t,"title",o=e[8].title),t.disabled=a=e[8].disabled;},m:function(e,o){jo(e,t,o),f&&f.m(t,null),yo(t,n),yo(t,r),yo(t,i),s=!0,c||(u=[Ao(t,"click",h),Ao(t,"mousedown",d)],c=!0);},p:function(i,c){(e=i)[8].icon?f?(f.p(e,c),8&c&&$a(f,1)):((f=xP(e)).c(),$a(f,1),f.m(t,n)):f&&(Sa(),_a(f,1,1,(function(){f=null;})),Ca()),(!s||8&c)&&l!==(l=e[8].text+"")&&Lo(r,l),(!s||8&c&&o!==(o=e[8].title))&&Ro(t,"title",o),(!s||8&c&&a!==(a=e[8].disabled))&&(t.disabled=a);},i:function(e){s||($a(f),s=!0);},o:function(e){_a(f),s=!1;},d:function(e){e&&So(t),f&&f.d(),c=!1,Zi(u);}}}function jP(e){for(var t,n,r,i,o,a,s,c,u,l,f,h=e[1]&&wP(e),d=e[3],v=[],p=0;p<d.length;p+=1)v[p]=kP(bP(e,d,p));var m=function(e){return _a(v[e],1,1,(function(){v[e]=null;}))};return {c:function(){t=$o("div"),n=$o("div"),r=$o("div"),h&&h.c(),i=Mo(),o=Oo(e[2]),a=Mo(),s=$o("div");for(var u=0;u<v.length;u+=1)v[u].c();Ro(r,"class","jse-text-centered"),Ro(n,"class","jse-text svelte-fqu1ku"),Fo(n,"jse-clickable",!!e[4]),Ro(s,"class","jse-actions svelte-fqu1ku"),Ro(t,"class",c="jse-message jse-"+e[0]+" svelte-fqu1ku");},m:function(c,d){jo(c,t,d),yo(t,n),yo(n,r),h&&h.m(r,null),yo(r,i),yo(r,o),yo(t,a),yo(t,s);for(var p=0;p<v.length;p+=1)v[p]&&v[p].m(s,null);u=!0,l||(f=Ao(n,"click",e[5]),l=!0);},p:function(e,a){var l=Si(a,1)[0];if(e[1]?h?(h.p(e,l),2&l&&$a(h,1)):((h=wP(e)).c(),$a(h,1),h.m(r,i)):h&&(Sa(),_a(h,1,1,(function(){h=null;})),Ca()),(!u||4&l)&&Lo(o,e[2]),(!u||16&l)&&Fo(n,"jse-clickable",!!e[4]),8&l){var f;for(d=e[3],f=0;f<d.length;f+=1){var p=bP(e,d,f);v[f]?(v[f].p(p,l),$a(v[f],1)):(v[f]=kP(p),v[f].c(),$a(v[f],1),v[f].m(s,null));}for(Sa(),f=d.length;f<v.length;f+=1)m(f);Ca();}(!u||1&l&&c!==(c="jse-message jse-"+e[0]+" svelte-fqu1ku"))&&Ro(t,"class",c);},i:function(e){if(!u){$a(h);for(var t=0;t<d.length;t+=1)$a(v[t]);u=!0;}},o:function(e){_a(h),v=v.filter(Boolean);for(var t=0;t<v.length;t+=1)_a(v[t]);u=!1;},d:function(e){e&&So(t),h&&h.d(),Co(v,e),l=!1,f();}}}function SP(e,t,n){var r=t.type,i=void 0===r?"success":r,o=t.icon,a=void 0===o?void 0:o,s=t.message,c=void 0===s?void 0:s,u=t.actions,l=void 0===u?[]:u,f=t.onClick,h=void 0===f?void 0:f;return e.$$set=function(e){"type"in e&&n(0,i=e.type),"icon"in e&&n(1,a=e.icon),"message"in e&&n(2,c=e.message),"actions"in e&&n(3,l=e.actions),"onClick"in e&&n(4,h=e.onClick);},[i,a,c,l,h,function(){h&&h();},function(e){e.onClick&&e.onClick();},function(e){e.onMouseDown&&e.onMouseDown();}]}var CP=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,SP,jP,no,{type:0,icon:1,message:2,actions:3,onClick:4},yP),r}return qi(n)}();function $P(e){bo(e,"svelte-1oe8e8r",".jse-validation-errors-overview.svelte-1oe8e8r.svelte-1oe8e8r{font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);background:var(--jse-message-warning-background);color:var(--jse-message-warning-color);overflow:auto;max-height:25%}.jse-validation-errors-overview.svelte-1oe8e8r table.svelte-1oe8e8r{border-collapse:collapse;width:100%}.jse-validation-errors-overview.svelte-1oe8e8r table tr.svelte-1oe8e8r{cursor:pointer}.jse-validation-errors-overview.svelte-1oe8e8r table tr.svelte-1oe8e8r:hover{background-color:rgba(255, 255, 255, 0.1)}.jse-validation-errors-overview.svelte-1oe8e8r table tr td.svelte-1oe8e8r{padding:4px var(--jse-padding);vertical-align:middle}.jse-validation-errors-overview.svelte-1oe8e8r table tr td.jse-validation-error-icon.svelte-1oe8e8r{width:36px;box-sizing:border-box}.jse-validation-errors-overview.svelte-1oe8e8r table tr td.jse-validation-error-action.svelte-1oe8e8r{width:36px;box-sizing:border-box;padding:0}.jse-validation-errors-overview.svelte-1oe8e8r table tr td.jse-validation-error-action button.jse-validation-errors-collapse.svelte-1oe8e8r{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;width:36px;height:26px;cursor:pointer}.jse-validation-errors-overview.svelte-1oe8e8r table tr td.jse-validation-error-action button.jse-validation-errors-collapse.svelte-1oe8e8r:hover{background-color:rgba(255, 255, 255, 0.2)}.jse-validation-errors-overview.svelte-1oe8e8r table tr td div.jse-validation-errors-expand.svelte-1oe8e8r{display:inline-block;position:relative;top:3px}");}function _P(e,t,n){var r=e.slice();return r[7]=t[n],r[9]=n,r}function OP(e){var t,n,r,i,o=[EP,MP],a=[];function s(e,t){return e[2]||1===e[3]?0:1}return n=s(e),r=a[n]=o[n](e),{c:function(){t=$o("div"),r.c(),Ro(t,"class","jse-validation-errors-overview svelte-1oe8e8r");},m:function(e,r){jo(e,t,r),a[n].m(t,null),i=!0;},p:function(e,i){var c=n;(n=s(e))===c?a[n].p(e,i):(Sa(),_a(a[c],1,1,(function(){a[c]=null;})),Ca(),(r=a[n])?r.p(e,i):(r=a[n]=o[n](e)).c(),$a(r,1),r.m(t,null));},i:function(e){i||($a(r),i=!0);},o:function(e){_a(r),i=!1;},d:function(e){e&&So(t),a[n].d();}}}function MP(e){var t,n,r,i,o,a,s,c,u,l,f,h,d,v;return o=new x$({props:{data:MM}}),f=new x$({props:{data:tM}}),{c:function(){t=$o("table"),n=$o("tbody"),r=$o("tr"),i=$o("td"),Da(o.$$.fragment),a=Mo(),s=$o("td"),c=Oo(e[3]),u=Oo(" validation errors\n              "),l=$o("div"),Da(f.$$.fragment),Ro(i,"class","jse-validation-error-icon svelte-1oe8e8r"),Ro(l,"class","jse-validation-errors-expand svelte-1oe8e8r"),Ro(s,"class","svelte-1oe8e8r"),Ro(r,"class","jse-validation-error svelte-1oe8e8r"),Ro(t,"class","svelte-1oe8e8r");},m:function(p,m){jo(p,t,m),yo(t,n),yo(n,r),yo(r,i),La(o,i,null),yo(r,a),yo(r,s),yo(s,c),yo(s,u),yo(s,l),La(f,l,null),h=!0,d||(v=Ao(r,"click",e[5]),d=!0);},p:function(e,t){(!h||8&t)&&Lo(c,e[3]);},i:function(e){h||($a(o.$$.fragment,e),$a(f.$$.fragment,e),h=!0);},o:function(e){_a(o.$$.fragment,e),_a(f.$$.fragment,e),h=!1;},d:function(e){e&&So(t),Ba(o),Ba(f),d=!1,v();}}}function EP(e){for(var t,n,r,i,o=ES(e[0],100),a=[],s=0;s<o.length;s+=1)a[s]=PP(_P(e,o,s));var c=function(e){return _a(a[e],1,1,(function(){a[e]=null;}))},u=e[3]>100&&TP(e);return {c:function(){t=$o("table"),n=$o("tbody");for(var e=0;e<a.length;e+=1)a[e].c();r=Mo(),u&&u.c(),Ro(t,"class","svelte-1oe8e8r");},m:function(e,o){jo(e,t,o),yo(t,n);for(var s=0;s<a.length;s+=1)a[s]&&a[s].m(n,null);yo(n,r),u&&u.m(n,null),i=!0;},p:function(e,t){if(19&t){var i;for(o=ES(e[0],100),i=0;i<o.length;i+=1){var s=_P(e,o,i);a[i]?(a[i].p(s,t),$a(a[i],1)):(a[i]=PP(s),a[i].c(),$a(a[i],1),a[i].m(n,r));}for(Sa(),i=o.length;i<a.length;i+=1)c(i);Ca();}e[3]>100?u?u.p(e,t):((u=TP(e)).c(),u.m(n,null)):u&&(u.d(1),u=null);},i:function(e){if(!i){for(var t=0;t<o.length;t+=1)$a(a[t]);i=!0;}},o:function(e){a=a.filter(Boolean);for(var t=0;t<a.length;t+=1)_a(a[t]);i=!1;},d:function(e){e&&So(t),Co(a,e),u&&u.d();}}}function AP(e){var t,n,r,i,o;return n=new x$({props:{data:gM}}),{c:function(){t=$o("button"),Da(n.$$.fragment),Ro(t,"type","button"),Ro(t,"class","jse-validation-errors-collapse svelte-1oe8e8r"),Ro(t,"title","Collapse validation errors");},m:function(a,s){jo(a,t,s),La(n,t,null),r=!0,i||(o=Ao(t,"click",To(e[4])),i=!0);},p:Ki,i:function(e){r||($a(n.$$.fragment,e),r=!0);},o:function(e){_a(n.$$.fragment,e),r=!1;},d:function(e){e&&So(t),Ba(n),i=!1,o();}}}function PP(e){var t,n,r,i,o,a,s,c,u,l,f,h,d,v,p=FC(e[7].path)+"",m=e[7].message+"";r=new x$({props:{data:MM}});var g=0===e[9]&&e[0].length>1&&AP(e);function y(){return e[6](e[7])}return {c:function(){t=$o("tr"),n=$o("td"),Da(r.$$.fragment),i=Mo(),o=$o("td"),a=Oo(p),s=Mo(),c=$o("td"),u=Oo(m),l=Mo(),f=$o("td"),g&&g.c(),Ro(n,"class","jse-validation-error-icon svelte-1oe8e8r"),Ro(o,"class","svelte-1oe8e8r"),Ro(c,"class","svelte-1oe8e8r"),Ro(f,"class","jse-validation-error-action svelte-1oe8e8r"),Ro(t,"class","jse-validation-error svelte-1oe8e8r");},m:function(e,p){jo(e,t,p),yo(t,n),La(r,n,null),yo(t,i),yo(t,o),yo(o,a),yo(t,s),yo(t,c),yo(c,u),yo(t,l),yo(t,f),g&&g.m(f,null),h=!0,d||(v=Ao(t,"click",y),d=!0);},p:function(t,n){e=t,(!h||1&n)&&p!==(p=FC(e[7].path)+"")&&Lo(a,p),(!h||1&n)&&m!==(m=e[7].message+"")&&Lo(u,m),0===e[9]&&e[0].length>1?g?(g.p(e,n),1&n&&$a(g,1)):((g=AP(e)).c(),$a(g,1),g.m(f,null)):g&&(Sa(),_a(g,1,1,(function(){g=null;})),Ca());},i:function(e){h||($a(r.$$.fragment,e),$a(g),h=!0);},o:function(e){_a(r.$$.fragment,e),_a(g),h=!1;},d:function(e){e&&So(t),Ba(r),g&&g.d(),d=!1,v();}}}function TP(e){var t,n,r,i,o,a,s,c,u,l,f,h=e[3]-100+"";return {c:function(){t=$o("tr"),n=$o("td"),r=Mo(),i=$o("td"),o=Mo(),a=$o("td"),s=Oo("(and "),c=Oo(h),u=Oo(" more errors)"),l=Mo(),f=$o("td"),Ro(n,"class","svelte-1oe8e8r"),Ro(i,"class","svelte-1oe8e8r"),Ro(a,"class","svelte-1oe8e8r"),Ro(f,"class","svelte-1oe8e8r"),Ro(t,"class","jse-validation-error svelte-1oe8e8r");},m:function(e,h){jo(e,t,h),yo(t,n),yo(t,r),yo(t,i),yo(t,o),yo(t,a),yo(a,s),yo(a,c),yo(a,u),yo(t,l),yo(t,f);},p:function(e,t){8&t&&h!==(h=e[3]-100+"")&&Lo(c,h);},d:function(e){e&&So(t);}}}function RP(e){var t,n,r=!By(e[0]),i=r&&OP(e);return {c:function(){i&&i.c(),t=Eo();},m:function(e,r){i&&i.m(e,r),jo(e,t,r),n=!0;},p:function(e,n){var o=Si(n,1)[0];1&o&&(r=!By(e[0])),r?i?(i.p(e,o),1&o&&$a(i,1)):((i=OP(e)).c(),$a(i,1),i.m(t.parentNode,t)):i&&(Sa(),_a(i,1,1,(function(){i=null;})),Ca());},i:function(e){n||($a(i),n=!0);},o:function(e){_a(i),n=!1;},d:function(e){i&&i.d(e),e&&So(t);}}}function NP(e,t,n){var r,i=t.validationErrors,o=t.selectError,a=!0;return e.$$set=function(e){"validationErrors"in e&&n(0,i=e.validationErrors),"selectError"in e&&n(1,o=e.selectError);},e.$$.update=function(){1&e.$$.dirty&&n(3,r=i.length);},[i,o,a,r,function(){n(2,a=!1);},function(){n(2,a=!0);},function(e){setTimeout((function(){return o(e)}));}]}var IP=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,NP,RP,no,{validationErrors:0,selectError:1},$P),r}return qi(n)}(),DP="undefined"!=typeof navigator&&navigator.platform.toUpperCase().indexOf("MAC")>=0;function LP(e){bo(e,"svelte-d01h2s",".jse-header.svelte-d01h2s.svelte-d01h2s{display:flex;background:var(--jse-theme-color);color:var(--jse-menu-color)}.jse-header.svelte-d01h2s .jse-title.svelte-d01h2s{flex:1;padding:5px;vertical-align:middle}.jse-header.svelte-d01h2s button.svelte-d01h2s{border:none;background:transparent;min-width:32px;color:inherit;cursor:pointer}.jse-header.svelte-d01h2s button.svelte-d01h2s:hover{background:rgba(255, 255, 255, 0.1)}");}function BP(e){var t,n,r,i,o,a,s,c,u;return a=new x$({props:{data:CM}}),{c:function(){t=$o("div"),n=$o("div"),r=Oo(e[0]),i=Mo(),o=$o("button"),Da(a.$$.fragment),Ro(n,"class","jse-title svelte-d01h2s"),Ro(o,"type","button"),Ro(o,"class","jse-close svelte-d01h2s"),Ro(t,"class","jse-header svelte-d01h2s");},m:function(l,f){jo(l,t,f),yo(t,n),yo(n,r),yo(t,i),yo(t,o),La(a,o,null),s=!0,c||(u=Ao(o,"click",e[3]),c=!0);},p:function(e,t){var n=Si(t,1)[0];(!s||1&n)&&Lo(r,e[0]);},i:function(e){s||($a(a.$$.fragment,e),s=!0);},o:function(e){_a(a.$$.fragment,e),s=!1;},d:function(e){e&&So(t),Ba(a),c=!1,u();}}}function zP(e,t,n){var r=t.title,i=void 0===r?"Modal":r,o=t.onClose,a=void 0===o?void 0:o,s=ia("simple-modal").close;return e.$$set=function(e){"title"in e&&n(0,i=e.title),"onClose"in e&&n(1,a=e.onClose);},[i,a,s,function(){a?a():s();}]}var qP=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,zP,BP,no,{title:0,onClose:1},LP),r}return qi(n)}();function FP(e){bo(e,"svelte-1olothd",".jse-modal.svelte-1olothd.svelte-1olothd{--height:36px;--multi-item-height:28px;--multi-item-margin:2px;--multi-item-padding:2px 8px;--multi-item-border-radius:6px;--indicator-top:8px;flex:1;display:flex;flex-direction:column;min-width:0;min-height:0;font-family:var(--jse-font-family);font-size:var(--jse-font-size);line-height:normal;background:var(--jse-modal-background);color:var(--jse-text-color)}.jse-modal.svelte-1olothd .jse-modal-contents.svelte-1olothd{padding:20px;overflow:auto;min-width:0;min-height:0}.jse-modal.svelte-1olothd .jse-modal-contents .jse-actions.svelte-1olothd{display:flex;flex-direction:row;justify-content:flex-end;padding-top:var(--jse-padding)}.jse-modal.svelte-1olothd .jse-modal-contents .jse-actions button.jse-primary.svelte-1olothd{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;background:var(--jse-button-primary-background);color:var(--jse-button-primary-color);padding:var(--jse-padding) calc(2 * var(--jse-padding));border-radius:3px}.jse-modal.svelte-1olothd .jse-modal-contents .jse-actions button.jse-primary.svelte-1olothd:hover{background:var(--jse-button-primary-background-highlight)}.jse-modal.svelte-1olothd .jse-modal-contents .jse-actions button.jse-primary.svelte-1olothd:disabled{background:var(--jse-button-primary-background-disabled)}.bg.jse-modal-bg{width:100%;height:100%;top:0;left:0;background:var(--jse-modal-overlay-background)}.bg.jse-modal-bg .jse-modal-window-wrap{margin:0}.bg.jse-modal-bg .jse-modal-window{max-width:90%;margin:4rem auto 2rem auto;border-radius:2px}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-sort{width:400px}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-transform{width:1200px;height:1200px;max-height:80%;display:flex}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-jsoneditor{width:800px;height:auto;min-height:500px;max-height:80%;display:flex}.bg.jse-modal-bg .jse-modal-content{flex:1;display:flex;max-height:calc(100vh - 6rem);padding:0}.jse-modal.jse-copy-paste.svelte-1olothd .jse-shortcuts.svelte-1olothd{display:flex;flex-wrap:wrap;justify-content:space-around;margin:calc(2 * var(--jse-padding)) 0}.jse-modal.jse-copy-paste.svelte-1olothd .jse-shortcuts .jse-shortcut .jse-key.svelte-1olothd{font-size:200%;color:var(--jse-theme-color)}");}function VP(e){var t,n,r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b,w,x,k,j,S;return n=new qP({props:{title:"Copying and pasting"}}),{c:function(){t=$o("div"),Da(n.$$.fragment),r=Mo(),i=$o("div"),(o=$o("div")).textContent="These actions are unavailable via the menu. Please use:",a=Mo(),s=$o("div"),c=$o("div"),(u=$o("div")).textContent="".concat(e[1],"+C"),l=Oo("\n        for copy"),f=Mo(),h=$o("div"),(d=$o("div")).textContent="".concat(e[1],"+X"),v=Oo("\n        for cut"),p=Mo(),m=$o("div"),(g=$o("div")).textContent="".concat(e[1],"+V"),y=Oo("\n        for paste"),b=Mo(),w=$o("div"),(x=$o("button")).textContent="Close",Ro(u,"class","jse-key svelte-1olothd"),Ro(c,"class","jse-shortcut"),Ro(d,"class","jse-key svelte-1olothd"),Ro(h,"class","jse-shortcut"),Ro(g,"class","jse-key svelte-1olothd"),Ro(m,"class","jse-shortcut"),Ro(s,"class","jse-shortcuts svelte-1olothd"),Ro(x,"type","button"),Ro(x,"class","jse-primary svelte-1olothd"),Ro(w,"class","jse-actions svelte-1olothd"),Ro(i,"class","jse-modal-contents svelte-1olothd"),Ro(t,"class","jse-modal jse-copy-paste svelte-1olothd");},m:function(C,$){jo(C,t,$),La(n,t,null),yo(t,r),yo(t,i),yo(i,o),yo(i,a),yo(i,s),yo(s,c),yo(c,u),yo(c,l),yo(s,f),yo(s,h),yo(h,d),yo(h,v),yo(s,p),yo(s,m),yo(m,g),yo(m,y),yo(i,b),yo(i,w),yo(w,x),k=!0,j||(S=Ao(x,"click",e[0]),j=!0);},p:Ki,i:function(e){k||($a(n.$$.fragment,e),k=!0);},o:function(e){_a(n.$$.fragment,e),k=!1;},d:function(e){e&&So(t),Ba(n),j=!1,S();}}}function WP(e){return [ia("simple-modal").close,DP?"":"Ctrl"]}var HP=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,WP,VP,no,{},FP),r}return qi(n)}();function UP(e){return !!e&&("space"===e.type||!0===e.space)}function JP(e){return !!e&&("separator"===e.type||!0===e.separator)}function KP(e){return !!e&&"function"==typeof e.onClick}function GP(e){return !!e&&("dropdown-button"===e.type&&KP(e.main)&&Array.isArray(e.items))}function QP(e){return hu(e)&&hu(e.parseError)}function YP(e){return hu(e)&&Array.isArray(e.validationErrors)}function XP(e){bo(e,"svelte-497ud4",".jse-menu.svelte-497ud4.svelte-497ud4{background:var(--jse-theme-color);border-bottom:1px solid var(--jse-theme-color);color:var(--jse-menu-color);display:flex;flex-wrap:wrap;align-items:center;position:relative}.jse-menu.svelte-497ud4 .jse-button.svelte-497ud4{width:var(--jse-menu-button-size);height:var(--jse-menu-button-size);border:none;background:transparent;color:inherit;cursor:pointer;padding:calc(0.5 * var(--jse-padding));margin:0;border-radius:0}.jse-menu.svelte-497ud4 .jse-button.svelte-497ud4:hover,.jse-menu.svelte-497ud4 .jse-button.svelte-497ud4:focus{background:var(--jse-theme-color-highlight)}.jse-menu.svelte-497ud4 .jse-button.svelte-497ud4:disabled{color:var(--jse-menu-color);opacity:0.5;background:transparent}.jse-menu.svelte-497ud4 .jse-button.jse-group-button.svelte-497ud4{border:1px solid var(--jse-menu-color);padding:0 calc(0.5 * var(--jse-padding));margin:calc(0.5 * var(--jse-padding)) 0;height:calc(var(--jse-menu-button-size) - var(--jse-padding));width:auto}.jse-menu.svelte-497ud4 .jse-button.jse-group-button.svelte-497ud4:not(.jse-last){border-right:none}.jse-menu.svelte-497ud4 .jse-button.jse-group-button.jse-first.svelte-497ud4{margin-left:calc(0.5 * var(--jse-padding))}.jse-menu.svelte-497ud4 .jse-button.jse-group-button.jse-last.svelte-497ud4{margin-right:calc(0.5 * var(--jse-padding))}.jse-menu.svelte-497ud4 .jse-button.jse-group-button.svelte-497ud4:hover,.jse-menu.svelte-497ud4 .jse-button.jse-group-button.svelte-497ud4:focus{background:var(--jse-theme-color-highlight)}.jse-menu.svelte-497ud4 .jse-button.jse-group-button.jse-selected.svelte-497ud4{background:var(--jse-menu-color);color:var(--jse-theme-color)}.jse-menu.svelte-497ud4 .jse-space.svelte-497ud4{flex:1}.jse-menu.svelte-497ud4 .jse-separator.svelte-497ud4{background:var(--jse-menu-color);opacity:0.3;box-sizing:border-box;width:1px;height:calc(var(--jse-menu-button-size) - 6px);margin:3px}");}var ZP=function(e){return {}},eT=function(e){return {}};function tT(e,t,n){var r=e.slice();return r[3]=t[n],r}var nT=function(e){return {}},rT=function(e){return {}};function iT(e){var t,n=hT(e[3])+"";return {c:function(){t=Oo(n);},m:function(e,n){jo(e,t,n);},p:function(e,r){1&r&&n!==(n=hT(e[3])+"")&&Lo(t,n);},i:Ki,o:Ki,d:function(e){e&&So(t);}}}function oT(e){var t,n,r,i,o,a,s,c,u=e[3].icon&&cT(e),l=e[3].text&&uT(e);return {c:function(){t=$o("button"),u&&u.c(),n=Mo(),l&&l.c(),Ro(t,"type","button"),Ro(t,"class",r="jse-button "+e[3].className+" svelte-497ud4"),Ro(t,"title",i=e[3].title),t.disabled=o=e[3].disabled||!1;},m:function(r,i){jo(r,t,i),u&&u.m(t,null),yo(t,n),l&&l.m(t,null),a=!0,s||(c=Ao(t,"click",(function(){eo(e[3].onClick)&&e[3].onClick.apply(this,arguments);})),s=!0);},p:function(s,c){(e=s)[3].icon?u?(u.p(e,c),1&c&&$a(u,1)):((u=cT(e)).c(),$a(u,1),u.m(t,n)):u&&(Sa(),_a(u,1,1,(function(){u=null;})),Ca()),e[3].text?l?l.p(e,c):((l=uT(e)).c(),l.m(t,null)):l&&(l.d(1),l=null),(!a||1&c&&r!==(r="jse-button "+e[3].className+" svelte-497ud4"))&&Ro(t,"class",r),(!a||1&c&&i!==(i=e[3].title))&&Ro(t,"title",i),(!a||1&c&&o!==(o=e[3].disabled||!1))&&(t.disabled=o);},i:function(e){a||($a(u),a=!0);},o:function(e){_a(u),a=!1;},d:function(e){e&&So(t),u&&u.d(),l&&l.d(),s=!1,c();}}}function aT(e){var t;return {c:function(){Ro(t=$o("div"),"class","jse-space svelte-497ud4");},m:function(e,n){jo(e,t,n);},p:Ki,i:Ki,o:Ki,d:function(e){e&&So(t);}}}function sT(e){var t;return {c:function(){Ro(t=$o("div"),"class","jse-separator svelte-497ud4");},m:function(e,n){jo(e,t,n);},p:Ki,i:Ki,o:Ki,d:function(e){e&&So(t);}}}function cT(e){var t,n;return t=new x$({props:{data:e[3].icon}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n&&(r.data=e[3].icon),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function uT(e){var t,n=e[3].text+"";return {c:function(){t=Oo(n);},m:function(e,n){jo(e,t,n);},p:function(e,r){1&r&&n!==(n=e[3].text+"")&&Lo(t,n);},d:function(e){e&&So(t);}}}function lT(e){var t,n,r,i,o,a,s,c=[sT,aT,oT,iT],u=[];function l(e,i){return 1&i&&(t=null),1&i&&(n=null),1&i&&(r=null),null==t&&(t=!!JP(e[3])),t?0:(null==n&&(n=!!UP(e[3])),n?1:(null==r&&(r=!!KP(e[3])),r?2:3))}return i=l(e,-1),o=u[i]=c[i](e),{c:function(){o.c(),a=Eo();},m:function(e,t){u[i].m(e,t),jo(e,a,t),s=!0;},p:function(e,t){var n=i;(i=l(e,t))===n?u[i].p(e,t):(Sa(),_a(u[n],1,1,(function(){u[n]=null;})),Ca(),(o=u[i])?o.p(e,t):(o=u[i]=c[i](e)).c(),$a(o,1),o.m(a.parentNode,a));},i:function(e){s||($a(o),s=!0);},o:function(e){_a(o),s=!1;},d:function(e){u[i].d(e),e&&So(a);}}}function fT(e){for(var t,n,r,i,o=e[2].left,a=ro(o,e,e[1],rT),s=e[0],c=[],u=0;u<s.length;u+=1)c[u]=lT(tT(e,s,u));var l=function(e){return _a(c[e],1,1,(function(){c[e]=null;}))},f=e[2].right,h=ro(f,e,e[1],eT);return {c:function(){t=$o("div"),a&&a.c(),n=Mo();for(var e=0;e<c.length;e+=1)c[e].c();r=Mo(),h&&h.c(),Ro(t,"class","jse-menu svelte-497ud4");},m:function(e,o){jo(e,t,o),a&&a.m(t,null),yo(t,n);for(var s=0;s<c.length;s+=1)c[s]&&c[s].m(t,null);yo(t,r),h&&h.m(t,null),i=!0;},p:function(e,n){var u=Si(n,1)[0];if(a&&a.p&&(!i||2&u)&&ao(a,o,e,e[1],i?oo(o,e[1],u,nT):so(e[1]),rT),1&u){var d;for(s=e[0],d=0;d<s.length;d+=1){var v=tT(e,s,d);c[d]?(c[d].p(v,u),$a(c[d],1)):(c[d]=lT(v),c[d].c(),$a(c[d],1),c[d].m(t,r));}for(Sa(),d=s.length;d<c.length;d+=1)l(d);Ca();}h&&h.p&&(!i||2&u)&&ao(h,f,e,e[1],i?oo(f,e[1],u,ZP):so(e[1]),eT);},i:function(e){if(!i){$a(a,e);for(var t=0;t<s.length;t+=1)$a(c[t]);$a(h,e),i=!0;}},o:function(e){_a(a,e),c=c.filter(Boolean);for(var t=0;t<c.length;t+=1)_a(c[t]);_a(h,e),i=!1;},d:function(e){e&&So(t),a&&a.d(e),Co(c,e),h&&h.d(e);}}}function hT(e){return console.error("Unknown type of menu item",e),"???"}function dT(e,t,n){var r=t.$$slots,i=void 0===r?{}:r,o=t.$$scope,a=t.items,s=void 0===a?[]:a;return e.$$set=function(e){"items"in e&&n(0,s=e.items),"$$scope"in e&&n(1,o=e.$$scope);},[s,o,i]}var vT=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,dT,fT,no,{items:0},XP),r}return qi(n)}();function pT(e){bo(e,"svelte-gz09vf",".jse-json-repair-component.svelte-gz09vf.svelte-gz09vf{flex:1;display:flex;flex-direction:column;background:var(--jse-background-color);color:var(--jse-text-color)}.jse-json-repair-component.svelte-gz09vf .jse-menu .jse-info.svelte-gz09vf{padding:0 var(--jse-padding)}.jse-json-repair-component.svelte-gz09vf .jse-json-text.svelte-gz09vf{flex:1;border:none;padding:2px;font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);background:var(--jse-background-color);color:var(--jse-text-color);resize:none;outline:none}");}function mT(e){var t;return {c:function(){(t=$o("div")).textContent="Repair invalid JSON, then click apply",Ro(t,"slot","left"),Ro(t,"class","jse-info svelte-gz09vf");},m:function(e,n){jo(e,t,n);},p:Ki,d:function(e){e&&So(t);}}}function gT(e){var t,n;return t=new CP({props:{type:"success",message:"JSON is valid now and can be parsed.",actions:e[6]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};64&n&&(r.actions=e[6]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function yT(e){var t,n;return t=new CP({props:{type:"error",icon:MM,message:"Cannot parse JSON: ".concat(e[2].message),actions:e[7]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};4&n&&(r.message="Cannot parse JSON: ".concat(e[2].message)),128&n&&(r.actions=e[7]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function bT(e){var t,n,r,i,o,a,s,c,u,l;n=new vT({props:{items:e[5],$$slots:{left:[mT]},$$scope:{ctx:e}}});var f=[yT,gT],h=[];function d(e,t){return e[2]?0:1}return i=d(e),o=h[i]=f[i](e),{c:function(){t=$o("div"),Da(n.$$.fragment),r=Mo(),o.c(),a=Mo(),(s=$o("textarea")).value=e[0],s.readOnly=e[1],Ro(s,"class","jse-json-text svelte-gz09vf"),Ro(s,"autocomplete","off"),Ro(s,"autocapitalize","off"),Ro(s,"spellcheck","false"),Ro(t,"class","jse-json-repair-component svelte-gz09vf");},m:function(o,f){jo(o,t,f),La(n,t,null),yo(t,r),h[i].m(t,null),yo(t,a),yo(t,s),e[17](s),e[18](t),c=!0,u||(l=Ao(s,"input",e[8]),u=!0);},p:function(e,r){var u=Si(r,1)[0],l={};32&u&&(l.items=e[5]),33554432&u&&(l.$$scope={dirty:u,ctx:e}),n.$set(l);var v=i;(i=d(e))===v?h[i].p(e,u):(Sa(),_a(h[v],1,1,(function(){h[v]=null;})),Ca(),(o=h[i])?o.p(e,u):(o=h[i]=f[i](e)).c(),$a(o,1),o.m(t,a)),(!c||1&u)&&(s.value=e[0]),(!c||2&u)&&(s.readOnly=e[1]);},i:function(e){c||($a(n.$$.fragment,e),$a(o),c=!0);},o:function(e){_a(n.$$.fragment,e),_a(o),c=!1;},d:function(r){r&&So(t),Ba(n),h[i].d(),e[17](null),e[18](null),u=!1,l();}}}function wT(e,t,n){var r,i,o,a,s,c,u,l,f,h=t.text,d=void 0===h?"":h,v=t.readOnly,p=void 0!==v&&v,m=t.onParse,g=t.onRepair,y=t.onChange,b=void 0===y?null:y,w=t.onApply,x=t.onCancel,k=Ha("jsoneditor:JSONRepair");function j(){w(d);}return e.$$set=function(e){"text"in e&&n(0,d=e.text),"readOnly"in e&&n(1,p=e.readOnly),"onParse"in e&&n(9,m=e.onParse),"onRepair"in e&&n(10,g=e.onRepair),"onChange"in e&&n(11,b=e.onChange),"onApply"in e&&n(12,w=e.onApply),"onCancel"in e&&n(13,x=e.onCancel);},e.$$.update=function(){1&e.$$.dirty&&n(2,r=function(e){try{return m(e),null}catch(t){return zS(e,t.message)}}(d)),1&e.$$.dirty&&n(16,i=function(e){try{return g(e),!0}catch(e){return !1}}(d)),4&e.$$.dirty&&k("error",r),8192&e.$$.dirty&&n(5,f=[{type:"space"},{type:"button",icon:CM,title:"Cancel repair",className:"jse-cancel",onClick:x}]),114688&e.$$.dirty&&n(7,s=i?[o,a]:[o]),2&e.$$.dirty&&n(6,c=[{icon:OM,text:"Apply",title:"Apply fixed JSON",disabled:p,onClick:j}]);},n(14,o={icon:yM,text:"Show me",title:"Scroll to the error location",onClick:function(){l&&r&&null!=r.position&&(l.setSelectionRange(r.position,r.position),setTimeout((function(){l.focus();})));}}),n(15,a={icon:aM,text:"Auto repair",title:"Automatically repair JSON",onClick:function(){try{n(0,d=g(d)),b&&b(d);}catch(e){}}}),[d,p,r,u,l,f,c,s,function(e){k("handleChange");var t=e.target.value;d!==t&&(n(0,d=t),b&&b(d));},m,g,b,w,x,o,a,i,function(e){sa[e?"unshift":"push"]((function(){n(4,l=e);}));},function(e){sa[e?"unshift":"push"]((function(){n(3,u=e);}));}]}var xT=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,wT,bT,no,{text:0,readOnly:1,onParse:9,onRepair:10,onChange:11,onApply:12,onCancel:13},pT),r}return qi(n)}(),kT=[];function jT(e){if("Escape"===e.key){var t=Em(kT);t&&t();}}function ST(e,t){return By(kT)&&window.addEventListener("keydown",jT),kT.push(t),{destroy:function(){kT=kT.filter((function(e){return e!==t})),By(kT)&&window.removeEventListener("keydown",jT);}}}function CT(e){bo(e,"svelte-1ffm3pm",".jse-modal.jse-repair.svelte-1ffm3pm{flex:1;display:flex;flex-direction:column;font-family:var(--jse-font-family);font-size:var(--jse-font-size);line-height:normal;background:var(--jse-background-color);color:var(--jse-text-color)}");}function $T(e){var t,n,r,i,o,a;function s(t){e[7](t);}var c={onParse:e[1],onRepair:e[2],onApply:e[4],onCancel:e[5]};return void 0!==e[0]&&(c.text=e[0]),n=new xT({props:c}),sa.push((function(){return Ia(n,"text",s)})),{c:function(){t=$o("div"),Da(n.$$.fragment),Ro(t,"class","jse-modal jse-repair svelte-1ffm3pm");},m:function(r,s){jo(r,t,s),La(n,t,null),i=!0,o||(a=fo(ST.call(null,t,e[3])),o=!0);},p:function(e,t){var i=Si(t,1)[0],o={};2&i&&(o.onParse=e[1]),4&i&&(o.onRepair=e[2]),!r&&1&i&&(r=!0,o.text=e[0],pa((function(){return r=!1}))),n.$set(o);},i:function(e){i||($a(n.$$.fragment,e),i=!0);},o:function(e){_a(n.$$.fragment,e),i=!1;},d:function(e){e&&So(t),Ba(n),o=!1,a();}}}function _T(e,t,n){var r=t.text,i=t.onParse,o=t.onRepair,a=t.onApply,s=ia("simple-modal").close;return e.$$set=function(e){"text"in e&&n(0,r=e.text),"onParse"in e&&n(1,i=e.onParse),"onRepair"in e&&n(2,o=e.onRepair),"onApply"in e&&n(6,a=e.onApply);},[r,i,o,s,function(e){s(),a(e);},function(){s();},a,function(e){n(0,r=e);}]}var OT=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,_T,$T,no,{text:0,onParse:1,onRepair:2,onApply:6},CT),r}return qi(n)}();function MT(e){bo(e,"svelte-1u2b6j8","button.jse-context-menu-button.svelte-1u2b6j8{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;flex:1;white-space:nowrap;padding:var(--jse-padding);color:inherit}button.jse-context-menu-button.svelte-1u2b6j8:hover{background:var(--jse-context-menu-background-highlight)}button.jse-context-menu-button.svelte-1u2b6j8:focus{background:var(--jse-context-menu-background-highlight);z-index:1}button.jse-context-menu-button.svelte-1u2b6j8:disabled{color:var(--jse-context-menu-color-disabled);background:unset}button.jse-context-menu-button.left.svelte-1u2b6j8{text-align:left}button.jse-context-menu-button.svelte-1u2b6j8 svg{width:16px}");}function ET(e){var t,n;return t=new x$({props:{data:e[0].icon}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n&&(r.data=e[0].icon),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function AT(e){var t,n=e[0].text+"";return {c:function(){t=Oo(n);},m:function(e,n){jo(e,t,n);},p:function(e,r){1&r&&n!==(n=e[0].text+"")&&Lo(t,n);},d:function(e){e&&So(t);}}}function PT(e){var t,n,r,i,o,a,s,c,u=e[0].icon&&ET(e),l=e[0].text&&AT(e);return {c:function(){t=$o("button"),u&&u.c(),n=Mo(),l&&l.c(),Ro(t,"type","button"),Ro(t,"class",r=lo(H_("jse-context-menu-button",e[1],e[0].className))+" svelte-1u2b6j8"),Ro(t,"title",i=e[0].title),t.disabled=o=e[0].disabled||!1;},m:function(r,i){jo(r,t,i),u&&u.m(t,null),yo(t,n),l&&l.m(t,null),a=!0,s||(c=Ao(t,"click",(function(){eo(e[0].onClick)&&e[0].onClick.apply(this,arguments);})),s=!0);},p:function(s,c){var f=Si(c,1)[0];(e=s)[0].icon?u?(u.p(e,f),1&f&&$a(u,1)):((u=ET(e)).c(),$a(u,1),u.m(t,n)):u&&(Sa(),_a(u,1,1,(function(){u=null;})),Ca()),e[0].text?l?l.p(e,f):((l=AT(e)).c(),l.m(t,null)):l&&(l.d(1),l=null),(!a||3&f&&r!==(r=lo(H_("jse-context-menu-button",e[1],e[0].className))+" svelte-1u2b6j8"))&&Ro(t,"class",r),(!a||1&f&&i!==(i=e[0].title))&&Ro(t,"title",i),(!a||1&f&&o!==(o=e[0].disabled||!1))&&(t.disabled=o);},i:function(e){a||($a(u),a=!0);},o:function(e){_a(u),a=!1;},d:function(e){e&&So(t),u&&u.d(),l&&l.d(),s=!1,c();}}}function TT(e,t,n){var r=t.item,i=t.className,o=void 0===i?void 0:i;return e.$$set=function(e){"item"in e&&n(0,r=e.item),"className"in e&&n(1,o=e.className);},[r,o]}var RT=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,TT,PT,to,{item:0,className:1},MT),r}return qi(n)}();function NT(e){bo(e,"svelte-12ophpi",".jse-dropdown-button.svelte-12ophpi.svelte-12ophpi{flex:1;line-height:normal;border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;position:relative;padding:0;display:flex}.jse-dropdown-button.svelte-12ophpi ul.svelte-12ophpi{margin:0;padding:0}.jse-dropdown-button.svelte-12ophpi ul li.svelte-12ophpi{margin:0;padding:0;list-style-type:none}.jse-dropdown-button.svelte-12ophpi button.jse-open-dropdown.svelte-12ophpi{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;width:2em;background:var(--jse-context-menu-background);color:var(--jse-context-menu-color);border-radius:0}.jse-dropdown-button.svelte-12ophpi button.jse-open-dropdown.jse-visible.svelte-12ophpi{background:var(--jse-context-menu-background)}.jse-dropdown-button.svelte-12ophpi button.jse-open-dropdown.svelte-12ophpi:hover{background:var(--jse-context-menu-background-highlight)}.jse-dropdown-button.svelte-12ophpi button.jse-open-dropdown.svelte-12ophpi:focus{z-index:1}.jse-dropdown-button.svelte-12ophpi button.jse-open-dropdown.svelte-12ophpi:disabled{color:var(--jse-context-menu-color-disabled);background:unset}.jse-dropdown-button.svelte-12ophpi .jse-dropdown-items.svelte-12ophpi{display:none;position:absolute;top:100%;left:0;z-index:1;background:var(--jse-context-menu-background);color:var(--jse-context-menu-color);box-shadow:var(--jse-controls-box-shadow)}.jse-dropdown-button.svelte-12ophpi .jse-dropdown-items.jse-visible.svelte-12ophpi{display:block}.jse-dropdown-button.svelte-12ophpi .jse-dropdown-items button.svelte-12ophpi{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;width:100%;text-align:left;padding:var(--jse-padding);margin:0}.jse-dropdown-button.svelte-12ophpi .jse-dropdown-items button.svelte-12ophpi:hover{background:var(--jse-context-menu-background-highlight)}.jse-dropdown-button.svelte-12ophpi .jse-dropdown-items button.svelte-12ophpi:disabled{color:var(--jse-context-menu-color-disabled);background:unset}");}function IT(e,t,n){var r=e.slice();return r[11]=t[n],r}var DT=function(e){return {}},LT=function(e){return {}};function BT(e){var t,n;return t=new x$({props:{data:e[11].icon}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n&&(r.data=e[11].icon),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function zT(e){var t,n,r,i,o,a,s,c,u,l,f,h=e[11].text+"",d=e[11].icon&&BT(e);function v(){return e[9](e[11])}return {c:function(){t=$o("li"),n=$o("button"),d&&d.c(),r=Mo(),i=Oo(h),c=Mo(),Ro(n,"type","button"),Ro(n,"title",o=e[11].title),n.disabled=a=e[11].disabled,Ro(n,"class",s=lo(e[11].className)+" svelte-12ophpi"),Ro(t,"class","svelte-12ophpi");},m:function(e,o){jo(e,t,o),yo(t,n),d&&d.m(n,null),yo(n,r),yo(n,i),yo(t,c),u=!0,l||(f=Ao(n,"click",v),l=!0);},p:function(t,c){(e=t)[11].icon?d?(d.p(e,c),1&c&&$a(d,1)):((d=BT(e)).c(),$a(d,1),d.m(n,r)):d&&(Sa(),_a(d,1,1,(function(){d=null;})),Ca()),(!u||1&c)&&h!==(h=e[11].text+"")&&Lo(i,h),(!u||1&c&&o!==(o=e[11].title))&&Ro(n,"title",o),(!u||1&c&&a!==(a=e[11].disabled))&&(n.disabled=a),(!u||1&c&&s!==(s=lo(e[11].className)+" svelte-12ophpi"))&&Ro(n,"class",s);},i:function(e){u||($a(d),u=!0);},o:function(e){_a(d),u=!1;},d:function(e){e&&So(t),d&&d.d(),l=!1,f();}}}function qT(e){var t,n,r,i,o,a,s,c,u,l,f=e[8].defaultItem,h=ro(f,e,e[7],LT);i=new x$({props:{data:dM}});for(var d=e[0],v=[],p=0;p<d.length;p+=1)v[p]=zT(IT(e,d,p));var m=function(e){return _a(v[e],1,1,(function(){v[e]=null;}))};return {c:function(){t=$o("div"),h&&h.c(),n=Mo(),r=$o("button"),Da(i.$$.fragment),o=Mo(),a=$o("div"),s=$o("ul");for(var c=0;c<v.length;c+=1)v[c].c();Ro(r,"type","button"),Ro(r,"class","jse-open-dropdown svelte-12ophpi"),Ro(r,"data-type","jse-open-dropdown"),r.disabled=e[4],Fo(r,"jse-visible",e[3]),Ro(s,"class","svelte-12ophpi"),Ro(a,"class","jse-dropdown-items svelte-12ophpi"),zo(a,"width",e[2]),Fo(a,"jse-visible",e[3]),Ro(t,"class","jse-dropdown-button svelte-12ophpi"),Ro(t,"title",e[1]);},m:function(f,d){jo(f,t,d),h&&h.m(t,null),yo(t,n),yo(t,r),La(i,r,null),yo(t,o),yo(t,a),yo(a,s);for(var p=0;p<v.length;p+=1)v[p]&&v[p].m(s,null);c=!0,u||(l=[Ao(r,"click",e[5]),Ao(t,"click",e[6])],u=!0);},p:function(e,n){var i=Si(n,1)[0];if(h&&h.p&&(!c||128&i)&&ao(h,f,e,e[7],c?oo(f,e[7],i,DT):so(e[7]),LT),(!c||16&i)&&(r.disabled=e[4]),(!c||8&i)&&Fo(r,"jse-visible",e[3]),1&i){var o;for(d=e[0],o=0;o<d.length;o+=1){var u=IT(e,d,o);v[o]?(v[o].p(u,i),$a(v[o],1)):(v[o]=zT(u),v[o].c(),$a(v[o],1),v[o].m(s,null));}for(Sa(),o=d.length;o<v.length;o+=1)m(o);Ca();}(!c||4&i)&&zo(a,"width",e[2]),(!c||8&i)&&Fo(a,"jse-visible",e[3]),(!c||2&i)&&Ro(t,"title",e[1]);},i:function(e){if(!c){$a(h,e),$a(i.$$.fragment,e);for(var t=0;t<d.length;t+=1)$a(v[t]);c=!0;}},o:function(e){_a(h,e),_a(i.$$.fragment,e),v=v.filter(Boolean);for(var t=0;t<v.length;t+=1)_a(v[t]);c=!1;},d:function(e){e&&So(t),h&&h.d(e),Ba(i),Co(v,e),u=!1,Zi(l);}}}function FT(e,t,n){var r,i=t.$$slots,o=void 0===i?{}:i,a=t.$$scope,s=t.items,c=void 0===s?[]:s,u=t.title,l=void 0===u?void 0:u,f=t.width,h=void 0===f?"120px":f,d=!1;function v(){n(3,d=!1);}function p(e){"Escape"===_C(e)&&(e.preventDefault(),n(3,d=!1));}ea((function(){document.addEventListener("click",v),document.addEventListener("keydown",p);})),ta((function(){document.removeEventListener("click",v),document.removeEventListener("keydown",p);}));return e.$$set=function(e){"items"in e&&n(0,c=e.items),"title"in e&&n(1,l=e.title),"width"in e&&n(2,h=e.width),"$$scope"in e&&n(7,a=e.$$scope);},e.$$.update=function(){1&e.$$.dirty&&n(4,r=c.every((function(e){return !0===e.disabled})));},[c,l,h,d,r,function(){var e=d;setTimeout((function(){return n(3,d=!e)}));},v,a,o,function(e){return e.onClick()}]}var VT=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,FT,qT,no,{items:0,title:1,width:2},NT),r}return qi(n)}();function WT(e){bo(e,"svelte-1u2b6j8","button.jse-context-menu-button.svelte-1u2b6j8{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;flex:1;white-space:nowrap;padding:var(--jse-padding);color:inherit}button.jse-context-menu-button.svelte-1u2b6j8:hover{background:var(--jse-context-menu-background-highlight)}button.jse-context-menu-button.svelte-1u2b6j8:focus{background:var(--jse-context-menu-background-highlight);z-index:1}button.jse-context-menu-button.svelte-1u2b6j8:disabled{color:var(--jse-context-menu-color-disabled);background:unset}button.jse-context-menu-button.left.svelte-1u2b6j8{text-align:left}button.jse-context-menu-button.svelte-1u2b6j8 svg{width:16px}");}function HT(e){var t,n;return t=new x$({props:{data:e[0].main.icon}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n&&(r.data=e[0].main.icon),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function UT(e){var t,n,r,i,o,a,s,c,u,l=e[0].main.text+"",f=e[0].main.icon&&HT(e);return {c:function(){t=$o("button"),f&&f.c(),n=Mo(),r=Oo(l),Ro(t,"class",i=lo(H_("jse-context-menu-button",e[1],e[0].main.className))+" svelte-1u2b6j8"),Ro(t,"type","button"),Ro(t,"slot","defaultItem"),Ro(t,"title",o=e[0].main.title),t.disabled=a=e[0].main.disabled||!1;},m:function(i,o){jo(i,t,o),f&&f.m(t,null),yo(t,n),yo(t,r),s=!0,c||(u=Ao(t,"click",(function(){eo(e[0].main.onClick)&&e[0].main.onClick.apply(this,arguments);})),c=!0);},p:function(c,u){(e=c)[0].main.icon?f?(f.p(e,u),1&u&&$a(f,1)):((f=HT(e)).c(),$a(f,1),f.m(t,n)):f&&(Sa(),_a(f,1,1,(function(){f=null;})),Ca()),(!s||1&u)&&l!==(l=e[0].main.text+"")&&Lo(r,l),(!s||3&u&&i!==(i=lo(H_("jse-context-menu-button",e[1],e[0].main.className))+" svelte-1u2b6j8"))&&Ro(t,"class",i),(!s||1&u&&o!==(o=e[0].main.title))&&Ro(t,"title",o),(!s||1&u&&a!==(a=e[0].main.disabled||!1))&&(t.disabled=a);},i:function(e){s||($a(f),s=!0);},o:function(e){_a(f),s=!1;},d:function(e){e&&So(t),f&&f.d(),c=!1,u();}}}function JT(e){var t,n;return t=new VT({props:{width:e[0].width,items:e[0].items,$$slots:{defaultItem:[UT]},$$scope:{ctx:e}}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r=Si(n,1)[0],i={};1&r&&(i.width=e[0].width),1&r&&(i.items=e[0].items),7&r&&(i.$$scope={dirty:r,ctx:e}),t.$set(i);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function KT(e,t,n){var r=t.item,i=t.className,o=void 0===i?void 0:i;return e.$$set=function(e){"item"in e&&n(0,r=e.item),"className"in e&&n(1,o=e.className);},[r,o]}var GT=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,KT,JT,to,{item:0,className:1},WT),r}return qi(n)}();function QT(e){bo(e,"svelte-1nininf",".jse-contextmenu.svelte-1nininf.svelte-1nininf{box-shadow:var(--jse-controls-box-shadow);font-family:var(--jse-font-family);font-size:var(--jse-font-size);background:var(--jse-context-menu-background);color:var(--jse-context-menu-color)}.jse-contextmenu.svelte-1nininf .jse-row.svelte-1nininf{display:flex;flex-direction:row;align-items:flex-start;justify-content:stretch}.jse-contextmenu.svelte-1nininf .jse-row div.jse-label.svelte-1nininf{flex:1;white-space:nowrap;padding:var(--jse-padding);color:var(--jse-context-menu-color-disabled);line-height:normal}.jse-contextmenu.svelte-1nininf .jse-row div.jse-tip.svelte-1nininf{flex:1;background:var(--jse-context-menu-tip-background);color:var(--jse-context-menu-tip-color);margin:calc(0.5 * var(--jse-padding));padding:calc(0.5 * var(--jse-padding)) var(--jse-padding);font-size:80%;line-height:1.3em;display:flex;flex-direction:row;align-items:start;gap:var(--jse-padding);border-radius:3px}.jse-contextmenu.svelte-1nininf .jse-row div.jse-tip div.jse-tip-icon.svelte-1nininf{padding-top:calc(0.5 * var(--jse-padding))}.jse-contextmenu.svelte-1nininf .jse-column.svelte-1nininf{flex:1;display:flex;flex-direction:column;align-items:stretch}.jse-contextmenu.svelte-1nininf .jse-column.svelte-1nininf:not(:last-child){border-right:1px solid var(--jse-context-menu-separator-color)}.jse-contextmenu.svelte-1nininf .jse-separator.svelte-1nininf{width:100%;height:1px;background:var(--jse-context-menu-separator-color)}");}function YT(e,t,n){var r=e.slice();return r[6]=t[n],r}function XT(e,t,n){var r=e.slice();return r[9]=t[n],r}function ZT(e,t,n){var r=e.slice();return r[12]=t[n],r}function eR(e){var t,n=wR(e[6])+"";return {c:function(){t=Oo(n);},m:function(e,n){jo(e,t,n);},p:function(e,r){1&r&&n!==(n=wR(e[6])+"")&&Lo(t,n);},i:Ki,o:Ki,d:function(e){e&&So(t);}}}function tR(e){var t;return {c:function(){Ro(t=$o("div"),"class","jse-separator svelte-1nininf");},m:function(e,n){jo(e,t,n);},p:Ki,i:Ki,o:Ki,d:function(e){e&&So(t);}}}function nR(e){for(var t,n,r=e[6].items,i=[],o=0;o<r.length;o+=1)i[o]=mR(XT(e,r,o));var a=function(e){return _a(i[e],1,1,(function(){i[e]=null;}))};return {c:function(){t=$o("div");for(var e=0;e<i.length;e+=1)i[e].c();Ro(t,"class","jse-row svelte-1nininf");},m:function(e,r){jo(e,t,r);for(var o=0;o<i.length;o+=1)i[o]&&i[o].m(t,null);n=!0;},p:function(e,n){if(1&n){var o;for(r=e[6].items,o=0;o<r.length;o+=1){var s=XT(e,r,o);i[o]?(i[o].p(s,n),$a(i[o],1)):(i[o]=mR(s),i[o].c(),$a(i[o],1),i[o].m(t,null));}for(Sa(),o=r.length;o<i.length;o+=1)a(o);Ca();}},i:function(e){if(!n){for(var t=0;t<r.length;t+=1)$a(i[t]);n=!0;}},o:function(e){i=i.filter(Boolean);for(var t=0;t<i.length;t+=1)_a(i[t]);n=!1;},d:function(e){e&&So(t),Co(i,e);}}}function rR(e){var t,n;return t=new GT({props:{item:e[6]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n&&(r.item=e[6]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function iR(e){var t,n;return t=new RT({props:{item:e[6]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n&&(r.item=e[6]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function oR(e){var t,n=wR(e[9])+"";return {c:function(){t=Oo(n);},m:function(e,n){jo(e,t,n);},p:function(e,r){1&r&&n!==(n=wR(e[9])+"")&&Lo(t,n);},i:Ki,o:Ki,d:function(e){e&&So(t);}}}function aR(e){var t;return {c:function(){Ro(t=$o("div"),"class","jse-separator svelte-1nininf");},m:function(e,n){jo(e,t,n);},p:Ki,i:Ki,o:Ki,d:function(e){e&&So(t);}}}function sR(e){for(var t,n,r=e[9].items,i=[],o=0;o<r.length;o+=1)i[o]=pR(ZT(e,r,o));var a=function(e){return _a(i[e],1,1,(function(){i[e]=null;}))};return {c:function(){t=$o("div");for(var e=0;e<i.length;e+=1)i[e].c();Ro(t,"class","jse-column svelte-1nininf");},m:function(e,r){jo(e,t,r);for(var o=0;o<i.length;o+=1)i[o]&&i[o].m(t,null);n=!0;},p:function(e,n){if(1&n){var o;for(r=e[9].items,o=0;o<r.length;o+=1){var s=ZT(e,r,o);i[o]?(i[o].p(s,n),$a(i[o],1)):(i[o]=pR(s),i[o].c(),$a(i[o],1),i[o].m(t,null));}for(Sa(),o=r.length;o<i.length;o+=1)a(o);Ca();}},i:function(e){if(!n){for(var t=0;t<r.length;t+=1)$a(i[t]);n=!0;}},o:function(e){i=i.filter(Boolean);for(var t=0;t<i.length;t+=1)_a(i[t]);n=!1;},d:function(e){e&&So(t),Co(i,e);}}}function cR(e){var t,n;return t=new GT({props:{item:e[9]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n&&(r.item=e[9]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function uR(e){var t,n;return t=new RT({props:{item:e[9]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n&&(r.item=e[9]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function lR(e){var t,n=wR(e[12])+"";return {c:function(){t=Oo(n);},m:function(e,n){jo(e,t,n);},p:function(e,r){1&r&&n!==(n=wR(e[12])+"")&&Lo(t,n);},i:Ki,o:Ki,d:function(e){e&&So(t);}}}function fR(e){var t,n,r=e[12].text+"";return {c:function(){t=$o("div"),n=Oo(r),Ro(t,"class","jse-label svelte-1nininf");},m:function(e,r){jo(e,t,r),yo(t,n);},p:function(e,t){1&t&&r!==(r=e[12].text+"")&&Lo(n,r);},i:Ki,o:Ki,d:function(e){e&&So(t);}}}function hR(e){var t;return {c:function(){Ro(t=$o("div"),"class","jse-separator svelte-1nininf");},m:function(e,n){jo(e,t,n);},p:Ki,i:Ki,o:Ki,d:function(e){e&&So(t);}}}function dR(e){var t,n;return t=new GT({props:{className:"left",item:e[12]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n&&(r.item=e[12]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function vR(e){var t,n;return t=new RT({props:{className:"left",item:e[12]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n&&(r.item=e[12]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function pR(e){var t,n,r,i,o,a,s,c,u=[vR,dR,hR,fR,lR],l=[];function f(e,o){return 1&o&&(t=null),1&o&&(n=null),1&o&&(r=null),1&o&&(i=null),null==t&&(t=!!KP(e[12])),t?0:(null==n&&(n=!!GP(e[12])),n?1:(null==r&&(r=!!JP(e[12])),r?2:(null==i&&(a=e[12],i=!(!a||"label"!==a.type||"string"!=typeof a.text)),i?3:4)));var a;}return o=f(e,-1),a=l[o]=u[o](e),{c:function(){a.c(),s=Eo();},m:function(e,t){l[o].m(e,t),jo(e,s,t),c=!0;},p:function(e,t){var n=o;(o=f(e,t))===n?l[o].p(e,t):(Sa(),_a(l[n],1,1,(function(){l[n]=null;})),Ca(),(a=l[o])?a.p(e,t):(a=l[o]=u[o](e)).c(),$a(a,1),a.m(s.parentNode,s));},i:function(e){c||($a(a),c=!0);},o:function(e){_a(a),c=!1;},d:function(e){l[o].d(e),e&&So(s);}}}function mR(e){var t,n,r,i,o,a,s,c,u=[uR,cR,sR,aR,oR],l=[];function f(e,o){return 1&o&&(t=null),1&o&&(n=null),1&o&&(r=null),1&o&&(i=null),null==t&&(t=!!KP(e[9])),t?0:(null==n&&(n=!!GP(e[9])),n?1:(null==r&&(a=e[9],r=!(!a||"column"!==a.type||!Array.isArray(a.items))),r?2:(null==i&&(i=!!JP(e[9])),i?3:4)));var a;}return o=f(e,-1),a=l[o]=u[o](e),{c:function(){a.c(),s=Eo();},m:function(e,t){l[o].m(e,t),jo(e,s,t),c=!0;},p:function(e,t){var n=o;(o=f(e,t))===n?l[o].p(e,t):(Sa(),_a(l[n],1,1,(function(){l[n]=null;})),Ca(),(a=l[o])?a.p(e,t):(a=l[o]=u[o](e)).c(),$a(a,1),a.m(s.parentNode,s));},i:function(e){c||($a(a),c=!0);},o:function(e){_a(a),c=!1;},d:function(e){l[o].d(e),e&&So(s);}}}function gR(e){var t,n,r,i,o,a,s,c,u=[iR,rR,nR,tR,eR],l=[];function f(e,o){return 1&o&&(t=null),1&o&&(n=null),1&o&&(r=null),1&o&&(i=null),null==t&&(t=!!KP(e[6])),t?0:(null==n&&(n=!!GP(e[6])),n?1:(null==r&&(a=e[6],r=!(!a||"row"!==a.type||!Array.isArray(a.items))),r?2:(null==i&&(i=!!JP(e[6])),i?3:4)));var a;}return o=f(e,-1),a=l[o]=u[o](e),{c:function(){a.c(),s=Eo();},m:function(e,t){l[o].m(e,t),jo(e,s,t),c=!0;},p:function(e,t){var n=o;(o=f(e,t))===n?l[o].p(e,t):(Sa(),_a(l[n],1,1,(function(){l[n]=null;})),Ca(),(a=l[o])?a.p(e,t):(a=l[o]=u[o](e)).c(),$a(a,1),a.m(s.parentNode,s));},i:function(e){c||($a(a),c=!0);},o:function(e){_a(a),c=!1;},d:function(e){l[o].d(e),e&&So(s);}}}function yR(e){var t,n,r,i,o,a,s,c;return i=new x$({props:{data:ZC}}),{c:function(){t=$o("div"),n=$o("div"),r=$o("div"),Da(i.$$.fragment),o=Mo(),a=$o("div"),s=Oo(e[1]),Ro(r,"class","jse-tip-icon svelte-1nininf"),Ro(a,"class","jse-tip-text"),Ro(n,"class","jse-tip svelte-1nininf"),Ro(t,"class","jse-row svelte-1nininf");},m:function(e,u){jo(e,t,u),yo(t,n),yo(n,r),La(i,r,null),yo(n,o),yo(n,a),yo(a,s),c=!0;},p:function(e,t){(!c||2&t)&&Lo(s,e[1]);},i:function(e){c||($a(i.$$.fragment,e),c=!0);},o:function(e){_a(i.$$.fragment,e),c=!1;},d:function(e){e&&So(t),Ba(i);}}}function bR(e){for(var t,n,r,i,o,a=e[0],s=[],c=0;c<a.length;c+=1)s[c]=gR(YT(e,a,c));var u=function(e){return _a(s[e],1,1,(function(){s[e]=null;}))},l=e[1]&&yR(e);return {c:function(){t=$o("div");for(var e=0;e<s.length;e+=1)s[e].c();n=Mo(),l&&l.c(),Ro(t,"class","jse-contextmenu svelte-1nininf");},m:function(a,c){jo(a,t,c);for(var u=0;u<s.length;u+=1)s[u]&&s[u].m(t,null);yo(t,n),l&&l.m(t,null),e[4](t),r=!0,i||(o=Ao(t,"keydown",e[3]),i=!0);},p:function(e,r){var i=Si(r,1)[0];if(1&i){var o;for(a=e[0],o=0;o<a.length;o+=1){var c=YT(e,a,o);s[o]?(s[o].p(c,i),$a(s[o],1)):(s[o]=gR(c),s[o].c(),$a(s[o],1),s[o].m(t,n));}for(Sa(),o=a.length;o<s.length;o+=1)u(o);Ca();}e[1]?l?(l.p(e,i),2&i&&$a(l,1)):((l=yR(e)).c(),$a(l,1),l.m(t,null)):l&&(Sa(),_a(l,1,1,(function(){l=null;})),Ca());},i:function(e){if(!r){for(var t=0;t<a.length;t+=1)$a(s[t]);$a(l),r=!0;}},o:function(e){s=s.filter(Boolean);for(var t=0;t<s.length;t+=1)_a(s[t]);_a(l),r=!1;},d:function(n){n&&So(t),Co(s,n),l&&l.d(),e[4](null),i=!1,o();}}}function wR(e){return console.error("Unknown type of context menu item",e),"???"}function xR(e,t,n){var r,i=t.items,o=t.tip;ea((function(){setTimeout((function(){var e=Vi(r.querySelectorAll("button")).find((function(e){return !e.disabled}));e&&e.focus();}));}));var a={ArrowUp:"Up",ArrowDown:"Down",ArrowLeft:"Left",ArrowRight:"Right"};return e.$$set=function(e){"items"in e&&n(0,i=e.items),"tip"in e&&n(1,o=e.tip);},[i,o,r,function(e){var t=_C(e),n=a[t];if("string"==typeof n){e.preventDefault();var i=$C({allElements:Array.from(r.querySelectorAll("button:not([disabled])")),currentElement:e.target,direction:n,hasPrio:function(e){return "jse-open-dropdown"!==e.getAttribute("data-type")}});i&&i.focus();}},function(e){sa[e?"unshift":"push"]((function(){n(2,r=e);}));}]}var kR=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,xR,bR,no,{items:0,tip:1},QT),r}return qi(n)}();function jR(e){var t,n;return t=new kR({props:{items:e[1],tip:e[0]?"Tip: you can open this context menu via right-click or with Ctrl+Q":void 0}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};2&n[0]&&(r.items=e[1]),1&n[0]&&(r.tip=e[0]?"Tip: you can open this context menu via right-click or with Ctrl+Q":void 0),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function SR(e,t,n){var r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b,w,x,k,j=t.json,S=t.documentState,C=t.parser,$=t.showTip,_=t.onCloseContextMenu,O=t.onEditKey,M=t.onEditValue,E=t.onToggleEnforceString,A=t.onCut,P=t.onCopy,T=t.onPaste,R=t.onRemove,N=t.onDuplicate,I=t.onExtract,D=t.onInsertBefore,L=t.onInsert,B=t.onConvert,z=t.onInsertAfter,q=t.onSort,F=t.onTransform;function V(){_(),O();}function W(){_(),M();}function H(){_(),E();}function U(){_(),A(!0);}function J(){_(),A(!1);}function K(){_(),P(!0);}function G(){_(),P(!1);}function Q(){_(),T();}function Y(){_(),R();}function X(){_(),N();}function Z(){_(),I();}function ee(e){_(),u?B(e):L(e);}function te(){_(),q();}function ne(){_(),F();}function re(){_(),D();}function ie(){_(),z();}return e.$$set=function(e){"json"in e&&n(2,j=e.json),"documentState"in e&&n(3,S=e.documentState),"parser"in e&&n(4,C=e.parser),"showTip"in e&&n(0,$=e.showTip),"onCloseContextMenu"in e&&n(5,_=e.onCloseContextMenu),"onEditKey"in e&&n(6,O=e.onEditKey),"onEditValue"in e&&n(7,M=e.onEditValue),"onToggleEnforceString"in e&&n(8,E=e.onToggleEnforceString),"onCut"in e&&n(9,A=e.onCut),"onCopy"in e&&n(10,P=e.onCopy),"onPaste"in e&&n(11,T=e.onPaste),"onRemove"in e&&n(12,R=e.onRemove),"onDuplicate"in e&&n(13,N=e.onDuplicate),"onExtract"in e&&n(14,I=e.onExtract),"onInsertBefore"in e&&n(15,D=e.onInsertBefore),"onInsert"in e&&n(16,L=e.onInsert),"onConvert"in e&&n(17,B=e.onConvert),"onInsertAfter"in e&&n(18,z=e.onInsertAfter),"onSort"in e&&n(19,q=e.onSort),"onTransform"in e&&n(20,F=e.onTransform);},e.$$.update=function(){8&e.$$.dirty[0]&&n(37,r=S.selection),4&e.$$.dirty[0]&&n(39,i=void 0!==j),64&e.$$.dirty[1]&&n(31,o=null!=r),65&e.$$.dirty[1]&&n(21,a=o&&By(r.focusPath)),4&e.$$.dirty[0]|65&e.$$.dirty[1]&&n(38,s=o?Vs(j,r.focusPath):void 0),128&e.$$.dirty[1]&&n(35,c=Array.isArray(s)?"Edit array":hu(s)?"Edit object":"Edit value"),320&e.$$.dirty[1]&&n(22,u=i&&(m_(r)||v_(r)||p_(r))),6291456&e.$$.dirty[0]|256&e.$$.dirty[1]&&n(30,l=i&&u&&!a),2097152&e.$$.dirty[0]|320&e.$$.dirty[1]&&n(29,f=i&&null!=r&&(m_(r)||p_(r))&&!a),2097156&e.$$.dirty[0]|320&e.$$.dirty[1]&&n(36,h=i&&null!=r&&O_(r)&&!a&&!Array.isArray(Vs(j,ly(r.focusPath)))),320&e.$$.dirty[1]&&n(34,d=i&&null!=r&&O_(r)),136&e.$$.dirty[1]&&n(32,v=d&&!du(s)),4194304&e.$$.dirty[0]&&n(25,p=u),33554432&e.$$.dirty[0]&&n(24,m=p?"Convert to:":"Insert:"),33554432&e.$$.dirty[0]|1&e.$$.dirty[1]&&n(28,g=!p&&o),33554432&e.$$.dirty[0]|193&e.$$.dirty[1]&&n(27,y=p?q_(r)&&!hu(s):o),33554432&e.$$.dirty[0]|193&e.$$.dirty[1]&&n(26,b=p?q_(r)&&!Array.isArray(s):o),33554432&e.$$.dirty[0]|193&e.$$.dirty[1]&&n(23,w=p?q_(r)&&du(s):o),24&e.$$.dirty[0]|192&e.$$.dirty[1]&&n(33,x=null!=r&&r_(s,S.enforceStringMap,Ys(r.focusPath),C)),2145386496&e.$$.dirty[0]|63&e.$$.dirty[1]&&n(1,k=[{type:"row",items:[{type:"button",onClick:V,icon:cM,text:"Edit key",title:"Edit the key (Double-click on the key)",disabled:!h},{type:"dropdown-button",main:{type:"button",onClick:W,icon:cM,text:c,title:"Edit the value (Double-click on the value)",disabled:!d},width:"11em",items:[{type:"button",icon:cM,text:c,title:"Edit the value (Double-click on the value)",onClick:W,disabled:!d},{type:"button",icon:x?e$:t$,text:"Enforce string",title:"Enforce keeping the value as string when it contains a numeric value",onClick:H,disabled:!v}]}]},{type:"separator"},{type:"row",items:[{type:"dropdown-button",main:{type:"button",onClick:U,icon:QO,text:"Cut",title:"Cut selected contents, formatted with indentation (Ctrl+X)",disabled:!u},width:"10em",items:[{type:"button",icon:QO,text:"Cut formatted",title:"Cut selected contents, formatted with indentation (Ctrl+X)",onClick:U,disabled:!u},{type:"button",icon:QO,text:"Cut compacted",title:"Cut selected contents, without indentation (Ctrl+Shift+X)",onClick:J,disabled:!u}]},{type:"dropdown-button",main:{type:"button",onClick:K,icon:xM,text:"Copy",title:"Copy selected contents, formatted with indentation (Ctrl+C)",disabled:!u},width:"12em",items:[{type:"button",icon:xM,text:"Copy formatted",title:"Copy selected contents, formatted with indentation (Ctrl+C)",onClick:K,disabled:!u},{type:"button",icon:xM,text:"Copy compacted",title:"Copy selected contents, without indentation (Ctrl+Shift+C)",onClick:G,disabled:!u}]},{type:"button",onClick:Q,icon:KO,text:"Paste",title:"Paste clipboard contents (Ctrl+V)",disabled:!o}]},{type:"separator"},{type:"row",items:[{type:"column",items:[{type:"button",onClick:X,icon:_M,text:"Duplicate",title:"Duplicate selected contents (Ctrl+D)",disabled:!l},{type:"button",onClick:Z,icon:fM,text:"Extract",title:"Extract selected contents",disabled:!f},{type:"button",onClick:te,icon:mM,text:"Sort",title:"Sort array or object contents",disabled:!u},{type:"button",onClick:ne,icon:iM,text:"Transform",title:"Transform array or object contents (filter, sort, project)",disabled:!u},{type:"button",onClick:Y,icon:UO,text:"Remove",title:"Remove selected contents (Delete)",disabled:!u}]},{type:"column",items:[{type:"label",text:m},{type:"button",onClick:function(){return ee("structure")},icon:p?pM:kM,text:"Structure",title:m+" structure",disabled:!g},{type:"button",onClick:function(){return ee("object")},icon:p?pM:kM,text:"Object",title:m+" structure",disabled:!y},{type:"button",onClick:function(){return ee("array")},icon:p?pM:kM,text:"Array",title:m+" array",disabled:!b},{type:"button",onClick:function(){return ee("value")},icon:p?pM:kM,text:"Value",title:m+" value",disabled:!w}]}]},{type:"separator"},{type:"row",items:[{type:"button",onClick:re,icon:nM,text:"Insert before",title:"Select area before current entry to insert or paste contents",disabled:!u||a},{type:"button",onClick:ie,icon:YO,text:"Insert after",title:"Select area after current entry to insert or paste contents",disabled:!u||a}]}]);},[$,k,j,S,C,_,O,M,E,A,P,T,R,N,I,D,L,B,z,q,F,a,u,w,m,p,b,y,g,f,l,o,v,x,d,c,h,r,s,i]}var CR=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,SR,jR,no,{json:2,documentState:3,parser:4,showTip:0,onCloseContextMenu:5,onEditKey:6,onEditValue:7,onToggleEnforceString:8,onCut:9,onCopy:10,onPaste:11,onRemove:12,onDuplicate:13,onExtract:14,onInsertBefore:15,onInsert:16,onConvert:17,onInsertAfter:18,onSort:19,onTransform:20},null,[-1,-1]),r}return qi(n)}();function $R(e){bo(e,"svelte-1kai5ns","div.jse-collapsed-items.svelte-1kai5ns.svelte-1kai5ns{font-family:var(--jse-font-family);font-size:var(--jse-font-size);color:var(--jse-collapsed-items-link-color);padding:calc(0.5 * var(--jse-padding));border:8px solid transparent;border-width:8px 0;background-color:var(--jse-contents-background-color);background-image:linear-gradient(var(--jse-collapsed-items-background-color), var(--jse-collapsed-items-background-color)), linear-gradient(to bottom right, transparent 50.5%, var(--jse-collapsed-items-background-color) 50.5%), linear-gradient(to bottom left, transparent 50.5%, var(--jse-collapsed-items-background-color) 50.5%), linear-gradient(to top right, transparent 50.5%, var(--jse-collapsed-items-background-color) 50.5%), linear-gradient(to top left, transparent 50.5%, var(--jse-collapsed-items-background-color) 50.5%);background-repeat:repeat, repeat-x, repeat-x, repeat-x, repeat-x;background-position:0 0, 8px 0, 8px 0, 8px 100%, 8px 100%;background-size:auto auto, 16px 16px, 16px 16px, 16px 16px, 16px 16px;background-clip:padding-box, border-box, border-box, border-box, border-box;background-origin:padding-box, border-box, border-box, border-box, border-box;display:flex}div.jse-collapsed-items.svelte-1kai5ns div.jse-text.svelte-1kai5ns,div.jse-collapsed-items.svelte-1kai5ns button.jse-expand-items.svelte-1kai5ns{margin:0 calc(0.5 * var(--jse-padding))}div.jse-collapsed-items.svelte-1kai5ns div.jse-text.svelte-1kai5ns{display:inline}div.jse-collapsed-items.svelte-1kai5ns button.jse-expand-items.svelte-1kai5ns{font-family:inherit;font-size:inherit;color:var(--jse-collapsed-items-link-color);background:none;border:none;padding:0;text-decoration:underline;cursor:pointer}div.jse-collapsed-items.svelte-1kai5ns button.jse-expand-items.svelte-1kai5ns:hover,div.jse-collapsed-items.svelte-1kai5ns button.jse-expand-items.svelte-1kai5ns:focus{color:var(--jse-collapsed-items-link-color-highlight)}");}function _R(e,t,n){var r=e.slice();return r[13]=t[n],r}function OR(e){var t,n,r,i,o,a,s,c,u=e[13].start+"",l=e[13].end+"";function f(){return e[12](e[13])}return {c:function(){t=$o("button"),n=Oo("show "),r=Oo(u),i=Oo("-"),o=Oo(l),a=Mo(),Ro(t,"type","button"),Ro(t,"class","jse-expand-items svelte-1kai5ns");},m:function(e,u){jo(e,t,u),yo(t,n),yo(t,r),yo(t,i),yo(t,o),yo(t,a),s||(c=Ao(t,"click",f),s=!0);},p:function(t,n){e=t,16&n&&u!==(u=e[13].start+"")&&Lo(r,u),16&n&&l!==(l=e[13].end+"")&&Lo(o,l);},d:function(e){e&&So(t),s=!1,c();}}}function MR(e){for(var t,n,r,i,o,a,s,c,u,l,f,h=e[4],d=[],v=0;v<h.length;v+=1)d[v]=OR(_R(e,h,v));return {c:function(){t=$o("div"),n=$o("div"),r=$o("div"),i=Oo("Items "),o=Oo(e[3]),a=Oo("-"),s=Oo(e[2]),c=Mo();for(var l=0;l<d.length;l+=1)d[l].c();Ro(r,"class","jse-text svelte-1kai5ns"),Ro(t,"class","jse-collapsed-items svelte-1kai5ns"),Ro(t,"style",u=ER(e[0].length+2)),Fo(t,"jse-selected",e[5]);},m:function(e,u){jo(e,t,u),yo(t,n),yo(n,r),yo(r,i),yo(r,o),yo(r,a),yo(r,s),yo(n,c);for(var h=0;h<d.length;h+=1)d[h]&&d[h].m(n,null);l||(f=Ao(t,"mousemove",AR),l=!0);},p:function(e,r){var i=Si(r,1)[0];if(8&i&&Lo(o,e[3]),4&i&&Lo(s,e[2]),19&i){var a;for(h=e[4],a=0;a<h.length;a+=1){var c=_R(e,h,a);d[a]?d[a].p(c,i):(d[a]=OR(c),d[a].c(),d[a].m(n,null));}for(;a<d.length;a+=1)d[a].d(1);d.length=h.length;}1&i&&u!==(u=ER(e[0].length+2))&&Ro(t,"style",u),32&i&&Fo(t,"jse-selected",e[5]);},i:Ki,o:Ki,d:function(e){e&&So(t),Co(d,e),l=!1,f();}}}function ER(e){return "margin-left: calc(".concat(e," * var(--jse-indent-size))")}function AR(e){e.stopPropagation();}function PR(e,t,n){var r,i,o,a,s,c=t.visibleSections,u=t.sectionIndex,l=t.total,f=t.path,h=t.pointer,d=t.selection,v=t.onExpandSection;return e.$$set=function(e){"visibleSections"in e&&n(6,c=e.visibleSections),"sectionIndex"in e&&n(7,u=e.sectionIndex),"total"in e&&n(8,l=e.total),"path"in e&&n(0,f=e.path),"pointer"in e&&n(9,h=e.pointer),"selection"in e&&n(10,d=e.selection),"onExpandSection"in e&&n(1,v=e.onExpandSection);},e.$$.update=function(){192&e.$$.dirty&&n(11,r=c[u]),2048&e.$$.dirty&&n(3,i=r.end),448&e.$$.dirty&&n(2,o=c[u+1]?c[u+1].start:l),1544&e.$$.dirty&&n(5,a=!!m_(d)&&!0===d.pointersMap[Zs(h,i)]),12&e.$$.dirty&&n(4,s=function(e,t){var n={start:e,end:Math.min(I$(e),t)},r=Math.max(D$((e+t)/2),e),i={start:r,end:Math.min(I$(r),t)},o=D$(t),a=o===t?o-100:o,s={start:Math.max(a,e),end:t},c=[n],u=i.start>=n.end&&i.end<=s.start;return u&&c.push(i),s.start>=(u?i.end:n.end)&&c.push(s),c}(i,o));},[f,v,o,i,s,a,c,u,l,h,d,r,function(e){return v(f,e)}]}var TR=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,PR,MR,no,{visibleSections:6,sectionIndex:7,total:8,path:0,pointer:9,selection:10,onExpandSection:1},$R),r}return qi(n)}();function RR(e){bo(e,"svelte-1yzl4st",".jse-context-menu-pointer.svelte-1yzl4st{position:absolute;top:calc(-0.5 * var(--jse-context-menu-pointer-size));right:calc(-0.5 * var(--jse-context-menu-pointer-size));width:var(--jse-context-menu-pointer-size);height:var(--jse-context-menu-pointer-size);padding:0;margin:0;cursor:pointer;background:transparent;border-radius:2px;background:var(--jse-context-menu-pointer-background);color:var(--jse-context-menu-pointer-color);border:none;box-shadow:var(--jse-controls-box-shadow)}.jse-context-menu-pointer.svelte-1yzl4st:hover{background:var(--jse-context-menu-pointer-background-highlight)}");}function NR(e){var t,n,r,i,o;return n=new x$({props:{data:dM}}),{c:function(){t=$o("button"),Da(n.$$.fragment),Ro(t,"type","button"),Ro(t,"class","jse-context-menu-pointer svelte-1yzl4st"),Ro(t,"title",bs),Fo(t,"jse-selected",e[0]);},m:function(a,s){jo(a,t,s),La(n,t,null),r=!0,i||(o=Ao(t,"click",e[1]),i=!0);},p:function(e,n){var i=Si(n,1)[0];(!r||1&i)&&Fo(t,"jse-selected",e[0]);},i:function(e){r||($a(n.$$.fragment,e),r=!0);},o:function(e){_a(n.$$.fragment,e),r=!1;},d:function(e){e&&So(t),Ba(n),i=!1,o();}}}function IR(e,t,n){var r=t.selected,i=t.onContextMenu;return e.$$set=function(e){"selected"in e&&n(0,r=e.selected),"onContextMenu"in e&&n(2,i=e.onContextMenu);},[r,function(e){for(var t=e.target;t&&"BUTTON"!==t.nodeName;)t=t.parentNode;t&&i({anchor:t,left:0,top:0,width:260,height:336,offsetTop:2,offsetLeft:0,showTip:!0});},i]}var DR=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,IR,NR,no,{selected:0,onContextMenu:2},RR),r}return qi(n)}();function LR(e){bo(e,"svelte-24a1b2",'.jse-key.svelte-24a1b2{display:inline-block;min-width:2em;padding:0 5px;box-sizing:border-box;outline:none;border-radius:1px;vertical-align:top;color:var(--jse-key-color);cursor:var(--jse-contents-cursor);word-break:normal;overflow-wrap:normal;white-space:pre-wrap}.jse-key.svelte-24a1b2:hover{background:var(--jse-hover-background-color)}.jse-key.svelte-24a1b2:hover{background:var(--jse-hover-background-color)}.jse-key.jse-empty.svelte-24a1b2{min-width:3em;outline:1px dotted var(--jse-tag-background);-moz-outline-radius:2px}.jse-key.jse-empty.svelte-24a1b2::after{pointer-events:none;color:var(--jse-tag-background);content:"key"}');}function BR(e){var t,n,r,i,o,a,s,c=[FR,qR],u=[];function l(e,t){return e[1]?0:1}return n=l(e),r=u[n]=c[n](e),{c:function(){t=$o("div"),r.c(),Ro(t,"data-type","selectable-key"),Ro(t,"class",i=lo(e[6](e[0]))+" svelte-24a1b2");},m:function(r,i){jo(r,t,i),u[n].m(t,null),o=!0,a||(s=Ao(t,"dblclick",e[5]),a=!0);},p:function(e,a){var s=n;(n=l(e))===s?u[n].p(e,a):(Sa(),_a(u[s],1,1,(function(){u[s]=null;})),Ca(),(r=u[n])?r.p(e,a):(r=u[n]=c[n](e)).c(),$a(r,1),r.m(t,null)),(!o||1&a&&i!==(i=lo(e[6](e[0]))+" svelte-24a1b2"))&&Ro(t,"class",i);},i:function(e){o||($a(r),o=!0);},o:function(e){_a(r),o=!1;},d:function(e){e&&So(t),u[n].d(),a=!1,s();}}}function zR(e){var t,n;return t=new Q_({props:{value:e[2].normalization.escapeValue(e[0]),shortText:!0,onChange:e[7],onCancel:e[8],onFind:e[2].onFind}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};5&n&&(r.value=e[2].normalization.escapeValue(e[0])),4&n&&(r.onFind=e[2].onFind),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function qR(e){var t,n=dC(e[2].normalization.escapeValue(e[0]))+"";return {c:function(){t=Oo(n);},m:function(e,n){jo(e,t,n);},p:function(e,r){5&r&&n!==(n=dC(e[2].normalization.escapeValue(e[0]))+"")&&Lo(t,n);},i:Ki,o:Ki,d:function(e){e&&So(t);}}}function FR(e){var t,n;return t=new MO({props:{text:e[2].normalization.escapeValue(e[0]),searchResultItems:e[1]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};5&n&&(r.text=e[2].normalization.escapeValue(e[0])),2&n&&(r.searchResultItems=e[1]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function VR(e){var t,n;return t=new DR({props:{selected:!0,onContextMenu:e[2].onContextMenu}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};4&n&&(r.onContextMenu=e[2].onContextMenu),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function WR(e){var t,n,r,i,o,a=[zR,BR],s=[];function c(e,t){return e[4]?0:1}t=c(e),n=s[t]=a[t](e);var u=!e[2].readOnly&&e[3]&&!e[4]&&VR(e);return {c:function(){n.c(),r=Mo(),u&&u.c(),i=Eo();},m:function(e,n){s[t].m(e,n),jo(e,r,n),u&&u.m(e,n),jo(e,i,n),o=!0;},p:function(e,o){var l=Si(o,1)[0],f=t;(t=c(e))===f?s[t].p(e,l):(Sa(),_a(s[f],1,1,(function(){s[f]=null;})),Ca(),(n=s[t])?n.p(e,l):(n=s[t]=a[t](e)).c(),$a(n,1),n.m(r.parentNode,r)),e[2].readOnly||!e[3]||e[4]?u&&(Sa(),_a(u,1,1,(function(){u=null;})),Ca()):u?(u.p(e,l),28&l&&$a(u,1)):((u=VR(e)).c(),$a(u,1),u.m(i.parentNode,i));},i:function(e){o||($a(n),$a(u),o=!0);},o:function(e){_a(n),_a(u),o=!1;},d:function(e){s[t].d(e),e&&So(r),u&&u.d(e),e&&So(i);}}}function HR(e,t,n){var r,i,o=t.path,a=t.pointer,s=t.key,c=t.selection,u=t.searchResultItems,l=t.onUpdateKey,f=t.context;return e.$$set=function(e){"path"in e&&n(9,o=e.path),"pointer"in e&&n(10,a=e.pointer),"key"in e&&n(0,s=e.key),"selection"in e&&n(11,c=e.selection),"searchResultItems"in e&&n(1,u=e.searchResultItems),"onUpdateKey"in e&&n(12,l=e.onUpdateKey),"context"in e&&n(2,f=e.context);},e.$$.update=function(){3072&e.$$.dirty&&n(3,r=c?!0===c.pointersMap[a]&&v_(c):void 0),2056&e.$$.dirty&&n(4,i=r&&B_(c));},[s,u,f,r,i,function(e){i||f.readOnly||(e.preventDefault(),f.onSelect(P_(o,!0)));},function(e){return H_("jse-key",{"jse-empty":""===e})},function(e,t){var n=l(s,f.normalization.unescapeValue(e)),r=ly(o).concat(n);f.onSelect(t===ks?T_(r,!1):P_(r,!1)),t!==xs&&f.focus();},function(){f.onSelect(P_(o,!1)),f.focus();},o,a,c,l]}var UR=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,HR,WR,no,{path:9,pointer:10,key:0,selection:11,searchResultItems:1,onUpdateKey:12,context:2},LR),r}return qi(n)}();function JR(e,t,n){var r=e.slice();return r[8]=t[n],r}function KR(e){var t,n,r,i=[e[8].props],o=e[8].component;function a(e){for(var t={},n=0;n<i.length;n+=1)t=Qi(t,i[n]);return {props:t}}return o&&(t=Wo(o,a())),{c:function(){t&&Da(t.$$.fragment),n=Eo();},m:function(e,i){t&&La(t,e,i),jo(e,n,i),r=!0;},p:function(e,r){var s=1&r?Ra(i,[Na(e[8].props)]):{};if(1&r&&o!==(o=e[8].component)){if(t){Sa();var c=t;_a(c.$$.fragment,1,0,(function(){Ba(c,1);})),Ca();}o?(Da((t=Wo(o,a())).$$.fragment),$a(t.$$.fragment,1),La(t,n.parentNode,n)):t=null;}else o&&t.$set(s);},i:function(e){r||(t&&$a(t.$$.fragment,e),r=!0);},o:function(e){t&&_a(t.$$.fragment,e),r=!1;},d:function(e){e&&So(n),t&&Ba(t,e);}}}function GR(e){for(var t,n,r=e[0],i=[],o=0;o<r.length;o+=1)i[o]=KR(JR(e,r,o));var a=function(e){return _a(i[e],1,1,(function(){i[e]=null;}))};return {c:function(){for(var e=0;e<i.length;e+=1)i[e].c();t=Eo();},m:function(e,r){for(var o=0;o<i.length;o+=1)i[o]&&i[o].m(e,r);jo(e,t,r),n=!0;},p:function(e,n){var o=Si(n,1)[0];if(1&o){var s;for(r=e[0],s=0;s<r.length;s+=1){var c=JR(e,r,s);i[s]?(i[s].p(c,o),$a(i[s],1)):(i[s]=KR(c),i[s].c(),$a(i[s],1),i[s].m(t.parentNode,t));}for(Sa(),s=r.length;s<i.length;s+=1)a(s);Ca();}},i:function(e){if(!n){for(var t=0;t<r.length;t+=1)$a(i[t]);n=!0;}},o:function(e){i=i.filter(Boolean);for(var t=0;t<i.length;t+=1)_a(i[t]);n=!1;},d:function(e){Co(i,e),e&&So(t);}}}function QR(e,t,n){var r,i,o=t.path,a=t.value,s=t.context,c=t.enforceString,u=t.selection,l=t.searchResultItems;return e.$$set=function(e){"path"in e&&n(1,o=e.path),"value"in e&&n(2,a=e.value),"context"in e&&n(3,s=e.context),"enforceString"in e&&n(4,c=e.enforceString),"selection"in e&&n(5,u=e.selection),"searchResultItems"in e&&n(6,l=e.searchResultItems);},e.$$.update=function(){40&e.$$.dirty&&n(7,r=!s.readOnly&&p_(u)&&B_(u)),254&e.$$.dirty&&n(0,i=s.onRenderValue({path:o,value:a,readOnly:s.readOnly,enforceString:c,isEditing:r,parser:s.parser,normalization:s.normalization,selection:u,searchResultItems:l,onPatch:s.onPatch,onPasteJson:s.onPasteJson,onSelect:s.onSelect,onFind:s.onFind,findNextInside:s.findNextInside,focus:s.focus}));},[i,o,a,s,c,u,l,r]}var YR=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,QR,GR,no,{path:1,value:2,context:3,enforceString:4,selection:5,searchResultItems:6}),r}return qi(n)}(),XR=YR,ZR={selecting:!1,selectionAnchor:null,selectionAnchorType:null,selectionFocus:null,dragging:!1};function eN(e){var t=e.json,n=e.documentState,r=e.deltaY,i=e.items;if(!n.selection)return {operations:void 0,updatedSelection:void 0,offset:0};var o=n.selection,a=r<0?function(e){var t=e.items,n=e.selection,r=e.deltaY,i=y_(n),o=t.findIndex((function(e){return zy(e.path,i)})),a=function(){var e;return null===(e=t[s-1])||void 0===e?void 0:e.height},s=o,c=0;for(;void 0!==a()&&Math.abs(r)>c+a()/2;)c+=a(),s-=1;var u=t[s].path,l=s-o;return s!==o&&void 0!==t[s]?{beforePath:u,offset:l}:void 0}({json:t,selection:o,deltaY:r,items:i}):function(e){var t,n=e.json,r=e.items,i=e.selection,o=e.deltaY,a=b_(i),s=r.findIndex((function(e){return zy(e.path,a)})),c=0,u=s,l=function(){var e;return null===(e=r[u+1])||void 0===e?void 0:e.height};for(;void 0!==l()&&Math.abs(o)>c+l()/2;)c+=l(),u+=1;var f=ly(a),h=Vs(n,f),d=Array.isArray(h),v=null===(t=r[d?u:u+1])||void 0===t?void 0:t.path,p=u-s;return v?{beforePath:v,offset:p}:{append:!0,offset:p}}({json:t,selection:o,deltaY:r,items:i});if(!a||0===a.offset)return {operations:void 0,updatedSelection:void 0,offset:0};var s=function(e,t,n){if(!t)return [];var r="beforePath"in n?n.beforePath:void 0,i="append"in n?n.append:void 0,o=ly(t.focusPath),a=Vs(e,o);if(!(i||r&&E_(r,o)&&r.length>o.length))return [];var s=y_(t),c=b_(t),u=Em(s),l=Em(c),f=r?r[o.length]:void 0;if(!Os(a)){if(_s(a)){var h=uu(u),d=uu(l),v=void 0!==f?uu(f):a.length;return Gk(d-h+1,v<h?function(e){return {op:"move",from:Ys(o.concat(String(h+e))),path:Ys(o.concat(String(v+e)))}}:function(){return {op:"move",from:Ys(o.concat(String(h))),path:Ys(o.concat(String(v)))}})}throw new Error("Cannot create move operations: parent must be an Object or Array")}var p=Object.keys(a),m=p.indexOf(u),g=p.indexOf(l),y=i?p.length:void 0!==f?p.indexOf(f):-1;return -1!==m&&-1!==g&&-1!==y?y>m?[].concat(Vi(p.slice(m,g+1)),Vi(p.slice(y,p.length))).map((function(e){return aO(o,e)})):[].concat(Vi(p.slice(y,m)),Vi(p.slice(g+1,p.length))).map((function(e){return aO(o,e)})):[]}(t,o,a),c=Vs(t,ly(y_(o)));if(Array.isArray(c)){var u=function(e){var t,n,r=e.items,i=e.json,o=e.selection,a=e.offset,s=y_(o),c=b_(o),u=r.findIndex((function(e){return zy(e.path,s)})),l=r.findIndex((function(e){return zy(e.path,c)})),f=null===(t=r[u+a])||void 0===t?void 0:t.path,h=null===(n=r[l+a])||void 0===n?void 0:n.path;return I_(i,f,h)}({items:i,json:t,selection:o,offset:a.offset});return {operations:s,updatedSelection:u,offset:a.offset}}return {operations:s,updatedSelection:void 0,offset:a.offset}}function tN(e,t){return function(e,t){if(e){for(var n={},r=0,i=Object.keys(e);r<i.length;r++){var o=i[r];t(o,e[o])&&(n[o]=e[o]);}return Object.keys(n).length>0?n:void 0}}(e,(function(e){return ec(e,t)}))}function nN(e){bo(e,"svelte-pz3g1j","button.jse-validation-error.svelte-pz3g1j{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;padding:0;margin:0;vertical-align:top;display:inline-flex;color:var(--jse-warning-color)}");}function rN(e){var t,n,r,i,o,a;return n=new x$({props:{data:MM}}),{c:function(){t=$o("button"),Da(n.$$.fragment),Ro(t,"type","button"),Ro(t,"class","jse-validation-error svelte-pz3g1j");},m:function(s,c){jo(s,t,c),La(n,t,null),i=!0,o||(a=[Ao(t,"click",(function(){eo(e[0])&&e[0].apply(this,arguments);})),fo(r=zO.call(null,t,Oi({text:e[1]},e[2])))],o=!0);},p:function(t,n){var i=Si(n,1)[0];e=t,r&&eo(r.update)&&2&i&&r.update.call(null,Oi({text:e[1]},e[2]));},i:function(e){i||($a(n.$$.fragment,e),i=!0);},o:function(e){_a(n.$$.fragment,e),i=!1;},d:function(e){e&&So(t),Ba(n),o=!1,Zi(a);}}}function iN(e,t,n){var r,i=ia("absolute-popup"),o=t.validationError,a=t.onExpand;return e.$$set=function(e){"validationError"in e&&n(3,o=e.validationError),"onExpand"in e&&n(0,a=e.onExpand);},e.$$.update=function(){8&e.$$.dirty&&n(1,r=o.isChildError?"Contains invalid data":o.message);},[a,r,i,o]}var oN=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,iN,rN,to,{validationError:3,onExpand:0},nN),r}return qi(n)}();function aN(e){bo(e,"svelte-1wlxti1",".jse-json-node.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{position:relative;color:var(--jse-text-color)}.jse-json-node.jse-root.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{min-height:100%;padding-bottom:2px;box-sizing:border-box}.jse-json-node.jse-root.svelte-1wlxti1>.jse-header-outer.svelte-1wlxti1 .jse-context-menu-pointer,.jse-json-node.jse-root.svelte-1wlxti1>.jse-contents-outer.svelte-1wlxti1>.jse-contents.svelte-1wlxti1 .jse-context-menu-pointer{top:0;right:calc(-2px - var(--jse-context-menu-pointer-size))}.jse-json-node.jse-root.svelte-1wlxti1>.jse-contents-outer.svelte-1wlxti1>.jse-contents.svelte-1wlxti1.svelte-1wlxti1{padding-left:0}.jse-json-node.svelte-1wlxti1 .jse-props.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.svelte-1wlxti1 .jse-items.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{position:relative}.jse-json-node.svelte-1wlxti1 .jse-header-outer.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.svelte-1wlxti1 .jse-footer-outer.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{display:flex}.jse-json-node.svelte-1wlxti1 .jse-header.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{position:relative}.jse-json-node.svelte-1wlxti1 .jse-header .jse-meta.svelte-1wlxti1>.jse-meta-inner.svelte-1wlxti1.svelte-1wlxti1{display:flex;justify-content:center}.jse-json-node.svelte-1wlxti1 .jse-contents-outer.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{display:flex}.jse-json-node.svelte-1wlxti1 .jse-header.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.svelte-1wlxti1 .jse-contents.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{display:flex;flex-direction:row;align-items:start}.jse-json-node.svelte-1wlxti1 .jse-contents.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{padding-left:var(--jse-indent-size)}.jse-json-node.svelte-1wlxti1 .jse-footer.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{display:inline-flex;padding-left:calc(var(--jse-indent-size) + 5px)}.jse-json-node.svelte-1wlxti1 .jse-header.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.svelte-1wlxti1 .jse-contents.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.svelte-1wlxti1 .jse-footer.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{background:var(--jse-contents-background-color)}.jse-json-node.svelte-1wlxti1 .jse-insert-selection-area.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{visibility:hidden;padding:0 calc(0.5 * var(--jse-padding));flex:1}.jse-json-node.svelte-1wlxti1 .jse-insert-selection-area.jse-inside.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{display:inline-flex;align-items:center}.jse-json-node.svelte-1wlxti1 .jse-insert-selection-area.jse-after.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{display:flex;align-items:flex-end}.jse-json-node.svelte-1wlxti1 .jse-context-menu-pointer-anchor.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{position:relative}.jse-json-node.svelte-1wlxti1 .jse-insert-area.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{display:flex;position:relative;z-index:1;max-width:250px;min-width:100px;height:0;margin-right:calc(0.5 * var(--jse-padding));outline:1px solid}.jse-json-node.svelte-1wlxti1 .jse-insert-area.svelte-1wlxti1 .jse-context-menu-pointer{right:-1px;background:var(--jse-context-menu-pointer-hover-background)}.jse-json-node.svelte-1wlxti1 .jse-insert-area.jse-hovered.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{outline-color:var(--jse-context-menu-pointer-hover-background)}.jse-json-node.svelte-1wlxti1:hover>.jse-contents-outer .jse-insert-selection-area.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1:not(.jse-selected),.jse-json-node.svelte-1wlxti1 .jse-header-outer.svelte-1wlxti1:hover>.jse-insert-selection-area.svelte-1wlxti1.svelte-1wlxti1:not(.jse-selected),.jse-json-node.svelte-1wlxti1 .jse-footer-outer:hover .jse-insert-selection-area.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1:not(.jse-selected){visibility:visible}.jse-json-node.jse-hovered.svelte-1wlxti1>.jse-header-outer.svelte-1wlxti1>.jse-header.svelte-1wlxti1>.jse-meta.svelte-1wlxti1,.jse-json-node.jse-hovered.svelte-1wlxti1 .jse-props .jse-header.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-hovered.svelte-1wlxti1 .jse-items .jse-header.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-hovered.svelte-1wlxti1 .jse-props .jse-contents.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-hovered.svelte-1wlxti1 .jse-items .jse-contents.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-hovered.svelte-1wlxti1 .jse-footer.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{background:var(--jse-hover-background-color)}.jse-json-node.jse-selected.svelte-1wlxti1>.jse-header-outer.svelte-1wlxti1>.jse-header.svelte-1wlxti1>.jse-meta.svelte-1wlxti1,.jse-json-node.jse-selected.svelte-1wlxti1 .jse-props .jse-header.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-selected.svelte-1wlxti1 .jse-items .jse-header.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-selected.svelte-1wlxti1 .jse-props .jse-contents.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-selected.svelte-1wlxti1 .jse-items .jse-contents.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-selected.svelte-1wlxti1 .jse-header.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-selected.svelte-1wlxti1 .jse-contents.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-selected.svelte-1wlxti1 .jse-footer.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-selected.svelte-1wlxti1 .jse-key,.jse-json-node.jse-selected.svelte-1wlxti1 .jse-value{background:var(--jse-selection-background-color);cursor:var(--jse-contents-selected-cursor)}.jse-json-node.jse-selected.svelte-1wlxti1 .jse-expand.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{background:var(--jse-selection-background-color)}.jse-json-node.jse-selected-key.svelte-1wlxti1>.jse-contents-outer.svelte-1wlxti1>.jse-contents.svelte-1wlxti1>.jse-identifier>.jse-key,.jse-json-node.jse-selected-key.svelte-1wlxti1>.jse-header-outer.svelte-1wlxti1>.jse-header.svelte-1wlxti1>.jse-identifier>.jse-key{background:var(--jse-selection-background-color);cursor:var(--jse-contents-selected-cursor)}.jse-json-node.jse-selected-value.svelte-1wlxti1>.jse-contents-outer.svelte-1wlxti1>.jse-contents.svelte-1wlxti1>.jse-value{background:var(--jse-selection-background-color);cursor:var(--jse-contents-selected-cursor)}.jse-json-node.svelte-1wlxti1 .jse-collapsed-items.jse-selected,.jse-json-node.jse-selected.svelte-1wlxti1 .jse-collapsed-items,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-collapsed-items{background-color:var(--jse-selection-background-color);--jse-collapsed-items-background-color:var(--jse-collapsed-items-selected-background-color)}.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-meta.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-selected-value.svelte-1wlxti1>.jse-header-outer.svelte-1wlxti1>.jse-header.svelte-1wlxti1>.jse-meta.svelte-1wlxti1,.jse-json-node.jse-selected-value.svelte-1wlxti1>.jse-footer-outer.svelte-1wlxti1>.jse-footer.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-props .jse-contents.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-props .jse-header.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-props .jse-footer.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-props .jse-expand.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-items .jse-contents.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-items .jse-header.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-items .jse-footer.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-items .jse-expand.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{background:var(--jse-selection-background-color)}.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-meta.svelte-1wlxti1 .jse-key,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-meta.svelte-1wlxti1 .jse-value,.jse-json-node.jse-selected-value.svelte-1wlxti1>.jse-header-outer.svelte-1wlxti1>.jse-header.svelte-1wlxti1>.jse-meta.svelte-1wlxti1 .jse-key,.jse-json-node.jse-selected-value.svelte-1wlxti1>.jse-header-outer.svelte-1wlxti1>.jse-header.svelte-1wlxti1>.jse-meta.svelte-1wlxti1 .jse-value,.jse-json-node.jse-selected-value.svelte-1wlxti1>.jse-footer-outer.svelte-1wlxti1>.jse-footer.svelte-1wlxti1 .jse-key,.jse-json-node.jse-selected-value.svelte-1wlxti1>.jse-footer-outer.svelte-1wlxti1>.jse-footer.svelte-1wlxti1 .jse-value,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-props .jse-contents.svelte-1wlxti1 .jse-key,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-props .jse-contents.svelte-1wlxti1 .jse-value,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-props .jse-header.svelte-1wlxti1 .jse-key,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-props .jse-header.svelte-1wlxti1 .jse-value,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-props .jse-footer.svelte-1wlxti1 .jse-key,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-props .jse-footer.svelte-1wlxti1 .jse-value,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-props .jse-expand.svelte-1wlxti1 .jse-key,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-props .jse-expand.svelte-1wlxti1 .jse-value,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-items .jse-contents.svelte-1wlxti1 .jse-key,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-items .jse-contents.svelte-1wlxti1 .jse-value,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-items .jse-header.svelte-1wlxti1 .jse-key,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-items .jse-header.svelte-1wlxti1 .jse-value,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-items .jse-footer.svelte-1wlxti1 .jse-key,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-items .jse-footer.svelte-1wlxti1 .jse-value,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-items .jse-expand.svelte-1wlxti1 .jse-key,.jse-json-node.jse-selected-value.svelte-1wlxti1 .jse-items .jse-expand.svelte-1wlxti1 .jse-value{background:var(--jse-selection-background-color);cursor:var(--jse-contents-selected-cursor)}.jse-json-node.jse-readonly.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{--jse-contents-selected-cursor:pointer}.jse-json-node.svelte-1wlxti1 .jse-insert-area.jse-selected.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{outline-color:var(--jse-context-menu-pointer-background)}.jse-json-node.svelte-1wlxti1 .jse-insert-area.jse-selected.svelte-1wlxti1 .jse-context-menu-pointer{background:var(--jse-context-menu-pointer-background)}.jse-json-node.svelte-1wlxti1 .jse-insert-area.jse-selected.svelte-1wlxti1 .jse-context-menu-pointer:hover{background:var(--jse-context-menu-pointer-background-highlight)}.jse-main:not(.jse-focus) .jse-json-node.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{--jse-selection-background-color:var(--jse-selection-background-inactive-color);--jse-context-menu-pointer-background:var(--jse-context-menu-pointer-hover-background)}.jse-expand.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{width:var(--jse-indent-size);padding:0;margin:0;border:none;cursor:pointer;background:transparent;color:var(--jse-delimiter-color);font-size:var(--jse-font-size-mono);height:var(--jse-line-height)}.jse-expand.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1:hover{opacity:0.8}.jse-meta.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-separator.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-index.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1,.jse-bracket.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{vertical-align:top;color:var(--jse-delimiter-color)}.jse-index.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{padding:0 calc(0.5 * var(--jse-padding))}.jse-bracket.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{padding:0 2px}.jse-bracket.jse-expanded.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{padding-right:var(--jse-padding)}.jse-tag.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{border:none;font-size:80%;font-family:var(--jse-font-family);color:var(--jse-tag-color);background:var(--jse-tag-background);border-radius:2px;cursor:pointer;display:inline-block;padding:0 4px;line-height:normal;margin:1px 0}.jse-tag.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1:hover{opacity:0.8}.jse-tag.jse-expanded.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{opacity:0.7;cursor:inherit}.jse-identifier.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1.svelte-1wlxti1{vertical-align:top;position:relative}");}var sN=function(e){return {}},cN=function(e){return {}};function uN(e,t,n){var r=e.slice();return r[53]=t[n],r}var lN=function(e){return {}},fN=function(e){return {}};function hN(e,t,n){var r=e.slice();return r[47]=t[n],r[49]=n,r}function dN(e,t,n){var r=e.slice();return r[50]=t[n],r}var vN=function(e){return {}},pN=function(e){return {}};function mN(e){var t,n,r,i,o,a,s,c,u,l=!e[8].readOnly&&e[16]&&e[7]&&(p_(e[7])||m_(e[7]))&&!e[7].edit&&zy(e[7].focusPath,e[1]),f=e[34].identifier,h=ro(f,e,e[35],cN),d=!e[17]&&bN();o=new XR({props:{path:e[1],value:e[0],enforceString:e[13],selection:e[16]?e[7]:void 0,searchResultItems:xO(e[6],e[9]),context:e[8]}});var v=l&&wN(e),p=e[15]&&xN(e),m=!e[17]&&kN(e);return {c:function(){t=$o("div"),n=$o("div"),h&&h.c(),r=Mo(),d&&d.c(),i=Mo(),Da(o.$$.fragment),a=Mo(),v&&v.c(),s=Mo(),p&&p.c(),c=Mo(),m&&m.c(),Ro(n,"class","jse-contents svelte-1wlxti1"),Ro(t,"class","jse-contents-outer svelte-1wlxti1"),Ro(t,"style",e[18]);},m:function(e,l){jo(e,t,l),yo(t,n),h&&h.m(n,null),yo(n,r),d&&d.m(n,null),yo(n,i),La(o,n,null),yo(n,a),v&&v.m(n,null),yo(t,s),p&&p.m(t,null),yo(t,c),m&&m.m(t,null),u=!0;},p:function(e,r){h&&h.p&&(!u||16&r[1])&&ao(h,f,e,e[35],u?oo(f,e[35],r,sN):so(e[35]),cN),e[17]?d&&(d.d(1),d=null):d||((d=bN()).c(),d.m(n,i));var a={};2&r[0]&&(a.path=e[1]),1&r[0]&&(a.value=e[0]),8192&r[0]&&(a.enforceString=e[13]),65664&r[0]&&(a.selection=e[16]?e[7]:void 0),576&r[0]&&(a.searchResultItems=xO(e[6],e[9])),256&r[0]&&(a.context=e[8]),o.$set(a),65922&r[0]&&(l=!e[8].readOnly&&e[16]&&e[7]&&(p_(e[7])||m_(e[7]))&&!e[7].edit&&zy(e[7].focusPath,e[1])),l?v?(v.p(e,r),65922&r[0]&&$a(v,1)):((v=wN(e)).c(),$a(v,1),v.m(n,null)):v&&(Sa(),_a(v,1,1,(function(){v=null;})),Ca()),e[15]?p?(p.p(e,r),32768&r[0]&&$a(p,1)):((p=xN(e)).c(),$a(p,1),p.m(t,c)):p&&(Sa(),_a(p,1,1,(function(){p=null;})),Ca()),e[17]?m&&(m.d(1),m=null):m?m.p(e,r):((m=kN(e)).c(),m.m(t,null)),(!u||262144&r[0])&&Ro(t,"style",e[18]);},i:function(e){u||($a(h,e),$a(o.$$.fragment,e),$a(v),$a(p),u=!0);},o:function(e){_a(h,e),_a(o.$$.fragment,e),_a(v),_a(p),u=!1;},d:function(e){e&&So(t),h&&h.d(e),d&&d.d(),Ba(o),v&&v.d(),p&&p.d(),m&&m.d();}}}function gN(e){var t,n,r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b=!e[8].readOnly&&e[16]&&e[7]&&(p_(e[7])||m_(e[7]))&&!e[7].edit&&zy(e[7].focusPath,e[1]),w=[SN,jN],x=[];function k(e,t){return e[12]?0:1}i=k(e),o=x[i]=w[i](e);var j=e[34].identifier,S=ro(j,e,e[35],fN),C=!e[17]&&CN();function $(e,t){return e[12]?_N:$N}var _=$(e),O=_(e),M=b&&ON(e),E=e[15]&&(!e[12]||!e[15].isChildError)&&MN(e);function A(e,t){return e[12]?AN:e[17]?void 0:EN}var P=A(e),T=P&&P(e),R=e[12]&&PN(e);return {c:function(){t=$o("div"),n=$o("div"),r=$o("button"),o.c(),a=Mo(),S&&S.c(),s=Mo(),C&&C.c(),c=Mo(),u=$o("div"),l=$o("div"),O.c(),f=Mo(),M&&M.c(),h=Mo(),E&&E.c(),d=Mo(),T&&T.c(),v=Mo(),R&&R.c(),p=Eo(),Ro(r,"type","button"),Ro(r,"class","jse-expand svelte-1wlxti1"),Ro(r,"title","Expand or collapse this object (Ctrl+Click to expand/collapse recursively)"),Ro(l,"class","jse-meta-inner svelte-1wlxti1"),Ro(u,"class","jse-meta svelte-1wlxti1"),Ro(u,"data-type","selectable-value"),Ro(n,"class","jse-header svelte-1wlxti1"),Ro(t,"class","jse-header-outer svelte-1wlxti1"),Ro(t,"style",e[18]);},m:function(o,b){jo(o,t,b),yo(t,n),yo(n,r),x[i].m(r,null),yo(n,a),S&&S.m(n,null),yo(n,s),C&&C.m(n,null),yo(n,c),yo(n,u),yo(u,l),O.m(l,null),yo(n,f),M&&M.m(n,null),yo(t,h),E&&E.m(t,null),yo(t,d),T&&T.m(t,null),jo(o,v,b),R&&R.m(o,b),jo(o,p,b),m=!0,g||(y=Ao(r,"click",e[21]),g=!0);},p:function(e,a){var s=i;(i=k(e))===s?x[i].p(e,a):(Sa(),_a(x[s],1,1,(function(){x[s]=null;})),Ca(),(o=x[i])?o.p(e,a):(o=x[i]=w[i](e)).c(),$a(o,1),o.m(r,null)),S&&S.p&&(!m||16&a[1])&&ao(S,j,e,e[35],m?oo(j,e[35],a,lN):so(e[35]),fN),e[17]?C&&(C.d(1),C=null):C||((C=CN()).c(),C.m(n,c)),_===(_=$(e))&&O?O.p(e,a):(O.d(1),(O=_(e))&&(O.c(),O.m(l,null))),65922&a[0]&&(b=!e[8].readOnly&&e[16]&&e[7]&&(p_(e[7])||m_(e[7]))&&!e[7].edit&&zy(e[7].focusPath,e[1])),b?M?(M.p(e,a),65922&a[0]&&$a(M,1)):((M=ON(e)).c(),$a(M,1),M.m(n,null)):M&&(Sa(),_a(M,1,1,(function(){M=null;})),Ca()),!e[15]||e[12]&&e[15].isChildError?E&&(Sa(),_a(E,1,1,(function(){E=null;})),Ca()):E?(E.p(e,a),36864&a[0]&&$a(E,1)):((E=MN(e)).c(),$a(E,1),E.m(t,d)),P===(P=A(e))&&T?T.p(e,a):(T&&T.d(1),(T=P&&P(e))&&(T.c(),T.m(t,null))),(!m||262144&a[0])&&Ro(t,"style",e[18]),e[12]?R?(R.p(e,a),4096&a[0]&&$a(R,1)):((R=PN(e)).c(),$a(R,1),R.m(p.parentNode,p)):R&&(Sa(),_a(R,1,1,(function(){R=null;})),Ca());},i:function(e){m||($a(o),$a(S,e),$a(M),$a(E),$a(R),m=!0);},o:function(e){_a(o),_a(S,e),_a(M),_a(E),_a(R),m=!1;},d:function(e){e&&So(t),x[i].d(),S&&S.d(e),C&&C.d(),O.d(),M&&M.d(),E&&E.d(),T&&T.d(),e&&So(v),R&&R.d(e),e&&So(p),g=!1,y();}}}function yN(e){var t,n,r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b=!e[8].readOnly&&e[16]&&e[7]&&(p_(e[7])||m_(e[7]))&&!e[7].edit&&zy(e[7].focusPath,e[1]),w=[LN,DN],x=[];function k(e,t){return e[12]?0:1}i=k(e),o=x[i]=w[i](e);var j=e[34].identifier,S=ro(j,e,e[35],pN),C=!e[17]&&BN();function $(e,t){return e[12]?qN:zN}var _=$(e),O=_(e),M=b&&FN(e),E=e[15]&&(!e[12]||!e[15].isChildError)&&VN(e);function A(e,t){return e[12]?HN:WN}var P=A(e),T=P(e),R=e[12]&&UN(e);return {c:function(){t=$o("div"),n=$o("div"),r=$o("button"),o.c(),a=Mo(),S&&S.c(),s=Mo(),C&&C.c(),c=Mo(),u=$o("div"),l=$o("div"),O.c(),f=Mo(),M&&M.c(),h=Mo(),E&&E.c(),d=Mo(),T.c(),v=Mo(),R&&R.c(),p=Eo(),Ro(r,"type","button"),Ro(r,"class","jse-expand svelte-1wlxti1"),Ro(r,"title","Expand or collapse this array (Ctrl+Click to expand/collapse recursively)"),Ro(l,"class","jse-meta-inner svelte-1wlxti1"),Ro(l,"data-type","selectable-value"),Ro(u,"class","jse-meta svelte-1wlxti1"),Ro(n,"class","jse-header svelte-1wlxti1"),Ro(t,"class","jse-header-outer svelte-1wlxti1"),Ro(t,"style",e[18]);},m:function(o,b){jo(o,t,b),yo(t,n),yo(n,r),x[i].m(r,null),yo(n,a),S&&S.m(n,null),yo(n,s),C&&C.m(n,null),yo(n,c),yo(n,u),yo(u,l),O.m(l,null),yo(n,f),M&&M.m(n,null),yo(t,h),E&&E.m(t,null),yo(t,d),T.m(t,null),jo(o,v,b),R&&R.m(o,b),jo(o,p,b),m=!0,g||(y=Ao(r,"click",e[21]),g=!0);},p:function(e,a){var s=i;(i=k(e))===s?x[i].p(e,a):(Sa(),_a(x[s],1,1,(function(){x[s]=null;})),Ca(),(o=x[i])?o.p(e,a):(o=x[i]=w[i](e)).c(),$a(o,1),o.m(r,null)),S&&S.p&&(!m||16&a[1])&&ao(S,j,e,e[35],m?oo(j,e[35],a,vN):so(e[35]),pN),e[17]?C&&(C.d(1),C=null):C||((C=BN()).c(),C.m(n,c)),_===(_=$(e))&&O?O.p(e,a):(O.d(1),(O=_(e))&&(O.c(),O.m(l,null))),65922&a[0]&&(b=!e[8].readOnly&&e[16]&&e[7]&&(p_(e[7])||m_(e[7]))&&!e[7].edit&&zy(e[7].focusPath,e[1])),b?M?(M.p(e,a),65922&a[0]&&$a(M,1)):((M=FN(e)).c(),$a(M,1),M.m(n,null)):M&&(Sa(),_a(M,1,1,(function(){M=null;})),Ca()),!e[15]||e[12]&&e[15].isChildError?E&&(Sa(),_a(E,1,1,(function(){E=null;})),Ca()):E?(E.p(e,a),36864&a[0]&&$a(E,1)):((E=VN(e)).c(),$a(E,1),E.m(t,d)),P===(P=A(e))&&T?T.p(e,a):(T.d(1),(T=P(e))&&(T.c(),T.m(t,null))),(!m||262144&a[0])&&Ro(t,"style",e[18]),e[12]?R?(R.p(e,a),4096&a[0]&&$a(R,1)):((R=UN(e)).c(),$a(R,1),R.m(p.parentNode,p)):R&&(Sa(),_a(R,1,1,(function(){R=null;})),Ca());},i:function(e){m||($a(o),$a(S,e),$a(M),$a(E),$a(R),m=!0);},o:function(e){_a(o),_a(S,e),_a(M),_a(E),_a(R),m=!1;},d:function(e){e&&So(t),x[i].d(),S&&S.d(e),C&&C.d(),O.d(),M&&M.d(),E&&E.d(),T.d(),e&&So(v),R&&R.d(e),e&&So(p),g=!1,y();}}}function bN(e){var t;return {c:function(){(t=$o("div")).textContent=":",Ro(t,"class","jse-separator svelte-1wlxti1");},m:function(e,n){jo(e,t,n);},d:function(e){e&&So(t);}}}function wN(e){var t,n,r;return n=new DR({props:{selected:!0,onContextMenu:e[8].onContextMenu}}),{c:function(){t=$o("div"),Da(n.$$.fragment),Ro(t,"class","jse-context-menu-pointer-anchor svelte-1wlxti1");},m:function(e,i){jo(e,t,i),La(n,t,null),r=!0;},p:function(e,t){var r={};256&t[0]&&(r.onContextMenu=e[8].onContextMenu),n.$set(r);},i:function(e){r||($a(n.$$.fragment,e),r=!0);},o:function(e){_a(n.$$.fragment,e),r=!1;},d:function(e){e&&So(t),Ba(n);}}}function xN(e){var t,n;return t=new oN({props:{validationError:e[15],onExpand:e[22]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};32768&n[0]&&(r.validationError=e[15]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function kN(e){var t,n,r;return {c:function(){Ro(t=$o("div"),"class","jse-insert-selection-area jse-after svelte-1wlxti1"),Ro(t,"data-type","insert-selection-area-after");},m:function(i,o){jo(i,t,o),n||(r=Ao(t,"click",e[30]),n=!0);},p:Ki,d:function(e){e&&So(t),n=!1,r();}}}function jN(e){var t,n;return t=new x$({props:{data:JO}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:Ki,i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function SN(e){var t,n;return t=new x$({props:{data:dM}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:Ki,i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function CN(e){var t;return {c:function(){(t=$o("div")).textContent=":",Ro(t,"class","jse-separator svelte-1wlxti1");},m:function(e,n){jo(e,t,n);},d:function(e){e&&So(t);}}}function $N(e){var t,n,r,i,o,a,s,c,u,l,f=Object.keys(e[0]).length+"",h=1===Object.keys(e[0]).length?"prop":"props";return {c:function(){(t=$o("div")).textContent="{",n=Mo(),r=$o("button"),i=Oo(f),o=Mo(),a=Oo(h),s=Mo(),(c=$o("div")).textContent="}",Ro(t,"class","jse-bracket svelte-1wlxti1"),Ro(r,"type","button"),Ro(r,"class","jse-tag svelte-1wlxti1"),Ro(c,"class","jse-bracket svelte-1wlxti1");},m:function(f,h){jo(f,t,h),jo(f,n,h),jo(f,r,h),yo(r,i),yo(r,o),yo(r,a),jo(f,s,h),jo(f,c,h),u||(l=Ao(r,"click",e[22]),u=!0);},p:function(e,t){1&t[0]&&f!==(f=Object.keys(e[0]).length+"")&&Lo(i,f),1&t[0]&&h!==(h=1===Object.keys(e[0]).length?"prop":"props")&&Lo(a,h);},d:function(e){e&&So(t),e&&So(n),e&&So(r),e&&So(s),e&&So(c),u=!1,l();}}}function _N(e){var t;return {c:function(){(t=$o("div")).textContent="{",Ro(t,"class","jse-bracket jse-expanded svelte-1wlxti1");},m:function(e,n){jo(e,t,n);},p:Ki,d:function(e){e&&So(t);}}}function ON(e){var t,n,r;return n=new DR({props:{selected:!0,onContextMenu:e[8].onContextMenu}}),{c:function(){t=$o("div"),Da(n.$$.fragment),Ro(t,"class","jse-context-menu-pointer-anchor svelte-1wlxti1");},m:function(e,i){jo(e,t,i),La(n,t,null),r=!0;},p:function(e,t){var r={};256&t[0]&&(r.onContextMenu=e[8].onContextMenu),n.$set(r);},i:function(e){r||($a(n.$$.fragment,e),r=!0);},o:function(e){_a(n.$$.fragment,e),r=!1;},d:function(e){e&&So(t),Ba(n);}}}function MN(e){var t,n;return t=new oN({props:{validationError:e[15],onExpand:e[22]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};32768&n[0]&&(r.validationError=e[15]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function EN(e){var t,n,r;return {c:function(){Ro(t=$o("div"),"class","jse-insert-selection-area jse-after svelte-1wlxti1"),Ro(t,"data-type","insert-selection-area-after");},m:function(i,o){jo(i,t,o),n||(r=Ao(t,"click",e[30]),n=!0);},p:Ki,d:function(e){e&&So(t),n=!1,r();}}}function AN(e){var t,n,r;return {c:function(){Ro(t=$o("div"),"class","jse-insert-selection-area jse-inside svelte-1wlxti1"),Ro(t,"data-type","insert-selection-area-inside");},m:function(i,o){jo(i,t,o),n||(r=Ao(t,"click",e[29]),n=!0);},p:Ki,d:function(e){e&&So(t),n=!1,r();}}}function PN(e){for(var t,n,r,i,o,a,s,c=!e[8].readOnly&&("hover-insert-inside"===e[10]||e[16]&&d_(e[7])),u=c&&TN(e),l=e[19](e[1],e[0],e[2],e[3],e[4],e[5],e[6],e[7],e[11]),f=[],h=0;h<l.length;h+=1)f[h]=NN(uN(e,l,h));var d=function(e){return _a(f[e],1,1,(function(){f[e]=null;}))},v=!e[17]&&IN(e);return {c:function(){t=$o("div"),u&&u.c(),n=Mo();for(var s=0;s<f.length;s+=1)f[s].c();r=Mo(),i=$o("div"),(o=$o("div")).innerHTML='<div class="jse-bracket svelte-1wlxti1">}</div>',a=Mo(),v&&v.c(),Ro(t,"class","jse-props svelte-1wlxti1"),Ro(o,"data-type","selectable-value"),Ro(o,"class","jse-footer svelte-1wlxti1"),Ro(i,"class","jse-footer-outer svelte-1wlxti1"),Ro(i,"style",e[18]);},m:function(e,c){jo(e,t,c),u&&u.m(t,null),yo(t,n);for(var l=0;l<f.length;l+=1)f[l]&&f[l].m(t,null);jo(e,r,c),jo(e,i,c),yo(i,o),yo(i,a),v&&v.m(i,null),s=!0;},p:function(e,r){if(66944&r[0]&&(c=!e[8].readOnly&&("hover-insert-inside"===e[10]||e[16]&&d_(e[7]))),c?u?(u.p(e,r),66944&r[0]&&$a(u,1)):((u=TN(e)).c(),$a(u,1),u.m(t,n)):u&&(Sa(),_a(u,1,1,(function(){u=null;})),Ca()),76024319&r[0]){var o;for(l=e[19](e[1],e[0],e[2],e[3],e[4],e[5],e[6],e[7],e[11]),o=0;o<l.length;o+=1){var a=uN(e,l,o);f[o]?(f[o].p(a,r),$a(f[o],1)):(f[o]=NN(a),f[o].c(),$a(f[o],1),f[o].m(t,null));}for(Sa(),o=l.length;o<f.length;o+=1)d(o);Ca();}e[17]?v&&(v.d(1),v=null):v?v.p(e,r):((v=IN(e)).c(),v.m(i,null)),(!s||262144&r[0])&&Ro(i,"style",e[18]);},i:function(e){if(!s){$a(u);for(var t=0;t<l.length;t+=1)$a(f[t]);s=!0;}},o:function(e){_a(u),f=f.filter(Boolean);for(var t=0;t<f.length;t+=1)_a(f[t]);s=!1;},d:function(e){e&&So(t),u&&u.d(),Co(f,e),e&&So(r),e&&So(i),v&&v.d();}}}function TN(e){var t,n,r,i;return n=new DR({props:{selected:e[16]&&d_(e[7]),onContextMenu:e[31]}}),{c:function(){t=$o("div"),Da(n.$$.fragment),Ro(t,"class","jse-insert-area jse-inside svelte-1wlxti1"),Ro(t,"data-type","insert-selection-area-inside"),Ro(t,"style",r=tI(e[1].length+1)),Ro(t,"title",ys),Fo(t,"jse-hovered","hover-insert-inside"===e[10]),Fo(t,"jse-selected",e[16]&&d_(e[7]));},m:function(e,r){jo(e,t,r),La(n,t,null),i=!0;},p:function(e,o){var a={};65664&o[0]&&(a.selected=e[16]&&d_(e[7])),n.$set(a),(!i||2&o[0]&&r!==(r=tI(e[1].length+1)))&&Ro(t,"style",r),(!i||1024&o[0])&&Fo(t,"jse-hovered","hover-insert-inside"===e[10]),(!i||65664&o[0])&&Fo(t,"jse-selected",e[16]&&d_(e[7]));},i:function(e){i||($a(n.$$.fragment,e),i=!0);},o:function(e){_a(n.$$.fragment,e),i=!1;},d:function(e){e&&So(t),Ba(n);}}}function RN(e){var t,n,r,i;return n=new UR({props:{path:e[53].path,pointer:e[53].pointer,key:e[53].key,selection:e[53].selection,searchResultItems:e[53].keySearchResultItemsMap,context:e[8],onUpdateKey:e[23]}}),{c:function(){t=$o("div"),Da(n.$$.fragment),r=Mo(),Ro(t,"slot","identifier"),Ro(t,"class","jse-identifier svelte-1wlxti1");},m:function(e,o){jo(e,t,o),La(n,t,null),yo(t,r),i=!0;},p:function(e,t){var r={};2303&t[0]&&(r.path=e[53].path),2303&t[0]&&(r.pointer=e[53].pointer),2303&t[0]&&(r.key=e[53].key),2303&t[0]&&(r.selection=e[53].selection),2303&t[0]&&(r.searchResultItems=e[53].keySearchResultItemsMap),256&t[0]&&(r.context=e[8]),n.$set(r);},i:function(e){i||($a(n.$$.fragment,e),i=!0);},o:function(e){_a(n.$$.fragment,e),i=!1;},d:function(e){e&&So(t),Ba(n);}}}function NN(e){var t,n;return t=new rI({props:{value:e[53].value,path:e[53].path,expandedMap:e[53].expandedMap,enforceStringMap:e[53].enforceStringMap,visibleSectionsMap:e[53].visibleSectionsMap,validationErrorsMap:e[53].validationErrorsMap,searchResultItemsMap:e[53].valueSearchResultItemsMap,selection:e[53].selection,context:e[8],onDragSelectionStart:e[26],$$slots:{identifier:[RN]},$$scope:{ctx:e}}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};2303&n[0]&&(r.value=e[53].value),2303&n[0]&&(r.path=e[53].path),2303&n[0]&&(r.expandedMap=e[53].expandedMap),2303&n[0]&&(r.enforceStringMap=e[53].enforceStringMap),2303&n[0]&&(r.visibleSectionsMap=e[53].visibleSectionsMap),2303&n[0]&&(r.validationErrorsMap=e[53].validationErrorsMap),2303&n[0]&&(r.searchResultItemsMap=e[53].valueSearchResultItemsMap),2303&n[0]&&(r.selection=e[53].selection),256&n[0]&&(r.context=e[8]),2559&n[0]|16&n[1]&&(r.$$scope={dirty:n,ctx:e}),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function IN(e){var t,n,r;return {c:function(){Ro(t=$o("div"),"class","jse-insert-selection-area jse-after svelte-1wlxti1"),Ro(t,"data-type","insert-selection-area-after");},m:function(i,o){jo(i,t,o),n||(r=Ao(t,"click",e[30]),n=!0);},p:Ki,d:function(e){e&&So(t),n=!1,r();}}}function DN(e){var t,n;return t=new x$({props:{data:JO}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:Ki,i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function LN(e){var t,n;return t=new x$({props:{data:dM}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:Ki,i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function BN(e){var t;return {c:function(){(t=$o("div")).textContent=":",Ro(t,"class","jse-separator svelte-1wlxti1");},m:function(e,n){jo(e,t,n);},d:function(e){e&&So(t);}}}function zN(e){var t,n,r,i,o,a,s,c,u,l,f=e[0].length+"",h=1===e[0].length?"item":"items";return {c:function(){(t=$o("div")).textContent="[",n=Mo(),r=$o("button"),i=Oo(f),o=Mo(),a=Oo(h),s=Mo(),(c=$o("div")).textContent="]",Ro(t,"class","jse-bracket svelte-1wlxti1"),Ro(r,"type","button"),Ro(r,"class","jse-tag svelte-1wlxti1"),Ro(c,"class","jse-bracket svelte-1wlxti1");},m:function(f,h){jo(f,t,h),jo(f,n,h),jo(f,r,h),yo(r,i),yo(r,o),yo(r,a),jo(f,s,h),jo(f,c,h),u||(l=Ao(r,"click",e[22]),u=!0);},p:function(e,t){1&t[0]&&f!==(f=e[0].length+"")&&Lo(i,f),1&t[0]&&h!==(h=1===e[0].length?"item":"items")&&Lo(a,h);},d:function(e){e&&So(t),e&&So(n),e&&So(r),e&&So(s),e&&So(c),u=!1,l();}}}function qN(e){var t,n,r,i,o,a,s,c=e[0].length+"",u=1===e[0].length?"item":"items";return {c:function(){(t=$o("div")).textContent="[",n=Mo(),r=$o("span"),i=Oo(c),o=Mo(),a=Oo(u),s=Oo("\n              "),Ro(t,"class","jse-bracket svelte-1wlxti1"),Ro(r,"class","jse-tag jse-expanded svelte-1wlxti1");},m:function(e,c){jo(e,t,c),jo(e,n,c),jo(e,r,c),yo(r,i),yo(r,o),yo(r,a),jo(e,s,c);},p:function(e,t){1&t[0]&&c!==(c=e[0].length+"")&&Lo(i,c),1&t[0]&&u!==(u=1===e[0].length?"item":"items")&&Lo(a,u);},d:function(e){e&&So(t),e&&So(n),e&&So(r),e&&So(s);}}}function FN(e){var t,n,r;return n=new DR({props:{selected:!0,onContextMenu:e[8].onContextMenu}}),{c:function(){t=$o("div"),Da(n.$$.fragment),Ro(t,"class","jse-context-menu-pointer-anchor svelte-1wlxti1");},m:function(e,i){jo(e,t,i),La(n,t,null),r=!0;},p:function(e,t){var r={};256&t[0]&&(r.onContextMenu=e[8].onContextMenu),n.$set(r);},i:function(e){r||($a(n.$$.fragment,e),r=!0);},o:function(e){_a(n.$$.fragment,e),r=!1;},d:function(e){e&&So(t),Ba(n);}}}function VN(e){var t,n;return t=new oN({props:{validationError:e[15],onExpand:e[22]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};32768&n[0]&&(r.validationError=e[15]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function WN(e){var t,n,r;return {c:function(){Ro(t=$o("div"),"class","jse-insert-selection-area jse-after svelte-1wlxti1"),Ro(t,"data-type","insert-selection-area-after");},m:function(i,o){jo(i,t,o),n||(r=Ao(t,"click",e[30]),n=!0);},p:Ki,d:function(e){e&&So(t),n=!1,r();}}}function HN(e){var t,n,r;return {c:function(){Ro(t=$o("div"),"class","jse-insert-selection-area jse-inside svelte-1wlxti1"),Ro(t,"data-type","insert-selection-area-inside");},m:function(i,o){jo(i,t,o),n||(r=Ao(t,"click",e[29]),n=!0);},p:Ki,d:function(e){e&&So(t),n=!1,r();}}}function UN(e){for(var t,n,r,i,o,a,s,c=!e[8].readOnly&&("hover-insert-inside"===e[10]||e[16]&&d_(e[7])),u=[],l=new Map,f=c&&JN(e),h=e[14]||ds,d=function(e){return e[49]},v=0;v<h.length;v+=1){var p=hN(e,h,v),m=d(p);l.set(m,u[v]=YN(m,p));}var g=!e[17]&&XN(e);return {c:function(){t=$o("div"),f&&f.c(),n=Mo();for(var s=0;s<u.length;s+=1)u[s].c();r=Mo(),i=$o("div"),(o=$o("div")).innerHTML='<span class="jse-bracket svelte-1wlxti1">]</span>',a=Mo(),g&&g.c(),Ro(t,"class","jse-items svelte-1wlxti1"),Ro(o,"data-type","selectable-value"),Ro(o,"class","jse-footer svelte-1wlxti1"),Ro(i,"class","jse-footer-outer svelte-1wlxti1"),Ro(i,"style",e[18]);},m:function(e,c){jo(e,t,c),f&&f.m(t,null),yo(t,n);for(var l=0;l<u.length;l+=1)u[l]&&u[l].m(t,null);jo(e,r,c),jo(e,i,c),yo(i,o),yo(i,a),g&&g.m(i,null),s=!0;},p:function(e,r){66944&r[0]&&(c=!e[8].readOnly&&("hover-insert-inside"===e[10]||e[16]&&d_(e[7]))),c?f?(f.p(e,r),66944&r[0]&&$a(f,1)):((f=JN(e)).c(),$a(f,1),f.m(t,n)):f&&(Sa(),_a(f,1,1,(function(){f=null;})),Ca()),68176895&r[0]&&(h=e[14]||ds,Sa(),u=Ta(u,r,d,1,e,h,l,t,Pa,YN,null,hN),Ca()),e[17]?g&&(g.d(1),g=null):g?g.p(e,r):((g=XN(e)).c(),g.m(i,null)),(!s||262144&r[0])&&Ro(i,"style",e[18]);},i:function(e){if(!s){$a(f);for(var t=0;t<h.length;t+=1)$a(u[t]);s=!0;}},o:function(e){_a(f);for(var t=0;t<u.length;t+=1)_a(u[t]);s=!1;},d:function(e){e&&So(t),f&&f.d();for(var n=0;n<u.length;n+=1)u[n].d();e&&So(r),e&&So(i),g&&g.d();}}}function JN(e){var t,n,r,i;return n=new DR({props:{selected:e[16]&&d_(e[7]),onContextMenu:e[31]}}),{c:function(){t=$o("div"),Da(n.$$.fragment),Ro(t,"class","jse-insert-area jse-inside svelte-1wlxti1"),Ro(t,"data-type","insert-selection-area-inside"),Ro(t,"style",r=tI(e[1].length+1)),Ro(t,"title",ys),Fo(t,"jse-hovered","hover-insert-inside"===e[10]),Fo(t,"jse-selected",e[16]&&d_(e[7]));},m:function(e,r){jo(e,t,r),La(n,t,null),i=!0;},p:function(e,o){var a={};65664&o[0]&&(a.selected=e[16]&&d_(e[7])),n.$set(a),(!i||2&o[0]&&r!==(r=tI(e[1].length+1)))&&Ro(t,"style",r),(!i||1024&o[0])&&Fo(t,"jse-hovered","hover-insert-inside"===e[10]),(!i||65664&o[0])&&Fo(t,"jse-selected",e[16]&&d_(e[7]));},i:function(e){i||($a(n.$$.fragment,e),i=!0);},o:function(e){_a(n.$$.fragment,e),i=!1;},d:function(e){e&&So(t),Ba(n);}}}function KN(e){var t,n,r,i=e[50].index+"";return {c:function(){t=$o("div"),n=$o("div"),r=Oo(i),Ro(n,"class","jse-index svelte-1wlxti1"),Ro(t,"slot","identifier"),Ro(t,"class","jse-identifier svelte-1wlxti1");},m:function(e,i){jo(e,t,i),yo(t,n),yo(n,r);},p:function(e,t){18687&t[0]&&i!==(i=e[50].index+"")&&Lo(r,i);},d:function(e){e&&So(t);}}}function GN(e,t){var n,r,i;return r=new rI({props:{value:t[50].value,path:t[50].path,expandedMap:t[50].expandedMap,enforceStringMap:t[50].enforceStringMap,visibleSectionsMap:t[50].visibleSectionsMap,validationErrorsMap:t[50].validationErrorsMap,searchResultItemsMap:t[50].searchResultItemsMap,selection:t[50].selection,context:t[8],onDragSelectionStart:t[26],$$slots:{identifier:[KN]},$$scope:{ctx:t}}}),{key:e,first:null,c:function(){n=Eo(),Da(r.$$.fragment),this.first=n;},m:function(e,t){jo(e,n,t),La(r,e,t),i=!0;},p:function(e,n){t=e;var i={};18687&n[0]&&(i.value=t[50].value),18687&n[0]&&(i.path=t[50].path),18687&n[0]&&(i.expandedMap=t[50].expandedMap),18687&n[0]&&(i.enforceStringMap=t[50].enforceStringMap),18687&n[0]&&(i.visibleSectionsMap=t[50].visibleSectionsMap),18687&n[0]&&(i.validationErrorsMap=t[50].validationErrorsMap),18687&n[0]&&(i.searchResultItemsMap=t[50].searchResultItemsMap),18687&n[0]&&(i.selection=t[50].selection),256&n[0]&&(i.context=t[8]),18687&n[0]|16&n[1]&&(i.$$scope={dirty:n,ctx:t}),r.$set(i);},i:function(e){i||($a(r.$$.fragment,e),i=!0);},o:function(e){_a(r.$$.fragment,e),i=!1;},d:function(e){e&&So(n),Ba(r,e);}}}function QN(e){var t,n;return t=new TR({props:{visibleSections:e[14]||ds,sectionIndex:e[49],total:e[0].length,path:e[1],pointer:e[9],onExpandSection:e[8].onExpandSection,selection:e[7]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};16384&n[0]&&(r.visibleSections=e[14]||ds),16384&n[0]&&(r.sectionIndex=e[49]),1&n[0]&&(r.total=e[0].length),2&n[0]&&(r.path=e[1]),512&n[0]&&(r.pointer=e[9]),256&n[0]&&(r.onExpandSection=e[8].onExpandSection),128&n[0]&&(r.selection=e[7]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function YN(e,t){for(var n,r,i,o,a=[],s=new Map,c=t[20](t[1],t[0],t[47],t[2],t[3],t[4],t[5],t[6],t[7],t[11]),u=function(e){return e[50].index},l=0;l<c.length;l+=1){var f=dN(t,c,l),h=u(f);s.set(h,a[l]=GN(h,f));}var d=t[47].end<t[0].length&&QN(t);return {key:e,first:null,c:function(){n=Eo();for(var e=0;e<a.length;e+=1)a[e].c();r=Mo(),d&&d.c(),i=Eo(),this.first=n;},m:function(e,t){jo(e,n,t);for(var s=0;s<a.length;s+=1)a[s]&&a[s].m(e,t);jo(e,r,t),d&&d.m(e,t),jo(e,i,t),o=!0;},p:function(e,n){t=e,68176383&n[0]&&(c=t[20](t[1],t[0],t[47],t[2],t[3],t[4],t[5],t[6],t[7],t[11]),Sa(),a=Ta(a,n,u,1,t,c,s,r.parentNode,Pa,GN,r,dN),Ca()),t[47].end<t[0].length?d?(d.p(t,n),16385&n[0]&&$a(d,1)):((d=QN(t)).c(),$a(d,1),d.m(i.parentNode,i)):d&&(Sa(),_a(d,1,1,(function(){d=null;})),Ca());},i:function(e){if(!o){for(var t=0;t<c.length;t+=1)$a(a[t]);$a(d),o=!0;}},o:function(e){for(var t=0;t<a.length;t+=1)_a(a[t]);_a(d),o=!1;},d:function(e){e&&So(n);for(var t=0;t<a.length;t+=1)a[t].d(e);e&&So(r),d&&d.d(e),e&&So(i);}}}function XN(e){var t,n,r;return {c:function(){Ro(t=$o("div"),"class","jse-insert-selection-area jse-after svelte-1wlxti1"),Ro(t,"data-type","insert-selection-area-after");},m:function(i,o){jo(i,t,o),n||(r=Ao(t,"click",e[30]),n=!0);},p:Ki,d:function(e){e&&So(t),n=!1,r();}}}function ZN(e){var t,n,r;return n=new DR({props:{selected:e[16]&&h_(e[7]),onContextMenu:e[32]}}),{c:function(){t=$o("div"),Da(n.$$.fragment),Ro(t,"class","jse-insert-area jse-after svelte-1wlxti1"),Ro(t,"data-type","insert-selection-area-after"),Ro(t,"style",e[18]),Ro(t,"title",ys),Fo(t,"jse-hovered","hover-insert-after"===e[10]),Fo(t,"jse-selected",e[16]&&h_(e[7]));},m:function(e,i){jo(e,t,i),La(n,t,null),r=!0;},p:function(e,i){var o={};65664&i[0]&&(o.selected=e[16]&&h_(e[7])),n.$set(o),(!r||262144&i[0])&&Ro(t,"style",e[18]),(!r||1024&i[0])&&Fo(t,"jse-hovered","hover-insert-after"===e[10]),(!r||65664&i[0])&&Fo(t,"jse-selected",e[16]&&h_(e[7]));},i:function(e){r||($a(n.$$.fragment,e),r=!0);},o:function(e){_a(n.$$.fragment,e),r=!1;},d:function(e){e&&So(t),Ba(n);}}}function eI(e){var t,n,r,i,o,a,s,c,u,l,f,h=!e[8].readOnly&&("hover-insert-after"===e[10]||e[16]&&h_(e[7])),d=[yN,gN,mN],v=[];function p(e,t){return 1&t[0]&&(n=null),1&t[0]&&(r=null),null==n&&(n=!!Array.isArray(e[0])),n?0:(null==r&&(r=!!hu(e[0])),r?1:2)}i=p(e,[-1,-1]),o=v[i]=d[i](e);var m=h&&ZN(e);return {c:function(){t=$o("div"),o.c(),a=Mo(),m&&m.c(),Ro(t,"class",s=lo(H_("jse-json-node",{"jse-expanded":e[12]},e[8].onClassName(e[1],e[0])))+" svelte-1wlxti1"),Ro(t,"data-path",c=SC(e[1])),Fo(t,"jse-root",e[17]),Fo(t,"jse-selected",e[16]&&m_(e[7])),Fo(t,"jse-selected-key",e[16]&&v_(e[7])),Fo(t,"jse-selected-value",e[16]&&p_(e[7])),Fo(t,"jse-readonly",e[8].readOnly),Fo(t,"jse-hovered","hover-collection"===e[10]);},m:function(n,r){jo(n,t,r),v[i].m(t,null),yo(t,a),m&&m.m(t,null),u=!0,l||(f=[Ao(t,"mousedown",e[24]),Ao(t,"mousemove",e[25]),Ao(t,"mouseover",e[27]),Ao(t,"mouseout",e[28]),Ao(t,"focus",void 0),Ao(t,"blur",void 0)],l=!0);},p:function(e,n){var r=i;(i=p(e,n))===r?v[i].p(e,n):(Sa(),_a(v[r],1,1,(function(){v[r]=null;})),Ca(),(o=v[i])?o.p(e,n):(o=v[i]=d[i](e)).c(),$a(o,1),o.m(t,a)),66944&n[0]&&(h=!e[8].readOnly&&("hover-insert-after"===e[10]||e[16]&&h_(e[7]))),h?m?(m.p(e,n),66944&n[0]&&$a(m,1)):((m=ZN(e)).c(),$a(m,1),m.m(t,null)):m&&(Sa(),_a(m,1,1,(function(){m=null;})),Ca()),(!u||4355&n[0]&&s!==(s=lo(H_("jse-json-node",{"jse-expanded":e[12]},e[8].onClassName(e[1],e[0])))+" svelte-1wlxti1"))&&Ro(t,"class",s),(!u||2&n[0]&&c!==(c=SC(e[1])))&&Ro(t,"data-path",c),(!u||135427&n[0])&&Fo(t,"jse-root",e[17]),(!u||70019&n[0])&&Fo(t,"jse-selected",e[16]&&m_(e[7])),(!u||70019&n[0])&&Fo(t,"jse-selected-key",e[16]&&v_(e[7])),(!u||70019&n[0])&&Fo(t,"jse-selected-value",e[16]&&p_(e[7])),(!u||4355&n[0])&&Fo(t,"jse-readonly",e[8].readOnly),(!u||5379&n[0])&&Fo(t,"jse-hovered","hover-collection"===e[10]);},i:function(e){u||($a(o),$a(m),u=!0);},o:function(e){_a(o),_a(m),u=!1;},d:function(e){e&&So(t),v[i].d(),m&&m.d(),l=!1,Zi(f);}}}function tI(e){return "margin-left: calc(".concat(e," * var(--jse-indent-size))")}function nI(e,t,n){var r,i,o,a,s,c,u,l,f=t.$$slots,h=void 0===f?{}:f,d=t.$$scope,v=t.value,p=t.path,m=t.expandedMap,g=t.enforceStringMap,y=t.visibleSectionsMap,b=t.validationErrorsMap,w=t.searchResultItemsMap,x=t.selection,k=t.context,j=t.onDragSelectionStart,S=Ha("jsoneditor:JSONNode"),C=void 0,$=void 0,_=void 0,O=Rh((function(e){return e}),FC);function M(e){k.onDrag(e);}function E(e){ZR.selecting&&(ZR.selecting=!1,e.stopPropagation()),k.onDragEnd(),document.removeEventListener("mousemove",M,!0),document.removeEventListener("mouseup",E);}function A(){var e,t;return (null===(e=k.findElement([]))||void 0===e||null===(t=e.getBoundingClientRect())||void 0===t?void 0:t.top)||0}function P(e,t){var n=A()-e.initialContentTop;return t.clientY-e.initialClientY-n}function T(e){if(_){var t=k.getJson(),r=k.getDocumentState(),i=P(_,e),o=eN({json:t,documentState:r,deltaY:i,items:_.items}).offset;o!==_.offset&&(S("drag selection",o,i),n(11,_=Oi(Oi({},_),{},{offset:o,didMoveItems:!0})));}}function R(e){if(_){var t=k.getJson(),r=eN({json:t,documentState:k.getDocumentState(),deltaY:P(_,e),items:_.items}),i=r.operations,o=r.updatedSelection;if(i)k.onPatch(i,(function(e,t){return {state:Oi(Oi({},t),{},{selection:o||x})}}));else if(e.target===_.initialTarget&&!_.didMoveItems){var a=jC(e.target),s=CC(e.target);s&&k.onSelect(V_(t,a,s));}n(11,_=void 0),ZR.dragging=!1,document.removeEventListener("mousemove",T,!0),document.removeEventListener("mouseup",R);}}return e.$$set=function(e){"value"in e&&n(0,v=e.value),"path"in e&&n(1,p=e.path),"expandedMap"in e&&n(2,m=e.expandedMap),"enforceStringMap"in e&&n(3,g=e.enforceStringMap),"visibleSectionsMap"in e&&n(4,y=e.visibleSectionsMap),"validationErrorsMap"in e&&n(5,b=e.validationErrorsMap),"searchResultItemsMap"in e&&n(6,w=e.searchResultItemsMap),"selection"in e&&n(7,x=e.selection),"context"in e&&n(8,k=e.context),"onDragSelectionStart"in e&&n(33,j=e.onDragSelectionStart),"$$scope"in e&&n(35,d=e.$$scope);},e.$$.update=function(){2&e.$$.dirty[0]&&n(9,o=Ys(p)),516&e.$$.dirty[0]&&n(12,a=!!m&&!0===m[o]),777&e.$$.dirty[0]&&n(13,s=r_(v,g,o,k.parser)),528&e.$$.dirty[0]&&n(14,c=y?y[o]:void 0),544&e.$$.dirty[0]&&n(15,u=b?b[o]:void 0),640&e.$$.dirty[0]&&n(16,l=!!x&&!0===x.pointersMap[o]),2&e.$$.dirty[0]&&n(17,r=0===p.length),2&e.$$.dirty[0]&&n(18,i=tI(p.length));},[v,p,m,g,y,b,w,x,k,o,C,_,a,s,c,u,l,r,i,function(e,t,n,r,i,a,s,c,u){var l=Object.keys(t).map((function(u){var l=Zs(o,u);return {key:u,value:t[u],path:O(e.concat(u)),pointer:l,expandedMap:tN(n,l),enforceStringMap:tN(r,l),visibleSectionsMap:tN(i,l),validationErrorsMap:tN(a,l),keySearchResultItemsMap:wO(s,l),valueSearchResultItemsMap:tN(s,l),selection:W_(c,l)}}));return u&&0!==u.offset&&(l=TS(l,u.selectionStartIndex,u.selectionItemsCount,u.offset)),l},function(e,t,n,r,i,a,s,c,u,l){for(var f=n.start,h=Math.min(n.end,t.length),d=[],v=f;v<h;v++){var p=Zs(o,v);d.push({index:v,value:t[v],path:O(e.concat(String(v))),pointer:p,expandedMap:tN(r,p),enforceStringMap:tN(i,p),visibleSectionsMap:tN(a,p),validationErrorsMap:tN(s,p),searchResultItemsMap:tN(c,p),selection:W_(u,p)});}if(l&&0!==l.offset){var m=d.map((function(e){return e.index}));d=TS(d,l.selectionStartIndex,l.selectionItemsCount,l.offset);for(var g=0;g<d.length;g++)d[g].index=m[g];}return d},function(e){e.stopPropagation();var t=e.ctrlKey;k.onExpand(p,!a,t);},function(e){e.stopPropagation(),k.onExpand(p,!0);},function(e,t){var n=nO(p,Object.keys(v),e,t);return k.onPatch(n),Em(Qs(n[0].path))},function(e){if(!(function(e){return "DIV"===e.nodeName&&"true"===e.contentEditable}(e.target)||1===e.which&&vC(e.target,"BUTTON"))){e.stopPropagation(),e.preventDefault(),k.focus(),document.addEventListener("mousemove",M,!0),document.addEventListener("mouseup",E);var t=jC(e.target),n=k.getJson(),i=k.getDocumentState();if(x&&x_(x,p,t))0===e.button&&j(e);else if(ZR.selecting=!0,ZR.selectionAnchor=p,ZR.selectionAnchorType=t,ZR.selectionFocus=p,e.shiftKey){var o=k.getDocumentState().selection;o&&k.onSelect(I_(n,o.anchorPath,p));}else if(t===ss.multi)if(r&&e.target.hasAttribute("data-path")){var a=Em(a_(v,i));k.onSelect(F_(a));}else k.onSelect(I_(n,p,p));else k.onSelect(V_(n,t,p));}},function(e){if(ZR.selecting){e.preventDefault(),e.stopPropagation(),null==ZR.selectionFocus&&window.getSelection&&window.getSelection().empty();var t=jC(e.target);if(!zy(p,ZR.selectionFocus)||t!==ZR.selectionAnchorType){ZR.selectionFocus=p,ZR.selectionAnchorType=t;var n=k.getJson();k.onSelect(I_(n,ZR.selectionAnchor||ZR.selectionFocus,ZR.selectionFocus));}}},function(e){if(!k.readOnly&&x){var t=ly(x.focusPath);if(zy(p,t)){var r=function(e,t){var n=[];function r(e){var t=p.concat(e),r=k.findElement(t);null!=r&&n.push({path:t,height:r.clientHeight});}if(Array.isArray(v)){var i=y_(e),o=b_(e),a=Em(i),s=Em(o),c=t.find((function(e){return a>=e.start&&s<=e.end}));if(!c)return null;var u=c.start,l=c.end;MS$1(u,Math.min(v.length,l),(function(e){return r(String(e))}));}else Object.keys(v).forEach(r);return n}(x,c||ds);if(S("dragSelectionStart",{selection:x,items:r}),r){var i=y_(x),o=r.findIndex((function(e){return zy(e.path,i)})),a=eN({json:k.getJson(),documentState:k.getDocumentState(),deltaY:0,items:r}).offset;n(11,_={initialTarget:e.target,initialClientY:e.clientY,initialContentTop:A(),selectionStartIndex:o,selectionItemsCount:L_(x).length,items:r,offset:a,didMoveItems:!1}),ZR.dragging=!0,document.addEventListener("mousemove",T,!0),document.addEventListener("mouseup",R);}else S("Cannot drag the current selection (probably spread over multiple sections)");}else j(e);}},function(e){ZR.selecting||ZR.dragging||(e.stopPropagation(),pC(e.target,"data-type","selectable-value")?n(10,C="hover-collection"):pC(e.target,"data-type","insert-selection-area-inside")?n(10,C="hover-insert-inside"):pC(e.target,"data-type","insert-selection-area-after")&&n(10,C="hover-insert-after"),clearTimeout($));},function(e){e.stopPropagation(),$=setTimeout((function(){return n(10,C=void 0)}));},function(e){e.shiftKey||(e.stopPropagation(),e.preventDefault(),k.onSelect(R_(p)));},function(e){e.shiftKey||(e.stopPropagation(),e.preventDefault(),k.onSelect(N_(p)));},function(e){k.onSelect(R_(p)),k.onContextMenu(e);},function(e){k.onSelect(N_(p)),k.onContextMenu(e);},j,h,d]}var rI=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,nI,eI,no,{value:0,path:1,expandedMap:2,enforceStringMap:3,visibleSectionsMap:4,validationErrorsMap:5,searchResultItemsMap:6,selection:7,context:8,onDragSelectionStart:33},aN,[-1,-1]),r}return qi(n)}(),iI=rI,oI={prefix:"fas",iconName:"jsoneditor-expand",icon:[512,512,[],"","M 0,448 V 512 h 512 v -64 z M 0,0 V 64 H 512 V 0 Z M 256,96 128,224 h 256 z M 256,416 384,288 H 128 Z"]},aI={prefix:"fas",iconName:"jsoneditor-collapse",icon:[512,512,[],"","m 0,224 v 64 h 512 v -64 z M 256,192 384,64 H 128 Z M 256,320 128,448 h 256 z"]},sI={prefix:"fas",iconName:"jsoneditor-format",icon:[512,512,[],"","M 0,32 v 64 h 416 v -64 z M 160,160 v 64 h 352 v -64 z M 160,288 v 64 h 288 v -64 z M 0,416 v 64 h 320 v -64 z"]},cI={prefix:"fas",iconName:"jsoneditor-compact",icon:[512,512,[],"","M 0,32 v 64 h 512 v -64 z M 0,160 v 64 h 512 v -64 z M 0,288 v 64 h 352 v -64 z"]};function uI(e){var t,n;return t=new vT({props:{items:e[0]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&Si(n,1)[0]&&(r.items=e[0]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function lI(e,t,n){var r,i,o,a,s,c,u,l=t.json,f=t.selection,h=t.readOnly,d=t.showSearch,v=void 0!==d&&d,p=t.historyState,m=t.onExpandAll,g=t.onCollapseAll,y=t.onUndo,b=t.onRedo,w=t.onSort,x=t.onTransform,k=t.onContextMenu,j=t.onCopy,S=t.onRenderMenu;function C(){n(1,v=!v);}return e.$$set=function(e){"json"in e&&n(2,l=e.json),"selection"in e&&n(3,f=e.selection),"readOnly"in e&&n(4,h=e.readOnly),"showSearch"in e&&n(1,v=e.showSearch),"historyState"in e&&n(5,p=e.historyState),"onExpandAll"in e&&n(6,m=e.onExpandAll),"onCollapseAll"in e&&n(7,g=e.onCollapseAll),"onUndo"in e&&n(8,y=e.onUndo),"onRedo"in e&&n(9,b=e.onRedo),"onSort"in e&&n(10,w=e.onSort),"onTransform"in e&&n(11,x=e.onTransform),"onContextMenu"in e&&n(12,k=e.onContextMenu),"onCopy"in e&&n(13,j=e.onCopy),"onRenderMenu"in e&&n(14,S=e.onRenderMenu);},e.$$.update=function(){4&e.$$.dirty&&n(20,r=void 0!==l),e.$$.dirty,1048584&e.$$.dirty&&n(19,i=r&&(m_(f)||v_(f)||p_(f))),68&e.$$.dirty&&n(15,a={type:"button",icon:oI,title:"Expand all",className:"jse-expand-all",onClick:m,disabled:!du(l)}),132&e.$$.dirty&&n(16,s={type:"button",icon:aI,title:"Collapse all",className:"jse-collapse-all",onClick:g,disabled:!du(l)}),4&e.$$.dirty&&n(17,c={type:"button",icon:bM,title:"Search (Ctrl+F)",className:"jse-search",onClick:C,disabled:void 0===l}),769844&e.$$.dirty&&n(18,u=h?[a,s,{type:"separator"},{type:"button",icon:xM,title:"Copy (Ctrl+C)",className:"jse-copy",onClick:j,disabled:!i},{type:"separator"},c,{type:"space"}]:[a,s,{type:"separator"},{type:"button",icon:mM,title:"Sort",className:"jse-sort",onClick:w,disabled:h||void 0===l},{type:"button",icon:iM,title:"Transform contents (filter, sort, project)",className:"jse-transform",onClick:x,disabled:h||void 0===l},c,{type:"button",icon:vM,title:bs,className:"jse-contextmenu",onClick:k},{type:"separator"},{type:"button",icon:lM,title:"Undo (Ctrl+Z)",className:"jse-undo",onClick:y,disabled:!p.canUndo},{type:"button",icon:uM,title:"Redo (Ctrl+Shift+Z)",className:"jse-redo",onClick:b,disabled:!p.canRedo},{type:"space"}]),278528&e.$$.dirty&&n(0,o=S(u)||u);},[o,v,l,f,h,p,m,g,y,b,w,x,k,j,S,a,s,c,u,i,r]}var fI=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,lI,uI,no,{json:2,selection:3,readOnly:4,showSearch:1,historyState:5,onExpandAll:6,onCollapseAll:7,onUndo:8,onRedo:9,onSort:10,onTransform:11,onContextMenu:12,onCopy:13,onRenderMenu:14}),r}return qi(n)}();function hI(e){bo(e,"svelte-1q2qkk2",'@charset "UTF-8";.jse-welcome.svelte-1q2qkk2.svelte-1q2qkk2{flex:1;overflow:auto;font-family:var(--jse-font-family);font-size:var(--jse-font-size);display:flex;flex-direction:column;align-items:center;border-left:var(--jse-main-border);border-right:var(--jse-main-border)}.jse-welcome.svelte-1q2qkk2.svelte-1q2qkk2:last-child{border-bottom:var(--jse-main-border)}.jse-welcome.svelte-1q2qkk2 .jse-space.jse-before.svelte-1q2qkk2{flex:1}.jse-welcome.svelte-1q2qkk2 .jse-space.jse-after.svelte-1q2qkk2{flex:2}.jse-welcome.svelte-1q2qkk2 .jse-contents.svelte-1q2qkk2{margin:2em var(--jse-padding) 0;color:var(--jse-panel-color-readonly)}.jse-welcome.svelte-1q2qkk2 .jse-contents ul.svelte-1q2qkk2{list-style:"";list-style-position:outside;padding-left:20px}.jse-welcome.svelte-1q2qkk2 .jse-contents ul li.svelte-1q2qkk2{padding-left:10px}.jse-welcome.svelte-1q2qkk2 .jse-contents ul li span.jse-bold.svelte-1q2qkk2{font-family:var(--jse-font-family-mono);font-weight:bold}');}function dI(e){var t;return {c:function(){(t=$o("ul")).innerHTML='<li class="svelte-1q2qkk2">Click inside the editor</li> \n        <li class="svelte-1q2qkk2">Paste clipboard data using <span class="jse-bold svelte-1q2qkk2">Ctrl+V</span></li> \n        <li class="svelte-1q2qkk2">Create a new object by typing <span class="jse-bold svelte-1q2qkk2">{</span></li> \n        <li class="svelte-1q2qkk2">Create a new array by typing <span class="jse-bold svelte-1q2qkk2">[</span></li>',Ro(t,"class","svelte-1q2qkk2");},m:function(e,n){jo(e,t,n);},d:function(e){e&&So(t);}}}function vI(e){var t,n,r,i,o,a,s,c=!e[0]&&dI();return {c:function(){t=$o("div"),n=$o("div"),r=Mo(),i=$o("div"),o=Oo("Empty document\n    "),c&&c.c(),a=Mo(),s=$o("div"),Ro(n,"class","jse-space jse-before svelte-1q2qkk2"),Ro(i,"class","jse-contents svelte-1q2qkk2"),Ro(s,"class","jse-space jse-after svelte-1q2qkk2"),Ro(t,"class","jse-welcome svelte-1q2qkk2");},m:function(e,u){jo(e,t,u),yo(t,n),yo(t,r),yo(t,i),yo(i,o),c&&c.m(i,null),yo(t,a),yo(t,s);},p:function(e,t){Si(t,1)[0];e[0]?c&&(c.d(1),c=null):c||((c=dI()).c(),c.m(i,null));},i:Ki,o:Ki,d:function(e){e&&So(t),c&&c.d();}}}function pI(e,t,n){var r=t.readOnly;return e.$$set=function(e){"readOnly"in e&&n(0,r=e.readOnly);},[r]}var mI=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,pI,vI,no,{readOnly:0},hI),r}return qi(n)}(),gI={exports:{}},yI=function(e,t){var n,r,i=1,o=0,a=0,s=String.alphabet;function c(e,t,r){if(r){for(n=t;(r=c(e,n))<76&&r>65;)++n;return +e.slice(t-1,n)}return (r=s&&s.indexOf(e.charAt(t)))>-1?r+76:(r=e.charCodeAt(t)||0)<45||r>127?r:r<46?65:r<48?r-1:r<58?r+18:r<65?r-11:r<91?r+11:r<97?r-37:r<123?r+5:r-63}if((e+="")!=(t+=""))for(;i;)if(r=c(e,o++),i=c(t,a++),r<76&&i<76&&r>66&&i>66&&(r=c(e,o,o),i=c(t,a,o=n),a=n),r!=i)return r<i?-1:1;return 0};try{gI.exports=yI;}catch(PM){String.naturalCompare=yI;}var bI=yc(gI.exports);function wI(e,t){var n="string"==typeof e?e.toLowerCase():e,r="string"==typeof t?t.toLowerCase():t;return bI(n,r)}function xI(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(_s(Vs(e,t))){if(void 0===n)throw new Error("Cannot sort: no property selected by which to sort the array");return jI(e,t,n,r)}if(hu(e))return kI(e,t,r);throw new Error("Cannot sort: no array or object")}function kI(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=Vs(e,t),i=Object.keys(r),o=i.slice();o.sort((function(e,t){return n*wI(e,t)}));for(var a=[],s=0;s<o.length;s++){var c=o[s],u=Ys(t.concat(c));a.push({op:"move",from:u,path:u});}return a}function jI(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=SI(n,r),o=Vs(e,t);return [{op:"replace",path:Ys(t),value:o.slice(0).sort(i)}]}function SI(e,t){return function(n,r){var i=Vs(n,e),o=Vs(r,e);return void 0===i?t:void 0===o?-t:"string"!=typeof i&&"string"!=typeof o?i>o?t:i<o?-t:0:t*wI(i,o)}}function CI(e){bo(e,"svelte-6hb2gf",".jse-navigation-bar-dropdown.svelte-6hb2gf.svelte-6hb2gf{position:absolute;top:100%;left:0;z-index:3;background:var(--jse-navigation-bar-background);color:var(--jse-navigation-bar-dropdown-color);box-shadow:var(--jse-controls-box-shadow);display:flex;flex-direction:column;max-height:300px;overflow:auto;min-width:80px}.jse-navigation-bar-dropdown.svelte-6hb2gf button.jse-navigation-bar-dropdown-item.svelte-6hb2gf{font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);border:none;background:transparent;color:inherit;cursor:pointer;outline:none;text-align:left;white-space:nowrap;box-sizing:border-box;padding:calc(0.5 * var(--jse-padding)) 36px}.jse-navigation-bar-dropdown.svelte-6hb2gf button.jse-navigation-bar-dropdown-item.svelte-6hb2gf:focus,.jse-navigation-bar-dropdown.svelte-6hb2gf button.jse-navigation-bar-dropdown-item.svelte-6hb2gf:hover{background:var(--jse-navigation-bar-background-highlight)}.jse-navigation-bar-dropdown.svelte-6hb2gf button.jse-navigation-bar-dropdown-item.jse-selected.svelte-6hb2gf{background:var(--jse-navigation-bar-dropdown-color);color:var(--jse-navigation-bar-background)}");}function $I(e,t,n){var r=e.slice();return r[4]=t[n],r}function _I(e,t){var n,r,i,o,a,s=QC(t[4].toString(),AI)+"";function c(){return t[3](t[4])}return {key:e,first:null,c:function(){n=$o("button"),r=Oo(s),Ro(n,"type","button"),Ro(n,"class","jse-navigation-bar-dropdown-item svelte-6hb2gf"),Ro(n,"title",i=t[4].toString()),Fo(n,"jse-selected",t[4]===t[1]),this.first=n;},m:function(e,t){jo(e,n,t),yo(n,r),o||(a=Ao(n,"click",To(c)),o=!0);},p:function(e,o){t=e,1&o&&s!==(s=QC(t[4].toString(),AI)+"")&&Lo(r,s),1&o&&i!==(i=t[4].toString())&&Ro(n,"title",i),3&o&&Fo(n,"jse-selected",t[4]===t[1]);},d:function(e){e&&So(n),o=!1,a();}}}function OI(e){var t,n;return {c:function(){t=$o("button"),n=Oo("..."),Ro(t,"type","button"),Ro(t,"class","jse-navigation-bar-dropdown-item svelte-6hb2gf"),Ro(t,"title","Limited to "+EI+" items");},m:function(e,r){jo(e,t,r),yo(t,n);},p:Ki,d:function(e){e&&So(t);}}}function MI(e){for(var t,n,r=[],i=new Map,o=ES(e[0],EI),a=function(e){return e[4]},s=0;s<o.length;s+=1){var c=$I(e,o,s),u=a(c);i.set(u,r[s]=_I(u,c));}var l=e[0].length>EI&&OI();return {c:function(){t=$o("div");for(var e=0;e<r.length;e+=1)r[e].c();n=Mo(),l&&l.c(),Ro(t,"class","jse-navigation-bar-dropdown svelte-6hb2gf");},m:function(e,i){jo(e,t,i);for(var o=0;o<r.length;o+=1)r[o]&&r[o].m(t,null);yo(t,n),l&&l.m(t,null);},p:function(e,s){var c=Si(s,1)[0];7&c&&(o=ES(e[0],EI),r=Ta(r,c,a,1,e,o,i,t,Aa,_I,n,$I)),e[0].length>EI?l?l.p(e,c):((l=OI()).c(),l.m(t,null)):l&&(l.d(1),l=null);},i:Ki,o:Ki,d:function(e){e&&So(t);for(var n=0;n<r.length;n+=1)r[n].d();l&&l.d();}}}var EI=100,AI=30;function PI(e,t,n){var r=t.items,i=t.selectedItem,o=t.onSelect;return e.$$set=function(e){"items"in e&&n(0,r=e.items),"selectedItem"in e&&n(1,i=e.selectedItem),"onSelect"in e&&n(2,o=e.onSelect);},[r,i,o,function(e){return o(e)}]}var TI=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,PI,MI,no,{items:0,selectedItem:1,onSelect:2},CI),r}return qi(n)}();function RI(e){bo(e,"svelte-1r1k9th",".jse-navigation-bar-item.svelte-1r1k9th.svelte-1r1k9th{position:relative;display:flex}.jse-navigation-bar-item.svelte-1r1k9th button.jse-navigation-bar-button.svelte-1r1k9th{font-family:inherit;font-size:inherit;padding:calc(0.5 * var(--jse-padding)) 2px;border:none;background:transparent;color:inherit;cursor:pointer;outline:none;min-width:2em;white-space:nowrap}.jse-navigation-bar-item.svelte-1r1k9th button.jse-navigation-bar-button.svelte-1r1k9th:focus,.jse-navigation-bar-item.svelte-1r1k9th button.jse-navigation-bar-button.svelte-1r1k9th:hover{background:var(--jse-panel-button-background-highlight);color:var(--jse-panel-button-color-highlight)}.jse-navigation-bar-item.svelte-1r1k9th button.jse-navigation-bar-button.jse-navigation-bar-arrow.svelte-1r1k9th{padding:2px var(--jse-padding) 0}.jse-navigation-bar-item.svelte-1r1k9th button.jse-navigation-bar-button.jse-navigation-bar-arrow.jse-open.svelte-1r1k9th{background:var(--jse-navigation-bar-background);color:var(--jse-navigation-bar-dropdown-color)}.jse-navigation-bar-item.svelte-1r1k9th.svelte-1r1k9th:last-child{padding-right:var(--jse-padding)}");}function NI(e){var t,n,r,i;return {c:function(){t=$o("button"),n=Oo(e[2]),Ro(t,"type","button"),Ro(t,"class","jse-navigation-bar-button svelte-1r1k9th");},m:function(o,a){jo(o,t,a),yo(t,n),r||(i=Ao(t,"click",e[9]),r=!0);},p:function(e,t){4&t&&Lo(n,e[2]);},d:function(e){e&&So(t),r=!1,i();}}}function II(e){var t,n,r,i,o,a,s;r=new x$({props:{data:tM}});var c=void 0!==e[2]&&NI(e);return {c:function(){t=$o("div"),n=$o("button"),Da(r.$$.fragment),i=Mo(),c&&c.c(),Ro(n,"type","button"),Ro(n,"class","jse-navigation-bar-button jse-navigation-bar-arrow svelte-1r1k9th"),Fo(n,"jse-open",e[1]),Ro(t,"class","jse-navigation-bar-item svelte-1r1k9th");},m:function(u,l){jo(u,t,l),yo(t,n),La(r,n,null),yo(t,i),c&&c.m(t,null),e[10](t),o=!0,a||(s=Ao(n,"click",e[4]),a=!0);},p:function(e,r){var i=Si(r,1)[0];(!o||2&i)&&Fo(n,"jse-open",e[1]),void 0!==e[2]?c?c.p(e,i):((c=NI(e)).c(),c.m(t,null)):c&&(c.d(1),c=null);},i:function(e){o||($a(r.$$.fragment,e),o=!0);},o:function(e){_a(r.$$.fragment,e),o=!1;},d:function(n){n&&So(t),Ba(r),c&&c.d(),e[10](null),a=!1,s();}}}function DI(e,t,n){var r,i,o,a,s=ia("absolute-popup"),c=s.openAbsolutePopup,u=s.closeAbsolutePopup,l=t.path,f=t.index,h=t.onSelect,d=t.getItems,v=!1;function p(e){u(a),h(r.concat(e));}return e.$$set=function(e){"path"in e&&n(5,l=e.path),"index"in e&&n(6,f=e.index),"onSelect"in e&&n(7,h=e.onSelect),"getItems"in e&&n(8,d=e.getItems);},e.$$.update=function(){96&e.$$.dirty&&(r=l.slice(0,f)),96&e.$$.dirty&&n(2,i=l[f]);},[o,v,i,p,function(){if(o){n(1,v=!0);var e={items:d(r),selectedItem:i,onSelect:p};a=c(TI,e,{anchor:o,closeOnOuterClick:!0,onClose:function(){n(1,v=!1);}});}},l,f,h,d,function(){return p(i)},function(e){sa[e?"unshift":"push"]((function(){n(0,o=e);}));}]}var LI=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,DI,II,no,{path:5,index:6,onSelect:7,getItems:8},RI),r}return qi(n)}();function BI(e){var t,n;if(navigator.clipboard)return navigator.clipboard.writeText(e);if(null!==(t=(n=document).queryCommandSupported)&&void 0!==t&&t.call(n,"copy")){var r=document.createElement("textarea");r.value=e,r.style.position="fixed",r.style.opacity="0",document.body.appendChild(r),r.select();try{document.execCommand("copy");}catch(e){console.error(e);}finally{document.body.removeChild(r);}}else console.error("Copy failed.");}function zI(e){bo(e,"svelte-g0evpe",".jse-navigation-bar-path-editor.svelte-g0evpe.svelte-g0evpe{flex:1;display:flex;border:var(--jse-edit-outline);background:var(--jse-background-color)}.jse-navigation-bar-path-editor.svelte-g0evpe input.jse-navigation-bar-text.svelte-g0evpe{flex:1;font-family:inherit;font-size:inherit;padding:0 5px 1px;background:var(--jse-background-color);color:var(--jse-text-color);border:none;outline:none}.jse-navigation-bar-path-editor.svelte-g0evpe button.svelte-g0evpe{border:none;background:var(--jse-background-color);cursor:pointer;font-family:inherit;font-size:80%;color:inherit}.jse-navigation-bar-path-editor.svelte-g0evpe button.jse-navigation-bar-copy.copied.svelte-g0evpe{color:var(--jse-message-success-background)}.jse-navigation-bar-path-editor.svelte-g0evpe button.jse-navigation-bar-validation-error.svelte-g0evpe{color:var(--jse-error-color)}.jse-navigation-bar-path-editor.error.svelte-g0evpe.svelte-g0evpe{border-color:var(--jse-error-color)}.jse-navigation-bar-path-editor.error.svelte-g0evpe input.jse-navigation-bar-text.svelte-g0evpe{color:var(--jse-error-color)}.jse-navigation-bar-path-editor.svelte-g0evpe .jse-copied-text.svelte-g0evpe{background:var(--jse-message-success-background);color:var(--jse-message-success-color);position:relative;margin:2px;padding:0 5px;border-radius:3px}");}function qI(e){var t,n,r,i,o,a;return n=new x$({props:{data:MM}}),{c:function(){t=$o("button"),Da(n.$$.fragment),Ro(t,"type","button"),Ro(t,"class","jse-navigation-bar-validation-error svelte-g0evpe");},m:function(s,c){jo(s,t,c),La(n,t,null),i=!0,o||(a=fo(r=zO.call(null,t,Oi({text:e[3]},e[4]))),o=!0);},p:function(e,t){r&&eo(r.update)&&8&t&&r.update.call(null,Oi({text:e[3]},e[4]));},i:function(e){i||($a(n.$$.fragment,e),i=!0);},o:function(e){_a(n.$$.fragment,e),i=!1;},d:function(e){e&&So(t),Ba(n),o=!1,a();}}}function FI(e){var t;return {c:function(){(t=$o("div")).textContent="Copied!",Ro(t,"class","jse-copied-text svelte-g0evpe");},m:function(e,n){jo(e,t,n);},d:function(e){e&&So(t);}}}function VI(e){var t,n,r,i,o,a,s,c,u,l,f=e[3]&&qI(e),h=e[2]&&FI();return s=new x$({props:{data:xM}}),{c:function(){t=$o("div"),n=$o("input"),r=Mo(),f&&f.c(),i=Mo(),h&&h.c(),o=Mo(),a=$o("button"),Da(s.$$.fragment),Ro(n,"type","text"),Ro(n,"class","jse-navigation-bar-text svelte-g0evpe"),n.value=e[0],Ro(a,"type","button"),Ro(a,"class","jse-navigation-bar-copy svelte-g0evpe"),Ro(a,"title","Copy selected path to the clipboard"),Fo(a,"copied",e[2]),Ro(t,"class","jse-navigation-bar-path-editor svelte-g0evpe"),Fo(t,"error",e[3]);},m:function(d,v){jo(d,t,v),yo(t,n),e[15](n),yo(t,r),f&&f.m(t,null),yo(t,i),h&&h.m(t,null),yo(t,o),yo(t,a),La(s,a,null),c=!0,u||(l=[Ao(n,"keydown",To(e[6])),Ao(n,"input",e[5]),Ao(a,"click",e[7])],u=!0);},p:function(e,r){var s=Si(r,1)[0];(!c||1&s&&n.value!==e[0])&&(n.value=e[0]),e[3]?f?(f.p(e,s),8&s&&$a(f,1)):((f=qI(e)).c(),$a(f,1),f.m(t,i)):f&&(Sa(),_a(f,1,1,(function(){f=null;})),Ca()),e[2]?h||((h=FI()).c(),h.m(t,o)):h&&(h.d(1),h=null),(!c||4&s)&&Fo(a,"copied",e[2]),(!c||8&s)&&Fo(t,"error",e[3]);},i:function(e){c||($a(f),$a(s.$$.fragment,e),c=!0);},o:function(e){_a(f),_a(s.$$.fragment,e),c=!1;},d:function(n){n&&So(t),e[15](null),f&&f.d(),h&&h.d(),Ba(s),u=!1,Zi(l);}}}function WI(e,t,n){var r,i,o,a=ia("absolute-popup"),s=t.path,c=t.pathParser,u=t.onChange,l=t.onClose,f=t.onError,h=t.pathExists,d=!1,v=void 0,p=!1;function m(){i.focus();}function g(e){try{var t=c.parse(e);return function(e){if(!h(e))throw new Error("Path does not exist in current document")}(t),{path:t,error:void 0}}catch(e){return {path:void 0,error:e}}}return ea((function(){m();})),ta((function(){clearTimeout(v);})),e.$$set=function(e){"path"in e&&n(8,s=e.path),"pathParser"in e&&n(9,c=e.pathParser),"onChange"in e&&n(10,u=e.onChange),"onClose"in e&&n(11,l=e.onClose),"onError"in e&&n(12,f=e.onError),"pathExists"in e&&n(13,h=e.pathExists);},e.$$.update=function(){768&e.$$.dirty&&n(0,o=c.stringify(s)),16385&e.$$.dirty&&n(3,r=d?g(o).error:void 0);},[o,i,p,r,a,function(e){n(0,o=e.currentTarget.value);},function(e){var t=_C(e);if("Escape"===t&&l(),"Enter"===t){n(14,d=!0);var r=g(o);void 0!==r.path?u(r.path):f(r.error);}},function(){BI(o),n(2,p=!0),v=setTimeout((function(){return n(2,p=!1)}),1e3),m();},s,c,u,l,f,h,d,function(e){sa[e?"unshift":"push"]((function(){n(1,i=e);}));}]}var HI=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,WI,VI,to,{path:8,pathParser:9,onChange:10,onClose:11,onError:12,pathExists:13},zI),r}return qi(n)}();function UI(e){bo(e,"svelte-15r3ahw",".jse-navigation-bar.svelte-15r3ahw.svelte-15r3ahw{font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);background:var(--jse-panel-background);color:var(--jse-panel-button-color);padding:0;margin:0;display:flex;overflow:auto;border-left:var(--jse-main-border);border-right:var(--jse-main-border)}.jse-navigation-bar.svelte-15r3ahw .jse-navigation-bar-edit.svelte-15r3ahw{font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);padding:calc(0.5 * var(--jse-padding)) var(--jse-padding);color:var(--jse-panel-color-readonly);background:transparent;border:none;display:flex;cursor:pointer;outline:none;align-items:center}.jse-navigation-bar.svelte-15r3ahw .jse-navigation-bar-edit.flex.svelte-15r3ahw{flex:1}.jse-navigation-bar.svelte-15r3ahw .jse-navigation-bar-edit.svelte-15r3ahw:focus,.jse-navigation-bar.svelte-15r3ahw .jse-navigation-bar-edit.svelte-15r3ahw:hover,.jse-navigation-bar.svelte-15r3ahw .jse-navigation-bar-edit.editing.svelte-15r3ahw{background:var(--jse-panel-button-background-highlight);color:var(--jse-panel-button-color-highlight);transition:color 0.2s ease-in, background 0.2s ease-in}.jse-navigation-bar.svelte-15r3ahw .jse-navigation-bar-edit .jse-navigation-bar-space.svelte-15r3ahw{flex:1;text-align:left}");}function JI(e,t,n){var r=e.slice();return r[20]=t[n],r[22]=n,r}function KI(e){var t,n;return t=new HI({props:{path:e[3],onClose:e[12],onChange:e[13],onError:e[1],pathExists:e[9],pathParser:e[2]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};8&n&&(r.path=e[3]),2&n&&(r.onError=e[1]),4&n&&(r.pathParser=e[2]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function GI(e){for(var t,n,r,i=[],o=new Map,a=e[3],s=function(e){return e[22]},c=0;c<a.length;c+=1){var u=JI(e,a,c),l=s(u);o.set(l,i[c]=QI(l,u));}var f=e[7]&&YI(e);return {c:function(){for(var e=0;e<i.length;e+=1)i[e].c();t=Mo(),f&&f.c(),n=Eo();},m:function(e,o){for(var a=0;a<i.length;a+=1)i[a]&&i[a].m(e,o);jo(e,t,o),f&&f.m(e,o),jo(e,n,o),r=!0;},p:function(e,r){1288&r&&(a=e[3],Sa(),i=Ta(i,r,s,1,e,a,o,t.parentNode,Pa,QI,t,JI),Ca()),e[7]?f?(f.p(e,r),128&r&&$a(f,1)):((f=YI(e)).c(),$a(f,1),f.m(n.parentNode,n)):f&&(Sa(),_a(f,1,1,(function(){f=null;})),Ca());},i:function(e){if(!r){for(var t=0;t<a.length;t+=1)$a(i[t]);$a(f),r=!0;}},o:function(e){for(var t=0;t<i.length;t+=1)_a(i[t]);_a(f),r=!1;},d:function(e){for(var r=0;r<i.length;r+=1)i[r].d(e);e&&So(t),f&&f.d(e),e&&So(n);}}}function QI(e,t){var n,r,i;return r=new LI({props:{getItems:t[8],path:t[3],index:t[22],onSelect:t[10]}}),{key:e,first:null,c:function(){n=Eo(),Da(r.$$.fragment),this.first=n;},m:function(e,t){jo(e,n,t),La(r,e,t),i=!0;},p:function(e,n){t=e;var i={};8&n&&(i.path=t[3]),8&n&&(i.index=t[22]),r.$set(i);},i:function(e){i||($a(r.$$.fragment,e),i=!0);},o:function(e){_a(r.$$.fragment,e),i=!1;},d:function(e){e&&So(n),Ba(r,e);}}}function YI(e){var t,n;return t=new LI({props:{getItems:e[8],path:e[3],index:void 0,onSelect:e[10]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};8&n&&(r.path=e[3]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function XI(e){var t,n,r,i,o,a,s,c,u,l,f,h,d,v=du(e[0])||e[6]?"":"Navigation bar",p=[GI,KI],m=[];function g(e,t){return e[6]?1:0}return n=g(e),r=m[n]=p[n](e),u=new x$({props:{data:e[6]?SM:ZO}}),{c:function(){t=$o("div"),r.c(),i=Mo(),o=$o("button"),a=$o("span"),s=Oo(v),c=Mo(),Da(u.$$.fragment),Ro(a,"class","jse-navigation-bar-space svelte-15r3ahw"),Ro(o,"type","button"),Ro(o,"class","jse-navigation-bar-edit svelte-15r3ahw"),Ro(o,"title",l=e[6]?"Cancel editing the selected path":"Edit the selected path"),Fo(o,"flex",!e[6]),Fo(o,"editing",e[6]),Ro(t,"class","jse-navigation-bar svelte-15r3ahw");},m:function(r,l){jo(r,t,l),m[n].m(t,null),yo(t,i),yo(t,o),yo(o,a),yo(a,s),yo(o,c),La(u,o,null),e[16](o),e[17](t),f=!0,h||(d=Ao(o,"click",e[11]),h=!0);},p:function(e,a){var c=Si(a,1)[0],h=n;(n=g(e))===h?m[n].p(e,c):(Sa(),_a(m[h],1,1,(function(){m[h]=null;})),Ca(),(r=m[n])?r.p(e,c):(r=m[n]=p[n](e)).c(),$a(r,1),r.m(t,i)),(!f||65&c)&&v!==(v=du(e[0])||e[6]?"":"Navigation bar")&&Lo(s,v);var d={};64&c&&(d.data=e[6]?SM:ZO),u.$set(d),(!f||64&c&&l!==(l=e[6]?"Cancel editing the selected path":"Edit the selected path"))&&Ro(o,"title",l),(!f||64&c)&&Fo(o,"flex",!e[6]),(!f||64&c)&&Fo(o,"editing",e[6]);},i:function(e){f||($a(r),$a(u.$$.fragment,e),f=!0);},o:function(e){_a(r),_a(u.$$.fragment,e),f=!1;},d:function(r){r&&So(t),m[n].d(),Ba(u),e[16](null),e[17](null),h=!1,d();}}}function ZI(e,t,n){var r,i,o,a,s=Ha("jsoneditor:NavigationBar"),c=t.json,u=t.documentState,l=t.onSelect,f=t.onError,h=t.pathParser,d=!1;function v(e){s("select path",JSON.stringify(e)),l(I_(c,e,e));}function p(){n(6,d=!1);}return e.$$set=function(e){"json"in e&&n(0,c=e.json),"documentState"in e&&n(14,u=e.documentState),"onSelect"in e&&n(15,l=e.onSelect),"onError"in e&&n(1,f=e.onError),"pathParser"in e&&n(2,h=e.pathParser);},e.$$.update=function(){16384&e.$$.dirty&&n(3,r=u.selection?u.selection.focusPath:[]),9&e.$$.dirty&&n(7,i=du(Vs(c,r))),8&e.$$.dirty&&setTimeout((function(){if(o&&o.scrollTo){var e=o.scrollWidth-o.clientWidth;e>0&&(s("scrollTo ",e),o.scrollTo({left:e,behavior:"smooth"}));}}));},[c,f,h,r,o,a,d,i,function(e){s("get items for path",e);var t=Vs(c,e);if(Array.isArray(t))return mx(0,t.length).map(String);if(hu(t)){var n=Object.keys(t).slice(0);return n.sort(wI),n}return []},function(e){return Gs(c,e)},v,function(){n(6,d=!d);},p,function(e){p(),v(e);},u,l,function(e){sa[e?"unshift":"push"]((function(){n(5,a=e);}));},function(e){sa[e?"unshift":"push"]((function(){n(4,o=e);}));}]}var eD=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,ZI,XI,no,{json:0,documentState:14,onSelect:15,onError:1,pathParser:2},UI),r}return qi(n)}();function tD(e){bo(e,"svelte-3lbrbf",".jse-search-box.svelte-3lbrbf.svelte-3lbrbf{border:var(--jse-panel-border);border-radius:3px;font-family:var(--jse-font-family);font-size:var(--jse-font-size);background:var(--jse-panel-background);color:var(--jse-panel-color-readonly);box-shadow:var(--jse-controls-box-shadow);display:inline-block;width:400px;max-width:100%;overflow:auto}.jse-search-box.svelte-3lbrbf .jse-search-form.svelte-3lbrbf{display:flex;align-items:stretch}.jse-search-box.svelte-3lbrbf .jse-search-form button.svelte-3lbrbf,.jse-search-box.svelte-3lbrbf .jse-search-form input.svelte-3lbrbf{font-family:inherit;font-size:inherit}.jse-search-box.svelte-3lbrbf .jse-search-form button.svelte-3lbrbf{display:block;text-align:center;border:none;padding:0 5px;margin:0;cursor:pointer;color:var(--jse-panel-button-color);background:var(--jse-panel-button-background)}.jse-search-box.svelte-3lbrbf .jse-search-form button.svelte-3lbrbf:hover{color:var(--jse-panel-button-color-highlight);background:var(--jse-panel-button-background-highlight)}.jse-search-box.svelte-3lbrbf .jse-search-form input.svelte-3lbrbf{color:var(--jse-panel-color);border:var(--jse-input-border);border-radius:3px;background:var(--jse-input-background);height:28px;padding:0 5px;margin:0;flex:1;width:0;min-width:50px;outline:none}.jse-search-box.svelte-3lbrbf .jse-search-form .jse-replace-toggle.svelte-3lbrbf{padding:var(--jse-padding) calc(0.5 * var(--jse-padding));min-width:20px;background:var(--jse-panel-button-background-highlight)}.jse-search-box.svelte-3lbrbf .jse-search-form .jse-search-contents.svelte-3lbrbf{flex:1;display:flex;flex-direction:column;padding:calc(0.5 * var(--jse-padding));gap:calc(0.5 * var(--jse-padding))}.jse-search-box.svelte-3lbrbf .jse-search-form .jse-search-contents .jse-search-section.svelte-3lbrbf{flex:1;display:flex;align-items:center;position:relative;padding-left:32px}.jse-search-box.svelte-3lbrbf .jse-search-form .jse-search-contents .jse-search-section .jse-search-icon.svelte-3lbrbf{color:inherit;cursor:inherit;background:inherit;position:absolute;top:calc(0.5 * var(--jse-padding));left:calc(0.5 * var(--jse-padding))}.jse-search-box.svelte-3lbrbf .jse-search-form .jse-search-contents .jse-search-section label.jse-search-input-label.svelte-3lbrbf{flex:1;display:flex}.jse-search-box.svelte-3lbrbf .jse-search-form .jse-search-contents .jse-search-section .jse-search-count.svelte-3lbrbf{color:inherit;font-size:80%;visibility:hidden;padding:0 5px;min-width:36px;text-align:center}.jse-search-box.svelte-3lbrbf .jse-search-form .jse-search-contents .jse-search-section .jse-search-count.jse-visible.svelte-3lbrbf{visibility:visible}.jse-search-box.svelte-3lbrbf .jse-search-form .jse-search-contents .jse-replace-section.svelte-3lbrbf{padding-left:32px;flex:1;display:flex}.jse-search-box.svelte-3lbrbf .jse-search-form .jse-search-contents .jse-replace-section button.svelte-3lbrbf{width:auto}");}function nD(e){var t,n,r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b,w,x,k,j,S,C,$,_,O,M=(-1!==e[3]?"".concat(e[3]+1,"/"):"")+"",E=!e[4]&&rD(e),A=[oD,iD],P=[];function T(e,t){return e[2]?0:1}s=T(e),c=P[s]=A[s](e),y=new x$({props:{data:wM}}),x=new x$({props:{data:eM}}),S=new x$({props:{data:CM}});var R=e[0]&&!e[4]&&aD(e);return {c:function(){t=$o("div"),n=$o("form"),E&&E.c(),r=Mo(),i=$o("div"),o=$o("div"),a=$o("div"),c.c(),u=Mo(),l=$o("label"),f=$o("input"),h=Mo(),d=$o("div"),v=Oo(M),p=Oo(e[10]),m=Mo(),g=$o("button"),Da(y.$$.fragment),b=Mo(),w=$o("button"),Da(x.$$.fragment),k=Mo(),j=$o("button"),Da(S.$$.fragment),C=Mo(),R&&R.c(),Ro(a,"class","jse-search-icon svelte-3lbrbf"),Ro(f,"class","jse-search-input svelte-3lbrbf"),Ro(f,"title","Enter text to search"),Ro(f,"type","text"),Ro(f,"placeholder","Find"),Ro(l,"class","jse-search-input-label svelte-3lbrbf"),Ro(l,"about","jse-search input"),Ro(d,"class","jse-search-count svelte-3lbrbf"),Fo(d,"jse-visible",""!==e[8]),Ro(g,"type","button"),Ro(g,"class","jse-search-next svelte-3lbrbf"),Ro(g,"title","Go to next search result (Enter)"),Ro(w,"type","button"),Ro(w,"class","jse-search-previous svelte-3lbrbf"),Ro(w,"title","Go to previous search result (Shift+Enter)"),Ro(j,"type","button"),Ro(j,"class","jse-search-clear svelte-3lbrbf"),Ro(j,"title","Close search box (Esc)"),Ro(o,"class","jse-search-section svelte-3lbrbf"),Ro(i,"class","jse-search-contents svelte-3lbrbf"),Ro(n,"class","jse-search-form svelte-3lbrbf"),Ro(t,"class","jse-search-box svelte-3lbrbf");},m:function(c,M){jo(c,t,M),yo(t,n),E&&E.m(n,null),yo(n,r),yo(n,i),yo(i,o),yo(o,a),P[s].m(a,null),yo(o,u),yo(o,l),yo(l,f),Bo(f,e[8]),yo(o,h),yo(o,d),yo(d,v),yo(d,p),yo(o,m),yo(o,g),La(y,g,null),yo(o,b),yo(o,w),La(x,w,null),yo(o,k),yo(o,j),La(S,j,null),yo(i,C),R&&R.m(i,null),$=!0,_||(O=[Ao(f,"input",e[21]),fo(cD.call(null,f)),Ao(g,"click",e[22]),Ao(w,"click",e[23]),Ao(j,"click",e[24]),Ao(n,"submit",e[12]),Ao(n,"keydown",e[13])],_=!0);},p:function(e,t){e[4]?E&&(Sa(),_a(E,1,1,(function(){E=null;})),Ca()):E?(E.p(e,t),16&t&&$a(E,1)):((E=rD(e)).c(),$a(E,1),E.m(n,r));var o=s;(s=T(e))===o?P[s].p(e,t):(Sa(),_a(P[o],1,1,(function(){P[o]=null;})),Ca(),(c=P[s])?c.p(e,t):(c=P[s]=A[s](e)).c(),$a(c,1),c.m(a,null)),256&t&&f.value!==e[8]&&Bo(f,e[8]),(!$||8&t)&&M!==(M=(-1!==e[3]?"".concat(e[3]+1,"/"):"")+"")&&Lo(v,M),(!$||1024&t)&&Lo(p,e[10]),(!$||256&t)&&Fo(d,"jse-visible",""!==e[8]),e[0]&&!e[4]?R?R.p(e,t):((R=aD(e)).c(),R.m(i,null)):R&&(R.d(1),R=null);},i:function(e){$||($a(E),$a(c),$a(y.$$.fragment,e),$a(x.$$.fragment,e),$a(S.$$.fragment,e),$=!0);},o:function(e){_a(E),_a(c),_a(y.$$.fragment,e),_a(x.$$.fragment,e),_a(S.$$.fragment,e),$=!1;},d:function(e){e&&So(t),E&&E.d(),P[s].d(),Ba(y),Ba(x),Ba(S),R&&R.d(),_=!1,Zi(O);}}}function rD(e){var t,n,r,i,o;return n=new x$({props:{data:e[0]?dM:JO}}),{c:function(){t=$o("button"),Da(n.$$.fragment),Ro(t,"type","button"),Ro(t,"class","jse-replace-toggle svelte-3lbrbf"),Ro(t,"title","Toggle visibility of replace options (Ctrl+H)");},m:function(a,s){jo(a,t,s),La(n,t,null),r=!0,i||(o=Ao(t,"click",e[11]),i=!0);},p:function(e,t){var r={};1&t&&(r.data=e[0]?dM:JO),n.$set(r);},i:function(e){r||($a(n.$$.fragment,e),r=!0);},o:function(e){_a(n.$$.fragment,e),r=!1;},d:function(e){e&&So(t),Ba(n),i=!1,o();}}}function iD(e){var t,n;return t=new x$({props:{data:bM}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:Ki,i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function oD(e){var t,n;return t=new x$({props:{data:GO,spin:!0}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:Ki,i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function aD(e){var t,n,r,i,o,a,s,c;return {c:function(){t=$o("div"),n=$o("input"),r=Mo(),(i=$o("button")).textContent="Replace",o=Mo(),(a=$o("button")).textContent="All",Ro(n,"class","jse-replace-input svelte-3lbrbf"),Ro(n,"title","Enter replacement text"),Ro(n,"type","text"),Ro(n,"placeholder","Replace"),Ro(i,"type","button"),Ro(i,"title","Replace current occurrence (Ctrl+Enter)"),Ro(i,"class","svelte-3lbrbf"),Ro(a,"type","button"),Ro(a,"title","Replace all occurrences"),Ro(a,"class","svelte-3lbrbf"),Ro(t,"class","jse-replace-section svelte-3lbrbf");},m:function(u,l){jo(u,t,l),yo(t,n),Bo(n,e[9]),yo(t,r),yo(t,i),yo(t,o),yo(t,a),s||(c=[Ao(n,"input",e[25]),Ao(i,"click",e[14]),Ao(a,"click",e[15])],s=!0);},p:function(e,t){512&t&&n.value!==e[9]&&Bo(n,e[9]);},d:function(e){e&&So(t),s=!1,Zi(c);}}}function sD(e){var t,n,r=e[1]&&nD(e);return {c:function(){r&&r.c(),t=Eo();},m:function(e,i){r&&r.m(e,i),jo(e,t,i),n=!0;},p:function(e,n){var i=Si(n,1)[0];e[1]?r?(r.p(e,i),2&i&&$a(r,1)):((r=nD(e)).c(),$a(r,1),r.m(t.parentNode,t)):r&&(Sa(),_a(r,1,1,(function(){r=null;})),Ca());},i:function(e){n||($a(r),n=!0);},o:function(e){_a(r),n=!1;},d:function(e){r&&r.d(e),e&&So(t);}}}function cD(e){e.select();}function uD(e,t,n){var r,i,o=t.show,a=void 0!==o&&o,s=t.searching,c=t.resultCount,u=void 0===c?0:c,l=t.activeIndex,f=void 0===l?0:l,h=t.showReplace,d=void 0!==h&&h,v=t.readOnly,p=void 0!==v&&v,m=t.onChange,g=void 0===m?Tl:m,y=t.onPrevious,b=void 0===y?Tl:y,w=t.onNext,x=void 0===w?Tl:w,k=t.onReplace,j=void 0===k?Tl:k,S=t.onReplaceAll,C=void 0===S?Tl:S,$=t.onClose,_=void 0===$?Tl:$,O="",M="",E="";function A(){n(0,d=!d&&!p);}function P(){p||j(O,E);}return e.$$set=function(e){"show"in e&&n(1,a=e.show),"searching"in e&&n(2,s=e.searching),"resultCount"in e&&n(16,u=e.resultCount),"activeIndex"in e&&n(3,f=e.activeIndex),"showReplace"in e&&n(0,d=e.showReplace),"readOnly"in e&&n(4,p=e.readOnly),"onChange"in e&&n(17,g=e.onChange),"onPrevious"in e&&n(5,b=e.onPrevious),"onNext"in e&&n(6,x=e.onNext),"onReplace"in e&&n(18,j=e.onReplace),"onReplaceAll"in e&&n(19,C=e.onReplaceAll),"onClose"in e&&n(7,_=e.onClose);},e.$$.update=function(){65536&e.$$.dirty&&n(10,r=u>=1e3?"".concat(999,"+"):String(u)),131072&e.$$.dirty&&n(20,i=am(g,300)),1048832&e.$$.dirty&&i(O),2&e.$$.dirty&&a&&""!==O&&g(O);},[d,a,s,f,p,b,x,_,O,E,r,A,function(e){e.preventDefault(),O!==M?(M=O,i.cancel(),g(O)):x();},function(e){e.stopPropagation();var t=_C(e);"Enter"===t&&(e.preventDefault(),x()),"Shift+Enter"===t&&(e.preventDefault(),b()),"Ctrl+Enter"===t&&(e.preventDefault(),d?P():x()),"Ctrl+H"===t&&(e.preventDefault(),A()),"Escape"===t&&(e.preventDefault(),_());},P,function(){p||C(O,E);},u,g,j,C,i,function(){O=this.value,n(8,O);},function(){return x()},function(){return b()},function(){return _()},function(){E=this.value,n(9,E);}]}var lD=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,uD,sD,no,{show:1,searching:2,resultCount:16,activeIndex:3,showReplace:0,readOnly:4,onChange:17,onPrevious:5,onNext:6,onReplace:18,onReplaceAll:19,onClose:7},tD),r}return qi(n)}(),fD=Number.isNaN||function(e){return "number"==typeof e&&e!=e};function hD(e,t){if(e.length!==t.length)return !1;for(var n=0;n<e.length;n++)if(r=e[n],i=t[n],!(r===i||fD(r)&&fD(i)))return !1;var r,i;return !0}function dD(e,t){void 0===t&&(t=hD);var n=null;function r(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(n&&n.lastThis===this&&t(r,n.lastArgs))return n.lastResult;var o=e.apply(this,r);return n={lastResult:o,lastArgs:r,lastThis:this},o}return r.clear=function(){n=null;},r}var vD=Symbol("path");function pD(e,t,n){for(var r in e){var i=e[r],o=t[r]||(t[r]={});hu(i)&&n?pD(i,o,n):void 0===o[vD]&&(o[vD]=!0);}}function mD(e,t,n,r){for(var i in e){var o=t.concat(i),a=e[i];a&&!0===a[vD]&&n.push(o),Os(a)&&r&&mD(a,o,n,r);}}function gD(e,t,n,r){for(var i=bD(e,t).rowIndex,o=0,a=0;a<i;a++)o+=n[a]||r;return o}function yD(e,t){var n=Object.values(e);if(By(n))return t;var r=n.reduce((function(e,t){return e+t}));return r/n.length}function bD(e,t){var n,r=$i(n=e)||Hi(n)||Wi(n)||Ci(),i=r[0],o=r.slice(1),a=parseInt(i,10);return {rowIndex:isNaN(a)?-1:a,columnIndex:t.findIndex((function(e){return E_(o,e)}))}}function wD(e,t){var n=e.rowIndex,r=e.columnIndex;return [String(n)].concat(Vi(t[r]))}function xD(e,t){var n=Si(Ww(e,(function(e){return lu(e.path[0])})),2),r=n[0],i=n[1],o=kb(Ug(r,jD),(function(e){var n={row:[],columns:{}};return e.forEach((function(e){var r=function(e,t){var n=bD(e.path,t);if(-1!==n.columnIndex)return n.columnIndex;return -1}(e,t);-1!==r?(void 0===n.columns[r]&&(n.columns[r]=[]),n.columns[r].push(e)):n.row.push(e);})),n}));return {root:i,rows:o}}function kD(e,t){if(t&&0!==t.length)return 1===t.length?t[0]:{path:e,message:"Multiple validation issues: "+t.map((function(e){return FC(e.path)+" "+e.message})).join(", "),severity:us.warning}}function jD(e){return parseInt(e.path[0],10)}function SD(e,t,n){return t.some((function(t){return function(e,t,n){if(!e)return !1;if("replace"===t.op){var r=bD(Qs(t.path),n),i=r.rowIndex,o=r.columnIndex,a=n.findIndex((function(t){return zy(t,e.path)}));if(-1!==i&&-1!==o&&o!==a)return !1}return !0}(e.sortedColumn,t,n)}))?Oi(Oi({},e),{},{sortedColumn:void 0}):e}var CD=Ha("jsoneditor:actions");function $D(e){return _D.apply(this,arguments)}function _D(){return _D=ji(xi().mark((function e(t){var n,r,i,o,a,s,c,u,l,f;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.json,r=t.documentState,i=t.indentation,o=t.readOnly,a=t.parser,s=t.onPatch,!o&&void 0!==n&&r.selection&&z_(r.selection)){e.next=3;break}return e.abrupt("return");case 3:if(null!=(c=D_(n,r.selection,i,a))){e.next=6;break}return e.abrupt("return");case 6:return CD("cut",{selection:r.selection,clipboard:c,indentation:i}),e.next=9,BI(c);case 9:u=cO(n,r.selection),l=u.operations,f=u.newSelection,s(l,(function(e,t){return {state:Oi(Oi({},t),{},{selection:f})}}));case 11:case"end":return e.stop()}}),e)}))),_D.apply(this,arguments)}function OD(e){return MD.apply(this,arguments)}function MD(){return MD=ji(xi().mark((function e(t){var n,r,i,o,a;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.json,r=t.documentState,i=t.indentation,o=t.parser,null!=(a=D_(n,r.selection,i,o))){e.next=4;break}return e.abrupt("return");case 4:return CD("copy",{clipboard:a,indentation:i}),e.next=7,BI(a);case 7:case"end":return e.stop()}}),e)}))),MD.apply(this,arguments)}function ED(e){var t=e.clipboardText,n=e.json,r=e.documentState,i=e.readOnly,o=e.parser,a=e.onPatch,s=e.onChangeText,c=e.openRepairModal;if(!i)try{u(t);}catch(e){c(t,(function(e){CD("repaired pasted text: ",e),u(e);}));}function u(e){if(void 0!==n){var i=r.selection||I_(n||{},[],[]),c=iO(n,i,e,o);CD("paste",{pastedText:e,operations:c,selection:i}),a(c,(function(e,t){var r=t;return c.filter((function(e){return (Ms(e)||As(e))&&du(e.value)})).forEach((function(t){var i=lc(n,t.path);r=u_(e,r,i);})),{state:r}}));}else CD("paste text",{pastedText:e}),s(t,(function(e,t){if(e){return {state:u_(e,t,[])}}}));}}function AD(e){var t=e.json,n=e.text,r=e.documentState,i=e.keepSelection,o=e.readOnly,a=e.onChange,s=e.onPatch;if(!o&&r.selection){var c=void 0!==t&&(v_(r.selection)||p_(r.selection))?I_(t,r.selection.anchorPath,r.selection.focusPath):r.selection;if(By(r.selection.focusPath))CD("remove root",{selection:r.selection}),a&&a({text:"",json:void 0},void 0!==t?{text:n,json:t}:{text:n||"",json:t},{contentErrors:null,patchResult:null});else if(void 0!==t){var u=cO(t,c),l=u.operations,f=u.newSelection;CD("remove",{operations:l,selection:r.selection,newSelection:f}),s(l,(function(e,t){return {state:Oi(Oi({},t),{},{selection:i?r.selection:f})}}));}}}function PD(e){var t=e.json,n=e.documentState,r=e.columns,i=e.readOnly,o=e.onPatch;if(!i&&void 0!==t&&n.selection&&z_(n.selection)){var a=bD(n.selection.focusPath,r),s=a.rowIndex,c=a.columnIndex;CD("duplicate row",{rowIndex:s});var u=[String(s)];o(rO(t,[u]),(function(e,n){var i=T_(wD({rowIndex:s<t.length?s+1:s,columnIndex:c},r),!1);return {state:Oi(Oi({},n),{},{selection:i})}}));}}function TD(e){var t=e.json,n=e.documentState,r=e.columns,i=e.readOnly,o=e.onPatch;if(!i&&void 0!==t&&n.selection&&z_(n.selection)){var a=bD(n.selection.focusPath,r).rowIndex;CD("insert before row",{rowIndex:a}),o(eO(t,[String(a)],[{key:"",value:Os(t[0])?{}:""}]));}}function RD(e){var t=e.json,n=e.documentState,r=e.columns,i=e.readOnly,o=e.onPatch;if(!i&&void 0!==t&&n.selection&&z_(n.selection)){var a=bD(n.selection.focusPath,r),s=a.rowIndex,c=a.columnIndex;CD("insert after row",{rowIndex:s});var u=s+1,l=[String(u)],f=[{key:"",value:Os(t[0])?{}:""}];o(u<t.length?eO(t,l,f):tO(t,[],f),(function(e,t){var n=T_(wD({rowIndex:u,columnIndex:c},r),!1);return {state:Oi(Oi({},t),{},{selection:n})}}));}}function ND(e){var t=e.json,n=e.documentState,r=e.columns,i=e.readOnly,o=e.onPatch;if(!i&&void 0!==t&&n.selection&&z_(n.selection)){var a=bD(n.selection.focusPath,r),s=a.rowIndex,c=a.columnIndex;CD("remove row",{rowIndex:s}),o(oO([[String(s)]]),(function(e,t){var n=s<e.length?s:s>0?s-1:void 0,i=void 0!==n?T_(wD({rowIndex:n,columnIndex:c},r),!1):void 0;return CD("remove row new selection",{rowIndex:s,newRowIndex:n,newSelection:i}),{state:Oi(Oi({},t),{},{selection:i})}}));}}function ID(e){var t=e.insertType,n=e.selectInside,r=e.refJsonEditor,i=e.json,o=e.documentState,a=e.readOnly,s=e.parser,c=e.onPatch,u=e.onReplaceJson;if(!a&&o.selection){var l=function(e,t,n){if("object"===n)return {};if("array"===n)return [];if("structure"===n&&void 0!==e){var r=Vs(e,t?g_(t):[]);if(Array.isArray(r)&&!By(r)){var i=jg(r);return du(i)?up(i,(function(e){return Array.isArray(e)?[]:hu(e)?void 0:""})):""}}return ""}(i,o.selection,t);if(void 0!==i){var f=s.stringify(l),h=iO(i,o.selection,f,s);CD("onInsert",{insertType:t,operations:h,newValue:l,data:f});var d=Em(h.filter((function(e){return "add"===e.op||"replace"===e.op})));c(h,(function(e,t){if(d){var r=lc(e,d.path);if(du(l))return {state:Oi(Oi({},F$(e,t,r,f_)),{},{selection:n?R_(r):t.selection})};if(""===l){var i=By(r)?null:Vs(e,ly(r));return {state:q$(e,Oi(Oi({},o),{},{selection:hu(i)?P_(r,!0):T_(r,!0)}),r)}}}})),CD("after patch"),d&&""===l&&qD((function(){return bC(r,"",!0)}));}else {CD("onInsert",{insertType:t,newValue:l});var v=[];u(l,(function(e,t){return {state:Oi(Oi({},u_(e,t,v)),{},{selection:R_(v)})}}));}}}function DD(e){return LD.apply(this,arguments)}function LD(){return LD=ji(xi().mark((function e(t){var n,r,i,o,a,s,c,u,l,f,h,d;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.char,r=t.selectInside,i=t.refJsonEditor,o=t.json,a=t.documentState,s=t.readOnly,c=t.parser,u=t.onPatch,l=t.onReplaceJson,f=t.onSelect,!s&&a.selection){e.next=3;break}return e.abrupt("return");case 3:if(!v_(a.selection)){e.next=8;break}return h=!a.selection.edit,f(Oi(Oi({},a.selection),{},{edit:!0})),qD((function(){return bC(i,n,h)})),e.abrupt("return");case 8:if("{"!==n){e.next=12;break}ID({insertType:"object",selectInside:r,refJsonEditor:i,json:o,documentState:a,readOnly:s,parser:c,onPatch:u,onReplaceJson:l}),e.next=22;break;case 12:if("["!==n){e.next=16;break}ID({insertType:"array",selectInside:r,refJsonEditor:i,json:o,documentState:a,readOnly:s,parser:c,onPatch:u,onReplaceJson:l}),e.next=22;break;case 16:if(!p_(a.selection)||void 0===o){e.next=20;break}du(Vs(o,a.selection.focusPath))||(d=!a.selection.edit,f(Oi(Oi({},a.selection),{},{edit:!0})),qD((function(){return bC(i,n,d)}))),e.next=22;break;case 20:return e.next=22,BD({char:n,refJsonEditor:i,json:o,documentState:a,readOnly:s,parser:c,onPatch:u,onReplaceJson:l});case 22:case"end":return e.stop()}}),e)}))),LD.apply(this,arguments)}function BD(e){return zD.apply(this,arguments)}function zD(){return zD=ji(xi().mark((function e(t){var n,r,i,o,a,s,c,u,l;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.char,r=t.refJsonEditor,i=t.json,o=t.documentState,a=t.readOnly,s=t.parser,c=t.onPatch,u=t.onReplaceJson,!a&&o.selection){e.next=3;break}return e.abrupt("return");case 3:ID({insertType:"value",selectInside:!1,refJsonEditor:r,json:i,documentState:o,readOnly:a,parser:s,onPatch:c,onReplaceJson:u}),l=!B_(o.selection),qD((function(){return bC(r,n,l)}));case 6:case"end":return e.stop()}}),e)}))),zD.apply(this,arguments)}function qD(e){setTimeout((function(){return setTimeout(e)}));}function FD(e){bo(e,"svelte-1ch6ow4",".jse-json-preview.svelte-1ch6ow4{flex:1;color:var(--jse-panel-color-readonly);overflow:auto;white-space:pre-wrap;padding:2px;border-left:var(--jse-main-border);border-right:var(--jse-main-border);border-bottom:var(--jse-main-border)}");}function VD(e){var t,n,r=QC(JS({text:e[0],json:e[1]},e[2],e[3]),2e4)+"";return {c:function(){t=$o("div"),n=Oo(r),Ro(t,"class","jse-json-preview svelte-1ch6ow4");},m:function(e,r){jo(e,t,r),yo(t,n);},p:function(e,t){15&Si(t,1)[0]&&r!==(r=QC(JS({text:e[0],json:e[1]},e[2],e[3]),2e4)+"")&&Lo(n,r);},i:Ki,o:Ki,d:function(e){e&&So(t);}}}function WD(e,t,n){var r=t.text,i=t.json,o=t.indentation,a=t.parser;return e.$$set=function(e){"text"in e&&n(0,r=e.text),"json"in e&&n(1,i=e.json),"indentation"in e&&n(2,o=e.indentation),"parser"in e&&n(3,a=e.parser);},[r,i,o,a]}var HD=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,WD,VD,to,{text:0,json:1,indentation:2,parser:3},FD),r}return qi(n)}(),UD=Ea.window;function JD(e){bo(e,"svelte-1n5yill",".jse-tree-mode.svelte-1n5yill.svelte-1n5yill{flex:1;display:flex;flex-direction:column;position:relative;background:var(--jse-background-color);min-width:0;min-height:0;font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);color:var(--jse-text-color);line-height:var(--jse-line-height)}.jse-tree-mode.svelte-1n5yill .jse-hidden-input-label .jse-hidden-input.svelte-1n5yill{position:fixed;top:-10px;left:-10px;width:1px;height:1px;padding:0;border:0;outline:none}.jse-tree-mode.svelte-1n5yill .jse-search-box-container.svelte-1n5yill{position:relative;height:0;top:var(--jse-padding);margin-right:calc(var(--jse-padding) + 20px);margin-left:var(--jse-padding);text-align:right;z-index:3}.jse-tree-mode.no-main-menu.svelte-1n5yill.svelte-1n5yill{border-top:var(--jse-main-border)}.jse-tree-mode.svelte-1n5yill .jse-contents.svelte-1n5yill{border-left:var(--jse-main-border);border-right:var(--jse-main-border);flex:1;overflow:auto;position:relative;padding:2px;display:flex;flex-direction:column}.jse-tree-mode.svelte-1n5yill .jse-contents.svelte-1n5yill:last-child{border-bottom:var(--jse-main-border)}.jse-tree-mode.svelte-1n5yill .jse-contents .jse-loading-space.svelte-1n5yill{flex:1}.jse-tree-mode.svelte-1n5yill .jse-contents .jse-loading.svelte-1n5yill{flex:2;text-align:center;color:var(--jse-panel-color-readonly);box-sizing:border-box;font-family:var(--jse-font-family);font-size:var(--jse-font-size)}");}function KD(e){var t,n,r;function i(t){e[75](t);}var o={json:e[10],selection:e[16].selection,readOnly:e[0],historyState:e[22],onExpandAll:e[39],onCollapseAll:e[40],onUndo:e[35],onRedo:e[36],onSort:e[37],onTransform:e[38],onContextMenu:e[44],onCopy:e[33],onRenderMenu:e[7]};return void 0!==e[19]&&(o.showSearch=e[19]),t=new fI({props:o}),sa.push((function(){return Ia(t,"showSearch",i)})),{c:function(){Da(t.$$.fragment);},m:function(e,n){La(t,e,n),r=!0;},p:function(e,r){var i={};1024&r[0]&&(i.json=e[10]),65536&r[0]&&(i.selection=e[16].selection),1&r[0]&&(i.readOnly=e[0]),4194304&r[0]&&(i.historyState=e[22]),128&r[0]&&(i.onRenderMenu=e[7]),!n&&524288&r[0]&&(n=!0,i.showSearch=e[19],pa((function(){return n=!1}))),t.$set(i);},i:function(e){r||($a(t.$$.fragment,e),r=!0);},o:function(e){_a(t.$$.fragment,e),r=!1;},d:function(e){Ba(t,e);}}}function GD(e){var t,n;return t=new eD({props:{json:e[10],documentState:e[16],onSelect:e[48],onError:e[6],pathParser:e[4]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1024&n[0]&&(r.json=e[10]),65536&n[0]&&(r.documentState=e[16]),64&n[0]&&(r.onError=e[6]),16&n[0]&&(r.pathParser=e[4]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function QD(e){var t;return {c:function(){(t=$o("div")).innerHTML='<div class="jse-loading-space svelte-1n5yill"></div> \n      <div class="jse-loading svelte-1n5yill">loading...</div>',Ro(t,"class","jse-contents svelte-1n5yill");},m:function(e,n){jo(e,t,n);},p:Ki,i:Ki,o:Ki,d:function(e){e&&So(t);}}}function YD(e){var t,n,r,i,o,a,s,c,u,l=[ZD,XD],f=[];function h(e,t){return void 0===e[10]?0:1}return i=h(e),o=f[i]=l[i](e),{c:function(){t=$o("label"),n=$o("input"),r=Mo(),o.c(),a=Eo(),Ro(n,"type","text"),n.readOnly="readonly",Ro(n,"tabindex","-1"),Ro(n,"class","jse-hidden-input svelte-1n5yill"),Ro(t,"class","jse-hidden-input-label");},m:function(o,l){jo(o,t,l),yo(t,n),e[76](n),jo(o,r,l),f[i].m(o,l),jo(o,a,l),s=!0,c||(u=Ao(n,"paste",e[34]),c=!0);},p:function(e,t){var n=i;(i=h(e))===n?f[i].p(e,t):(Sa(),_a(f[n],1,1,(function(){f[n]=null;})),Ca(),(o=f[i])?o.p(e,t):(o=f[i]=l[i](e)).c(),$a(o,1),o.m(a.parentNode,a));},i:function(e){s||($a(o),s=!0);},o:function(e){_a(o),s=!1;},d:function(n){n&&So(t),e[76](null),n&&So(r),f[i].d(n),n&&So(a),c=!1,u();}}}function XD(e){var t,n,r,i,o,a,s,c,u,l,f,h,d,v;a=new lD({props:{show:e[19],resultCount:(null===(t=e[17])||void 0===t||null===(n=t.items)||void 0===n?void 0:n.length)||0,activeIndex:(null===(r=e[17])||void 0===r?void 0:r.activeIndex)||0,showReplace:e[20],searching:e[21],readOnly:e[0],onChange:e[26],onNext:e[27],onPrevious:e[28],onReplace:e[29],onReplaceAll:e[30],onClose:e[31]}}),u=new iI({props:{value:e[10],path:[],expandedMap:e[16].expandedMap,enforceStringMap:e[16].enforceStringMap,visibleSectionsMap:e[16].visibleSectionsMap,validationErrorsMap:e[24],searchResultItemsMap:null===(i=e[17])||void 0===i?void 0:i.itemsMap,selection:e[16].selection,context:e[13],onDragSelectionStart:Tl}});var p=e[18]&&eL(e),m=e[23]&&tL(e);return d=new IP({props:{validationErrors:e[12],selectError:e[32]}}),{c:function(){o=$o("div"),Da(a.$$.fragment),s=Mo(),c=$o("div"),Da(u.$$.fragment),l=Mo(),p&&p.c(),f=Mo(),m&&m.c(),h=Mo(),Da(d.$$.fragment),Ro(o,"class","jse-search-box-container svelte-1n5yill"),Ro(c,"class","jse-contents svelte-1n5yill"),Ro(c,"data-jsoneditor-scrollable-contents",!0);},m:function(t,n){jo(t,o,n),La(a,o,null),jo(t,s,n),jo(t,c,n),La(u,c,null),e[77](c),jo(t,l,n),p&&p.m(t,n),jo(t,f,n),m&&m.m(t,n),jo(t,h,n),La(d,t,n),v=!0;},p:function(e,t){var n,r,i,o,s={};524288&t[0]&&(s.show=e[19]),131072&t[0]&&(s.resultCount=(null===(n=e[17])||void 0===n||null===(r=n.items)||void 0===r?void 0:r.length)||0),131072&t[0]&&(s.activeIndex=(null===(i=e[17])||void 0===i?void 0:i.activeIndex)||0),1048576&t[0]&&(s.showReplace=e[20]),2097152&t[0]&&(s.searching=e[21]),1&t[0]&&(s.readOnly=e[0]),a.$set(s);var c={};1024&t[0]&&(c.value=e[10]),65536&t[0]&&(c.expandedMap=e[16].expandedMap),65536&t[0]&&(c.enforceStringMap=e[16].enforceStringMap),65536&t[0]&&(c.visibleSectionsMap=e[16].visibleSectionsMap),16777216&t[0]&&(c.validationErrorsMap=e[24]),131072&t[0]&&(c.searchResultItemsMap=null===(o=e[17])||void 0===o?void 0:o.itemsMap),65536&t[0]&&(c.selection=e[16].selection),8192&t[0]&&(c.context=e[13]),u.$set(c),e[18]?p?(p.p(e,t),262144&t[0]&&$a(p,1)):((p=eL(e)).c(),$a(p,1),p.m(f.parentNode,f)):p&&(Sa(),_a(p,1,1,(function(){p=null;})),Ca()),e[23]?m?(m.p(e,t),8388608&t[0]&&$a(m,1)):((m=tL(e)).c(),$a(m,1),m.m(h.parentNode,h)):m&&(Sa(),_a(m,1,1,(function(){m=null;})),Ca());var l={};4096&t[0]&&(l.validationErrors=e[12]),d.$set(l);},i:function(e){v||($a(a.$$.fragment,e),$a(u.$$.fragment,e),$a(p),$a(m),$a(d.$$.fragment,e),v=!0);},o:function(e){_a(a.$$.fragment,e),_a(u.$$.fragment,e),_a(p),_a(m),_a(d.$$.fragment,e),v=!1;},d:function(t){t&&So(o),Ba(a),t&&So(s),t&&So(c),Ba(u),e[77](null),t&&So(l),p&&p.d(t),t&&So(f),m&&m.d(t),t&&So(h),Ba(d,t);}}}function ZD(e){var t,n,r,i,o=[rL,nL],a=[];function s(e,t){return ""===e[11]||void 0===e[11]?0:1}return t=s(e),n=a[t]=o[t](e),{c:function(){n.c(),r=Eo();},m:function(e,n){a[t].m(e,n),jo(e,r,n),i=!0;},p:function(e,i){var c=t;(t=s(e))===c?a[t].p(e,i):(Sa(),_a(a[c],1,1,(function(){a[c]=null;})),Ca(),(n=a[t])?n.p(e,i):(n=a[t]=o[t](e)).c(),$a(n,1),n.m(r.parentNode,r));},i:function(e){i||($a(n),i=!0);},o:function(e){_a(n),i=!1;},d:function(e){a[t].d(e),e&&So(r);}}}function eL(e){var t,n;return t=new CP({props:{type:"info",message:"You pasted a JSON ".concat(Array.isArray(e[18].contents)?"array":"object"," as text"),actions:[{icon:aM,text:"Paste as JSON instead",onMouseDown:e[45]},{text:"Leave as is",onClick:e[46]}]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};262144&n[0]&&(r.message="You pasted a JSON ".concat(Array.isArray(e[18].contents)?"array":"object"," as text")),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function tL(e){var t,n;return t=new CP({props:{type:"success",message:"The loaded JSON document was invalid but is successfully repaired.",actions:e[0]?[]:[{icon:OM,text:"Ok",onClick:e[8]},{icon:oM,text:"Repair manually instead",onClick:e[47]}]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n[0]&&(r.actions=e[0]?[]:[{icon:OM,text:"Ok",onClick:e[8]},{icon:oM,text:"Repair manually instead",onClick:e[47]}]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function nL(e){var t,n,r,i;return t=new CP({props:{type:"error",message:"The loaded JSON document is invalid and could not be repaired automatically.",actions:e[0]?[]:[{icon:oM,text:"Repair manually",onClick:e[47]}]}}),r=new HD({props:{text:e[11],json:e[10],indentation:e[5],parser:e[3]}}),{c:function(){Da(t.$$.fragment),n=Mo(),Da(r.$$.fragment);},m:function(e,o){La(t,e,o),jo(e,n,o),La(r,e,o),i=!0;},p:function(e,n){var i={};1&n[0]&&(i.actions=e[0]?[]:[{icon:oM,text:"Repair manually",onClick:e[47]}]),t.$set(i);var o={};2048&n[0]&&(o.text=e[11]),1024&n[0]&&(o.json=e[10]),32&n[0]&&(o.indentation=e[5]),8&n[0]&&(o.parser=e[3]),r.$set(o);},i:function(e){i||($a(t.$$.fragment,e),$a(r.$$.fragment,e),i=!0);},o:function(e){_a(t.$$.fragment,e),_a(r.$$.fragment,e),i=!1;},d:function(e){Ba(t,e),e&&So(n),Ba(r,e);}}}function rL(e){var t,n;return t=new mI({props:{readOnly:e[0]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n[0]&&(r.readOnly=e[0]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function iL(e){var t,n,r,i,o,a,s,c,u=e[1]&&KD(e),l=e[2]&&GD(e),f=[YD,QD],h=[];return i=function(e,t){return e[25]?1:0}(e),o=h[i]=f[i](e),{c:function(){t=$o("div"),u&&u.c(),n=Mo(),l&&l.c(),r=Mo(),o.c(),Ro(t,"class","jse-tree-mode svelte-1n5yill"),Fo(t,"no-main-menu",!e[1]);},m:function(o,f){jo(o,t,f),u&&u.m(t,null),yo(t,n),l&&l.m(t,null),yo(t,r),h[i].m(t,null),e[78](t),a=!0,s||(c=[Ao(UD,"mousedown",e[49]),Ao(t,"keydown",e[41]),Ao(t,"mousedown",e[42]),Ao(t,"contextmenu",e[43])],s=!0);},p:function(e,i){e[1]?u?(u.p(e,i),2&i[0]&&$a(u,1)):((u=KD(e)).c(),$a(u,1),u.m(t,n)):u&&(Sa(),_a(u,1,1,(function(){u=null;})),Ca()),e[2]?l?(l.p(e,i),4&i[0]&&$a(l,1)):((l=GD(e)).c(),$a(l,1),l.m(t,r)):l&&(Sa(),_a(l,1,1,(function(){l=null;})),Ca()),o.p(e,i),(!a||2&i[0])&&Fo(t,"no-main-menu",!e[1]);},i:function(e){a||($a(u),$a(l),$a(o),a=!0);},o:function(e){_a(u),_a(l),_a(o),a=!1;},d:function(n){n&&So(t),u&&u.d(),l&&l.d(),h[i].d(),e[78](null),s=!1,Zi(c);}}}function oL(e,t,n){var r,i=Ha("jsoneditor:TreeMode"),o="undefined"==typeof window;i("isSSR:",o);var a,s,c,u,l,f=ia("simple-modal").open,h=Oj(),d=Oj(),v=ia("absolute-popup"),p=v.openAbsolutePopup,m=v.closeAbsolutePopup,g=!1,y=uP(),b=t.readOnly,w=t.externalContent,x=t.mainMenuBar,k=t.navigationBar,j=t.escapeControlCharacters,S=t.escapeUnicodeCharacters,C=t.parser,$=t.parseMemoizeOne,_=t.validator,O=t.validationParser,M=t.pathParser,E=t.indentation,A=t.onError,P=t.onChange,T=t.onChangeMode,R=t.onRenderValue,N=t.onRenderMenu,I=t.onClassName,D=t.onFocus,L=t.onBlur,B=t.onSortModal,z=t.onTransformModal,q=t.onJSONEditorModal,F=!1;gP({onMount:ea,onDestroy:ta,getWindow:function(){return wC(c)},hasFocus:function(){return F&&document.hasFocus()||xC(c)},onFocus:function(){g=!0,D&&D();},onBlur:function(){g=!1,L&&L();}});var V=void 0;function W(e){i("updateSelection",e);var t="function"==typeof e?e(G.selection):e;zy(t,G.selection)||n(16,G=Oi(Oi({},G),{},{selection:t}));}var H,U,J,K=!1,G=L$(),Q=!1,Y=!1,X=!1,Z="";function ee(e){return te.apply(this,arguments)}function te(){return te=ji(xi().mark((function e(t){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i("search text updated",t),n(74,Z=t),e.next=4,da();case 4:return e.next=6,ae();case 6:case"end":return e.stop()}}),e)}))),te.apply(this,arguments)}function ne(){return (ne=ji(xi().mark((function e(){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(17,H=H?fO(H):void 0),e.next=3,ae();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(){return (re=ji(xi().mark((function e(){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(17,H=H?hO(H):void 0),e.next=3,ae();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(){return (ie=ji(xi().mark((function e(t,n){var r,o,a,s,c;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=null===(r=H)||void 0===r?void 0:r.activeItem,i("handleReplace",{replacementText:n,activeItem:o}),o){e.next=4;break}return e.abrupt("return");case 4:return a=gO(u,G,n,o,C),s=a.operations,c=a.newSelection,tt(s,(function(e,t){return {state:Oi(Oi({},t),{},{selection:c})}})),e.next=8,da();case 8:return e.next=10,ae();case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(){return oe=ji(xi().mark((function e(t,n){var r,o,a;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i("handleReplaceAll",{text:t,replacementText:n}),r=yO(u,G,t,n,C),o=r.operations,a=r.newSelection,tt(o,(function(e,t){return {state:Oi(Oi({},t),{},{selection:a})}})),e.next=5,da();case 5:return e.next=7,ae();case 7:case"end":return e.stop()}}),e)}))),oe.apply(this,arguments)}function ae(){return se.apply(this,arguments)}function se(){return (se=ji(xi().mark((function e(){var t,r,o;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null===(t=H)||void 0===t?void 0:t.activeItem,i("focusActiveSearchResult",H),!r){e.next=9;break}return o=r.path,n(16,G=Oi(Oi({},q$(u,G,o)),{},{selection:void 0})),e.next=7,da();case 7:return e.next=9,Qe(o);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ce=fP({onChange:function(e){n(22,ue=e);}}),ue=ce.getState();var le,fe,he=Uk((function(e,t){if(""===e)return i("clearing search result"),void(void 0!==H&&n(17,H=void 0));n(21,X=!0),setTimeout((function(){i("searching...",e);var r=dO(e,t,1e3);n(17,H=function(e,t,n){var r=null!=n&&n.activeItem?bO(n.activeItem):void 0,i=t.findIndex((function(e){return zy(r,bO(e))})),o=-1!==i?i:void 0!==(null==n?void 0:n.activeIndex)&&(null==n?void 0:n.activeIndex)<t.length?null==n?void 0:n.activeIndex:t.length>0?0:-1,a=t.map((function(e,t){return Oi(Oi({},e),{},{active:t===o})})),s=a[o];return {items:a,itemsMap:Ug(a,(function(e){return Ys(e.path)})),activeItem:s,activeIndex:o}}(0,r,H)),n(21,X=!1);}));}),300),de=!1,ve=[],pe=dD(vP);function me(e,t,r,o){hP((function(){var a;try{a=pe(e,t,r,o);}catch(e){a=[{path:[],message:"Failed to validate: "+e.message,severity:us.warning}];}zy(a,ve)||(i("validationErrors changed:",a),n(12,ve=a));}),(function(e){return i("validationErrors updated in ".concat(e," ms"))}));}function ge(){return i("validate"),V?{parseError:V,isRepairable:!1}:(me(u,_,C,O),By(ve)?null:{validationErrors:ve})}function ye(){return u}function be(){return G}function we(e){void 0!==e.json&&function(e){if(void 0===e)return;var t=!zy(u,e);if(i("update external json",{isChanged:t,currentlyText:void 0===u}),!t)return;var r={json:u,text:l},o=G,a=u,s=l,c=de;n(10,u=e),xe(u),n(11,l=void 0),n(23,de=!1),V=void 0,ke(u),je({previousJson:a,previousState:o,previousText:s,previousTextIsRepaired:c}),et(r,null);}(e.json),void 0!==e.text&&function(e){if(void 0===e||void 0!==w.json)return;var t=e!==l;if(i("update external text",{isChanged:t}),!t)return;var r={json:u,text:l},o=u,a=G,s=l,c=de;try{n(10,u=$(e)),xe(u),n(11,l=e),n(23,de=!1),V=void 0;}catch(t){try{n(10,u=$(su(e))),xe(u),n(11,l=e),n(23,de=!0),V=void 0,ke(u);}catch(e){n(10,u=void 0),n(11,l=w.text),n(23,de=!1),V=void 0!==l&&""!==l?zS(l,t.message||t.toString()):void 0;}}ke(u),je({previousJson:o,previousState:a,previousText:s,previousTextIsRepaired:c}),et(r,null);}(e.text);}function xe(e){K||(K=!0,n(16,G=F$(e,G,[],function(e){return KS({json:e},10240)?l_:f_}(e))));}function ke(e){void 0!==G.selection&&(G.selection&&Gs(e,G.selection.anchorPath)&&Gs(e,G.selection.focusPath)||(i("clearing selection: path does not exist anymore",G.selection),n(16,G=Oi(Oi({},G),{},{selection:S_(e,G)}))));}function je(e){var t=e.previousJson,n=e.previousState,r=e.previousText,i=e.previousTextIsRepaired;void 0===t&&void 0===r||(void 0!==u?void 0!==t?ce.add({undo:{patch:[{op:"replace",path:"",value:t}],state:A_(n),json:void 0,text:r,textIsRepaired:i},redo:{patch:[{op:"replace",path:"",value:u}],state:A_(G),json:void 0,text:l,textIsRepaired:de}}):ce.add({undo:{patch:void 0,json:void 0,text:r,state:A_(n),textIsRepaired:i},redo:{patch:void 0,json:u,state:A_(G),text:l,textIsRepaired:de}}):void 0!==t&&ce.add({undo:{patch:void 0,json:t,state:A_(n),text:r,textIsRepaired:i},redo:{patch:void 0,json:void 0,text:l,textIsRepaired:de,state:A_(G)}}));}function Se(e,t){if(i("patch",e,t),void 0===u)throw new Error("Cannot apply patch: no JSON");var r={json:u,text:l},o=u,a=G,s=l,c=de,f=uO(u,e),h=U$(u,G,e),d=C_(u,e),v=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return void 0!==t||n?Oi(Oi({},e),{},{selection:t}):e}(h.documentState,d,!1);i("patch updatedSelection",d);var p="function"==typeof t?t(h.json,v):void 0;n(10,u=p&&void 0!==p.json?p.json:h.json);var m=p&&void 0!==p.state?p.state:v;n(16,G=m),n(11,l=void 0),n(23,de=!1),n(18,J=void 0),V=void 0,ke(u),ce.add({undo:{patch:f,json:void 0,text:s,state:A_(a),textIsRepaired:c},redo:{patch:e,json:void 0,state:A_(m),text:l,textIsRepaired:de}});var g={json:u,previousJson:o,undo:f,redo:e};return et(r,g),g}function Ce(){!b&&G.selection&&W(P_(G.selection.focusPath,!0));}function $e(){if(!b&&G.selection){var e=G.selection.focusPath,t=Vs(u,e);du(t)?function(e,t){i("openJSONEditorModal",{path:e,value:t}),F=!0,q({content:{json:t},path:e,onPatch:fe.onPatch,onClose:function(){F=!1,ft();}});}(e,t):W(T_(e,!0));}}function _e(){if(!b&&p_(G.selection)){var e=G.selection.focusPath,t=Ys(e),n=Vs(u,e),r=!r_(n,G.enforceStringMap,t,C),o=r?String(n):bu(String(n),C);i("handleToggleEnforceString",{enforceString:r,value:n,updatedValue:o}),tt([{op:"replace",path:t,value:o}],(function(e,n){return {state:H$(n,t,r)}}));}}function Oe(){return Me.apply(this,arguments)}function Me(){return Me=ji(xi().mark((function e(){var t,n=arguments;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(n.length>0&&void 0!==n[0])||n[0],e.next=3,$D({json:u,documentState:G,indentation:t?E:void 0,readOnly:b,parser:C,onPatch:tt});case 3:case"end":return e.stop()}}),e)}))),Me.apply(this,arguments)}function Ee(){return Ae.apply(this,arguments)}function Ae(){return Ae=ji(xi().mark((function e(){var t,n=arguments;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(n.length>0&&void 0!==n[0])||n[0],void 0!==u){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,OD({json:u,documentState:G,indentation:t?E:void 0,parser:C});case 5:case"end":return e.stop()}}),e)}))),Ae.apply(this,arguments)}function Pe(){f(HP,{},Oi(Oi({},vs),{},{styleWindow:{width:"450px"}}),{onClose:function(){return ft()}});}function Te(e,t){f(OT,{text:e,onParse:DS,onRepair:LS,onApply:t},Oi(Oi({},vs),{},{styleWindow:{width:"600px",height:"500px"},styleContent:{padding:0,height:"100%"}}),{onClose:function(){return ft()}});}function Re(){AD({json:u,text:l,documentState:G,keepSelection:!1,readOnly:b,onChange:P,onPatch:tt});}function Ne(){!b&&void 0!==u&&G.selection&&z_(G.selection)&&!By(G.selection.focusPath)&&(i("duplicate",{selection:G.selection}),tt(rO(u,L_(G.selection))));}function Ie(){if(!b&&G.selection&&(m_(G.selection)||p_(G.selection))&&!By(G.selection.focusPath)){i("extract",{selection:G.selection});var e=function(e,t){if(p_(t))return [{op:"move",from:Ys(t.focusPath),path:""}];if(!m_(t))throw new Error("Cannot create extract operations: parent must be an Object or Array");var n=Vs(e,ly(t.focusPath));if(_s(n))return [{op:"replace",path:"",value:t.paths.map((function(e){var t=uu(Em(e));return n[t]}))}];if(Os(n)){var r={};return t.paths.forEach((function(e){var t=String(Em(e));r[t]=n[t];})),[{op:"replace",path:"",value:r}]}throw new Error("Cannot extract: unsupported type of selection "+JSON.stringify(t))}(u,G.selection);tt(e,(function(e,t){if(du(e)){return {state:u_(e,t,[])}}}));}}function De(e){void 0!==u&&ID({insertType:e,selectInside:!0,refJsonEditor:c,json:u,documentState:G,readOnly:b,parser:C,onPatch:tt,onReplaceJson:nt});}function Le(e){v_(G.selection)&&W(T_(G.selection.focusPath,!1)),De(e);}function Be(e){if(!b&&G.selection)if(q_(G.selection))try{var t=G.selection.anchorPath,n=Vs(u,t),r=function(e,t,n){if("array"===t){if(Array.isArray(e))return e;if(hu(e))return PS(e);if("string"==typeof e)try{var r=n.parse(e);if(Array.isArray(r))return r;if(hu(r))return PS(r)}catch(t){return [e]}return [e]}if("object"===t){if(Array.isArray(e))return AS(e);if(hu(e))return e;if("string"==typeof e)try{var i=n.parse(e);if(hu(i))return i;if(Array.isArray(i))return AS(i)}catch(t){return {value:e}}return {value:e}}if("value"===t)return du(e)?n.stringify(e):e;throw new Error("Cannot convert ".concat(mu(e,n)," to ").concat(t))}(n,e,C);if(r===n)return;var o=[{op:"replace",path:Ys(t),value:r}];i("handleConvert",{selection:G.selection,path:t,type:e,operations:o}),tt(o,(function(e,t){return {state:u_(e,t,G.selection.focusPath)}}));}catch(e){A(e);}else A(new Error("Cannot convert current selection to ".concat(e)));}function ze(){var e=k_(u,G,!1),t=ly(G.selection.focusPath);!By(e.focusPath)&&zy(t,ly(e.focusPath))?W(N_(e.focusPath)):W(R_(t)),i("insert before",{selection:G.selection,selectionBefore:e,parentPath:t}),da().then(ut);}function qe(){var e=m_(G.selection)?Em(G.selection.paths):G.selection.focusPath;i("insert after",e),W(N_(e)),da().then(ut);}function Fe(e){return Ve.apply(this,arguments)}function Ve(){return (Ve=ji(xi().mark((function e(t){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,DD({char:t,selectInside:!0,refJsonEditor:c,json:u,documentState:G,readOnly:b,parser:C,onPatch:tt,onReplaceJson:nt,onSelect:W});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function We(){if(!b&&ce.getState().canUndo){var e=ce.undo();if(e){var t={json:u,text:l};n(10,u=e.undo.patch?tc(u,e.undo.patch):e.undo.json),n(16,G=e.undo.state),n(11,l=e.undo.text),n(23,de=e.undo.textIsRepaired),V=void 0,i("undo",{item:e,json:u,documentState:G}),et(t,{json:u,previousJson:t.json,redo:e.undo.patch,undo:e.redo.patch}),ft(),G.selection&&Qe(G.selection.focusPath,!1);}}}function He(){if(!b&&ce.getState().canRedo){var e=ce.redo();if(e){var t={json:u,text:l};n(10,u=e.redo.patch?tc(u,e.redo.patch):e.redo.json),n(16,G=e.redo.state),n(11,l=e.redo.text),n(23,de=e.redo.textIsRepaired),V=void 0,i("redo",{item:e,json:u,documentState:G}),et(t,{json:u,previousJson:t.json,redo:e.redo.patch,undo:e.undo.patch}),ft(),G.selection&&Qe(G.selection.focusPath,!1);}}}function Ue(e){var t;b||void 0===u||(F=!0,B({id:h,json:u,rootPath:e,onSort:(t=ji(xi().mark((function t(n){var r;return xi().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.operations,i("onSort",e,r),tt(r,(function(t,n){return {state:Oi(Oi({},u_(t,n,e)),{},{selection:T_(e,!1)})}}));case 3:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)}),onClose:function(){F=!1,ft();}}));}function Je(){G.selection&&Ue(M_(u,G.selection));}function Ke(e){if(void 0!==u){var t=e.id,n=e.onTransform,r=e.onClose,o=e.rootPath||[];F=!0,z({id:t||d,json:u,rootPath:o,onTransform:function(e){n?n({operations:e,json:u,transformedJson:tc(u,e)}):(i("onTransform",o,e),tt(e,(function(e,t){return {state:Oi(Oi({},u_(e,t,o)),{},{selection:T_(o,!1)})}})));},onClose:function(){F=!1,ft(),r&&r();}});}}function Ge(){G.selection&&Ke({rootPath:M_(u,G.selection)});}function Qe(e){return Ye.apply(this,arguments)}function Ye(){return Ye=ji(xi().mark((function e(t){var r,o,s,c,l,f=arguments;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(f.length>1&&void 0!==f[1])||f[1],n(16,G=q$(u,G,ly(t))),e.next=4,da();case 4:if(!(o=Xe(t))){e.next=16;break}if(i("scrollTo",{path:t,elem:o,refContents:a}),s=a.getBoundingClientRect(),c=o.getBoundingClientRect(),r){e.next=12;break}if(!(c.bottom>s.top&&c.top<s.bottom)){e.next=12;break}return e.abrupt("return",Promise.resolve());case 12:return l=-s.height/4,e.abrupt("return",new Promise((function(e){y(o,{container:a,offset:l,duration:300,callback:function(){return e()}});})));case 16:return e.abrupt("return",Promise.resolve());case 17:case"end":return e.stop()}}),e)}))),Ye.apply(this,arguments)}function Xe(e){return a?a.querySelector('div[data-path="'.concat(SC(e),'"]')):null}function Ze(e){var t=Xe(e);if(t&&a){var n=a.getBoundingClientRect(),r=t.getBoundingClientRect(),i=du(Vs(u,e))?20:r.height;r.top<n.top+20?y(t,{container:a,offset:-20,duration:0}):r.top+i>n.bottom-20&&y(t,{container:a,offset:-(n.height-i-20),duration:0});}}function et(e,t){if(void 0!==e.json||void 0!==(null==e?void 0:e.text))if(void 0!==l)P({text:l,json:void 0},e,{contentErrors:ge(),patchResult:t});else if(void 0!==u){P({text:void 0,json:u},e,{contentErrors:ge(),patchResult:t});}}function tt(e,t){if(!b)return i("handlePatch",e,t),Se(e,t)}function nt(e,t){var r=G,i=u,o=l,a={json:u,text:l},s=de,c=F$(u,G,[],l_),f="function"==typeof t?t(e,c):void 0;n(10,u=f&&void 0!==f.json?f.json:e),n(16,G=f&&void 0!==f.state?f.state:c),n(11,l=void 0),n(23,de=!1),V=void 0,ke(u),je({previousJson:i,previousState:r,previousText:o,previousTextIsRepaired:s});et(a,null);}function rt(e,t){i("handleChangeText");var r=G,o=u,a=l,s={json:u,text:l},c=de;try{n(10,u=$(e)),n(16,G=F$(u,G,[],l_)),n(11,l=void 0),n(23,de=!1),V=void 0;}catch(t){try{n(10,u=$(su(e))),n(16,G=F$(u,G,[],l_)),n(11,l=e),n(23,de=!0),V=void 0;}catch(r){n(10,u=void 0),n(16,G=L$({json:u,expand:l_})),n(11,l=e),n(23,de=!1),V=""!==l?zS(l,t.message||t.toString()):void 0;}}if("function"==typeof t){var f=t(u,G);n(10,u=f&&f.json?f.json:u),n(16,G=f&&f.state?f.state:G);}ke(u),je({previousJson:o,previousState:r,previousText:a,previousTextIsRepaired:c});et(s,null);}function it(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i("expand",{path:e,expanded:t,recursive:r}),n(16,G=t?r?F$(u,G,e,f_):V$(G,e):W$(G,e)),G.selection&&!t&&w_(G.selection,e)&&W(void 0),setTimeout((function(){xC(c)||ft();}));}function ot(e){i("openFind",{findAndReplace:e}),n(19,Q=!1),n(20,Y=!1),da().then((function(){n(19,Q=!0),n(20,Y=e);}));}function at(e,t){i("handleExpandSection",e,t);var r=Ys(e);n(16,G=function(e,t,n,r){return Oi(Oi({},t),{},{visibleSectionsMap:Oi(Oi({},t.visibleSectionsMap),{},Mi({},n,R$(B$(t,n).concat(r))))})}(0,G,r,t));}function st(e){i("pasted json as text",e),n(18,J=e);}function ct(e){var t=e.anchor,n=e.left,r=e.top,i=e.width,o=e.height,a=e.offsetTop,s=e.offsetLeft,c=e.showTip;F=!0;var l=p(CR,{json:u,documentState:G,parser:C,showTip:c,onEditKey:Ce,onEditValue:$e,onToggleEnforceString:_e,onCut:Oe,onCopy:Ee,onPaste:Pe,onRemove:Re,onDuplicate:Ne,onExtract:Ie,onInsertBefore:ze,onInsert:Le,onConvert:Be,onInsertAfter:qe,onSort:Je,onTransform:Ge,onCloseContextMenu:function(){m(l),ft();}},{left:n,top:r,offsetTop:a,offsetLeft:s,width:i,height:o,anchor:t,closeOnOuterClick:!0,onClose:function(){F=!1,ft();}});}function ut(e){if(!b&&!B_(G.selection)){if(e&&(e.stopPropagation(),e.preventDefault()),e&&"contextmenu"===e.type&&e.target!==s)ct({left:e.clientX,top:e.clientY,width:260,height:336,showTip:!1});else {var t,n=null===(t=a)||void 0===t?void 0:t.querySelector(".jse-context-menu-pointer.jse-selected");if(n)ct({anchor:n,offsetTop:2,width:260,height:336,showTip:!1});else {var r,i=null===(r=a)||void 0===r?void 0:r.getBoundingClientRect();i&&ct({top:i.top+2,left:i.left+2,width:260,height:336,showTip:!1});}}return !1}}function lt(){return (lt=ji(xi().mark((function e(){var t,n,r;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i("apply pasted json",J),n=(t=J).path,r=t.contents,W(T_(n,!1)),e.next=5,da();case 5:tt([{op:"replace",path:Ys(n),value:r}],(function(e,t){return {state:u_(e,t,n)}}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ft(){i("focus"),s&&(s.focus(),s.select());}function ht(e){return function(e,t,n){var r=ly(n),i=[Em(n)],o=Vs(e,r),a=o?c_(o,t,i):void 0;return a?T_(r.concat(a),!1):N_(n)}(u,G,e)}function dt(e){r&&r.onDrag(e);}function vt(){r&&r.onDragEnd();}return e.$$set=function(e){"readOnly"in e&&n(0,b=e.readOnly),"externalContent"in e&&n(50,w=e.externalContent),"mainMenuBar"in e&&n(1,x=e.mainMenuBar),"navigationBar"in e&&n(2,k=e.navigationBar),"escapeControlCharacters"in e&&n(51,j=e.escapeControlCharacters),"escapeUnicodeCharacters"in e&&n(52,S=e.escapeUnicodeCharacters),"parser"in e&&n(3,C=e.parser),"parseMemoizeOne"in e&&n(53,$=e.parseMemoizeOne),"validator"in e&&n(54,_=e.validator),"validationParser"in e&&n(55,O=e.validationParser),"pathParser"in e&&n(4,M=e.pathParser),"indentation"in e&&n(5,E=e.indentation),"onError"in e&&n(6,A=e.onError),"onChange"in e&&n(56,P=e.onChange),"onChangeMode"in e&&n(57,T=e.onChangeMode),"onRenderValue"in e&&n(58,R=e.onRenderValue),"onRenderMenu"in e&&n(7,N=e.onRenderMenu),"onClassName"in e&&n(59,I=e.onClassName),"onFocus"in e&&n(60,D=e.onFocus),"onBlur"in e&&n(61,L=e.onBlur),"onSortModal"in e&&n(62,B=e.onSortModal),"onTransformModal"in e&&n(63,z=e.onTransformModal),"onJSONEditorModal"in e&&n(64,q=e.onJSONEditorModal);},e.$$.update=function(){3145728&e.$$.dirty[1]&&n(73,U=nC({escapeControlCharacters:j,escapeUnicodeCharacters:S})),524288&e.$$.dirty[1]&&we(w),1024&e.$$.dirty[0]|4096&e.$$.dirty[2]&&he(Z,u),e.$$.dirty[0],1032&e.$$.dirty[0]|25165824&e.$$.dirty[1]&&me(u,_,C,O),4096&e.$$.dirty[0]&&n(24,le=function(e){var t={};return e.forEach((function(e){t[Ys(e.path)]=e;})),e.forEach((function(e){for(var n=e.path;n.length>0;){var r=Ys(n=ly(n));r in t||(t[r]={isChildError:!0,path:n,message:"Contains invalid data",severity:us.warning});}})),t}(ve)),512&e.$$.dirty[0]&&(r=a?function(e){var t,n;function r(e){return e<20?200:e<50?400:1200}function i(){if(e){var n=.05*(t||0);e.scrollTop+=n;}}function o(e){n&&e===t||(a(),sP("startAutoScroll",e),t=e,n=setInterval(i,50));}function a(){n&&(sP("stopAutoScroll"),clearInterval(n),n=void 0,t=void 0);}return sP("createAutoScrollHandler",e),{onDrag:function(t){if(e){var n=t.clientY,i=e.getBoundingClientRect(),s=i.top,c=i.bottom;n<s?o(-r(s-n)):n>c?o(r(n-c)):a();}},onDragEnd:function(){a();}}}(a):void 0),9&e.$$.dirty[0]|402653184&e.$$.dirty[1]|2048&e.$$.dirty[2]&&n(13,fe={readOnly:b,parser:C,normalization:U,getJson:ye,getDocumentState:be,findElement:Xe,findNextInside:ht,focus:ft,onPatch:tt,onInsert:De,onExpand:it,onSelect:W,onFind:ot,onExpandSection:at,onPasteJson:st,onRenderValue:R,onContextMenu:ct,onClassName:I||function(){},onDrag:dt,onDragEnd:vt}),8192&e.$$.dirty[0]&&i("context changed",fe);},[b,x,k,C,M,E,A,N,function(){return de&&void 0!==u&&nt(u),{json:u,text:l}},a,u,l,ve,fe,s,c,G,H,J,Q,Y,X,ue,de,le,o,ee,function(){return ne.apply(this,arguments)},function(){return re.apply(this,arguments)},function(e,t){return ie.apply(this,arguments)},function(e,t){return oe.apply(this,arguments)},function(){n(19,Q=!1),n(20,Y=!1),ee(""),ft();},function(e){i("select validation error",e),W(T_(e.path,!1)),Qe(e.path);},Ee,function(e){e.preventDefault(),ED({clipboardText:e.clipboardData.getData("text/plain"),json:u,documentState:G,readOnly:b,parser:C,onPatch:tt,onChangeText:rt,openRepairModal:Te});},We,He,function(){Ue([]);},function(){Ke({rootPath:[]});},function(){it([],!0,!0);},function(){it([],!1,!0);},function(e){var t=_C(e),n=e.shiftKey;if(i("keydown",{combo:t,key:e.key}),"Ctrl+X"===t&&(e.preventDefault(),Oe(!0)),"Ctrl+Shift+X"===t&&(e.preventDefault(),Oe(!1)),"Ctrl+C"===t&&(e.preventDefault(),Ee(!0)),"Ctrl+Shift+C"===t&&(e.preventDefault(),Ee(!1)),"Ctrl+D"===t&&(e.preventDefault(),Ne()),"Delete"!==t&&"Backspace"!==t||(e.preventDefault(),Re()),"Insert"===t&&(e.preventDefault(),De("structure")),"Ctrl+A"===t&&(e.preventDefault(),W(T_([],!1))),"Ctrl+Q"===t&&ut(e),"ArrowUp"===t||"Shift+ArrowUp"===t){e.preventDefault();var r=G.selection?k_(u,G,n,!0)||G.selection:S_(u,G);W(r),Ze(r.focusPath);}if("ArrowDown"===t||"Shift+ArrowDown"===t){e.preventDefault();var o=G.selection?function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t.selection;if(!i)return null;var o=!r&&m_(i)?Em(i.paths):i.focusPath,a=c_(e,t,o),s=a,c=a;if(null===a||null==s||null==c)return null;if(n){var u=c_(e,du(Vs(e,o))?W$(t,o):t,o);return null===u?null:h_(i)?I_(e,u,u):d_(i)?I_(e,s,c):I_(e,i.anchorPath,u)}if(v_(i)){var l=Vs(e,ly(a));return Array.isArray(l)?T_(c,!1):P_(c,!1)}return p_(i)?T_(c,!1):d_(i)?I_(e,s,c):I_(e,a,a)}(u,G,n,!0)||G.selection:S_(u,G);W(o),Ze(o.focusPath);}if("ArrowLeft"===t||"Shift+ArrowLeft"===t){e.preventDefault();var a=G.selection?function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=t.selection;if(!i)return null;var o=j_(e,t,r),a=o.caret,s=o.previous;if(n)return m_(i)?null:I_(e,i.anchorPath,i.focusPath);if(a&&s)return F_(s);var c=ly(i.focusPath),u=Vs(e,c);return p_(i)&&Array.isArray(u)?I_(e,i.focusPath,i.focusPath):m_(i)&&!Array.isArray(u)?P_(i.focusPath,!1):null}(u,G,n,!b)||G.selection:S_(u,G);W(a),Ze(a.focusPath);}if("ArrowRight"===t||"Shift+ArrowRight"===t){e.preventDefault();var s=G.selection&&void 0!==u?function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=t.selection;if(!i)return null;var o=j_(e,t,r),a=o.caret,s=o.next;return n?m_(i)?null:I_(e,i.anchorPath,i.focusPath):a&&s?F_(s):m_(i)?T_(i.focusPath,!1):null}(u,G,n,!b)||G.selection:S_(u,G);W(s),Ze(s.focusPath);}if("Enter"===t&&G.selection){if(!b&&m_(G.selection)&&1===G.selection.paths.length){var c=G.selection.focusPath,l=Vs(u,ly(c));Array.isArray(l)&&W(T_(c,!1));}if(!b&&v_(G.selection)&&(e.preventDefault(),W(Oi(Oi({},G.selection),{},{edit:!0}))),p_(G.selection))e.preventDefault(),du(Vs(u,G.selection.focusPath))?it(G.selection.focusPath,!0):b||W(Oi(Oi({},G.selection),{},{edit:!0}));}if(1===t.replace(/^Shift\+/,"").length&&G.selection)return e.preventDefault(),void Fe(e.key);if("Enter"===t&&(h_(G.selection)||d_(G.selection)))return e.preventDefault(),void Fe("");if("Ctrl+Enter"===t&&p_(G.selection)){var f=Vs(u,G.selection.focusPath);yu(f)&&window.open(String(f),"_blank");}if("Escape"===t&&G.selection&&(e.preventDefault(),W(void 0)),"Ctrl+F"===t&&(e.preventDefault(),ot(!1)),"Ctrl+H"===t&&(e.preventDefault(),ot(!0)),"Ctrl+Z"===t){e.preventDefault();var h=document.activeElement;h&&h.blur&&h.focus?(h.blur(),setTimeout((function(){We(),setTimeout((function(){return h.select()}));}))):We();}if("Ctrl+Shift+Z"===t){e.preventDefault();var d=document.activeElement;d&&d.blur&&d.focus?(d.blur(),setTimeout((function(){He(),setTimeout((function(){return d.select()}));}))):He();}},function(e){i("handleMouseDown",e),setTimeout((function(){setTimeout((function(){g||vC(e.target,"BUTTON")||(ft(),G.selection||void 0!==u||""!==l&&void 0!==l||(i("createDefaultSelection"),n(16,G=Oi(Oi({},G),{},{selection:I_(u||{},[],[])}))));}));}));},ut,function(e){b||ct({anchor:kC(e.target,"BUTTON"),offsetTop:0,width:260,height:336,showTip:!0});},function(){return lt.apply(this,arguments)},function(){i("clear pasted json"),n(18,J=void 0);},function(){T(as.text);},function(e){W(e),ft(),Qe(e.focusPath);},function(e){var t=!mC(e.target,(function(e){return e===c}));t&&B_(G.selection)&&(i("click outside the editor, stop edit mode"),W((function(e){return v_(e)||p_(e)?Oi(Oi({},e),{},{edit:!1}):e})),g&&s&&(s.focus(),s.blur()),da().then((function(){setTimeout((function(){s&&s.blur();}));})));},w,j,S,$,_,O,P,T,R,I,D,L,B,z,q,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f_;i("expand");var t=Oi(Oi({},G),{},{expandedMap:{},visibleSectionsMap:{}});n(16,G=F$(u,t,[],e));},ge,ye,Se,Ke,Qe,Xe,ft,U,Z,function(e){n(19,Q=e);},function(e){sa[e?"unshift":"push"]((function(){n(14,s=e);}));},function(e){sa[e?"unshift":"push"]((function(){n(9,a=e);}));},function(e){sa[e?"unshift":"push"]((function(){n(15,c=e);}));}]}var aL=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,oL,iL,no,{readOnly:0,externalContent:50,mainMenuBar:1,navigationBar:2,escapeControlCharacters:51,escapeUnicodeCharacters:52,parser:3,parseMemoizeOne:53,validator:54,validationParser:55,pathParser:4,indentation:5,onError:6,onChange:56,onChangeMode:57,onRenderValue:58,onRenderMenu:7,onClassName:59,onFocus:60,onBlur:61,onSortModal:62,onTransformModal:63,onJSONEditorModal:64,expand:65,validate:66,getJson:67,patch:68,acceptAutoRepair:8,openTransformModal:69,scrollTo:70,findElement:71,focus:72},JD,[-1,-1,-1,-1,-1]),r}return qi(n,[{key:"expand",get:function(){return this.$$.ctx[65]}},{key:"validate",get:function(){return this.$$.ctx[66]}},{key:"getJson",get:function(){return this.$$.ctx[67]}},{key:"patch",get:function(){return this.$$.ctx[68]}},{key:"acceptAutoRepair",get:function(){return this.$$.ctx[8]}},{key:"openTransformModal",get:function(){return this.$$.ctx[69]}},{key:"scrollTo",get:function(){return this.$$.ctx[70]}},{key:"findElement",get:function(){return this.$$.ctx[71]}},{key:"focus",get:function(){return this.$$.ctx[72]}}]),n}();function sL(e){bo(e,"svelte-107mggt",".jse-modal.svelte-107mggt.svelte-107mggt{--height:36px;--multi-item-height:28px;--multi-item-margin:2px;--multi-item-padding:2px 8px;--multi-item-border-radius:6px;--indicator-top:8px;flex:1;display:flex;flex-direction:column;min-width:0;min-height:0;font-family:var(--jse-font-family);font-size:var(--jse-font-size);line-height:normal;background:var(--jse-modal-background);color:var(--jse-text-color)}.jse-modal.svelte-107mggt .jse-modal-contents.svelte-107mggt{padding:20px;overflow:auto;min-width:0;min-height:0}.jse-modal.svelte-107mggt .jse-modal-contents .jse-actions.svelte-107mggt{display:flex;flex-direction:row;justify-content:flex-end;padding-top:var(--jse-padding)}.jse-modal.svelte-107mggt .jse-modal-contents .jse-actions button.jse-primary.svelte-107mggt{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;background:var(--jse-button-primary-background);color:var(--jse-button-primary-color);padding:var(--jse-padding) calc(2 * var(--jse-padding));border-radius:3px}.jse-modal.svelte-107mggt .jse-modal-contents .jse-actions button.jse-primary.svelte-107mggt:hover{background:var(--jse-button-primary-background-highlight)}.jse-modal.svelte-107mggt .jse-modal-contents .jse-actions button.jse-primary.svelte-107mggt:disabled{background:var(--jse-button-primary-background-disabled)}.bg.jse-modal-bg{width:100%;height:100%;top:0;left:0;background:var(--jse-modal-overlay-background)}.bg.jse-modal-bg .jse-modal-window-wrap{margin:0}.bg.jse-modal-bg .jse-modal-window{max-width:90%;margin:4rem auto 2rem auto;border-radius:2px}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-sort{width:400px}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-transform{width:1200px;height:1200px;max-height:80%;display:flex}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-jsoneditor{width:800px;height:auto;min-height:500px;max-height:80%;display:flex}.bg.jse-modal-bg .jse-modal-content{flex:1;display:flex;max-height:calc(100vh - 6rem);padding:0}.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents.svelte-107mggt{flex:1;display:flex;flex-direction:column;color:inherit;min-height:0;padding:0}.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents .jse-main-contents.svelte-107mggt{flex:1;display:flex;gap:calc(2 * var(--jse-padding));min-height:0;box-sizing:border-box;padding:0 calc(2 * var(--jse-padding)) var(--jse-padding)}.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents .jse-main-contents .jse-query-contents.svelte-107mggt{flex:1;display:flex;flex-direction:column}.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents .jse-main-contents .jse-query-contents .jse-description.svelte-107mggt p{margin:var(--jse-padding) 0}.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents .jse-main-contents .jse-query-contents .jse-description.svelte-107mggt p:first-child{margin-top:0}.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents .jse-main-contents .jse-query-contents .jse-description.svelte-107mggt p:last-child{margin-bottom:0}.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents .jse-main-contents .jse-query-contents .jse-description.svelte-107mggt code{background:var(--jse-modal-code-background);font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono)}.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents .jse-main-contents .jse-query-contents textarea.jse-query.svelte-107mggt{flex:1;outline:none;resize:vertical}.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents .jse-main-contents .jse-data-contents.svelte-107mggt{flex:1;display:flex;flex-direction:column;gap:calc(2 * var(--jse-padding))}.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents .jse-main-contents .jse-data-contents .jse-original-data.svelte-107mggt{flex:1;display:flex;flex-direction:column;min-height:0;box-sizing:border-box}.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents .jse-main-contents .jse-data-contents .jse-original-data.jse-hide.svelte-107mggt{flex:none}.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents .jse-main-contents .jse-data-contents .jse-preview-data.svelte-107mggt{flex:1;display:flex;flex-direction:column;min-height:0;box-sizing:border-box}.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents .jse-main-contents .jse-data-contents.jse-hide-original-data.svelte-107mggt{flex-direction:column;gap:0;margin-bottom:0}.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents .jse-actions.svelte-107mggt{padding:var(--jse-padding) calc(2 * var(--jse-padding)) calc(2 * var(--jse-padding))}@media screen and (max-width: 1200px){.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents .jse-main-contents.svelte-107mggt{flex-direction:column;overflow:auto}.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents .jse-main-contents .jse-query-contents textarea.jse-query.svelte-107mggt{min-height:150px;flex:none}.jse-modal.jse-transform.svelte-107mggt .jse-modal-contents .jse-main-contents .jse-data-contents.svelte-107mggt .jse-tree-mode{height:300px;flex:none}}.jse-modal.jse-transform.svelte-107mggt .jse-label.svelte-107mggt{font-weight:bold;display:block;box-sizing:border-box}.jse-modal.jse-transform.svelte-107mggt .jse-label .jse-label-inner.svelte-107mggt{margin-top:calc(2 * var(--jse-padding));margin-bottom:calc(0.5 * var(--jse-padding));box-sizing:border-box}.jse-modal.jse-transform.svelte-107mggt .jse-label .jse-label-inner button.svelte-107mggt{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;font-weight:bold;padding:0}.jse-modal.jse-transform.svelte-107mggt .jse-tree-mode{flex:1;background:var(--jse-input-background-readonly);box-shadow:none;box-sizing:border-box;--jse-main-border:var(--jse-input-border)}.jse-modal.jse-transform.svelte-107mggt input.svelte-107mggt,.jse-modal.jse-transform.svelte-107mggt textarea.svelte-107mggt{border:var(--jse-input-border);outline:none;box-sizing:border-box;padding:calc(0.5 * var(--jse-padding));font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);color:inherit;background:var(--jse-input-background)}.jse-modal.jse-transform.svelte-107mggt input.svelte-107mggt:focus,.jse-modal.jse-transform.svelte-107mggt textarea.svelte-107mggt:focus{border:var(--jse-input-border-focus)}.jse-modal.jse-transform.svelte-107mggt input.svelte-107mggt:read-only,.jse-modal.jse-transform.svelte-107mggt textarea.svelte-107mggt:read-only{background:var(--jse-input-background-readonly)}.jse-modal.jse-transform.svelte-107mggt .jse-preview.jse-error.svelte-107mggt{flex:1;background:var(--jse-input-background-readonly);border:var(--jse-input-border);color:var(--jse-error-color);padding:calc(0.5 * var(--jse-padding))}.jse-modal.jse-transform.svelte-107mggt a{color:var(--jse-a-color)}.jse-modal.jse-transform.svelte-107mggt a:hover{color:var(--jse-a-color-highlight)}");}function cL(e){var t,n,r,i,o,a=[lL,uL],s=[];function c(e,n){return 16384&n[0]&&(t=null),null==t&&(t=!!Array.isArray(e[14])),t?0:1}return n=c(e,[-1,-1]),r=s[n]=a[n](e),{c:function(){r.c(),i=Eo();},m:function(e,t){s[n].m(e,t),jo(e,i,t),o=!0;},p:function(e,t){var o=n;(n=c(e,t))===o?s[n].p(e,t):(Sa(),_a(s[o],1,1,(function(){s[o]=null;})),Ca(),(r=s[n])?r.p(e,t):(r=s[n]=a[n](e)).c(),$a(r,1),r.m(i.parentNode,i));},i:function(e){o||($a(r),o=!0);},o:function(e){_a(r),o=!1;},d:function(e){s[n].d(e),e&&So(i);}}}function uL(e){var t;return {c:function(){t=Oo("(Only available for arrays, not for objects)");},m:function(e,n){jo(e,t,n);},p:Ki,i:Ki,o:Ki,d:function(e){e&&So(t);}}}function lL(e){var t,n;return t=new JA({props:{queryOptions:e[12],json:e[14],onChange:e[22]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};4096&n[0]&&(r.queryOptions=e[12]),16384&n[0]&&(r.json=e[14]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function fL(e){var t,n;return t=new aL({props:{externalContent:e[19],readOnly:!0,mainMenuBar:!1,navigationBar:!1,indentation:e[2],escapeControlCharacters:e[3],escapeUnicodeCharacters:e[4],parser:e[5],parseMemoizeOne:e[6],onRenderValue:e[10],onRenderMenu:Tl,onError:console.error,onChange:Tl,onChangeMode:Tl,onFocus:Tl,onBlur:Tl,onSortModal:Tl,onTransformModal:Tl,onJSONEditorModal:Tl,onClassName:e[11],validator:null,validationParser:e[7],pathParser:e[8]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};524288&n[0]&&(r.externalContent=e[19]),4&n[0]&&(r.indentation=e[2]),8&n[0]&&(r.escapeControlCharacters=e[3]),16&n[0]&&(r.escapeUnicodeCharacters=e[4]),32&n[0]&&(r.parser=e[5]),64&n[0]&&(r.parseMemoizeOne=e[6]),1024&n[0]&&(r.onRenderValue=e[10]),2048&n[0]&&(r.onClassName=e[11]),128&n[0]&&(r.validationParser=e[7]),256&n[0]&&(r.pathParser=e[8]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function hL(e){var t,n;return {c:function(){t=$o("div"),n=Oo(e[17]),Ro(t,"class","jse-preview jse-error svelte-107mggt");},m:function(e,r){jo(e,t,r),yo(t,n);},p:function(e,t){131072&t[0]&&Lo(n,e[17]);},i:Ki,o:Ki,d:function(e){e&&So(t);}}}function dL(e){var t,n;return t=new aL({props:{externalContent:e[18],readOnly:!0,mainMenuBar:!1,navigationBar:!1,indentation:e[2],escapeControlCharacters:e[3],escapeUnicodeCharacters:e[4],parser:e[5],parseMemoizeOne:e[6],onRenderValue:e[10],onRenderMenu:Tl,onError:console.error,onChange:Tl,onChangeMode:Tl,onFocus:Tl,onBlur:Tl,onSortModal:Tl,onTransformModal:Tl,onJSONEditorModal:Tl,onClassName:e[11],validator:null,validationParser:e[7],pathParser:e[8]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};262144&n[0]&&(r.externalContent=e[18]),4&n[0]&&(r.indentation=e[2]),8&n[0]&&(r.escapeControlCharacters=e[3]),16&n[0]&&(r.escapeUnicodeCharacters=e[4]),32&n[0]&&(r.parser=e[5]),64&n[0]&&(r.parseMemoizeOne=e[6]),1024&n[0]&&(r.onRenderValue=e[10]),2048&n[0]&&(r.onClassName=e[11]),128&n[0]&&(r.validationParser=e[7]),256&n[0]&&(r.pathParser=e[8]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function vL(e){var t,n,r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b,w,x,k,j,S,C,$,_,O,M,E,A,P,T,R,N,I,D,L,B,z,q,F,V,W,H,U,J,K=e[21](e[0]).description+"";t=new aP({props:{queryLanguages:e[9],queryLanguageId:e[0],onChangeQueryLanguage:e[27]}}),y=new x$({props:{data:e[15]?dM:JO}});var G=e[15]&&cL(e);A=new x$({props:{data:e[16]?dM:JO}});var Q=e[16]&&fL(e),Y=[dL,hL],X=[];function Z(e,t){return e[17]?1:0}return L=Z(e),B=X[L]=Y[L](e),{c:function(){Da(t.$$.fragment),n=Mo(),r=$o("div"),i=$o("div"),o=$o("div"),(a=$o("div")).innerHTML='<div class="jse-label-inner svelte-107mggt">Language</div>',s=Mo(),c=$o("div"),u=Mo(),(l=$o("div")).innerHTML='<div class="jse-label-inner svelte-107mggt">Path</div>',f=Mo(),h=$o("input"),v=Mo(),p=$o("div"),m=$o("div"),g=$o("button"),Da(y.$$.fragment),b=Oo("\n                Wizard"),w=Mo(),G&&G.c(),x=Mo(),(k=$o("div")).innerHTML='<div class="jse-label-inner svelte-107mggt">Query</div>',j=Mo(),S=$o("textarea"),C=Mo(),$=$o("div"),_=$o("div"),O=$o("div"),M=$o("div"),E=$o("button"),Da(A.$$.fragment),P=Oo("\n                  Original"),T=Mo(),Q&&Q.c(),R=Mo(),N=$o("div"),(I=$o("div")).innerHTML='<div class="jse-label-inner svelte-107mggt">Preview</div>',D=Mo(),B.c(),z=Mo(),q=$o("div"),F=$o("button"),V=Oo("Transform"),Ro(a,"class","jse-label svelte-107mggt"),Ro(c,"class","jse-description svelte-107mggt"),Ro(l,"class","jse-label svelte-107mggt"),Ro(h,"class","jse-path svelte-107mggt"),Ro(h,"type","text"),h.readOnly=!0,Ro(h,"title","Selected path"),h.value=d=By(e[1])?"(whole document)":FC(e[1]),Ro(g,"type","button"),Ro(g,"class","svelte-107mggt"),Ro(m,"class","jse-label-inner svelte-107mggt"),Ro(p,"class","jse-label svelte-107mggt"),Ro(k,"class","jse-label svelte-107mggt"),Ro(S,"class","jse-query svelte-107mggt"),Ro(S,"spellcheck","false"),S.value=e[13],Ro(o,"class","jse-query-contents svelte-107mggt"),Ro(E,"type","button"),Ro(E,"class","svelte-107mggt"),Ro(M,"class","jse-label-inner svelte-107mggt"),Ro(O,"class","jse-label svelte-107mggt"),Ro(_,"class","jse-original-data svelte-107mggt"),Fo(_,"jse-hide",!e[16]),Ro(I,"class","jse-label svelte-107mggt"),Ro(N,"class","jse-preview-data svelte-107mggt"),Ro($,"class","jse-data-contents svelte-107mggt"),Fo($,"jse-hide-original-data",!e[16]),Ro(i,"class","jse-main-contents svelte-107mggt"),Ro(F,"type","button"),Ro(F,"class","jse-primary svelte-107mggt"),F.disabled=W=!!e[17],Ro(q,"class","jse-actions svelte-107mggt"),Ro(r,"class","jse-modal-contents svelte-107mggt");},m:function(d,B){La(t,d,B),jo(d,n,B),jo(d,r,B),yo(r,i),yo(i,o),yo(o,a),yo(o,s),yo(o,c),c.innerHTML=K,yo(o,u),yo(o,l),yo(o,f),yo(o,h),yo(o,v),yo(o,p),yo(p,m),yo(m,g),La(y,g,null),yo(g,b),yo(o,w),G&&G.m(o,null),yo(o,x),yo(o,k),yo(o,j),yo(o,S),yo(i,C),yo(i,$),yo($,_),yo(_,O),yo(O,M),yo(M,E),La(A,E,null),yo(E,P),yo(_,T),Q&&Q.m(_,null),yo($,R),yo($,N),yo(N,I),yo(N,D),X[L].m(N,null),yo(r,z),yo(r,q),yo(q,F),yo(F,V),H=!0,U||(J=[Ao(g,"click",e[25]),Ao(S,"input",e[23]),Ao(E,"click",e[26]),Ao(F,"click",e[24]),fo(mL.call(null,F))],U=!0);},p:function(e,n){var r={};512&n[0]&&(r.queryLanguages=e[9]),1&n[0]&&(r.queryLanguageId=e[0]),t.$set(r),(!H||1&n[0])&&K!==(K=e[21](e[0]).description+"")&&(c.innerHTML=K),(!H||2&n[0]&&d!==(d=By(e[1])?"(whole document)":FC(e[1]))&&h.value!==d)&&(h.value=d);var i={};32768&n[0]&&(i.data=e[15]?dM:JO),y.$set(i),e[15]?G?(G.p(e,n),32768&n[0]&&$a(G,1)):((G=cL(e)).c(),$a(G,1),G.m(o,x)):G&&(Sa(),_a(G,1,1,(function(){G=null;})),Ca()),(!H||8192&n[0])&&(S.value=e[13]);var a={};65536&n[0]&&(a.data=e[16]?dM:JO),A.$set(a),e[16]?Q?(Q.p(e,n),65536&n[0]&&$a(Q,1)):((Q=fL(e)).c(),$a(Q,1),Q.m(_,null)):Q&&(Sa(),_a(Q,1,1,(function(){Q=null;})),Ca()),(!H||65536&n[0])&&Fo(_,"jse-hide",!e[16]);var s=L;(L=Z(e))===s?X[L].p(e,n):(Sa(),_a(X[s],1,1,(function(){X[s]=null;})),Ca(),(B=X[L])?B.p(e,n):(B=X[L]=Y[L](e)).c(),$a(B,1),B.m(N,null)),(!H||65536&n[0])&&Fo($,"jse-hide-original-data",!e[16]),(!H||131072&n[0]&&W!==(W=!!e[17]))&&(F.disabled=W);},i:function(e){H||($a(t.$$.fragment,e),$a(y.$$.fragment,e),$a(G),$a(A.$$.fragment,e),$a(Q),$a(B),H=!0);},o:function(e){_a(t.$$.fragment,e),_a(y.$$.fragment,e),_a(G),_a(A.$$.fragment,e),_a(Q),_a(B),H=!1;},d:function(e){Ba(t,e),e&&So(n),e&&So(r),Ba(y),G&&G.d(),Ba(A),Q&&Q.d(),X[L].d(),U=!1,Zi(J);}}}function pL(e){var t,n,r,i,o;return n=new qC({props:{$$slots:{default:[vL]},$$scope:{ctx:e}}}),{c:function(){t=$o("div"),Da(n.$$.fragment),Ro(t,"class","jse-modal jse-transform svelte-107mggt");},m:function(a,s){jo(a,t,s),La(n,t,null),r=!0,i||(o=fo(ST.call(null,t,e[20])),i=!0);},p:function(e,t){var r={};1048575&t[0]|256&t[1]&&(r.$$scope={dirty:t,ctx:e}),n.$set(r);},i:function(e){r||($a(n.$$.fragment,e),r=!0);},o:function(e){_a(n.$$.fragment,e),r=!1;},d:function(e){e&&So(t),Ba(n),i=!1,o();}}}function mL(e){e.focus();}function gL(e,t,n){var r,i,o=Ha("jsoneditor:TransformModal"),a=t.id,s=void 0===a?"transform-modal-"+Cs():a,c=t.json,u=t.rootPath,l=void 0===u?[]:u,f=t.indentation,h=t.escapeControlCharacters,d=t.escapeUnicodeCharacters,v=t.parser,p=t.parseMemoizeOne,m=t.validationParser,g=t.pathParser,y=t.queryLanguages,b=t.queryLanguageId,w=t.onChangeQueryLanguage,x=t.onRenderValue,k=t.onClassName,j=t.onTransform,S=ia("simple-modal").close,C="".concat(s,":").concat(Ys(l)),$=EM[C]||{},_=!1!==EM.showWizard,O=!1!==EM.showOriginal,M=$.queryOptions||{},E=b===$.queryLanguageId&&$.query?$.query:R(b).createQuery(c,$.queryOptions||{}),A=$.isManual||!1,P=void 0,T={text:""};function R(e){return y.find((function(t){return t.id===e}))||y[0]}var N=am((function(e,t){try{o("previewTransform",{query:t});var r=R(b).executeQuery(e,t,v);n(18,T={json:r}),n(17,P=void 0);}catch(e){n(18,T={text:""}),n(17,P=e.toString());}}),300);return e.$$set=function(e){"id"in e&&n(28,s=e.id),"json"in e&&n(29,c=e.json),"rootPath"in e&&n(1,l=e.rootPath),"indentation"in e&&n(2,f=e.indentation),"escapeControlCharacters"in e&&n(3,h=e.escapeControlCharacters),"escapeUnicodeCharacters"in e&&n(4,d=e.escapeUnicodeCharacters),"parser"in e&&n(5,v=e.parser),"parseMemoizeOne"in e&&n(6,p=e.parseMemoizeOne),"validationParser"in e&&n(7,m=e.validationParser),"pathParser"in e&&n(8,g=e.pathParser),"queryLanguages"in e&&n(9,y=e.queryLanguages),"queryLanguageId"in e&&n(0,b=e.queryLanguageId),"onChangeQueryLanguage"in e&&n(30,w=e.onChangeQueryLanguage),"onRenderValue"in e&&n(10,x=e.onRenderValue),"onClassName"in e&&n(11,k=e.onClassName),"onTransform"in e&&n(31,j=e.onTransform);},e.$$.update=function(){536870914&e.$$.dirty[0]&&n(14,r=Vs(c,l)),16384&e.$$.dirty[0]&&n(19,i={json:r}),24576&e.$$.dirty[0]&&N(r,E),12289&e.$$.dirty[0]|6&e.$$.dirty[1]&&(n(32,EM[C]={queryOptions:M,query:E,queryLanguageId:b,isManual:A},EM),o("store state in memory",C,EM[C]));},[b,l,f,h,d,v,p,m,g,y,x,k,M,E,r,_,O,P,T,i,S,R,function(e){n(12,M=e),n(13,E=R(b).createQuery(c,e)),n(33,A=!1),o("updateQueryByWizard",{queryOptions:M,query:E,isManual:A});},function(e){n(13,E=e.target.value),n(33,A=!0),o("handleChangeQuery",{query:E,isManual:A});},function(){try{o("handleTransform",{query:E});var e=R(b).executeQuery(r,E,v);j([{op:"replace",path:Ys(l),value:e}]),S();}catch(e){console.error(e),n(18,T={text:""}),n(17,P=e.toString());}},function(){n(15,_=!_),n(32,EM.showWizard=_,EM);},function(){n(16,O=!O),n(32,EM.showOriginal=O,EM);},function(e){o("handleChangeQueryLanguage",e),n(0,b=e),w(e);var t=R(b);n(13,E=t.createQuery(c,M)),n(33,A=!1);},s,c,w,j,EM,A]}var yL=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,gL,pL,no,{id:28,json:29,rootPath:1,indentation:2,escapeControlCharacters:3,escapeUnicodeCharacters:4,parser:5,parseMemoizeOne:6,validationParser:7,pathParser:8,queryLanguages:9,queryLanguageId:0,onChangeQueryLanguage:30,onRenderValue:10,onClassName:11,onTransform:31},sL,[-1,-1]),r}return qi(n)}(),bL={};function wL(e){bo(e,"svelte-1y818v2",".jse-modal.svelte-1y818v2.svelte-1y818v2{--height:36px;--multi-item-height:28px;--multi-item-margin:2px;--multi-item-padding:2px 8px;--multi-item-border-radius:6px;--indicator-top:8px;flex:1;display:flex;flex-direction:column;min-width:0;min-height:0;font-family:var(--jse-font-family);font-size:var(--jse-font-size);line-height:normal;background:var(--jse-modal-background);color:var(--jse-text-color)}.jse-modal.svelte-1y818v2 .jse-modal-contents.svelte-1y818v2{padding:20px;overflow:auto;min-width:0;min-height:0}.jse-modal.svelte-1y818v2 .jse-modal-contents .jse-actions.svelte-1y818v2{display:flex;flex-direction:row;justify-content:flex-end;padding-top:var(--jse-padding)}.jse-modal.svelte-1y818v2 .jse-modal-contents .jse-actions button.jse-primary.svelte-1y818v2{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;background:var(--jse-button-primary-background);color:var(--jse-button-primary-color);padding:var(--jse-padding) calc(2 * var(--jse-padding));border-radius:3px}.jse-modal.svelte-1y818v2 .jse-modal-contents .jse-actions button.jse-primary.svelte-1y818v2:hover{background:var(--jse-button-primary-background-highlight)}.jse-modal.svelte-1y818v2 .jse-modal-contents .jse-actions button.jse-primary.svelte-1y818v2:disabled{background:var(--jse-button-primary-background-disabled)}.bg.jse-modal-bg{width:100%;height:100%;top:0;left:0;background:var(--jse-modal-overlay-background)}.bg.jse-modal-bg .jse-modal-window-wrap{margin:0}.bg.jse-modal-bg .jse-modal-window{max-width:90%;margin:4rem auto 2rem auto;border-radius:2px}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-sort{width:400px}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-transform{width:1200px;height:1200px;max-height:80%;display:flex}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-jsoneditor{width:800px;height:auto;min-height:500px;max-height:80%;display:flex}.bg.jse-modal-bg .jse-modal-content{flex:1;display:flex;max-height:calc(100vh - 6rem);padding:0}.jse-modal.jse-sort.svelte-1y818v2 table.svelte-1y818v2{width:100%;border-collapse:collapse;border-spacing:0}.jse-modal.jse-sort.svelte-1y818v2 table th.svelte-1y818v2,.jse-modal.jse-sort.svelte-1y818v2 table td.svelte-1y818v2{text-align:left;vertical-align:middle;font-weight:normal;padding-bottom:var(--jse-padding)}.jse-modal.jse-sort.svelte-1y818v2 table th input.jse-path.svelte-1y818v2,.jse-modal.jse-sort.svelte-1y818v2 table td input.jse-path.svelte-1y818v2{width:100%;box-sizing:border-box;padding:6px 16px;border:var(--jse-input-border);border-radius:var(--jse-input-radius);font-family:inherit;font-size:inherit;background:inherit;color:inherit;outline:none}.jse-modal.jse-sort.svelte-1y818v2 table th input.jse-path.svelte-1y818v2:read-only,.jse-modal.jse-sort.svelte-1y818v2 table td input.jse-path.svelte-1y818v2:read-only{background:var(--jse-input-background-readonly)}.jse-modal.jse-sort.svelte-1y818v2 table th.svelte-1y818v2 .svelte-select input,.jse-modal.jse-sort.svelte-1y818v2 table td.svelte-1y818v2 .svelte-select input{box-sizing:border-box}.jse-modal.jse-sort.svelte-1y818v2 .jse-space.svelte-1y818v2{height:200px}.jse-modal.jse-sort.svelte-1y818v2 .jse-space .jse-error.svelte-1y818v2{color:var(--jse-error-color)}");}function xL(e){var t,n,r,i,o,a,s;function c(t){e[14](t);}var u={showChevron:!0,items:e[3]};return void 0!==e[1]&&(u.value=e[1]),o=new VA({props:u}),sa.push((function(){return Ia(o,"value",c)})),{c:function(){t=$o("tr"),(n=$o("th")).textContent="Property",r=Mo(),i=$o("td"),Da(o.$$.fragment),Ro(n,"class","svelte-1y818v2"),Ro(i,"class","svelte-1y818v2");},m:function(e,a){jo(e,t,a),yo(t,n),yo(t,r),yo(t,i),La(o,i,null),s=!0;},p:function(e,t){var n={};8&t&&(n.items=e[3]),!a&&2&t&&(a=!0,n.value=e[1],pa((function(){return a=!1}))),o.$set(n);},i:function(e){s||($a(o.$$.fragment,e),s=!0);},o:function(e){_a(o.$$.fragment,e),s=!1;},d:function(e){e&&So(t),Ba(o);}}}function kL(e){var t,n;return {c:function(){t=$o("div"),n=Oo(e[5]),Ro(t,"class","jse-error svelte-1y818v2");},m:function(e,r){jo(e,t,r),yo(t,n);},p:function(e,t){32&t&&Lo(n,e[5]);},d:function(e){e&&So(t);}}}function jL(e){var t,n,r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b,w,x,k,j,S,C,$,_,O,M,E,A,P;n=new qP({props:{title:e[4]?"Sort array items":"Sort object keys"}});var T=e[4]&&(e[3].length>1||void 0===e[1])&&xL(e);function R(t){e[15](t);}var N={showChevron:!0,clearable:!1,items:e[7]};void 0!==e[2]&&(N.value=e[2]),x=new VA({props:N}),sa.push((function(){return Ia(x,"value",R)}));var I=e[5]&&kL(e);return {c:function(){t=$o("div"),Da(n.$$.fragment),r=Mo(),i=$o("div"),o=$o("table"),(a=$o("colgroup")).innerHTML='<col width="25%"/> \n        <col width="75%"/>',s=Mo(),c=$o("tbody"),u=$o("tr"),(l=$o("th")).textContent="Path",f=Mo(),h=$o("td"),d=$o("input"),p=Mo(),T&&T.c(),m=Mo(),g=$o("tr"),(y=$o("th")).textContent="Direction",b=Mo(),w=$o("td"),Da(x.$$.fragment),j=Mo(),S=$o("div"),I&&I.c(),C=Mo(),$=$o("div"),_=$o("button"),O=Oo("Sort"),Ro(l,"class","svelte-1y818v2"),Ro(d,"class","jse-path svelte-1y818v2"),Ro(d,"type","text"),d.readOnly=!0,Ro(d,"title","Selected path"),d.value=v=By(e[0])?"(whole document)":FC(e[0]),Ro(h,"class","svelte-1y818v2"),Ro(y,"class","svelte-1y818v2"),Ro(w,"class","svelte-1y818v2"),Ro(o,"class","svelte-1y818v2"),Ro(S,"class","jse-space svelte-1y818v2"),Ro(_,"type","button"),Ro(_,"class","jse-primary svelte-1y818v2"),_.disabled=M=!!e[4]&&!e[1],Ro($,"class","jse-actions svelte-1y818v2"),Ro(i,"class","jse-modal-contents svelte-1y818v2"),Ro(t,"class","jse-modal jse-sort svelte-1y818v2");},m:function(v,k){jo(v,t,k),La(n,t,null),yo(t,r),yo(t,i),yo(i,o),yo(o,a),yo(o,s),yo(o,c),yo(c,u),yo(u,l),yo(u,f),yo(u,h),yo(h,d),yo(c,p),T&&T.m(c,null),yo(c,m),yo(c,g),yo(g,y),yo(g,b),yo(g,w),La(x,w,null),yo(i,j),yo(i,S),I&&I.m(S,null),yo(i,C),yo(i,$),yo($,_),yo(_,O),E=!0,A||(P=[Ao(_,"click",e[8]),fo(SL.call(null,_)),fo(ST.call(null,t,e[6]))],A=!0);},p:function(e,t){var r=Si(t,1)[0],i={};16&r&&(i.title=e[4]?"Sort array items":"Sort object keys"),n.$set(i),(!E||1&r&&v!==(v=By(e[0])?"(whole document)":FC(e[0]))&&d.value!==v)&&(d.value=v),e[4]&&(e[3].length>1||void 0===e[1])?T?(T.p(e,r),26&r&&$a(T,1)):((T=xL(e)).c(),$a(T,1),T.m(c,m)):T&&(Sa(),_a(T,1,1,(function(){T=null;})),Ca());var o={};!k&&4&r&&(k=!0,o.value=e[2],pa((function(){return k=!1}))),x.$set(o),e[5]?I?I.p(e,r):((I=kL(e)).c(),I.m(S,null)):I&&(I.d(1),I=null),(!E||18&r&&M!==(M=!!e[4]&&!e[1]))&&(_.disabled=M);},i:function(e){E||($a(n.$$.fragment,e),$a(T),$a(x.$$.fragment,e),E=!0);},o:function(e){_a(n.$$.fragment,e),_a(T),_a(x.$$.fragment,e),E=!1;},d:function(e){e&&So(t),Ba(n),T&&T.d(),Ba(x),I&&I.d(),A=!1,Zi(P);}}}function SL(e){e.focus();}function CL(e,t,n){var r,i,o,a=Ha("jsoneditor:SortModal"),s=t.id,c=t.json,u=t.rootPath,l=t.onSort,f=ia("simple-modal").close,h="".concat(s,":").concat(Ys(u)),d=Vs(c,u),v={value:1,label:"ascending"},p=[v,{value:-1,label:"descending"}],m=bL[h]&&bL[h].selectedProperty||void 0,g=bL[h]&&bL[h].selectedDirection||v,y=void 0;return e.$$set=function(e){"id"in e&&n(9,s=e.id),"json"in e&&n(10,c=e.json),"rootPath"in e&&n(0,u=e.rootPath),"onSort"in e&&n(11,l=e.onSort);},e.$$.update=function(){16&e.$$.dirty&&n(13,i=r&&void 0!==d?OS(d):void 0),8192&e.$$.dirty&&n(3,o=i?i.map(WC):void 0),10&e.$$.dirty&&void 0===m&&o&&1===o.length&&n(1,m=o[0]),4102&e.$$.dirty&&(n(12,bL[h]={selectedProperty:m,selectedDirection:g},bL),a("store state in memory",h,bL[h]));},n(4,r=Array.isArray(d)),[u,m,g,o,r,y,f,p,function(){try{var e,t;n(5,y=void 0);var r=null===(e=m)||void 0===e?void 0:e.value,i=null===(t=g)||void 0===t?void 0:t.value,o=xI(c,u,r,i);l({operations:o,rootPath:u,itemPath:r,direction:i}),f();}catch(e){n(5,y=e.toString());}},s,c,l,bL,i,function(e){n(1,m=e),n(3,o),n(13,i),n(4,r);},function(e){n(2,g=e);}]}var $L=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,CL,jL,no,{id:9,json:10,rootPath:0,onSort:11},wL),r}return qi(n)}();function _L(){}function OL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(e<.9*t)return e.toFixed()+" B";var n=e/t;if(n<.9*t)return n.toFixed(1)+" KB";var r=n/t;if(r<.9*t)return r.toFixed(1)+" MB";var i=r/t;if(i<.9*t)return i.toFixed(1)+" GB";var o=i/t;return o.toFixed(1)+" TB"}function ML(e){var t,n;return t=new vT({props:{items:e[0]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&Si(n,1)[0]&&(r.items=e[0]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function EL(e,t,n){var r,i,o=t.readOnly,a=void 0!==o&&o,s=t.onFormat,c=t.onCompact,u=t.onSort,l=t.onTransform,f=t.onToggleSearch,h=t.onUndo,d=t.onRedo,v=t.canUndo,p=t.canRedo,m=t.canFormat,g=t.canCompact,y=t.canSort,b=t.canTransform,w=t.onRenderMenu,x={type:"button",icon:bM,title:"Search (Ctrl+F)",className:"jse-search",onClick:f};return e.$$set=function(e){"readOnly"in e&&n(1,a=e.readOnly),"onFormat"in e&&n(2,s=e.onFormat),"onCompact"in e&&n(3,c=e.onCompact),"onSort"in e&&n(4,u=e.onSort),"onTransform"in e&&n(5,l=e.onTransform),"onToggleSearch"in e&&n(6,f=e.onToggleSearch),"onUndo"in e&&n(7,h=e.onUndo),"onRedo"in e&&n(8,d=e.onRedo),"canUndo"in e&&n(9,v=e.canUndo),"canRedo"in e&&n(10,p=e.canRedo),"canFormat"in e&&n(11,m=e.canFormat),"canCompact"in e&&n(12,g=e.canCompact),"canSort"in e&&n(13,y=e.canSort),"canTransform"in e&&n(14,b=e.canTransform),"onRenderMenu"in e&&n(15,w=e.onRenderMenu);},e.$$.update=function(){32702&e.$$.dirty&&n(16,i=a?[x,{type:"space"}]:[{type:"button",icon:sI,title:"Format JSON: add proper indentation and new lines (Ctrl+I)",className:"jse-format",onClick:s,disabled:a||!m},{type:"button",icon:cI,title:"Compact JSON: remove all white spacing and new lines (Ctrl+Shift+I)",className:"jse-compact",onClick:c,disabled:a||!g},{type:"separator"},{type:"button",icon:mM,title:"Sort",className:"jse-sort",onClick:u,disabled:a||!y},{type:"button",icon:iM,title:"Transform contents (filter, sort, project)",className:"jse-transform",onClick:l,disabled:a||!b},x,{type:"separator"},{type:"button",icon:lM,title:"Undo (Ctrl+Z)",className:"jse-undo",onClick:h,disabled:!v},{type:"button",icon:uM,title:"Redo (Ctrl+Shift+Z)",className:"jse-redo",onClick:d,disabled:!p},{type:"space"}]),98304&e.$$.dirty&&n(0,r=w(i)||i);},[r,a,s,c,u,l,f,h,d,v,p,m,g,y,b,w,i]}var AL=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,EL,ML,no,{readOnly:1,onFormat:2,onCompact:3,onSort:4,onTransform:5,onToggleSearch:6,onUndo:7,onRedo:8,canUndo:9,canRedo:10,canFormat:11,canCompact:12,canSort:13,canTransform:14,onRenderMenu:15}),r}return qi(n)}(),PL=function(){function e(){Bi(this,e);}return qi(e,[{key:"lineAt",value:function(e){if(e<0||e>this.length)throw new RangeError("Invalid position ".concat(e," in document of length ").concat(this.length));return this.lineInner(e,!1,1,0)}},{key:"line",value:function(e){if(e<1||e>this.lines)throw new RangeError("Invalid line number ".concat(e," in ").concat(this.lines,"-line document"));return this.lineInner(e,!0,1,0)}},{key:"replace",value:function(e,t,n){var r=[];return this.decompose(0,e,r,2),n.length&&n.decompose(0,n.length,r,3),this.decompose(t,this.length,r,1),RL.from(r,this.length-(t-e)+n.length)}},{key:"append",value:function(e){return this.replace(this.length,this.length,e)}},{key:"slice",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length,n=[];return this.decompose(e,t,n,0),RL.from(n,t-e)}},{key:"eq",value:function(e){if(e==this)return !0;if(e.length!=this.length||e.lines!=this.lines)return !1;for(var t=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),r=new LL(this),i=new LL(e),o=t,a=t;;){if(r.next(o),i.next(o),o=0,r.lineBreak!=i.lineBreak||r.done!=i.done||r.value!=i.value)return !1;if(a+=r.value.length,r.done||a>=n)return !0}}},{key:"iter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new LL(this,e)}},{key:"iterRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return new BL(this,e,t)}},{key:"iterLines",value:function(e,t){var n;if(null==e)n=this.iter();else {null==t&&(t=this.lines+1);var r=this.line(e).from;n=this.iterRange(r,Math.max(r,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to));}return new zL(n)}},{key:"toString",value:function(){return this.sliceString(0)}},{key:"toJSON",value:function(){var e=[];return this.flatten(e),e}}],[{key:"of",value:function(t){if(0==t.length)throw new RangeError("A document must have at least one line");return 1!=t.length||t[0]?t.length<=32?new TL(t):RL.from(TL.split(t,[])):e.empty}}]),e}(),TL=function(e){Pi(n,PL);var t=Ri(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NL(e);return Bi(this,n),(r=t.call(this)).text=e,r.length=i,r}return qi(n,[{key:"lines",get:function(){return this.text.length}},{key:"children",get:function(){return null}},{key:"lineInner",value:function(e,t,n,r){for(var i=0;;i++){var o=this.text[i],a=r+o.length;if((t?n:a)>=e)return new qL(r,a,n,o);r=a+1,n++;}}},{key:"decompose",value:function(e,t,r,i){var o=e<=0&&t>=this.length?this:new n(DL(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(1&i){var a=r.pop(),s=IL(o.text,a.text.slice(),0,o.length);if(s.length<=32)r.push(new n(s,a.length+o.length));else {var c=s.length>>1;r.push(new n(s.slice(0,c)),new n(s.slice(c)));}}else r.push(o);}},{key:"replace",value:function(e,t,r){if(!(r instanceof n))return Ei(Li(n.prototype),"replace",this).call(this,e,t,r);var i=IL(this.text,IL(r.text,DL(this.text,0,e)),t),o=this.length+r.length-(t-e);return i.length<=32?new n(i,o):RL.from(n.split(i,[]),o)}},{key:"sliceString",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"\n",r="",i=0,o=0;i<=t&&o<this.text.length;o++){var a=this.text[o],s=i+a.length;i>e&&o&&(r+=n),e<s&&t>i&&(r+=a.slice(Math.max(0,e-i),t-i)),i=s+1;}return r}},{key:"flatten",value:function(e){var t,n=wi(this.text);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.push(r);}}catch(e){n.e(e);}finally{n.f();}}},{key:"scanIdentical",value:function(){return 0}}],[{key:"split",value:function(e,t){var r,i=[],o=-1,a=wi(e);try{for(a.s();!(r=a.n()).done;){var s=r.value;i.push(s),o+=s.length+1,32==i.length&&(t.push(new n(i,o)),i=[],o=-1);}}catch(e){a.e(e);}finally{a.f();}return o>-1&&t.push(new n(i,o)),t}}]),n}(),RL=function(e){Pi(n,PL);var t=Ri(n);function n(e,r){var i;Bi(this,n),(i=t.call(this)).children=e,i.length=r,i.lines=0;var o,a=wi(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;i.lines+=s.lines;}}catch(e){a.e(e);}finally{a.f();}return i}return qi(n,[{key:"lineInner",value:function(e,t,n,r){for(var i=0;;i++){var o=this.children[i],a=r+o.length,s=n+o.lines-1;if((t?s:a)>=e)return o.lineInner(e,t,n,r);r=a+1,n=s+1;}}},{key:"decompose",value:function(e,t,n,r){for(var i=0,o=0;o<=t&&i<this.children.length;i++){var a=this.children[i],s=o+a.length;if(e<=s&&t>=o){var c=r&((o<=e?1:0)|(s>=t?2:0));o>=e&&s<=t&&!c?n.push(a):a.decompose(e-o,t-o,n,c);}o=s+1;}}},{key:"replace",value:function(e,t,r){if(r.lines<this.lines)for(var i=0,o=0;i<this.children.length;i++){var a=this.children[i],s=o+a.length;if(e>=o&&t<=s){var c=a.replace(e-o,t-o,r),u=this.lines-a.lines+c.lines;if(c.lines<u>>4&&c.lines>u>>6){var l=this.children.slice();return l[i]=c,new n(l,this.length-(t-e)+r.length)}return Ei(Li(n.prototype),"replace",this).call(this,o,s,c)}o=s+1;}return Ei(Li(n.prototype),"replace",this).call(this,e,t,r)}},{key:"sliceString",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"\n",r="",i=0,o=0;i<this.children.length&&o<=t;i++){var a=this.children[i],s=o+a.length;o>e&&i&&(r+=n),e<s&&t>o&&(r+=a.sliceString(e-o,t-o,n)),o=s+1;}return r}},{key:"flatten",value:function(e){var t,n=wi(this.children);try{for(n.s();!(t=n.n()).done;){t.value.flatten(e);}}catch(e){n.e(e);}finally{n.f();}}},{key:"scanIdentical",value:function(e,t){if(!(e instanceof n))return 0;for(var r=0,i=Si(t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1],4),o=i[0],a=i[1],s=i[2],c=i[3];;o+=t,a+=t){if(o==s||a==c)return r;var u=this.children[o],l=e.children[a];if(u!=l)return r+u.scanIdentical(l,t);r+=u.length+1;}}}],[{key:"from",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.reduce((function(e,t){return e+t.length+1}),-1),i=0,o=wi(e);try{for(o.s();!(t=o.n()).done;){var a=t.value;i+=a.lines;}}catch(e){o.e(e);}finally{o.f();}if(i<32){var s,c=[],u=wi(e);try{for(u.s();!(s=u.n()).done;){var l=s.value;l.flatten(c);}}catch(e){u.e(e);}finally{u.f();}return new TL(c,r)}var f=Math.max(32,i>>5),h=f<<1,d=f>>1,v=[],p=0,m=-1,g=[];function y(e){var t;if(e.lines>h&&e instanceof n){var r,i=wi(e.children);try{for(i.s();!(r=i.n()).done;){y(r.value);}}catch(e){i.e(e);}finally{i.f();}}else e.lines>d&&(p>d||!p)?(b(),v.push(e)):e instanceof TL&&p&&(t=g[g.length-1])instanceof TL&&e.lines+t.lines<=32?(p+=e.lines,m+=e.length+1,g[g.length-1]=new TL(t.text.concat(e.text),t.length+1+e.length)):(p+e.lines>f&&b(),p+=e.lines,m+=e.length+1,g.push(e));}function b(){0!=p&&(v.push(1==g.length?g[0]:n.from(g,m)),m=-1,p=g.length=0);}var w,x=wi(e);try{for(x.s();!(w=x.n()).done;){var k=w.value;y(k);}}catch(e){x.e(e);}finally{x.f();}return b(),1==v.length?v[0]:new n(v,r)}}]),n}();function NL(e){var t,n=-1,r=wi(e);try{for(r.s();!(t=r.n()).done;){n+=t.value.length+1;}}catch(e){r.e(e);}finally{r.f();}return n}function IL(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e9,i=0,o=0,a=!0;o<e.length&&i<=r;o++){var s=e[o],c=i+s.length;c>=n&&(c>r&&(s=s.slice(0,r-i)),i<n&&(s=s.slice(n-i)),a?(t[t.length-1]+=s,a=!1):t.push(s)),i=c+1;}return t}function DL(e,t,n){return IL(e,[""],t,n)}PL.empty=new TL([""],0);var LL=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Bi(this,e),this.dir=n,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[n>0?1:(t instanceof TL?t.text.length:t.children.length)<<1];}return qi(e,[{key:"nextInner",value:function(e,t){for(this.done=this.lineBreak=!1;;){var n=this.nodes.length-1,r=this.nodes[n],i=this.offsets[n],o=i>>1,a=r instanceof TL?r.text.length:r.children.length;if(o==(t>0?a:0)){if(0==n)return this.done=!0,this.value="",this;t>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop();}else if((1&i)==(t>0?0:1)){if(this.offsets[n]+=t,0==e)return this.lineBreak=!0,this.value="\n",this;e--;}else if(r instanceof TL){var s=r.text[o+(t<0?-1:0)];if(this.offsets[n]+=t,s.length>Math.max(0,e))return this.value=0==e?s:t>0?s.slice(e):s.slice(0,s.length-e),this;e-=s.length;}else {var c=r.children[o+(t<0?-1:0)];e>c.length?(e-=c.length,this.offsets[n]+=t):(t<0&&this.offsets[n]--,this.nodes.push(c),this.offsets.push(t>0?1:(c instanceof TL?c.text.length:c.children.length)<<1));}}}},{key:"next",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}]),e}(),BL=function(){function e(t,n,r){Bi(this,e),this.value="",this.done=!1,this.cursor=new LL(t,n>r?-1:1),this.pos=n>r?t.length:0,this.from=Math.min(n,r),this.to=Math.max(n,r);}return qi(e,[{key:"nextInner",value:function(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);var n=t<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;var r=this.cursor.next(e).value;return this.pos+=(r.length+e)*t,this.value=r.length<=n?r:t<0?r.slice(r.length-n):r.slice(0,n),this.done=!this.value,this}},{key:"next",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}},{key:"lineBreak",get:function(){return this.cursor.lineBreak&&""!=this.value}}]),e}(),zL=function(){function e(t){Bi(this,e),this.inner=t,this.afterBreak=!0,this.value="",this.done=!1;}return qi(e,[{key:"next",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.inner.next(e),n=t.done,r=t.lineBreak,i=t.value;return n?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}},{key:"lineBreak",get:function(){return !1}}]),e}();"undefined"!=typeof Symbol&&(PL.prototype[Symbol.iterator]=function(){return this.iter()},LL.prototype[Symbol.iterator]=BL.prototype[Symbol.iterator]=zL.prototype[Symbol.iterator]=function(){return this});for(var qL=function(){function e(t,n,r,i){Bi(this,e),this.from=t,this.to=n,this.number=r,this.text=i;}return qi(e,[{key:"length",get:function(){return this.to-this.from}}]),e}(),FL="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((function(e){return e?parseInt(e,36):1})),VL=1;VL<FL.length;VL++)FL[VL]+=FL[VL-1];function WL(e){for(var t=1;t<FL.length;t+=2)if(FL[t]>e)return FL[t-1]<=e;return !1}function HL(e){return e>=127462&&e<=127487}function UL(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return (n?JL:KL)(e,t,r)}function JL(e,t,n){if(t==e.length)return t;t&&GL(e.charCodeAt(t))&&QL(e.charCodeAt(t-1))&&t--;var r=YL(e,t);for(t+=ZL(r);t<e.length;){var i=YL(e,t);if(8205==r||8205==i||n&&WL(i))t+=ZL(i),r=i;else {if(!HL(i))break;for(var o=0,a=t-2;a>=0&&HL(YL(e,a));)o++,a-=2;if(o%2==0)break;t+=2;}}return t}function KL(e,t,n){for(;t>0;){var r=JL(e,t-2,n);if(r<t)return r;t--;}return 0}function GL(e){return e>=56320&&e<57344}function QL(e){return e>=55296&&e<56320}function YL(e,t){var n=e.charCodeAt(t);if(!QL(n)||t+1==e.length)return n;var r=e.charCodeAt(t+1);return GL(r)?r-56320+(n-55296<<10)+65536:n}function XL(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}function ZL(e){return e<65536?1:2}var eB=/\r\n?|\n/,tB=function(e){return e[e.Simple=0]="Simple",e[e.TrackDel=1]="TrackDel",e[e.TrackBefore=2]="TrackBefore",e[e.TrackAfter=3]="TrackAfter",e}(tB||(tB={})),nB=function(){function e(t){Bi(this,e),this.sections=t;}return qi(e,[{key:"length",get:function(){for(var e=0,t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}},{key:"newLength",get:function(){for(var e=0,t=0;t<this.sections.length;t+=2){var n=this.sections[t+1];e+=n<0?this.sections[t]:n;}return e}},{key:"empty",get:function(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}},{key:"iterGaps",value:function(e){for(var t=0,n=0,r=0;t<this.sections.length;){var i=this.sections[t++],o=this.sections[t++];o<0?(e(n,r,i),r+=i):r+=o,n+=i;}}},{key:"iterChangedRanges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];aB(this,e,t);}},{key:"invertedDesc",get:function(){for(var t=[],n=0;n<this.sections.length;){var r=this.sections[n++],i=this.sections[n++];i<0?t.push(r,i):t.push(i,r);}return new e(t)}},{key:"composeDesc",value:function(e){return this.empty?e:e.empty?this:cB(this,e)}},{key:"mapDesc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.empty?this:sB(this,e,t)}},{key:"mapPos",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tB.Simple,r=0,i=0,o=0;o<this.sections.length;){var a=this.sections[o++],s=this.sections[o++],c=r+a;if(s<0){if(c>e)return i+(e-r);i+=a;}else {if(n!=tB.Simple&&c>=e&&(n==tB.TrackDel&&r<e&&c>e||n==tB.TrackBefore&&r<e||n==tB.TrackAfter&&c>e))return null;if(c>e||c==e&&t<0&&!a)return e==r||t<0?i:i+s;i+=s;}r=c;}if(e>r)throw new RangeError("Position ".concat(e," is out of range for changeset of length ").concat(r));return i}},{key:"touchesRange",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=0,r=0;n<this.sections.length&&r<=t;){var i=this.sections[n++],o=this.sections[n++],a=r+i;if(o>=0&&r<=t&&a>=e)return !(r<e&&a>t)||"cover";r=a;}return !1}},{key:"toString",value:function(){for(var e="",t=0;t<this.sections.length;){var n=this.sections[t++],r=this.sections[t++];e+=(e?" ":"")+n+(r>=0?":"+r:"");}return e}},{key:"toJSON",value:function(){return this.sections}}],[{key:"fromJSON",value:function(t){if(!Array.isArray(t)||t.length%2||t.some((function(e){return "number"!=typeof e})))throw new RangeError("Invalid JSON representation of ChangeDesc");return new e(t)}},{key:"create",value:function(t){return new e(t)}}]),e}(),rB=function(e){Pi(n,nB);var t=Ri(n);function n(e,r){var i;return Bi(this,n),(i=t.call(this,e)).inserted=r,i}return qi(n,[{key:"apply",value:function(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return aB(this,(function(t,n,r,i,o){return e=e.replace(r,r+(n-t),o)}),!1),e}},{key:"mapDesc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return sB(this,e,t,!0)}},{key:"invert",value:function(e){for(var t=this.sections.slice(),r=[],i=0,o=0;i<t.length;i+=2){var a=t[i],s=t[i+1];if(s>=0){t[i]=s,t[i+1]=a;for(var c=i>>1;r.length<c;)r.push(PL.empty);r.push(a?e.slice(o,o+a):PL.empty);}o+=a;}return new n(t,r)}},{key:"compose",value:function(e){return this.empty?e:e.empty?this:cB(this,e,!0)}},{key:"map",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.empty?this:sB(this,e,t,!0)}},{key:"iterChanges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];aB(this,e,t);}},{key:"desc",get:function(){return nB.create(this.sections)}},{key:"filter",value:function(e){var t=[],r=[],i=[],o=new uB(this);e:for(var a=0,s=0;;){for(var c=a==e.length?1e9:e[a++];s<c||s==c&&0==o.len;){if(o.done)break e;var u=Math.min(o.len,c-s);iB(i,u,-1);var l=-1==o.ins?-1:0==o.off?o.ins:0;iB(t,u,l),l>0&&oB(r,t,o.text),o.forward(u),s+=u;}for(var f=e[a++];s<f;){if(o.done)break e;var h=Math.min(o.len,f-s);iB(t,h,-1),iB(i,h,-1==o.ins?-1:0==o.off?o.ins:0),o.forward(h),s+=h;}}return {changes:new n(t,r),filtered:nB.create(i)}}},{key:"toJSON",value:function(){for(var e=[],t=0;t<this.sections.length;t+=2){var n=this.sections[t],r=this.sections[t+1];r<0?e.push(n):0==r?e.push([n]):e.push([n].concat(this.inserted[t>>1].toJSON()));}return e}}],[{key:"of",value:function(e,t,r){var i=[],o=[],a=0,s=null;function c(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||i.length){a<t&&iB(i,t-a,-1);var r=new n(i,o);s=s?s.compose(r.map(s)):r,i=[],o=[],a=0;}}return function e(u){if(Array.isArray(u)){var l,f=wi(u);try{for(f.s();!(l=f.n()).done;){e(l.value);}}catch(e){f.e(e);}finally{f.f();}}else if(u instanceof n){if(u.length!=t)throw new RangeError("Mismatched change set length (got ".concat(u.length,", expected ").concat(t,")"));c(),s=s?s.compose(u.map(s)):u;}else {var h=u.from,d=u.to,v=void 0===d?h:d,p=u.insert;if(h>v||h<0||v>t)throw new RangeError("Invalid change range ".concat(h," to ").concat(v," (in doc of length ").concat(t,")"));var m=p?"string"==typeof p?PL.of(p.split(r||eB)):p:PL.empty,g=m.length;if(h==v&&0==g)return;h<a&&c(),h>a&&iB(i,h-a,-1),iB(i,v-h,g),oB(o,i,m),a=v;}}(e),c(!s),s}},{key:"empty",value:function(e){return new n(e?[e,-1]:[],[])}},{key:"fromJSON",value:function(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");for(var t=[],r=[],i=0;i<e.length;i++){var o=e[i];if("number"==typeof o)t.push(o,-1);else {if(!Array.isArray(o)||"number"!=typeof o[0]||o.some((function(e,t){return t&&"string"!=typeof e})))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==o.length)t.push(o[0],0);else {for(;r.length<i;)r.push(PL.empty);r[i]=PL.of(o.slice(1)),t.push(o[0],r[i].length);}}}return new n(t,r)}},{key:"createSet",value:function(e,t){return new n(e,t)}}]),n}();function iB(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!(0==t&&n<=0)){var i=e.length-2;i>=0&&n<=0&&n==e[i+1]?e[i]+=t:0==t&&0==e[i]?e[i+1]+=n:r?(e[i]+=t,e[i+1]+=n):e.push(t,n);}}function oB(e,t,n){if(0!=n.length){var r=t.length-2>>1;if(r<e.length)e[e.length-1]=e[e.length-1].append(n);else {for(;e.length<r;)e.push(PL.empty);e.push(n);}}}function aB(e,t,n){for(var r=e.inserted,i=0,o=0,a=0;a<e.sections.length;){var s=e.sections[a++],c=e.sections[a++];if(c<0)i+=s,o+=s;else {for(var u=i,l=o,f=PL.empty;u+=s,l+=c,c&&r&&(f=f.append(r[a-2>>1])),!(n||a==e.sections.length||e.sections[a+1]<0);)s=e.sections[a++],c=e.sections[a++];t(i,u,o,l,f),i=u,o=l;}}}function sB(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=[],o=r?[]:null,a=new uB(e),s=new uB(t),c=-1;;)if(-1==a.ins&&-1==s.ins){var u=Math.min(a.len,s.len);iB(i,u,-1),a.forward(u),s.forward(u);}else if(s.ins>=0&&(a.ins<0||c==a.i||0==a.off&&(s.len<a.len||s.len==a.len&&!n))){var l=s.len;for(iB(i,s.ins,-1);l;){var f=Math.min(a.len,l);a.ins>=0&&c<a.i&&a.len<=f&&(iB(i,0,a.ins),o&&oB(o,i,a.text),c=a.i),a.forward(f),l-=f;}s.next();}else {if(!(a.ins>=0)){if(a.done&&s.done)return o?rB.createSet(i,o):nB.create(i);throw new Error("Mismatched change set lengths")}for(var h=0,d=a.len;d;)if(-1==s.ins){var v=Math.min(d,s.len);h+=v,d-=v,s.forward(v);}else {if(!(0==s.ins&&s.len<d))break;d-=s.len,s.next();}iB(i,h,c<a.i?a.ins:0),o&&c<a.i&&oB(o,i,a.text),c=a.i,a.forward(a.len-d);}}function cB(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[],i=n?[]:null,o=new uB(e),a=new uB(t),s=!1;;){if(o.done&&a.done)return i?rB.createSet(r,i):nB.create(r);if(0==o.ins)iB(r,o.len,0,s),o.next();else if(0!=a.len||a.done){if(o.done||a.done)throw new Error("Mismatched change set lengths");var c=Math.min(o.len2,a.len),u=r.length;if(-1==o.ins){var l=-1==a.ins?-1:a.off?0:a.ins;iB(r,c,l,s),i&&l&&oB(i,r,a.text);}else -1==a.ins?(iB(r,o.off?0:o.len,c,s),i&&oB(i,r,o.textBit(c))):(iB(r,o.off?0:o.len,a.off?0:a.ins,s),i&&!a.off&&oB(i,r,a.text));s=(o.ins>c||a.ins>=0&&a.len>c)&&(s||r.length>u),o.forward2(c),a.forward(c);}else iB(r,0,a.ins,s),i&&oB(i,r,a.text),a.next();}}var uB=function(){function e(t){Bi(this,e),this.set=t,this.i=0,this.next();}return qi(e,[{key:"next",value:function(){var e=this.set.sections;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0;}},{key:"done",get:function(){return -2==this.ins}},{key:"len2",get:function(){return this.ins<0?this.len:this.ins}},{key:"text",get:function(){var e=this.set.inserted,t=this.i-2>>1;return t>=e.length?PL.empty:e[t]}},{key:"textBit",value:function(e){var t=this.set.inserted,n=this.i-2>>1;return n>=t.length&&!e?PL.empty:t[n].slice(this.off,null==e?void 0:this.off+e)}},{key:"forward",value:function(e){e==this.len?this.next():(this.len-=e,this.off+=e);}},{key:"forward2",value:function(e){-1==this.ins?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e);}}]),e}(),lB=function(){function e(t,n,r){Bi(this,e),this.from=t,this.to=n,this.flags=r;}return qi(e,[{key:"anchor",get:function(){return 16&this.flags?this.to:this.from}},{key:"head",get:function(){return 16&this.flags?this.from:this.to}},{key:"empty",get:function(){return this.from==this.to}},{key:"assoc",get:function(){return 4&this.flags?-1:8&this.flags?1:0}},{key:"bidiLevel",get:function(){var e=3&this.flags;return 3==e?null:e}},{key:"goalColumn",get:function(){var e=this.flags>>5;return 33554431==e?void 0:e}},{key:"map",value:function(t){var n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return this.empty?n=r=t.mapPos(this.from,i):(n=t.mapPos(this.from,1),r=t.mapPos(this.to,-1)),n==this.from&&r==this.to?this:new e(n,r,this.flags)}},{key:"extend",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(e<=this.anchor&&t>=this.anchor)return fB.range(e,t);var n=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return fB.range(this.anchor,n)}},{key:"eq",value:function(e){return this.anchor==e.anchor&&this.head==e.head}},{key:"toJSON",value:function(){return {anchor:this.anchor,head:this.head}}}],[{key:"fromJSON",value:function(e){if(!e||"number"!=typeof e.anchor||"number"!=typeof e.head)throw new RangeError("Invalid JSON representation for SelectionRange");return fB.range(e.anchor,e.head)}},{key:"create",value:function(t,n,r){return new e(t,n,r)}}]),e}(),fB=function(){function e(t,n){Bi(this,e),this.ranges=t,this.mainIndex=n;}return qi(e,[{key:"map",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return t.empty?this:e.create(this.ranges.map((function(e){return e.map(t,n)})),this.mainIndex)}},{key:"eq",value:function(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return !1;for(var t=0;t<this.ranges.length;t++)if(!this.ranges[t].eq(e.ranges[t]))return !1;return !0}},{key:"main",get:function(){return this.ranges[this.mainIndex]}},{key:"asSingle",value:function(){return 1==this.ranges.length?this:new e([this.main],0)}},{key:"addRange",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.create([t].concat(this.ranges),n?0:this.mainIndex+1)}},{key:"replaceRange",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.mainIndex,r=this.ranges.slice();return r[n]=t,e.create(r,this.mainIndex)}},{key:"toJSON",value:function(){return {ranges:this.ranges.map((function(e){return e.toJSON()})),main:this.mainIndex}}}],[{key:"fromJSON",value:function(t){if(!t||!Array.isArray(t.ranges)||"number"!=typeof t.main||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new e(t.ranges.map((function(e){return lB.fromJSON(e)})),t.main)}},{key:"single",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return new e([e.range(t,n)],0)}},{key:"create",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0==t.length)throw new RangeError("A selection needs at least one range");for(var r=0,i=0;i<t.length;i++){var o=t[i];if(o.empty?o.from<=r:o.from<r)return e.normalized(t.slice(),n);r=o.to;}return new e(t,n)}},{key:"cursor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return lB.create(e,e,(0==t?0:t<0?4:8)|(null==n?3:Math.min(2,n))|(null!=r?r:33554431)<<5)}},{key:"range",value:function(e,t,n,r){var i=(null!=n?n:33554431)<<5|(null==r?3:Math.min(2,r));return t<e?lB.create(t,e,24|i):lB.create(e,t,(t>e?4:0)|i)}},{key:"normalized",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=t[n];t.sort((function(e,t){return e.from-t.from})),n=t.indexOf(r);for(var i=1;i<t.length;i++){var o=t[i],a=t[i-1];if(o.empty?o.from<=a.to:o.from<a.to){var s=a.from,c=Math.max(o.to,a.to);i<=n&&n--,t.splice(--i,2,o.anchor>o.head?e.range(c,s):e.range(s,c));}}return new e(t,n)}}]),e}();function hB(e,t){var n,r=wi(e.ranges);try{for(r.s();!(n=r.n()).done;){if(n.value.to>t)throw new RangeError("Selection points outside of document")}}catch(e){r.e(e);}finally{r.f();}}var dB=0,vB=function(){function e(t,n,r,i,o){Bi(this,e),this.combine=t,this.compareInput=n,this.compare=r,this.isStatic=i,this.id=dB++,this.default=t([]),this.extensions="function"==typeof o?o(this):o;}return qi(e,[{key:"of",value:function(e){return new mB([],this,0,e)}},{key:"compute",value:function(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new mB(e,this,1,t)}},{key:"computeN",value:function(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new mB(e,this,2,t)}},{key:"from",value:function(e,t){return t||(t=function(e){return e}),this.compute([e],(function(n){return t(n.field(e))}))}}],[{key:"define",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new e(t.combine||function(e){return e},t.compareInput||function(e,t){return e===t},t.compare||(t.combine?function(e,t){return e===t}:pB),!!t.static,t.enables)}}]),e}();function pB(e,t){return e==t||e.length==t.length&&e.every((function(e,n){return e===t[n]}))}var mB=function(){function e(t,n,r,i){Bi(this,e),this.dependencies=t,this.facet=n,this.type=r,this.value=i,this.id=dB++;}return qi(e,[{key:"dynamicSlot",value:function(e){var t,n,r=this,i=this.value,o=this.facet.compareInput,a=this.id,s=e[a]>>1,c=2==this.type,u=!1,l=!1,f=[],h=wi(this.dependencies);try{for(h.s();!(n=h.n()).done;){var d=n.value;"doc"==d?u=!0:"selection"==d?l=!0:0==(1&(null!==(t=e[d.id])&&void 0!==t?t:1))&&f.push(e[d.id]);}}catch(e){h.e(e);}finally{h.f();}return {create:function(e){return e.values[s]=i(e),1},update:function(e,t){if(u&&t.docChanged||l&&(t.docChanged||t.selection)||yB(e,f)){var n=i(e);if(c?!gB(n,e.values[s],o):!o(n,e.values[s]))return e.values[s]=n,1}return 0},reconfigure:function(e,t){var n,u=t.config.address[a];if(null!=u){var l=PB(t,u);if(r.dependencies.every((function(n){return n instanceof vB?t.facet(n)===e.facet(n):!(n instanceof wB)||t.field(n,!1)==e.field(n,!1)}))||(c?gB(n=i(e),l,o):o(n=i(e),l)))return e.values[s]=l,0}else n=i(e);return e.values[s]=n,1}}}}]),e}();function gB(e,t,n){if(e.length!=t.length)return !1;for(var r=0;r<e.length;r++)if(!n(e[r],t[r]))return !1;return !0}function yB(e,t){var n,r=!1,i=wi(t);try{for(i.s();!(n=i.n()).done;){1&AB(e,n.value)&&(r=!0);}}catch(e){i.e(e);}finally{i.f();}return r}var bB=vB.define({static:!0}),wB=function(){function e(t,n,r,i,o){Bi(this,e),this.id=t,this.createF=n,this.updateF=r,this.compareF=i,this.spec=o,this.provides=void 0;}return qi(e,[{key:"create",value:function(e){var t=this,n=e.facet(bB).find((function(e){return e.field==t}));return ((null==n?void 0:n.create)||this.createF)(e)}},{key:"slot",value:function(e){var t=this,n=e[this.id]>>1;return {create:function(e){return e.values[n]=t.create(e),1},update:function(e,r){var i=e.values[n],o=t.updateF(i,r);return t.compareF(i,o)?0:(e.values[n]=o,1)},reconfigure:function(e,r){return null!=r.config.address[t.id]?(e.values[n]=r.field(t),0):(e.values[n]=t.create(e),1)}}}},{key:"init",value:function(e){return [this,bB.of({field:this,create:e})]}},{key:"extension",get:function(){return this}}],[{key:"define",value:function(t){var n=new e(dB++,t.create,t.update,t.compare||function(e,t){return e===t},t);return t.provide&&(n.provides=t.provide(n)),n}}]),e}(),xB=4,kB=3,jB=2,SB=1;function CB(e){return function(t){return new _B(t,e)}}var $B={highest:CB(0),high:CB(SB),default:CB(jB),low:CB(kB),lowest:CB(xB)},_B=qi((function e(t,n){Bi(this,e),this.inner=t,this.prec=n;})),OB=function(){function e(){Bi(this,e);}return qi(e,[{key:"of",value:function(e){return new MB(this,e)}},{key:"reconfigure",value:function(t){return e.reconfigure.of({compartment:this,extension:t})}},{key:"get",value:function(e){return e.config.compartments.get(this)}}]),e}(),MB=qi((function e(t,n){Bi(this,e),this.compartment=t,this.inner=n;})),EB=function(){function e(t,n,r,i,o,a){for(Bi(this,e),this.base=t,this.compartments=n,this.dynamicSlots=r,this.address=i,this.staticValues=o,this.facets=a,this.statusTemplate=[];this.statusTemplate.length<r.length;)this.statusTemplate.push(0);}return qi(e,[{key:"staticFacet",value:function(e){var t=this.address[e.id];return null==t?e.default:this.staticValues[t>>1]}}],[{key:"resolve",value:function(t,n,r){var i,o=[],a=Object.create(null),s=new Map,c=wi(function(e,t,n){var r=[[],[],[],[],[]],i=new Map;function o(e,a){var s=i.get(e);if(null!=s){if(s<=a)return;var c=r[s].indexOf(e);c>-1&&r[s].splice(c,1),e instanceof MB&&n.delete(e.compartment);}if(i.set(e,a),Array.isArray(e)){var u,l=wi(e);try{for(l.s();!(u=l.n()).done;){o(u.value,a);}}catch(e){l.e(e);}finally{l.f();}}else if(e instanceof MB){if(n.has(e.compartment))throw new RangeError("Duplicate use of compartment in extensions");var f=t.get(e.compartment)||e.inner;n.set(e.compartment,f),o(f,a);}else if(e instanceof _B)o(e.inner,e.prec);else if(e instanceof wB)r[a].push(e),e.provides&&o(e.provides,a);else if(e instanceof mB)r[a].push(e),e.facet.extensions&&o(e.facet.extensions,jB);else {var h=e.extension;if(!h)throw new Error("Unrecognized extension value in extension set (".concat(e,"). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks."));o(h,a);}}return o(e,jB),r.reduce((function(e,t){return e.concat(t)}))}(t,n,s));try{for(c.s();!(i=c.n()).done;){var u=i.value;u instanceof wB?o.push(u):(a[u.facet.id]||(a[u.facet.id]=[])).push(u);}}catch(e){c.e(e);}finally{c.f();}for(var l=Object.create(null),f=[],h=[],d=function(){var e=p[v];l[e.id]=h.length<<1,h.push((function(t){return e.slot(t)}));},v=0,p=o;v<p.length;v++)d();var m=null==r?void 0:r.config.facets,g=function(){var e=a[y],t=e[0].facet,n=m&&m[y]||[];if(e.every((function(e){return 0==e.type})))if(l[t.id]=f.length<<1|1,pB(n,e))f.push(r.facet(t));else {var i=t.combine(e.map((function(e){return e.value})));f.push(r&&t.compare(i,r.facet(t))?r.facet(t):i);}else {var o,s=wi(e);try{var c=function(){var e=o.value;0==e.type?(l[e.id]=f.length<<1|1,f.push(e.value)):(l[e.id]=h.length<<1,h.push((function(t){return e.dynamicSlot(t)})));};for(s.s();!(o=s.n()).done;)c();}catch(e){s.e(e);}finally{s.f();}l[t.id]=h.length<<1,h.push((function(n){return function(e,t,n){var r=n.map((function(t){return e[t.id]})),i=n.map((function(e){return e.type})),o=r.filter((function(e){return !(1&e)})),a=e[t.id]>>1;function s(e){for(var n=[],o=0;o<r.length;o++){var a=PB(e,r[o]);if(2==i[o]){var s,c=wi(a);try{for(c.s();!(s=c.n()).done;){var u=s.value;n.push(u);}}catch(e){c.e(e);}finally{c.f();}}else n.push(a);}return t.combine(n)}return {create:function(e){var t,n=wi(r);try{for(n.s();!(t=n.n()).done;)AB(e,t.value);}catch(e){n.e(e);}finally{n.f();}return e.values[a]=s(e),1},update:function(e,n){if(!yB(e,o))return 0;var r=s(e);return t.compare(r,e.values[a])?0:(e.values[a]=r,1)},reconfigure:function(e,i){var o=yB(e,r),c=i.config.facets[t.id],u=i.facet(t);if(c&&!o&&pB(n,c))return e.values[a]=u,0;var l=s(e);return t.compare(l,u)?(e.values[a]=u,0):(e.values[a]=l,1)}}}(n,t,e)}));}};for(var y in a)g();var b=h.map((function(e){return e(l)}));return new e(t,s,b,l,f,a)}}]),e}();function AB(e,t){if(1&t)return 2;var n=t>>1,r=e.status[n];if(4==r)throw new Error("Cyclic dependency between fields and/or facets");if(2&r)return r;e.status[n]=4;var i=e.computeSlot(e,e.config.dynamicSlots[n]);return e.status[n]=2|i}function PB(e,t){return 1&t?e.config.staticValues[t>>1]:e.values[t>>1]}var TB=vB.define(),RB=vB.define({combine:function(e){return e.some((function(e){return e}))},static:!0}),NB=vB.define({combine:function(e){return e.length?e[0]:void 0},static:!0}),IB=vB.define(),DB=vB.define(),LB=vB.define(),BB=vB.define({combine:function(e){return !!e.length&&e[0]}}),zB=function(){function e(t,n){Bi(this,e),this.type=t,this.value=n;}return qi(e,null,[{key:"define",value:function(){return new qB}}]),e}(),qB=function(){function e(){Bi(this,e);}return qi(e,[{key:"of",value:function(e){return new zB(this,e)}}]),e}(),FB=function(){function e(t){Bi(this,e),this.map=t;}return qi(e,[{key:"of",value:function(e){return new VB(this,e)}}]),e}(),VB=function(){function e(t,n){Bi(this,e),this.type=t,this.value=n;}return qi(e,[{key:"map",value:function(t){var n=this.type.map(this.value,t);return void 0===n?void 0:n==this.value?this:new e(this.type,n)}},{key:"is",value:function(e){return this.type==e}}],[{key:"define",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new FB(e.map||function(e){return e})}},{key:"mapEffects",value:function(e,t){if(!e.length)return e;var n,r=[],i=wi(e);try{for(i.s();!(n=i.n()).done;){var o=n.value.map(t);o&&r.push(o);}}catch(e){i.e(e);}finally{i.f();}return r}}]),e}();VB.reconfigure=VB.define(),VB.appendConfig=VB.define();var WB=function(){function e(t,n,r,i,o,a){Bi(this,e),this.startState=t,this.changes=n,this.selection=r,this.effects=i,this.annotations=o,this.scrollIntoView=a,this._doc=null,this._state=null,r&&hB(r,n.newLength),o.some((function(t){return t.type==e.time}))||(this.annotations=o.concat(e.time.of(Date.now())));}return qi(e,[{key:"newDoc",get:function(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}},{key:"newSelection",get:function(){return this.selection||this.startState.selection.map(this.changes)}},{key:"state",get:function(){return this._state||this.startState.applyTransaction(this),this._state}},{key:"annotation",value:function(e){var t,n=wi(this.annotations);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.type==e)return r.value}}catch(e){n.e(e);}finally{n.f();}}},{key:"docChanged",get:function(){return !this.changes.empty}},{key:"reconfigured",get:function(){return this.startState.config!=this.state.config}},{key:"isUserEvent",value:function(t){var n=this.annotation(e.userEvent);return !(!n||!(n==t||n.length>t.length&&n.slice(0,t.length)==t&&"."==n[t.length]))}}],[{key:"create",value:function(t,n,r,i,o,a){return new e(t,n,r,i,o,a)}}]),e}();function HB(e,t){for(var n=[],r=0,i=0;;){var o=void 0,a=void 0;if(r<e.length&&(i==t.length||t[i]>=e[r]))o=e[r++],a=e[r++];else {if(!(i<t.length))return n;o=t[i++],a=t[i++];}!n.length||n[n.length-1]<o?n.push(o,a):n[n.length-1]<a&&(n[n.length-1]=a);}}function UB(e,t,n){var r,i,o,a;return n?(i=t.changes,o=rB.empty(t.changes.length),a=e.changes.compose(t.changes)):(i=t.changes.map(e.changes),o=e.changes.mapDesc(t.changes,!0),a=e.changes.compose(i)),{changes:a,selection:t.selection?t.selection.map(o):null===(r=e.selection)||void 0===r?void 0:r.map(i),effects:VB.mapEffects(e.effects,i).concat(VB.mapEffects(t.effects,o)),annotations:e.annotations.length?e.annotations.concat(t.annotations):t.annotations,scrollIntoView:e.scrollIntoView||t.scrollIntoView}}function JB(e,t,n){var r=t.selection,i=QB(t.annotations);return t.userEvent&&(i=i.concat(WB.userEvent.of(t.userEvent))),{changes:t.changes instanceof rB?t.changes:rB.of(t.changes||[],n,e.facet(NB)),selection:r&&(r instanceof fB?r:fB.single(r.anchor,r.head)),effects:QB(t.effects),annotations:i,scrollIntoView:!!t.scrollIntoView}}function KB(e,t,n){var r=JB(e,t.length?t[0]:{},e.doc.length);t.length&&!1===t[0].filter&&(n=!1);for(var i=1;i<t.length;i++){!1===t[i].filter&&(n=!1);var o=!!t[i].sequential;r=UB(r,JB(e,t[i],o?r.changes.newLength:e.doc.length),o);}var a=WB.create(e,r.changes,r.selection,r.effects,r.annotations,r.scrollIntoView);return function(e){for(var t=e.startState,n=t.facet(LB),r=e,i=n.length-1;i>=0;i--){var o=n[i](e);o&&Object.keys(o).length&&(r=UB(r,JB(t,o,e.changes.newLength),!0));}return r==e?e:WB.create(t,e.changes,e.selection,r.effects,r.annotations,r.scrollIntoView)}(n?function(e){var t,n=e.startState,r=!0,i=wi(n.facet(IB));try{for(i.s();!(t=i.n()).done;){var o=(0,t.value)(e);if(!1===o){r=!1;break}Array.isArray(o)&&(r=!0===r?o:HB(r,o));}}catch(e){i.e(e);}finally{i.f();}if(!0!==r){var a,s;if(!1===r)s=e.changes.invertedDesc,a=rB.empty(n.doc.length);else {var c=e.changes.filter(r);a=c.changes,s=c.filtered.mapDesc(c.changes).invertedDesc;}e=WB.create(n,a,e.selection&&e.selection.map(s),VB.mapEffects(e.effects,s),e.annotations,e.scrollIntoView);}for(var u=n.facet(DB),l=u.length-1;l>=0;l--){var f=u[l](e);e=f instanceof WB?f:Array.isArray(f)&&1==f.length&&f[0]instanceof WB?f[0]:KB(n,QB(f),!1);}return e}(a):a)}WB.time=zB.define(),WB.userEvent=zB.define(),WB.addToHistory=zB.define(),WB.remote=zB.define();var GB=[];function QB(e){return null==e?GB:Array.isArray(e)?e:[e]}var YB,XB=function(e){return e[e.Word=0]="Word",e[e.Space=1]="Space",e[e.Other=2]="Other",e}(XB||(XB={})),ZB=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;try{YB=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u");}catch($S){}function ez(e){return function(t){if(!/\S/.test(t))return XB.Space;if(function(e){if(YB)return YB.test(e);for(var t=0;t<e.length;t++){var n=e[t];if(/\w/.test(n)||n>""&&(n.toUpperCase()!=n.toLowerCase()||ZB.test(n)))return !0}return !1}(t))return XB.Word;for(var n=0;n<e.length;n++)if(t.indexOf(e[n])>-1)return XB.Word;return XB.Other}}var tz=function(){function e(t,n,r,i,o,a){Bi(this,e),this.config=t,this.doc=n,this.selection=r,this.values=i,this.status=t.statusTemplate.slice(),this.computeSlot=o,a&&(a._state=this);for(var s=0;s<this.config.dynamicSlots.length;s++)AB(this,s<<1);this.computeSlot=null;}return qi(e,[{key:"field",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.config.address[e.id];if(null!=n)return AB(this,n),PB(this,n);if(t)throw new RangeError("Field is not present in this state")}},{key:"update",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return KB(this,t,!0)}},{key:"applyTransaction",value:function(t){var n,r,i=this,o=this.config,a=o,s=a.base,c=a.compartments,u=wi(t.effects);try{for(u.s();!(n=u.n()).done;){var l=n.value;l.is(OB.reconfigure)?(o&&(c=new Map,o.compartments.forEach((function(e,t){return c.set(t,e)})),o=null),c.set(l.value.compartment,l.value.extension)):l.is(VB.reconfigure)?(o=null,s=l.value):l.is(VB.appendConfig)&&(o=null,s=QB(s).concat(l.value));}}catch(e){u.e(e);}finally{u.f();}o?r=t.startState.values.slice():r=new e(o=EB.resolve(s,c,this),this.doc,this.selection,o.dynamicSlots.map((function(){return null})),(function(e,t){return t.reconfigure(e,i)}),null).values;new e(o,t.newDoc,t.newSelection,r,(function(e,n){return n.update(e,t)}),t);}},{key:"replaceSelection",value:function(e){return "string"==typeof e&&(e=this.toText(e)),this.changeByRange((function(t){return {changes:{from:t.from,to:t.to,insert:e},range:fB.cursor(t.from+e.length)}}))}},{key:"changeByRange",value:function(e){for(var t=this.selection,n=e(t.ranges[0]),r=this.changes(n.changes),i=[n.range],o=QB(n.effects),a=1;a<t.ranges.length;a++){for(var s=e(t.ranges[a]),c=this.changes(s.changes),u=c.map(r),l=0;l<a;l++)i[l]=i[l].map(u);var f=r.mapDesc(c,!0);i.push(s.range.map(f)),r=r.compose(u),o=VB.mapEffects(o,u).concat(VB.mapEffects(QB(s.effects),f));}return {changes:r,selection:fB.create(i,t.mainIndex),effects:o}}},{key:"changes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t instanceof rB?t:rB.of(t,this.doc.length,this.facet(e.lineSeparator))}},{key:"toText",value:function(t){return PL.of(t.split(this.facet(e.lineSeparator)||eB))}},{key:"sliceDoc",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.doc.length;return this.doc.sliceString(e,t,this.lineBreak)}},{key:"facet",value:function(e){var t=this.config.address[e.id];return null==t?e.default:(AB(this,t),PB(this,t))}},{key:"toJSON",value:function(e){var t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(var n in e){var r=e[n];r instanceof wB&&null!=this.config.address[r.id]&&(t[n]=r.spec.toJSON(this.field(e[n]),this));}return t}},{key:"tabSize",get:function(){return this.facet(e.tabSize)}},{key:"lineBreak",get:function(){return this.facet(e.lineSeparator)||"\n"}},{key:"readOnly",get:function(){return this.facet(BB)}},{key:"phrase",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o,a=wi(this.facet(e.phrases));try{for(a.s();!(o=a.n()).done;){var s=o.value;if(Object.prototype.hasOwnProperty.call(s,t)){t=s[t];break}}}catch(e){a.e(e);}finally{a.f();}return r.length&&(t=t.replace(/\$(\$|\d*)/g,(function(e,t){if("$"==t)return "$";var n=+(t||1);return !n||n>r.length?e:r[n-1]}))),t}},{key:"languageDataAt",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=[],o=wi(this.facet(TB));try{for(o.s();!(n=o.n()).done;){var a,s=n.value,c=wi(s(this,t,r));try{for(c.s();!(a=c.n()).done;){var u=a.value;Object.prototype.hasOwnProperty.call(u,e)&&i.push(u[e]);}}catch(e){c.e(e);}finally{c.f();}}}catch(e){o.e(e);}finally{o.f();}return i}},{key:"charCategorizer",value:function(e){return ez(this.languageDataAt("wordChars",e).join(""))}},{key:"wordAt",value:function(e){for(var t=this.doc.lineAt(e),n=t.text,r=t.from,i=t.length,o=this.charCategorizer(e),a=e-r,s=e-r;a>0;){var c=UL(n,a,!1);if(o(n.slice(c,a))!=XB.Word)break;a=c;}for(;s<i;){var u=UL(n,s);if(o(n.slice(s,u))!=XB.Word)break;s=u;}return a==s?null:fB.range(a+r,s+r)}}],[{key:"fromJSON",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;if(!t||"string"!=typeof t.doc)throw new RangeError("Invalid JSON representation for EditorState");var i=[];if(r){var o=function(){if(Object.prototype.hasOwnProperty.call(t,a)){var e=r[a],n=t[a];i.push(e.init((function(t){return e.spec.fromJSON(n,t)})));}};for(var a in r)o();}return e.create({doc:t.doc,selection:fB.fromJSON(t.selection),extensions:n.extensions?i.concat([n.extensions]):i})}},{key:"create",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=EB.resolve(t.extensions||[],new Map),r=t.doc instanceof PL?t.doc:PL.of((t.doc||"").split(n.staticFacet(e.lineSeparator)||eB)),i=t.selection?t.selection instanceof fB?t.selection:fB.single(t.selection.anchor,t.selection.head):fB.single(0);return hB(i,r.length),n.staticFacet(RB)||(i=i.asSingle()),new e(n,r,i,n.dynamicSlots.map((function(){return null})),(function(e,t){return t.create(e)}),null)}}]),e}();function nz(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={},o=wi(e);try{for(o.s();!(n=o.n()).done;)for(var a=n.value,s=0,c=Object.keys(a);s<c.length;s++){var u=c[s],l=a[u],f=i[u];if(void 0===f)i[u]=l;else if(f===l||void 0===l);else {if(!Object.hasOwnProperty.call(r,u))throw new Error("Config merge conflict for field "+u);i[u]=r[u](f,l);}}}catch(e){o.e(e);}finally{o.f();}for(var h in t)void 0===i[h]&&(i[h]=t[h]);return i}tz.allowMultipleSelections=RB,tz.tabSize=vB.define({combine:function(e){return e.length?e[0]:4}}),tz.lineSeparator=NB,tz.readOnly=BB,tz.phrases=vB.define({compare:function(e,t){var n=Object.keys(e),r=Object.keys(t);return n.length==r.length&&n.every((function(n){return e[n]==t[n]}))}}),tz.languageData=TB,tz.changeFilter=IB,tz.transactionFilter=DB,tz.transactionExtender=LB,OB.reconfigure=VB.define();var rz=function(){function e(){Bi(this,e);}return qi(e,[{key:"eq",value:function(e){return this==e}},{key:"range",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return iz.create(e,t,this)}}]),e}();rz.prototype.startSide=rz.prototype.endSide=0,rz.prototype.point=!1,rz.prototype.mapMode=tB.TrackDel;var iz=function(){function e(t,n,r){Bi(this,e),this.from=t,this.to=n,this.value=r;}return qi(e,null,[{key:"create",value:function(t,n,r){return new e(t,n,r)}}]),e}();function oz(e,t){return e.from-t.from||e.value.startSide-t.value.startSide}var az=function(){function e(t,n,r,i){Bi(this,e),this.from=t,this.to=n,this.value=r,this.maxPoint=i;}return qi(e,[{key:"length",get:function(){return this.to[this.to.length-1]}},{key:"findIndex",value:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=n?this.to:this.from,o=r,a=i.length;;){if(o==a)return o;var s=o+a>>1,c=i[s]-e||(n?this.value[s].endSide:this.value[s].startSide)-t;if(s==o)return c>=0?o:a;c>=0?a=s:o=s+1;}}},{key:"between",value:function(e,t,n,r){for(var i=this.findIndex(t,-1e9,!0),o=this.findIndex(n,1e9,!1,i);i<o;i++)if(!1===r(this.from[i]+e,this.to[i]+e,this.value[i]))return !1}},{key:"map",value:function(t,n){for(var r=[],i=[],o=[],a=-1,s=-1,c=0;c<this.value.length;c++){var u=this.value[c],l=this.from[c]+t,f=this.to[c]+t,h=void 0,d=void 0;if(l==f){var v=n.mapPos(l,u.startSide,u.mapMode);if(null==v)continue;if(h=d=v,u.startSide!=u.endSide&&(d=n.mapPos(l,u.endSide))<h)continue}else if((h=n.mapPos(l,u.startSide))>(d=n.mapPos(f,u.endSide))||h==d&&u.startSide>0&&u.endSide<=0)continue;(d-h||u.endSide-u.startSide)<0||(a<0&&(a=h),u.point&&(s=Math.max(s,d-h)),r.push(u),i.push(h-a),o.push(d-a));}return {mapped:r.length?new e(i,o,r,s):null,pos:a}}}]),e}(),sz=function(){function e(t,n,r,i){Bi(this,e),this.chunkPos=t,this.chunk=n,this.nextLayer=r,this.maxPoint=i;}return qi(e,[{key:"length",get:function(){var e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}},{key:"size",get:function(){if(this.isEmpty)return 0;var e,t=this.nextLayer.size,n=wi(this.chunk);try{for(n.s();!(e=n.n()).done;){t+=e.value.value.length;}}catch(e){n.e(e);}finally{n.f();}return t}},{key:"chunkEnd",value:function(e){return this.chunkPos[e]+this.chunk[e].length}},{key:"update",value:function(t){var n=t.add,r=void 0===n?[]:n,i=t.sort,o=void 0!==i&&i,a=t.filterFrom,s=void 0===a?0:a,c=t.filterTo,u=void 0===c?this.length:c,l=t.filter;if(0==r.length&&!l)return this;if(o&&(r=r.slice().sort(oz)),this.isEmpty)return r.length?e.of(r):this;for(var f=new fz(this,null,-1).goto(0),h=0,d=[],v=new uz;f.value||h<r.length;)if(h<r.length&&(f.from-r[h].from||f.startSide-r[h].value.startSide)>=0){var p=r[h++];v.addInner(p.from,p.to,p.value)||d.push(p);}else 1==f.rangeIndex&&f.chunkIndex<this.chunk.length&&(h==r.length||this.chunkEnd(f.chunkIndex)<r[h].from)&&(!l||s>this.chunkEnd(f.chunkIndex)||u<this.chunkPos[f.chunkIndex])&&v.addChunk(this.chunkPos[f.chunkIndex],this.chunk[f.chunkIndex])?f.nextChunk():((!l||s>f.to||u<f.from||l(f.from,f.to,f.value))&&(v.addInner(f.from,f.to,f.value)||d.push(iz.create(f.from,f.to,f.value))),f.next());return v.finishInner(this.nextLayer.isEmpty&&!d.length?e.empty:this.nextLayer.update({add:d,filter:l,filterFrom:s,filterTo:u}))}},{key:"map",value:function(t){if(t.empty||this.isEmpty)return this;for(var n=[],r=[],i=-1,o=0;o<this.chunk.length;o++){var a=this.chunkPos[o],s=this.chunk[o],c=t.touchesRange(a,a+s.length);if(!1===c)i=Math.max(i,s.maxPoint),n.push(s),r.push(t.mapPos(a));else if(!0===c){var u=s.map(a,t),l=u.mapped,f=u.pos;l&&(i=Math.max(i,l.maxPoint),n.push(l),r.push(f));}}var h=this.nextLayer.map(t);return 0==n.length?h:new e(r,n,h||e.empty,i)}},{key:"between",value:function(e,t,n){if(!this.isEmpty){for(var r=0;r<this.chunk.length;r++){var i=this.chunkPos[r],o=this.chunk[r];if(t>=i&&e<=i+o.length&&!1===o.between(i,e-i,t-i,n))return}this.nextLayer.between(e,t,n);}}},{key:"iter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return hz.from([this]).goto(e)}},{key:"isEmpty",get:function(){return this.nextLayer==this}}],[{key:"create",value:function(t,n,r,i){return new e(t,n,r,i)}},{key:"iter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return hz.from(e).goto(t)}},{key:"compare",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,o=e.filter((function(e){return e.maxPoint>0||!e.isEmpty&&e.maxPoint>=i})),a=t.filter((function(e){return e.maxPoint>0||!e.isEmpty&&e.maxPoint>=i})),s=lz(o,a,n),c=new vz(o,s,i),u=new vz(a,s,i);n.iterGaps((function(e,t,n){return pz(c,e,u,t,n,r)})),n.empty&&0==n.length&&pz(c,0,u,0,0,r);}},{key:"eq",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;null==r&&(r=999999999);var i=e.filter((function(e){return !e.isEmpty&&t.indexOf(e)<0})),o=t.filter((function(t){return !t.isEmpty&&e.indexOf(t)<0}));if(i.length!=o.length)return !1;if(!i.length)return !0;for(var a=lz(i,o),s=new vz(i,a,0).goto(n),c=new vz(o,a,0).goto(n);;){if(s.to!=c.to||!mz(s.active,c.active)||s.point&&(!c.point||!s.point.eq(c.point)))return !1;if(s.to>r)return !0;s.next(),c.next();}}},{key:"spans",value:function(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,o=new vz(e,null,i).goto(t),a=t,s=o.openStart;;){var c=Math.min(o.to,n);if(o.point){var u=o.activeForPoint(o.to),l=o.pointFrom<t?u.length+1:Math.min(u.length,s);r.point(a,c,o.point,u,l,o.pointRank),s=Math.min(o.openEnd(c),u.length);}else c>a&&(r.span(a,c,o.active,s),s=o.openEnd(c));if(o.to>n)return s+(o.point&&o.to>n?1:0);a=o.to,o.next();}}},{key:"of",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new uz,i=wi(e instanceof iz?[e]:n?cz(e):e);try{for(i.s();!(t=i.n()).done;){var o=t.value;r.add(o.from,o.to,o.value);}}catch(e){i.e(e);}finally{i.f();}return r.finish()}}]),e}();function cz(e){if(e.length>1)for(var t=e[0],n=1;n<e.length;n++){var r=e[n];if(oz(t,r)>0)return e.slice().sort(oz);t=r;}return e}sz.empty=new sz([],[],null,-1),sz.empty.nextLayer=sz.empty;var uz=function(){function e(){Bi(this,e),this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null;}return qi(e,[{key:"finishChunk",value:function(e){this.chunks.push(new az(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[]);}},{key:"add",value:function(t,n,r){this.addInner(t,n,r)||(this.nextLayer||(this.nextLayer=new e)).add(t,n,r);}},{key:"addInner",value:function(e,t,n){var r=e-this.lastTo||n.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return !(r<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=t,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}},{key:"addChunk",value:function(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return !1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);var n=t.value.length-1;return this.last=t.value[n],this.lastFrom=t.from[n]+e,this.lastTo=t.to[n]+e,!0}},{key:"finish",value:function(){return this.finishInner(sz.empty)}},{key:"finishInner",value:function(e){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return e;var t=sz.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}]),e}();function lz(e,t,n){var r,i=new Map,o=wi(e);try{for(o.s();!(r=o.n()).done;)for(var a=r.value,s=0;s<a.chunk.length;s++)a.chunk[s].maxPoint<=0&&i.set(a.chunk[s],a.chunkPos[s]);}catch(e){o.e(e);}finally{o.f();}var c,u=new Set,l=wi(t);try{for(l.s();!(c=l.n()).done;)for(var f=c.value,h=0;h<f.chunk.length;h++){var d=i.get(f.chunk[h]);null==d||(n?n.mapPos(d):d)!=f.chunkPos[h]||(null==n?void 0:n.touchesRange(d,d+f.chunk[h].length))||u.add(f.chunk[h]);}}catch(e){l.e(e);}finally{l.f();}return u}var fz=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Bi(this,e),this.layer=t,this.skip=n,this.minPoint=r,this.rank=i;}return qi(e,[{key:"startSide",get:function(){return this.value?this.value.startSide:0}},{key:"endSide",get:function(){return this.value?this.value.endSide:0}},{key:"goto",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1e9;return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}},{key:"gotoInner",value:function(e,t,n){for(;this.chunkIndex<this.layer.chunk.length;){var r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1;}if(this.chunkIndex<this.layer.chunk.length){var i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!n||this.rangeIndex<i)&&this.setRangeIndex(i);}this.next();}},{key:"forward",value:function(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0);}},{key:"next",value:function(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}var e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],n=e+t.from[this.rangeIndex];if(this.from=n,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}},{key:"setRangeIndex",value:function(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0;}else this.rangeIndex=e;}},{key:"nextChunk",value:function(){this.chunkIndex++,this.rangeIndex=0,this.next();}},{key:"compare",value:function(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}]),e}(),hz=function(){function e(t){Bi(this,e),this.heap=t;}return qi(e,[{key:"startSide",get:function(){return this.value?this.value.startSide:0}},{key:"goto",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1e9,r=wi(this.heap);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.goto(e,n);}}catch(e){r.e(e);}finally{r.f();}for(var o=this.heap.length>>1;o>=0;o--)dz(this.heap,o);return this.next(),this}},{key:"forward",value:function(e,t){var n,r=wi(this.heap);try{for(r.s();!(n=r.n()).done;){n.value.forward(e,t);}}catch(e){r.e(e);}finally{r.f();}for(var i=this.heap.length>>1;i>=0;i--)dz(this.heap,i);(this.to-e||this.value.endSide-t)<0&&this.next();}},{key:"next",value:function(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else {var e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),dz(this.heap,0);}}}],[{key:"from",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=[],o=0;o<t.length;o++)for(var a=t[o];!a.isEmpty;a=a.nextLayer)a.maxPoint>=r&&i.push(new fz(a,n,r,o));return 1==i.length?i[0]:new e(i)}}]),e}();function dz(e,t){for(var n=e[t];;){var r=1+(t<<1);if(r>=e.length)break;var i=e[r];if(r+1<e.length&&i.compare(e[r+1])>=0&&(i=e[r+1],r++),n.compare(i)<0)break;e[r]=n,e[t]=i,t=r;}}var vz=function(){function e(t,n,r){Bi(this,e),this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=hz.from(t,n,r);}return qi(e,[{key:"goto",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1e9;return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}},{key:"forward",value:function(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t);}},{key:"removeActive",value:function(e){gz(this.active,e),gz(this.activeTo,e),gz(this.activeRank,e),this.minActive=bz(this.active,this.activeTo);}},{key:"addActive",value:function(e){for(var t=0,n=this.cursor,r=n.value,i=n.to,o=n.rank;t<this.activeRank.length&&this.activeRank[t]<=o;)t++;yz(this.active,t,r),yz(this.activeTo,t,i),yz(this.activeRank,t,o),e&&yz(e,t,this.cursor.from),this.minActive=bz(this.active,this.activeTo);}},{key:"next",value:function(){var e=this.to,t=this.point;this.point=null;for(var n=this.openStart<0?[]:null;;){var r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),n&&gz(n,r);}else {if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}var i=this.cursor.value;if(i.point){if(!(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=i,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=i.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next();}else this.addActive(n),this.cursor.next();}}if(n){this.openStart=0;for(var o=n.length-1;o>=0&&n[o]<e;o--)this.openStart++;}}},{key:"activeForPoint",value:function(e){if(!this.active.length)return this.active;for(var t=[],n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&t.push(this.active[n]);return t.reverse()}},{key:"openEnd",value:function(e){for(var t=0,n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)t++;return t}}]),e}();function pz(e,t,n,r,i,o){e.goto(t),n.goto(r);for(var a=r+i,s=r,c=r-t;;){var u=e.to+c-n.to||e.endSide-n.endSide,l=u<0?e.to+c:n.to,f=Math.min(l,a);if(e.point||n.point?e.point&&n.point&&(e.point==n.point||e.point.eq(n.point))&&mz(e.activeForPoint(e.to+c),n.activeForPoint(n.to))||o.comparePoint(s,f,e.point,n.point):f>s&&!mz(e.active,n.active)&&o.compareRange(s,f,e.active,n.active),l>a)break;s=l,u<=0&&e.next(),u>=0&&n.next();}}function mz(e,t){if(e.length!=t.length)return !1;for(var n=0;n<e.length;n++)if(e[n]!=t[n]&&!e[n].eq(t[n]))return !1;return !0}function gz(e,t){for(var n=t,r=e.length-1;n<r;n++)e[n]=e[n+1];e.pop();}function yz(e,t,n){for(var r=e.length-1;r>=t;r--)e[r+1]=e[r];e[t]=n;}function bz(e,t){for(var n=-1,r=1e9,i=0;i<t.length;i++)(t[i]-r||e[i].endSide-e[n].endSide)<0&&(n=i,r=t[i]);return n}function wz(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,r=0,i=0;i<n;)9==e.charCodeAt(i)?(r+=t-r%t,i++):(r++,i=UL(e,i));return r}function xz(e,t,n,r){for(var i=0,o=0;;){if(o>=t)return i;if(i==e.length)break;o+=9==e.charCodeAt(i)?n-o%n:1,i=UL(e,i);}return !0===r?-1:e.length}for(var kz="undefined"==typeof Symbol?"__":Symbol.for(""),jz="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),Sz="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{},Cz=function(){function e(t,n){Bi(this,e),this.rules=[];var r=(n||{}).finish;function i(e){return /^@/.test(e)?[e]:e.split(/,\s*/)}function o(e,t,n,a){var s=[],c=/^@(\w+)\b/.exec(e[0]),u=c&&"keyframes"==c[1];if(c&&null==t)return n.push(e[0]+";");for(var l in t){var f=t[l];if(/&/.test(l))o(l.split(/,\s*/).map((function(t){return e.map((function(e){return t.replace(/&/,e)}))})).reduce((function(e,t){return e.concat(t)})),f,n);else if(f&&"object"==Ji(f)){if(!c)throw new RangeError("The value of a property ("+l+") should be a primitive value.");o(i(l),f,s,u);}else null!=f&&s.push(l.replace(/_.*/,"").replace(/[A-Z]/g,(function(e){return "-"+e.toLowerCase()}))+": "+f+";");}(s.length||u)&&n.push((!r||c||a?e:e.map(r)).join(", ")+" {"+s.join(" ")+"}");}for(var a in t)o(i(a),t[a],this.rules);}return qi(e,[{key:"getRules",value:function(){return this.rules.join("\n")}}],[{key:"newName",value:function(){var e=Sz[kz]||1;return Sz[kz]=e+1,""+e.toString(36)}},{key:"mount",value:function(e,t){(e[jz]||new _z(e)).mount(Array.isArray(t)?t:[t]);}}]),e}(),$z=null,_z=function(){function e(t){if(Bi(this,e),!t.head&&t.adoptedStyleSheets&&"undefined"!=typeof CSSStyleSheet){if($z)return t.adoptedStyleSheets=[$z.sheet].concat(t.adoptedStyleSheets),t[jz]=$z;this.sheet=new CSSStyleSheet,t.adoptedStyleSheets=[this.sheet].concat(t.adoptedStyleSheets),$z=this;}else {this.styleTag=(t.ownerDocument||t).createElement("style");var n=t.head||t;n.insertBefore(this.styleTag,n.firstChild);}this.modules=[],t[jz]=this;}return qi(e,[{key:"mount",value:function(e){for(var t=this.sheet,n=0,r=0,i=0;i<e.length;i++){var o=e[i],a=this.modules.indexOf(o);if(a<r&&a>-1&&(this.modules.splice(a,1),r--,a=-1),-1==a){if(this.modules.splice(r++,0,o),t)for(var s=0;s<o.rules.length;s++)t.insertRule(o.rules[s],n++);}else {for(;r<a;)n+=this.modules[r++].rules.length;n+=o.rules.length,r++;}}if(!t){for(var c="",u=0;u<this.modules.length;u++)c+=this.modules[u].getRules()+"\n";this.styleTag.textContent=c;}}}]),e}(),Oz={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Mz={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Ez="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),Az="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Pz="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Tz=Az||Ez&&+Ez[1]<57,Rz=0;Rz<10;Rz++)Oz[48+Rz]=Oz[96+Rz]=String(Rz);for(Rz=1;Rz<=24;Rz++)Oz[Rz+111]="F"+Rz;for(Rz=65;Rz<=90;Rz++)Oz[Rz]=String.fromCharCode(Rz+32),Mz[Rz]=String.fromCharCode(Rz);for(var Nz in Oz)Mz.hasOwnProperty(Nz)||(Mz[Nz]=Oz[Nz]);function Iz(e){return (11==e.nodeType?e.getSelection?e:e.ownerDocument:e).getSelection()}function Dz(e,t){return !!t&&(e==t||e.contains(1!=t.nodeType?t.parentNode:t))}function Lz(e,t){if(!t.anchorNode)return !1;try{return Dz(e,t.anchorNode)}catch(e){return !1}}function Bz(e){return 3==e.nodeType?Qz(e,0,e.nodeValue.length).getClientRects():1==e.nodeType?e.getClientRects():[]}function zz(e,t,n,r){return !!n&&(Fz(e,t,n,r,-1)||Fz(e,t,n,r,1))}function qz(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t}function Fz(e,t,n,r,i){for(;;){if(e==n&&t==r)return !0;if(t==(i<0?0:Vz(e))){if("DIV"==e.nodeName)return !1;var o=e.parentNode;if(!o||1!=o.nodeType)return !1;t=qz(e)+(i<0?0:1),e=o;}else {if(1!=e.nodeType)return !1;if(1==(e=e.childNodes[t+(i<0?-1:0)]).nodeType&&"false"==e.contentEditable)return !1;t=i<0?Vz(e):0;}}}function Vz(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function Wz(e,t){var n=t?e.left:e.right;return {left:n,right:n,top:e.top,bottom:e.bottom}}function Hz(e){return {left:0,right:e.innerWidth,top:0,bottom:e.innerHeight}}var Uz,Jz=function(){function e(){Bi(this,e),this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0;}return qi(e,[{key:"eq",value:function(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}},{key:"setRange",value:function(e){this.set(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset);}},{key:"set",value:function(e,t,n,r){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=r;}}]),e}(),Kz=null;function Gz(e){if(e.setActive)return e.setActive();if(Kz)return e.focus(Kz);for(var t=[],n=e;n&&(t.push(n,n.scrollTop,n.scrollLeft),n!=n.ownerDocument);n=n.parentNode);if(e.focus(null==Kz?{get preventScroll(){return Kz={preventScroll:!0},!0}}:void 0),!Kz){Kz=!1;for(var r=0;r<t.length;){var i=t[r++],o=t[r++],a=t[r++];i.scrollTop!=o&&(i.scrollTop=o),i.scrollLeft!=a&&(i.scrollLeft=a);}}}function Qz(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=Uz||(Uz=document.createRange());return r.setEnd(e,n),r.setStart(e,t),r}function Yz(e,t,n){var r={key:t,code:t,keyCode:n,which:n,cancelable:!0},i=new KeyboardEvent("keydown",r);i.synthetic=!0,e.dispatchEvent(i);var o=new KeyboardEvent("keyup",r);return o.synthetic=!0,e.dispatchEvent(o),i.defaultPrevented||o.defaultPrevented}function Xz(e){for(;e;){if(e&&(9==e.nodeType||11==e.nodeType&&e.host))return e;e=e.assignedSlot||e.parentNode;}return null}function Zz(e){for(;e.attributes.length;)e.removeAttributeNode(e.attributes[0]);}var eq=function(){function e(t,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Bi(this,e),this.node=t,this.offset=n,this.precise=r;}return qi(e,null,[{key:"before",value:function(t,n){return new e(t.parentNode,qz(t),n)}},{key:"after",value:function(t,n){return new e(t.parentNode,qz(t)+1,n)}}]),e}(),tq=[],nq=function(){function e(){Bi(this,e),this.parent=null,this.dom=null,this.dirty=2;}return qi(e,[{key:"overrideDOMText",get:function(){return null}},{key:"posAtStart",get:function(){return this.parent?this.parent.posBefore(this):0}},{key:"posAtEnd",get:function(){return this.posAtStart+this.length}},{key:"posBefore",value:function(e){var t,n=this.posAtStart,r=wi(this.children);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i==e)return n;n+=i.length+i.breakAfter;}}catch(e){r.e(e);}finally{r.f();}throw new RangeError("Invalid child in posBefore")}},{key:"posAfter",value:function(e){return this.posBefore(e)+e.length}},{key:"sync",value:function(t,n){if(2&this.dirty){var r,i,o=this.dom,a=null,s=wi(this.children);try{for(s.s();!(i=s.n()).done;){var c=i.value;if(c.dirty){if(!c.dom&&(r=a?a.nextSibling:o.firstChild)){var u=e.get(r);(!u||!u.parent&&u.canReuseDOM(c))&&c.reuseDOM(r);}c.sync(t,n),c.dirty=0;}if(r=a?a.nextSibling:o.firstChild,n&&!n.written&&n.node==o&&r!=c.dom&&(n.written=!0),c.dom.parentNode==o)for(;r&&r!=c.dom;)r=rq(r);else o.insertBefore(c.dom,r);a=c.dom;}}catch(e){s.e(e);}finally{s.f();}for((r=a?a.nextSibling:o.firstChild)&&n&&n.node==o&&(n.written=!0);r;)r=rq(r);}else if(1&this.dirty){var l,f=wi(this.children);try{for(f.s();!(l=f.n()).done;){var h=l.value;h.dirty&&(h.sync(t,n),h.dirty=0);}}catch(e){f.e(e);}finally{f.f();}}}},{key:"reuseDOM",value:function(e){}},{key:"localPosFromDOM",value:function(t,n){var r;if(t==this.dom)r=this.dom.childNodes[n];else {for(var i=0==Vz(t)?0:0==n?-1:1;;){var o=t.parentNode;if(o==this.dom)break;0==i&&o.firstChild!=o.lastChild&&(i=t==o.firstChild?-1:1),t=o;}r=i<0?t:t.nextSibling;}if(r==this.dom.firstChild)return 0;for(;r&&!e.get(r);)r=r.nextSibling;if(!r)return this.length;for(var a=0,s=0;;a++){var c=this.children[a];if(c.dom==r)return s;s+=c.length+c.breakAfter;}}},{key:"domBoundsAround",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=-1,i=-1,o=-1,a=-1,s=0,c=n,u=n;s<this.children.length;s++){var l=this.children[s],f=c+l.length;if(c<e&&f>t)return l.domBoundsAround(e,t,c);if(f>=e&&-1==r&&(r=s,i=c),c>t&&l.dom.parentNode==this.dom){o=s,a=u;break}u=f,c=f+l.breakAfter;}return {from:i,to:a<0?n+this.length:a,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}},{key:"markDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.dirty|=2,this.markParentsDirty(e);}},{key:"markParentsDirty",value:function(e){for(var t=this.parent;t;t=t.parent){if(e&&(t.dirty|=2),1&t.dirty)return;t.dirty|=1,e=!1;}}},{key:"setParent",value:function(e){this.parent!=e&&(this.parent=e,this.dirty&&this.markParentsDirty(!0));}},{key:"setDOM",value:function(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this;}},{key:"rootView",get:function(){for(var e=this;;){var t=e.parent;if(!t)return e;e=t;}}},{key:"replaceChildren",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tq;this.markDirty();for(var i=e;i<t;i++){var o=this.children[i];o.parent==this&&o.destroy();}(n=this.children).splice.apply(n,[e,t-e].concat(Vi(r)));for(var a=0;a<r.length;a++)r[a].setParent(this);}},{key:"ignoreMutation",value:function(e){return !1}},{key:"ignoreEvent",value:function(e){return !1}},{key:"childCursor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.length;return new iq(this.children,e,this.children.length)}},{key:"childPos",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.childCursor().findPos(e,t)}},{key:"toString",value:function(){var e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==e?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}},{key:"isEditable",get:function(){return !0}},{key:"isWidget",get:function(){return !1}},{key:"isHidden",get:function(){return !1}},{key:"merge",value:function(e,t,n,r,i,o){return !1}},{key:"become",value:function(e){return !1}},{key:"canReuseDOM",value:function(e){return e.constructor==this.constructor}},{key:"getSide",value:function(){return 0}},{key:"destroy",value:function(){this.parent=null;}}],[{key:"get",value:function(e){return e.cmView}}]),e}();function rq(e){var t=e.nextSibling;return e.parentNode.removeChild(e),t}nq.prototype.breakAfter=0;var iq=function(){function e(t,n,r){Bi(this,e),this.children=t,this.pos=n,this.i=r,this.off=0;}return qi(e,[{key:"findPos",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;;){if(e>this.pos||e==this.pos&&(t>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;var n=this.children[--this.i];this.pos-=n.length+n.breakAfter;}}}]),e}();function oq(e,t,n,r,i,o,a,s,c){var u=e.children,l=u.length?u[t]:null,f=o.length?o[o.length-1]:null,h=f?f.breakAfter:a;if(!(t==r&&l&&!a&&!h&&o.length<2&&l.merge(n,i,o.length?f:null,0==n,s,c))){if(r<u.length){var d=u[r];d&&i<d.length?(t==r&&(d=d.split(i),i=0),!h&&f&&d.merge(0,i,f,!0,0,c)?o[o.length-1]=d:(i&&d.merge(0,i,null,!1,0,c),o.push(d))):(null==d?void 0:d.breakAfter)&&(f?f.breakAfter=1:a=1),r++;}for(l&&(l.breakAfter=a,n>0&&(!a&&o.length&&l.merge(n,l.length,o[0],!1,s,0)?l.breakAfter=o.shift().breakAfter:(n<l.length||l.children.length&&0==l.children[l.children.length-1].length)&&l.merge(n,l.length,null,!1,s,0),t++));t<r&&o.length;)if(u[r-1].become(o[o.length-1]))r--,o.pop(),c=o.length?0:s;else {if(!u[t].become(o[0]))break;t++,o.shift(),s=o.length?0:c;}!o.length&&t&&r<u.length&&!u[t-1].breakAfter&&u[r].merge(0,0,u[t-1],!1,s,c)&&t--,(t<r||o.length)&&e.replaceChildren(t,r,o);}}function aq(e,t,n,r,i,o){var a,s=e.childCursor(),c=s.findPos(n,1),u=c.i,l=c.off,f=s.findPos(t,-1),h=f.i,d=f.off,v=t-n,p=wi(r);try{for(p.s();!(a=p.n()).done;){v+=a.value.length;}}catch(e){p.e(e);}finally{p.f();}e.length+=v,oq(e,h,d,u,l,r,0,i,o);}var sq="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},cq="undefined"!=typeof document?document:{documentElement:{style:{}}},uq=/Edge\/(\d+)/.exec(sq.userAgent),lq=/MSIE \d/.test(sq.userAgent),fq=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(sq.userAgent),hq=!!(lq||fq||uq),dq=!hq&&/gecko\/(\d+)/i.test(sq.userAgent),vq=!hq&&/Chrome\/(\d+)/.exec(sq.userAgent),pq="webkitFontSmoothing"in cq.documentElement.style,mq=!hq&&/Apple Computer/.test(sq.vendor),gq=mq&&(/Mobile\/\w+/.test(sq.userAgent)||sq.maxTouchPoints>2),yq={mac:gq||/Mac/.test(sq.platform),windows:/Win/.test(sq.platform),linux:/Linux|X11/.test(sq.platform),ie:hq,ie_version:lq?cq.documentMode||6:fq?+fq[1]:uq?+uq[1]:0,gecko:dq,gecko_version:dq?+(/Firefox\/(\d+)/.exec(sq.userAgent)||[0,0])[1]:0,chrome:!!vq,chrome_version:vq?+vq[1]:0,ios:gq,android:/Android\b/.test(sq.userAgent),webkit:pq,safari:mq,webkit_version:pq?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=cq.documentElement.style.tabSize?"tab-size":"-moz-tab-size"},bq=function(e){Pi(n,nq);var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this)).text=e,r}return qi(n,[{key:"length",get:function(){return this.text.length}},{key:"createDOM",value:function(e){this.setDOM(e||document.createTextNode(this.text));}},{key:"sync",value:function(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text);}},{key:"reuseDOM",value:function(e){3==e.nodeType&&this.createDOM(e);}},{key:"merge",value:function(e,t,r){return (!r||r instanceof n&&!(this.length-(t-e)+r.length>256))&&(this.text=this.text.slice(0,e)+(r?r.text:"")+this.text.slice(t),this.markDirty(),!0)}},{key:"split",value:function(e){var t=new n(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t}},{key:"localPosFromDOM",value:function(e,t){return e==this.dom?t:t?this.text.length:0}},{key:"domAtPos",value:function(e){return new eq(this.dom,e)}},{key:"domBoundsAround",value:function(e,t,n){return {from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}},{key:"coordsAt",value:function(e,t){return xq(this.dom,e,t)}}]),n}(),wq=function(e){Pi(n,nq);var t=Ri(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Bi(this,n),(r=t.call(this)).mark=e,r.children=i,r.length=o;var a,s=wi(i);try{for(s.s();!(a=s.n()).done;){var c=a.value;c.setParent(Ii(r));}}catch(e){s.e(e);}finally{s.f();}return r}return qi(n,[{key:"setAttrs",value:function(e){if(Zz(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(var t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}},{key:"reuseDOM",value:function(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.dirty|=6);}},{key:"sync",value:function(e,t){this.dom?4&this.dirty&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),Ei(Li(n.prototype),"sync",this).call(this,e,t);}},{key:"merge",value:function(e,t,r,i,o,a){return (!r||!(!(r instanceof n&&r.mark.eq(this.mark))||e&&o<=0||t<this.length&&a<=0))&&(aq(this,e,t,r?r.children:[],o-1,a-1),this.markDirty(),!0)}},{key:"split",value:function(e){var t,r=[],i=0,o=-1,a=0,s=wi(this.children);try{for(s.s();!(t=s.n()).done;){var c=t.value,u=i+c.length;u>e&&r.push(i<e?c.split(e-i):c),o<0&&i>=e&&(o=a),i=u,a++;}}catch(e){s.e(e);}finally{s.f();}var l=this.length-e;return this.length=e,o>-1&&(this.children.length=o,this.markDirty()),new n(this.mark,r,l)}},{key:"domAtPos",value:function(e){return Mq(this,e)}},{key:"coordsAt",value:function(e,t){return Aq(this,e,t)}}]),n}();function xq(e,t,n){var r=e.nodeValue.length;t>r&&(t=r);var i=t,o=t,a=0;0==t&&n<0||t==r&&n>=0?yq.chrome||yq.gecko||(t?(i--,a=1):o<r&&(o++,a=-1)):n<0?i--:o<r&&o++;var s=Qz(e,i,o).getClientRects();if(!s.length)return null;var c=s[(a?a<0:n>=0)?0:s.length-1];return yq.safari&&!a&&0==c.width&&(c=Array.prototype.find.call(s,(function(e){return e.width}))||c),a?Wz(c,a<0):c||null}var kq=function(e){Pi(n,nq);var t=Ri(n);function n(e,r,i){var o;return Bi(this,n),(o=t.call(this)).widget=e,o.length=r,o.side=i,o.prevWidget=null,o}return qi(n,[{key:"split",value:function(e){var t=n.create(this.widget,this.length-e,this.side);return this.length-=e,t}},{key:"sync",value:function(e){this.dom&&this.widget.updateDOM(this.dom,e)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false");}},{key:"getSide",value:function(){return this.side}},{key:"merge",value:function(e,t,r,i,o,a){return !(r&&(!(r instanceof n&&this.widget.compare(r.widget))||e>0&&o<=0||t<this.length&&a<=0))&&(this.length=e+(r?r.length:0)+(this.length-t),!0)}},{key:"become",value:function(e){return e instanceof n&&e.side==this.side&&this.widget.constructor==e.widget.constructor&&(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0)}},{key:"ignoreMutation",value:function(){return !0}},{key:"ignoreEvent",value:function(e){return this.widget.ignoreEvent(e)}},{key:"overrideDOMText",get:function(){if(0==this.length)return PL.empty;for(var e=this;e.parent;)e=e.parent;var t=e.view,n=t&&t.state.doc,r=this.posAtStart;return n?n.slice(r,r+this.length):PL.empty}},{key:"domAtPos",value:function(e){return (this.length?0==e:this.side>0)?eq.before(this.dom):eq.after(this.dom,e==this.length)}},{key:"domBoundsAround",value:function(){return null}},{key:"coordsAt",value:function(e,t){var n=this.widget.coordsAt(this.dom,e,t);if(n)return n;var r=this.dom.getClientRects(),i=null;if(!r.length)return null;for(var o=e>0?r.length-1:0;i=r[o],!(e>0?0==o:o==r.length-1||i.top<i.bottom);o+=e>0?-1:1);return this.length?i:Wz(i,this.side>0)}},{key:"isEditable",get:function(){return !1}},{key:"isWidget",get:function(){return !0}},{key:"isHidden",get:function(){return this.widget.isHidden}},{key:"destroy",value:function(){Ei(Li(n.prototype),"destroy",this).call(this),this.dom&&this.widget.destroy(this.dom);}}],[{key:"create",value:function(e,t,r){return new(e.customView||n)(e,t,r)}}]),n}(),jq=function(e){Pi(n,kq);var t=Ri(n);function n(){return Bi(this,n),t.apply(this,arguments)}return qi(n,[{key:"domAtPos",value:function(e){var t=this.widget,n=t.topView,r=t.text;return n?Sq(e,0,n,r,this.length-n.length,(function(e,t){return e.domAtPos(t)}),(function(e,t){return new eq(e,Math.min(t,e.nodeValue.length))})):new eq(r,Math.min(e,r.nodeValue.length))}},{key:"sync",value:function(){this.setDOM(this.widget.toDOM());}},{key:"localPosFromDOM",value:function(e,t){var n=this.widget,r=n.topView,i=n.text;return r?$q(e,t,r,i,this.length-r.length):Math.min(t,this.length)}},{key:"ignoreMutation",value:function(){return !1}},{key:"overrideDOMText",get:function(){return null}},{key:"coordsAt",value:function(e,t){var n=this.widget,r=n.topView,i=n.text;return r?Sq(e,t,r,i,this.length-r.length,(function(e,t,n){return e.coordsAt(t,n)}),(function(e,t,n){return xq(e,t,n)})):xq(i,e,t)}},{key:"destroy",value:function(){var e;Ei(Li(n.prototype),"destroy",this).call(this),null===(e=this.widget.topView)||void 0===e||e.destroy();}},{key:"isEditable",get:function(){return !0}},{key:"canReuseDOM",value:function(){return !0}}]),n}();function Sq(e,t,n,r,i,o,a){if(n instanceof wq){for(var s=n.dom.firstChild;s;s=s.nextSibling){var c=nq.get(s);if(c){var u=Dz(s,r),l=c.length+(u?i:0);if(e<l||e==l&&c.getSide()<=0)return u?Sq(e,t,c,r,i,o,a):o(c,e,t);e-=l;}else {var f=Cq(e,t,s,a);if("number"!=typeof f)return f;e=f;}}return o(n,n.length,-1)}return n.dom==r?a(r,e,t):o(n,e,t)}function Cq(e,t,n,r){if(3==n.nodeType){var i=n.nodeValue.length;if(e<=i)return r(n,e,t);e-=i;}else if(1==n.nodeType&&"false"!=n.contentEditable)for(var o=n.firstChild;o;o=o.nextSibling){var a=Cq(e,t,o,r);if("number"!=typeof a)return a;e=a;}return e}function $q(e,t,n,r,i){if(n instanceof wq)for(var o=0,a=n.dom.firstChild;a;a=a.nextSibling){var s=nq.get(a);if(s){var c=Dz(a,r);if(Dz(a,e))return o+(c?$q(e,t,s,r,i):s.localPosFromDOM(e,t));o+=s.length+(c?i:0);}else {var u=_q(e,t,a);if(null!=u.result)return o+u.result;o+=u.size;}}else if(n.dom==r)return Math.min(t,r.nodeValue.length);return n.localPosFromDOM(e,t)}function _q(e,t,n){if(3==n.nodeType)return e==n?{result:t}:{size:n.nodeValue.length};if(1!=n.nodeType||"false"==n.contentEditable)return n.contains(e)?{result:0}:{size:0};for(var r=0,i=n.firstChild,o=0;;i=i.nextSibling,o++){if(e==n&&o==t)return {result:r};if(!i)return {size:r};var a=_q(e,t,i);if(null!=a.result)return {result:t+a.result};r+=a.size;}}var Oq=function(e){Pi(n,nq);var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this)).side=e,r}return qi(n,[{key:"length",get:function(){return 0}},{key:"merge",value:function(){return !1}},{key:"become",value:function(e){return e instanceof n&&e.side==this.side}},{key:"split",value:function(){return new n(this.side)}},{key:"sync",value:function(){if(!this.dom){var e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e);}}},{key:"getSide",value:function(){return this.side}},{key:"domAtPos",value:function(e){return this.side>0?eq.before(this.dom):eq.after(this.dom)}},{key:"localPosFromDOM",value:function(){return 0}},{key:"domBoundsAround",value:function(){return null}},{key:"coordsAt",value:function(e){return this.dom.getBoundingClientRect()}},{key:"overrideDOMText",get:function(){return PL.empty}},{key:"isHidden",get:function(){return !0}}]),n}();function Mq(e,t){for(var n=e.dom,r=e.children,i=0,o=0;i<r.length;i++){var a=r[i],s=o+a.length;if(!(s==o&&a.getSide()<=0)){if(t>o&&t<s&&a.dom.parentNode==n)return a.domAtPos(t-o);if(t<=o)break;o=s;}}for(var c=i;c>0;c--){var u=r[c-1];if(u.dom.parentNode==n)return u.domAtPos(u.length)}for(var l=i;l<r.length;l++){var f=r[l];if(f.dom.parentNode==n)return f.domAtPos(0)}return new eq(n,0)}function Eq(e,t,n){var r,i=e.children;n>0&&t instanceof wq&&i.length&&(r=i[i.length-1])instanceof wq&&r.mark.eq(t.mark)?Eq(r,t.children[0],n-1):(i.push(t),t.setParent(e)),e.length+=t.length;}function Aq(e,t,n){var r=null,i=-1,o=null,a=-1;!function e(t,s){for(var c=0,u=0;c<t.children.length&&u<=s;c++){var l=t.children[c],f=u+l.length;f>=s&&(l.children.length?e(l,s-u):(!o||o.isHidden&&n>0)&&(f>s||u==f&&l.getSide()>0)?(o=l,a=s-u):(u<s||u==f&&l.getSide()<0&&!l.isHidden)&&(r=l,i=s-u)),u=f;}}(e,t);var s=(n<0?r:o)||r||o;return s?s.coordsAt(Math.max(0,s==r?i:a),n):function(e){var t=e.dom.lastChild;if(!t)return e.dom.getBoundingClientRect();var n=Bz(t);return n[n.length-1]||null}(e)}function Pq(e,t){for(var n in e)"class"==n&&t.class?t.class+=" "+e.class:"style"==n&&t.style?t.style+=";"+e.style:t[n]=e[n];return t}function Tq(e,t){if(e==t)return !0;if(!e||!t)return !1;var n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return !1;for(var i=0,o=n;i<o.length;i++){var a=o[i];if(-1==r.indexOf(a)||e[a]!==t[a])return !1}return !0}function Rq(e,t,n){var r=null;if(t)for(var i in t)n&&i in n||e.removeAttribute(r=i);if(n)for(var o in n)t&&t[o]==n[o]||e.setAttribute(r=o,n[o]);return !!r}bq.prototype.children=kq.prototype.children=Oq.prototype.children=tq;var Nq=function(){function e(){Bi(this,e);}return qi(e,[{key:"eq",value:function(e){return !1}},{key:"updateDOM",value:function(e,t){return !1}},{key:"compare",value:function(e){return this==e||this.constructor==e.constructor&&this.eq(e)}},{key:"estimatedHeight",get:function(){return -1}},{key:"ignoreEvent",value:function(e){return !0}},{key:"coordsAt",value:function(e,t,n){return null}},{key:"customView",get:function(){return null}},{key:"isHidden",get:function(){return !1}},{key:"destroy",value:function(e){}}]),e}(),Iq=function(e){return e[e.Text=0]="Text",e[e.WidgetBefore=1]="WidgetBefore",e[e.WidgetAfter=2]="WidgetAfter",e[e.WidgetRange=3]="WidgetRange",e}(Iq||(Iq={})),Dq=function(e){Pi(n,rz);var t=Ri(n);function n(e,r,i,o){var a;return Bi(this,n),(a=t.call(this)).startSide=e,a.endSide=r,a.widget=i,a.spec=o,a}return qi(n,[{key:"heightRelevant",get:function(){return !1}},{key:"hasHeight",value:function(){return !!this.widget&&this.widget.estimatedHeight>-1}}],[{key:"mark",value:function(e){return new Lq(e)}},{key:"widget",value:function(e){var t=e.side||0,n=!!e.block;return new zq(e,t+=n?t>0?3e8:-4e8:t>0?1e8:-1e8,t,n,e.widget||null,!1)}},{key:"replace",value:function(e){var t,n,r=!!e.block;if(e.isBlockGap)t=-5e8,n=4e8;else {var i=qq(e,r);t=(i.start?r?-3e8:-1:5e8)-1,n=1+(i.end?r?2e8:1:-6e8);}return new zq(e,t,n,r,e.widget||null,!0)}},{key:"line",value:function(e){return new Bq(e)}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return sz.of(e,t)}}]),n}();Dq.none=sz.empty;var Lq=function(e){Pi(n,Dq);var t=Ri(n);function n(e){var r;Bi(this,n);var i=qq(e),o=i.start,a=i.end;return (r=t.call(this,o?-1:5e8,a?1:-6e8,null,e)).tagName=e.tagName||"span",r.class=e.class||"",r.attrs=e.attributes||null,r}return qi(n,[{key:"eq",value:function(e){return this==e||e instanceof n&&this.tagName==e.tagName&&this.class==e.class&&Tq(this.attrs,e.attrs)}},{key:"range",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(e>=t)throw new RangeError("Mark decorations may not be empty");return Ei(Li(n.prototype),"range",this).call(this,e,t)}}]),n}();Lq.prototype.point=!1;var Bq=function(e){Pi(n,Dq);var t=Ri(n);function n(e){return Bi(this,n),t.call(this,-2e8,-2e8,null,e)}return qi(n,[{key:"eq",value:function(e){return e instanceof n&&this.spec.class==e.spec.class&&Tq(this.spec.attributes,e.spec.attributes)}},{key:"range",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return Ei(Li(n.prototype),"range",this).call(this,e,t)}}]),n}();Bq.prototype.mapMode=tB.TrackBefore,Bq.prototype.point=!0;var zq=function(e){Pi(n,Dq);var t=Ri(n);function n(e,r,i,o,a,s){var c;return Bi(this,n),(c=t.call(this,r,i,a,e)).block=o,c.isReplace=s,c.mapMode=o?r<=0?tB.TrackBefore:tB.TrackAfter:tB.TrackDel,c}return qi(n,[{key:"type",get:function(){return this.startSide<this.endSide?Iq.WidgetRange:this.startSide<=0?Iq.WidgetBefore:Iq.WidgetAfter}},{key:"heightRelevant",get:function(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}},{key:"eq",value:function(e){return e instanceof n&&function(e,t){return e==t||!!(e&&t&&e.compare(t))}(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}},{key:"range",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return Ei(Li(n.prototype),"range",this).call(this,e,t)}}]),n}();function qq(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.inclusiveStart,r=e.inclusiveEnd;return null==n&&(n=e.inclusive),null==r&&(r=e.inclusive),{start:null!=n?n:t,end:null!=r?r:t}}function Fq(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=n.length-1;i>=0&&n[i]+r>=e?n[i]=Math.max(n[i],t):n.push(e,t);}zq.prototype.point=!0;var Vq=function(e){Pi(n,nq);var t=Ri(n);function n(){var e;return Bi(this,n),(e=t.apply(this,arguments)).children=[],e.length=0,e.prevAttrs=void 0,e.attrs=null,e.breakAfter=0,e}return qi(n,[{key:"merge",value:function(e,t,r,i,o,a){if(r){if(!(r instanceof n))return !1;this.dom||r.transferDOM(this);}return i&&this.setDeco(r?r.attrs:null),aq(this,e,t,r?r.children:[],o,a),!0}},{key:"split",value:function(e){var t=new n;if(t.breakAfter=this.breakAfter,0==this.length)return t;var r=this.childPos(e),i=r.i,o=r.off;o&&(t.append(this.children[i].split(o),0),this.children[i].merge(o,this.children[i].length,null,!1,0,0),i++);for(var a=i;a<this.children.length;a++)t.append(this.children[a],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,t}},{key:"transferDOM",value:function(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null);}},{key:"setDeco",value:function(e){Tq(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e);}},{key:"append",value:function(e,t){Eq(this,e,t);}},{key:"addLineDeco",value:function(e){var t=e.spec.attributes,n=e.spec.class;t&&(this.attrs=Pq(t,this.attrs||{})),n&&(this.attrs=Pq({class:n},this.attrs||{}));}},{key:"domAtPos",value:function(e){return Mq(this,e)}},{key:"reuseDOM",value:function(e){"DIV"==e.nodeName&&(this.setDOM(e),this.dirty|=6);}},{key:"sync",value:function(e,t){var r;this.dom?4&this.dirty&&(Zz(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(Rq(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),Ei(Li(n.prototype),"sync",this).call(this,e,t);for(var i=this.dom.lastChild;i&&nq.get(i)instanceof wq;)i=i.lastChild;if(!(i&&this.length&&("BR"==i.nodeName||0!=(null===(r=nq.get(i))||void 0===r?void 0:r.isEditable)||yq.ios&&this.children.some((function(e){return e instanceof bq}))))){var o=document.createElement("BR");o.cmIgnore=!0,this.dom.appendChild(o);}}},{key:"measureTextSize",value:function(){if(0==this.children.length||this.length>20)return null;var e,t,n=0,r=wi(this.children);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(!(i instanceof bq)||/[^ -~]/.test(i.text))return null;var o=Bz(i.dom);if(1!=o.length)return null;n+=o[0].width,e=o[0].height;}}catch(e){r.e(e);}finally{r.f();}return n?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:n/this.length,textHeight:e}:null}},{key:"coordsAt",value:function(e,t){var n=Aq(this,e,t);if(!this.children.length&&n&&this.parent){var r=this.parent.view.viewState.heightOracle,i=n.bottom-n.top;if(Math.abs(i-r.lineHeight)<2&&r.textHeight<i){var o=(i-r.textHeight)/2;return {top:n.top+o,bottom:n.bottom-o,left:n.left,right:n.left}}}return n}},{key:"become",value:function(e){return !1}},{key:"type",get:function(){return Iq.Text}}],[{key:"find",value:function(e,t){for(var r=0,i=0;r<e.children.length;r++){var o=e.children[r],a=i+o.length;if(a>=t){if(o instanceof n)return o;if(a>t)break}i=a+o.breakAfter;}return null}}]),n}(),Wq=function(e){Pi(n,nq);var t=Ri(n);function n(e,r,i){var o;return Bi(this,n),(o=t.call(this)).widget=e,o.length=r,o.type=i,o.breakAfter=0,o.prevWidget=null,o}return qi(n,[{key:"merge",value:function(e,t,r,i,o,a){return !(r&&(!(r instanceof n&&this.widget.compare(r.widget))||e>0&&o<=0||t<this.length&&a<=0))&&(this.length=e+(r?r.length:0)+(this.length-t),!0)}},{key:"domAtPos",value:function(e){return 0==e?eq.before(this.dom):eq.after(this.dom,e==this.length)}},{key:"split",value:function(e){var t=this.length-e;this.length=e;var r=new n(this.widget,t,this.type);return r.breakAfter=this.breakAfter,r}},{key:"children",get:function(){return tq}},{key:"sync",value:function(e){this.dom&&this.widget.updateDOM(this.dom,e)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false");}},{key:"overrideDOMText",get:function(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):PL.empty}},{key:"domBoundsAround",value:function(){return null}},{key:"become",value:function(e){return e instanceof n&&e.type==this.type&&e.widget.constructor==this.widget.constructor&&(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.breakAfter=e.breakAfter,!0)}},{key:"ignoreMutation",value:function(){return !0}},{key:"ignoreEvent",value:function(e){return this.widget.ignoreEvent(e)}},{key:"isEditable",get:function(){return !1}},{key:"isWidget",get:function(){return !0}},{key:"coordsAt",value:function(e,t){return this.widget.coordsAt(this.dom,e,t)}},{key:"destroy",value:function(){Ei(Li(n.prototype),"destroy",this).call(this),this.dom&&this.widget.destroy(this.dom);}}]),n}(),Hq=function(){function e(t,n,r,i){Bi(this,e),this.doc=t,this.pos=n,this.end=r,this.disallowBlockEffectsFor=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=n;}return qi(e,[{key:"posCovered",value:function(){if(0==this.content.length)return !this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;var e=this.content[this.content.length-1];return !(e.breakAfter||e instanceof Wq&&e.type==Iq.WidgetBefore)}},{key:"getLine",value:function(){return this.curLine||(this.content.push(this.curLine=new Vq),this.atCursorPos=!0),this.curLine}},{key:"flushBuffer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.bufferMarks;this.pendingBuffer&&(this.curLine.append(Uq(new Oq(-1),e),e.length),this.pendingBuffer=0);}},{key:"addBlockWidget",value:function(e){this.flushBuffer(),this.curLine=null,this.content.push(e);}},{key:"finish",value:function(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||this.getLine();}},{key:"buildText",value:function(e,t,n){for(;e>0;){if(this.textOff==this.text.length){var r=this.cursor.next(this.skip),i=r.value,o=r.lineBreak,a=r.done;if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}this.text=i,this.textOff=0;}var s=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-n)),this.getLine().append(Uq(new bq(this.text.slice(this.textOff,this.textOff+s)),t),n),this.atCursorPos=!0,this.textOff+=s,e-=s,n=0;}}},{key:"span",value:function(e,t,n,r){this.buildText(t-e,n,r),this.pos=t,this.openStart<0&&(this.openStart=r);}},{key:"point",value:function(e,t,n,r,i,o){if(this.disallowBlockEffectsFor[o]&&n instanceof zq){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}var a=t-e;if(n instanceof zq)if(n.block){var s=n.type;s!=Iq.WidgetAfter||this.posCovered()||this.getLine(),this.addBlockWidget(new Wq(n.widget||new Jq("div"),a,s));}else {var c=kq.create(n.widget||new Jq("span"),a,a?0:n.startSide),u=this.atCursorPos&&!c.isEditable&&i<=r.length&&(e<t||n.startSide>0),l=!c.isEditable&&(e<t||i>r.length||n.startSide<=0),f=this.getLine();2!=this.pendingBuffer||u||c.isEditable||(this.pendingBuffer=0),this.flushBuffer(r),u&&(f.append(Uq(new Oq(1),r),i),i=r.length+Math.max(0,i-r.length)),f.append(Uq(c,r),i),this.atCursorPos=l,this.pendingBuffer=l?e<t||i>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice());}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=i);}}],[{key:"build",value:function(t,n,r,i,o){var a=new e(t,n,r,o);return a.openEnd=sz.spans(i,n,r,a),a.openStart<0&&(a.openStart=a.openEnd),a.finish(a.openEnd),a}}]),e}();function Uq(e,t){var n,r=wi(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;e=new wq(i,[e],e.length);}}catch(e){r.e(e);}finally{r.f();}return e}var Jq=function(e){Pi(n,Nq);var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this)).tag=e,r}return qi(n,[{key:"eq",value:function(e){return e.tag==this.tag}},{key:"toDOM",value:function(){return document.createElement(this.tag)}},{key:"updateDOM",value:function(e){return e.nodeName.toLowerCase()==this.tag}},{key:"isHidden",get:function(){return !0}}]),n}(),Kq=vB.define(),Gq=vB.define(),Qq=vB.define(),Yq=vB.define(),Xq=vB.define(),Zq=vB.define(),eF=vB.define(),tF=vB.define({combine:function(e){return e.some((function(e){return e}))}}),nF=vB.define({combine:function(e){return e.some((function(e){return e}))}}),rF=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"nearest",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5;Bi(this,e),this.range=t,this.y=n,this.x=r,this.yMargin=i,this.xMargin=o;}return qi(e,[{key:"map",value:function(t){return t.empty?this:new e(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin)}}]),e}(),iF=VB.define({map:function(e,t){return e.map(t)}});function oF(e,t,n){var r=e.facet(Yq);r.length?r[0](t):window.onerror?window.onerror(String(t),n,void 0,void 0,t):n?console.error(n+":",t):console.error(t);}var aF=vB.define({combine:function(e){return !e.length||e[0]}}),sF=0,cF=vB.define(),uF=function(){function e(t,n,r,i){Bi(this,e),this.id=t,this.create=n,this.domEventHandlers=r,this.extension=i(this);}return qi(e,null,[{key:"define",value:function(t,n){var r=n||{},i=r.eventHandlers,o=r.provide,a=r.decorations;return new e(sF++,t,i,(function(e){var t=[cF.of(e)];return a&&t.push(dF.of((function(t){var n=t.plugin(e);return n?a(n):Dq.none}))),o&&t.push(o(e)),t}))}},{key:"fromClass",value:function(t,n){return e.define((function(e){return new t(e)}),n)}}]),e}(),lF=function(){function e(t){Bi(this,e),this.spec=t,this.mustUpdate=null,this.value=null;}return qi(e,[{key:"update",value:function(e){if(this.value){if(this.mustUpdate){var t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t);}catch(e){if(oF(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy();}catch(e){}this.deactivate();}}}else if(this.spec)try{this.value=this.spec.create(e);}catch(t){oF(e.state,t,"CodeMirror plugin crashed"),this.deactivate();}return this}},{key:"destroy",value:function(e){var t;if(null===(t=this.value)||void 0===t?void 0:t.destroy)try{this.value.destroy();}catch(t){oF(e.state,t,"CodeMirror plugin crashed");}}},{key:"deactivate",value:function(){this.spec=this.value=null;}}]),e}(),fF=vB.define(),hF=vB.define(),dF=vB.define(),vF=vB.define(),pF=vB.define(),mF=vB.define(),gF=function(){function e(t,n,r,i){Bi(this,e),this.fromA=t,this.toA=n,this.fromB=r,this.toB=i;}return qi(e,[{key:"join",value:function(t){return new e(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}},{key:"addToSet",value:function(e){for(var t=e.length,n=this;t>0;t--){var r=e[t-1];if(!(r.fromA>n.toA)){if(r.toA<n.fromA)break;n=n.join(r),e.splice(t-1,1);}}return e.splice(t,0,n),e}}],[{key:"extendWithRanges",value:function(t,n){if(0==n.length)return t;for(var r=[],i=0,o=0,a=0,s=0;;i++){for(var c=i==t.length?null:t[i],u=a-s,l=c?c.fromB:1e9;o<n.length&&n[o]<l;){var f=n[o],h=n[o+1],d=Math.max(s,f),v=Math.min(l,h);if(d<=v&&new e(d+u,v+u,d,v).addToSet(r),h>l)break;o+=2;}if(!c)return r;new e(c.fromA,c.toA,c.fromB,c.toB).addToSet(r),a=c.toA,s=c.toB;}}}]),e}(),yF=function(){function e(t,n,r){Bi(this,e),this.view=t,this.state=n,this.transactions=r,this.flags=0,this.startState=t.state,this.changes=rB.empty(this.startState.doc.length);var i,o=wi(r);try{for(o.s();!(i=o.n()).done;){var a=i.value;this.changes=this.changes.compose(a.changes);}}catch(e){o.e(e);}finally{o.f();}var s=[];this.changes.iterChangedRanges((function(e,t,n,r){return s.push(new gF(e,t,n,r))})),this.changedRanges=s;}return qi(e,[{key:"viewportChanged",get:function(){return (4&this.flags)>0}},{key:"heightChanged",get:function(){return (2&this.flags)>0}},{key:"geometryChanged",get:function(){return this.docChanged||(10&this.flags)>0}},{key:"focusChanged",get:function(){return (1&this.flags)>0}},{key:"docChanged",get:function(){return !this.changes.empty}},{key:"selectionSet",get:function(){return this.transactions.some((function(e){return e.selection}))}},{key:"empty",get:function(){return 0==this.flags&&0==this.transactions.length}}],[{key:"create",value:function(t,n,r){return new e(t,n,r)}}]),e}(),bF=function(e){return e[e.LTR=0]="LTR",e[e.RTL=1]="RTL",e}(bF||(bF={})),wF=bF.LTR,xF=bF.RTL;function kF(e){for(var t=[],n=0;n<e.length;n++)t.push(1<<+e[n]);return t}for(var jF=kF("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),SF=kF("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),CF=Object.create(null),$F=[],_F=0,OF=["()","[]","{}"];_F<OF.length;_F++){var MF=OF[_F],EF=MF.charCodeAt(0),AF=MF.charCodeAt(1);CF[EF]=AF,CF[AF]=-EF;}function PF(e){return e<=247?jF[e]:1424<=e&&e<=1524?2:1536<=e&&e<=1785?SF[e-1536]:1774<=e&&e<=2220?4:8192<=e&&e<=8203?256:64336<=e&&e<=65023?4:8204==e?256:1}var TF=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/,RF=function(){function e(t,n,r){Bi(this,e),this.from=t,this.to=n,this.level=r;}return qi(e,[{key:"dir",get:function(){return this.level%2?xF:wF}},{key:"side",value:function(e,t){return this.dir==t==e?this.to:this.from}}],[{key:"find",value:function(e,t,n,r){for(var i=-1,o=0;o<e.length;o++){var a=e[o];if(a.from<=t&&a.to>=t){if(a.level==n)return o;(i<0||(0!=r?r<0?a.from<t:a.to>t:e[i].level>a.level))&&(i=o);}}if(i<0)throw new RangeError("Index out of range");return i}}]),e}(),NF=[];function IF(e){return [new RF(0,e,0)]}var DF="";function LF(e,t,n,r,i){var o,a=r.head-e.from,s=-1;if(0==a){if(!i||!e.length)return null;t[0].level!=n&&(a=t[0].side(!1,n),s=0);}else if(a==e.length){if(i)return null;var c=t[t.length-1];c.level!=n&&(a=c.side(!0,n),s=t.length-1);}s<0&&(s=RF.find(t,a,null!==(o=r.bidiLevel)&&void 0!==o?o:-1,r.assoc));var u=t[s];a==u.side(i,n)&&(a=(u=t[s+=i?1:-1]).side(!i,n));var l=i==(u.dir==n),f=UL(e.text,a,l);if(DF=e.text.slice(Math.min(a,f),Math.max(a,f)),f!=u.side(i,n))return fB.cursor(f+e.from,l?-1:1,u.level);var h=s==(i?t.length-1:0)?null:t[s+(i?1:-1)];return h||u.level==n?h&&h.level<u.level?fB.cursor(h.side(!i,n)+e.from,i?1:-1,h.level):fB.cursor(f+e.from,i?-1:1,u.level):fB.cursor(i?e.to:e.from,i?-1:1,n)}var BF=function(){function e(t,n){Bi(this,e),this.points=t,this.text="",this.lineSeparator=n.facet(tz.lineSeparator);}return qi(e,[{key:"append",value:function(e){this.text+=e;}},{key:"lineBreak",value:function(){this.text+="";}},{key:"readRange",value:function(e,t){if(!e)return this;for(var n=e.parentNode,r=e;;){this.findPointBefore(n,r),this.readNode(r);var i=r.nextSibling;if(i==t)break;var o=nq.get(r),a=nq.get(i);(o&&a?o.breakAfter:(o?o.breakAfter:zF(r))||zF(i)&&("BR"!=r.nodeName||r.cmIgnore))&&this.lineBreak(),r=i;}return this.findPointBefore(n,t),this}},{key:"readTextNode",value:function(e){var t,n=e.nodeValue,r=wi(this.points);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.node==e&&(i.pos=this.text.length+Math.min(i.offset,n.length));}}catch(e){r.e(e);}finally{r.f();}for(var o=0,a=this.lineSeparator?null:/\r\n?|\n/g;;){var s=-1,c=1,u=void 0;if(this.lineSeparator?(s=n.indexOf(this.lineSeparator,o),c=this.lineSeparator.length):(u=a.exec(n))&&(s=u.index,c=u[0].length),this.append(n.slice(o,s<0?n.length:s)),s<0)break;if(this.lineBreak(),c>1){var l,f=wi(this.points);try{for(f.s();!(l=f.n()).done;){var h=l.value;h.node==e&&h.pos>this.text.length&&(h.pos-=c-1);}}catch(e){f.e(e);}finally{f.f();}}o=s+c;}}},{key:"readNode",value:function(e){if(!e.cmIgnore){var t=nq.get(e),n=t&&t.overrideDOMText;if(null!=n){this.findPointInside(e,n.length);for(var r=n.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value);}else 3==e.nodeType?this.readTextNode(e):"BR"==e.nodeName?e.nextSibling&&this.lineBreak():1==e.nodeType&&this.readRange(e.firstChild,null);}}},{key:"findPointBefore",value:function(e,t){var n,r=wi(this.points);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length);}}catch(e){r.e(e);}finally{r.f();}}},{key:"findPointInside",value:function(e,t){var n,r=wi(this.points);try{for(r.s();!(n=r.n()).done;){var i=n.value;(3==e.nodeType?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+Math.min(t,i.offset));}}catch(e){r.e(e);}finally{r.f();}}}]),e}();function zF(e){return 1==e.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(e.nodeName)}var qF=qi((function e(t,n){Bi(this,e),this.node=t,this.offset=n,this.pos=-1;})),FF=function(e){Pi(n,nq);var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this)).view=e,r.compositionDeco=Dq.none,r.decorations=[],r.dynamicDecorationMap=[],r.minWidth=0,r.minWidthFrom=0,r.minWidthTo=0,r.impreciseAnchor=null,r.impreciseHead=null,r.forceSelection=!1,r.lastUpdate=Date.now(),r.setDOM(e.contentDOM),r.children=[new Vq],r.children[0].setParent(Ii(r)),r.updateDeco(),r.updateInner([new gF(0,0,0,e.state.doc.length)],0),r}return qi(n,[{key:"length",get:function(){return this.view.state.doc.length}},{key:"update",value:function(e){var t=this,n=e.changedRanges;this.minWidth>0&&n.length&&(n.every((function(e){var n=e.fromA;return e.toA<t.minWidthFrom||n>t.minWidthTo}))?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=Dq.none:(e.transactions.length||this.dirty)&&(this.compositionDeco=function(e,t){var n=HF(e);if(!n)return Dq.none;var r=n.from,i=n.to,o=n.node,a=n.text,s=t.mapPos(r,1),c=Math.max(s,t.mapPos(i,-1)),u=e.state,l=3==o.nodeType?o.nodeValue:new BF([],u).readRange(o.firstChild,null).text;if(c-s<l.length)if(u.doc.sliceString(s,Math.min(u.doc.length,s+l.length),"")==l)c=s+l.length;else {if(u.doc.sliceString(Math.max(0,c-l.length),c,"")!=l)return Dq.none;s=c-l.length;}else if(u.doc.sliceString(s,c,"")!=l)return Dq.none;var f=nq.get(o);f instanceof jq?f=f.widget.topView:f&&(f.parent=null);return Dq.set(Dq.replace({widget:new UF(o,a,f),inclusive:!0}).range(s,c))}(this.view,e.changes)),(yq.ie||yq.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);var r=function(e,t,n){var r=new GF;return sz.compare(e,t,n,r),r.changes}(this.decorations,this.updateDeco(),e.changes);return n=gF.extendWithRanges(n,r),(0!=this.dirty||0!=n.length)&&(this.updateInner(n,e.startState.doc.length),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}},{key:"updateInner",value:function(e,t){var n=this;this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t);var r=this.view.observer;r.ignore((function(){n.dom.style.height=n.view.viewState.contentHeight+"px",n.dom.style.flexBasis=n.minWidth?n.minWidth+"px":"";var e=yq.chrome||yq.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;n.sync(n.view,e),n.dirty=0,e&&(e.written||r.selectionRange.focusNode!=e.node)&&(n.forceSelection=!0),n.dom.style.height="";}));var i=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length){var o,a=wi(this.children);try{for(a.s();!(o=a.n()).done;){var s=o.value;s instanceof Wq&&s.widget instanceof WF&&i.push(s.dom);}}catch(e){a.e(e);}finally{a.f();}}r.updateGaps(i);}},{key:"updateChildren",value:function(e,t){for(var n=this.childCursor(t),r=e.length-1;;r--){var i=r>=0?e[r]:null;if(!i)break;var o=i.fromA,a=i.toA,s=i.fromB,c=i.toB,u=Hq.build(this.view.state.doc,s,c,this.decorations,this.dynamicDecorationMap),l=u.content,f=u.breakAtStart,h=u.openStart,d=u.openEnd,v=n.findPos(a,1),p=v.i,m=v.off,g=n.findPos(o,-1);oq(this,g.i,g.off,p,m,l,f,h,d);}}},{key:"updateSelection",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!t&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();var r=this.view.root.activeElement,i=r==this.dom,o=!i&&Lz(this.dom,this.view.observer.selectionRange)&&!(r&&this.dom.contains(r));if(i||n||o){var a=this.forceSelection;this.forceSelection=!1;var s=this.view.state.selection.main,c=this.domAtPos(s.anchor),u=s.empty?c:this.domAtPos(s.head);if(yq.gecko&&s.empty&&!this.compositionDeco.size&&VF(c)){var l=document.createTextNode("");this.view.observer.ignore((function(){return c.node.insertBefore(l,c.node.childNodes[c.offset]||null)})),c=u=new eq(l,0),a=!0;}var f=this.view.observer.selectionRange;!a&&f.focusNode&&zz(c.node,c.offset,f.anchorNode,f.anchorOffset)&&zz(u.node,u.offset,f.focusNode,f.focusOffset)||(this.view.observer.ignore((function(){yq.android&&yq.chrome&&e.dom.contains(f.focusNode)&&QF(f.focusNode,e.dom)&&(e.dom.blur(),e.dom.focus({preventScroll:!0}));var t=Iz(e.view.root);if(t)if(s.empty){if(yq.gecko){var n=KF(c.node,c.offset);if(n&&3!=n){var i=JF(c.node,c.offset,1==n?1:-1);i&&(c=new eq(i,1==n?0:i.nodeValue.length));}}t.collapse(c.node,c.offset),null!=s.bidiLevel&&null!=f.cursorBidiLevel&&(f.cursorBidiLevel=s.bidiLevel);}else if(t.extend){t.collapse(c.node,c.offset);try{t.extend(u.node,u.offset);}catch(e){}}else {var a=document.createRange();if(s.anchor>s.head){var l=[u,c];c=l[0],u=l[1];}a.setEnd(u.node,u.offset),a.setStart(c.node,c.offset),t.removeAllRanges(),t.addRange(a);}o&&e.view.root.activeElement==e.dom&&(e.dom.blur(),r&&r.focus());})),this.view.observer.setSelectionRange(c,u)),this.impreciseAnchor=c.precise?null:new eq(f.anchorNode,f.anchorOffset),this.impreciseHead=u.precise?null:new eq(f.focusNode,f.focusOffset);}}},{key:"enforceCursorAssoc",value:function(){if(!this.compositionDeco.size){var e=this.view,t=e.state.selection.main,n=Iz(e.root),r=e.observer.selectionRange,i=r.anchorNode,o=r.anchorOffset;if(n&&t.empty&&t.assoc&&n.modify){var a=Vq.find(this,t.head);if(a){var s=a.posAtStart;if(t.head!=s&&t.head!=s+a.length){var c=this.coordsAt(t.head,-1),u=this.coordsAt(t.head,1);if(c&&u&&!(c.bottom>u.top)){var l=this.domAtPos(t.head+t.assoc);n.collapse(l.node,l.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();var f=e.observer.selectionRange;e.docView.posFromDOM(f.anchorNode,f.anchorOffset)!=t.from&&n.collapse(i,o);}}}}}}},{key:"nearest",value:function(e){for(var t=e;t;){var n=nq.get(t);if(n&&n.rootView==this)return n;t=t.parentNode;}return null}},{key:"posFromDOM",value:function(e,t){var n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}},{key:"domAtPos",value:function(e){for(var t=this.childCursor().findPos(e,-1),n=t.i,r=t.off;n<this.children.length-1;){var i=this.children[n];if(r<i.length||i instanceof Vq)break;n++,r=0;}return this.children[n].domAtPos(r)}},{key:"coordsAt",value:function(e,t){for(var n=this.length,r=this.children.length-1;;r--){var i=this.children[r],o=n-i.breakAfter-i.length;if(e>o||e==o&&i.type!=Iq.WidgetBefore&&i.type!=Iq.WidgetAfter&&(!r||2==t||this.children[r-1].breakAfter||this.children[r-1].type==Iq.WidgetBefore&&t>-2))return i.coordsAt(e-o,t);n=o;}}},{key:"measureVisibleLineHeights",value:function(e){for(var t=[],n=e.from,r=e.to,i=this.view.contentDOM.clientWidth,o=i>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,s=this.view.textDirection==bF.LTR,c=0,u=0;u<this.children.length;u++){var l=this.children[u],f=c+l.length;if(f>r)break;if(c>=n){var h=l.dom.getBoundingClientRect();if(t.push(h.height),o){var d=l.dom.lastChild,v=d?Bz(d):[];if(v.length){var p=v[v.length-1],m=s?p.right-h.left:h.right-p.left;m>a&&(a=m,this.minWidth=i,this.minWidthFrom=c,this.minWidthTo=f);}}}c=f+l.breakAfter;}return t}},{key:"textDirectionAt",value:function(e){var t=this.childPos(e,1).i;return "rtl"==getComputedStyle(this.children[t].dom).direction?bF.RTL:bF.LTR}},{key:"measureTextSize",value:function(){var e,t=this,n=wi(this.children);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r instanceof Vq){var i=r.measureTextSize();if(i)return i}}}catch(e){n.e(e);}finally{n.f();}var o,a,s,c=document.createElement("div");return c.className="cm-line",c.style.width="99999px",c.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((function(){t.dom.appendChild(c);var e=Bz(c.firstChild)[0];o=c.getBoundingClientRect().height,a=e?e.width/27:7,s=e?e.height:o,c.remove();})),{lineHeight:o,charWidth:a,textHeight:s}}},{key:"childCursor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.length,t=this.children.length;return t&&(e-=this.children[--t].length),new iq(this.children,e,t)}},{key:"computeBlockGapDeco",value:function(){for(var e=[],t=this.view.viewState,n=0,r=0;;r++){var i=r==t.viewports.length?null:t.viewports[r],o=i?i.from-1:this.length;if(o>n){var a=t.lineBlockAt(o).bottom-t.lineBlockAt(n).top;e.push(Dq.replace({widget:new WF(a),block:!0,inclusive:!0,isBlockGap:!0}).range(n,o));}if(!i)break;n=i.to+1;}return Dq.set(e)}},{key:"updateDeco",value:function(){for(var e=this,t=this.view.state.facet(dF).map((function(t,n){return (e.dynamicDecorationMap[n]="function"==typeof t)?t(e.view):t})),n=t.length;n<t.length+3;n++)this.dynamicDecorationMap[n]=!1;return this.decorations=[].concat(Vi(t),[this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco])}},{key:"scrollIntoView",value:function(e){var t,n=this,r=e.range,i=this.coordsAt(r.head,r.empty?r.assoc:r.head>r.anchor?-1:1);if(i){!r.empty&&(t=this.coordsAt(r.anchor,r.anchor>r.head?-1:1))&&(i={left:Math.min(i.left,t.left),top:Math.min(i.top,t.top),right:Math.max(i.right,t.right),bottom:Math.max(i.bottom,t.bottom)});var o,a=0,s=0,c=0,u=0,l=wi(this.view.state.facet(pF).map((function(e){return e(n.view)})));try{for(l.s();!(o=l.n()).done;){var f=o.value;if(f){var h=f.left,d=f.right,v=f.top,p=f.bottom;null!=h&&(a=Math.max(a,h)),null!=d&&(s=Math.max(s,d)),null!=v&&(c=Math.max(c,v)),null!=p&&(u=Math.max(u,p));}}}catch(e){l.e(e);}finally{l.f();}var m={left:i.left-a,top:i.top-c,right:i.right+s,bottom:i.bottom+u};!function(e,t,n,r,i,o,a,s){for(var c=e.ownerDocument,u=c.defaultView||window,l=e;l;)if(1==l.nodeType){var f=void 0,h=l==c.body;if(h)f=Hz(u);else {if(l.scrollHeight<=l.clientHeight&&l.scrollWidth<=l.clientWidth){l=l.assignedSlot||l.parentNode;continue}var d=l.getBoundingClientRect();f={left:d.left,right:d.left+l.clientWidth,top:d.top,bottom:d.top+l.clientHeight};}var v=0,p=0;if("nearest"==i)t.top<f.top?(p=-(f.top-t.top+a),n>0&&t.bottom>f.bottom+p&&(p=t.bottom-f.bottom+p+a)):t.bottom>f.bottom&&(p=t.bottom-f.bottom+a,n<0&&t.top-p<f.top&&(p=-(f.top+p-t.top+a)));else {var m=t.bottom-t.top,g=f.bottom-f.top;p=("center"==i&&m<=g?t.top+m/2-g/2:"start"==i||"center"==i&&n<0?t.top-a:t.bottom-g+a)-f.top;}if("nearest"==r?t.left<f.left?(v=-(f.left-t.left+o),n>0&&t.right>f.right+v&&(v=t.right-f.right+v+o)):t.right>f.right&&(v=t.right-f.right+o,n<0&&t.left<f.left+v&&(v=-(f.left+v-t.left+o))):v=("center"==r?t.left+(t.right-t.left)/2-(f.right-f.left)/2:"start"==r==s?t.left-o:t.right-(f.right-f.left)+o)-f.left,v||p)if(h)u.scrollBy(v,p);else {var y=0,b=0;if(p){var w=l.scrollTop;l.scrollTop+=p,b=l.scrollTop-w;}if(v){var x=l.scrollLeft;l.scrollLeft+=v,y=l.scrollLeft-x;}t={left:t.left-y,top:t.top-b,right:t.right-y,bottom:t.bottom-b},y&&Math.abs(y-v)<1&&(r="nearest"),b&&Math.abs(b-p)<1&&(i="nearest");}if(h)break;l=l.assignedSlot||l.parentNode;}else {if(11!=l.nodeType)break;l=l.host;}}(this.view.scrollDOM,m,r.head<r.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==bF.LTR);}}}]),n}();function VF(e){return 1==e.node.nodeType&&e.node.firstChild&&(0==e.offset||"false"==e.node.childNodes[e.offset-1].contentEditable)&&(e.offset==e.node.childNodes.length||"false"==e.node.childNodes[e.offset].contentEditable)}var WF=function(e){Pi(n,Nq);var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this)).height=e,r}return qi(n,[{key:"toDOM",value:function(){var e=document.createElement("div");return this.updateDOM(e),e}},{key:"eq",value:function(e){return e.height==this.height}},{key:"updateDOM",value:function(e){return e.style.height=this.height+"px",!0}},{key:"estimatedHeight",get:function(){return this.height}}]),n}();function HF(e){var t=e.observer.selectionRange,n=t.focusNode&&JF(t.focusNode,t.focusOffset,0);if(!n)return null;var r=e.docView.nearest(n);if(!r)return null;if(r instanceof Vq){for(var i=n;i.parentNode!=r.dom;)i=i.parentNode;for(var o=i.previousSibling;o&&!nq.get(o);)o=o.previousSibling;var a=o?nq.get(o).posAtEnd:r.posAtStart;return {from:a,to:a,node:i,text:n}}for(;;){var s=r.parent;if(!s)return null;if(s instanceof Vq)break;r=s;}var c=r.posAtStart;return {from:c,to:c+r.length,node:r.dom,text:n}}var UF=function(e){Pi(n,Nq);var t=Ri(n);function n(e,r,i){var o;return Bi(this,n),(o=t.call(this)).top=e,o.text=r,o.topView=i,o}return qi(n,[{key:"eq",value:function(e){return this.top==e.top&&this.text==e.text}},{key:"toDOM",value:function(){return this.top}},{key:"ignoreEvent",value:function(){return !1}},{key:"customView",get:function(){return jq}}]),n}();function JF(e,t,n){if(n<=0)for(var r=e,i=t;;){if(3==r.nodeType)return r;if(!(1==r.nodeType&&i>0))break;i=Vz(r=r.childNodes[i-1]);}if(n>=0)for(var o=e,a=t;;){if(3==o.nodeType)return o;if(!(1==o.nodeType&&a<o.childNodes.length&&n>=0))break;o=o.childNodes[a],a=0;}return null}function KF(e,t){return 1!=e.nodeType?0:(t&&"false"==e.childNodes[t-1].contentEditable?1:0)|(t<e.childNodes.length&&"false"==e.childNodes[t].contentEditable?2:0)}var GF=function(){function e(){Bi(this,e),this.changes=[];}return qi(e,[{key:"compareRange",value:function(e,t){Fq(e,t,this.changes);}},{key:"comparePoint",value:function(e,t){Fq(e,t,this.changes);}}]),e}();function QF(e,t){for(var n=e;n&&n!=t;n=n.assignedSlot||n.parentNode)if(1==n.nodeType&&"false"==n.contentEditable)return !0;return !1}function YF(e,t){return t.left>e?t.left-e:Math.max(0,e-t.right)}function XF(e,t){return t.top>e?t.top-e:Math.max(0,e-t.bottom)}function ZF(e,t){return e.top<t.bottom-1&&e.bottom>t.top+1}function eV(e,t){return t<e.top?{top:t,left:e.left,right:e.right,bottom:e.bottom}:e}function tV(e,t){return t>e.bottom?{top:e.top,left:e.left,right:e.right,bottom:t}:e}function nV(e,t,n){for(var r,i,o,a,s,c,u,l,f=!1,h=e.firstChild;h;h=h.nextSibling)for(var d=Bz(h),v=0;v<d.length;v++){var p=d[v];i&&ZF(i,p)&&(p=eV(tV(p,i.bottom),i.top));var m=YF(t,p),g=XF(n,p);if(0==m&&0==g)return 3==h.nodeType?rV(h,t,n):nV(h,t,n);if(!r||a>g||a==g&&o>m){r=h,i=p,o=m,a=g;var y=g?n<p.top?-1:1:m?t<p.left?-1:1:0;f=!y||(y>0?v<d.length-1:v>0);}0==m?n>p.bottom&&(!u||u.bottom<p.bottom)?(s=h,u=p):n<p.top&&(!l||l.top>p.top)&&(c=h,l=p):u&&ZF(u,p)?u=tV(u,p.bottom):l&&ZF(l,p)&&(l=eV(l,p.top));}if(u&&u.bottom>=n?(r=s,i=u):l&&l.top<=n&&(r=c,i=l),!r)return {node:e,offset:0};var b=Math.max(i.left,Math.min(i.right,t));return 3==r.nodeType?rV(r,b,n):f&&"false"!=r.contentEditable?nV(r,b,n):{node:e,offset:Array.prototype.indexOf.call(e.childNodes,r)+(t>=(i.left+i.right)/2?1:0)}}function rV(e,t,n){for(var r=e.nodeValue.length,i=-1,o=1e9,a=0,s=0;s<r;s++)for(var c=Qz(e,s,s+1).getClientRects(),u=0;u<c.length;u++){var l=c[u];if(l.top!=l.bottom){a||(a=t-l.left);var f=(l.top>n?l.top-n:n-l.bottom)-1;if(l.left-1<=t&&l.right+1>=t&&f<o){var h=t>=(l.left+l.right)/2,d=h;if(yq.chrome||yq.gecko)Qz(e,s).getBoundingClientRect().left==l.right&&(d=!h);if(f<=0)return {node:e,offset:s+(d?1:0)};i=s+(d?1:0),o=f;}}}return {node:e,offset:i>-1?i:a>0?e.nodeValue.length:0}}function iV(e,t,n){var r,i,o,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,s=e.contentDOM.getBoundingClientRect(),c=s.top+e.viewState.paddingTop,u=e.viewState.docHeight,l=t.x,f=t.y,h=f-c;if(h<0)return 0;if(h>u)return e.state.doc.length;for(var d=e.defaultLineHeight/2,v=!1;(o=e.elementAtHeight(h)).type!=Iq.Text;)for(;!((h=a>0?o.bottom+d:o.top-d)>=0&&h<=u);){if(v)return n?null:0;v=!0,a=-a;}f=c+h;var p=o.from;if(p<e.viewport.from)return 0==e.viewport.from?0:n?null:oV(e,s,o,l,f);if(p>e.viewport.to)return e.viewport.to==e.state.doc.length?e.state.doc.length:n?null:oV(e,s,o,l,f);var m=e.dom.ownerDocument,g=e.root.elementFromPoint?e.root:m,y=g.elementFromPoint(l,f);y&&!e.contentDOM.contains(y)&&(y=null),y||(l=Math.max(s.left+1,Math.min(s.right-1,l)),(y=g.elementFromPoint(l,f))&&!e.contentDOM.contains(y)&&(y=null));var b,w=-1;if(y&&0!=(null===(r=e.docView.nearest(y))||void 0===r?void 0:r.isEditable))if(m.caretPositionFromPoint){var x=m.caretPositionFromPoint(l,f);x&&(b=x.offsetNode,w=x.offset);}else if(m.caretRangeFromPoint){var k=m.caretRangeFromPoint(l,f);k&&(b=k.startContainer,w=k.startOffset,(!e.contentDOM.contains(b)||yq.safari&&aV(b,w,l)||yq.chrome&&sV(b,w,l))&&(b=void 0));}if(!b||!e.docView.dom.contains(b)){var j=Vq.find(e.docView,p);if(!j)return h>o.top+o.height/2?o.to:o.from;var S=nV(j.dom,l,f);b=S.node,w=S.offset;}var C=e.docView.nearest(b);if(!C)return null;if(C.isWidget&&1==(null===(i=C.dom)||void 0===i?void 0:i.nodeType)){var $=C.dom.getBoundingClientRect();return t.y<$.top||t.y<=$.bottom&&t.x<=($.left+$.right)/2?C.posAtStart:C.posAtEnd}return C.localPosFromDOM(b,w)+C.posAtStart}function oV(e,t,n,r,i){var o=Math.round((r-t.left)*e.defaultCharacterWidth);e.lineWrapping&&n.height>1.5*e.defaultLineHeight&&(o+=Math.floor((i-n.top)/e.defaultLineHeight)*e.viewState.heightOracle.lineLength);var a=e.state.sliceDoc(n.from,n.to);return n.from+xz(a,o,e.state.tabSize)}function aV(e,t,n){var r;if(3!=e.nodeType||t!=(r=e.nodeValue.length))return !1;for(var i=e.nextSibling;i;i=i.nextSibling)if(1!=i.nodeType||"BR"!=i.nodeName)return !1;return Qz(e,r-1,r).getBoundingClientRect().left>n}function sV(e,t,n){if(0!=t)return !1;for(var r=e;;){var i=r.parentNode;if(!i||1!=i.nodeType||i.firstChild!=r)return !1;if(i.classList.contains("cm-line"))break;r=i;}return n-(1==e.nodeType?e.getBoundingClientRect():Qz(e,0,Math.max(e.nodeValue.length,1)).getBoundingClientRect()).left>5}function cV(e,t,n,r){var i=e.state.doc.lineAt(t.head),o=r&&e.lineWrapping?e.coordsAtPos(t.assoc<0&&t.head>i.from?t.head-1:t.head):null;if(o){var a=e.dom.getBoundingClientRect(),s=e.textDirectionAt(i.from),c=e.posAtCoords({x:n==(s==bF.LTR)?a.right-1:a.left+1,y:(o.top+o.bottom)/2});if(null!=c)return fB.cursor(c,n?-1:1)}var u=Vq.find(e.docView,t.head),l=u?n?u.posAtEnd:u.posAtStart:n?i.to:i.from;return fB.cursor(l,n?-1:1)}function uV(e,t,n,r){for(var i=e.state.doc.lineAt(t.head),o=e.bidiSpans(i),a=e.textDirectionAt(i.from),s=t,c=null;;){var u=LF(i,o,a,s,n),l=DF;if(!u){if(i.number==(n?e.state.doc.lines:1))return s;l="\n",i=e.state.doc.line(i.number+(n?1:-1)),o=e.bidiSpans(i),u=fB.cursor(n?i.from:i.to);}if(c){if(!c(l))return s}else {if(!r)return u;c=r(l);}s=u;}}function lV(e,t,n){for(var r=e.state.facet(vF).map((function(t){return t(e)})),i=function(){var e,i=!1,o=wi(r);try{for(o.s();!(e=o.n()).done;){e.value.between(n.from-1,n.from+1,(function(e,r,o){n.from>e&&n.from<r&&(n=t.head>n.from?fB.cursor(e,1):fB.cursor(r,-1),i=!0);}));}}catch(e){o.e(e);}finally{o.f();}if(!i)return {v:n}};;){var o=i();if("object"===Ji(o))return o.v}}var fV=function(){function e(t){var n=this;Bi(this,e),this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null;var r=function(e,r){n.ignoreDuringComposition(r)||"keydown"==r.type&&n.keydown(t,r)||(n.mustFlushObserver(r)&&t.observer.forceFlush(),n.runCustomHandlers(r.type,t,r)?r.preventDefault():e(t,r));},i=function(){var e=yV[o];t.contentDOM.addEventListener(o,(function(n){gV(t,n)&&r(e,n);}),bV[o]),n.registeredEvents.push(o);};for(var o in yV)i();t.scrollDOM.addEventListener("mousedown",(function(e){if(e.target==t.scrollDOM&&e.clientY>t.contentDOM.getBoundingClientRect().bottom&&(r(yV.mousedown,e),!e.defaultPrevented&&2==e.button)){var n=t.contentDOM.style.minHeight;t.contentDOM.style.minHeight="100%",setTimeout((function(){return t.contentDOM.style.minHeight=n}),200);}})),t.scrollDOM.addEventListener("drop",(function(e){e.target==t.scrollDOM&&e.clientY>t.contentDOM.getBoundingClientRect().bottom&&r(yV.drop,e);})),yq.chrome&&102==yq.chrome_version&&t.scrollDOM.addEventListener("wheel",(function(){n.chromeScrollHack<0?t.contentDOM.style.pointerEvents="none":window.clearTimeout(n.chromeScrollHack),n.chromeScrollHack=setTimeout((function(){n.chromeScrollHack=-1,t.contentDOM.style.pointerEvents="";}),100);}),{passive:!0}),this.notifiedFocused=t.hasFocus,yq.safari&&t.contentDOM.addEventListener("input",(function(){return null}));}return qi(e,[{key:"setSelectionOrigin",value:function(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now();}},{key:"ensureHandlers",value:function(e,t){var n,r,i=this;this.customHandlers=[];var o,a=wi(t);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(r=null===(n=s.update(e).spec)||void 0===n?void 0:n.domEventHandlers){this.customHandlers.push({plugin:s.value,handlers:r});var c=function(t){i.registeredEvents.indexOf(t)<0&&"scroll"!=t&&(i.registeredEvents.push(t),e.contentDOM.addEventListener(t,(function(n){gV(e,n)&&i.runCustomHandlers(t,e,n)&&n.preventDefault();})));};for(var u in r)c(u);}}}catch(e){a.e(e);}finally{a.f();}}},{key:"runCustomHandlers",value:function(e,t,n){var r,i=wi(this.customHandlers);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=o.handlers[e];if(a)try{if(a.call(o.plugin,n,t)||n.defaultPrevented)return !0}catch(e){oF(t.state,e);}}}catch(e){i.e(e);}finally{i.f();}return !1}},{key:"runScrollHandlers",value:function(e,t){this.lastScrollTop=e.scrollDOM.scrollTop,this.lastScrollLeft=e.scrollDOM.scrollLeft;var n,r=wi(this.customHandlers);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=i.handlers.scroll;if(o)try{o.call(i.plugin,t,e);}catch(t){oF(e.state,t);}}}catch(e){r.e(e);}finally{r.f();}}},{key:"keydown",value:function(e,t){var n,r=this;return this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),9==t.keyCode&&Date.now()<this.lastEscPress+2e3||(27!=t.keyCode&&vV.indexOf(t.keyCode)<0&&(e.inputState.lastEscPress=0),!yq.android||!yq.chrome||t.synthetic||13!=t.keyCode&&8!=t.keyCode?!(!yq.ios||t.synthetic||t.altKey||t.metaKey||!((n=hV.find((function(e){return e.keyCode==t.keyCode})))&&!t.ctrlKey||dV.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey))&&(this.pendingIOSKey=n||t,setTimeout((function(){return r.flushIOSKey(e)}),250),!0):(e.observer.delayAndroidKey(t.key,t.keyCode),!0))}},{key:"flushIOSKey",value:function(e){var t=this.pendingIOSKey;return !!t&&(this.pendingIOSKey=void 0,Yz(e.contentDOM,t.key,t.keyCode))}},{key:"ignoreDuringComposition",value:function(e){return !!/^key/.test(e.type)&&(this.composing>0||!!(yq.safari&&!yq.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}},{key:"mustFlushObserver",value:function(e){return "keydown"==e.type&&229!=e.keyCode}},{key:"startMouseSelection",value:function(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e;}},{key:"update",value:function(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0);}},{key:"destroy",value:function(){this.mouseSelection&&this.mouseSelection.destroy();}}]),e}(),hV=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],dV="dthko",vV=[16,17,18,20,91,92,224,225];function pV(e){return .7*Math.max(0,e)+8}var mV=function(){function e(t,n,r,i){Bi(this,e),this.view=t,this.style=r,this.mustSelect=i,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=n,this.scrollParent=function(e){for(var t=e.ownerDocument,n=e.parentNode;n&&n!=t.body;)if(1==n.nodeType){if(n.scrollHeight>n.clientHeight||n.scrollWidth>n.clientWidth)return n;n=n.assignedSlot||n.parentNode;}else {if(11!=n.nodeType)break;n=n.host;}return null}(t.contentDOM);var o=t.contentDOM.ownerDocument;o.addEventListener("mousemove",this.move=this.move.bind(this)),o.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=n.shiftKey,this.multiple=t.state.facet(tz.allowMultipleSelections)&&function(e,t){var n=e.state.facet(Kq);return n.length?n[0](t):yq.mac?t.metaKey:t.ctrlKey}(t,n),this.dragMove=function(e,t){var n=e.state.facet(Gq);return n.length?n[0](t):yq.mac?!t.altKey:!t.ctrlKey}(t,n),this.dragging=!(!function(e,t){if(e.state.selection.main.empty)return !1;var n=Iz(e.root);if(!n||0==n.rangeCount)return !0;for(var r=n.getRangeAt(0).getClientRects(),i=0;i<r.length;i++){var o=r[i];if(o.left<=t.clientX&&o.right>=t.clientX&&o.top<=t.clientY&&o.bottom>=t.clientY)return !0}return !1}(t,n)||1!=AV(n))&&null;}return qi(e,[{key:"start",value:function(e){!1===this.dragging&&(e.preventDefault(),this.select(e));}},{key:"move",value:function(e){var t;if(0==e.buttons)return this.destroy();if(!1===this.dragging){this.select(this.lastEvent=e);var n=0,r=0,i=(null===(t=this.scrollParent)||void 0===t?void 0:t.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight};e.clientX<=i.left+6?n=-pV(i.left-e.clientX):e.clientX>=i.right-6&&(n=pV(e.clientX-i.right)),e.clientY<=i.top+6?r=-pV(i.top-e.clientY):e.clientY>=i.bottom-6&&(r=pV(e.clientY-i.bottom)),this.setScrollSpeed(n,r);}}},{key:"up",value:function(e){null==this.dragging&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy();}},{key:"destroy",value:function(){this.setScrollSpeed(0,0);var e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null;}},{key:"setScrollSpeed",value:function(e,t){var n=this;this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval((function(){return n.scroll()}),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1);}},{key:"scroll",value:function(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),!1===this.dragging&&this.select(this.lastEvent);}},{key:"select",value:function(e){var t=this.style.get(e,this.extend,this.multiple);!this.mustSelect&&t.eq(this.view.state.selection)&&t.main.assoc==this.view.state.selection.main.assoc||this.view.dispatch({selection:t,userEvent:"select.pointer"}),this.mustSelect=!1;}},{key:"update",value:function(e){var t=this;e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout((function(){return t.select(t.lastEvent)}),20);}}]),e}();function gV(e,t){if(!t.bubbles)return !0;if(t.defaultPrevented)return !1;for(var n,r=t.target;r!=e.contentDOM;r=r.parentNode)if(!r||11==r.nodeType||(n=nq.get(r))&&n.ignoreEvent(t))return !1;return !0}var yV=Object.create(null),bV=Object.create(null),wV=yq.ie&&yq.ie_version<15||yq.ios&&yq.webkit_version<604;function xV(e,t){var n,r=e.state,i=1,o=r.toText(t),a=o.lines==r.selection.ranges.length,s=null!=TV&&r.selection.ranges.every((function(e){return e.empty}))&&TV==o.toString();if(s){var c=-1;n=r.changeByRange((function(e){var n=r.doc.lineAt(e.from);if(n.from==c)return {range:e};c=n.from;var s=r.toText((a?o.line(i++).text:t)+r.lineBreak);return {changes:{from:n.from,insert:s},range:fB.cursor(e.from+s.length)}}));}else n=a?r.changeByRange((function(e){var t=o.line(i++);return {changes:{from:e.from,to:e.to,insert:t.text},range:fB.cursor(e.from+t.length)}})):r.replaceSelection(o);e.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0});}function kV(e,t,n,r){if(1==r)return fB.cursor(t,n);if(2==r)return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=e.charCategorizer(t),i=e.doc.lineAt(t),o=t-i.from;if(0==i.length)return fB.cursor(t);0==o?n=1:o==i.length&&(n=-1);var a=o,s=o;n<0?a=UL(i.text,o,!1):s=UL(i.text,o);for(var c=r(i.text.slice(a,s));a>0;){var u=UL(i.text,a,!1);if(r(i.text.slice(u,a))!=c)break;a=u;}for(;s<i.length;){var l=UL(i.text,s);if(r(i.text.slice(s,l))!=c)break;s=l;}return fB.range(a+i.from,s+i.from)}(e.state,t,n);var i=Vq.find(e.docView,t),o=e.state.doc.lineAt(i?i.posAtEnd:t),a=i?i.posAtStart:o.from,s=i?i.posAtEnd:o.to;return s<e.state.doc.length&&s==o.to&&s++,fB.range(a,s)}yV.keydown=function(e,t){e.inputState.setSelectionOrigin("select"),27==t.keyCode&&(e.inputState.lastEscPress=Date.now());},yV.touchstart=function(e,t){e.inputState.lastTouchTime=Date.now(),e.inputState.setSelectionOrigin("select.pointer");},yV.touchmove=function(e){e.inputState.setSelectionOrigin("select.pointer");},bV.touchstart=bV.touchmove={passive:!0},yV.mousedown=function(e,t){if(e.observer.flush(),!(e.inputState.lastTouchTime>Date.now()-2e3)){var n,r=null,i=wi(e.state.facet(Qq));try{for(i.s();!(n=i.n()).done;){if(r=(0,n.value)(e,t))break}}catch(e){i.e(e);}finally{i.f();}if(r||0!=t.button||(r=function(e,t){var n=$V(e,t),r=AV(t),i=e.state.selection;return {update:function(e){e.docChanged&&(n.pos=e.changes.mapPos(n.pos),i=i.map(e.changes));},get:function(t,o,a){var s,c=$V(e,t),u=kV(e,c.pos,c.bias,r);if(n.pos!=c.pos&&!o){var l=kV(e,n.pos,n.bias,r),f=Math.min(l.from,u.from),h=Math.max(l.to,u.to);u=f<u.from?fB.range(f,h):fB.range(h,f);}return o?i.replaceRange(i.main.extend(u.from,u.to)):a&&1==r&&i.ranges.length>1&&(s=function(e,t){for(var n=0;n<e.ranges.length;n++){var r=e.ranges[n],i=r.from,o=r.to;if(i<=t&&o>=t)return fB.create(e.ranges.slice(0,n).concat(e.ranges.slice(n+1)),e.mainIndex==n?0:e.mainIndex-(e.mainIndex>n?1:0))}return null}(i,c.pos))?s:a?i.addRange(u):fB.create([u])}}}(e,t)),r){var o=e.root.activeElement!=e.contentDOM;e.inputState.startMouseSelection(new mV(e,t,r,o)),o&&e.observer.ignore((function(){return Gz(e.contentDOM)})),e.inputState.mouseSelection&&e.inputState.mouseSelection.start(t);}}};var jV=function(e,t){return e>=t.top&&e<=t.bottom},SV=function(e,t,n){return jV(t,n)&&e>=n.left&&e<=n.right};function CV(e,t,n,r){var i=Vq.find(e.docView,t);if(!i)return 1;var o=t-i.posAtStart;if(0==o)return 1;if(o==i.length)return -1;var a=i.coordsAt(o,-1);if(a&&SV(n,r,a))return -1;var s=i.coordsAt(o,1);return s&&SV(n,r,s)?1:a&&jV(r,a)?-1:1}function $V(e,t){var n=e.posAtCoords({x:t.clientX,y:t.clientY},!1);return {pos:n,bias:CV(e,n,t.clientX,t.clientY)}}var _V=yq.ie&&yq.ie_version<=11,OV=null,MV=0,EV=0;function AV(e){if(!_V)return e.detail;var t=OV,n=EV;return OV=e,EV=Date.now(),MV=!t||n>Date.now()-400&&Math.abs(t.clientX-e.clientX)<2&&Math.abs(t.clientY-e.clientY)<2?(MV+1)%3:1}function PV(e,t,n,r){if(n){var i=e.posAtCoords({x:t.clientX,y:t.clientY},!1);t.preventDefault();var o=e.inputState.mouseSelection,a=r&&o&&o.dragging&&o.dragMove?{from:o.dragging.from,to:o.dragging.to}:null,s={from:i,insert:n},c=e.state.changes(a?[a,s]:s);e.focus(),e.dispatch({changes:c,selection:{anchor:c.mapPos(i,-1),head:c.mapPos(i,1)},userEvent:a?"move.drop":"input.drop"});}}yV.dragstart=function(e,t){var n=e.state.selection.main,r=e.inputState.mouseSelection;r&&(r.dragging=n),t.dataTransfer&&(t.dataTransfer.setData("Text",e.state.sliceDoc(n.from,n.to)),t.dataTransfer.effectAllowed="copyMove");},yV.drop=function(e,t){if(t.dataTransfer){if(e.state.readOnly)return t.preventDefault();var n=t.dataTransfer.files;if(n&&n.length){t.preventDefault();for(var r=Array(n.length),i=0,o=function(){++i==n.length&&PV(e,t,r.filter((function(e){return null!=e})).join(e.state.lineBreak),!1);},a=function(e){var t=new FileReader;t.onerror=o,t.onload=function(){/[\x00-\x08\x0e-\x1f]{2}/.test(t.result)||(r[e]=t.result),o();},t.readAsText(n[e]);},s=0;s<n.length;s++)a(s);}else PV(e,t,t.dataTransfer.getData("Text"),!0);}},yV.paste=function(e,t){if(e.state.readOnly)return t.preventDefault();e.observer.flush();var n=wV?null:t.clipboardData;n?(xV(e,n.getData("text/plain")||n.getData("text/uri-text")),t.preventDefault()):function(e){var t=e.dom.parentNode;if(t){var n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout((function(){e.focus(),n.remove(),xV(e,n.value);}),50);}}(e);};var TV=null;yV.copy=yV.cut=function(e,t){var n=function(e){var t,n=[],r=[],i=!1,o=wi(e.selection.ranges);try{for(o.s();!(t=o.n()).done;){var a=t.value;a.empty||(n.push(e.sliceDoc(a.from,a.to)),r.push(a));}}catch(e){o.e(e);}finally{o.f();}if(!n.length){var s,c=-1,u=wi(e.selection.ranges);try{for(u.s();!(s=u.n()).done;){var l=s.value.from,f=e.doc.lineAt(l);f.number>c&&(n.push(f.text),r.push({from:f.from,to:Math.min(e.doc.length,f.to+1)})),c=f.number;}}catch(e){u.e(e);}finally{u.f();}i=!0;}return {text:n.join(e.lineBreak),ranges:r,linewise:i}}(e.state),r=n.text,i=n.ranges,o=n.linewise;if(r||o){TV=o?r:null;var a=wV?null:t.clipboardData;a?(t.preventDefault(),a.clearData(),a.setData("text/plain",r)):function(e,t){var n=e.dom.parentNode;if(n){var r=n.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=t,r.focus(),r.selectionEnd=t.length,r.selectionStart=0,setTimeout((function(){r.remove(),e.focus();}),50);}}(e,r),"cut"!=t.type||e.state.readOnly||e.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});}};var RV=zB.define();function NV(e,t){var n,r=[],i=wi(e.facet(eF));try{for(i.s();!(n=i.n()).done;){var o=(0,n.value)(e,t);o&&r.push(o);}}catch(e){i.e(e);}finally{i.f();}return r?e.update({effects:r,annotations:RV.of(!0)}):null}function IV(e){setTimeout((function(){var t=e.hasFocus;if(t!=e.inputState.notifiedFocused){var n=NV(e.state,t);n?e.dispatch(n):e.update([]);}}),10);}yV.focus=function(e){e.inputState.lastFocusTime=Date.now(),e.scrollDOM.scrollTop||!e.inputState.lastScrollTop&&!e.inputState.lastScrollLeft||(e.scrollDOM.scrollTop=e.inputState.lastScrollTop,e.scrollDOM.scrollLeft=e.inputState.lastScrollLeft),IV(e);},yV.blur=function(e){e.observer.clearSelectionRange(),IV(e);},yV.compositionstart=yV.compositionupdate=function(e){null==e.inputState.compositionFirstChange&&(e.inputState.compositionFirstChange=!0),e.inputState.composing<0&&(e.inputState.composing=0);},yV.compositionend=function(e){e.inputState.composing=-1,e.inputState.compositionEndedAt=Date.now(),e.inputState.compositionPendingKey=!0,e.inputState.compositionPendingChange=e.observer.pendingRecords().length>0,e.inputState.compositionFirstChange=null,yq.chrome&&yq.android?e.observer.flushSoon():e.inputState.compositionPendingChange?Promise.resolve().then((function(){return e.observer.flush()})):setTimeout((function(){e.inputState.composing<0&&e.docView.compositionDeco.size&&e.update([]);}),50);},yV.contextmenu=function(e){e.inputState.lastContextMenu=Date.now();},yV.beforeinput=function(e,t){var n,r;if(yq.chrome&&yq.android&&(r=hV.find((function(e){return e.inputType==t.inputType})))&&(e.observer.delayAndroidKey(r.key,r.keyCode),"Backspace"==r.key||"Delete"==r.key)){var i=(null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0;setTimeout((function(){var t;((null===(t=window.visualViewport)||void 0===t?void 0:t.height)||0)>i+10&&e.hasFocus&&(e.contentDOM.blur(),e.focus());}),100);}};var DV=["pre-wrap","normal","pre-line","break-spaces"],LV=function(){function e(t){Bi(this,e),this.lineWrapping=t,this.doc=PL.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1;}return qi(e,[{key:"heightForGap",value:function(e,t){var n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}},{key:"heightForLine",value:function(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}},{key:"setDoc",value:function(e){return this.doc=e,this}},{key:"mustRefreshForWrapping",value:function(e){return DV.indexOf(e)>-1!=this.lineWrapping}},{key:"mustRefreshForHeights",value:function(e){for(var t=!1,n=0;n<e.length;n++){var r=e[n];r<0?n++:this.heightSamples[Math.floor(10*r)]||(t=!0,this.heightSamples[Math.floor(10*r)]=!0);}return t}},{key:"refresh",value:function(e,t,n,r,i,o){var a=DV.indexOf(e)>-1,s=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=a;if(this.lineWrapping=a,this.lineHeight=t,this.charWidth=n,this.textHeight=r,this.lineLength=i,s){this.heightSamples={};for(var c=0;c<o.length;c++){var u=o[c];u<0?c++:this.heightSamples[Math.floor(10*u)]=!0;}}return s}}]),e}(),BV=function(){function e(t,n){Bi(this,e),this.from=t,this.heights=n,this.index=0;}return qi(e,[{key:"more",get:function(){return this.index<this.heights.length}}]),e}(),zV=function(){function e(t,n,r,i,o,a){Bi(this,e),this.from=t,this.length=n,this.top=r,this.height=i,this.children=o,this.deco=a;}return qi(e,[{key:"type",get:function(){var e,t,n;return null!==(n=null!==(e=this.children)&&void 0!==e?e:null===(t=this.deco)||void 0===t?void 0:t.type)&&void 0!==n?n:Iq.Text}},{key:"widget",get:function(){return this.deco&&this.deco.widget}},{key:"to",get:function(){return this.from+this.length}},{key:"bottom",get:function(){return this.top+this.height}},{key:"join",value:function(t){var n=(this.children||[this]).concat(t.children||[t]);return new e(this.from,this.length+t.length,this.top,this.height+t.height,n,null)}}]),e}(),qV=function(e){return e[e.ByPos=0]="ByPos",e[e.ByHeight=1]="ByHeight",e[e.ByPosNoHeight=2]="ByPosNoHeight",e}(qV||(qV={})),FV=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;Bi(this,e),this.length=t,this.height=n,this.flags=r;}return qi(e,[{key:"outdated",get:function(){return (2&this.flags)>0},set:function(e){this.flags=(e?2:0)|-3&this.flags;}},{key:"setHeight",value:function(e,t){this.height!=t&&(Math.abs(this.height-t)>.001&&(e.heightChanged=!0),this.height=t);}},{key:"replace",value:function(t,n,r){return e.of(r)}},{key:"decomposeLeft",value:function(e,t){t.push(this);}},{key:"decomposeRight",value:function(e,t){t.push(this);}},{key:"applyChanges",value:function(e,t,n,r){for(var i=this,o=n.doc,a=r.length-1;a>=0;a--){var s=r[a],c=s.fromA,u=s.toA,l=s.fromB,f=s.toB,h=i.lineAt(c,qV.ByPosNoHeight,n.setDoc(t),0,0),d=h.to>=u?h:i.lineAt(u,qV.ByPosNoHeight,n,0,0);for(f+=d.to-u,u=d.to;a>0&&h.from<=r[a-1].toA;)c=r[a-1].fromA,l=r[a-1].fromB,a--,c<h.from&&(h=i.lineAt(c,qV.ByPosNoHeight,n,0,0));l+=h.from-c,c=h.from;var v=KV.build(n.setDoc(o),e,l,f);i=i.replace(c,u,v);}return i.updateHeight(n,0)}}],[{key:"empty",value:function(){return new WV(0,0)}},{key:"of",value:function(t){if(1==t.length)return t[0];for(var n=0,r=t.length,i=0,o=0;;)if(n==r)if(i>2*o){var a=t[n-1];a.break?t.splice(--n,1,a.left,null,a.right):t.splice(--n,1,a.left,a.right),r+=1+a.break,i-=a.size;}else {if(!(o>2*i))break;var s=t[r];s.break?t.splice(r,1,s.left,null,s.right):t.splice(r,1,s.left,s.right),r+=2+s.break,o-=s.size;}else if(i<o){var c=t[n++];c&&(i+=c.size);}else {var u=t[--r];u&&(o+=u.size);}var l=0;return null==t[n-1]?(l=1,n--):null==t[n]&&(l=1,r++),new UV(e.of(t.slice(0,n)),l,e.of(t.slice(r)))}}]),e}();FV.prototype.size=1;var VV=function(e){Pi(n,FV);var t=Ri(n);function n(e,r,i){var o;return Bi(this,n),(o=t.call(this,e,r)).deco=i,o}return qi(n,[{key:"blockAt",value:function(e,t,n,r){return new zV(r,this.length,n,this.height,null,this.deco)}},{key:"lineAt",value:function(e,t,n,r,i){return this.blockAt(0,n,r,i)}},{key:"forEachLine",value:function(e,t,n,r,i,o){e<=i+this.length&&t>=i&&o(this.blockAt(0,n,r,i));}},{key:"updateHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>3?arguments[3]:void 0;return n&&n.from<=t&&n.more&&this.setHeight(e,n.heights[n.index++]),this.outdated=!1,this}},{key:"toString",value:function(){return "block(".concat(this.length,")")}}]),n}(),WV=function(e){Pi(n,VV);var t=Ri(n);function n(e,r){var i;return Bi(this,n),(i=t.call(this,e,r,null)).collapsed=0,i.widgetHeight=0,i}return qi(n,[{key:"replace",value:function(e,t,r){var i=r[0];return 1==r.length&&(i instanceof n||i instanceof HV&&4&i.flags)&&Math.abs(this.length-i.length)<10?(i instanceof HV?i=new n(i.length,this.height):i.height=this.height,this.outdated||(i.outdated=!1),i):FV.of(r)}},{key:"updateHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;return r&&r.from<=t&&r.more?this.setHeight(e,r.heights[r.index++]):(n||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}},{key:"toString",value:function(){return "line(".concat(this.length).concat(this.collapsed?-this.collapsed:"").concat(this.widgetHeight?":"+this.widgetHeight:"",")")}}]),n}(),HV=function(e){Pi(n,FV);var t=Ri(n);function n(e){return Bi(this,n),t.call(this,e,0)}return qi(n,[{key:"heightMetrics",value:function(e,t){var n,r=e.doc.lineAt(t).number,i=e.doc.lineAt(t+this.length).number,o=i-r+1,a=0;if(e.lineWrapping){var s=Math.min(this.height,e.lineHeight*o);n=s/o,this.length>o+1&&(a=(this.height-s)/(this.length-o-1));}else n=this.height/o;return {firstLine:r,lastLine:i,perLine:n,perChar:a}}},{key:"blockAt",value:function(e,t,n,r){var i=this.heightMetrics(t,r),o=i.firstLine,a=i.lastLine,s=i.perLine,c=i.perChar;if(t.lineWrapping){var u=r+Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length),l=t.doc.lineAt(u),f=s+l.length*c,h=Math.max(n,e-f/2);return new zV(l.from,l.length,h,f,null,null)}var d=Math.max(0,Math.min(a-o,Math.floor((e-n)/s))),v=t.doc.line(o+d),p=v.from,m=v.length;return new zV(p,m,n+s*d,s,null,null)}},{key:"lineAt",value:function(e,t,n,r,i){if(t==qV.ByHeight)return this.blockAt(e,n,r,i);if(t==qV.ByPosNoHeight){var o=n.doc.lineAt(e),a=o.from,s=o.to;return new zV(a,s-a,0,0,null,null)}var c=this.heightMetrics(n,i),u=c.firstLine,l=c.perLine,f=c.perChar,h=n.doc.lineAt(e),d=l+h.length*f,v=h.number-u,p=r+l*v+f*(h.from-i-v);return new zV(h.from,h.length,Math.max(r,Math.min(p,r+this.height-d)),d,null,null)}},{key:"forEachLine",value:function(e,t,n,r,i,o){e=Math.max(e,i),t=Math.min(t,i+this.length);for(var a=this.heightMetrics(n,i),s=a.firstLine,c=a.perLine,u=a.perChar,l=e,f=r;l<=t;){var h=n.doc.lineAt(l);if(l==e){var d=h.number-s;f+=c*d+u*(e-i-d);}var v=c+u*h.length;o(new zV(h.from,h.length,f,v,null,null)),f+=v,l=h.to+1;}}},{key:"replace",value:function(e,t,r){var i=this.length-t;if(i>0){var o=r[r.length-1];o instanceof n?r[r.length-1]=new n(o.length+i):r.push(null,new n(i-1));}if(e>0){var a=r[0];a instanceof n?r[0]=new n(e+a.length):r.unshift(new n(e-1),null);}return FV.of(r)}},{key:"decomposeLeft",value:function(e,t){t.push(new n(e-1),null);}},{key:"decomposeRight",value:function(e,t){t.push(null,new n(this.length-e-1));}},{key:"updateHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0,o=t+this.length;if(i&&i.from<=t+this.length&&i.more){var a=[],s=Math.max(t,i.from),c=-1;for(i.from>t&&a.push(new n(i.from-t-1).updateHeight(e,t));s<=o&&i.more;){var u=e.doc.lineAt(s).length;a.length&&a.push(null);var l=i.heights[i.index++];-1==c?c=l:Math.abs(l-c)>=.001&&(c=-2);var f=new WV(u,l);f.outdated=!1,a.push(f),s+=u+1;}s<=o&&a.push(null,new n(o-s).updateHeight(e,s));var h=FV.of(a);return (c<0||Math.abs(h.height-this.height)>=.001||Math.abs(c-this.heightMetrics(e,t).perLine)>=.001)&&(e.heightChanged=!0),h}return (r||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1),this}},{key:"toString",value:function(){return "gap(".concat(this.length,")")}}]),n}(),UV=function(e){Pi(n,FV);var t=Ri(n);function n(e,r,i){var o;return Bi(this,n),(o=t.call(this,e.length+r+i.length,e.height+i.height,r|(e.outdated||i.outdated?2:0))).left=e,o.right=i,o.size=e.size+i.size,o}return qi(n,[{key:"break",get:function(){return 1&this.flags}},{key:"blockAt",value:function(e,t,n,r){var i=n+this.left.height;return e<i?this.left.blockAt(e,t,n,r):this.right.blockAt(e,t,i,r+this.left.length+this.break)}},{key:"lineAt",value:function(e,t,n,r,i){var o=r+this.left.height,a=i+this.left.length+this.break,s=t==qV.ByHeight?e<o:e<a,c=s?this.left.lineAt(e,t,n,r,i):this.right.lineAt(e,t,n,o,a);if(this.break||(s?c.to<a:c.from>a))return c;var u=t==qV.ByPosNoHeight?qV.ByPosNoHeight:qV.ByPos;return s?c.join(this.right.lineAt(a,u,n,o,a)):this.left.lineAt(a,u,n,r,i).join(c)}},{key:"forEachLine",value:function(e,t,n,r,i,o){var a=r+this.left.height,s=i+this.left.length+this.break;if(this.break)e<s&&this.left.forEachLine(e,t,n,r,i,o),t>=s&&this.right.forEachLine(e,t,n,a,s,o);else {var c=this.lineAt(s,qV.ByPos,n,r,i);e<c.from&&this.left.forEachLine(e,c.from-1,n,r,i,o),c.to>=e&&c.from<=t&&o(c),t>c.to&&this.right.forEachLine(c.to+1,t,n,a,s,o);}}},{key:"replace",value:function(e,t,n){var r=this.left.length+this.break;if(t<r)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,t-r,n));var i=[];e>0&&this.decomposeLeft(e,i);var o,a=i.length,s=wi(n);try{for(s.s();!(o=s.n()).done;){var c=o.value;i.push(c);}}catch(e){s.e(e);}finally{s.f();}if(e>0&&JV(i,a-1),t<this.length){var u=i.length;this.decomposeRight(t,i),JV(i,u);}return FV.of(i)}},{key:"decomposeLeft",value:function(e,t){var n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&e>=++n&&t.push(null),e>n&&this.right.decomposeLeft(e-n,t);}},{key:"decomposeRight",value:function(e,t){var n=this.left.length,r=n+this.break;if(e>=r)return this.right.decomposeRight(e-r,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<r&&t.push(null),t.push(this.right);}},{key:"balanced",value:function(e,t){return e.size>2*t.size||t.size>2*e.size?FV.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}},{key:"updateHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i=this.left,o=this.right,a=t+i.length+this.break,s=null;return r&&r.from<=t+i.length&&r.more?s=i=i.updateHeight(e,t,n,r):i.updateHeight(e,t,n),r&&r.from<=a+o.length&&r.more?s=o=o.updateHeight(e,a,n,r):o.updateHeight(e,a,n),s?this.balanced(i,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}},{key:"toString",value:function(){return this.left+(this.break?" ":"-")+this.right}}]),n}();function JV(e,t){var n,r;null==e[t]&&(n=e[t-1])instanceof HV&&(r=e[t+1])instanceof HV&&e.splice(t-1,3,new HV(n.length+1+r.length));}var KV=function(){function e(t,n){Bi(this,e),this.pos=t,this.oracle=n,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t;}return qi(e,[{key:"isCovered",get:function(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}},{key:"span",value:function(e,t){if(this.lineStart>-1){var n=Math.min(t,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof WV?r.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new WV(n-this.pos,-1)),this.writtenTo=n,t>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1);}this.pos=t;}},{key:"point",value:function(e,t,n){if(e<t||n.heightRelevant){var r=n.widget?n.widget.estimatedHeight:0;r<0&&(r=this.oracle.lineHeight);var i=t-e;n.block?this.addBlock(new VV(i,r,n)):(i||r>=5)&&this.addLineDeco(r,i);}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to);}},{key:"enterLine",value:function(){if(!(this.lineStart>-1)){var e=this.oracle.doc.lineAt(this.pos),t=e.from,n=e.to;this.lineStart=t,this.lineEnd=n,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new WV(this.pos-t,-1)),this.writtenTo=this.pos;}}},{key:"blankContent",value:function(e,t){var n=new HV(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}},{key:"ensureLine",value:function(){this.enterLine();var e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof WV)return e;var t=new WV(0,-1);return this.nodes.push(t),t}},{key:"addBlock",value:function(e){var t;this.enterLine();var n=null===(t=e.deco)||void 0===t?void 0:t.type;n!=Iq.WidgetAfter||this.isCovered||this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,n!=Iq.WidgetBefore&&(this.covering=e);}},{key:"addLineDeco",value:function(e,t){var n=this.ensureLine();n.length+=t,n.collapsed+=t,n.widgetHeight=Math.max(n.widgetHeight,e),this.writtenTo=this.pos=this.pos+t;}},{key:"finish",value:function(e){var t=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||t instanceof WV||this.isCovered?(this.writtenTo<this.pos||null==t)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new WV(0,-1));var n,r=e,i=wi(this.nodes);try{for(i.s();!(n=i.n()).done;){var o=n.value;o instanceof WV&&o.updateHeight(this.oracle,r),r+=o?o.length:1;}}catch(e){i.e(e);}finally{i.f();}return this.nodes}}],[{key:"build",value:function(t,n,r,i){var o=new e(r,t);return sz.spans(n,r,i,o,0),o.finish(r)}}]),e}();function GV(e,t,n){var r=new QV;return sz.compare(e,t,n,r,0),r.changes}var QV=function(){function e(){Bi(this,e),this.changes=[];}return qi(e,[{key:"compareRange",value:function(){}},{key:"comparePoint",value:function(e,t,n,r){(e<t||n&&n.heightRelevant||r&&r.heightRelevant)&&Fq(e,t,this.changes,5);}}]),e}();function YV(e,t){for(var n=e.getBoundingClientRect(),r=e.ownerDocument,i=r.defaultView||window,o=Math.max(0,n.left),a=Math.min(i.innerWidth,n.right),s=Math.max(0,n.top),c=Math.min(i.innerHeight,n.bottom),u=e.parentNode;u&&u!=r.body;)if(1==u.nodeType){var l=u,f=window.getComputedStyle(l);if((l.scrollHeight>l.clientHeight||l.scrollWidth>l.clientWidth)&&"visible"!=f.overflow){var h=l.getBoundingClientRect();o=Math.max(o,h.left),a=Math.min(a,h.right),s=Math.max(s,h.top),c=u==e.parentNode?h.bottom:Math.min(c,h.bottom);}u="absolute"==f.position||"fixed"==f.position?l.offsetParent:l.parentNode;}else {if(11!=u.nodeType)break;u=u.host;}return {left:o-n.left,right:Math.max(o,a)-n.left,top:s-(n.top+t),bottom:Math.max(s,c)-(n.top+t)}}function XV(e,t){var n=e.getBoundingClientRect();return {left:0,right:n.right-n.left,top:t,bottom:n.bottom-(n.top+t)}}var ZV=function(){function e(t,n,r){Bi(this,e),this.from=t,this.to=n,this.size=r;}return qi(e,[{key:"draw",value:function(e){return Dq.replace({widget:new eW(this.size,e)}).range(this.from,this.to)}}],[{key:"same",value:function(e,t){if(e.length!=t.length)return !1;for(var n=0;n<e.length;n++){var r=e[n],i=t[n];if(r.from!=i.from||r.to!=i.to||r.size!=i.size)return !1}return !0}}]),e}(),eW=function(e){Pi(n,Nq);var t=Ri(n);function n(e,r){var i;return Bi(this,n),(i=t.call(this)).size=e,i.vertical=r,i}return qi(n,[{key:"eq",value:function(e){return e.size==this.size&&e.vertical==this.vertical}},{key:"toDOM",value:function(){var e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}},{key:"estimatedHeight",get:function(){return this.vertical?this.size:-1}}]),n}(),tW=function(){function e(t){Bi(this,e),this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scaler=aW,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=bF.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;var n=t.facet(hF).some((function(e){return "function"!=typeof e&&"cm-lineWrapping"==e.class}));this.heightOracle=new LV(n),this.stateDeco=t.facet(dF).filter((function(e){return "function"!=typeof e})),this.heightMap=FV.empty().applyChanges(this.stateDeco,PL.empty,this.heightOracle.setDoc(t.doc),[new gF(0,0,0,t.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Dq.set(this.lineGaps.map((function(e){return e.draw(!1)}))),this.computeVisibleRanges();}return qi(e,[{key:"updateForViewport",value:function(){for(var e=this,t=[this.viewport],n=this.state.selection.main,r=function(){var r=i?n.head:n.anchor;if(!t.some((function(e){var t=e.from,n=e.to;return r>=t&&r<=n}))){var o=e.lineBlockAt(r),a=o.from,s=o.to;t.push(new nW(a,s));}},i=0;i<=1;i++)r();this.viewports=t.sort((function(e,t){return e.from-t.from})),this.scaler=this.heightMap.height<=7e6?aW:new sW(this.heightOracle,this.heightMap,this.viewports);}},{key:"updateViewportLines",value:function(){var e=this;this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(function(t){e.viewportLines.push(1==e.scaler.scale?t:cW(t,e.scaler));}));}},{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.state=e.state;var n=this.stateDeco;this.stateDeco=this.state.facet(dF).filter((function(e){return "function"!=typeof e}));var r=e.changedRanges,i=gF.extendWithRanges(r,GV(n,this.stateDeco,e?e.changes:rB.empty(this.state.doc.length))),o=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),i),this.heightMap.height!=o&&(e.flags|=2);var a=i.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<a.from||t.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,t));var s=!e.changes.empty||2&e.flags||a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,this.updateForViewport(),s&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(nF)&&(this.mustEnforceCursorAssoc=!0);}},{key:"measure",value:function(e){var t=e.contentDOM,n=window.getComputedStyle(t),r=this.heightOracle,i=n.whiteSpace;this.defaultTextDirection="rtl"==n.direction?bF.RTL:bF.LTR;var o=this.heightOracle.mustRefreshForWrapping(i),a=t.getBoundingClientRect(),s=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;var c=0,u=0,l=parseInt(n.paddingTop)||0,f=parseInt(n.paddingBottom)||0;this.paddingTop==l&&this.paddingBottom==f||(this.paddingTop=l,this.paddingBottom=f,c|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(s=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=8);var h=(this.printing?XV:YV)(t,this.paddingTop),d=h.top-this.pixelViewport.top,v=h.bottom-this.pixelViewport.bottom;this.pixelViewport=h;var p=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(p!=this.inView&&(this.inView=p,p&&(s=!0)),!this.inView&&!this.scrollTarget)return 0;var m=a.width;if(this.contentDOMWidth==m&&this.editorHeight==e.scrollDOM.clientHeight||(this.contentDOMWidth=a.width,this.editorHeight=e.scrollDOM.clientHeight,c|=8),s){var g=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(g)&&(o=!0),o||r.lineWrapping&&Math.abs(m-this.contentDOMWidth)>r.charWidth){var y=e.docView.measureTextSize(),b=y.lineHeight,w=y.charWidth,x=y.textHeight;(o=b>0&&r.refresh(i,b,w,x,m/w,g))&&(e.docView.minWidth=0,c|=8);}d>0&&v>0?u=Math.max(d,v):d<0&&v<0&&(u=Math.min(d,v)),r.heightChanged=!1;var k,j=wi(this.viewports);try{for(j.s();!(k=j.n()).done;){var S=k.value,C=S.from==this.viewport.from?g:e.docView.measureVisibleLineHeights(S);this.heightMap=(o?FV.empty().applyChanges(this.stateDeco,PL.empty,this.heightOracle,[new gF(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,o,new BV(S.from,C));}}catch(e){j.e(e);}finally{j.f();}r.heightChanged&&(c|=2);}var $=!this.viewportIsAppropriate(this.viewport,u)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return $&&(this.viewport=this.getViewport(u,this.scrollTarget)),this.updateForViewport(),(2&c||$)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}},{key:"visibleTop",get:function(){return this.scaler.fromDOM(this.pixelViewport.top)}},{key:"visibleBottom",get:function(){return this.scaler.fromDOM(this.pixelViewport.bottom)}},{key:"getViewport",value:function(e,t){var n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,i=this.heightOracle,o=this.visibleTop,a=this.visibleBottom,s=new nW(r.lineAt(o-1e3*n,qV.ByHeight,i,0,0).from,r.lineAt(a+1e3*(1-n),qV.ByHeight,i,0,0).to);if(t){var c=t.range.head;if(c<s.from||c>s.to){var u,l=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),f=r.lineAt(c,qV.ByPos,i,0,0);u="center"==t.y?(f.top+f.bottom)/2-l/2:"start"==t.y||"nearest"==t.y&&c<s.from?f.top:f.bottom-l,s=new nW(r.lineAt(u-500,qV.ByHeight,i,0,0).from,r.lineAt(u+l+500,qV.ByHeight,i,0,0).to);}}return s}},{key:"mapViewport",value:function(e,t){var n=t.mapPos(e.from,-1),r=t.mapPos(e.to,1);return new nW(this.heightMap.lineAt(n,qV.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,qV.ByPos,this.heightOracle,0,0).to)}},{key:"viewportIsAppropriate",value:function(e){var t=e.from,n=e.to,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.inView)return !0;var i=this.heightMap.lineAt(t,qV.ByPos,this.heightOracle,0,0),o=i.top,a=this.heightMap.lineAt(n,qV.ByPos,this.heightOracle,0,0),s=a.bottom,c=this.visibleTop,u=this.visibleBottom;return (0==t||o<=c-Math.max(10,Math.min(-r,250)))&&(n==this.state.doc.length||s>=u+Math.max(10,Math.min(r,250)))&&o>c-2e3&&s<u+2e3}},{key:"mapLineGaps",value:function(e,t){if(!e.length||t.empty)return e;var n,r=[],i=wi(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;t.touchesRange(o.from,o.to)||r.push(new ZV(t.mapPos(o.from),t.mapPos(o.to),o.size));}}catch(e){i.e(e);}finally{i.f();}return r}},{key:"ensureLineGaps",value:function(e,t){var n=this,r=this.heightOracle.lineWrapping,i=r?1e4:2e3,o=i>>1,a=i<<1;if(this.defaultTextDirection!=bF.LTR&&!r)return [];var s,c=[],u=function i(a,s,u,l){if(!(s-a<o)){var f=n.state.selection.main,h=[f.from];f.empty||h.push(f.to);for(var d=0,v=h;d<v.length;d++){var p=v[d];if(p>a&&p<s)return i(a,p-10,u,l),void i(p+10,s,u,l)}var m=function(e,t){var n,r=wi(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t(i))return i}}catch(e){r.e(e);}finally{r.f();}return}(e,(function(e){return e.from>=u.from&&e.to<=u.to&&Math.abs(e.from-a)<o&&Math.abs(e.to-s)<o&&!h.some((function(t){return e.from<t&&e.to>t}))}));if(!m){if(s<u.to&&t&&r&&t.visibleRanges.some((function(e){return e.from<=s&&e.to>=s}))){var g=t.moveToLineBoundary(fB.cursor(s),!1,!0).head;g>a&&(s=g);}m=new ZV(a,s,n.gapSize(u,a,s,l));}c.push(m);}},l=wi(this.viewportLines);try{for(l.s();!(s=l.n()).done;){var f=s.value;if(!(f.length<a)){var h=rW(f.from,f.to,this.stateDeco);if(!(h.total<a)){var d=this.scrollTarget?this.scrollTarget.range.head:null,v=void 0,p=void 0;if(r){var m=i/this.heightOracle.lineLength*this.heightOracle.lineHeight,g=void 0,y=void 0;if(null!=d){var b=oW(h,d),w=((this.visibleBottom-this.visibleTop)/2+m)/f.height;g=b-w,y=b+w;}else g=(this.visibleTop-f.top-m)/f.height,y=(this.visibleBottom-f.top+m)/f.height;v=iW(h,g),p=iW(h,y);}else {var x=h.total*this.heightOracle.charWidth,k=i*this.heightOracle.charWidth,j=void 0,S=void 0;if(null!=d){var C=oW(h,d),$=((this.pixelViewport.right-this.pixelViewport.left)/2+k)/x;j=C-$,S=C+$;}else j=(this.pixelViewport.left-k)/x,S=(this.pixelViewport.right+k)/x;v=iW(h,j),p=iW(h,S);}v>f.from&&u(f.from,v,f,h),p<f.to&&u(p,f.to,f,h);}}}}catch(e){l.e(e);}finally{l.f();}return c}},{key:"gapSize",value:function(e,t,n,r){var i=oW(r,n)-oW(r,t);return this.heightOracle.lineWrapping?e.height*i:r.total*this.heightOracle.charWidth*i}},{key:"updateLineGaps",value:function(e){var t=this;ZV.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Dq.set(e.map((function(e){return e.draw(t.heightOracle.lineWrapping)}))));}},{key:"computeVisibleRanges",value:function(){var e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));var t=[];sz.spans(e,this.viewport.from,this.viewport.to,{span:function(e,n){t.push({from:e,to:n});},point:function(){}},20);var n=t.length!=this.visibleRanges.length||this.visibleRanges.some((function(e,n){return e.from!=t[n].from||e.to!=t[n].to}));return this.visibleRanges=t,n?4:0}},{key:"lineBlockAt",value:function(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find((function(t){return t.from<=e&&t.to>=e}))||cW(this.heightMap.lineAt(e,qV.ByPos,this.heightOracle,0,0),this.scaler)}},{key:"lineBlockAtHeight",value:function(e){return cW(this.heightMap.lineAt(this.scaler.fromDOM(e),qV.ByHeight,this.heightOracle,0,0),this.scaler)}},{key:"elementAtHeight",value:function(e){return cW(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}},{key:"docHeight",get:function(){return this.scaler.toDOM(this.heightMap.height)}},{key:"contentHeight",get:function(){return this.docHeight+this.paddingTop+this.paddingBottom}}]),e}(),nW=qi((function e(t,n){Bi(this,e),this.from=t,this.to=n;}));function rW(e,t,n){var r=[],i=e,o=0;return sz.spans(n,e,t,{span:function(){},point:function(e,t){e>i&&(r.push({from:i,to:e}),o+=e-i),i=t;}},20),i<t&&(r.push({from:i,to:t}),o+=t-i),{total:o,ranges:r}}function iW(e,t){var n=e.total,r=e.ranges;if(t<=0)return r[0].from;if(t>=1)return r[r.length-1].to;for(var i=Math.floor(n*t),o=0;;o++){var a=r[o],s=a.from,c=a.to-s;if(i<=c)return s+i;i-=c;}}function oW(e,t){var n,r=0,i=wi(e.ranges);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=o.from,s=o.to;if(t<=s){r+=t-a;break}r+=s-a;}}catch(e){i.e(e);}finally{i.f();}return r/e.total}var aW={toDOM:function(e){return e},fromDOM:function(e){return e},scale:1},sW=function(){function e(t,n,r){Bi(this,e);var i=0,o=0,a=0;this.viewports=r.map((function(e){var r=e.from,o=e.to,a=n.lineAt(r,qV.ByPos,t,0,0).top,s=n.lineAt(o,qV.ByPos,t,0,0).bottom;return i+=s-a,{from:r,to:o,top:a,bottom:s,domTop:0,domBottom:0}})),this.scale=(7e6-i)/(n.height-i);var s,c=wi(this.viewports);try{for(c.s();!(s=c.n()).done;){var u=s.value;u.domTop=a+(u.top-o)*this.scale,a=u.domBottom=u.domTop+(u.bottom-u.top),o=u.bottom;}}catch(e){c.e(e);}finally{c.f();}}return qi(e,[{key:"toDOM",value:function(e){for(var t=0,n=0,r=0;;t++){var i=t<this.viewports.length?this.viewports[t]:null;if(!i||e<i.top)return r+(e-n)*this.scale;if(e<=i.bottom)return i.domTop+(e-i.top);n=i.bottom,r=i.domBottom;}}},{key:"fromDOM",value:function(e){for(var t=0,n=0,r=0;;t++){var i=t<this.viewports.length?this.viewports[t]:null;if(!i||e<i.domTop)return n+(e-r)/this.scale;if(e<=i.domBottom)return i.top+(e-i.domTop);n=i.bottom,r=i.domBottom;}}}]),e}();function cW(e,t){if(1==t.scale)return e;var n=t.toDOM(e.top),r=t.toDOM(e.bottom);return new zV(e.from,e.length,n,r-n,e.children&&e.children.map((function(e){return cW(e,t)})),e.deco)}var uW=vB.define({combine:function(e){return e.join(" ")}}),lW=vB.define({combine:function(e){return e.indexOf(!0)>-1}}),fW=Cz.newName(),hW=Cz.newName(),dW=Cz.newName(),vW={"&light":"."+hW,"&dark":"."+dW};function pW(e,t,n){return new Cz(t,{finish:function(t){return /&/.test(t)?t.replace(/&\w*/,(function(t){if("&"==t)return e;if(!n||!n[t])throw new RangeError("Unsupported selector: ".concat(t));return n[t]})):e+" "+t}})}var mW=pW("."+fW,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},vW),gW=qi((function e(t,n,r,i){Bi(this,e),this.typeOver=i,this.bounds=null,this.text="";var o=t.docView,a=o.impreciseHead,s=o.impreciseAnchor;if(t.state.readOnly&&n>-1)this.newSel=null;else if(n>-1&&(this.bounds=t.docView.domBoundsAround(n,r,0))){var c=a||s?[]:function(e){var t=[];if(e.root.activeElement!=e.contentDOM)return t;var n=e.observer.selectionRange,r=n.anchorNode,i=n.anchorOffset,o=n.focusNode,a=n.focusOffset;r&&(t.push(new qF(r,i)),o==r&&a==i||t.push(new qF(o,a)));return t}(t),u=new BF(c,t.state);u.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=u.text,this.newSel=function(e,t){if(0==e.length)return null;var n=e[0].pos,r=2==e.length?e[1].pos:n;return n>-1&&r>-1?fB.single(n+t,r+t):null}(c,this.bounds.from);}else {var l=t.observer.selectionRange,f=a&&a.node==l.focusNode&&a.offset==l.focusOffset||!Dz(t.contentDOM,l.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(l.focusNode,l.focusOffset),h=s&&s.node==l.anchorNode&&s.offset==l.anchorOffset||!Dz(t.contentDOM,l.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(l.anchorNode,l.anchorOffset);this.newSel=fB.single(h,f);}}));function yW(e,t){var n,r=t.newSel,i=e.state.selection.main;if(t.bounds){var o=t.bounds,a=o.from,s=o.to,c=i.from,u=null;(8===e.inputState.lastKeyCode&&e.inputState.lastKeyTime>Date.now()-100||yq.android&&t.text.length<s-a)&&(c=i.to,u="end");var l=function(e,t,n,r){var i=Math.min(e.length,t.length),o=0;for(;o<i&&e.charCodeAt(o)==t.charCodeAt(o);)o++;if(o==i&&e.length==t.length)return null;var a=e.length,s=t.length;for(;a>0&&s>0&&e.charCodeAt(a-1)==t.charCodeAt(s-1);)a--,s--;if("end"==r){n-=a+Math.max(0,o-Math.min(a,s))-o;}if(a<o&&e.length<t.length){s=(o-=n<=o&&n>=a?o-n:0)+(s-a),a=o;}else if(s<o){a=(o-=n<=o&&n>=s?o-n:0)+(a-s),s=o;}return {from:o,toA:a,toB:s}}(e.state.doc.sliceString(a,s,""),t.text,c-a,u);l&&(yq.chrome&&13==e.inputState.lastKeyCode&&l.toB==l.from+2&&""==t.text.slice(l.from,l.toB)&&l.toB--,n={from:a+l.from,to:a+l.toA,insert:PL.of(t.text.slice(l.from,l.toB).split(""))});}else r&&(!e.hasFocus&&e.state.facet(aF)||r.main.eq(i))&&(r=null);if(!n&&!r)return !1;if(!n&&t.typeOver&&!i.empty&&r&&r.main.empty?n={from:i.from,to:i.to,insert:e.state.doc.slice(i.from,i.to)}:n&&n.from>=i.from&&n.to<=i.to&&(n.from!=i.from||n.to!=i.to)&&i.to-i.from-(n.to-n.from)<=4?n={from:i.from,to:i.to,insert:e.state.doc.slice(i.from,n.from).append(n.insert).append(e.state.doc.slice(n.to,i.to))}:(yq.mac||yq.android)&&n&&n.from==n.to&&n.from==i.head-1&&/^\. ?$/.test(n.insert.toString())&&"off"==e.contentDOM.getAttribute("autocorrect")?(r&&2==n.insert.length&&(r=fB.single(r.main.anchor-1,r.main.head-1)),n={from:i.from,to:i.to,insert:PL.of([" "])}):yq.chrome&&n&&n.from==n.to&&n.from==i.head&&"\n "==n.insert.toString()&&e.lineWrapping&&(r&&(r=fB.single(r.main.anchor-1,r.main.head-1)),n={from:i.from,to:i.to,insert:PL.of([" "])}),n){var f=e.state;if(yq.ios&&e.inputState.flushIOSKey(e))return !0;if(yq.android&&(n.from==i.from&&n.to==i.to&&1==n.insert.length&&2==n.insert.lines&&Yz(e.contentDOM,"Enter",13)||n.from==i.from-1&&n.to==i.to&&0==n.insert.length&&Yz(e.contentDOM,"Backspace",8)||n.from==i.from&&n.to==i.to+1&&0==n.insert.length&&Yz(e.contentDOM,"Delete",46)))return !0;var h,d=n.insert.toString();if(e.state.facet(Zq).some((function(t){return t(e,n.from,n.to,d)})))return !0;if(e.inputState.composing>=0&&e.inputState.composing++,n.from>=i.from&&n.to<=i.to&&n.to-n.from>=(i.to-i.from)/3&&(!r||r.main.empty&&r.main.from==n.from+n.insert.length)&&e.inputState.composing<0){var v=i.from<n.from?f.sliceDoc(i.from,n.from):"",p=i.to>n.to?f.sliceDoc(n.to,i.to):"";h=f.replaceSelection(e.state.toText(v+n.insert.sliceString(0,void 0,e.state.lineBreak)+p));}else {var m=f.changes(n),g=r&&r.main.to<=m.newLength?r.main:void 0;if(f.selection.ranges.length>1&&e.inputState.composing>=0&&n.to<=i.to&&n.to>=i.to-10){var y=e.state.sliceDoc(n.from,n.to),b=HF(e)||e.state.doc.lineAt(i.head),w=i.to-n.to,x=i.to-i.from;h=f.changeByRange((function(t){if(t.from==i.from&&t.to==i.to)return {changes:m,range:g||t.map(m)};var r=t.to-w,o=r-y.length;if(t.to-t.from!=x||e.state.sliceDoc(o,r)!=y||b&&t.to>=b.from&&t.from<=b.to)return {range:t};var a=f.changes({from:o,to:r,insert:n.insert}),s=t.to-i.to;return {changes:a,range:g?fB.range(Math.max(0,g.anchor+s),Math.max(0,g.head+s)):t.map(a)}}));}else h={changes:m,selection:g&&f.selection.replaceRange(g)};}var k="input.type";return (e.composing||e.inputState.compositionPendingChange&&e.inputState.compositionEndedAt>Date.now()-50)&&(e.inputState.compositionPendingChange=!1,k+=".compose",e.inputState.compositionFirstChange&&(k+=".start",e.inputState.compositionFirstChange=!1)),e.dispatch(h,{scrollIntoView:!0,userEvent:k}),!0}if(r&&!r.main.eq(i)){var j=!1,S="select";return e.inputState.lastSelectionTime>Date.now()-50&&("select"==e.inputState.lastSelectionOrigin&&(j=!0),S=e.inputState.lastSelectionOrigin),e.dispatch({selection:r,scrollIntoView:j,userEvent:S}),!0}return !1}var bW={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},wW=yq.ie&&yq.ie_version<=11,xW=function(){function e(t){var n=this;Bi(this,e),this.view=t,this.active=!1,this.selectionRange=new Jz,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.resizeContent=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver((function(e){var r,i=wi(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;n.queue.push(o);}}catch(e){i.e(e);}finally{i.f();}(yq.ie&&yq.ie_version<=11||yq.ios&&t.composing)&&e.some((function(e){return "childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length}))?n.flushSoon():n.flush();})),wW&&(this.onCharData=function(e){n.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),n.flushSoon();}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver((function(){var e;(null===(e=n.view.docView)||void 0===e?void 0:e.lastUpdate)<Date.now()-75&&n.onResize();})),this.resizeScroll.observe(t.scrollDOM),this.resizeContent=new ResizeObserver((function(){return n.view.requestMeasure()})),this.resizeContent.observe(t.contentDOM)),this.addWindowListeners(this.win=t.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((function(e){n.parentCheck<0&&(n.parentCheck=setTimeout(n.listenForScroll.bind(n),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=n.intersecting&&(n.intersecting=!n.intersecting,n.intersecting!=n.view.inView&&n.onScrollChanged(document.createEvent("Event")));}),{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((function(e){e.length>0&&e[e.length-1].intersectionRatio>0&&n.onScrollChanged(document.createEvent("Event"));}),{})),this.listenForScroll(),this.readSelectionRange();}return qi(e,[{key:"onScrollChanged",value:function(e){this.view.inputState.runScrollHandlers(this.view,e),this.intersecting&&this.view.measure();}},{key:"onScroll",value:function(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e);}},{key:"onResize",value:function(){var e=this;this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((function(){e.resizeTimeout=-1,e.view.requestMeasure();}),50));}},{key:"onPrint",value:function(){var e=this;this.view.viewState.printing=!0,this.view.measure(),setTimeout((function(){e.view.viewState.printing=!1,e.view.requestMeasure();}),500);}},{key:"updateGaps",value:function(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((function(t,n){return t!=e[n]})))){this.gapIntersection.disconnect();var t,n=wi(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.gapIntersection.observe(r);}}catch(e){n.e(e);}finally{n.f();}this.gaps=e;}}},{key:"onSelectionChange",value:function(e){var t=this.selectionChanged;if(this.readSelectionRange()&&!this.delayedAndroidKey){var n=this.view,r=this.selectionRange;if(n.state.facet(aF)?n.root.activeElement==this.dom:Lz(n.dom,r)){var i=r.anchorNode&&n.docView.nearest(r.anchorNode);i&&i.ignoreEvent(e)?t||(this.selectionChanged=!1):(yq.ie&&yq.ie_version<=11||yq.android&&yq.chrome)&&!n.state.selection.main.empty&&r.focusNode&&zz(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1);}}}},{key:"readSelectionRange",value:function(){var e=this.view,t=yq.safari&&11==e.root.nodeType&&function(e){for(var t=e.activeElement;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e){var t=null;function n(e){e.preventDefault(),e.stopImmediatePropagation(),t=e.getTargetRanges()[0];}if(e.contentDOM.addEventListener("beforeinput",n,!0),e.dom.ownerDocument.execCommand("indent"),e.contentDOM.removeEventListener("beforeinput",n,!0),!t)return null;var r=t.startContainer,i=t.startOffset,o=t.endContainer,a=t.endOffset,s=e.docView.domAtPos(e.state.selection.main.anchor);if(zz(s.node,s.offset,o,a)){var c=[o,a,r,i];r=c[0],i=c[1],o=c[2],a=c[3];}return {anchorNode:r,anchorOffset:i,focusNode:o,focusOffset:a}}(this.view)||Iz(e.root);if(!t||this.selectionRange.eq(t))return !1;var n=Lz(this.dom,t);return n&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&function(e,t){var n=t.focusNode,r=t.focusOffset;if(!n||t.anchorNode!=n||t.anchorOffset!=r)return !1;for(;;)if(r){if(1!=n.nodeType)return !1;var i=n.childNodes[r-1];"false"==i.contentEditable?r--:r=Vz(n=i);}else {if(n==e)return !0;r=qz(n),n=n.parentNode;}}(this.dom,t)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(t),n&&(this.selectionChanged=!0),!0)}},{key:"setSelectionRange",value:function(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1;}},{key:"clearSelectionRange",value:function(){this.selectionRange.set(null,0,null,0);}},{key:"listenForScroll",value:function(){this.parentCheck=-1;for(var e=0,t=null,n=this.dom;n;)if(1==n.nodeType)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else {if(11!=n.nodeType)break;n=n.host;}if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){var r,i=wi(this.scrollTargets);try{for(i.s();!(r=i.n()).done;){r.value.removeEventListener("scroll",this.onScroll);}}catch(e){i.e(e);}finally{i.f();}var o,a=wi(this.scrollTargets=t);try{for(a.s();!(o=a.n()).done;){o.value.addEventListener("scroll",this.onScroll);}}catch(e){a.e(e);}finally{a.f();}}}},{key:"ignore",value:function(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear();}}},{key:"start",value:function(){this.active||(this.observer.observe(this.dom,bW),wW&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0);}},{key:"stop",value:function(){this.active&&(this.active=!1,this.observer.disconnect(),wW&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData));}},{key:"clear",value:function(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1;}},{key:"delayAndroidKey",value:function(e,t){var n,r=this;if(!this.delayedAndroidKey){this.flushingAndroidKey=this.view.win.requestAnimationFrame((function(){var e=r.delayedAndroidKey;e&&(r.clearDelayedAndroidKey(),!r.flush()&&e.force&&Yz(r.dom,e.key,e.keyCode));}));}this.delayedAndroidKey&&"Enter"!=e||(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(null===(n=this.delayedAndroidKey)||void 0===n?void 0:n.force)});}},{key:"clearDelayedAndroidKey",value:function(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1;}},{key:"flushSoon",value:function(){var e=this;this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame((function(){e.delayedFlush=-1,e.flush();})));}},{key:"forceFlush",value:function(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush();}},{key:"pendingRecords",value:function(){var e,t=wi(this.observer.takeRecords());try{for(t.s();!(e=t.n()).done;){var n=e.value;this.queue.push(n);}}catch(e){t.e(e);}finally{t.f();}return this.queue}},{key:"processRecords",value:function(){var e=this.pendingRecords();e.length&&(this.queue=[]);var t,n=-1,r=-1,i=!1,o=wi(e);try{for(o.s();!(t=o.n()).done;){var a=t.value,s=this.readMutation(a);s&&(s.typeOver&&(i=!0),-1==n?(n=s.from,r=s.to):(n=Math.min(s.from,n),r=Math.max(s.to,r)));}}catch(e){o.e(e);}finally{o.f();}return {from:n,to:r,typeOver:i}}},{key:"readChange",value:function(){var e=this.processRecords(),t=e.from,n=e.to,r=e.typeOver,i=this.selectionChanged&&Lz(this.dom,this.selectionRange);return t<0&&!i?null:(t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1,new gW(this.view,t,n,r))}},{key:"flush",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.delayedFlush>=0||this.delayedAndroidKey)return !1;e&&this.readSelectionRange();var t=this.readChange();if(!t)return !1;var n=this.view.state,r=yW(this.view,t);return this.view.state==n&&this.view.update([]),r}},{key:"readMutation",value:function(e){var t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty("attributes"==e.type),"attributes"==e.type&&(t.dirty|=4),"childList"==e.type){var n=kW(t,e.previousSibling||e.target.previousSibling,-1),r=kW(t,e.nextSibling||e.target.nextSibling,1);return {from:n?t.posAfter(n):t.posAtStart,to:r?t.posBefore(r):t.posAtEnd,typeOver:!1}}return "characterData"==e.type?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}},{key:"setWindow",value:function(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win));}},{key:"addWindowListeners",value:function(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange);}},{key:"removeWindowListeners",value:function(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange);}},{key:"destroy",value:function(){var e,t,n,r;this.stop(),null===(e=this.intersection)||void 0===e||e.disconnect(),null===(t=this.gapIntersection)||void 0===t||t.disconnect(),null===(n=this.resizeScroll)||void 0===n||n.disconnect(),null===(r=this.resizeContent)||void 0===r||r.disconnect();var i,o=wi(this.scrollTargets);try{for(o.s();!(i=o.n()).done;){i.value.removeEventListener("scroll",this.onScroll);}}catch(e){o.e(e);}finally{o.f();}this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey);}}]),e}();function kW(e,t,n){for(;t;){var r=nq.get(t);if(r&&r.parent==e)return r;var i=t.parentNode;t=i!=e.dom?i:n>0?t.nextSibling:t.previousSibling;}return null}var jW=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Bi(this,e),this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=n.dispatch||function(e){return t.update([e])},this.dispatch=this.dispatch.bind(this),this._root=n.root||Xz(n.parent)||document,this.viewState=new tW(n.state||tz.create(n)),this.plugins=this.state.facet(cF).map((function(e){return new lF(e)}));var r,i=wi(this.plugins);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.update(this);}}catch(e){i.e(e);}finally{i.f();}this.observer=new xW(this),this.inputState=new fV(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new FF(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),n.parent&&n.parent.appendChild(this.dom);}return qi(e,[{key:"state",get:function(){return this.viewState.state}},{key:"viewport",get:function(){return this.viewState.viewport}},{key:"visibleRanges",get:function(){return this.viewState.visibleRanges}},{key:"inView",get:function(){return this.viewState.inView}},{key:"composing",get:function(){return this.inputState.composing>0}},{key:"compositionStarted",get:function(){return this.inputState.composing>=0}},{key:"root",get:function(){return this._root}},{key:"win",get:function(){return this.dom.ownerDocument.defaultView||window}},{key:"dispatch",value:function(){var e;this._dispatch(1==arguments.length&&(arguments.length<=0?void 0:arguments[0])instanceof WB?arguments.length<=0?void 0:arguments[0]:(e=this.state).update.apply(e,arguments));}},{key:"update",value:function(e){var t=this;if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");var n,r,i=!1,o=!1,a=this.state,s=wi(e);try{for(s.s();!(r=s.n()).done;){var c=r.value;if(c.startState!=a)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");a=c.state;}}catch(e){s.e(e);}finally{s.f();}if(this.destroyed)this.viewState.state=a;else {var u=this.hasFocus,l=0,f=null;e.some((function(e){return e.annotation(RV)}))?(this.inputState.notifiedFocused=u,l=1):u!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=u,(f=NV(a,u))||(l=1));var h=this.observer.delayedAndroidKey,d=null;if(h?(this.observer.clearDelayedAndroidKey(),((d=this.observer.readChange())&&!this.state.doc.eq(a.doc)||!this.state.selection.eq(a.selection))&&(d=null)):this.observer.clear(),a.facet(tz.phrases)!=this.state.facet(tz.phrases))return this.setState(a);n=yF.create(this,a,e),n.flags|=l;var v=this.viewState.scrollTarget;try{this.updateState=2;var p,m=wi(e);try{for(m.s();!(p=m.n()).done;){var g=p.value;if(v&&(v=v.map(g.changes)),g.scrollIntoView){var y=g.state.selection.main;v=new rF(y.empty?y:fB.cursor(y.head,y.head>y.anchor?-1:1));}var b,w=wi(g.effects);try{for(w.s();!(b=w.n()).done;){var x=b.value;x.is(iF)&&(v=x.value);}}catch(e){w.e(e);}finally{w.f();}}}catch(e){m.e(e);}finally{m.f();}this.viewState.update(n,v),this.bidiCache=$W.update(this.bidiCache,n.changes),n.empty||(this.updatePlugins(n),this.inputState.update(n)),i=this.docView.update(n),this.state.facet(mF)!=this.styleModules&&this.mountStyles(),o=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(i,e.some((function(e){return e.isUserEvent("select.pointer")})));}finally{this.updateState=0;}if(n.startState.facet(uW)!=n.state.facet(uW)&&(this.viewState.mustMeasureContent=!0),(i||o||v||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!n.empty){var k,j=wi(this.state.facet(Xq));try{for(j.s();!(k=j.n()).done;){(0,k.value)(n);}}catch(e){j.e(e);}finally{j.f();}}(f||d)&&Promise.resolve().then((function(){f&&t.state==f.startState&&t.dispatch(f),d&&!yW(t,d)&&h.force&&Yz(t.contentDOM,h.key,h.keyCode);}));}}},{key:"setState",value:function(e){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)this.viewState.state=e;else {this.updateState=2;var t=this.hasFocus;try{var n,r=wi(this.plugins);try{for(r.s();!(n=r.n()).done;){n.value.destroy(this);}}catch(e){r.e(e);}finally{r.f();}this.viewState=new tW(e),this.plugins=e.facet(cF).map((function(e){return new lF(e)})),this.pluginMap.clear();var i,o=wi(this.plugins);try{for(o.s();!(i=o.n()).done;){i.value.update(this);}}catch(e){o.e(e);}finally{o.f();}this.docView=new FF(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[];}finally{this.updateState=0;}t&&this.focus(),this.requestMeasure();}}},{key:"updatePlugins",value:function(e){var t=e.startState.facet(cF),n=e.state.facet(cF);if(t!=n){var r,i=[],o=wi(n);try{for(o.s();!(r=o.n()).done;){var a=r.value,s=t.indexOf(a);if(s<0)i.push(new lF(a));else {var c=this.plugins[s];c.mustUpdate=e,i.push(c);}}}catch(e){o.e(e);}finally{o.f();}var u,l=wi(this.plugins);try{for(l.s();!(u=l.n()).done;){var f=u.value;f.mustUpdate!=e&&f.destroy(this);}}catch(e){l.e(e);}finally{l.f();}this.plugins=i,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins);}else {var h,d=wi(this.plugins);try{for(d.s();!(h=d.n()).done;){h.value.mustUpdate=e;}}catch(e){d.e(e);}finally{d.f();}}for(var v=0;v<this.plugins.length;v++)this.plugins[v].update(this);}},{key:"measure",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.destroyed){this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,t&&this.observer.forceFlush();var n=null,r=this.scrollDOM,i=r.scrollHeight,o=r.scrollTop,a=r.clientHeight,s=o>i-a-4?i:o;try{for(var c=0;;c++){this.updateState=1;var u=this.viewport,l=this.viewState.lineBlockAtHeight(s),f=this.viewState.measure(this);if(!f&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(c>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}var h=[];if(!(4&f)){var d=[h,this.measureRequests];this.measureRequests=d[0],h=d[1];}var v=h.map((function(t){try{return t.read(e)}catch(t){return oF(e.state,t),CW}})),p=yF.create(this,this.state,[]),m=!1,g=!1;p.flags|=f,n?n.flags|=f:n=p,this.updateState=2,p.empty||(this.updatePlugins(p),this.inputState.update(p),this.updateAttrs(),m=this.docView.update(p));for(var y=0;y<h.length;y++)if(v[y]!=CW)try{var b=h[y];b.write&&b.write(v[y],this);}catch(e){oF(this.state,e);}if(this.viewState.editorHeight)if(this.viewState.scrollTarget)this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,g=!0;else {var w=this.viewState.lineBlockAt(l.from).top-l.top;(w>1||w<-1)&&(this.scrollDOM.scrollTop+=w,g=!0);}if(m&&this.docView.updateSelection(!0),this.viewport.from==u.from&&this.viewport.to==u.to&&!g&&0==this.measureRequests.length)break}}finally{this.updateState=0,this.measureScheduled=-1;}if(n&&!n.empty){var x,k=wi(this.state.facet(Xq));try{for(k.s();!(x=k.n()).done;){var j=x.value;j(n);}}catch(e){k.e(e);}finally{k.f();}}}}},{key:"themeClasses",get:function(){return fW+" "+(this.state.facet(lW)?dW:hW)+" "+this.state.facet(uW)}},{key:"updateAttrs",value:function(){var e=this,t=_W(this,fF,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),n={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(aF)?"true":"false",class:"cm-content",style:"".concat(yq.tabSize,": ").concat(this.state.tabSize),role:"textbox","aria-multiline":"true"};this.state.readOnly&&(n["aria-readonly"]="true"),_W(this,hF,n);var r=this.observer.ignore((function(){var r=Rq(e.contentDOM,e.contentAttrs,n),i=Rq(e.dom,e.editorAttrs,t);return r||i}));return this.editorAttrs=t,this.contentAttrs=n,r}},{key:"showAnnouncements",value:function(t){var n,r=!0,i=wi(t);try{for(i.s();!(n=i.n()).done;){var o,a=wi(n.value.effects);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(s.is(e.announce))r&&(this.announceDOM.textContent=""),r=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=s.value;}}catch(e){a.e(e);}finally{a.f();}}}catch(e){i.e(e);}finally{i.f();}}},{key:"mountStyles",value:function(){this.styleModules=this.state.facet(mF),Cz.mount(this.root,this.styleModules.concat(mW).reverse());}},{key:"readMeasured",value:function(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1);}},{key:"requestMeasure",value:function(e){var t=this;if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame((function(){return t.measure()}))),e){if(this.measureRequests.indexOf(e)>-1)return;if(null!=e.key)for(var n=0;n<this.measureRequests.length;n++)if(this.measureRequests[n].key===e.key)return void(this.measureRequests[n]=e);this.measureRequests.push(e);}}},{key:"plugin",value:function(e){var t=this.pluginMap.get(e);return (void 0===t||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find((function(t){return t.spec==e}))||null),t&&t.update(this).value}},{key:"documentTop",get:function(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}},{key:"documentPadding",get:function(){return {top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}},{key:"elementAtHeight",value:function(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}},{key:"lineBlockAtHeight",value:function(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}},{key:"viewportLineBlocks",get:function(){return this.viewState.viewportLines}},{key:"lineBlockAt",value:function(e){return this.viewState.lineBlockAt(e)}},{key:"contentHeight",get:function(){return this.viewState.contentHeight}},{key:"moveByChar",value:function(e,t,n){return lV(this,e,uV(this,e,t,n))}},{key:"moveByGroup",value:function(e,t){var n=this;return lV(this,e,uV(this,e,t,(function(t){return function(e,t,n){var r=e.state.charCategorizer(t),i=r(n);return function(e){var t=r(e);return i==XB.Space&&(i=t),i==t}}(n,e.head,t)})))}},{key:"moveToLineBoundary",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return cV(this,e,t,n)}},{key:"moveVertically",value:function(e,t,n){return lV(this,e,function(e,t,n,r){var i=t.head,o=n?1:-1;if(i==(n?e.state.doc.length:0))return fB.cursor(i,t.assoc);var a,s=t.goalColumn,c=e.contentDOM.getBoundingClientRect(),u=e.coordsAtPos(i),l=e.documentTop;if(u)null==s&&(s=u.left-c.left),a=o<0?u.top:u.bottom;else {var f=e.viewState.lineBlockAt(i);null==s&&(s=Math.min(c.right-c.left,e.defaultCharacterWidth*(i-f.from))),a=(o<0?f.top:f.bottom)+l;}for(var h=c.left+s,d=null!=r?r:e.defaultLineHeight>>1,v=0;;v+=10){var p=a+(d+v)*o,m=iV(e,{x:h,y:p},!1,o);if(p<c.top||p>c.bottom||(o<0?m<i:m>i))return fB.cursor(m,t.assoc,void 0,s)}}(this,e,t,n))}},{key:"domAtPos",value:function(e){return this.docView.domAtPos(e)}},{key:"posAtDOM",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.docView.posFromDOM(e,t)}},{key:"posAtCoords",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.readMeasured(),iV(this,e,t)}},{key:"coordsAtPos",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.readMeasured();var n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;var r=this.state.doc.lineAt(e),i=this.bidiSpans(r),o=i[RF.find(i,e-r.from,-1,t)];return Wz(n,o.dir==bF.LTR==t>0)}},{key:"defaultCharacterWidth",get:function(){return this.viewState.heightOracle.charWidth}},{key:"defaultLineHeight",get:function(){return this.viewState.heightOracle.lineHeight}},{key:"textDirection",get:function(){return this.viewState.defaultTextDirection}},{key:"textDirectionAt",value:function(e){return !this.state.facet(tF)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}},{key:"lineWrapping",get:function(){return this.viewState.heightOracle.lineWrapping}},{key:"bidiSpans",value:function(e){if(e.length>SW)return IF(e.length);var t,n=this.textDirectionAt(e.from),r=wi(this.bidiCache);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.from==e.from&&i.dir==n)return i.order}}catch(e){r.e(e);}finally{r.f();}var o=function(e,t){var n=e.length,r=t==wF?1:2,i=t==wF?2:1;if(!e||1==r&&!TF.test(e))return IF(n);for(var o=0,a=r,s=r;o<n;o++){var c=PF(e.charCodeAt(o));512==c?c=a:8==c&&4==s&&(c=16),NF[o]=4==c?2:c,7&c&&(s=c),a=c;}for(var u=0,l=r,f=r;u<n;u++){var h=NF[u];if(128==h)u<n-1&&l==NF[u+1]&&24&l?h=NF[u]=l:NF[u]=256;else if(64==h){for(var d=u+1;d<n&&64==NF[d];)d++;for(var v=u&&8==l||d<n&&8==NF[d]?1==f?1:8:256,p=u;p<d;p++)NF[p]=v;u=d-1;}else 8==h&&1==f&&(NF[u]=1);l=h,7&h&&(f=h);}for(var m,g,y,b=0,w=0,x=0;b<n;b++)if(g=CF[m=e.charCodeAt(b)])if(g<0){for(var k=w-3;k>=0;k-=3)if($F[k+1]==-g){var j=$F[k+2],S=2&j?r:4&j?1&j?i:r:0;S&&(NF[b]=NF[$F[k]]=S),w=k;break}}else {if(189==$F.length)break;$F[w++]=b,$F[w++]=m,$F[w++]=x;}else if(2==(y=NF[b])||1==y){var C=y==r;x=C?0:1;for(var $=w-3;$>=0;$-=3){var _=$F[$+2];if(2&_)break;if(C)$F[$+2]|=2;else {if(4&_)break;$F[$+2]|=4;}}}for(var O=0;O<n;O++)if(256==NF[O]){for(var M=O+1;M<n&&256==NF[M];)M++;for(var E=1==(O?NF[O-1]:r),A=E==(1==(M<n?NF[M]:r))?E?1:2:r,P=O;P<M;P++)NF[P]=A;O=M-1;}var T=[];if(1==r)for(var R=0;R<n;){for(var N=R,I=1!=NF[R++];R<n&&I==(1!=NF[R]);)R++;if(I)for(var D=R;D>N;){for(var L=D,B=2!=NF[--D];D>N&&B==(2!=NF[D-1]);)D--;T.push(new RF(D,L,B?2:1));}else T.push(new RF(N,R,0));}else for(var z=0;z<n;){for(var q=z,F=2==NF[z++];z<n&&F==(2==NF[z]);)z++;T.push(new RF(q,z,F?1:2));}return T}(e.text,n);return this.bidiCache.push(new $W(e.from,e.to,n,o)),o}},{key:"hasFocus",get:function(){var e;return (this.dom.ownerDocument.hasFocus()||yq.safari&&(null===(e=this.inputState)||void 0===e?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}},{key:"focus",value:function(){var e=this;this.observer.ignore((function(){Gz(e.contentDOM),e.docView.updateSelection();}));}},{key:"setRoot",value:function(e){this._root!=e&&(this._root=e,this.observer.setWindow((9==e.nodeType?e:e.ownerDocument).defaultView||window),this.mountStyles());}},{key:"destroy",value:function(){var e,t=wi(this.plugins);try{for(t.s();!(e=t.n()).done;){e.value.destroy(this);}}catch(e){t.e(e);}finally{t.f();}this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0;}}],[{key:"scrollIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return iF.of(new rF("number"==typeof e?fB.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}},{key:"domEventHandlers",value:function(e){return uF.define((function(){return {}}),{eventHandlers:e})}},{key:"theme",value:function(e,t){var n=Cz.newName(),r=[uW.of(n),mF.of(pW(".".concat(n),e))];return t&&t.dark&&r.push(lW.of(!0)),r}},{key:"baseTheme",value:function(e){return $B.lowest(mF.of(pW("."+fW,e,vW)))}},{key:"findFromDOM",value:function(e){var t,n=e.querySelector(".cm-content"),r=n&&nq.get(n)||nq.get(e);return (null===(t=null==r?void 0:r.rootView)||void 0===t?void 0:t.view)||null}}]),e}();jW.styleModule=mF,jW.inputHandler=Zq,jW.focusChangeEffect=eF,jW.perLineTextDirection=tF,jW.exceptionSink=Yq,jW.updateListener=Xq,jW.editable=aF,jW.mouseSelectionStyle=Qq,jW.dragMovesSelection=Gq,jW.clickAddsSelectionRange=Kq,jW.decorations=dF,jW.atomicRanges=vF,jW.scrollMargins=pF,jW.darkTheme=lW,jW.contentAttributes=hF,jW.editorAttributes=fF,jW.lineWrapping=jW.contentAttributes.of({class:"cm-lineWrapping"}),jW.announce=VB.define();var SW=4096,CW={},$W=function(){function e(t,n,r,i){Bi(this,e),this.from=t,this.to=n,this.dir=r,this.order=i;}return qi(e,null,[{key:"update",value:function(t,n){if(n.empty)return t;for(var r=[],i=t.length?t[t.length-1].dir:bF.LTR,o=Math.max(0,t.length-10);o<t.length;o++){var a=t[o];a.dir!=i||n.touchesRange(a.from,a.to)||r.push(new e(n.mapPos(a.from,1),n.mapPos(a.to,-1),a.dir,a.order));}return r}}]),e}();function _W(e,t,n){for(var r=e.state.facet(t),i=r.length-1;i>=0;i--){var o=r[i],a="function"==typeof o?o(e):o;a&&Pq(a,n);}return n}var OW=yq.mac?"mac":yq.windows?"win":yq.linux?"linux":"key";function MW(e,t){var n,r,i,o,a=e.split(/-(?!$)/),s=a[a.length-1];"Space"==s&&(s=" ");for(var c=0;c<a.length-1;++c){var u=a[c];if(/^(cmd|meta|m)$/i.test(u))o=!0;else if(/^a(lt)?$/i.test(u))n=!0;else if(/^(c|ctrl|control)$/i.test(u))r=!0;else if(/^s(hift)?$/i.test(u))i=!0;else {if(!/^mod$/i.test(u))throw new Error("Unrecognized modifier name: "+u);"mac"==t?o=!0:r=!0;}}return n&&(s="Alt-"+s),r&&(s="Ctrl-"+s),o&&(s="Meta-"+s),i&&(s="Shift-"+s),s}function EW(e,t,n){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==n&&t.shiftKey&&(e="Shift-"+e),e}var AW=$B.default(jW.domEventHandlers({keydown:function(e,t){return IW(RW(t.state),e,t,"editor")}})),PW=vB.define({enables:AW}),TW=new WeakMap;function RW(e){var t=e.facet(PW),n=TW.get(t);return n||TW.set(t,n=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:OW,r=Object.create(null),i=Object.create(null),o=function(e,t){var n=i[e];if(null==n)i[e]=t;else if(n!=t)throw new Error("Key binding "+e+" is used both as a regular binding and as a multi-stroke prefix")},a=function(e,t,i,a){for(var s,c,u=r[e]||(r[e]=Object.create(null)),l=t.split(/ (?!$)/).map((function(e){return MW(e,n)})),f=function(){var t=l.slice(0,h).join(" ");o(t,!0),u[t]||(u[t]={preventDefault:!0,run:[function(n){var r=NW={view:n,prefix:t,scope:e};return setTimeout((function(){NW==r&&(NW=null);}),4e3),!0}]});},h=1;h<l.length;h++)f();var d=l.join(" ");o(d,!1);var v=u[d]||(u[d]={preventDefault:!1,run:(null===(c=null===(s=u._any)||void 0===s?void 0:s.run)||void 0===c?void 0:c.slice())||[]});i&&v.run.push(i),a&&(v.preventDefault=!0);},s=wi(e);try{for(s.s();!(t=s.n()).done;){var c=t.value,u=c.scope?c.scope.split(" "):["editor"];if(c.any){var l,f=wi(u);try{for(f.s();!(l=f.n()).done;){var h=l.value,d=r[h]||(r[h]=Object.create(null));for(var v in d._any||(d._any={preventDefault:!1,run:[]}),d)d[v].run.push(c.any);}}catch(e){f.e(e);}finally{f.f();}}var p=c[n]||c.key;if(p){var m,g=wi(u);try{for(g.s();!(m=g.n()).done;){var y=m.value;a(y,p,c.run,c.preventDefault),c.shift&&a(y,"Shift-"+p,c.shift,c.preventDefault);}}catch(e){g.e(e);}finally{g.f();}}}}catch(e){s.e(e);}finally{s.f();}return r}(t.reduce((function(e,t){return e.concat(t)}),[]))),n}var NW=null;function IW(e,t,n,r){var i=function(e){var t=!(Tz&&(e.ctrlKey||e.altKey||e.metaKey)||Pz&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?Mz:Oz)[e.keyCode]||e.key||"Unidentified";return "Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(t),o=ZL(YL(i,0))==i.length&&" "!=i,a="",s=!1;NW&&NW.view==n&&NW.scope==r&&(a=NW.prefix+" ",(s=vV.indexOf(t.keyCode)<0)&&(NW=null));var c,u,l=new Set,f=function(e){if(e){var r,i=wi(e.run);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(!l.has(o)&&(l.add(o),o(n,t)))return !0}}catch(e){i.e(e);}finally{i.f();}e.preventDefault&&(s=!0);}return !1},h=e[r];if(h){if(f(h[a+EW(i,t,!o)]))return !0;if(o&&(t.altKey||t.metaKey||t.ctrlKey)&&!(yq.windows&&t.ctrlKey&&t.altKey)&&(c=Oz[t.keyCode])&&c!=i){if(f(h[a+EW(c,t,!0)]))return !0;if(t.shiftKey&&(u=Mz[t.keyCode])!=i&&u!=c&&f(h[a+EW(u,t,!1)]))return !0}else if(o&&t.shiftKey&&f(h[a+EW(i,t,!0)]))return !0;if(f(h._any))return !0}return s}var DW=function(){function e(t,n,r,i,o){Bi(this,e),this.className=t,this.left=n,this.top=r,this.width=i,this.height=o;}return qi(e,[{key:"draw",value:function(){var e=document.createElement("div");return e.className=this.className,this.adjust(e),e}},{key:"update",value:function(e,t){return t.className==this.className&&(this.adjust(e),!0)}},{key:"adjust",value:function(e){e.style.left=this.left+"px",e.style.top=this.top+"px",null!=this.width&&(e.style.width=this.width+"px"),e.style.height=this.height+"px";}},{key:"eq",value:function(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}}],[{key:"forRange",value:function(t,n,r){if(r.empty){var i=t.coordsAtPos(r.head,r.assoc||1);if(!i)return [];var o=LW(t);return [new e(n,i.left-o.left,i.top-o.top,null,i.bottom-i.top)]}return qW(t,n,r)}}]),e}();function LW(e){var t=e.scrollDOM.getBoundingClientRect();return {left:(e.textDirection==bF.LTR?t.left:t.right-e.scrollDOM.clientWidth)-e.scrollDOM.scrollLeft,top:t.top-e.scrollDOM.scrollTop}}function BW(e,t,n){var r=fB.cursor(t);return {from:Math.max(n.from,e.moveToLineBoundary(r,!1,!0).from),to:Math.min(n.to,e.moveToLineBoundary(r,!0,!0).from),type:Iq.Text}}function zW(e,t){var n=e.lineBlockAt(t);if(Array.isArray(n.type)){var r,i=wi(n.type);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o.to>t||o.to==t&&(o.to==n.to||o.type==Iq.Text))return o}}catch(e){i.e(e);}finally{i.f();}}return n}function qW(e,t,n){if(n.to<=e.viewport.from||n.from>=e.viewport.to)return [];var r=Math.max(n.from,e.viewport.from),i=Math.min(n.to,e.viewport.to),o=e.textDirection==bF.LTR,a=e.contentDOM,s=a.getBoundingClientRect(),c=LW(e),u=a.querySelector(".cm-line"),l=u&&window.getComputedStyle(u),f=s.left+(l?parseInt(l.paddingLeft)+Math.min(0,parseInt(l.textIndent)):0),h=s.right-(l?parseInt(l.paddingRight):0),d=zW(e,r),v=zW(e,i),p=d.type==Iq.Text?d:null,m=v.type==Iq.Text?v:null;if(e.lineWrapping&&(p&&(p=BW(e,r,p)),m&&(m=BW(e,i,m))),p&&m&&p.from==m.from)return x(k(n.from,n.to,p));var g=p?k(n.from,null,p):j(d,!1),y=m?k(null,n.to,m):j(v,!0),b=[];return (p||d).to<(m||v).from-1?b.push(w(f,g.bottom,h,y.top)):g.bottom<y.top&&e.elementAtHeight((g.bottom+y.top)/2).type==Iq.Text&&(g.bottom=y.top=(g.bottom+y.top)/2),x(g).concat(b).concat(x(y));function w(e,n,r,i){return new DW(t,e-c.left,n-c.top-.01,r-e,i-n+.01)}function x(e){for(var t=e.top,n=e.bottom,r=e.horizontal,i=[],o=0;o<r.length;o+=2)i.push(w(r[o],t,r[o+1],n));return i}function k(t,n,r){var i=1e9,a=-1e9,s=[];function c(t,n,c,u,l){var d=e.coordsAtPos(t,t==r.to?-2:2),v=e.coordsAtPos(c,c==r.from?2:-2);d&&v&&(i=Math.min(d.top,v.top,i),a=Math.max(d.bottom,v.bottom,a),l==bF.LTR?s.push(o&&n?f:d.left,o&&u?h:v.right):s.push(!o&&u?f:v.left,!o&&n?h:d.right));}var u,l=null!=t?t:r.from,d=null!=n?n:r.to,v=wi(e.visibleRanges);try{for(v.s();!(u=v.n()).done;){var p=u.value;if(p.to>l&&p.from<d)for(var m=Math.max(p.from,l),g=Math.min(p.to,d);;){var y,b=e.state.doc.lineAt(m),w=wi(e.bidiSpans(b));try{for(w.s();!(y=w.n()).done;){var x=y.value,k=x.from+b.from,j=x.to+b.from;if(k>=g)break;j>m&&c(Math.max(k,m),null==t&&k<=l,Math.min(j,g),null==n&&j>=d,x.dir);}}catch(e){w.e(e);}finally{w.f();}if((m=b.to+1)>=g)break}}}catch(e){v.e(e);}finally{v.f();}return 0==s.length&&c(l,null==t,d,null==n,e.textDirection),{top:i,bottom:a,horizontal:s}}function j(e,t){var n=s.top+(t?e.top:e.bottom);return {top:n,bottom:n,horizontal:[]}}}var FW=function(){function e(t,n){Bi(this,e),this.view=t,this.layer=n,this.drawn=[],this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=t.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),n.above&&this.dom.classList.add("cm-layer-above"),n.class&&this.dom.classList.add(n.class),this.dom.setAttribute("aria-hidden","true"),this.setOrder(t.state),t.requestMeasure(this.measureReq),n.mount&&n.mount(this.dom,t);}return qi(e,[{key:"update",value:function(e){e.startState.facet(VW)!=e.state.facet(VW)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&e.view.requestMeasure(this.measureReq);}},{key:"setOrder",value:function(e){for(var t=0,n=e.facet(VW);t<n.length&&n[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t);}},{key:"measure",value:function(){return this.layer.markers(this.view)}},{key:"draw",value:function(e){var t=this;if(e.length!=this.drawn.length||e.some((function(e,n){return !function(e,t){return e.constructor==t.constructor&&e.eq(t)}(e,t.drawn[n])}))){var n,r=this.dom.firstChild,i=0,o=wi(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;a.update&&r&&a.constructor&&this.drawn[i].constructor&&a.update(r,this.drawn[i])?(r=r.nextSibling,i++):this.dom.insertBefore(a.draw(),r);}}catch(e){o.e(e);}finally{o.f();}for(;r;){var s=r.nextSibling;r.remove(),r=s;}this.drawn=e;}}},{key:"destroy",value:function(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove();}}]),e}(),VW=vB.define();function WW(e){return [uF.define((function(t){return new FW(t,e)})),VW.of(e)]}var HW=!yq.ios,UW=vB.define({combine:function(e){return nz(e,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:function(e,t){return Math.min(e,t)},drawRangeCursor:function(e,t){return e||t}})}});function JW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return [UW.of(e),GW,YW,ZW,nF.of(!0)]}function KW(e){return e.startState.facet(UW)!=e.state.facet(UW)}var GW=WW({above:!0,markers:function(e){var t,n=e.state,r=n.facet(UW),i=[],o=wi(n.selection.ranges);try{for(o.s();!(t=o.n()).done;){var a=t.value,s=a==n.selection.main;if(a.empty?!s||HW:r.drawRangeCursor){var c,u=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",l=a.empty?a:fB.cursor(a.head,a.head>a.anchor?-1:1),f=wi(DW.forRange(e,u,l));try{for(f.s();!(c=f.n()).done;){var h=c.value;i.push(h);}}catch(e){f.e(e);}finally{f.f();}}}}catch(e){o.e(e);}finally{o.f();}return i},update:function(e,t){e.transactions.some((function(e){return e.selection}))&&(t.style.animationName="cm-blink"==t.style.animationName?"cm-blink2":"cm-blink");var n=KW(e);return n&&QW(e.state,t),e.docChanged||e.selectionSet||n},mount:function(e,t){QW(t.state,e);},class:"cm-cursorLayer"});function QW(e,t){t.style.animationDuration=e.facet(UW).cursorBlinkRate+"ms";}var YW=WW({above:!1,markers:function(e){return e.state.selection.ranges.map((function(t){return t.empty?[]:DW.forRange(e,"cm-selectionBackground",t)})).reduce((function(e,t){return e.concat(t)}))},update:function(e,t){return e.docChanged||e.selectionSet||e.viewportChanged||KW(e)},class:"cm-selectionLayer"}),XW={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};HW&&(XW[".cm-line"].caretColor="transparent !important");var ZW=$B.highest(jW.theme(XW)),eH=VB.define({map:function(e,t){return null==e?null:t.mapPos(e)}}),tH=wB.define({create:function(){return null},update:function(e,t){return null!=e&&(e=t.changes.mapPos(e)),t.effects.reduce((function(e,t){return t.is(eH)?t.value:e}),e)}}),nH=uF.fromClass(function(){function e(t){Bi(this,e),this.view=t,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)};}return qi(e,[{key:"update",value:function(e){var t,n=e.state.field(tH);null==n?null!=this.cursor&&(null===(t=this.cursor)||void 0===t||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(e.startState.field(tH)!=n||e.docChanged||e.geometryChanged)&&this.view.requestMeasure(this.measureReq));}},{key:"readPos",value:function(){var e=this.view.state.field(tH),t=null!=e&&this.view.coordsAtPos(e);if(!t)return null;var n=this.view.scrollDOM.getBoundingClientRect();return {left:t.left-n.left+this.view.scrollDOM.scrollLeft,top:t.top-n.top+this.view.scrollDOM.scrollTop,height:t.bottom-t.top}}},{key:"drawCursor",value:function(e){this.cursor&&(e?(this.cursor.style.left=e.left+"px",this.cursor.style.top=e.top+"px",this.cursor.style.height=e.height+"px"):this.cursor.style.left="-100000px");}},{key:"destroy",value:function(){this.cursor&&this.cursor.remove();}},{key:"setDropPos",value:function(e){this.view.state.field(tH)!=e&&this.view.dispatch({effects:eH.of(e)});}}]),e}(),{eventHandlers:{dragover:function(e){this.setDropPos(this.view.posAtCoords({x:e.clientX,y:e.clientY}));},dragleave:function(e){e.target!=this.view.contentDOM&&this.view.contentDOM.contains(e.relatedTarget)||this.setDropPos(null);},dragend:function(){this.setDropPos(null);},drop:function(){this.setDropPos(null);}}});function rH(e,t,n,r,i){t.lastIndex=0;for(var o,a=e.iterRange(n,r),s=n;!a.next().done;s+=a.value.length)if(!a.lineBreak)for(;o=t.exec(a.value);)i(s+o.index,o);}var iH=function(){function e(t){Bi(this,e);var n=t.regexp,r=t.decoration,i=t.decorate,o=t.boundary,a=t.maxLength,s=void 0===a?1e3:a;if(!n.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=n,i)this.addMatch=function(e,t,n,r){return i(r,n,n+e[0].length,e,t)};else if("function"==typeof r)this.addMatch=function(e,t,n,i){var o=r(e,t,n);o&&i(n,n+e[0].length,o);};else {if(!r)throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.addMatch=function(e,t,n,i){return i(n,n+e[0].length,r)};}this.boundary=o,this.maxLength=s;}return qi(e,[{key:"createDeco",value:function(e){var t,n=this,r=new uz,i=r.add.bind(r),o=wi(function(e,t){var n=e.visibleRanges;if(1==n.length&&n[0].from==e.viewport.from&&n[0].to==e.viewport.to)return n;var r,i=[],o=wi(n);try{for(o.s();!(r=o.n()).done;){var a=r.value,s=a.from,c=a.to;s=Math.max(e.state.doc.lineAt(s).from,s-t),c=Math.min(e.state.doc.lineAt(c).to,c+t),i.length&&i[i.length-1].to>=s?i[i.length-1].to=c:i.push({from:s,to:c});}}catch(e){o.e(e);}finally{o.f();}return i}(e,this.maxLength));try{for(o.s();!(t=o.n()).done;){var a=t.value,s=a.from,c=a.to;rH(e.state.doc,this.regexp,s,c,(function(t,r){return n.addMatch(r,e,t,i)}));}}catch(e){o.e(e);}finally{o.f();}return r.finish()}},{key:"updateDeco",value:function(e,t){var n=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((function(t,i,o,a){a>e.view.viewport.from&&o<e.view.viewport.to&&(n=Math.min(o,n),r=Math.max(a,r));})),e.viewportChanged||r-n>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,t.map(e.changes),n,r):t}},{key:"updateRange",value:function(e,t,n,r){var i,o=this,a=wi(e.visibleRanges);try{var s=function(){var a=i.value,s=Math.max(a.from,n),c=Math.min(a.to,r);if(c>s){var u=e.state.doc.lineAt(s),l=u.to<c?e.state.doc.lineAt(c):u,f=Math.max(a.from,u.from),h=Math.min(a.to,l.to);if(o.boundary){for(;s>u.from;s--)if(o.boundary.test(u.text[s-1-u.from])){f=s;break}for(;c<l.to;c++)if(o.boundary.test(l.text[c-l.from])){h=c;break}}var d,v=[],p=function(e,t,n){return v.push(n.range(e,t))};if(u==l)for(o.regexp.lastIndex=f-u.from;(d=o.regexp.exec(u.text))&&d.index<h-u.from;)o.addMatch(d,e,d.index+u.from,p);else rH(e.state.doc,o.regexp,f,h,(function(t,n){return o.addMatch(n,e,t,p)}));t=t.update({filterFrom:f,filterTo:h,filter:function(e,t){return e<f||t>h},add:v});}};for(a.s();!(i=a.n()).done;)s();}catch(e){a.e(e);}finally{a.f();}return t}}]),e}(),oH=null!=/x/.unicode?"gu":"g",aH=new RegExp("[\0-\b\n--\u2028\u2029\ufeff-]",oH),sH={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},cH=null;var uH=vB.define({combine:function(e){var t=nz(e,{render:null,specialChars:aH,addSpecialChars:null});return (t.replaceTabs=!function(){var e;if(null==cH&&"undefined"!=typeof document&&document.body){var t=document.body.style;cH=null!=(null!==(e=t.tabSize)&&void 0!==e?e:t.MozTabSize);}return cH||!1}())&&(t.specialChars=new RegExp("\t|"+t.specialChars.source,oH)),t.addSpecialChars&&(t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,oH)),t}});function lH(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return [uH.of(e),hH()]}var fH=null;function hH(){return fH||(fH=uF.fromClass(function(){function e(t){Bi(this,e),this.view=t,this.decorations=Dq.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(t.state.facet(uH)),this.decorations=this.decorator.createDeco(t);}return qi(e,[{key:"makeDecorator",value:function(e){var t=this;return new iH({regexp:e.specialChars,decoration:function(n,r,i){var o=r.state.doc,a=YL(n[0],0);if(9==a){var s=o.lineAt(i),c=r.state.tabSize,u=wz(s.text,c,i-s.from);return Dq.replace({widget:new vH((c-u%c)*t.view.defaultCharacterWidth)})}return t.decorationCache[a]||(t.decorationCache[a]=Dq.replace({widget:new dH(e,a)}))},boundary:e.replaceTabs?void 0:/[^]/})}},{key:"update",value:function(e){var t=e.state.facet(uH);e.startState.facet(uH)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(e.view)):this.decorations=this.decorator.updateDeco(e,this.decorations);}}]),e}(),{decorations:function(e){return e.decorations}}))}var dH=function(e){Pi(n,Nq);var t=Ri(n);function n(e,r){var i;return Bi(this,n),(i=t.call(this)).options=e,i.code=r,i}return qi(n,[{key:"eq",value:function(e){return e.code==this.code}},{key:"toDOM",value:function(e){var t=function(e){return e>=32?"":10==e?"":String.fromCharCode(9216+e)}(this.code),n=e.state.phrase("Control character")+" "+(sH[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,n,t);if(r)return r;var i=document.createElement("span");return i.textContent=t,i.title=n,i.setAttribute("aria-label",n),i.className="cm-specialChar",i}},{key:"ignoreEvent",value:function(){return !1}}]),n}(),vH=function(e){Pi(n,Nq);var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this)).width=e,r}return qi(n,[{key:"eq",value:function(e){return e.width==this.width}},{key:"toDOM",value:function(){var e=document.createElement("span");return e.textContent="\t",e.className="cm-tab",e.style.width=this.width+"px",e}},{key:"ignoreEvent",value:function(){return !1}}]),n}();var pH=Dq.line({class:"cm-activeLine"}),mH=uF.fromClass(function(){function e(t){Bi(this,e),this.decorations=this.getDeco(t);}return qi(e,[{key:"update",value:function(e){(e.docChanged||e.selectionSet)&&(this.decorations=this.getDeco(e.view));}},{key:"getDeco",value:function(e){var t,n=-1,r=[],i=wi(e.state.selection.ranges);try{for(i.s();!(t=i.n()).done;){var o=t.value,a=e.lineBlockAt(o.head);a.from>n&&(r.push(pH.range(a.from)),n=a.from);}}catch(e){i.e(e);}finally{i.f();}return Dq.set(r)}}]),e}(),{decorations:function(e){return e.decorations}});function gH(e,t){var n=e.posAtCoords({x:t.clientX,y:t.clientY},!1),r=e.state.doc.lineAt(n),i=n-r.from,o=i>2e3?-1:i==r.length?function(e,t){var n=e.coordsAtPos(e.viewport.from);return n?Math.round(Math.abs((n.left-t)/e.defaultCharacterWidth)):-1}(e,t.clientX):wz(r.text,e.state.tabSize,n-r.from);return {line:r.number,col:o,off:i}}function yH(e,t){var n=gH(e,t),r=e.state.selection;return n?{update:function(e){if(e.docChanged){var t=e.changes.mapPos(e.startState.doc.line(n.line).from),i=e.state.doc.lineAt(t);n={line:i.number,col:n.col,off:Math.min(n.off,i.length)},r=r.map(e.changes);}},get:function(t,i,o){var a=gH(e,t);if(!a)return r;var s=function(e,t,n){var r=Math.min(t.line,n.line),i=Math.max(t.line,n.line),o=[];if(t.off>2e3||n.off>2e3||t.col<0||n.col<0)for(var a=Math.min(t.off,n.off),s=Math.max(t.off,n.off),c=r;c<=i;c++){var u=e.doc.line(c);u.length<=s&&o.push(fB.range(u.from+a,u.to+s));}else for(var l=Math.min(t.col,n.col),f=Math.max(t.col,n.col),h=r;h<=i;h++){var d=e.doc.line(h),v=xz(d.text,l,e.tabSize,!0);if(v<0)o.push(fB.cursor(d.to));else {var p=xz(d.text,f,e.tabSize);o.push(fB.range(d.from+v,d.from+p));}}return o}(e.state,n,a);return s.length?o?fB.create(s.concat(r.ranges)):fB.create(s):r}}:null}function bH(e){var t=(null==e?void 0:e.eventFilter)||function(e){return e.altKey&&0==e.button};return jW.mouseSelectionStyle.of((function(e,n){return t(n)?yH(e,n):null}))}var wH={Alt:[18,function(e){return e.altKey}],Control:[17,function(e){return e.ctrlKey}],Shift:[16,function(e){return e.shiftKey}],Meta:[91,function(e){return e.metaKey}]},xH={style:"cursor: crosshair"};function kH(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Si(wH[e.key||"Alt"],2),n=t[0],r=t[1],i=uF.fromClass(function(){function e(t){Bi(this,e),this.view=t,this.isDown=!1;}return qi(e,[{key:"set",value:function(e){this.isDown!=e&&(this.isDown=e,this.view.update([]));}}]),e}(),{eventHandlers:{keydown:function(e){this.set(e.keyCode==n||r(e));},keyup:function(e){e.keyCode!=n&&r(e)||this.set(!1);},mousemove:function(e){this.set(r(e));}}});return [i,jW.contentAttributes.of((function(e){var t;return (null===(t=e.plugin(i))||void 0===t?void 0:t.isDown)?xH:null}))]}var jH=function(){function e(t,n,r){Bi(this,e),this.facet=n,this.createTooltipView=r,this.input=t.state.facet(n),this.tooltips=this.input.filter((function(e){return e})),this.tooltipViews=this.tooltips.map(r);}return qi(e,[{key:"update",value:function(e){var t,n=e.state.facet(this.facet),r=n.filter((function(e){return e}));if(n===this.input){var i,o=wi(this.tooltipViews);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.update&&a.update(e);}}catch(e){o.e(e);}finally{o.f();}return !1}for(var s=[],c=0;c<r.length;c++){var u=r[c],l=-1;if(u){for(var f=0;f<this.tooltips.length;f++){var h=this.tooltips[f];h&&h.create==u.create&&(l=f);}if(l<0)s[c]=this.createTooltipView(u);else {var d=s[c]=this.tooltipViews[l];d.update&&d.update(e);}}}var v,p=wi(this.tooltipViews);try{for(p.s();!(v=p.n()).done;){var m=v.value;s.indexOf(m)<0&&(m.dom.remove(),null===(t=m.destroy)||void 0===t||t.call(m));}}catch(e){p.e(e);}finally{p.f();}return this.input=n,this.tooltips=r,this.tooltipViews=s,!0}}]),e}();function SH(e){var t=e.win;return {top:0,left:0,bottom:t.innerHeight,right:t.innerWidth}}var CH=vB.define({combine:function(e){var t,n,r;return {position:yq.ios?"absolute":(null===(t=e.find((function(e){return e.position})))||void 0===t?void 0:t.position)||"fixed",parent:(null===(n=e.find((function(e){return e.parent})))||void 0===n?void 0:n.parent)||null,tooltipSpace:(null===(r=e.find((function(e){return e.tooltipSpace})))||void 0===r?void 0:r.tooltipSpace)||SH}}}),$H=new WeakMap,_H=uF.fromClass(function(){function e(t){var n=this;Bi(this,e),this.view=t,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;var r=t.state.facet(CH);this.position=r.position,this.parent=r.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new jH(t,EH,(function(e){return n.createTooltip(e)})),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver((function(e){Date.now()>n.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&n.measureSoon();}),{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure();}return qi(e,[{key:"createContainer",value:function(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom;}},{key:"observeIntersection",value:function(){if(this.intersectionObserver){this.intersectionObserver.disconnect();var e,t=wi(this.manager.tooltipViews);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.intersectionObserver.observe(n.dom);}}catch(e){t.e(e);}finally{t.f();}}}},{key:"measureSoon",value:function(){var e=this;this.measureTimeout<0&&(this.measureTimeout=setTimeout((function(){e.measureTimeout=-1,e.maybeMeasure();}),50));}},{key:"update",value:function(e){e.transactions.length&&(this.lastTransaction=Date.now());var t=this.manager.update(e);t&&this.observeIntersection();var n=t||e.geometryChanged,r=e.state.facet(CH);if(r.position!=this.position){this.position=r.position;var i,o=wi(this.manager.tooltipViews);try{for(o.s();!(i=o.n()).done;){i.value.dom.style.position=this.position;}}catch(e){o.e(e);}finally{o.f();}n=!0;}if(r.parent!=this.parent){this.parent&&this.container.remove(),this.parent=r.parent,this.createContainer();var a,s=wi(this.manager.tooltipViews);try{for(s.s();!(a=s.n()).done;){var c=a.value;this.container.appendChild(c.dom);}}catch(e){s.e(e);}finally{s.f();}n=!0;}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);n&&this.maybeMeasure();}},{key:"createTooltip",value:function(e){var t=e.create(this.view);if(t.dom.classList.add("cm-tooltip"),e.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){var n=document.createElement("div");n.className="cm-tooltip-arrow",t.dom.appendChild(n);}return t.dom.style.position=this.position,t.dom.style.top="-10000px",this.container.appendChild(t.dom),t.mount&&t.mount(this.view),t}},{key:"destroy",value:function(){var e,t;this.view.win.removeEventListener("resize",this.measureSoon);var n,r=wi(this.manager.tooltipViews);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.dom.remove(),null===(e=i.destroy)||void 0===e||e.call(i);}}catch(e){r.e(e);}finally{r.f();}null===(t=this.intersectionObserver)||void 0===t||t.disconnect(),clearTimeout(this.measureTimeout);}},{key:"readMeasure",value:function(){var e=this,t=this.view.dom.getBoundingClientRect();return {editor:t,parent:this.parent?this.container.getBoundingClientRect():t,pos:this.manager.tooltips.map((function(t,n){var r=e.manager.tooltipViews[n];return r.getCoords?r.getCoords(t.pos):e.view.coordsAtPos(t.pos)})),size:this.manager.tooltipViews.map((function(e){return e.dom.getBoundingClientRect()})),space:this.view.state.facet(CH).tooltipSpace(this.view)}}},{key:"writeMeasure",value:function(e){for(var t,n=e.editor,r=e.space,i=[],o=0;o<this.manager.tooltips.length;o++){var a=this.manager.tooltips[o],s=this.manager.tooltipViews[o],c=s.dom,u=e.pos[o],l=e.size[o];if(!u||u.bottom<=Math.max(n.top,r.top)||u.top>=Math.min(n.bottom,r.bottom)||u.right<Math.max(n.left,r.left)-.1||u.left>Math.min(n.right,r.right)+.1)c.style.top="-10000px";else {var f=a.arrow?s.dom.querySelector(".cm-tooltip-arrow"):null,h=f?7:0,d=l.right-l.left,v=null!==(t=$H.get(s))&&void 0!==t?t:l.bottom-l.top,p=s.offset||MH,m=this.view.textDirection==bF.LTR,g=l.width>r.right-r.left?m?r.left:r.right-l.width:m?Math.min(u.left-(f?14:0)+p.x,r.right-d):Math.max(r.left,u.left-d+(f?14:0)-p.x),y=!!a.above;!a.strictSide&&(y?u.top-(l.bottom-l.top)-p.y<r.top:u.bottom+(l.bottom-l.top)+p.y>r.bottom)&&y==r.bottom-u.bottom>u.top-r.top&&(y=!y);var b=(y?u.top-r.top:r.bottom-u.bottom)-h;if(b<v&&!1!==s.resize){if(b<this.view.defaultLineHeight){c.style.top="-10000px";continue}$H.set(s,v),c.style.height=(v=b)+"px";}else c.style.height&&(c.style.height="");var w=y?u.top-v-h-p.y:u.bottom+h+p.y,x=g+d;if(!0!==s.overlap){var k,j=wi(i);try{for(j.s();!(k=j.n()).done;){var S=k.value;S.left<x&&S.right>g&&S.top<w+v&&S.bottom>w&&(w=y?S.top-v-2-h:S.bottom+h+2);}}catch(e){j.e(e);}finally{j.f();}}"absolute"==this.position?(c.style.top=w-e.parent.top+"px",c.style.left=g-e.parent.left+"px"):(c.style.top=w+"px",c.style.left=g+"px"),f&&(f.style.left="".concat(u.left+(m?p.x:-p.x)-(g+14-7),"px")),!0!==s.overlap&&i.push({left:g,top:w,right:x,bottom:w+v}),c.classList.toggle("cm-tooltip-above",y),c.classList.toggle("cm-tooltip-below",!y),s.positioned&&s.positioned(e.space);}}}},{key:"maybeMeasure",value:function(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView))){var e,t=wi(this.manager.tooltipViews);try{for(t.s();!(e=t.n()).done;){e.value.dom.style.top="-10000px";}}catch(e){t.e(e);}finally{t.f();}}}}]),e}(),{eventHandlers:{scroll:function(){this.maybeMeasure();}}}),OH=jW.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"".concat(7,"px"),width:"".concat(14,"px"),position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"".concat(7,"px solid transparent"),borderRight:"".concat(7,"px solid transparent")},".cm-tooltip-above &":{bottom:"-".concat(7,"px"),"&:before":{borderTop:"".concat(7,"px solid #bbb")},"&:after":{borderTop:"".concat(7,"px solid #f5f5f5"),bottom:"1px"}},".cm-tooltip-below &":{top:"-".concat(7,"px"),"&:before":{borderBottom:"".concat(7,"px solid #bbb")},"&:after":{borderBottom:"".concat(7,"px solid #f5f5f5"),top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),MH={x:0,y:0},EH=vB.define({enables:[_H,OH]}),AH=vB.define(),PH=function(){function e(t){var n=this;Bi(this,e),this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new jH(t,AH,(function(e){return n.createHostedView(e)}));}return qi(e,[{key:"createHostedView",value:function(e){var t=e.create(this.view);return t.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(t.dom),this.mounted&&t.mount&&t.mount(this.view),t}},{key:"mount",value:function(e){var t,n=wi(this.manager.tooltipViews);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.mount&&r.mount(e);}}catch(e){n.e(e);}finally{n.f();}this.mounted=!0;}},{key:"positioned",value:function(e){var t,n=wi(this.manager.tooltipViews);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.positioned&&r.positioned(e);}}catch(e){n.e(e);}finally{n.f();}}},{key:"update",value:function(e){this.manager.update(e);}},{key:"destroy",value:function(){var e,t,n=wi(this.manager.tooltipViews);try{for(n.s();!(t=n.n()).done;){var r=t.value;null===(e=r.destroy)||void 0===e||e.call(r);}}catch(e){n.e(e);}finally{n.f();}}}],[{key:"create",value:function(t){return new e(t)}}]),e}(),TH=EH.compute([AH],(function(e){var t=e.facet(AH).filter((function(e){return e}));return 0===t.length?null:{pos:Math.min.apply(Math,Vi(t.map((function(e){return e.pos})))),end:Math.max.apply(Math,Vi(t.filter((function(e){return null!=e.end})).map((function(e){return e.end})))),create:PH.create,above:t[0].above,arrow:t.some((function(e){return e.arrow}))}})),RH=function(){function e(t,n,r,i,o){Bi(this,e),this.view=t,this.source=n,this.field=r,this.setHover=i,this.hoverTime=o,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this));}return qi(e,[{key:"update",value:function(){var e=this;this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout((function(){return e.startHover()}),20));}},{key:"active",get:function(){return this.view.state.field(this.field)}},{key:"checkHover",value:function(){if(this.hoverTimeout=-1,!this.active){var e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover();}}},{key:"startHover",value:function(){var e=this;clearTimeout(this.restartTimeout);var t=this.lastMove,n=this.view.contentDOM.contains(t.target)?this.view.posAtCoords(t):null;if(null!=n){var r=this.view.coordsAtPos(n);if(!(null==r||t.y<r.top||t.y>r.bottom||t.x<r.left-this.view.defaultCharacterWidth||t.x>r.right+this.view.defaultCharacterWidth)){var i=this.view.bidiSpans(this.view.state.doc.lineAt(n)).find((function(e){return e.from<=n&&e.to>=n})),o=i&&i.dir==bF.RTL?-1:1,a=this.source(this.view,n,t.x<r.left?-o:o);if(null==a?void 0:a.then){var s=this.pending={pos:n};a.then((function(t){e.pending==s&&(e.pending=null,t&&e.view.dispatch({effects:e.setHover.of(t)}));}),(function(t){return oF(e.view.state,t,"hover tooltip")}));}else a&&this.view.dispatch({effects:this.setHover.of(a)});}}}},{key:"mousemove",value:function(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));var n=this.active;if(n&&!NH(this.lastMove.target)||this.pending){var r=(n||this.pending).pos,i=null!==(t=null==n?void 0:n.end)&&void 0!==t?t:r;(r==i?this.view.posAtCoords(this.lastMove)==r:function(e,t,n,r,i,o){var a=document.createRange(),s=e.domAtPos(t),c=e.domAtPos(n);a.setEnd(c.node,c.offset),a.setStart(s.node,s.offset);var u=a.getClientRects();a.detach();for(var l=0;l<u.length;l++){var f=u[l];if(Math.max(f.top-i,i-f.bottom,f.left-r,r-f.right)<=o)return !0}return !1}(this.view,r,i,e.clientX,e.clientY,6))||(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null);}}},{key:"mouseleave",value:function(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&!NH(e.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)});}},{key:"destroy",value:function(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove);}}]),e}();function NH(e){for(var t=e;t;t=t.parentNode)if(1==t.nodeType&&t.classList.contains("cm-tooltip"))return !0;return !1}function IH(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=VB.define(),r=wB.define({create:function(){return null},update:function(e,r){if(e&&(t.hideOnChange&&(r.docChanged||r.selection)||t.hideOn&&t.hideOn(r,e)))return null;if(e&&r.docChanged){var i=r.changes.mapPos(e.pos,-1,tB.TrackDel);if(null==i)return null;var o=Object.assign(Object.create(null),e);o.pos=i,null!=e.end&&(o.end=r.changes.mapPos(e.end)),e=o;}var a,s=wi(r.effects);try{for(s.s();!(a=s.n()).done;){var c=a.value;c.is(n)&&(e=c.value),c.is(LH)&&(e=null);}}catch(e){s.e(e);}finally{s.f();}return e},provide:function(e){return AH.from(e)}});return [r,uF.define((function(i){return new RH(i,e,r,n,t.hoverTime||300)})),TH]}function DH(e,t){var n=e.plugin(_H);if(!n)return null;var r=n.manager.tooltips.indexOf(t);return r<0?null:n.manager.tooltipViews[r]}var LH=VB.define(),BH=vB.define({combine:function(e){var t,n,r,i=wi(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;t=t||o.topContainer,n=n||o.bottomContainer;}}catch(e){i.e(e);}finally{i.f();}return {topContainer:t,bottomContainer:n}}});function zH(e,t){var n=e.plugin(qH),r=n?n.specs.indexOf(t):-1;return r>-1?n.panels[r]:null}var qH=uF.fromClass(function(){function e(t){Bi(this,e),this.input=t.state.facet(WH),this.specs=this.input.filter((function(e){return e})),this.panels=this.specs.map((function(e){return e(t)}));var n=t.state.facet(BH);this.top=new FH(t,!0,n.topContainer),this.bottom=new FH(t,!1,n.bottomContainer),this.top.sync(this.panels.filter((function(e){return e.top}))),this.bottom.sync(this.panels.filter((function(e){return !e.top})));var r,i=wi(this.panels);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.dom.classList.add("cm-panel"),o.mount&&o.mount();}}catch(e){i.e(e);}finally{i.f();}}return qi(e,[{key:"update",value:function(e){var t=e.state.facet(BH);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new FH(e.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new FH(e.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();var n=e.state.facet(WH);if(n!=this.input){var r,i=n.filter((function(e){return e})),o=[],a=[],s=[],c=[],u=wi(i);try{for(u.s();!(r=u.n()).done;){var l=r.value,f=this.specs.indexOf(l),h=void 0;f<0?(h=l(e.view),c.push(h)):(h=this.panels[f]).update&&h.update(e),o.push(h),(h.top?a:s).push(h);}}catch(e){u.e(e);}finally{u.f();}this.specs=i,this.panels=o,this.top.sync(a),this.bottom.sync(s);for(var d=0,v=c;d<v.length;d++){var p=v[d];p.dom.classList.add("cm-panel"),p.mount&&p.mount();}}else {var m,g=wi(this.panels);try{for(g.s();!(m=g.n()).done;){var y=m.value;y.update&&y.update(e);}}catch(e){g.e(e);}finally{g.f();}}}},{key:"destroy",value:function(){this.top.sync([]),this.bottom.sync([]);}}]),e}(),{provide:function(e){return jW.scrollMargins.of((function(t){var n=t.plugin(e);return n&&{top:n.top.scrollMargin(),bottom:n.bottom.scrollMargin()}}))}}),FH=function(){function e(t,n,r){Bi(this,e),this.view=t,this.top=n,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses();}return qi(e,[{key:"sync",value:function(e){var t,n=wi(this.panels);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.destroy&&e.indexOf(r)<0&&r.destroy();}}catch(e){n.e(e);}finally{n.f();}this.panels=e,this.syncDOM();}},{key:"syncDOM",value:function(){if(0!=this.panels.length){if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";var e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null);}var t,n=this.dom.firstChild,r=wi(this.panels);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.dom.parentNode==this.dom){for(;n!=i.dom;)n=VH(n);n=n.nextSibling;}else this.dom.insertBefore(i.dom,n);}}catch(e){r.e(e);}finally{r.f();}for(;n;)n=VH(n);}else this.dom&&(this.dom.remove(),this.dom=void 0);}},{key:"scrollMargin",value:function(){return !this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}},{key:"syncClasses",value:function(){if(this.container&&this.classes!=this.view.themeClasses){var e,t=wi(this.classes.split(" "));try{for(t.s();!(e=t.n()).done;){var n=e.value;n&&this.container.classList.remove(n);}}catch(e){t.e(e);}finally{t.f();}var r,i=wi((this.classes=this.view.themeClasses).split(" "));try{for(i.s();!(r=i.n()).done;){var o=r.value;o&&this.container.classList.add(o);}}catch(e){i.e(e);}finally{i.f();}}}}]),e}();function VH(e){var t=e.nextSibling;return e.remove(),t}var WH=vB.define({enables:qH}),HH=function(e){Pi(n,rz);var t=Ri(n);function n(){return Bi(this,n),t.apply(this,arguments)}return qi(n,[{key:"compare",value:function(e){return this==e||this.constructor==e.constructor&&this.eq(e)}},{key:"eq",value:function(e){return !1}},{key:"destroy",value:function(e){}}]),n}();HH.prototype.elementClass="",HH.prototype.toDOM=void 0,HH.prototype.mapMode=tB.TrackBefore,HH.prototype.startSide=HH.prototype.endSide=-1,HH.prototype.point=!0;var UH=vB.define(),JH={class:"",renderEmptyElements:!1,elementStyle:"",markers:function(){return sz.empty},lineMarker:function(){return null},widgetMarker:function(){return null},lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},KH=vB.define();function GH(e){return [YH(),KH.of(Object.assign(Object.assign({},JH),e))]}var QH=vB.define({combine:function(e){return e.some((function(e){return e}))}});function YH(e){var t=[XH];return e&&!1===e.fixed&&t.push(QH.of(!0)),t}var XH=uF.fromClass(function(){function e(t){Bi(this,e),this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=t.state.facet(KH).map((function(e){return new nU(t,e)}));var n,r=wi(this.gutters);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.dom.appendChild(i.dom);}}catch(e){r.e(e);}finally{r.f();}this.fixed=!t.state.facet(QH),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM);}return qi(e,[{key:"update",value:function(e){if(this.updateGutters(e)){var t=this.prevViewport,n=e.view.viewport,r=Math.min(t.to,n.to)-Math.max(t.from,n.from);this.syncGutters(r<.8*(n.to-n.from));}e.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(QH)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=e.view.viewport;}},{key:"syncGutters",value:function(e){var t=this,n=this.dom.nextSibling;e&&this.dom.remove();var r,i=sz.iter(this.view.state.facet(UH),this.view.viewport.from),o=[],a=this.gutters.map((function(e){return new tU(e,t.view.viewport,-t.view.documentPadding.top)})),s=wi(this.view.viewportLineBlocks);try{for(s.s();!(r=s.n()).done;){var c=r.value;if(o.length&&(o=[]),Array.isArray(c.type)){var u,l=!0,f=wi(c.type);try{for(f.s();!(u=f.n()).done;){var h=u.value;if(h.type==Iq.Text&&l){eU(i,o,h.from);var d,v=wi(a);try{for(v.s();!(d=v.n()).done;){d.value.line(this.view,h,o);}}catch(e){v.e(e);}finally{v.f();}l=!1;}else if(h.widget){var p,m=wi(a);try{for(m.s();!(p=m.n()).done;){p.value.widget(this.view,h);}}catch(e){m.e(e);}finally{m.f();}}}}catch(e){f.e(e);}finally{f.f();}}else if(c.type==Iq.Text){eU(i,o,c.from);var g,y=wi(a);try{for(y.s();!(g=y.n()).done;){g.value.line(this.view,c,o);}}catch(e){y.e(e);}finally{y.f();}}}}catch(e){s.e(e);}finally{s.f();}var b,w=wi(a);try{for(w.s();!(b=w.n()).done;){b.value.finish();}}catch(e){w.e(e);}finally{w.f();}e&&this.view.scrollDOM.insertBefore(this.dom,n);}},{key:"updateGutters",value:function(e){var t=e.startState.facet(KH),n=e.state.facet(KH),r=e.docChanged||e.heightChanged||e.viewportChanged||!sz.eq(e.startState.facet(UH),e.state.facet(UH),e.view.viewport.from,e.view.viewport.to);if(t==n){var i,o=wi(this.gutters);try{for(o.s();!(i=o.n()).done;){i.value.update(e)&&(r=!0);}}catch(e){o.e(e);}finally{o.f();}}else {r=!0;var a,s=[],c=wi(n);try{for(c.s();!(a=c.n()).done;){var u=a.value,l=t.indexOf(u);l<0?s.push(new nU(this.view,u)):(this.gutters[l].update(e),s.push(this.gutters[l]));}}catch(e){c.e(e);}finally{c.f();}var f,h=wi(this.gutters);try{for(h.s();!(f=h.n()).done;){var d=f.value;d.dom.remove(),s.indexOf(d)<0&&d.destroy();}}catch(e){h.e(e);}finally{h.f();}for(var v=0,p=s;v<p.length;v++){var m=p[v];this.dom.appendChild(m.dom);}this.gutters=s;}return r}},{key:"destroy",value:function(){var e,t=wi(this.gutters);try{for(t.s();!(e=t.n()).done;){e.value.destroy();}}catch(e){t.e(e);}finally{t.f();}this.dom.remove();}}]),e}(),{provide:function(e){return jW.scrollMargins.of((function(t){var n=t.plugin(e);return n&&0!=n.gutters.length&&n.fixed?t.textDirection==bF.LTR?{left:n.dom.offsetWidth}:{right:n.dom.offsetWidth}:null}))}});function ZH(e){return Array.isArray(e)?e:[e]}function eU(e,t,n){for(;e.value&&e.from<=n;)e.from==n&&t.push(e.value),e.next();}var tU=function(){function e(t,n,r){Bi(this,e),this.gutter=t,this.height=r,this.i=0,this.cursor=sz.iter(t.markers,n.from);}return qi(e,[{key:"addElement",value:function(e,t,n){var r=this.gutter,i=t.top-this.height;if(this.i==r.elements.length){var o=new rU(e,t.height,i,n);r.elements.push(o),r.dom.appendChild(o.dom);}else r.elements[this.i].update(e,t.height,i,n);this.height=t.bottom,this.i++;}},{key:"line",value:function(e,t,n){var r=[];eU(this.cursor,r,t.from),n.length&&(r=r.concat(n));var i=this.gutter.config.lineMarker(e,t,r);i&&r.unshift(i);var o=this.gutter;(0!=r.length||o.config.renderEmptyElements)&&this.addElement(e,t,r);}},{key:"widget",value:function(e,t){var n=this.gutter.config.widgetMarker(e,t.widget,t);n&&this.addElement(e,t,[n]);}},{key:"finish",value:function(){for(var e=this.gutter;e.elements.length>this.i;){var t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy();}}}]),e}(),nU=function(){function e(t,n){var r=this;Bi(this,e),this.view=t,this.config=n,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");var i=function(e){r.dom.addEventListener(e,(function(i){var o,a=i.target;if(a!=r.dom&&r.dom.contains(a)){for(;a.parentNode!=r.dom;)a=a.parentNode;var s=a.getBoundingClientRect();o=(s.top+s.bottom)/2;}else o=i.clientY;var c=t.lineBlockAtHeight(o-t.documentTop);n.domEventHandlers[e](t,c,i)&&i.preventDefault();}));};for(var o in n.domEventHandlers)i(o);this.markers=ZH(n.markers(t)),n.initialSpacer&&(this.spacer=new rU(t,0,0,[n.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none");}return qi(e,[{key:"update",value:function(e){var t=this.markers;if(this.markers=ZH(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){var n=this.config.updateSpacer(this.spacer.markers[0],e);n!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[n]);}var r=e.view.viewport;return !sz.eq(this.markers,t,r.from,r.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(e)}},{key:"destroy",value:function(){var e,t=wi(this.elements);try{for(t.s();!(e=t.n()).done;){e.value.destroy();}}catch(e){t.e(e);}finally{t.f();}}}]),e}(),rU=function(){function e(t,n,r,i){Bi(this,e),this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,n,r,i);}return qi(e,[{key:"update",value:function(e,t,n,r){this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),function(e,t){if(e.length!=t.length)return !1;for(var n=0;n<e.length;n++)if(!e[n].compare(t[n]))return !1;return !0}(this.markers,r)||this.setMarkers(e,r);}},{key:"setMarkers",value:function(e,t){for(var n="cm-gutterElement",r=this.dom.firstChild,i=0,o=0;;){var a=o,s=i<t.length?t[i++]:null,c=!1;if(s){var u=s.elementClass;u&&(n+=" "+u);for(var l=o;l<this.markers.length;l++)if(this.markers[l].compare(s)){a=l,c=!0;break}}else a=this.markers.length;for(;o<a;){var f=this.markers[o++];if(f.toDOM){f.destroy(r);var h=r.nextSibling;r.remove(),r=h;}}if(!s)break;s.toDOM&&(c?r=r.nextSibling:this.dom.insertBefore(s.toDOM(e),r)),c&&o++;}this.dom.className=n,this.markers=t;}},{key:"destroy",value:function(){this.setMarkers(null,[]);}}]),e}();var iU=vB.define(),oU=vB.define({combine:function(e){return nz(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers:function(e,t){var n=Object.assign({},e),r=function(){var e=n[i],r=t[i];n[i]=e?function(t,n,i){return e(t,n,i)||r(t,n,i)}:r;};for(var i in t)r();return n}})}}),aU=function(e){Pi(n,HH);var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this)).number=e,r}return qi(n,[{key:"eq",value:function(e){return this.number==e.number}},{key:"toDOM",value:function(){return document.createTextNode(this.number)}}]),n}();function sU(e,t){return e.state.facet(oU).formatNumber(t,e.state)}var cU=KH.compute([oU],(function(e){return {class:"cm-lineNumbers",renderEmptyElements:!1,markers:function(e){return e.state.facet(iU)},lineMarker:function(e,t,n){return n.some((function(e){return e.toDOM}))?null:new aU(sU(e,e.state.doc.lineAt(t.from).number))},widgetMarker:function(){return null},lineMarkerChange:function(e){return e.startState.facet(oU)!=e.state.facet(oU)},initialSpacer:function(e){return new aU(sU(e,lU(e.state.doc.lines)))},updateSpacer:function(e,t){var n=sU(t.view,lU(t.view.state.doc.lines));return n==e.number?e:new aU(n)},domEventHandlers:e.facet(oU).domEventHandlers}}));function uU(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return [oU.of(e),YH(),cU]}function lU(e){for(var t=9;t<e;)t=10*t+9;return t}var fU=new(function(e){Pi(n,HH);var t=Ri(n);function n(){var e;return Bi(this,n),(e=t.apply(this,arguments)).elementClass="cm-activeLineGutter",e}return qi(n)}()),hU=UH.compute(["selection"],(function(e){var t,n=[],r=-1,i=wi(e.selection.ranges);try{for(i.s();!(t=i.n()).done;){var o=t.value,a=e.doc.lineAt(o.head).from;a>r&&(r=a,n.push(fU.range(a)));}}catch(e){i.e(e);}finally{i.f();}return sz.of(n)}));var dU=0,vU=qi((function e(t,n){Bi(this,e),this.from=t,this.to=n;})),pU=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Bi(this,e),this.id=dU++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||function(){throw new Error("This node type doesn't define a deserialize function")};}return qi(e,[{key:"add",value:function(e){var t=this;if(this.perNode)throw new RangeError("Can't add per-node props to node types");return "function"!=typeof e&&(e=gU.match(e)),function(n){var r=e(n);return void 0===r?null:[t,r]}}}]),e}();pU.closedBy=new pU({deserialize:function(e){return e.split(" ")}}),pU.openedBy=new pU({deserialize:function(e){return e.split(" ")}}),pU.group=new pU({deserialize:function(e){return e.split(" ")}}),pU.contextHash=new pU({perNode:!0}),pU.lookAhead=new pU({perNode:!0}),pU.mounted=new pU({perNode:!0});var mU=Object.create(null),gU=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Bi(this,e),this.name=t,this.props=n,this.id=r,this.flags=i;}return qi(e,[{key:"prop",value:function(e){return this.props[e.id]}},{key:"isTop",get:function(){return (1&this.flags)>0}},{key:"isSkipped",get:function(){return (2&this.flags)>0}},{key:"isError",get:function(){return (4&this.flags)>0}},{key:"isAnonymous",get:function(){return (8&this.flags)>0}},{key:"is",value:function(e){if("string"==typeof e){if(this.name==e)return !0;var t=this.prop(pU.group);return !!t&&t.indexOf(e)>-1}return this.id==e}}],[{key:"define",value:function(t){var n=t.props&&t.props.length?Object.create(null):mU,r=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),i=new e(t.name||"",n,t.id,r);if(t.props){var o,a=wi(t.props);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");n[s[0].id]=s[1];}}}catch(e){a.e(e);}finally{a.f();}}return i}},{key:"match",value:function(e){var t=Object.create(null);for(var n in e){var r,i=wi(n.split(" "));try{for(i.s();!(r=i.n()).done;){var o=r.value;t[o]=e[n];}}catch(e){i.e(e);}finally{i.f();}}return function(e){for(var n=e.prop(pU.group),r=-1;r<(n?n.length:0);r++){var i=t[r<0?e.name:n[r]];if(i)return i}}}}]),e}();gU.none=new gU("",Object.create(null),0,8);var yU,bU=function(){function e(t){Bi(this,e),this.types=t;for(var n=0;n<t.length;n++)if(t[n].id!=n)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}return qi(e,[{key:"extend",value:function(){for(var t=[],n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o,a=wi(this.types);try{for(a.s();!(o=a.n()).done;){var s,c=o.value,u=null,l=wi(r);try{for(l.s();!(s=l.n()).done;){var f=s.value,h=f(c);h&&(u||(u=Object.assign({},c.props)),u[h[0].id]=h[1]);}}catch(e){l.e(e);}finally{l.f();}t.push(u?new gU(c.name,u,c.id,c.flags):c);}}catch(e){a.e(e);}finally{a.f();}return new e(t)}}]),e}(),wU=new WeakMap,xU=new WeakMap;!function(e){e[e.ExcludeBuffers=1]="ExcludeBuffers",e[e.IncludeAnonymous=2]="IncludeAnonymous",e[e.IgnoreMounts=4]="IgnoreMounts",e[e.IgnoreOverlays=8]="IgnoreOverlays";}(yU||(yU={}));var kU=function(){function e(t,n,r,i,o){if(Bi(this,e),this.type=t,this.children=n,this.positions=r,this.length=i,this.props=null,o&&o.length){this.props=Object.create(null);var a,s=wi(o);try{for(s.s();!(a=s.n()).done;){var c=Si(a.value,2),u=c[0],l=c[1];this.props["number"==typeof u?u:u.id]=l;}}catch(e){s.e(e);}finally{s.f();}}}return qi(e,[{key:"toString",value:function(){var e=this.prop(pU.mounted);if(e&&!e.overlay)return e.tree.toString();var t,n="",r=wi(this.children);try{for(r.s();!(t=r.n()).done;){var i=t.value.toString();i&&(n&&(n+=","),n+=i);}}catch(e){r.e(e);}finally{r.f();}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(n.length?"("+n+")":""):n}},{key:"cursor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new TU(this.topNode,e)}},{key:"cursorAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=wU.get(this)||this.topNode,r=new TU(n);return r.moveTo(e,t),wU.set(this,r._tree),r}},{key:"topNode",get:function(){return new OU(this,0,0,null)}},{key:"resolve",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=_U(wU.get(this)||this.topNode,e,t,!1);return wU.set(this,n),n}},{key:"resolveInner",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=_U(xU.get(this)||this.topNode,e,t,!0);return xU.set(this,n),n}},{key:"iterate",value:function(e){for(var t=e.enter,n=e.leave,r=e.from,i=void 0===r?0:r,o=e.to,a=void 0===o?this.length:o,s=this.cursor((e.mode||0)|yU.IncludeAnonymous);;){var c=!1;if(s.from<=a&&s.to>=i&&(s.type.isAnonymous||!1!==t(s))){if(s.firstChild())continue;c=!0;}for(;c&&n&&!s.type.isAnonymous&&n(s),!s.nextSibling();){if(!s.parent())return;c=!0;}}}},{key:"prop",value:function(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}},{key:"propValues",get:function(){var e=[];if(this.props)for(var t in this.props)e.push([+t,this.props[t]]);return e}},{key:"balance",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.children.length<=8?this:LU(gU.none,this.children,this.positions,0,this.children.length,0,this.length,(function(n,r,i){return new e(t.type,n,r,i,t.propValues)}),n.makeTree||function(t,n,r){return new e(gU.none,t,n,r)})}}],[{key:"build",value:function(e){return NU(e)}}]),e}();kU.empty=new kU(gU.none,[],[],0);var jU=function(){function e(t,n){Bi(this,e),this.buffer=t,this.index=n;}return qi(e,[{key:"id",get:function(){return this.buffer[this.index-4]}},{key:"start",get:function(){return this.buffer[this.index-3]}},{key:"end",get:function(){return this.buffer[this.index-2]}},{key:"size",get:function(){return this.buffer[this.index-1]}},{key:"pos",get:function(){return this.index}},{key:"next",value:function(){this.index-=4;}},{key:"fork",value:function(){return new e(this.buffer,this.index)}}]),e}(),SU=function(){function e(t,n,r){Bi(this,e),this.buffer=t,this.length=n,this.set=r;}return qi(e,[{key:"type",get:function(){return gU.none}},{key:"toString",value:function(){for(var e=[],t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}},{key:"childString",value:function(e){var t=this.buffer[e],n=this.buffer[e+3],r=this.set.types[t],i=r.name;if(/\W/.test(i)&&!r.isError&&(i=JSON.stringify(i)),n==(e+=4))return i;for(var o=[];e<n;)o.push(this.childString(e)),e=this.buffer[e+3];return i+"("+o.join(",")+")"}},{key:"findChild",value:function(e,t,n,r,i){for(var o=this.buffer,a=-1,s=e;s!=t&&!(CU(i,r,o[s+1],o[s+2])&&(a=s,n>0));s=o[s+3]);return a}},{key:"slice",value:function(t,n,r,i){for(var o=this.buffer,a=new Uint16Array(n-t),s=t,c=0;s<n;)a[c++]=o[s++],a[c++]=o[s++]-r,a[c++]=o[s++]-r,a[c++]=o[s++]-t;return new e(a,i-r,this.set)}}]),e}();function CU(e,t,n,r){switch(e){case-2:return n<t;case-1:return r>=t&&n<t;case 0:return n<t&&r>t;case 1:return n<=t&&r>t;case 2:return r>t;case 4:return !0}}function $U(e,t){for(var n=e.childBefore(t);n;){var r=n.lastChild;if(!r||r.to!=n.to)break;r.type.isError&&r.from==r.to?(e=n,n=r.prevSibling):n=r;}return e}function _U(e,t,n,r){for(var i;e.from==e.to||(n<1?e.from>=t:e.from>t)||(n>-1?e.to<=t:e.to<t);){var o=!r&&e instanceof OU&&e.index<0?null:e.parent;if(!o)return e;e=o;}var a=r?0:yU.IgnoreOverlays;if(r)for(var s=e,c=s.parent;c;c=(s=c).parent)s instanceof OU&&s.index<0&&(null===(i=c.enter(t,n,a))||void 0===i?void 0:i.from)!=s.from&&(e=c);for(;;){var u=e.enter(t,n,a);if(!u)return e;e=u;}}var OU=function(){function e(t,n,r,i){Bi(this,e),this._tree=t,this.from=n,this.index=r,this._parent=i;}return qi(e,[{key:"type",get:function(){return this._tree.type}},{key:"name",get:function(){return this._tree.type.name}},{key:"to",get:function(){return this.from+this._tree.length}},{key:"nextChild",value:function(t,n,r,i){for(var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=this;;){for(var s=a._tree,c=s.children,u=s.positions,l=n>0?c.length:-1;t!=l;t+=n){var f=c[t],h=u[t]+a.from;if(CU(i,r,h,h+f.length))if(f instanceof SU){if(o&yU.ExcludeBuffers)continue;var d=f.findChild(0,f.buffer.length,n,r-h,i);if(d>-1)return new PU(new AU(a,f,t,h),null,d)}else if(o&yU.IncludeAnonymous||!f.type.isAnonymous||RU(f)){var v=void 0;if(!(o&yU.IgnoreMounts)&&f.props&&(v=f.prop(pU.mounted))&&!v.overlay)return new e(v.tree,h,t,a);var p=new e(f,h,t,a);return o&yU.IncludeAnonymous||!p.type.isAnonymous?p:p.nextChild(n<0?f.children.length-1:0,n,r,i)}}if(o&yU.IncludeAnonymous||!a.type.isAnonymous)return null;if(t=a.index>=0?a.index+n:n<0?-1:a._parent._tree.children.length,!(a=a._parent))return null}}},{key:"firstChild",get:function(){return this.nextChild(0,1,0,4)}},{key:"lastChild",get:function(){return this.nextChild(this._tree.children.length-1,-1,0,4)}},{key:"childAfter",value:function(e){return this.nextChild(0,1,e,2)}},{key:"childBefore",value:function(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}},{key:"enter",value:function(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!(i&yU.IgnoreOverlays)&&(r=this._tree.prop(pU.mounted))&&r.overlay){var o,a=t-this.from,s=wi(r.overlay);try{for(s.s();!(o=s.n()).done;){var c=o.value,u=c.from,l=c.to;if((n>0?u<=a:u<a)&&(n<0?l>=a:l>a))return new e(r.tree,r.overlay[0].from+this.from,-1,this)}}catch(e){s.e(e);}finally{s.f();}}return this.nextChild(0,1,t,n,i)}},{key:"nextSignificantParent",value:function(){for(var e=this;e.type.isAnonymous&&e._parent;)e=e._parent;return e}},{key:"parent",get:function(){return this._parent?this._parent.nextSignificantParent():null}},{key:"nextSibling",get:function(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}},{key:"prevSibling",get:function(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}},{key:"cursor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new TU(this,e)}},{key:"tree",get:function(){return this._tree}},{key:"toTree",value:function(){return this._tree}},{key:"resolve",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return _U(this,e,t,!1)}},{key:"resolveInner",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return _U(this,e,t,!0)}},{key:"enterUnfinishedNodesBefore",value:function(e){return $U(this,e)}},{key:"getChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=MU(this,e,t,n);return r.length?r[0]:null}},{key:"getChildren",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return MU(this,e,t,n)}},{key:"toString",value:function(){return this._tree.toString()}},{key:"node",get:function(){return this}},{key:"matchContext",value:function(e){return EU(this,e)}}]),e}();function MU(e,t,n,r){var i=e.cursor(),o=[];if(!i.firstChild())return o;if(null!=n)for(;!i.type.is(n);)if(!i.nextSibling())return o;for(;;){if(null!=r&&i.type.is(r))return o;if(i.type.is(t)&&o.push(i.node),!i.nextSibling())return null==r?o:[]}}function EU(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length-1,r=e.parent;n>=0;r=r.parent){if(!r)return !1;if(!r.type.isAnonymous){if(t[n]&&t[n]!=r.name)return !1;n--;}}return !0}var AU=qi((function e(t,n,r,i){Bi(this,e),this.parent=t,this.buffer=n,this.index=r,this.start=i;})),PU=function(){function e(t,n,r){Bi(this,e),this.context=t,this._parent=n,this.index=r,this.type=t.buffer.set.types[t.buffer.buffer[r]];}return qi(e,[{key:"name",get:function(){return this.type.name}},{key:"from",get:function(){return this.context.start+this.context.buffer.buffer[this.index+1]}},{key:"to",get:function(){return this.context.start+this.context.buffer.buffer[this.index+2]}},{key:"child",value:function(t,n,r){var i=this.context.buffer,o=i.findChild(this.index+4,i.buffer[this.index+3],t,n-this.context.start,r);return o<0?null:new e(this.context,this,o)}},{key:"firstChild",get:function(){return this.child(1,0,4)}},{key:"lastChild",get:function(){return this.child(-1,0,4)}},{key:"childAfter",value:function(e){return this.child(1,e,2)}},{key:"childBefore",value:function(e){return this.child(-1,e,-2)}},{key:"enter",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(r&yU.ExcludeBuffers)return null;var i=this.context.buffer,o=i.findChild(this.index+4,i.buffer[this.index+3],n>0?1:-1,t-this.context.start,n);return o<0?null:new e(this.context,this,o)}},{key:"parent",get:function(){return this._parent||this.context.parent.nextSignificantParent()}},{key:"externalSibling",value:function(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}},{key:"nextSibling",get:function(){var t=this.context.buffer,n=t.buffer[this.index+3];return n<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new e(this.context,this._parent,n):this.externalSibling(1)}},{key:"prevSibling",get:function(){var t=this.context.buffer,n=this._parent?this._parent.index+4:0;return this.index==n?this.externalSibling(-1):new e(this.context,this._parent,t.findChild(n,this.index,-1,0,4))}},{key:"cursor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new TU(this,e)}},{key:"tree",get:function(){return null}},{key:"toTree",value:function(){var e=[],t=[],n=this.context.buffer,r=this.index+4,i=n.buffer[this.index+3];if(i>r){var o=n.buffer[this.index+1],a=n.buffer[this.index+2];e.push(n.slice(r,i,o,a)),t.push(0);}return new kU(this.type,e,t,this.to-this.from)}},{key:"resolve",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return _U(this,e,t,!1)}},{key:"resolveInner",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return _U(this,e,t,!0)}},{key:"enterUnfinishedNodesBefore",value:function(e){return $U(this,e)}},{key:"toString",value:function(){return this.context.buffer.childString(this.index)}},{key:"getChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=MU(this,e,t,n);return r.length?r[0]:null}},{key:"getChildren",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return MU(this,e,t,n)}},{key:"node",get:function(){return this}},{key:"matchContext",value:function(e){return EU(this,e)}}]),e}(),TU=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(Bi(this,e),this.mode=n,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof OU)this.yieldNode(t);else {this._tree=t.context.parent,this.buffer=t.context;for(var r=t._parent;r;r=r._parent)this.stack.unshift(r.index);this.bufferNode=t,this.yieldBuf(t.index);}}return qi(e,[{key:"name",get:function(){return this.type.name}},{key:"yieldNode",value:function(e){return !!e&&(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0)}},{key:"yieldBuf",value:function(e,t){this.index=e;var n=this.buffer,r=n.start,i=n.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=r+i.buffer[e+1],this.to=r+i.buffer[e+2],!0}},{key:"yield",value:function(e){return !!e&&(e instanceof OU?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)))}},{key:"toString",value:function(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}},{key:"enterChild",value:function(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));var r=this.buffer.buffer,i=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.buffer.start,n);return !(i<0)&&(this.stack.push(this.index),this.yieldBuf(i))}},{key:"firstChild",value:function(){return this.enterChild(1,0,4)}},{key:"lastChild",value:function(){return this.enterChild(-1,0,4)}},{key:"childAfter",value:function(e){return this.enterChild(1,e,2)}},{key:"childBefore",value:function(e){return this.enterChild(-1,e,-2)}},{key:"enter",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.mode;return this.buffer?!(n&yU.ExcludeBuffers)&&this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}},{key:"parent",value:function(){if(!this.buffer)return this.yieldNode(this.mode&yU.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());var e=this.mode&yU.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}},{key:"sibling",value:function(e){if(!this.buffer)return !!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));var t=this.buffer.buffer,n=this.stack.length-1;if(e<0){var r=n<0?0:this.stack[n]+4;if(this.index!=r)return this.yieldBuf(t.findChild(r,this.index,-1,0,4))}else {var i=t.buffer[this.index+3];if(i<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode))}},{key:"nextSibling",value:function(){return this.sibling(1)}},{key:"prevSibling",value:function(){return this.sibling(-1)}},{key:"atLastNode",value:function(e){var t,n,r=this.buffer;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return !1}else for(var i=0;i<this.index;i++)if(r.buffer.buffer[i+3]<this.index)return !1;t=r.index,n=r.parent;}else {var o=this._tree;t=o.index,n=o._parent;}for(;n;t=(a=n).index,n=a._parent,a){var a;if(t>-1)for(var s=t+e,c=e<0?-1:n._tree.children.length;s!=c;s+=e){var u=n._tree.children[s];if(this.mode&yU.IncludeAnonymous||u instanceof SU||!u.type.isAnonymous||RU(u))return !1}}return !0}},{key:"move",value:function(e,t){if(t&&this.enterChild(e,0,4))return !0;for(;;){if(this.sibling(e))return !0;if(this.atLastNode(e)||!this.parent())return !1}}},{key:"next",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.move(1,e)}},{key:"prev",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.move(-1,e)}},{key:"moveTo",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}},{key:"node",get:function(){if(!this.buffer)return this._tree;var e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(var r=this.index,i=this.stack.length;i>=0;){for(var o=e;o;o=o._parent)if(o.index==r){if(r==this.index)return o;t=o,n=i+1;break e}r=this.stack[--i];}for(var a=n;a<this.stack.length;a++)t=new PU(this.buffer,t,this.stack[a]);return this.bufferNode=new PU(this.buffer,t,this.index)}},{key:"tree",get:function(){return this.buffer?null:this._tree._tree}},{key:"iterate",value:function(e,t){for(var n=0;;){var r=!1;if(this.type.isAnonymous||!1!==e(this)){if(this.firstChild()){n++;continue}this.type.isAnonymous||(r=!0);}for(;r&&t&&t(this),r=this.type.isAnonymous,!this.nextSibling();){if(!n)return;this.parent(),n--,r=!0;}}}},{key:"matchContext",value:function(e){if(!this.buffer)return EU(this.node,e);for(var t=this.buffer.buffer,n=t.set.types,r=e.length-1,i=this.stack.length-1;r>=0;i--){if(i<0)return EU(this.node,e,r);var o=n[t.buffer[this.stack[i]]];if(!o.isAnonymous){if(e[r]&&e[r]!=o.name)return !1;r--;}}return !0}}]),e}();function RU(e){return e.children.some((function(e){return e instanceof SU||!e.type.isAnonymous||RU(e)}))}function NU(e){var t,n=e.buffer,r=e.nodeSet,i=e.maxBufferLength,o=void 0===i?1024:i,a=e.reused,s=void 0===a?[]:a,c=e.minRepeatType,u=void 0===c?r.types.length:c,l=Array.isArray(n)?new jU(n,n.length):n,f=r.types,h=0,d=0;function v(e,t,n,i,a){for(var c=l.id,y=l.start,b=l.end,w=l.size,x=d;w<0;){if(l.next(),-1==w){var k=s[c];return n.push(k),void i.push(y-e)}if(-3==w)return void(h=c);if(-4==w)return void(d=c);throw new RangeError("Unrecognized record size: ".concat(w))}var j,S,C=f[c],$=y-e;if(b-y<=o&&(S=function(e,t){var n=l.fork(),r=0,i=0,a=0,s=n.end-o,c={size:0,start:0,skip:0};e:for(var f=n.pos-e;n.pos>f;){var h=n.size;if(n.id==t&&h>=0)c.size=r,c.start=i,c.skip=a,a+=4,r+=4,n.next();else {var d=n.pos-h;if(h<0||d<f||n.start<s)break;var v=n.id>=u?4:0,p=n.start;for(n.next();n.pos>d;){if(n.size<0){if(-3!=n.size)break e;v+=4;}else n.id>=u&&(v+=4);n.next();}i=p,r+=h,a+=v;}}(t<0||r==e)&&(c.size=r,c.start=i,c.skip=a);return c.size>4?c:void 0}(l.pos-t,a))){for(var _=new Uint16Array(S.size-S.skip),O=l.pos-S.size,M=_.length;l.pos>O;)M=g(S.start,_,M);j=new SU(_,b-S.start,r),$=S.start-e;}else {var E=l.pos-w;l.next();for(var A=[],P=[],T=c>=u?c:-1,R=0,N=b;l.pos>E;)T>=0&&l.id==T&&l.size>=0?(l.end<=N-o&&(p(A,P,y,R,l.end,N,T,x),R=A.length,N=l.end),l.next()):v(y,E,A,P,T);if(T>=0&&R>0&&R<A.length&&p(A,P,y,R,y,N,T,x),A.reverse(),P.reverse(),T>-1&&R>0){var I=function(e){return function(t,n,r){var i,o,a=0,s=t.length-1;if(s>=0&&(i=t[s])instanceof kU){if(!s&&i.type==e&&i.length==r)return i;(o=i.prop(pU.lookAhead))&&(a=n[s]+i.length+o);}return m(e,t,n,r,a)}}(C);j=LU(C,A,P,0,A.length,0,b-y,I,I);}else j=m(C,A,P,b-y,x-b);}n.push(j),i.push($);}function p(e,t,n,i,o,a,s,c){for(var u=[],l=[];e.length>i;)u.push(e.pop()),l.push(t.pop()+n-o);e.push(m(r.types[s],u,l,a-o,c-a)),t.push(o-n);}function m(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0;if(h){var a=[pU.contextHash,h];o=o?[a].concat(o):[a];}if(i>25){var s=[pU.lookAhead,i];o=o?[s].concat(o):[s];}return new kU(e,t,n,r,o)}function g(e,t,n){var r=l.id,i=l.start,o=l.end,a=l.size;if(l.next(),a>=0&&r<u){var s=n;if(a>4)for(var c=l.pos-(a-4);l.pos>c;)n=g(e,t,n);t[--n]=s,t[--n]=o-e,t[--n]=i-e,t[--n]=r;}else -3==a?h=r:-4==a&&(d=r);return n}for(var y=[],b=[];l.pos>0;)v(e.start||0,e.bufferStart||0,y,b,-1);var w=null!==(t=e.length)&&void 0!==t?t:y.length?b[0]+y[0].length:0;return new kU(f[e.topID],y.reverse(),b.reverse(),w)}var IU=new WeakMap;function DU(e,t){if(!e.isAnonymous||t instanceof SU||t.type!=e)return 1;var n=IU.get(t);if(null==n){n=1;var r,i=wi(t.children);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o.type!=e||!(o instanceof kU)){n=1;break}n+=DU(e,o);}}catch(e){i.e(e);}finally{i.f();}IU.set(t,n);}return n}function LU(e,t,n,r,i,o,a,s,c){for(var u=0,l=r;l<i;l++)u+=DU(e,t[l]);var f=Math.ceil(1.5*u/8),h=[],d=[];return function t(n,r,i,a,s){for(var u=i;u<a;){var l=u,v=r[u],p=DU(e,n[u]);for(u++;u<a;u++){var m=DU(e,n[u]);if(p+m>=f)break;p+=m;}if(u==l+1){if(p>f){var g=n[l];t(g.children,g.positions,0,g.children.length,r[l]+s);continue}h.push(n[l]);}else {var y=r[u-1]+n[u-1].length-v;h.push(LU(e,n,r,l,u,v,y,null,c));}d.push(v+s-o);}}(t,n,r,i,0),(s||c)(h,d,a)}var BU=function(){function e(t,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];Bi(this,e),this.from=t,this.to=n,this.tree=r,this.offset=i,this.open=(o?1:0)|(a?2:0);}return qi(e,[{key:"openStart",get:function(){return (1&this.open)>0}},{key:"openEnd",get:function(){return (2&this.open)>0}}],[{key:"addTree",value:function(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[new e(0,t.length,t,0,!1,i)],a=wi(r);try{for(a.s();!(n=a.n()).done;){var s=n.value;s.to>t.length&&o.push(s);}}catch(e){a.e(e);}finally{a.f();}return o}},{key:"applyChanges",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:128;if(!n.length)return t;for(var i=[],o=1,a=t.length?t[0]:null,s=0,c=0,u=0;;s++){var l=s<n.length?n[s]:null,f=l?l.fromA:1e9;if(f-c>=r)for(;a&&a.from<f;){var h=a;if(c>=h.from||f<=h.to||u){var d=Math.max(h.from,c)-u,v=Math.min(h.to,f)-u;h=d>=v?null:new e(d,v,h.tree,h.offset+u,s>0,!!l);}if(h&&i.push(h),a.to>f)break;a=o<t.length?t[o++]:null;}if(!l)break;c=l.toA,u=l.toA-l.toB;}return i}}]),e}(),zU=function(){function e(){Bi(this,e);}return qi(e,[{key:"startParse",value:function(e,t,n){return "string"==typeof e&&(e=new qU(e)),n=n?n.length?n.map((function(e){return new vU(e.from,e.to)})):[new vU(0,0)]:[new vU(0,e.length)],this.createParse(e,t||[],n)}},{key:"parse",value:function(e,t,n){for(var r=this.startParse(e,t,n);;){var i=r.advance();if(i)return i}}}]),e}(),qU=function(){function e(t){Bi(this,e),this.string=t;}return qi(e,[{key:"length",get:function(){return this.string.length}},{key:"chunk",value:function(e){return this.string.slice(e)}},{key:"lineChunks",get:function(){return !1}},{key:"read",value:function(e,t){return this.string.slice(e,t)}}]),e}();new pU({perNode:!0});var FU=0,VU=function(){function e(t,n,r){Bi(this,e),this.set=t,this.base=n,this.modified=r,this.id=FU++;}return qi(e,null,[{key:"define",value:function(t){if(null==t?void 0:t.base)throw new Error("Can not derive from a modified tag");var n=new e([],null,[]);if(n.set.push(n),t){var r,i=wi(t.set);try{for(i.s();!(r=i.n()).done;){var o=r.value;n.set.push(o);}}catch(e){i.e(e);}finally{i.f();}}return n}},{key:"defineModifier",value:function(){var e=new HU;return function(t){return t.modified.indexOf(e)>-1?t:HU.get(t.base||t,t.modified.concat(e).sort((function(e,t){return e.id-t.id})))}}}]),e}(),WU=0,HU=function(){function e(){Bi(this,e),this.instances=[],this.id=WU++;}return qi(e,null,[{key:"get",value:function(t,n){if(!n.length)return t;var r=n[0].instances.find((function(e){return e.base==t&&function(e,t){return e.length==t.length&&e.every((function(e,n){return e==t[n]}))}(n,e.modified)}));if(r)return r;var i,o=[],a=new VU(o,t,n),s=wi(n);try{for(s.s();!(i=s.n()).done;){i.value.instances.push(a);}}catch(e){s.e(e);}finally{s.f();}var c,u=UU(n),l=wi(t.set);try{for(l.s();!(c=l.n()).done;){var f,h=c.value,d=wi(u);try{for(d.s();!(f=d.n()).done;){var v=f.value;o.push(e.get(h,v));}}catch(e){d.e(e);}finally{d.f();}}}catch(e){l.e(e);}finally{l.f();}return a}}]),e}();function UU(e){for(var t=[e],n=0;n<e.length;n++){var r,i=wi(UU(e.slice(0,n).concat(e.slice(n+1))));try{for(i.s();!(r=i.n()).done;){var o=r.value;t.push(o);}}catch(e){i.e(e);}finally{i.f();}}return t}function JU(e){var t=Object.create(null);for(var n in e){var r=e[n];Array.isArray(r)||(r=[r]);var i,o=wi(n.split(" "));try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a){for(var s=[],c=2,u=a,l=0;;){if("..."==u&&l>0&&l+3==a.length){c=1;break}var f=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(u);if(!f)throw new RangeError("Invalid path: "+a);if(s.push("*"==f[0]?"":'"'==f[0][0]?JSON.parse(f[0]):f[0]),(l+=f[0].length)==a.length)break;var h=a[l++];if(l==a.length&&"!"==h){c=0;break}if("/"!=h)throw new RangeError("Invalid path: "+a);u=a.slice(l);}var d=s.length-1,v=s[d];if(!v)throw new RangeError("Invalid path: "+a);var p=new GU(r,c,d>0?s.slice(0,d):null);t[v]=p.sort(t[v]);}}}catch(e){o.e(e);}finally{o.f();}}return KU.add(t)}var KU=new pU,GU=function(){function e(t,n,r,i){Bi(this,e),this.tags=t,this.mode=n,this.context=r,this.next=i;}return qi(e,[{key:"sort",value:function(e){return !e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}},{key:"depth",get:function(){return this.context?this.context.length:0}}]),e}();function QU(e,t){var n,r=Object.create(null),i=wi(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(Array.isArray(o.tag)){var a,s=wi(o.tag);try{for(s.s();!(a=s.n()).done;){var c=a.value;r[c.id]=o.class;}}catch(e){s.e(e);}finally{s.f();}}else r[o.tag.id]=o.class;}}catch(e){i.e(e);}finally{i.f();}var u=t||{},l=u.scope,f=u.all,h=void 0===f?null:f;return {style:function(e){var t,n=h,i=wi(e);try{for(i.s();!(t=i.n()).done;){var o,a=wi(t.value.set);try{for(a.s();!(o=a.n()).done;){var s=o.value,c=r[s.id];if(c){n=n?n+" "+c:c;break}}}catch(e){a.e(e);}finally{a.f();}}}catch(e){i.e(e);}finally{i.f();}return n},scope:l}}function YU(e,t){var n,r=null,i=wi(e);try{for(i.s();!(n=i.n()).done;){var o=n.value.style(t);o&&(r=r?r+" "+o:o);}}catch(e){i.e(e);}finally{i.f();}return r}function XU(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.length,o=new eJ(r,Array.isArray(t)?t:[t],n);o.highlightRange(e.cursor(),r,i,"",o.highlighters),o.flush(i);}var ZU,eJ=function(){function e(t,n,r){Bi(this,e),this.at=t,this.highlighters=n,this.span=r,this.class="";}return qi(e,[{key:"startSpan",value:function(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t);}},{key:"flush",value:function(e){e>this.at&&this.class&&this.span(this.at,e,this.class);}},{key:"highlightRange",value:function(e,t,n,r,i){var o=e.type,a=e.from,s=e.to;if(!(a>=n||s<=t)){o.isTop&&(i=this.highlighters.filter((function(e){return !e.scope||e.scope(o)})));for(var c=r,u=o.prop(KU),l=!1;u;){if(!u.context||e.matchContext(u.context)){var f=YU(i,u.tags);f&&(c&&(c+=" "),c+=f,1==u.mode?r+=(r?" ":"")+f:0==u.mode&&(l=!0));break}u=u.next;}if(this.startSpan(e.from,c),!l){var h=e.tree&&e.tree.prop(pU.mounted);if(h&&h.overlay){for(var d=e.node.enter(h.overlay[0].from+a,1),v=this.highlighters.filter((function(e){return !e.scope||e.scope(h.tree.type)})),p=e.firstChild(),m=0,g=a;;m++){var y=m<h.overlay.length?h.overlay[m]:null,b=y?y.from+a:s,w=Math.max(t,g),x=Math.min(n,b);if(w<x&&p)for(;e.from<x&&(this.highlightRange(e,w,x,r,i),this.startSpan(Math.min(n,e.to),c),!(e.to>=b)&&e.nextSibling()););if(!y||b>n)break;(g=y.to+a)>t&&(this.highlightRange(d.cursor(),Math.max(t,y.from+a),Math.min(n,g),r,v),this.startSpan(g,c));}p&&e.parent();}else if(e.firstChild()){do{if(!(e.to<=t)){if(e.from>=n)break;this.highlightRange(e,t,n,r,i),this.startSpan(Math.min(n,e.to),c);}}while(e.nextSibling());e.parent();}}}}}]),e}(),tJ=VU.define,nJ=tJ(),rJ=tJ(),iJ=tJ(rJ),oJ=tJ(rJ),aJ=tJ(),sJ=tJ(aJ),cJ=tJ(aJ),uJ=tJ(),lJ=tJ(uJ),fJ=tJ(),hJ=tJ(),dJ=tJ(),vJ=tJ(dJ),pJ=tJ(),mJ={comment:nJ,lineComment:tJ(nJ),blockComment:tJ(nJ),docComment:tJ(nJ),name:rJ,variableName:tJ(rJ),typeName:iJ,tagName:tJ(iJ),propertyName:oJ,attributeName:tJ(oJ),className:tJ(rJ),labelName:tJ(rJ),namespace:tJ(rJ),macroName:tJ(rJ),literal:aJ,string:sJ,docString:tJ(sJ),character:tJ(sJ),attributeValue:tJ(sJ),number:cJ,integer:tJ(cJ),float:tJ(cJ),bool:tJ(aJ),regexp:tJ(aJ),escape:tJ(aJ),color:tJ(aJ),url:tJ(aJ),keyword:fJ,self:tJ(fJ),null:tJ(fJ),atom:tJ(fJ),unit:tJ(fJ),modifier:tJ(fJ),operatorKeyword:tJ(fJ),controlKeyword:tJ(fJ),definitionKeyword:tJ(fJ),moduleKeyword:tJ(fJ),operator:hJ,derefOperator:tJ(hJ),arithmeticOperator:tJ(hJ),logicOperator:tJ(hJ),bitwiseOperator:tJ(hJ),compareOperator:tJ(hJ),updateOperator:tJ(hJ),definitionOperator:tJ(hJ),typeOperator:tJ(hJ),controlOperator:tJ(hJ),punctuation:dJ,separator:tJ(dJ),bracket:vJ,angleBracket:tJ(vJ),squareBracket:tJ(vJ),paren:tJ(vJ),brace:tJ(vJ),content:uJ,heading:lJ,heading1:tJ(lJ),heading2:tJ(lJ),heading3:tJ(lJ),heading4:tJ(lJ),heading5:tJ(lJ),heading6:tJ(lJ),contentSeparator:tJ(uJ),list:tJ(uJ),quote:tJ(uJ),emphasis:tJ(uJ),strong:tJ(uJ),link:tJ(uJ),monospace:tJ(uJ),strikethrough:tJ(uJ),inserted:tJ(),deleted:tJ(),changed:tJ(),invalid:tJ(),meta:pJ,documentMeta:tJ(pJ),annotation:tJ(pJ),processingInstruction:tJ(pJ),definition:VU.defineModifier(),constant:VU.defineModifier(),function:VU.defineModifier(),standard:VU.defineModifier(),local:VU.defineModifier(),special:VU.defineModifier()};QU([{tag:mJ.link,class:"tok-link"},{tag:mJ.heading,class:"tok-heading"},{tag:mJ.emphasis,class:"tok-emphasis"},{tag:mJ.strong,class:"tok-strong"},{tag:mJ.keyword,class:"tok-keyword"},{tag:mJ.atom,class:"tok-atom"},{tag:mJ.bool,class:"tok-bool"},{tag:mJ.url,class:"tok-url"},{tag:mJ.labelName,class:"tok-labelName"},{tag:mJ.inserted,class:"tok-inserted"},{tag:mJ.deleted,class:"tok-deleted"},{tag:mJ.literal,class:"tok-literal"},{tag:mJ.string,class:"tok-string"},{tag:mJ.number,class:"tok-number"},{tag:[mJ.regexp,mJ.escape,mJ.special(mJ.string)],class:"tok-string2"},{tag:mJ.variableName,class:"tok-variableName"},{tag:mJ.local(mJ.variableName),class:"tok-variableName tok-local"},{tag:mJ.definition(mJ.variableName),class:"tok-variableName tok-definition"},{tag:mJ.special(mJ.variableName),class:"tok-variableName2"},{tag:mJ.definition(mJ.propertyName),class:"tok-propertyName tok-definition"},{tag:mJ.typeName,class:"tok-typeName"},{tag:mJ.namespace,class:"tok-namespace"},{tag:mJ.className,class:"tok-className"},{tag:mJ.macroName,class:"tok-macroName"},{tag:mJ.propertyName,class:"tok-propertyName"},{tag:mJ.operator,class:"tok-operator"},{tag:mJ.comment,class:"tok-comment"},{tag:mJ.meta,class:"tok-meta"},{tag:mJ.invalid,class:"tok-invalid"},{tag:mJ.punctuation,class:"tok-punctuation"}]);var gJ=new pU;var yJ=new pU,bJ=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";Bi(this,e),this.data=t,this.name=i,tz.prototype.hasOwnProperty("tree")||Object.defineProperty(tz.prototype,"tree",{get:function(){return kJ(this)}}),this.parser=n,this.extension=[AJ.of(this),tz.languageData.of((function(e,t,n){var r=wJ(e,t,n),i=r.type.prop(gJ);if(!i)return [];var o=e.facet(i),a=r.type.prop(yJ);if(a){var s,c=r.resolve(t-r.from,n),u=wi(a);try{for(u.s();!(s=u.n()).done;){var l=s.value;if(l.test(c,e)){var f=e.facet(l.facet);return "replace"==l.type?f:f.concat(o)}}}catch(e){u.e(e);}finally{u.f();}}return o}))].concat(r);}return qi(e,[{key:"isActiveAt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;return wJ(e,t,n).type.prop(gJ)==this.data}},{key:"findRegions",value:function(e){var t=this,n=e.facet(AJ);if((null==n?void 0:n.data)==this.data)return [{from:0,to:e.doc.length}];if(!n||!n.allowsNesting)return [];var r=[];return function e(n,i){if(n.prop(gJ)!=t.data){var o=n.prop(pU.mounted);if(o){if(o.tree.prop(gJ)==t.data){if(o.overlay){var a,s=wi(o.overlay);try{for(s.s();!(a=s.n()).done;){var c=a.value;r.push({from:c.from+i,to:c.to+i});}}catch(e){s.e(e);}finally{s.f();}}else r.push({from:i,to:i+n.length});return}if(o.overlay){var u=r.length;if(e(o.tree,o.overlay[0].from+i),r.length>u)return}}for(var l=0;l<n.children.length;l++){var f=n.children[l];f instanceof kU&&e(f,n.positions[l]+i);}}else r.push({from:i,to:i+n.length});}(kJ(e),0),r}},{key:"allowsNesting",get:function(){return !0}}]),e}();function wJ(e,t,n){var r=e.facet(AJ),i=kJ(e).topNode;if(!r||r.allowsNesting)for(var o=i;o;o=o.enter(t,n,yU.ExcludeBuffers))o.type.isTop&&(i=o);return i}bJ.setState=VB.define();var xJ=function(e){Pi(n,bJ);var t=Ri(n);function n(e,r,i){var o;return Bi(this,n),(o=t.call(this,e,r,[],i)).parser=r,o}return qi(n,[{key:"configure",value:function(e,t){return new n(this.data,this.parser.configure(e),t||this.name)}},{key:"allowsNesting",get:function(){return this.parser.hasWrappers()}}],[{key:"define",value:function(e){var t,r=(t=e.languageData,vB.define({combine:t?function(e){return e.concat(t)}:void 0}));return new n(r,e.parser.configure({props:[gJ.add((function(e){return e.isTop?r:void 0}))]}),e.name)}}]),n}();function kJ(e){var t=e.field(bJ.state,!1);return t?t.tree:kU.empty}var jJ=function(){function e(t){Bi(this,e),this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter();}return qi(e,[{key:"length",get:function(){return this.doc.length}},{key:"syncTo",value:function(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}},{key:"chunk",value:function(e){return this.syncTo(e),this.string}},{key:"lineChunks",get:function(){return !0}},{key:"read",value:function(e,t){var n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}}]),e}(),SJ=null,CJ=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0;Bi(this,e),this.parser=t,this.state=n,this.fragments=r,this.tree=i,this.treeLen=o,this.viewport=a,this.skipped=s,this.scheduleOn=c,this.parse=null,this.tempSkipped=[];}return qi(e,[{key:"startParse",value:function(){return this.parser.startParse(new jJ(this.state.doc),this.fragments)}},{key:"work",value:function(e,t){var n=this;return null!=t&&t>=this.state.doc.length&&(t=void 0),this.tree!=kU.empty&&this.isDone(null!=t?t:this.state.doc.length)?(this.takeTree(),!0):this.withContext((function(){var r;if("number"==typeof e){var i=Date.now()+e;e=function(){return Date.now()>i};}for(n.parse||(n.parse=n.startParse()),null!=t&&(null==n.parse.stoppedAt||n.parse.stoppedAt>t)&&t<n.state.doc.length&&n.parse.stopAt(t);;){var o=n.parse.advance();if(o){if(n.fragments=n.withoutTempSkipped(BU.addTree(o,n.fragments,null!=n.parse.stoppedAt)),n.treeLen=null!==(r=n.parse.stoppedAt)&&void 0!==r?r:n.state.doc.length,n.tree=o,n.parse=null,!(n.treeLen<(null!=t?t:n.state.doc.length)))return !0;n.parse=n.startParse();}if(e())return !1}}))}},{key:"takeTree",value:function(){var e,t,n=this;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext((function(){for(;!(t=n.parse.advance()););})),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(BU.addTree(this.tree,this.fragments,!0)),this.parse=null);}},{key:"withContext",value:function(e){var t=SJ;SJ=this;try{return e()}finally{SJ=t;}}},{key:"withoutTempSkipped",value:function(e){for(var t;t=this.tempSkipped.pop();)e=$J(e,t.from,t.to);return e}},{key:"changes",value:function(t,n){var r=this.fragments,i=this.tree,o=this.treeLen,a=this.viewport,s=this.skipped;if(this.takeTree(),!t.empty){var c=[];if(t.iterChangedRanges((function(e,t,n,r){return c.push({fromA:e,toA:t,fromB:n,toB:r})})),r=BU.applyChanges(r,c),i=kU.empty,o=0,a={from:t.mapPos(a.from,-1),to:t.mapPos(a.to,1)},this.skipped.length){s=[];var u,l=wi(this.skipped);try{for(l.s();!(u=l.n()).done;){var f=u.value,h=t.mapPos(f.from,1),d=t.mapPos(f.to,-1);h<d&&s.push({from:h,to:d});}}catch(e){l.e(e);}finally{l.f();}}}return new e(this.parser,n,r,i,o,a,s,this.scheduleOn)}},{key:"updateViewport",value:function(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return !1;this.viewport=e;for(var t=this.skipped.length,n=0;n<this.skipped.length;n++){var r=this.skipped[n],i=r.from,o=r.to;i<e.to&&o>e.from&&(this.fragments=$J(this.fragments,i,o),this.skipped.splice(n--,1));}return !(this.skipped.length>=t)&&(this.reset(),!0)}},{key:"reset",value:function(){this.parse&&(this.takeTree(),this.parse=null);}},{key:"skipUntilInView",value:function(e,t){this.skipped.push({from:e,to:t});}},{key:"isDone",value:function(e){e=Math.min(e,this.state.doc.length);var t=this.fragments;return this.treeLen>=e&&t.length&&0==t[0].from&&t[0].to>=e}}],[{key:"create",value:function(t,n,r){return new e(t,n,[],kU.empty,0,r,[],null)}},{key:"getSkippingParser",value:function(e){return new(function(t){Pi(r,zU);var n=Ri(r);function r(){return Bi(this,r),n.apply(this,arguments)}return qi(r,[{key:"createParse",value:function(t,n,r){var i=r[0].from,o=r[r.length-1].to;return {parsedPos:i,advance:function(){var t=SJ;if(t){var n,a=wi(r);try{for(a.s();!(n=a.n()).done;){var s=n.value;t.tempSkipped.push(s);}}catch(e){a.e(e);}finally{a.f();}e&&(t.scheduleOn=t.scheduleOn?Promise.all([t.scheduleOn,e]):e);}return this.parsedPos=o,new kU(gU.none,[],[],o-i)},stoppedAt:null,stopAt:function(){}}}}]),r}())}},{key:"get",value:function(){return SJ}}]),e}();function $J(e,t,n){return BU.applyChanges(e,[{fromA:t,toA:n,fromB:t,toB:n}])}var _J=function(){function e(t){Bi(this,e),this.context=t,this.tree=t.tree;}return qi(e,[{key:"apply",value:function(t){if(!t.docChanged&&this.tree==this.context.tree)return this;var n=this.context.changes(t.changes,t.state),r=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),n.viewport.to);return n.work(20,r)||n.takeTree(),new e(n)}}],[{key:"init",value:function(t){var n=Math.min(3e3,t.doc.length),r=CJ.create(t.facet(AJ).parser,t,{from:0,to:n});return r.work(20,n)||r.takeTree(),new e(r)}}]),e}();bJ.state=wB.define({create:_J.init,update:function(e,t){var n,r=wi(t.effects);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.is(bJ.setState))return i.value}}catch(e){r.e(e);}finally{r.f();}return t.startState.facet(AJ)!=t.state.facet(AJ)?_J.init(t.state):e.apply(t)}});var OJ=function(e){var t=setTimeout((function(){return e()}),500);return function(){return clearTimeout(t)}};"undefined"!=typeof requestIdleCallback&&(OJ=function(e){var t=-1,n=setTimeout((function(){t=requestIdleCallback(e,{timeout:400});}),100);return function(){return t<0?clearTimeout(n):cancelIdleCallback(t)}});var MJ="undefined"!=typeof navigator&&(null===(ZU=navigator.scheduling)||void 0===ZU?void 0:ZU.isInputPending)?function(){return navigator.scheduling.isInputPending()}:null,EJ=uF.fromClass(function(){function e(t){Bi(this,e),this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork();}return qi(e,[{key:"update",value:function(e){var t=this.view.state.field(bJ.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),e.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t);}},{key:"scheduleWork",value:function(){if(!this.working){var e=this.view.state,t=e.field(bJ.state);t.tree==t.context.tree&&t.context.isDone(e.doc.length)||(this.working=OJ(this.work));}}},{key:"work",value:function(e){this.working=null;var t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),!(this.chunkBudget<=0)){var n=this.view,r=n.state,i=n.viewport.to,o=r.field(bJ.state);if(o.tree!=o.context.tree||!o.context.isDone(i+1e5)){var a=Date.now()+Math.min(this.chunkBudget,100,e&&!MJ?Math.max(25,e.timeRemaining()-5):1e9),s=o.context.treeLen<i&&r.doc.length>i+1e3,c=o.context.work((function(){return MJ&&MJ()||Date.now()>a}),i+(s?0:1e5));this.chunkBudget-=Date.now()-t,(c||this.chunkBudget<=0)&&(o.context.takeTree(),this.view.dispatch({effects:bJ.setState.of(new _J(o.context))})),this.chunkBudget>0&&(!c||s)&&this.scheduleWork(),this.checkAsyncSchedule(o.context);}}}},{key:"checkAsyncSchedule",value:function(e){var t=this;e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then((function(){return t.scheduleWork()})).catch((function(e){return oF(t.view.state,e)})).then((function(){return t.workScheduled--})),e.scheduleOn=null);}},{key:"destroy",value:function(){this.working&&this.working();}},{key:"isWorking",value:function(){return !!(this.working||this.workScheduled>0)}}]),e}(),{eventHandlers:{focus:function(){this.scheduleWork();}}}),AJ=vB.define({combine:function(e){return e.length?e[0]:null},enables:function(e){return [bJ.state,EJ,jW.contentAttributes.compute([e],(function(t){var n=t.facet(e);return n&&n.name?{"data-language":n.name}:{}}))]}}),PJ=qi((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Bi(this,e),this.language=t,this.support=n,this.extension=[t,n];})),TJ=vB.define(),RJ=vB.define({combine:function(e){if(!e.length)return "  ";var t=e[0];if(!t||/\S/.test(t)||Array.from(t).some((function(e){return e!=t[0]})))throw new Error("Invalid indent unit: "+JSON.stringify(e[0]));return t}});function NJ(e){var t=e.facet(RJ);return 9==t.charCodeAt(0)?e.tabSize*t.length:t.length}function IJ(e,t){var n="",r=e.tabSize,i=e.facet(RJ)[0];if("\t"==i){for(;t>=r;)n+="\t",t-=r;i=" ";}for(var o=0;o<t;o++)n+=i;return n}function DJ(e,t){e instanceof tz&&(e=new LJ(e));var n,r=wi(e.state.facet(TJ));try{for(r.s();!(n=r.n()).done;){var i=(0,n.value)(e,t);if(void 0!==i)return i}}catch(e){r.e(e);}finally{r.f();}var o=kJ(e.state);return o?function(e,t,n){return qJ(t.resolveInner(n).enterUnfinishedNodesBefore(n),n,e)}(e,o,t):null}var LJ=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Bi(this,e),this.state=t,this.options=n,this.unit=NJ(t);}return qi(e,[{key:"lineAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.state.doc.lineAt(e),r=this.options,i=r.simulateBreak,o=r.simulateDoubleBreak;return null!=i&&i>=n.from&&i<=n.to?o&&i==e?{text:"",from:e}:(t<0?i<e:i<=e)?{text:n.text.slice(i-n.from),from:i}:{text:n.text.slice(0,i-n.from),from:n.from}:n}},{key:"textAfterPos",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return "";var n=this.lineAt(e,t),r=n.text,i=n.from;return r.slice(e-i,Math.min(r.length,e+100-i))}},{key:"column",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.lineAt(e,t),r=n.text,i=n.from,o=this.countColumn(r,e-i),a=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return a>-1&&(o+=a-this.countColumn(r,r.search(/\S|$/))),o}},{key:"countColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;return wz(e,this.state.tabSize,t)}},{key:"lineIndent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.lineAt(e,t),r=n.text,i=n.from,o=this.options.overrideIndentation;if(o){var a=o(i);if(a>-1)return a}return this.countColumn(r,r.search(/\S|$/))}},{key:"simulatedBreak",get:function(){return this.options.simulateBreak||null}}]),e}(),BJ=new pU;function zJ(e){var t=e.type.prop(BJ);if(t)return t;var n,r=e.firstChild;if(r&&(n=r.type.prop(pU.closedBy))){var i=e.lastChild,o=i&&n.indexOf(i.name)>-1;return function(e){return function(e,t,n,r,i){var o=e.textAfter,a=o.match(/^\s*/)[0].length,s=r&&o.slice(a,a+r.length)==r||i==e.pos+a,c=t?function(e){var t=e.node,n=t.childAfter(t.from),r=t.lastChild;if(!n)return null;for(var i=e.options.simulateBreak,o=e.state.doc.lineAt(n.from),a=null==i||i<=o.from?o.to:Math.min(o.to,i),s=n.to;;){var c=t.childAfter(s);if(!c||c==r)return null;if(!c.type.isSkipped)return c.from<a?n:null;s=c.to;}}(e):null;return c?s?e.column(c.from):e.column(c.to):e.baseIndent+(s?0:e.unit*n)}(e,!0,1,void 0,o&&!function(e){return e.pos==e.options.simulateBreak&&e.options.simulateDoubleBreak}(e)?i.from:void 0)}}return null==e.parent?FJ:null}function qJ(e,t,n){for(;e;e=e.parent){var r=zJ(e);if(r)return r(VJ.create(n,t,e))}return null}function FJ(){return 0}var VJ=function(e){Pi(n,LJ);var t=Ri(n);function n(e,r,i){var o;return Bi(this,n),(o=t.call(this,e.state,e.options)).base=e,o.pos=r,o.node=i,o}return qi(n,[{key:"textAfter",get:function(){return this.textAfterPos(this.pos)}},{key:"baseIndent",get:function(){for(var e=this.state.doc.lineAt(this.node.from);;){for(var t=this.node.resolve(e.from);t.parent&&t.parent.from==t.from;)t=t.parent;if(WJ(t,this.node))break;e=this.state.doc.lineAt(t.from);}return this.lineIndent(e.from)}},{key:"continue",value:function(){var e=this.node.parent;return e?qJ(e,this.pos,this.base):0}}],[{key:"create",value:function(e,t,r){return new n(e,t,r)}}]),n}();function WJ(e,t){for(var n=t;n;n=n.parent)if(e==n)return !0;return !1}function HJ(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.except,n=e.units,r=void 0===n?1:n;return function(e){var n=t&&t.test(e.textAfter);return e.baseIndent+(n?0:r*e.unit)}}var UJ=vB.define(),JJ=new pU;function KJ(e,t,n){var r,i=wi(e.facet(UJ));try{for(i.s();!(r=i.n()).done;){var o=(0,r.value)(e,t,n);if(o)return o}}catch(e){i.e(e);}finally{i.f();}return function(e,t,n){var r=kJ(e);if(r.length<n)return null;for(var i,o,a=null,s=r.resolveInner(n,1);s;s=s.parent)if(!(s.to<=n||s.from>n)){if(a&&s.from<t)break;var c=s.type.prop(JJ);if(c&&(s.to<r.length-50||r.length==e.doc.length||(o=void 0,!(o=(i=s).lastChild)||o.to!=i.to||!o.type.isError))){var u=c(s,e);u&&u.from<=n&&u.from>=t&&u.to>n&&(a=u);}}return a}(e,t,n)}function GJ(e,t){var n=t.mapPos(e.from,1),r=t.mapPos(e.to,-1);return n>=r?void 0:{from:n,to:r}}var QJ=VB.define({map:GJ}),YJ=VB.define({map:GJ});function XJ(e){var t,n=[],r=wi(e.state.selection.ranges);try{var i=function(){var r=t.value.head;if(n.some((function(e){return e.from<=r&&e.to>=r})))return "continue";n.push(e.lineBlockAt(r));};for(r.s();!(t=r.n()).done;)i();}catch(e){r.e(e);}finally{r.f();}return n}var ZJ=wB.define({create:function(){return Dq.none},update:function(e,t){e=e.map(t.changes);var n,r=wi(t.effects);try{var i=function(){var t=n.value;t.is(QJ)&&!function(e,t,n){var r=!1;return e.between(t,t,(function(e,i){e==t&&i==n&&(r=!0);})),r}(e,t.value.from,t.value.to)?e=e.update({add:[sK.range(t.value.from,t.value.to)]}):t.is(YJ)&&(e=e.update({filter:function(e,n){return t.value.from!=e||t.value.to!=n},filterFrom:t.value.from,filterTo:t.value.to}));};for(r.s();!(n=r.n()).done;)i();}catch(e){r.e(e);}finally{r.f();}if(t.selection){var o=!1,a=t.selection.main.head;e.between(a,a,(function(e,t){e<a&&t>a&&(o=!0);})),o&&(e=e.update({filterFrom:a,filterTo:a,filter:function(e,t){return t<=a||e>=a}}));}return e},provide:function(e){return jW.decorations.from(e)},toJSON:function(e,t){var n=[];return e.between(0,t.doc.length,(function(e,t){n.push(e,t);})),n},fromJSON:function(e){if(!Array.isArray(e)||e.length%2)throw new RangeError("Invalid JSON for fold state");for(var t=[],n=0;n<e.length;){var r=e[n++],i=e[n++];if("number"!=typeof r||"number"!=typeof i)throw new RangeError("Invalid JSON for fold state");t.push(sK.range(r,i));}return Dq.set(t,!0)}});function eK(e,t,n){var r,i=null;return null===(r=e.field(ZJ,!1))||void 0===r||r.between(t,n,(function(e,t){(!i||i.from>e)&&(i={from:e,to:t});})),i}function tK(e,t){return e.field(ZJ,!1)?t:t.concat(VB.appendConfig.of(aK()))}function nK(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.state.doc.lineAt(t.from).number,i=e.state.doc.lineAt(t.to).number;return jW.announce.of("".concat(e.state.phrase(n?"Folded lines":"Unfolded lines")," ").concat(r," ").concat(e.state.phrase("to")," ").concat(i,"."))}var rK=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:function(e){var t,n=wi(XJ(e));try{for(n.s();!(t=n.n()).done;){var r=t.value,i=KJ(e.state,r.from,r.to);if(i)return e.dispatch({effects:tK(e.state,[QJ.of(i),nK(e,i)])}),!0}}catch(e){n.e(e);}finally{n.f();}return !1}},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:function(e){if(!e.state.field(ZJ,!1))return !1;var t,n=[],r=wi(XJ(e));try{for(r.s();!(t=r.n()).done;){var i=t.value,o=eK(e.state,i.from,i.to);o&&n.push(YJ.of(o),nK(e,o,!1));}}catch(e){r.e(e);}finally{r.f();}return n.length&&e.dispatch({effects:n}),n.length>0}},{key:"Ctrl-Alt-[",run:function(e){for(var t=e.state,n=[],r=0;r<t.doc.length;){var i=e.lineBlockAt(r),o=KJ(t,i.from,i.to);o&&n.push(QJ.of(o)),r=(o?e.lineBlockAt(o.to):i).to+1;}return n.length&&e.dispatch({effects:tK(e.state,n)}),!!n.length}},{key:"Ctrl-Alt-]",run:function(e){var t=e.state.field(ZJ,!1);if(!t||!t.size)return !1;var n=[];return t.between(0,e.state.doc.length,(function(e,t){n.push(YJ.of({from:e,to:t}));})),e.dispatch({effects:n}),!0}}],iK={placeholderDOM:null,placeholderText:""},oK=vB.define({combine:function(e){return nz(e,iK)}});function aK(e){var t=[ZJ,fK];return e&&t.push(oK.of(e)),t}var sK=Dq.replace({widget:new(function(e){Pi(n,Nq);var t=Ri(n);function n(){return Bi(this,n),t.apply(this,arguments)}return qi(n,[{key:"toDOM",value:function(e){var t=e.state,n=t.facet(oK),r=function(t){var n=e.lineBlockAt(e.posAtDOM(t.target)),r=eK(e.state,n.from,n.to);r&&e.dispatch({effects:YJ.of(r)}),t.preventDefault();};if(n.placeholderDOM)return n.placeholderDOM(e,r);var i=document.createElement("span");return i.textContent=n.placeholderText,i.setAttribute("aria-label",t.phrase("folded code")),i.title=t.phrase("unfold"),i.className="cm-foldPlaceholder",i.onclick=r,i}}]),n}())}),cK={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:function(){return !1}},uK=function(e){Pi(n,HH);var t=Ri(n);function n(e,r){var i;return Bi(this,n),(i=t.call(this)).config=e,i.open=r,i}return qi(n,[{key:"eq",value:function(e){return this.config==e.config&&this.open==e.open}},{key:"toDOM",value:function(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);var t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}]),n}();function lK(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign(Object.assign({},cK),e),n=new uK(t,!0),r=new uK(t,!1),i=uF.fromClass(function(){function e(t){Bi(this,e),this.from=t.viewport.from,this.markers=this.buildMarkers(t);}return qi(e,[{key:"update",value:function(e){(e.docChanged||e.viewportChanged||e.startState.facet(AJ)!=e.state.facet(AJ)||e.startState.field(ZJ,!1)!=e.state.field(ZJ,!1)||kJ(e.startState)!=kJ(e.state)||t.foldingChanged(e))&&(this.markers=this.buildMarkers(e.view));}},{key:"buildMarkers",value:function(e){var t,i=new uz,o=wi(e.viewportLineBlocks);try{for(o.s();!(t=o.n()).done;){var a=t.value,s=eK(e.state,a.from,a.to)?r:KJ(e.state,a.from,a.to)?n:null;s&&i.add(a.from,a.from,s);}}catch(e){o.e(e);}finally{o.f();}return i.finish()}}]),e}()),o=t.domEventHandlers;return [i,GH({class:"cm-foldGutter",markers:function(e){var t;return (null===(t=e.plugin(i))||void 0===t?void 0:t.markers)||sz.empty},initialSpacer:function(){return new uK(t,!1)},domEventHandlers:Object.assign(Object.assign({},o),{click:function(e,t,n){if(o.click&&o.click(e,t,n))return !0;var r=eK(e.state,t.from,t.to);if(r)return e.dispatch({effects:YJ.of(r)}),!0;var i=KJ(e.state,t.from,t.to);return !!i&&(e.dispatch({effects:QJ.of(i)}),!0)}})}),aK()]}var fK=jW.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}}),hK=function(){function e(t,n){var r;function i(e){var t=Cz.newName();return (r||(r=Object.create(null)))["."+t]=e,t}Bi(this,e),this.specs=t;var o="string"==typeof n.all?n.all:n.all?i(n.all):void 0,a=n.scope;this.scope=a instanceof bJ?function(e){return e.prop(gJ)==a.data}:a?function(e){return e==a}:void 0,this.style=QU(t.map((function(e){return {tag:e.tag,class:e.class||i(Object.assign({},e,{tag:null}))}})),{all:o}).style,this.module=r?new Cz(r):null,this.themeType=n.themeType;}return qi(e,null,[{key:"define",value:function(t,n){return new e(t,n||{})}}]),e}(),dK=vB.define(),vK=vB.define({combine:function(e){return e.length?[e[0]]:null}});function pK(e){var t=e.facet(dK);return t.length?t:e.facet(vK)}function mK(e,t){var n,r=[yK];return e instanceof hK&&(e.module&&r.push(jW.styleModule.of(e.module)),n=e.themeType),(null==t?void 0:t.fallback)?r.push(vK.of(e)):n?r.push(dK.computeN([jW.darkTheme],(function(t){return t.facet(jW.darkTheme)==("dark"==n)?[e]:[]}))):r.push(dK.of(e)),r}var gK=function(){function e(t){Bi(this,e),this.markCache=Object.create(null),this.tree=kJ(t.state),this.decorations=this.buildDeco(t,pK(t.state));}return qi(e,[{key:"update",value:function(e){var t=kJ(e.state),n=pK(e.state),r=n!=pK(e.startState);t.length<e.view.viewport.to&&!r&&t.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(t!=this.tree||e.viewportChanged||r)&&(this.tree=t,this.decorations=this.buildDeco(e.view,n));}},{key:"buildDeco",value:function(e,t){var n=this;if(!t||!this.tree.length)return Dq.none;var r,i=new uz,o=wi(e.visibleRanges);try{for(o.s();!(r=o.n()).done;){var a=r.value,s=a.from,c=a.to;XU(this.tree,t,(function(e,t,r){i.add(e,t,n.markCache[r]||(n.markCache[r]=Dq.mark({class:r})));}),s,c);}}catch(e){o.e(e);}finally{o.f();}return i.finish()}}]),e}(),yK=$B.high(uF.fromClass(gK,{decorations:function(e){return e.decorations}})),bK=hK.define([{tag:mJ.meta,color:"#404740"},{tag:mJ.link,textDecoration:"underline"},{tag:mJ.heading,textDecoration:"underline",fontWeight:"bold"},{tag:mJ.emphasis,fontStyle:"italic"},{tag:mJ.strong,fontWeight:"bold"},{tag:mJ.strikethrough,textDecoration:"line-through"},{tag:mJ.keyword,color:"#708"},{tag:[mJ.atom,mJ.bool,mJ.url,mJ.contentSeparator,mJ.labelName],color:"#219"},{tag:[mJ.literal,mJ.inserted],color:"#164"},{tag:[mJ.string,mJ.deleted],color:"#a11"},{tag:[mJ.regexp,mJ.escape,mJ.special(mJ.string)],color:"#e40"},{tag:mJ.definition(mJ.variableName),color:"#00f"},{tag:mJ.local(mJ.variableName),color:"#30a"},{tag:[mJ.typeName,mJ.namespace],color:"#085"},{tag:mJ.className,color:"#167"},{tag:[mJ.special(mJ.variableName),mJ.macroName],color:"#256"},{tag:mJ.definition(mJ.propertyName),color:"#00c"},{tag:mJ.comment,color:"#940"},{tag:mJ.invalid,color:"#f00"}]),wK=jW.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),xK=vB.define({combine:function(e){return nz(e,{afterCursor:!0,brackets:"()[]{}",maxScanDistance:1e4,renderMatch:SK})}}),kK=Dq.mark({class:"cm-matchingBracket"}),jK=Dq.mark({class:"cm-nonmatchingBracket"});function SK(e){var t=[],n=e.matched?kK:jK;return t.push(n.range(e.start.from,e.start.to)),e.end&&t.push(n.range(e.end.from,e.end.to)),t}var CK=wB.define({create:function(){return Dq.none},update:function(e,t){if(!t.docChanged&&!t.selection)return e;var n,r=[],i=t.state.facet(xK),o=wi(t.state.selection.ranges);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(a.empty){var s=AK(t.state,a.head,-1,i)||a.head>0&&AK(t.state,a.head-1,1,i)||i.afterCursor&&(AK(t.state,a.head,1,i)||a.head<t.state.doc.length&&AK(t.state,a.head+1,-1,i));s&&(r=r.concat(i.renderMatch(s,t.state)));}}}catch(e){o.e(e);}finally{o.f();}return Dq.set(r,!0)},provide:function(e){return jW.decorations.from(e)}}),$K=[CK,wK];function _K(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return [xK.of(e),$K]}var OK=new pU;function MK(e,t,n){var r=e.prop(t<0?pU.openedBy:pU.closedBy);if(r)return r;if(1==e.name.length){var i=n.indexOf(e.name);if(i>-1&&i%2==(t<0?1:0))return [n[i+t]]}return null}function EK(e){var t=e.type.prop(OK);return t?t(e.node):e}function AK(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.maxScanDistance||1e4,o=r.brackets||"()[]{}",a=kJ(e),s=a.resolveInner(t,n),c=s;c;c=c.parent){var u=MK(c.type,n,o);if(u&&c.from<c.to){var l=EK(c);if(l&&(n>0?t>=l.from&&t<l.to:t>l.from&&t<=l.to))return PK(e,t,n,c,l,u,o)}}return TK(e,t,n,a,s.type,i,o)}function PK(e,t,n,r,i,o,a){var s=r.parent,c={from:i.from,to:i.to},u=0,l=null==s?void 0:s.cursor();if(l&&(n<0?l.childBefore(r.from):l.childAfter(r.to)))do{if(n<0?l.to<=r.from:l.from>=r.to){if(0==u&&o.indexOf(l.type.name)>-1&&l.from<l.to){var f=EK(l);return {start:c,end:f?{from:f.from,to:f.to}:void 0,matched:!0}}if(MK(l.type,n,a))u++;else if(MK(l.type,-n,a)){if(0==u){var h=EK(l);return {start:c,end:h&&h.from<h.to?{from:h.from,to:h.to}:void 0,matched:!1}}u--;}}}while(n<0?l.prevSibling():l.nextSibling());return {start:c,matched:!1}}function TK(e,t,n,r,i,o,a){var s=n<0?e.sliceDoc(t-1,t):e.sliceDoc(t,t+1),c=a.indexOf(s);if(c<0||c%2==0!=n>0)return null;for(var u={from:n<0?t-1:t,to:n>0?t+1:t},l=e.doc.iterRange(t,n>0?e.doc.length:0),f=0,h=0;!l.next().done&&h<=o;){var d=l.value;n<0&&(h+=d.length);for(var v=t+h*n,p=n>0?0:d.length-1,m=n>0?d.length:-1;p!=m;p+=n){var g=a.indexOf(d[p]);if(!(g<0||r.resolveInner(v+p,1).type!=i))if(g%2==0==n>0)f++;else {if(1==f)return {start:u,end:{from:v+p,to:v+p+1},matched:g>>1==c>>1};f--;}}n>0&&(h+=d.length);}return l.done?{start:u,matched:!1}:null}for(var RK=Object.create(null),NK=[gU.none],IK=[],DK=Object.create(null),LK=0,BK=[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]];LK<BK.length;LK++){var zK=Si(BK[LK],2),qK=zK[0],FK=zK[1];DK[qK]=WK(RK,FK);}function VK(e,t){IK.indexOf(e)>-1||(IK.push(e),console.warn(t));}function WK(e,t){var n,r=null,i=wi(t.split("."));try{for(i.s();!(n=i.n()).done;){var o=n.value,a=e[o]||mJ[o];a?"function"==typeof a?r?r=a(r):VK(o,"Modifier ".concat(o," used at start of tag")):r?VK(o,"Tag ".concat(o," used as modifier")):r=a:VK(o,"Unknown highlighting tag ".concat(o));}}catch(e){i.e(e);}finally{i.f();}if(!r)return 0;var s=t.replace(/ /g,"_"),c=gU.define({id:NK.length,name:s,props:[JU(Mi({},s,r))]});return NK.push(c),c.id}function HK(e,t){return function(n){var r=n.state,i=n.dispatch;if(r.readOnly)return !1;var o=e(t,r);return !!o&&(i(r.update(o)),!0)}}var UK=HK(XK,0),JK=HK(YK,0),KK=HK((function(e,t){return YK(e,t,function(e){var t,n=[],r=wi(e.selection.ranges);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=e.doc.lineAt(i.from),a=i.to<=o.to?o:e.doc.lineAt(i.to),s=n.length-1;s>=0&&n[s].to>o.from?n[s].to=a.to:n.push({from:o.from+/^\s*/.exec(o.text)[0].length,to:a.to});}}catch(e){r.e(e);}finally{r.f();}return n}(t))}),0);function GK(e,t){var n=e.languageDataAt("commentTokens",t);return n.length?n[0]:{}}function QK(e,t,n,r){var i,o,a=t.open,s=t.close,c=e.sliceDoc(n-50,n),u=e.sliceDoc(r,r+50),l=/\s*$/.exec(c)[0].length,f=/^\s*/.exec(u)[0].length,h=c.length-l;if(c.slice(h-a.length,h)==a&&u.slice(f,f+s.length)==s)return {open:{pos:n-l,margin:l&&1},close:{pos:r+f,margin:f&&1}};r-n<=100?i=o=e.sliceDoc(n,r):(i=e.sliceDoc(n,n+50),o=e.sliceDoc(r-50,r));var d=/^\s*/.exec(i)[0].length,v=/\s*$/.exec(o)[0].length,p=o.length-v-s.length;return i.slice(d,d+a.length)==a&&o.slice(p,p+s.length)==s?{open:{pos:n+d+a.length,margin:/\s/.test(i.charAt(d+a.length))?1:0},close:{pos:r-v-s.length,margin:/\s/.test(o.charAt(p-1))?1:0}}:null}function YK(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.selection.ranges,r=n.map((function(e){return GK(t,e.from).block}));if(!r.every((function(e){return e})))return null;var i=n.map((function(e,n){return QK(t,r[n],e.from,e.to)}));if(2!=e&&!i.every((function(e){return e})))return {changes:t.changes(n.map((function(e,t){return i[t]?[]:[{from:e.from,insert:r[t].open+" "},{from:e.to,insert:" "+r[t].close}]})))};if(1!=e&&i.some((function(e){return e}))){for(var o,a=[],s=0;s<i.length;s++)if(o=i[s]){var c=r[s],u=o,l=u.open,f=u.close;a.push({from:l.pos-c.open.length,to:l.pos+l.margin},{from:f.pos-f.margin,to:f.pos+c.close.length});}return {changes:a}}return null}function XK(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.selection.ranges,i=[],o=-1,a=wi(r);try{for(a.s();!(n=a.n()).done;){var s=n.value,c=s.from,u=s.to,l=i.length,f=1e9,h=GK(t,c).line;if(h){for(var d=c;d<=u;){var v=t.doc.lineAt(d);if(v.from>o&&(c==u||u>v.from)){o=v.from;var p=/^\s*/.exec(v.text)[0].length,m=p==v.length,g=v.text.slice(p,p+h.length)==h?p:-1;p<v.text.length&&p<f&&(f=p),i.push({line:v,comment:g,token:h,indent:p,empty:m,single:!1});}d=v.to+1;}if(f<1e9)for(var y=l;y<i.length;y++)i[y].indent<i[y].line.text.length&&(i[y].indent=f);i.length==l+1&&(i[l].single=!0);}}}catch(e){a.e(e);}finally{a.f();}if(2!=e&&i.some((function(e){return e.comment<0&&(!e.empty||e.single)}))){var b,w=[],x=wi(i);try{for(x.s();!(b=x.n()).done;){var k=b.value,j=k.line,S=k.token,C=k.indent,$=k.empty,_=k.single;!_&&$||w.push({from:j.from+C,insert:S+" "});}}catch(e){x.e(e);}finally{x.f();}var O=t.changes(w);return {changes:O,selection:t.selection.map(O,1)}}if(1!=e&&i.some((function(e){return e.comment>=0}))){var M,E=[],A=wi(i);try{for(A.s();!(M=A.n()).done;){var P=M.value,T=P.line,R=P.comment,N=P.token;if(R>=0){var I=T.from+R,D=I+N.length;" "==T.text[D-T.from]&&D++,E.push({from:I,to:D});}}}catch(e){A.e(e);}finally{A.f();}return {changes:E}}return null}var ZK=zB.define(),eG=zB.define(),tG=vB.define(),nG=vB.define({combine:function(e){return nz(e,{minDepth:100,newGroupDelay:500,joinToEvent:function(e,t){return t}},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:function(e,t){return function(n,r){return e(n,r)||t(n,r)}}})}});var rG=wB.define({create:function(){return kG.empty},update:function(e,t){var n,r,i=t.state.facet(nG),o=t.annotation(ZK);if(o){var a=t.docChanged?fB.single((n=t.changes,r=0,n.iterChangedRanges((function(e,t){return r=t})),r)):void 0,s=dG.fromTransaction(t,a),c=o.side,u=0==c?e.undone:e.done;return u=s?vG(u,u.length,i.minDepth,s):gG(u,t.startState.selection),new kG(0==c?o.rest:u,0==c?u:o.rest)}var l=t.annotation(eG);if("full"!=l&&"before"!=l||(e=e.isolate()),!1===t.annotation(WB.addToHistory))return t.changes.empty?e:e.addMapping(t.changes.desc);var f=dG.fromTransaction(t),h=t.annotation(WB.time),d=t.annotation(WB.userEvent);return f?e=e.addChanges(f,h,d,i,t):t.selection&&(e=e.addSelection(t.startState.selection,h,d,i.newGroupDelay)),"full"!=l&&"after"!=l||(e=e.isolate()),e},toJSON:function(e){return {done:e.done.map((function(e){return e.toJSON()})),undone:e.undone.map((function(e){return e.toJSON()}))}},fromJSON:function(e){return new kG(e.done.map(dG.fromJSON),e.undone.map(dG.fromJSON))}});function iG(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return [rG,nG.of(e),jW.domEventHandlers({beforeinput:function(e,t){var n="historyUndo"==e.inputType?aG:"historyRedo"==e.inputType?sG:null;return !!n&&(e.preventDefault(),n(t))}})]}function oG(e,t){return function(n){var r=n.state,i=n.dispatch;if(!t&&r.readOnly)return !1;var o=r.field(rG,!1);if(!o)return !1;var a=o.pop(e,r,t);return !!a&&(i(a),!0)}}var aG=oG(0,!1),sG=oG(1,!1),cG=oG(0,!0),uG=oG(1,!0);function lG(e){return function(t){var n=t.field(rG,!1);if(!n)return 0;var r=0==e?n.done:n.undone;return r.length-(r.length&&!r[0].changes?1:0)}}var fG=lG(0),hG=lG(1),dG=function(){function e(t,n,r,i,o){Bi(this,e),this.changes=t,this.effects=n,this.mapped=r,this.startSelection=i,this.selectionsAfter=o;}return qi(e,[{key:"setSelAfter",value:function(t){return new e(this.changes,this.effects,this.mapped,this.startSelection,t)}},{key:"toJSON",value:function(){var e,t,n;return {changes:null===(e=this.changes)||void 0===e?void 0:e.toJSON(),mapped:null===(t=this.mapped)||void 0===t?void 0:t.toJSON(),startSelection:null===(n=this.startSelection)||void 0===n?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map((function(e){return e.toJSON()}))}}}],[{key:"fromJSON",value:function(t){return new e(t.changes&&rB.fromJSON(t.changes),[],t.mapped&&nB.fromJSON(t.mapped),t.startSelection&&fB.fromJSON(t.startSelection),t.selectionsAfter.map(fB.fromJSON))}},{key:"fromTransaction",value:function(t,n){var r,i=mG,o=wi(t.startState.facet(tG));try{for(o.s();!(r=o.n()).done;){var a=(0,r.value)(t);a.length&&(i=i.concat(a));}}catch(e){o.e(e);}finally{o.f();}return !i.length&&t.changes.empty?null:new e(t.changes.invert(t.startState.doc),i,void 0,n||t.startState.selection,mG)}},{key:"selection",value:function(t){return new e(void 0,mG,void 0,void 0,t)}}]),e}();function vG(e,t,n,r){var i=t+1>n+20?t-n-1:0,o=e.slice(i,t);return o.push(r),o}function pG(e,t){return e.length?t.length?e.concat(t):e:t}var mG=[];function gG(e,t){if(e.length){var n=e[e.length-1],r=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-200));return r.length&&r[r.length-1].eq(t)?e:(r.push(t),vG(e,e.length-1,1e9,n.setSelAfter(r)))}return [dG.selection([t])]}function yG(e){var t=e[e.length-1],n=e.slice();return n[e.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),n}function bG(e,t){if(!e.length)return e;for(var n=e.length,r=mG;n;){var i=wG(e[n-1],t,r);if(i.changes&&!i.changes.empty||i.effects.length){var o=e.slice(0,n);return o[n-1]=i,o}t=i.mapped,n--,r=i.selectionsAfter;}return r.length?[dG.selection(r)]:mG}function wG(e,t,n){var r=pG(e.selectionsAfter.length?e.selectionsAfter.map((function(e){return e.map(t)})):mG,n);if(!e.changes)return dG.selection(r);var i=e.changes.map(t),o=t.mapDesc(e.changes,!0),a=e.mapped?e.mapped.composeDesc(o):o;return new dG(i,VB.mapEffects(e.effects,t),a,e.startSelection.map(o),r)}var xG=/^(input\.type|delete)($|\.)/,kG=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;Bi(this,e),this.done=t,this.undone=n,this.prevTime=r,this.prevUserEvent=i;}return qi(e,[{key:"isolate",value:function(){return this.prevTime?new e(this.done,this.undone):this}},{key:"addChanges",value:function(t,n,r,i,o){var a=this.done,s=a[a.length-1];return a=s&&s.changes&&!s.changes.empty&&t.changes&&(!r||xG.test(r))&&(!s.selectionsAfter.length&&n-this.prevTime<i.newGroupDelay&&i.joinToEvent(o,function(e,t){var n=[],r=!1;return e.iterChangedRanges((function(e,t){return n.push(e,t)})),t.iterChangedRanges((function(e,t,i,o){for(var a=0;a<n.length;){var s=n[a++],c=n[a++];o>=s&&i<=c&&(r=!0);}})),r}(s.changes,t.changes))||"input.type.compose"==r)?vG(a,a.length-1,i.minDepth,new dG(t.changes.compose(s.changes),pG(t.effects,s.effects),s.mapped,s.startSelection,mG)):vG(a,a.length,i.minDepth,t),new e(a,mG,n,r)}},{key:"addSelection",value:function(t,n,r,i){var o=this.done.length?this.done[this.done.length-1].selectionsAfter:mG;return o.length>0&&n-this.prevTime<i&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&function(e,t){return e.ranges.length==t.ranges.length&&0===e.ranges.filter((function(e,n){return e.empty!=t.ranges[n].empty})).length}(o[o.length-1],t)?this:new e(gG(this.done,t),this.undone,n,r)}},{key:"addMapping",value:function(t){return new e(bG(this.done,t),bG(this.undone,t),this.prevTime,this.prevUserEvent)}},{key:"pop",value:function(e,t,n){var r=0==e?this.done:this.undone;if(0==r.length)return null;var i=r[r.length-1];if(n&&i.selectionsAfter.length)return t.update({selection:i.selectionsAfter[i.selectionsAfter.length-1],annotations:ZK.of({side:e,rest:yG(r)}),userEvent:0==e?"select.undo":"select.redo",scrollIntoView:!0});if(i.changes){var o=1==r.length?mG:r.slice(0,r.length-1);return i.mapped&&(o=bG(o,i.mapped)),t.update({changes:i.changes,selection:i.startSelection,effects:i.effects,annotations:ZK.of({side:e,rest:o}),filter:!1,userEvent:0==e?"undo":"redo",scrollIntoView:!0})}return null}}]),e}();kG.empty=new kG(mG,mG);var jG=[{key:"Mod-z",run:aG,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:sG,preventDefault:!0},{linux:"Ctrl-Shift-z",run:sG,preventDefault:!0},{key:"Mod-u",run:cG,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:uG,preventDefault:!0}];function SG(e,t){return fB.create(e.ranges.map(t),e.mainIndex)}function CG(e,t){return e.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function $G(e,t){var n=e.state,r=e.dispatch,i=SG(n.selection,t);return !i.eq(n.selection)&&(r(CG(n,i)),!0)}function _G(e,t){return fB.cursor(t?e.to:e.from)}function OG(e,t){return $G(e,(function(n){return n.empty?e.moveByChar(n,t):_G(n,t)}))}function MG(e){return e.textDirectionAt(e.state.selection.main.head)==bF.LTR}var EG=function(e){return OG(e,!MG(e))},AG=function(e){return OG(e,MG(e))};function PG(e,t){return $G(e,(function(n){return n.empty?e.moveByGroup(n,t):_G(n,t)}))}function TG(e,t,n){if(t.type.prop(n))return !0;var r=t.to-t.from;return r&&(r>2||/[^\s,.;:]/.test(e.sliceDoc(t.from,t.to)))||t.firstChild}function RG(e,t,n){for(var r=kJ(e).resolveInner(t.head),i=n?pU.closedBy:pU.openedBy,o=t.head;;){var a=n?r.childAfter(o):r.childBefore(o);if(!a)break;TG(e,a,i)?r=a:o=n?a.to:a.from;}var s,c;return c=r.type.prop(i)&&(s=n?AK(e,r.from,1):AK(e,r.to,-1))&&s.matched?n?s.end.to:s.end.from:n?r.to:r.from,fB.cursor(c,n?-1:1)}function NG(e,t){return $G(e,(function(n){if(!n.empty)return _G(n,t);var r=e.moveVertically(n,t);return r.head!=n.head?r:e.moveToLineBoundary(n,t)}))}var IG=function(e){return NG(e,!1)},DG=function(e){return NG(e,!0)};function LG(e){var t,n=e.scrollDOM.clientHeight<e.scrollDOM.scrollHeight-2,r=0,i=0;if(n){var o,a=wi(e.state.facet(jW.scrollMargins));try{for(a.s();!(o=a.n()).done;){var s=(0,o.value)(e);(null==s?void 0:s.top)&&(r=Math.max(null==s?void 0:s.top,r)),(null==s?void 0:s.bottom)&&(i=Math.max(null==s?void 0:s.bottom,i));}}catch(e){a.e(e);}finally{a.f();}t=e.scrollDOM.clientHeight-r-i;}else t=(e.dom.ownerDocument.defaultView||window).innerHeight;return {marginTop:r,marginBottom:i,selfScroll:n,height:Math.max(e.defaultLineHeight,t-5)}}function BG(e,t){var n,r=LG(e),i=e.state,o=SG(i.selection,(function(n){return n.empty?e.moveVertically(n,t,r.height):_G(n,t)}));if(o.eq(i.selection))return !1;if(r.selfScroll){var a=e.coordsAtPos(i.selection.main.head),s=e.scrollDOM.getBoundingClientRect(),c=s.top+r.marginTop,u=s.bottom-r.marginBottom;a&&a.top>c&&a.bottom<u&&(n=jW.scrollIntoView(o.main.head,{y:"start",yMargin:a.top-c}));}return e.dispatch(CG(i,o),{effects:n}),!0}var zG=function(e){return BG(e,!1)},qG=function(e){return BG(e,!0)};function FG(e,t,n){var r=e.lineBlockAt(t.head),i=e.moveToLineBoundary(t,n);if(i.head==t.head&&i.head!=(n?r.to:r.from)&&(i=e.moveToLineBoundary(t,n,!1)),!n&&i.head==r.from&&r.length){var o=/^\s*/.exec(e.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;o&&t.head!=r.from+o&&(i=fB.cursor(r.from+o));}return i}function VG(e,t){var n=SG(e.state.selection,(function(e){var n=t(e);return fB.range(e.anchor,n.head,n.goalColumn,n.bidiLevel||void 0)}));return !n.eq(e.state.selection)&&(e.dispatch(CG(e.state,n)),!0)}function WG(e,t){return VG(e,(function(n){return e.moveByChar(n,t)}))}var HG=function(e){return WG(e,!MG(e))},UG=function(e){return WG(e,MG(e))};function JG(e,t){return VG(e,(function(n){return e.moveByGroup(n,t)}))}function KG(e,t){return VG(e,(function(n){return e.moveVertically(n,t)}))}var GG=function(e){return KG(e,!1)},QG=function(e){return KG(e,!0)};function YG(e,t){return VG(e,(function(n){return e.moveVertically(n,t,LG(e).height)}))}var XG=function(e){return YG(e,!1)},ZG=function(e){return YG(e,!0)},eQ=function(e){var t=e.state;return (0, e.dispatch)(CG(t,{anchor:0})),!0},tQ=function(e){var t=e.state;return (0, e.dispatch)(CG(t,{anchor:t.doc.length})),!0},nQ=function(e){var t=e.state;return (0, e.dispatch)(CG(t,{anchor:t.selection.main.anchor,head:0})),!0},rQ=function(e){var t=e.state;return (0, e.dispatch)(CG(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0};function iQ(e,t){if(e.state.readOnly)return !1;var n="delete.selection",r=e.state,i=r.changeByRange((function(r){var i=r.from,o=r.to;if(i==o){var a=t(i);a<i?(n="delete.backward",a=oQ(e,a,!1)):a>i&&(n="delete.forward",a=oQ(e,a,!0)),i=Math.min(i,a),o=Math.max(o,a);}else i=oQ(e,i,!1),o=oQ(e,o,!0);return i==o?{range:r}:{changes:{from:i,to:o},range:fB.cursor(i)}}));return !i.changes.empty&&(e.dispatch(r.update(i,{scrollIntoView:!0,userEvent:n,effects:"delete.selection"==n?jW.announce.of(r.phrase("Selection deleted")):void 0})),!0)}function oQ(e,t,n){if(e instanceof jW){var r,i=wi(e.state.facet(jW.atomicRanges).map((function(t){return t(e)})));try{for(i.s();!(r=i.n()).done;){r.value.between(t,t,(function(e,r){e<t&&r>t&&(t=n?r:e);}));}}catch(e){i.e(e);}finally{i.f();}}return t}var aQ=function(e,t){return iQ(e,(function(n){var r,i,o=e.state,a=o.doc.lineAt(n);if(!t&&n>a.from&&n<a.from+200&&!/[^ \t]/.test(r=a.text.slice(0,n-a.from))){if("\t"==r[r.length-1])return n-1;for(var s=wz(r,o.tabSize)%NJ(o)||NJ(o),c=0;c<s&&" "==r[r.length-1-c];c++)n--;i=n;}else (i=UL(a.text,n-a.from,t,t)+a.from)==n&&a.number!=(t?o.doc.lines:1)&&(i+=t?1:-1);return i}))},sQ=function(e){return aQ(e,!1)},cQ=function(e){return aQ(e,!0)},uQ=function(e,t){return iQ(e,(function(n){for(var r=n,i=e.state,o=i.doc.lineAt(r),a=i.charCategorizer(r),s=null;;){if(r==(t?o.to:o.from)){r==n&&o.number!=(t?i.doc.lines:1)&&(r+=t?1:-1);break}var c=UL(o.text,r-o.from,t)+o.from,u=o.text.slice(Math.min(r,c)-o.from,Math.max(r,c)-o.from),l=a(u);if(null!=s&&l!=s)break;" "==u&&r==n||(s=l),r=c;}return r}))},lQ=function(e){return uQ(e,!1)},fQ=function(e){return iQ(e,(function(t){var n=e.lineBlockAt(t).to;return t<n?n:Math.min(e.state.doc.length,t+1)}))};function hQ(e){var t,n=[],r=-1,i=wi(e.selection.ranges);try{for(i.s();!(t=i.n()).done;){var o=t.value,a=e.doc.lineAt(o.from),s=e.doc.lineAt(o.to);if(o.empty||o.to!=s.from||(s=e.doc.lineAt(o.to-1)),r>=a.number){var c=n[n.length-1];c.to=s.to,c.ranges.push(o);}else n.push({from:a.from,to:s.to,ranges:[o]});r=s.number+1;}}catch(e){i.e(e);}finally{i.f();}return n}function dQ(e,t,n){if(e.readOnly)return !1;var r,i=[],o=[],a=wi(hQ(e));try{for(a.s();!(r=a.n()).done;){var s=r.value;if(n?s.to!=e.doc.length:0!=s.from){var c=e.doc.lineAt(n?s.to+1:s.from-1),u=c.length+1;if(n){i.push({from:s.to,to:c.to},{from:s.from,insert:c.text+e.lineBreak});var l,f=wi(s.ranges);try{for(f.s();!(l=f.n()).done;){var h=l.value;o.push(fB.range(Math.min(e.doc.length,h.anchor+u),Math.min(e.doc.length,h.head+u)));}}catch(e){f.e(e);}finally{f.f();}}else {i.push({from:c.from,to:s.from},{from:s.to,insert:e.lineBreak+c.text});var d,v=wi(s.ranges);try{for(v.s();!(d=v.n()).done;){var p=d.value;o.push(fB.range(p.anchor-u,p.head-u));}}catch(e){v.e(e);}finally{v.f();}}}}}catch(e){a.e(e);}finally{a.f();}return !!i.length&&(t(e.update({changes:i,scrollIntoView:!0,selection:fB.create(o,e.selection.mainIndex),userEvent:"move.line"})),!0)}function vQ(e,t,n){if(e.readOnly)return !1;var r,i=[],o=wi(hQ(e));try{for(o.s();!(r=o.n()).done;){var a=r.value;n?i.push({from:a.from,insert:e.doc.slice(a.from,a.to)+e.lineBreak}):i.push({from:a.to,insert:e.lineBreak+e.doc.slice(a.from,a.to)});}}catch(e){o.e(e);}finally{o.f();}return t(e.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}var pQ=gQ(!1),mQ=gQ(!0);function gQ(e){return function(t){var n=t.state,r=t.dispatch;if(n.readOnly)return !1;var i=n.changeByRange((function(t){var r=t.from,i=t.to,o=n.doc.lineAt(r),a=!e&&r==i&&function(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return {from:t,to:t};var n,r=kJ(e).resolveInner(t),i=r.childBefore(t),o=r.childAfter(t);return i&&o&&i.to<=t&&o.from>=t&&(n=i.type.prop(pU.closedBy))&&n.indexOf(o.name)>-1&&e.doc.lineAt(i.to).from==e.doc.lineAt(o.from).from?{from:i.to,to:o.from}:null}(n,r);e&&(r=i=(i<=o.to?o:n.doc.lineAt(i)).to);var s=new LJ(n,{simulateBreak:r,simulateDoubleBreak:!!a}),c=DJ(s,r);for(null==c&&(c=/^\s*/.exec(n.doc.lineAt(r).text)[0].length);i<o.to&&/\s/.test(o.text[i-o.from]);)i++;a?(r=a.from,i=a.to):r>o.from&&r<o.from+100&&!/\S/.test(o.text.slice(0,r))&&(r=o.from);var u=["",IJ(n,c)];return a&&u.push(IJ(n,s.lineIndent(o.from,-1))),{changes:{from:r,to:i,insert:PL.of(u)},range:fB.cursor(r+1+u[1].length)}}));return r(n.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function yQ(e,t){var n=-1;return e.changeByRange((function(r){for(var i=[],o=r.from;o<=r.to;){var a=e.doc.lineAt(o);a.number>n&&(r.empty||r.to>a.from)&&(t(a,i,r),n=a.number),o=a.to+1;}var s=e.changes(i);return {changes:i,range:fB.range(s.mapPos(r.anchor,1),s.mapPos(r.head,1))}}))}var bQ=function(e){var t=e.state,n=e.dispatch;return !t.readOnly&&(n(t.update(yQ(t,(function(e,n){n.push({from:e.from,insert:t.facet(RJ)});})),{userEvent:"input.indent"})),!0)},wQ=function(e){var t=e.state,n=e.dispatch;return !t.readOnly&&(n(t.update(yQ(t,(function(e,n){var r=/^\s*/.exec(e.text)[0];if(r){for(var i=wz(r,t.tabSize),o=0,a=IJ(t,Math.max(0,i-NJ(t)));o<r.length&&o<a.length&&r.charCodeAt(o)==a.charCodeAt(o);)o++;n.push({from:e.from+o,to:e.from+r.length,insert:a.slice(o)});}})),{userEvent:"delete.dedent"})),!0)},xQ=[{key:"Ctrl-b",run:EG,shift:HG,preventDefault:!0},{key:"Ctrl-f",run:AG,shift:UG},{key:"Ctrl-p",run:IG,shift:GG},{key:"Ctrl-n",run:DG,shift:QG},{key:"Ctrl-a",run:function(e){return $G(e,(function(t){return fB.cursor(e.lineBlockAt(t.head).from,1)}))},shift:function(e){return VG(e,(function(t){return fB.cursor(e.lineBlockAt(t.head).from)}))}},{key:"Ctrl-e",run:function(e){return $G(e,(function(t){return fB.cursor(e.lineBlockAt(t.head).to,-1)}))},shift:function(e){return VG(e,(function(t){return fB.cursor(e.lineBlockAt(t.head).to)}))}},{key:"Ctrl-d",run:cQ},{key:"Ctrl-h",run:sQ},{key:"Ctrl-k",run:fQ},{key:"Ctrl-Alt-h",run:lQ},{key:"Ctrl-o",run:function(e){var t=e.state,n=e.dispatch;if(t.readOnly)return !1;var r=t.changeByRange((function(e){return {changes:{from:e.from,to:e.to,insert:PL.of(["",""])},range:fB.cursor(e.from)}}));return n(t.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:function(e){var t=e.state,n=e.dispatch;if(t.readOnly)return !1;var r=t.changeByRange((function(e){if(!e.empty||0==e.from||e.from==t.doc.length)return {range:e};var n=e.from,r=t.doc.lineAt(n),i=n==r.from?n-1:UL(r.text,n-r.from,!1)+r.from,o=n==r.to?n+1:UL(r.text,n-r.from,!0)+r.from;return {changes:{from:i,to:o,insert:t.doc.slice(n,o).append(t.doc.slice(i,n))},range:fB.cursor(o)}}));return !r.changes.empty&&(n(t.update(r,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:qG}],kQ=[{key:"ArrowLeft",run:EG,shift:HG,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:function(e){return PG(e,!MG(e))},shift:function(e){return JG(e,!MG(e))},preventDefault:!0},{mac:"Cmd-ArrowLeft",run:function(e){return $G(e,(function(t){return FG(e,t,!MG(e))}))},shift:function(e){return VG(e,(function(t){return FG(e,t,!MG(e))}))},preventDefault:!0},{key:"ArrowRight",run:AG,shift:UG,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:function(e){return PG(e,MG(e))},shift:function(e){return JG(e,MG(e))},preventDefault:!0},{mac:"Cmd-ArrowRight",run:function(e){return $G(e,(function(t){return FG(e,t,MG(e))}))},shift:function(e){return VG(e,(function(t){return FG(e,t,MG(e))}))},preventDefault:!0},{key:"ArrowUp",run:IG,shift:GG,preventDefault:!0},{mac:"Cmd-ArrowUp",run:eQ,shift:nQ},{mac:"Ctrl-ArrowUp",run:zG,shift:XG},{key:"ArrowDown",run:DG,shift:QG,preventDefault:!0},{mac:"Cmd-ArrowDown",run:tQ,shift:rQ},{mac:"Ctrl-ArrowDown",run:qG,shift:ZG},{key:"PageUp",run:zG,shift:XG},{key:"PageDown",run:qG,shift:ZG},{key:"Home",run:function(e){return $G(e,(function(t){return FG(e,t,!1)}))},shift:function(e){return VG(e,(function(t){return FG(e,t,!1)}))},preventDefault:!0},{key:"Mod-Home",run:eQ,shift:nQ},{key:"End",run:function(e){return $G(e,(function(t){return FG(e,t,!0)}))},shift:function(e){return VG(e,(function(t){return FG(e,t,!0)}))},preventDefault:!0},{key:"Mod-End",run:tQ,shift:rQ},{key:"Enter",run:pQ},{key:"Mod-a",run:function(e){var t=e.state;return (0, e.dispatch)(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0}},{key:"Backspace",run:sQ,shift:sQ},{key:"Delete",run:cQ},{key:"Mod-Backspace",mac:"Alt-Backspace",run:lQ},{key:"Mod-Delete",mac:"Alt-Delete",run:function(e){return uQ(e,!0)}},{mac:"Mod-Backspace",run:function(e){return iQ(e,(function(t){var n=e.lineBlockAt(t).from;return t>n?n:Math.max(0,t-1)}))}},{mac:"Mod-Delete",run:fQ}].concat(xQ.map((function(e){return {mac:e.key,run:e.run,shift:e.shift}}))),jQ=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:function(e){return $G(e,(function(t){return RG(e.state,t,!MG(e))}))},shift:function(e){return VG(e,(function(t){return RG(e.state,t,!MG(e))}))}},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:function(e){return $G(e,(function(t){return RG(e.state,t,MG(e))}))},shift:function(e){return VG(e,(function(t){return RG(e.state,t,MG(e))}))}},{key:"Alt-ArrowUp",run:function(e){return dQ(e.state,e.dispatch,!1)}},{key:"Shift-Alt-ArrowUp",run:function(e){return vQ(e.state,e.dispatch,!1)}},{key:"Alt-ArrowDown",run:function(e){return dQ(e.state,e.dispatch,!0)}},{key:"Shift-Alt-ArrowDown",run:function(e){return vQ(e.state,e.dispatch,!0)}},{key:"Escape",run:function(e){var t=e.state,n=e.dispatch,r=t.selection,i=null;return r.ranges.length>1?i=fB.create([r.main]):r.main.empty||(i=fB.create([fB.cursor(r.main.head)])),!!i&&(n(CG(t,i)),!0)}},{key:"Mod-Enter",run:mQ},{key:"Alt-l",mac:"Ctrl-l",run:function(e){var t=e.state,n=e.dispatch,r=hQ(t).map((function(e){var n=e.from,r=e.to;return fB.range(n,Math.min(r+1,t.doc.length))}));return n(t.update({selection:fB.create(r),userEvent:"select"})),!0}},{key:"Mod-i",run:function(e){var t=e.state,n=e.dispatch,r=SG(t.selection,(function(e){for(var n,r=kJ(t).resolveInner(e.head,1);!(r.from<e.from&&r.to>=e.to||r.to>e.to&&r.from<=e.from)&&(null===(n=r.parent)||void 0===n?void 0:n.parent);)r=r.parent;return fB.range(r.to,r.from)}));return n(CG(t,r)),!0},preventDefault:!0},{key:"Mod-[",run:wQ},{key:"Mod-]",run:bQ},{key:"Mod-Alt-\\",run:function(e){var t=e.state,n=e.dispatch;if(t.readOnly)return !1;var r=Object.create(null),i=new LJ(t,{overrideIndentation:function(e){var t=r[e];return null==t?-1:t}}),o=yQ(t,(function(e,n,o){var a=DJ(i,e.from);if(null!=a){/\S/.test(e.text)||(a=0);var s=/^\s*/.exec(e.text)[0],c=IJ(t,a);(s!=c||o.from<e.from+s.length)&&(r[e.from]=a,n.push({from:e.from,to:e.from+s.length,insert:c}));}}));return o.changes.empty||n(t.update(o,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:function(e){if(e.state.readOnly)return !1;var t=e.state,n=t.changes(hQ(t).map((function(e){var n=e.from,r=e.to;return n>0?n--:r<t.doc.length&&r++,{from:n,to:r}}))),r=SG(t.selection,(function(t){return e.moveVertically(t,!0)})).map(n);return e.dispatch({changes:n,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:function(e){return function(e,t,n){var r=!1,i=SG(e.selection,(function(t){var i=AK(e,t.head,-1)||AK(e,t.head,1)||t.head>0&&AK(e,t.head-1,1)||t.head<e.doc.length&&AK(e,t.head+1,-1);if(!i||!i.end)return t;r=!0;var o=i.start.from==t.head?i.end.to:i.end.from;return n?fB.range(t.anchor,o):fB.cursor(o)}));return !!r&&(t(CG(e,i)),!0)}(e.state,e.dispatch,!1)}},{key:"Mod-/",run:function(e){var t=e.state,n=t.doc.lineAt(t.selection.main.from),r=GK(e.state,n.from);return r.line?UK(e):!!r.block&&KK(e)}},{key:"Alt-A",run:JK}].concat(kQ),SQ={key:"Tab",run:bQ,shift:wQ};function CQ(){var e=arguments[0];"string"==typeof e&&(e=document.createElement(e));var t=1,n=arguments[1];if(n&&"object"==Ji(n)&&null==n.nodeType&&!Array.isArray(n)){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var i=n[r];"string"==typeof i?e.setAttribute(r,i):null!=i&&(e[r]=i);}t++;}for(;t<arguments.length;t++)$Q(e,arguments[t]);return e}function $Q(e,t){if("string"==typeof t)e.appendChild(document.createTextNode(t));else if(null==t);else if(null!=t.nodeType)e.appendChild(t);else {if(!Array.isArray(t))throw new RangeError("Unsupported child node: "+t);for(var n=0;n<t.length;n++)$Q(e,t[n]);}}var _Q="function"==typeof String.prototype.normalize?function(e){return e.normalize("NFKD")}:function(e){return e},OQ=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length,o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;Bi(this,e),this.test=a,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=t.iterRange(r,i),this.bufferStart=r,this.normalize=o?function(e){return o(_Q(e))}:_Q,this.query=this.normalize(n);}return qi(e,[{key:"peek",value:function(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return -1;this.bufferPos=0,this.buffer=this.iter.value;}return YL(this.buffer,this.bufferPos)}},{key:"next",value:function(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}},{key:"nextOverlapping",value:function(){for(;;){var e=this.peek();if(e<0)return this.done=!0,this;var t=XL(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=ZL(e);for(var r=this.normalize(t),i=0,o=n;;i++){var a=r.charCodeAt(i),s=this.match(a,o);if(s)return this.value=s,this;if(i==r.length-1)break;o==n&&i<t.length&&t.charCodeAt(i)==a&&o++;}}}},{key:"match",value:function(e,t){for(var n=null,r=0;r<this.matches.length;r+=2){var i=this.matches[r],o=!1;this.query.charCodeAt(i)==e&&(i==this.query.length-1?n={from:this.matches[r+1],to:t+1}:(this.matches[r]++,o=!0)),o||(this.matches.splice(r,2),r-=2);}return this.query.charCodeAt(0)==e&&(1==this.query.length?n={from:t,to:t+1}:this.matches.push(1,t)),n&&this.test&&!this.test(n.from,n.to,this.buffer,this.bufferPos)&&(n=null),n}}]),e}();"undefined"!=typeof Symbol&&(OQ.prototype[Symbol.iterator]=function(){return this});var MQ={from:-1,to:-1,match:/.*/.exec("")},EQ="gm"+(null==/x/.unicode?"":"u"),AQ=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.length;if(Bi(this,e),this.text=t,this.to=o,this.curLine="",this.done=!1,this.value=MQ,/\\[sWDnr]|\n|\r|\[\^/.test(n))return new RQ(t,n,r,i,o);this.re=new RegExp(n,EQ+((null==r?void 0:r.ignoreCase)?"i":"")),this.test=null==r?void 0:r.test,this.iter=t.iter();var a=t.lineAt(i);this.curLineStart=a.from,this.matchPos=NQ(t,i),this.getLine(this.curLineStart);}return qi(e,[{key:"getLine",value:function(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next());}},{key:"nextLine",value:function(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0);}},{key:"next",value:function(){for(var e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;var t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){var n=this.curLineStart+t.index,r=n+t[0].length;if(this.matchPos=NQ(this.text,r+(n==r?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<r||n>this.value.to)&&(!this.test||this.test(n,r,t)))return this.value={from:n,to:r,match:t},this;e=this.matchPos-this.curLineStart;}else {if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),e=0;}}}}]),e}(),PQ=new WeakMap,TQ=function(){function e(t,n){Bi(this,e),this.from=t,this.text=n;}return qi(e,[{key:"to",get:function(){return this.from+this.text.length}}],[{key:"get",value:function(t,n,r){var i=PQ.get(t);if(!i||i.from>=r||i.to<=n){var o=new e(n,t.sliceString(n,r));return PQ.set(t,o),o}if(i.from==n&&i.to==r)return i;var a=i.text,s=i.from;return s>n&&(a=t.sliceString(n,s)+a,s=n),i.to<r&&(a+=t.sliceString(i.to,r)),PQ.set(t,new e(s,a)),new e(n,a.slice(n-s,r-s))}}]),e}(),RQ=function(){function e(t,n,r,i,o){Bi(this,e),this.text=t,this.to=o,this.done=!1,this.value=MQ,this.matchPos=NQ(t,i),this.re=new RegExp(n,EQ+((null==r?void 0:r.ignoreCase)?"i":"")),this.test=null==r?void 0:r.test,this.flat=TQ.get(t,i,this.chunkEnd(i+5e3));}return qi(e,[{key:"chunkEnd",value:function(e){return e>=this.to?this.to:this.text.lineAt(e).to}},{key:"next",value:function(){for(;;){var e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){var n=this.flat.from+t.index,r=n+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,r,t)))return this.value={from:n,to:r,match:t},this.matchPos=NQ(this.text,r+(n==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=TQ.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length));}}}]),e}();function NQ(e,t){if(t>=e.length)return t;for(var n,r=e.lineAt(t);t<r.to&&(n=r.text.charCodeAt(t-r.from))>=56320&&n<57344;)t++;return t}function IQ(e){var t=CQ("input",{class:"cm-textfield",name:"line"});function n(){var n=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(n){var r=e.state,i=r.doc.lineAt(r.selection.main.head),o=Si(n,5),a=o[1],s=o[2],c=o[3],u=o[4],l=c?+c.slice(1):0,f=s?+s:i.number;if(s&&u){var h=f/100;a&&(h=h*("-"==a?-1:1)+i.number/r.doc.lines),f=Math.round(r.doc.lines*h);}else s&&a&&(f=f*("-"==a?-1:1)+i.number);var d=r.doc.line(Math.max(1,Math.min(r.doc.lines,f)));e.dispatch({effects:DQ.of(!1),selection:fB.cursor(d.from+Math.max(0,Math.min(l,d.length))),scrollIntoView:!0}),e.focus();}}return {dom:CQ("form",{class:"cm-gotoLine",onkeydown:function(t){27==t.keyCode?(t.preventDefault(),e.dispatch({effects:DQ.of(!1)}),e.focus()):13==t.keyCode&&(t.preventDefault(),n());},onsubmit:function(e){e.preventDefault(),n();}},CQ("label",e.state.phrase("Go to line"),": ",t)," ",CQ("button",{class:"cm-button",type:"submit"},e.state.phrase("go")))}}"undefined"!=typeof Symbol&&(AQ.prototype[Symbol.iterator]=RQ.prototype[Symbol.iterator]=function(){return this});var DQ=VB.define(),LQ=wB.define({create:function(){return !0},update:function(e,t){var n,r=wi(t.effects);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.is(DQ)&&(e=i.value);}}catch(e){r.e(e);}finally{r.f();}return e},provide:function(e){return WH.from(e,(function(e){return e?IQ:null}))}}),BQ=jW.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),zQ={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},qQ=vB.define({combine:function(e){return nz(e,zQ,{highlightWordAroundCursor:function(e,t){return e||t},minSelectionLength:Math.min,maxMatches:Math.min})}});var FQ=Dq.mark({class:"cm-selectionMatch"}),VQ=Dq.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function WQ(e,t,n,r){return !(0!=n&&e(t.sliceDoc(n-1,n))==XB.Word||r!=t.doc.length&&e(t.sliceDoc(r,r+1))==XB.Word)}var HQ=uF.fromClass(function(){function e(t){Bi(this,e),this.decorations=this.getDeco(t);}return qi(e,[{key:"update",value:function(e){(e.selectionSet||e.docChanged||e.viewportChanged)&&(this.decorations=this.getDeco(e.view));}},{key:"getDeco",value:function(e){var t=e.state.facet(qQ),n=e.state,r=n.selection;if(r.ranges.length>1)return Dq.none;var i,o=r.main,a=null;if(o.empty){if(!t.highlightWordAroundCursor)return Dq.none;var s=n.wordAt(o.head);if(!s)return Dq.none;a=n.charCategorizer(o.head),i=n.sliceDoc(s.from,s.to);}else {var c=o.to-o.from;if(c<t.minSelectionLength||c>200)return Dq.none;if(t.wholeWords){if(i=n.sliceDoc(o.from,o.to),!WQ(a=n.charCategorizer(o.head),n,o.from,o.to)||!function(e,t,n,r){return e(t.sliceDoc(n,n+1))==XB.Word&&e(t.sliceDoc(r-1,r))==XB.Word}(a,n,o.from,o.to))return Dq.none}else if(!(i=n.sliceDoc(o.from,o.to).trim()))return Dq.none}var u,l=[],f=wi(e.visibleRanges);try{for(f.s();!(u=f.n()).done;)for(var h=u.value,d=new OQ(n.doc,i,h.from,h.to);!d.next().done;){var v=d.value,p=v.from,m=v.to;if((!a||WQ(a,n,p,m))&&(o.empty&&p<=o.from&&m>=o.to?l.push(VQ.range(p,m)):(p>=o.to||m<=o.from)&&l.push(FQ.range(p,m)),l.length>t.maxMatches))return Dq.none}}catch(e){f.e(e);}finally{f.f();}return Dq.set(l)}}]),e}(),{decorations:function(e){return e.decorations}}),UQ=jW.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}});var JQ=vB.define({combine:function(e){return nz(e,{top:!1,caseSensitive:!1,literal:!1,wholeWord:!1,createPanel:function(e){return new jY(e)},scrollToMatch:function(e){return jW.scrollIntoView(e)}})}});function KQ(e){return e?[JQ.of(e),OY]:OY}var GQ=function(){function e(t){Bi(this,e),this.search=t.search,this.caseSensitive=!!t.caseSensitive,this.literal=!!t.literal,this.regexp=!!t.regexp,this.replace=t.replace||"",this.valid=!!this.search&&(!this.regexp||function(e){try{return new RegExp(e,EQ),!0}catch(e){return !1}}(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!t.wholeWord;}return qi(e,[{key:"unquote",value:function(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(function(e,t){return "n"==t?"\n":"r"==t?"\r":"t"==t?"\t":"\\"}))}},{key:"eq",value:function(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}},{key:"create",value:function(){return this.regexp?new nY(this):new XQ(this)}},{key:"getCursor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=e.doc?e:tz.create({doc:e});return null==n&&(n=r.doc.length),this.regexp?ZQ(this,r,t,n):YQ(this,r,t,n)}}]),e}(),QQ=qi((function e(t){Bi(this,e),this.spec=t;}));function YQ(e,t,n,r){return new OQ(t.doc,e.unquoted,n,r,e.caseSensitive?void 0:function(e){return e.toLowerCase()},e.wholeWord?function(e,t){return function(n,r,i,o){return (o>n||o+i.length<r)&&(o=Math.max(0,n-2),i=e.sliceString(o,Math.min(e.length,r+2))),!(t(eY(i,n-o))==XB.Word&&t(tY(i,n-o))==XB.Word||t(tY(i,r-o))==XB.Word&&t(eY(i,r-o))==XB.Word)}}(t.doc,t.charCategorizer(t.selection.main.head)):void 0)}var XQ=function(e){Pi(n,QQ);var t=Ri(n);function n(e){return Bi(this,n),t.call(this,e)}return qi(n,[{key:"nextMatch",value:function(e,t,n){var r=YQ(this.spec,e,n,e.doc.length).nextOverlapping();return r.done&&(r=YQ(this.spec,e,0,t).nextOverlapping()),r.done?null:r.value}},{key:"prevMatchInRange",value:function(e,t,n){for(var r=n;;){for(var i=Math.max(t,r-1e4-this.spec.unquoted.length),o=YQ(this.spec,e,i,r),a=null;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(i==t)return null;r-=1e4;}}},{key:"prevMatch",value:function(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}},{key:"getReplacement",value:function(e){return this.spec.unquote(this.spec.replace)}},{key:"matchAll",value:function(e,t){for(var n=YQ(this.spec,e,0,e.doc.length),r=[];!n.next().done;){if(r.length>=t)return null;r.push(n.value);}return r}},{key:"highlight",value:function(e,t,n,r){for(var i=YQ(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));!i.next().done;)r(i.value.from,i.value.to);}}]),n}();function ZQ(e,t,n,r){return new AQ(t.doc,e.search,{ignoreCase:!e.caseSensitive,test:e.wholeWord?(i=t.charCategorizer(t.selection.main.head),function(e,t,n){return !n[0].length||(i(eY(n.input,n.index))!=XB.Word||i(tY(n.input,n.index))!=XB.Word)&&(i(tY(n.input,n.index+n[0].length))!=XB.Word||i(eY(n.input,n.index+n[0].length))!=XB.Word)}):void 0},n,r);var i;}function eY(e,t){return e.slice(UL(e,t,!1),t)}function tY(e,t){return e.slice(t,UL(e,t))}var nY=function(e){Pi(n,QQ);var t=Ri(n);function n(){return Bi(this,n),t.apply(this,arguments)}return qi(n,[{key:"nextMatch",value:function(e,t,n){var r=ZQ(this.spec,e,n,e.doc.length).next();return r.done&&(r=ZQ(this.spec,e,0,t).next()),r.done?null:r.value}},{key:"prevMatchInRange",value:function(e,t,n){for(var r=1;;r++){for(var i=Math.max(t,n-1e4*r),o=ZQ(this.spec,e,i,n),a=null;!o.next().done;)a=o.value;if(a&&(i==t||a.from>i+10))return a;if(i==t)return null}}},{key:"prevMatch",value:function(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}},{key:"getReplacement",value:function(e){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,(function(t,n){return "$"==n?"$":"&"==n?e.match[0]:"0"!=n&&+n<e.match.length?e.match[n]:t})))}},{key:"matchAll",value:function(e,t){for(var n=ZQ(this.spec,e,0,e.doc.length),r=[];!n.next().done;){if(r.length>=t)return null;r.push(n.value);}return r}},{key:"highlight",value:function(e,t,n,r){for(var i=ZQ(this.spec,e,Math.max(0,t-250),Math.min(n+250,e.doc.length));!i.next().done;)r(i.value.from,i.value.to);}}]),n}(),rY=VB.define(),iY=VB.define(),oY=wB.define({create:function(e){return new aY(gY(e).create(),null)},update:function(e,t){var n,r=wi(t.effects);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.is(rY)?e=new aY(i.value.create(),e.panel):i.is(iY)&&(e=new aY(e.query,i.value?mY:null));}}catch(e){r.e(e);}finally{r.f();}return e},provide:function(e){return WH.from(e,(function(e){return e.panel}))}}),aY=qi((function e(t,n){Bi(this,e),this.query=t,this.panel=n;})),sY=Dq.mark({class:"cm-searchMatch"}),cY=Dq.mark({class:"cm-searchMatch cm-searchMatch-selected"}),uY=uF.fromClass(function(){function e(t){Bi(this,e),this.view=t,this.decorations=this.highlight(t.state.field(oY));}return qi(e,[{key:"update",value:function(e){var t=e.state.field(oY);(t!=e.startState.field(oY)||e.docChanged||e.selectionSet||e.viewportChanged)&&(this.decorations=this.highlight(t));}},{key:"highlight",value:function(e){var t=e.query;if(!e.panel||!t.spec.valid)return Dq.none;for(var n=this.view,r=new uz,i=0,o=n.visibleRanges,a=o.length;i<a;i++){for(var s=o[i],c=s.from,u=s.to;i<a-1&&u>o[i+1].from-500;)u=o[++i].to;t.highlight(n.state,c,u,(function(e,t){var i=n.state.selection.ranges.some((function(n){return n.from==e&&n.to==t}));r.add(e,t,i?cY:sY);}));}return r.finish()}}]),e}(),{decorations:function(e){return e.decorations}});function lY(e){return function(t){var n=t.state.field(oY,!1);return n&&n.query.spec.valid?e(t,n):wY(t)}}var fY=lY((function(e,t){var n=t.query,r=e.state.selection.main.to,i=n.nextMatch(e.state,r,r);if(!i)return !1;var o=fB.single(i.from,i.to),a=e.state.facet(JQ);return e.dispatch({selection:o,effects:[$Y(e,i),a.scrollToMatch(o.main,e)],userEvent:"select.search"}),bY(e),!0})),hY=lY((function(e,t){var n=t.query,r=e.state,i=r.selection.main.from,o=n.prevMatch(r,i,i);if(!o)return !1;var a=fB.single(o.from,o.to),s=e.state.facet(JQ);return e.dispatch({selection:a,effects:[$Y(e,o),s.scrollToMatch(a.main,e)],userEvent:"select.search"}),bY(e),!0})),dY=lY((function(e,t){var n=t.query.matchAll(e.state,1e3);return !(!n||!n.length)&&(e.dispatch({selection:fB.create(n.map((function(e){return fB.range(e.from,e.to)}))),userEvent:"select.search.matches"}),!0)})),vY=lY((function(e,t){var n=t.query,r=e.state,i=r.selection.main,o=i.from,a=i.to;if(r.readOnly)return !1;var s=n.nextMatch(r,o,o);if(!s)return !1;var c,u,l=[],f=[];if(s.from==o&&s.to==a&&(u=r.toText(n.getReplacement(s)),l.push({from:s.from,to:s.to,insert:u}),s=n.nextMatch(r,s.from,s.to),f.push(jW.announce.of(r.phrase("replaced match on line $",r.doc.lineAt(o).number)+"."))),s){var h=0==l.length||l[0].from>=s.to?0:s.to-s.from-u.length;c=fB.single(s.from-h,s.to-h),f.push($Y(e,s)),f.push(r.facet(JQ).scrollToMatch(c.main,e));}return e.dispatch({changes:l,selection:c,effects:f,userEvent:"input.replace"}),!0})),pY=lY((function(e,t){var n=t.query;if(e.state.readOnly)return !1;var r=n.matchAll(e.state,1e9).map((function(e){return {from:e.from,to:e.to,insert:n.getReplacement(e)}}));if(!r.length)return !1;var i=e.state.phrase("replaced $ matches",r.length)+".";return e.dispatch({changes:r,effects:jW.announce.of(i),userEvent:"input.replace.all"}),!0}));function mY(e){return e.state.facet(JQ).createPanel(e)}function gY(e,t){var n,r,i,o,a=e.selection.main,s=a.empty||a.to>a.from+100?"":e.sliceDoc(a.from,a.to);if(t&&!s)return t;var c=e.facet(JQ);return new GQ({search:(null!==(n=null==t?void 0:t.literal)&&void 0!==n?n:c.literal)?s:s.replace(/\n/g,"\\n"),caseSensitive:null!==(r=null==t?void 0:t.caseSensitive)&&void 0!==r?r:c.caseSensitive,literal:null!==(i=null==t?void 0:t.literal)&&void 0!==i?i:c.literal,wholeWord:null!==(o=null==t?void 0:t.wholeWord)&&void 0!==o?o:c.wholeWord})}function yY(e){var t=zH(e,mY);return t&&t.dom.querySelector("[main-field]")}function bY(e){var t=yY(e);t&&t==e.root.activeElement&&t.select();}var wY=function(e){var t=e.state.field(oY,!1);if(t&&t.panel){var n=yY(e);if(n&&n!=e.root.activeElement){var r=gY(e.state,t.query.spec);r.valid&&e.dispatch({effects:rY.of(r)}),n.focus(),n.select();}}else e.dispatch({effects:[iY.of(!0),t?rY.of(gY(e.state,t.query.spec)):VB.appendConfig.of(OY)]});return !0},xY=function(e){var t=e.state.field(oY,!1);if(!t||!t.panel)return !1;var n=zH(e,mY);return n&&n.dom.contains(e.root.activeElement)&&e.focus(),e.dispatch({effects:iY.of(!1)}),!0},kY=[{key:"Mod-f",run:wY,scope:"editor search-panel"},{key:"F3",run:fY,shift:hY,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:fY,shift:hY,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:xY,scope:"editor search-panel"},{key:"Mod-Shift-l",run:function(e){var t=e.state,n=e.dispatch,r=t.selection;if(r.ranges.length>1||r.main.empty)return !1;for(var i=r.main,o=i.from,a=i.to,s=[],c=0,u=new OQ(t.doc,t.sliceDoc(o,a));!u.next().done;){if(s.length>1e3)return !1;u.value.from==o&&(c=s.length),s.push(fB.range(u.value.from,u.value.to));}return n(t.update({selection:fB.create(s,c),userEvent:"select.search.matches"})),!0}},{key:"Alt-g",run:function(e){var t=zH(e,IQ);if(!t){var n=[DQ.of(!0)];null==e.state.field(LQ,!1)&&n.push(VB.appendConfig.of([LQ,BQ])),e.dispatch({effects:n}),t=zH(e,IQ);}return t&&t.dom.querySelector("input").focus(),!0}},{key:"Mod-d",run:function(e){var t=e.state,n=e.dispatch,r=t.selection.ranges;if(r.some((function(e){return e.from===e.to})))return function(e){var t=e.state,n=e.dispatch,r=t.selection,i=fB.create(r.ranges.map((function(e){return t.wordAt(e.head)||fB.cursor(e.head)})),r.mainIndex);return !i.eq(r)&&(n(t.update({selection:i})),!0)}({state:t,dispatch:n});var i=t.sliceDoc(r[0].from,r[0].to);if(t.selection.ranges.some((function(e){return t.sliceDoc(e.from,e.to)!=i})))return !1;var o=function(e,t){for(var n=e.selection,r=n.main,i=n.ranges,o=e.wordAt(r.head),a=o&&o.from==r.from&&o.to==r.to,s=function(n,r){if(r.next(),!r.done){if(n&&i.some((function(e){return e.from==r.value.from})))return c=n,u=r,"continue";if(a){var o=e.wordAt(r.value.from);if(!o||o.from!=r.value.from||o.to!=r.value.to)return c=n,u=r,"continue"}return {v:r.value}}if(n)return {v:null};r=new OQ(e.doc,t,0,Math.max(0,i[i.length-1].from-1)),c=n=!0,u=r;},c=!1,u=new OQ(e.doc,t,i[i.length-1].to);;){var l=s(c,u);if("continue"!==l&&"object"===Ji(l))return l.v}}(t,i);return !!o&&(n(t.update({selection:t.selection.addRange(fB.range(o.from,o.to),!1),effects:jW.scrollIntoView(o.to)})),!0)},preventDefault:!0}],jY=function(){function e(t){var n=this;Bi(this,e),this.view=t;var r=this.query=t.state.field(oY).query.spec;function i(e,t,n){return CQ("button",{class:"cm-button",name:e,onclick:t,type:"button"},n)}this.commit=this.commit.bind(this),this.searchField=CQ("input",{value:r.search,placeholder:SY(t,"Find"),"aria-label":SY(t,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=CQ("input",{value:r.replace,placeholder:SY(t,"Replace"),"aria-label":SY(t,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=CQ("input",{type:"checkbox",name:"case",form:"",checked:r.caseSensitive,onchange:this.commit}),this.reField=CQ("input",{type:"checkbox",name:"re",form:"",checked:r.regexp,onchange:this.commit}),this.wordField=CQ("input",{type:"checkbox",name:"word",form:"",checked:r.wholeWord,onchange:this.commit}),this.dom=CQ("div",{onkeydown:function(e){return n.keydown(e)},class:"cm-search"},[this.searchField,i("next",(function(){return fY(t)}),[SY(t,"next")]),i("prev",(function(){return hY(t)}),[SY(t,"previous")]),i("select",(function(){return dY(t)}),[SY(t,"all")]),CQ("label",null,[this.caseField,SY(t,"match case")]),CQ("label",null,[this.reField,SY(t,"regexp")]),CQ("label",null,[this.wordField,SY(t,"by word")])].concat(Vi(t.state.readOnly?[]:[CQ("br"),this.replaceField,i("replace",(function(){return vY(t)}),[SY(t,"replace")]),i("replaceAll",(function(){return pY(t)}),[SY(t,"replace all")])]),[CQ("button",{name:"close",onclick:function(){return xY(t)},"aria-label":SY(t,"close"),type:"button"},[""])]));}return qi(e,[{key:"commit",value:function(){var e=new GQ({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:rY.of(e)}));}},{key:"keydown",value:function(e){!function(e,t,n){return IW(RW(e.state),t,e,n)}(this.view,e,"search-panel")?13==e.keyCode&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?hY:fY)(this.view)):13==e.keyCode&&e.target==this.replaceField&&(e.preventDefault(),vY(this.view)):e.preventDefault();}},{key:"update",value:function(e){var t,n=wi(e.transactions);try{for(n.s();!(t=n.n()).done;){var r,i=wi(t.value.effects);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.is(rY)&&!o.value.eq(this.query)&&this.setQuery(o.value);}}catch(e){i.e(e);}finally{i.f();}}}catch(e){n.e(e);}finally{n.f();}}},{key:"setQuery",value:function(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord;}},{key:"mount",value:function(){this.searchField.select();}},{key:"pos",get:function(){return 80}},{key:"top",get:function(){return this.view.state.facet(JQ).top}}]),e}();function SY(e,t){return e.state.phrase(t)}var CY=/[\s\.,:;?!]/;function $Y(e,t){var n=t.from,r=t.to,i=e.state.doc.lineAt(n),o=e.state.doc.lineAt(r).to,a=Math.max(i.from,n-30),s=Math.min(o,r+30),c=e.state.sliceDoc(a,s);if(a!=i.from)for(var u=0;u<30;u++)if(!CY.test(c[u+1])&&CY.test(c[u])){c=c.slice(u);break}if(s!=o)for(var l=c.length-1;l>c.length-30;l--)if(!CY.test(c[l-1])&&CY.test(c[l])){c=c.slice(0,l);break}return jW.announce.of("".concat(e.state.phrase("current match"),". ").concat(c," ").concat(e.state.phrase("on line")," ").concat(i.number,"."))}var _Y=jW.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),OY=[oY,$B.lowest(uY),_Y],MY=function(){function e(t,n,r){Bi(this,e),this.state=t,this.pos=n,this.explicit=r,this.abortListeners=[];}return qi(e,[{key:"tokenBefore",value:function(e){for(var t=kJ(this.state).resolveInner(this.pos,-1);t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}},{key:"matchBefore",value:function(e){var t=this.state.doc.lineAt(this.pos),n=Math.max(t.from,this.pos-250),r=t.text.slice(n-t.from,this.pos-t.from),i=r.search(RY(e,!1));return i<0?null:{from:n+i,to:this.pos,text:r.slice(i)}}},{key:"aborted",get:function(){return null==this.abortListeners}},{key:"addEventListener",value:function(e,t){"abort"==e&&this.abortListeners&&this.abortListeners.push(t);}}]),e}();function EY(e){var t=Object.keys(e).join(""),n=/\w/.test(t);return n&&(t=t.replace(/\w/g,"")),"[".concat(n?"\\w":"").concat(t.replace(/[^\w\s]/g,"\\$&"),"]")}function AY(e){var t=e.map((function(e){return "string"==typeof e?{label:e}:e})),n=t.every((function(e){return /^\w+$/.test(e.label)}))?[/\w*$/,/\w+$/]:function(e){var t,n=Object.create(null),r=Object.create(null),i=wi(e);try{for(i.s();!(t=i.n()).done;){var o=t.value.label;n[o[0]]=!0;for(var a=1;a<o.length;a++)r[o[a]]=!0;}}catch(e){i.e(e);}finally{i.f();}var s=EY(n)+EY(r)+"*$";return [new RegExp("^"+s),new RegExp(s)]}(t),r=Si(n,2),i=r[0],o=r[1];return function(e){var n=e.matchBefore(o);return n||e.explicit?{from:n?n.from:e.pos,options:t,validFor:i}:null}}var PY=qi((function e(t,n,r){Bi(this,e),this.completion=t,this.source=n,this.match=r;}));function TY(e){return e.selection.main.head}function RY(e,t){var n,r=e.source,i=t&&"^"!=r[0],o="$"!=r[r.length-1];return i||o?new RegExp("".concat(i?"^":"","(?:").concat(r,")").concat(o?"$":""),null!==(n=e.flags)&&void 0!==n?n:e.ignoreCase?"i":""):e}function NY(e,t){var n=t.completion.apply||t.completion.label,r=t.source;"string"==typeof n?e.dispatch(function(e,t,n,r){return Object.assign(Object.assign({},e.changeByRange((function(i){if(i==e.selection.main)return {changes:{from:n,to:r,insert:t},range:fB.cursor(n+t.length)};var o=r-n;return !i.empty||o&&e.sliceDoc(i.from-o,i.from)!=e.sliceDoc(n,r)?{range:i}:{changes:{from:i.from-o,to:i.from,insert:t},range:fB.cursor(i.from-o+t.length)}}))),{userEvent:"input.complete"})}(e.state,n,r.from,r.to)):n(e,t.completion,r.from,r.to);}var IY=new WeakMap;function DY(e){if(!Array.isArray(e))return e;var t=IY.get(e);return t||IY.set(e,t=AY(e)),t}var LY=function(){function e(t){Bi(this,e),this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(var n=0;n<t.length;){var r=YL(t,n),i=ZL(r);this.chars.push(r);var o=t.slice(n,n+i),a=o.toUpperCase();this.folded.push(YL(a==o?o.toLowerCase():a,0)),n+=i;}this.astral=t.length!=this.chars.length;}return qi(e,[{key:"match",value:function(e){if(0==this.pattern.length)return [0];if(e.length<this.pattern.length)return null;var t=this.chars,n=this.folded,r=this.any,i=this.precise,o=this.byWord;if(1==t.length){var a=YL(e,0);return a==t[0]?[0,0,ZL(a)]:a==n[0]?[-200,0,ZL(a)]:null}var s=e.indexOf(this.pattern);if(0==s)return [0,0,this.pattern.length];var c=t.length,u=0;if(s<0){for(var l=0,f=Math.min(e.length,200);l<f&&u<c;){var h=YL(e,l);h!=t[u]&&h!=n[u]||(r[u++]=l),l+=ZL(h);}if(u<c)return null}for(var d=0,v=0,p=!1,m=0,g=-1,y=-1,b=/[a-z]/.test(e),w=!0,x=0,k=Math.min(e.length,200),j=0;x<k&&v<c;){var S=YL(e,x);s<0&&(d<c&&S==t[d]&&(i[d++]=x),m<c&&(S==t[m]||S==n[m]?(0==m&&(g=x),y=x+1,m++):m=0));var C=void 0,$=S<255?S>=48&&S<=57||S>=97&&S<=122?2:S>=65&&S<=90?1:0:(C=XL(S))!=C.toLowerCase()?1:C!=C.toUpperCase()?2:0;(!x||1==$&&b||0==j&&0!=$)&&(t[v]==S||n[v]==S&&(p=!0)?o[v++]=x:o.length&&(w=!1)),j=$,x+=ZL(S);}return v==c&&0==o[0]&&w?this.result((p?-200:0)-100,o,e):m==c&&0==g?[-200-e.length,0,y]:s>-1?[-700-e.length,s,s+this.pattern.length]:m==c?[-900-e.length,g,y]:v==c?this.result((p?-200:0)-100-700+(w?0:-1100),o,e):2==t.length?null:this.result((r[0]?-700:0)-200-1100,r,e)}},{key:"result",value:function(e,t,n){var r,i=[e-n.length],o=1,a=wi(t);try{for(a.s();!(r=a.n()).done;){var s=r.value,c=s+(this.astral?ZL(YL(n,s)):1);o>1&&i[o-1]==s?i[o-1]=c:(i[o++]=s,i[o++]=c);}}catch(e){a.e(e);}finally{a.f();}return i}}]),e}(),BY=vB.define({combine:function(e){return nz(e,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,optionClass:function(){return ""},aboveCursor:!1,icons:!0,addToOptions:[],compareCompletions:function(e,t){return e.label.localeCompare(t.label)}},{defaultKeymap:function(e,t){return e&&t},closeOnBlur:function(e,t){return e&&t},icons:function(e,t){return e&&t},optionClass:function(e,t){return function(n){return function(e,t){return e?t?e+" "+t:e:t}(e(n),t(n))}},addToOptions:function(e,t){return e.concat(t)}})}});function zY(e,t,n){if(e<=n)return {from:0,to:e};if(t<0&&(t=0),t<=e>>1){var r=Math.floor(t/n);return {from:r*n,to:(r+1)*n}}var i=Math.floor((e-t)/n);return {from:e-(i+1)*n,to:e-i*n}}var qY=function(){function e(t,n){var r=this;Bi(this,e),this.view=t,this.stateField=n,this.info=null,this.placeInfo={read:function(){return r.measureInfo()},write:function(e){return r.positionInfo(e)},key:this};var i=t.state.field(n),o=i.open,a=o.options,s=o.selected,c=t.state.facet(BY);this.optionContent=function(e){var t=e.addToOptions.slice();return e.icons&&t.push({render:function(e){var t,n=document.createElement("div");return n.classList.add("cm-completionIcon"),e.type&&(t=n.classList).add.apply(t,Vi(e.type.split(/\s+/g).map((function(e){return "cm-completionIcon-"+e})))),n.setAttribute("aria-hidden","true"),n},position:20}),t.push({render:function(e,t,n){var r=document.createElement("span");r.className="cm-completionLabel";for(var i=e.label,o=0,a=1;a<n.length;){var s=n[a++],c=n[a++];s>o&&r.appendChild(document.createTextNode(i.slice(o,s)));var u=r.appendChild(document.createElement("span"));u.appendChild(document.createTextNode(i.slice(s,c))),u.className="cm-completionMatchedText",o=c;}return o<i.length&&r.appendChild(document.createTextNode(i.slice(o))),r},position:50},{render:function(e){if(!e.detail)return null;var t=document.createElement("span");return t.className="cm-completionDetail",t.textContent=e.detail,t},position:80}),t.sort((function(e,t){return e.position-t.position})).map((function(e){return e.render}))}(c),this.optionClass=c.optionClass,this.range=zY(a.length,s,c.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.dom.addEventListener("mousedown",(function(e){for(var n,i=e.target;i&&i!=r.dom;i=i.parentNode)if("LI"==i.nodeName&&(n=/-(\d+)$/.exec(i.id))&&+n[1]<a.length)return NY(t,a[+n[1]]),void e.preventDefault()})),this.list=this.dom.appendChild(this.createListBox(a,i.id,this.range)),this.list.addEventListener("scroll",(function(){r.info&&r.view.requestMeasure(r.placeInfo);}));}return qi(e,[{key:"mount",value:function(){this.updateSel();}},{key:"update",value:function(e){e.state.field(this.stateField)!=e.startState.field(this.stateField)&&this.updateSel();}},{key:"positioned",value:function(){this.info&&this.view.requestMeasure(this.placeInfo);}},{key:"updateSel",value:function(){var e=this,t=this.view.state.field(this.stateField),n=t.open;if((n.selected<this.range.from||n.selected>=this.range.to)&&(this.range=zY(n.options.length,n.selected,this.view.state.facet(BY).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(n.options,t.id,this.range)),this.list.addEventListener("scroll",(function(){e.info&&e.view.requestMeasure(e.placeInfo);}))),this.updateSelectedOption(n.selected)){this.info&&(this.info.remove(),this.info=null);var r=n.options[n.selected].completion,i=r.info;if(!i)return;var o="string"==typeof i?document.createTextNode(i):i(r);if(!o)return;"then"in o?o.then((function(n){n&&e.view.state.field(e.stateField,!1)==t&&e.addInfoPane(n);})).catch((function(t){return oF(e.view.state,t,"completion info")})):this.addInfoPane(o);}}},{key:"addInfoPane",value:function(e){var t=this.info=document.createElement("div");t.className="cm-tooltip cm-completionInfo",t.appendChild(e),this.dom.appendChild(t),this.view.requestMeasure(this.placeInfo);}},{key:"updateSelectedOption",value:function(e){for(var t=null,n=this.list.firstChild,r=this.range.from;n;n=n.nextSibling,r++)r==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),t=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return t&&function(e,t){var n=e.getBoundingClientRect(),r=t.getBoundingClientRect();r.top<n.top?e.scrollTop-=n.top-r.top:r.bottom>n.bottom&&(e.scrollTop+=r.bottom-n.bottom);}(this.list,t),t}},{key:"measureInfo",value:function(){var e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;var t=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),r=e.getBoundingClientRect();if(r.top>Math.min(innerHeight,t.bottom)-10||r.bottom<Math.max(0,t.top)+10)return null;var i=Math.max(0,Math.min(r.top,innerHeight-n.height))-t.top,o=this.view.textDirection==bF.RTL,a=t.left,s=innerWidth-t.right;return o&&a<Math.min(n.width,s)?o=!1:!o&&s<Math.min(n.width,a)&&(o=!0),{top:i,left:o}}},{key:"positionInfo",value:function(e){this.info&&(this.info.style.top=(e?e.top:-1e6)+"px",e&&(this.info.classList.toggle("cm-completionInfo-left",e.left),this.info.classList.toggle("cm-completionInfo-right",!e.left)));}},{key:"createListBox",value:function(e,t,n){var r=document.createElement("ul");r.id=t,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions"));for(var i=n.from;i<n.to;i++){var o=e[i],a=o.completion,s=o.match,c=r.appendChild(document.createElement("li"));c.id=t+"-"+i,c.setAttribute("role","option");var u=this.optionClass(a);u&&(c.className=u);var l,f=wi(this.optionContent);try{for(f.s();!(l=f.n()).done;){var h=(0,l.value)(a,this.view.state,s);h&&c.appendChild(h);}}catch(e){f.e(e);}finally{f.f();}}return n.from&&r.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}}]),e}();function FY(e){return 100*(e.boost||0)+(e.apply?10:0)+(e.info?5:0)+(e.type?1:0)}var VY=function(){function e(t,n,r,i,o){Bi(this,e),this.options=t,this.attrs=n,this.tooltip=r,this.timestamp=i,this.selected=o;}return qi(e,[{key:"setSelected",value:function(t,n){return t==this.selected||t>=this.options.length?this:new e(this.options,UY(n,t),this.tooltip,this.timestamp,t)}},{key:"map",value:function(t){return new e(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:t.mapPos(this.tooltip.pos)}),this.timestamp,this.selected)}}],[{key:"build",value:function(t,n,r,i,o){var a=function(e,t){var n,r=[],i=0,o=wi(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(a.hasResult())if(!1===a.result.filter){var s,c=a.result.getMatch,u=wi(a.result.options);try{for(u.s();!(s=u.n()).done;){var l=s.value,f=[1e9-i++];if(c){var h,d=wi(c(l));try{for(d.s();!(h=d.n()).done;){var v=h.value;f.push(v);}}catch(e){d.e(e);}finally{d.f();}}r.push(new PY(l,a,f));}}catch(e){u.e(e);}finally{u.f();}}else {var p,m=new LY(t.sliceDoc(a.from,a.to)),g=void 0,y=wi(a.result.options);try{for(y.s();!(p=y.n()).done;){var b=p.value;(g=m.match(b.label))&&(null!=b.boost&&(g[0]+=b.boost),r.push(new PY(b,a,g)));}}catch(e){y.e(e);}finally{y.f();}}}}catch(e){o.e(e);}finally{o.f();}var w,x=[],k=null,j=t.facet(BY).compareCompletions,S=wi(r.sort((function(e,t){return t.match[0]-e.match[0]||j(e.completion,t.completion)})));try{for(S.s();!(w=S.n()).done;){var C=w.value;!k||k.label!=C.completion.label||k.detail!=C.completion.detail||null!=k.type&&null!=C.completion.type&&k.type!=C.completion.type||k.apply!=C.completion.apply?x.push(C):FY(C.completion)>FY(k)&&(x[x.length-1]=C),k=C.completion;}}catch(e){S.e(e);}finally{S.f();}return x}(t,n);if(!a.length)return null;var s,c=n.facet(BY).selectOnOpen?0:-1;if(i&&i.selected!=c&&-1!=i.selected)for(var u=i.options[i.selected].completion,l=0;l<a.length;l++)if(a[l].completion==u){c=l;break}return new e(a,UY(r,c),{pos:t.reduce((function(e,t){return t.hasResult()?Math.min(e,t.from):e}),1e8),create:(s=tX,function(e){return new qY(e,s)}),above:o.aboveCursor},i?i.timestamp:Date.now(),c)}}]),e}(),WY=function(){function e(t,n,r){Bi(this,e),this.active=t,this.id=n,this.open=r;}return qi(e,[{key:"update",value:function(t){var n=this,r=t.state,i=r.facet(BY),o=(i.override||r.languageDataAt("autocomplete",TY(r)).map(DY)).map((function(e){var r=n.active.find((function(t){return t.source==e}))||new GY(e,n.active.some((function(e){return 0!=e.state}))?1:0);return r.update(t,i)}));o.length==this.active.length&&o.every((function(e,t){return e==n.active[t]}))&&(o=this.active);var a=t.selection||o.some((function(e){return e.hasResult()&&t.changes.touchesRange(e.from,e.to)}))||!function(e,t){if(e==t)return !0;for(var n=0,r=0;;){for(;n<e.length&&!e[n].hasResult;)n++;for(;r<t.length&&!t[r].hasResult;)r++;var i=n==e.length,o=r==t.length;if(i||o)return i==o;if(e[n++].result!=t[r++].result)return !1}}(o,this.active)?VY.build(o,r,this.id,this.open,i):this.open&&t.docChanged?this.open.map(t.changes):this.open;!a&&o.every((function(e){return 1!=e.state}))&&o.some((function(e){return e.hasResult()}))&&(o=o.map((function(e){return e.hasResult()?new GY(e.source,0):e})));var s,c=wi(t.effects);try{for(c.s();!(s=c.n()).done;){var u=s.value;u.is(eX)&&(a=a&&a.setSelected(u.value,this.id));}}catch(e){c.e(e);}finally{c.f();}return o==this.active&&a==this.open?this:new e(o,this.id,a)}},{key:"tooltip",get:function(){return this.open?this.open.tooltip:null}},{key:"attrs",get:function(){return this.open?this.open.attrs:HY}}],[{key:"start",value:function(){return new e(JY,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}}]),e}();var HY={"aria-autocomplete":"list"};function UY(e,t){var n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":e};return t>-1&&(n["aria-activedescendant"]=e+"-"+t),n}var JY=[];function KY(e){return e.isUserEvent("input.type")?"input":e.isUserEvent("delete.backward")?"delete":null}var GY=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;Bi(this,e),this.source=t,this.state=n,this.explicitPos=r;}return qi(e,[{key:"hasResult",value:function(){return !1}},{key:"update",value:function(t,n){var r=KY(t),i=this;r?i=i.handleUserEvent(t,r,n):t.docChanged?i=i.handleChange(t):t.selection&&0!=i.state&&(i=new e(i.source,0));var o,a=wi(t.effects);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(s.is(YY))i=new e(i.source,1,s.value?TY(t.state):-1);else if(s.is(XY))i=new e(i.source,0);else if(s.is(ZY)){var c,u=wi(s.value);try{for(u.s();!(c=u.n()).done;){var l=c.value;l.source==i.source&&(i=l);}}catch(e){u.e(e);}finally{u.f();}}}}catch(e){a.e(e);}finally{a.f();}return i}},{key:"handleUserEvent",value:function(t,n,r){return "delete"!=n&&r.activateOnTyping?new e(this.source,1):this.map(t.changes)}},{key:"handleChange",value:function(t){return t.changes.touchesRange(TY(t.startState))?new e(this.source,0):this.map(t.changes)}},{key:"map",value:function(t){return t.empty||this.explicitPos<0?this:new e(this.source,this.state,t.mapPos(this.explicitPos))}}]),e}(),QY=function(e){Pi(n,GY);var t=Ri(n);function n(e,r,i,o,a){var s;return Bi(this,n),(s=t.call(this,e,2,r)).result=i,s.from=o,s.to=a,s}return qi(n,[{key:"hasResult",value:function(){return !0}},{key:"handleUserEvent",value:function(e,t,r){var i,o=e.changes.mapPos(this.from),a=e.changes.mapPos(this.to,1),s=TY(e.state);if((this.explicitPos<0?s<=o:s<this.from)||s>a||"delete"==t&&TY(e.startState)==this.from)return new GY(this.source,"input"==t&&r.activateOnTyping?1:0);var c,u=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos);return function(e,t,n,r){if(!e)return !1;var i=t.sliceDoc(n,r);return "function"==typeof e?e(i,n,r,t):RY(e,!0).test(i)}(this.result.validFor,e.state,o,a)?new n(this.source,u,this.result,o,a):this.result.update&&(c=this.result.update(this.result,o,a,new MY(e.state,s,u>=0)))?new n(this.source,u,c,c.from,null!==(i=c.to)&&void 0!==i?i:TY(e.state)):new GY(this.source,1,u)}},{key:"handleChange",value:function(e){return e.changes.touchesRange(this.from,this.to)?new GY(this.source,0):this.map(e.changes)}},{key:"map",value:function(e){return e.empty?this:new n(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1))}}]),n}();var YY=VB.define(),XY=VB.define(),ZY=VB.define({map:function(e,t){return e.map((function(e){return e.map(t)}))}}),eX=VB.define(),tX=wB.define({create:function(){return WY.start()},update:function(e,t){return e.update(t)},provide:function(e){return [EH.from(e,(function(e){return e.tooltip})),jW.contentAttributes.from(e,(function(e){return e.attrs}))]}});function nX(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"option";return function(n){var r=n.state.field(tX,!1);if(!r||!r.open||Date.now()-r.open.timestamp<75)return !1;var i,o=1;"page"==t&&(i=DH(n,r.open.tooltip))&&(o=Math.max(2,Math.floor(i.dom.offsetHeight/i.dom.querySelector("li").offsetHeight)-1));var a=r.open.options.length,s=r.open.selected>-1?r.open.selected+o*(e?1:-1):e?0:a-1;return s<0?s="page"==t?0:a-1:s>=a&&(s="page"==t?a-1:0),n.dispatch({effects:eX.of(s)}),!0}}var rX=qi((function e(t,n){Bi(this,e),this.active=t,this.context=n,this.time=Date.now(),this.updates=[],this.done=void 0;})),iX=uF.fromClass(function(){function e(t){Bi(this,e),this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;var n,r=wi(t.state.field(tX).active);try{for(r.s();!(n=r.n()).done;){var i=n.value;1==i.state&&this.startQuery(i);}}catch(e){r.e(e);}finally{r.f();}}return qi(e,[{key:"update",value:function(e){var t=this,n=e.state.field(tX);if(e.selectionSet||e.docChanged||e.startState.field(tX)!=n){for(var r=e.transactions.some((function(e){return (e.selection||e.docChanged)&&!KY(e)})),i=0;i<this.running.length;i++){var o=this.running[i];if(r||o.updates.length+e.transactions.length>50&&Date.now()-o.time>1e3){var a,s=wi(o.context.abortListeners);try{for(s.s();!(a=s.n()).done;){var c=a.value;try{c();}catch(e){oF(this.view.state,e);}}}catch(e){s.e(e);}finally{s.f();}o.context.abortListeners=null,this.running.splice(i--,1);}else {var u;(u=o.updates).push.apply(u,Vi(e.transactions));}}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=n.active.some((function(e){return 1==e.state&&!t.running.some((function(t){return t.active.source==e.source}))}))?setTimeout((function(){return t.startUpdate()}),50):-1,0!=this.composing){var l,f=wi(e.transactions);try{for(f.s();!(l=f.n()).done;){var h=l.value;"input"==KY(h)?this.composing=2:2==this.composing&&h.selection&&(this.composing=3);}}catch(e){f.e(e);}finally{f.f();}}}}},{key:"startUpdate",value:function(){var e=this;this.debounceUpdate=-1;var t,n=wi(this.view.state.field(tX).active);try{var r=function(){var n=t.value;1!=n.state||e.running.some((function(e){return e.active.source==n.source}))||e.startQuery(n);};for(n.s();!(t=n.n()).done;)r();}catch(e){n.e(e);}finally{n.f();}}},{key:"startQuery",value:function(e){var t=this,n=this.view.state,r=TY(n),i=new MY(n,r,e.explicitPos==r),o=new rX(e,i);this.running.push(o),Promise.resolve(e.source(i)).then((function(e){o.context.aborted||(o.done=e||null,t.scheduleAccept());}),(function(e){t.view.dispatch({effects:XY.of(null)}),oF(t.view.state,e);}));}},{key:"scheduleAccept",value:function(){var e=this;this.running.every((function(e){return void 0!==e.done}))?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout((function(){return e.accept()}),50));}},{key:"accept",value:function(){var e,t=this;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;for(var n=[],r=this.view.state.facet(BY),i=function(i){var a=t.running[i];if(void 0===a.done)return o=i,"continue";if(t.running.splice(i--,1),a.done){var s,c=new QY(a.active.source,a.active.explicitPos,a.done,a.done.from,null!==(e=a.done.to)&&void 0!==e?e:TY(a.updates.length?a.updates[0].startState:t.view.state)),u=wi(a.updates);try{for(u.s();!(s=u.n()).done;){var l=s.value;c=c.update(l,r);}}catch(e){u.e(e);}finally{u.f();}if(c.hasResult())return n.push(c),o=i,"continue"}var f=t.view.state.field(tX).active.find((function(e){return e.source==a.active.source}));if(f&&1==f.state)if(null==a.done){var h,d=new GY(a.active.source,0),v=wi(a.updates);try{for(v.s();!(h=v.n()).done;){var p=h.value;d=d.update(p,r);}}catch(e){v.e(e);}finally{v.f();}1!=d.state&&n.push(d);}else t.startQuery(f);o=i;},o=0;o<this.running.length;o++)i(o);n.length&&this.view.dispatch({effects:ZY.of(n)});}}]),e}(),{eventHandlers:{blur:function(){var e=this.view.state.field(tX,!1);e&&e.tooltip&&this.view.state.facet(BY).closeOnBlur&&this.view.dispatch({effects:XY.of(null)});},compositionstart:function(){this.composing=1;},compositionend:function(){var e=this;3==this.composing&&setTimeout((function(){return e.view.dispatch({effects:YY.of(!1)})}),20),this.composing=0;}}}),oX=jW.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"300px"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),aX={brackets:["(","[","{","'",'"'],before:")]}:;>"},sX=VB.define({map:function(e,t){var n=t.mapPos(e,-1,tB.TrackAfter);return null==n?void 0:n}}),cX=VB.define({map:function(e,t){return t.mapPos(e)}}),uX=new(function(e){Pi(n,rz);var t=Ri(n);function n(){return Bi(this,n),t.apply(this,arguments)}return qi(n)}());uX.startSide=1,uX.endSide=-1;var lX=wB.define({create:function(){return sz.empty},update:function(e,t){if(t.selection){var n=t.state.doc.lineAt(t.selection.main.head).from,r=t.startState.doc.lineAt(t.startState.selection.main.head).from;n!=t.changes.mapPos(r,-1)&&(e=sz.empty);}e=e.map(t.changes);var i,o=wi(t.effects);try{var a=function(){var t=i.value;t.is(sX)?e=e.update({add:[uX.range(t.value,t.value+1)]}):t.is(cX)&&(e=e.update({filter:function(e){return e!=t.value}}));};for(o.s();!(i=o.n()).done;)a();}catch(e){o.e(e);}finally{o.f();}return e}});function fX(e){for(var t=0;t<"()[]{}<>".length;t+=2)if("()[]{}<>".charCodeAt(t)==e)return "()[]{}<>".charAt(t+1);return XL(e<128?e:e+1)}function hX(e,t){return e.languageDataAt("closeBrackets",t)[0]||aX}var dX="object"==("undefined"==typeof navigator?"undefined":Ji(navigator))&&/Android\b/.test(navigator.userAgent),vX=jW.inputHandler.of((function(e,t,n,r){if((dX?e.composing:e.compositionStarted)||e.state.readOnly)return !1;var i=e.state.selection.main;if(r.length>2||2==r.length&&1==ZL(YL(r,0))||t!=i.from||n!=i.to)return !1;var o=function(e,t){var n,r=hX(e,e.selection.main.head),i=r.brackets||aX.brackets,o=wi(i);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=fX(YL(a,0));if(t==a)return s==a?wX(e,a,i.indexOf(a+a+a)>-1):yX(e,a,s,r.before||aX.before);if(t==s&&mX(e,e.selection.main.from))return bX(e,a,s)}}catch(e){o.e(e);}finally{o.f();}return null}(e.state,r);return !!o&&(e.dispatch(o),!0)})),pX=[{key:"Backspace",run:function(e){var t=e.state,n=e.dispatch;if(t.readOnly)return !1;var r=hX(t,t.selection.main.head).brackets||aX.brackets,i=null,o=t.changeByRange((function(e){if(e.empty){var n,o=function(e,t){var n=e.sliceString(t-2,t);return ZL(YL(n,0))==n.length?n:n.slice(1)}(t.doc,e.head),a=wi(r);try{for(a.s();!(n=a.n()).done;){var s=n.value;if(s==o&&gX(t.doc,e.head)==fX(YL(s,0)))return {changes:{from:e.head-s.length,to:e.head+s.length},range:fB.cursor(e.head-s.length),userEvent:"delete.backward"}}}catch(e){a.e(e);}finally{a.f();}}return {range:i=e}}));return i||n(t.update(o,{scrollIntoView:!0})),!i}}];function mX(e,t){var n=!1;return e.field(lX).between(0,e.doc.length,(function(e){e==t&&(n=!0);})),n}function gX(e,t){var n=e.sliceString(t,t+2);return n.slice(0,ZL(YL(n,0)))}function yX(e,t,n,r){var i=null,o=e.changeByRange((function(o){if(!o.empty)return {changes:[{insert:t,from:o.from},{insert:n,from:o.to}],effects:sX.of(o.to+t.length),range:fB.range(o.anchor+t.length,o.head+t.length)};var a=gX(e.doc,o.head);return !a||/\s/.test(a)||r.indexOf(a)>-1?{changes:{insert:t+n,from:o.head},effects:sX.of(o.head+t.length),range:fB.cursor(o.head+t.length)}:{range:i=o}}));return i?null:e.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function bX(e,t,n){var r=null,i=e.selection.ranges.map((function(t){return t.empty&&gX(e.doc,t.head)==n?fB.cursor(t.head+n.length):r=t}));return r?null:e.update({selection:fB.create(i,e.selection.mainIndex),scrollIntoView:!0,effects:e.selection.ranges.map((function(e){var t=e.from;return cX.of(t)}))})}function wX(e,t,n){var r=null,i=e.changeByRange((function(i){if(!i.empty)return {changes:[{insert:t,from:i.from},{insert:t,from:i.to}],effects:sX.of(i.to+t.length),range:fB.range(i.anchor+t.length,i.head+t.length)};var o=i.head,a=gX(e.doc,o);if(a==t){if(xX(e,o))return {changes:{insert:t+t,from:o},effects:sX.of(o+t.length),range:fB.cursor(o+t.length)};if(mX(e,o)){var s=n&&e.sliceDoc(o,o+3*t.length)==t+t+t;return {range:fB.cursor(o+t.length*(s?3:1)),effects:cX.of(o)}}}else {if(n&&e.sliceDoc(o-2*t.length,o)==t+t&&xX(e,o-2*t.length))return {changes:{insert:t+t+t+t,from:o},effects:sX.of(o+t.length),range:fB.cursor(o+t.length)};if(e.charCategorizer(o)(a)!=XB.Word){var c=e.sliceDoc(o-1,o);if(c!=t&&e.charCategorizer(o)(c)!=XB.Word&&!function(e,t,n){for(var r=kJ(e).resolveInner(t,-1),i=0;i<5;i++){if(e.sliceDoc(r.from,r.from+n.length)==n){for(var o=r.firstChild;o&&o.from==r.from&&o.to-o.from>n.length;){if(e.sliceDoc(o.to-n.length,o.to)==n)return !1;o=o.firstChild;}return !0}var a=r.to==t&&r.parent;if(!a)break;r=a;}return !1}(e,o,t))return {changes:{insert:t+t,from:o},effects:sX.of(o+t.length),range:fB.cursor(o+t.length)}}}return {range:r=i}}));return r?null:e.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function xX(e,t){var n=kJ(e).resolveInner(t+1);return n.parent&&n.from==t}function kX(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return [tX,BY.of(e),iX,SX,oX]}var jX=[{key:"Ctrl-Space",run:function(e){return !!e.state.field(tX,!1)&&(e.dispatch({effects:YY.of(!0)}),!0)}},{key:"Escape",run:function(e){var t=e.state.field(tX,!1);return !(!t||!t.active.some((function(e){return 0!=e.state})))&&(e.dispatch({effects:XY.of(null)}),!0)}},{key:"ArrowDown",run:nX(!0)},{key:"ArrowUp",run:nX(!1)},{key:"PageDown",run:nX(!0,"page")},{key:"PageUp",run:nX(!1,"page")},{key:"Enter",run:function(e){var t=e.state.field(tX,!1);return !(e.state.readOnly||!t||!t.open||Date.now()-t.open.timestamp<75||t.open.selected<0)&&(NY(e,t.open.options[t.open.selected]),!0)}}],SX=$B.highest(PW.computeN([BY],(function(e){return e.facet(BY).defaultKeymap?[jX]:[]}))),CX=qi((function e(t,n,r){Bi(this,e),this.from=t,this.to=n,this.diagnostic=r;})),$X=function(){function e(t,n,r){Bi(this,e),this.diagnostics=t,this.panel=n,this.selected=r;}return qi(e,null,[{key:"init",value:function(t,n,r){var i=t,o=r.facet(zX).markerFilter;o&&(i=o(i));var a=Dq.set(i.map((function(e){return e.from==e.to||e.from==e.to-1&&r.doc.lineAt(e.from).to==e.from?Dq.widget({widget:new VX(e),diagnostic:e}).range(e.from):Dq.mark({attributes:{class:"cm-lintRange cm-lintRange-"+e.severity},diagnostic:e}).range(e.from,e.to)})),!0);return new e(a,n,_X(a))}}]),e}();function _X(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=null;return e.between(n,1e9,(function(e,n,i){var o=i.spec;if(!t||o.diagnostic==t)return r=new CX(e,n,o.diagnostic),!1})),r}function OX(e,t){return !(!e.effects.some((function(e){return e.is(EX)}))&&!e.changes.touchesRange(t.pos))}function MX(e,t){return e.field(TX,!1)?t:t.concat(VB.appendConfig.of(nZ))}var EX=VB.define(),AX=VB.define(),PX=VB.define(),TX=wB.define({create:function(){return new $X(Dq.none,null,null)},update:function(e,t){if(t.docChanged){var n=e.diagnostics.map(t.changes),r=null;if(e.selected){var i=t.changes.mapPos(e.selected.from,1);r=_X(n,e.selected.diagnostic,i)||_X(n,null,i);}e=new $X(n,e.panel,r);}var o,a=wi(t.effects);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.is(EX)?e=$X.init(s.value,e.panel,t.state):s.is(AX)?e=new $X(e.diagnostics,s.value?HX.open:null,e.selected):s.is(PX)&&(e=new $X(e.diagnostics,e.panel,s.value));}}catch(e){a.e(e);}finally{a.f();}return e},provide:function(e){return [WH.from(e,(function(e){return e.panel})),jW.decorations.from(e,(function(e){return e.diagnostics}))]}}),RX=Dq.mark({class:"cm-lintRange cm-lintRange-active"});function NX(e,t,n){var r=e.state.field(TX).diagnostics,i=[],o=2e8,a=0;r.between(t-(n<0?1:0),t+(n>0?1:0),(function(e,r,s){var c=s.spec;t>=e&&t<=r&&(e==r||(t>e||n>0)&&(t<r||n<0))&&(i.push(c.diagnostic),o=Math.min(e,o),a=Math.max(r,a));}));var s=e.state.facet(zX).tooltipFilter;return s&&(i=s(i)),i.length?{pos:o,end:a,above:e.state.doc.lineAt(o).to<a,create:function(){return {dom:IX(e,i)}}}:null}function IX(e,t){return CQ("ul",{class:"cm-tooltip-lint"},t.map((function(t){return FX(e,t,!1)})))}var DX=function(e){var t=e.state.field(TX,!1);return !(!t||!t.panel)&&(e.dispatch({effects:AX.of(!1)}),!0)},LX=[{key:"Mod-Shift-m",run:function(e){var t=e.state.field(TX,!1);t&&t.panel||e.dispatch({effects:MX(e.state,[AX.of(!0)])});var n=zH(e,HX.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},preventDefault:!0},{key:"F8",run:function(e){var t=e.state.field(TX,!1);if(!t)return !1;var n=e.state.selection.main,r=t.diagnostics.iter(n.to+1);return !(!r.value&&(!(r=t.diagnostics.iter(0)).value||r.from==n.from&&r.to==n.to))&&(e.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0}),!0)}}],BX=uF.fromClass(function(){function e(t){Bi(this,e),this.view=t,this.timeout=-1,this.set=!0;var n=t.state.facet(zX).delay;this.lintTime=Date.now()+n,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,n);}return qi(e,[{key:"run",value:function(){var e=this,t=Date.now();if(t<this.lintTime-10)setTimeout(this.run,this.lintTime-t);else {this.set=!1;var n=this.view.state,r=n.facet(zX).sources;Promise.all(r.map((function(t){return Promise.resolve(t(e.view))}))).then((function(t){var r=t.reduce((function(e,t){return e.concat(t)}));e.view.state.doc==n.doc&&e.view.dispatch(function(e,t){return {effects:MX(e,[EX.of(t)])}}(e.view.state,r));}),(function(t){oF(e.view.state,t);}));}}},{key:"update",value:function(e){var t=e.state.facet(zX);(e.docChanged||t!=e.startState.facet(zX)||t.needsRefresh&&t.needsRefresh(e))&&(this.lintTime=Date.now()+t.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,t.delay)));}},{key:"force",value:function(){this.set&&(this.lintTime=Date.now(),this.run());}},{key:"destroy",value:function(){clearTimeout(this.timeout);}}]),e}()),zX=vB.define({combine:function(e){return Object.assign({sources:e.map((function(e){return e.source}))},nz(e.map((function(e){return e.config})),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:function(e,t){return e?t?function(n){return e(n)||t(n)}:e:t}}))}});function qX(e){var t=[];if(e){var n,r=wi(e);try{e:for(r.s();!(n=r.n()).done;){for(var i=n.value.name,o=function(){var e=i[a];if(/[a-zA-Z]/.test(e)&&!t.some((function(t){return t.toLowerCase()==e.toLowerCase()})))return t.push(e),"continue|actions"},a=0;a<i.length;a++){if("continue|actions"===o())continue e}t.push("");}}catch(e){r.e(e);}finally{r.f();}}return t}function FX(e,t,n){var r,i=n?qX(t.actions):[];return CQ("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},CQ("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage():t.message),null===(r=t.actions)||void 0===r?void 0:r.map((function(n,r){var o=!1,a=function(r){if(r.preventDefault(),!o){o=!0;var i=_X(e.state.field(TX).diagnostics,t);i&&n.apply(e,i.from,i.to);}},s=n.name,c=i[r]?s.indexOf(i[r]):-1,u=c<0?s:[s.slice(0,c),CQ("u",s.slice(c,c+1)),s.slice(c+1)];return CQ("button",{type:"button",class:"cm-diagnosticAction",onclick:a,onmousedown:a,"aria-label":" Action: ".concat(s).concat(c<0?"":' (access key "'.concat(i[r],')"'),".")},u)})),t.source&&CQ("div",{class:"cm-diagnosticSource"},t.source))}var VX=function(e){Pi(n,Nq);var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this)).diagnostic=e,r}return qi(n,[{key:"eq",value:function(e){return e.diagnostic==this.diagnostic}},{key:"toDOM",value:function(){return CQ("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}]),n}(),WX=qi((function e(t,n){Bi(this,e),this.diagnostic=n,this.id="item_"+Math.floor(4294967295*Math.random()).toString(16),this.dom=FX(t,n,!0),this.dom.id=this.id,this.dom.setAttribute("role","option");})),HX=function(){function e(t){var n=this;Bi(this,e),this.view=t,this.items=[];this.list=CQ("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:function(e){if(27==e.keyCode)DX(n.view),n.view.focus();else if(38==e.keyCode||33==e.keyCode)n.moveSelection((n.selectedIndex-1+n.items.length)%n.items.length);else if(40==e.keyCode||34==e.keyCode)n.moveSelection((n.selectedIndex+1)%n.items.length);else if(36==e.keyCode)n.moveSelection(0);else if(35==e.keyCode)n.moveSelection(n.items.length-1);else if(13==e.keyCode)n.view.focus();else {if(!(e.keyCode>=65&&e.keyCode<=90&&n.selectedIndex>=0))return;for(var r=n.items[n.selectedIndex].diagnostic,i=qX(r.actions),o=0;o<i.length;o++)if(i[o].toUpperCase().charCodeAt(0)==e.keyCode){var a=_X(n.view.state.field(TX).diagnostics,r);a&&r.actions[o].apply(t,a.from,a.to);}}e.preventDefault();},onclick:function(e){for(var t=0;t<n.items.length;t++)n.items[t].dom.contains(e.target)&&n.moveSelection(t);}}),this.dom=CQ("div",{class:"cm-panel-lint"},this.list,CQ("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:function(){return DX(n.view)}},"")),this.update();}return qi(e,[{key:"selectedIndex",get:function(){var e=this.view.state.field(TX).selected;if(!e)return -1;for(var t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return -1}},{key:"update",value:function(){var e=this,t=this.view.state.field(TX),n=t.diagnostics,r=t.selected,i=0,o=!1,a=null;for(n.between(0,this.view.state.doc.length,(function(t,n,s){for(var c,u=s.spec,l=-1,f=i;f<e.items.length;f++)if(e.items[f].diagnostic==u.diagnostic){l=f;break}l<0?(c=new WX(e.view,u.diagnostic),e.items.splice(i,0,c),o=!0):(c=e.items[l],l>i&&(e.items.splice(i,l-i),o=!0)),r&&c.diagnostic==r.diagnostic?c.dom.hasAttribute("aria-selected")||(c.dom.setAttribute("aria-selected","true"),a=c):c.dom.hasAttribute("aria-selected")&&c.dom.removeAttribute("aria-selected"),i++;}));i<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)o=!0,this.items.pop();0==this.items.length&&(this.items.push(new WX(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),o=!0),a?(this.list.setAttribute("aria-activedescendant",a.id),this.view.requestMeasure({key:this,read:function(){return {sel:a.dom.getBoundingClientRect(),panel:e.list.getBoundingClientRect()}},write:function(t){var n=t.sel,r=t.panel;n.top<r.top?e.list.scrollTop-=r.top-n.top:n.bottom>r.bottom&&(e.list.scrollTop+=n.bottom-r.bottom);}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),o&&this.sync();}},{key:"sync",value:function(){var e=this.list.firstChild;function t(){var t=e;e=t.nextSibling,t.remove();}var n,r=wi(this.items);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.dom.parentNode==this.list){for(;e!=i.dom;)t();e=i.dom.nextSibling;}else this.list.insertBefore(i.dom,e);}}catch(e){r.e(e);}finally{r.f();}for(;e;)t();}},{key:"moveSelection",value:function(e){if(!(this.selectedIndex<0)){var t=_X(this.view.state.field(TX).diagnostics,this.items[e].diagnostic);t&&this.view.dispatch({selection:{anchor:t.from,head:t.to},scrollIntoView:!0,effects:PX.of(t)});}}}],[{key:"open",value:function(t){return new e(t)}}]),e}();function UX(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:'viewBox="0 0 40 40"';return 'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" '.concat(t,">").concat(encodeURIComponent(e),"</svg>')")}function JX(e){return UX('<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="'.concat(e,'" fill="none" stroke-width=".7"/>'),'width="6" height="3"')}var KX=jW.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:JX("#d11")},".cm-lintRange-warning":{backgroundImage:JX("orange")},".cm-lintRange-info":{backgroundImage:JX("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),GX=function(e){Pi(n,HH);var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this)).diagnostics=e,r.severity=e.reduce((function(e,t){var n=t.severity;return "error"==n||"warning"==n&&"info"==e?n:e}),"info"),r}return qi(n,[{key:"toDOM",value:function(e){var t=document.createElement("div");t.className="cm-lint-marker cm-lint-marker-"+this.severity;var n=this.diagnostics,r=e.state.facet(rZ).tooltipFilter;return r&&(n=r(n)),n.length&&(t.onmouseover=function(){return function(e,t,n){function r(){var r=e.elementAtHeight(t.getBoundingClientRect().top+5-e.documentTop);e.coordsAtPos(r.from)&&e.dispatch({effects:ZX.of({pos:r.from,above:!1,create:function(){return {dom:IX(e,n),getCoords:function(){return t.getBoundingClientRect()}}}})}),t.onmouseout=t.onmousemove=null,function(e,t){var n=function n(r){var i=t.getBoundingClientRect();if(!(r.clientX>i.left-10&&r.clientX<i.right+10&&r.clientY>i.top-10&&r.clientY<i.bottom+10)){for(var o=r.target;o;o=o.parentNode)if(1==o.nodeType&&o.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",n),e.state.field(eZ)&&e.dispatch({effects:ZX.of(null)});}};window.addEventListener("mousemove",n);}(e,t);}var i=e.state.facet(rZ).hoverTime,o=setTimeout(r,i);t.onmouseout=function(){clearTimeout(o),t.onmouseout=t.onmousemove=null;},t.onmousemove=function(){clearTimeout(o),o=setTimeout(r,i);};}(e,t,n)}),t}}]),n}();function QX(e,t){var n,r=Object.create(null),i=wi(t);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=e.lineAt(o.from);(r[a.from]||(r[a.from]=[])).push(o);}}catch(e){i.e(e);}finally{i.f();}var s=[];for(var c in r)s.push(new GX(r[c]).range(+c));return sz.of(s,!0)}var YX=GH({class:"cm-gutter-lint",markers:function(e){return e.state.field(XX)}}),XX=wB.define({create:function(){return sz.empty},update:function(e,t){e=e.map(t.changes);var n,r=t.state.facet(rZ).markerFilter,i=wi(t.effects);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.is(EX)){var a=o.value;r&&(a=r(a||[])),e=QX(t.state.doc,a.slice(0));}}}catch(e){i.e(e);}finally{i.f();}return e}}),ZX=VB.define(),eZ=wB.define({create:function(){return null},update:function(e,t){return e&&t.docChanged&&(e=OX(t,e)?null:Object.assign(Object.assign({},e),{pos:t.changes.mapPos(e.pos)})),t.effects.reduce((function(e,t){return t.is(ZX)?t.value:e}),e)},provide:function(e){return EH.from(e)}}),tZ=jW.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:UX('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:UX('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:UX('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),nZ=[TX,jW.decorations.compute([TX],(function(e){var t=e.field(TX),n=t.selected,r=t.panel;return n&&r&&n.from!=n.to?Dq.set([RX.range(n.from,n.to)]):Dq.none})),IH(NX,{hideOn:OX}),KX],rZ=vB.define({combine:function(e){return nz(e,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});function iZ(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return [rZ.of(e),XX,YX,tZ,eZ]}var oZ,aZ=function(){return [uU(),hU,lH(),iG(),lK(),JW(),[tH,nH],tz.allowMultipleSelections.of(!0),tz.transactionFilter.of((function(e){if(!e.docChanged||!e.isUserEvent("input.type")&&!e.isUserEvent("input.complete"))return e;var t=e.startState.languageDataAt("indentOnInput",e.startState.selection.main.head);if(!t.length)return e;var n=e.newDoc,r=e.newSelection.main.head,i=n.lineAt(r);if(r>i.from+200)return e;var o=n.sliceString(i.from,r);if(!t.some((function(e){return e.test(o)})))return e;var a,s=e.state,c=-1,u=[],l=wi(s.selection.ranges);try{for(l.s();!(a=l.n()).done;){var f=a.value.head,h=s.doc.lineAt(f);if(h.from!=c){c=h.from;var d=DJ(s,h.from);if(null!=d){var v=/^\s*/.exec(h.text)[0],p=IJ(s,d);v!=p&&u.push({from:h.from,to:h.from+v.length,insert:p});}}}}catch(e){l.e(e);}finally{l.f();}return u.length?[e,{changes:u,sequential:!0}]:e})),mK(bK,{fallback:!0}),_K(),[vX,lX],kX(),bH(),kH(),mH,(t=[UQ,HQ],e&&t.push(qQ.of(e)),t),PW.of([].concat(pX,Vi(jQ),kY,jG,rK,jX,LX))];var e,t;}(),sZ=function(){function e(t,n,r,i,o,a,s,c,u){var l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,f=arguments.length>10?arguments[10]:void 0;Bi(this,e),this.p=t,this.stack=n,this.state=r,this.reducePos=i,this.pos=o,this.score=a,this.buffer=s,this.bufferBase=c,this.curContext=u,this.lookAhead=l,this.parent=f;}return qi(e,[{key:"toString",value:function(){return "[".concat(this.stack.filter((function(e,t){return t%3==0})).concat(this.state),"]@").concat(this.pos).concat(this.score?"!"+this.score:"")}},{key:"context",get:function(){return this.curContext?this.curContext.context:null}},{key:"pushState",value:function(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e;}},{key:"reduce",value:function(e){var t=e>>19,n=65535&e,r=this.p.parser,i=r.dynamicPrecedence(n);if(i&&(this.score+=i),0==t)return this.pushState(r.getGoto(this.state,n,!0),this.reducePos),n<r.minRepeatTerm&&this.storeNode(n,this.reducePos,this.reducePos,4,!0),void this.reduceContext(n,this.reducePos);var o=this.stack.length-3*(t-1)-(262144&e?6:0),a=this.stack[o-2],s=this.stack[o-1],c=this.bufferBase+this.buffer.length-s;if(n<r.minRepeatTerm||131072&e){var u=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(n,a,u,c+4,!0);}if(262144&e)this.state=this.stack[o];else {var l=this.stack[o-3];this.state=r.getGoto(l,n,!0);}for(;this.stack.length>o;)this.stack.pop();this.reduceContext(n,a);}},{key:"storeNode",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(0==e&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){var o=this,a=this.buffer.length;if(0==a&&o.parent&&(a=o.bufferBase-o.parent.bufferBase,o=o.parent),a>0&&0==o.buffer[a-4]&&o.buffer[a-1]>-1){if(t==n)return;if(o.buffer[a-2]>=t)return void(o.buffer[a-2]=n)}}if(i&&this.pos!=n){var s=this.buffer.length;if(s>0&&0!=this.buffer[s-4])for(;s>0&&this.buffer[s-2]>n;)this.buffer[s]=this.buffer[s-4],this.buffer[s+1]=this.buffer[s-3],this.buffer[s+2]=this.buffer[s-2],this.buffer[s+3]=this.buffer[s-1],s-=4,r>4&&(r-=4);this.buffer[s]=e,this.buffer[s+1]=t,this.buffer[s+2]=n,this.buffer[s+3]=r;}else this.buffer.push(e,t,n,r);}},{key:"shift",value:function(e,t,n){var r=this.pos;if(131072&e)this.pushState(65535&e,this.pos);else if(0==(262144&e)){var i=e,o=this.p.parser;(n>this.pos||t<=o.maxNode)&&(this.pos=n,o.stateFlag(i,1)||(this.reducePos=n)),this.pushState(i,r),this.shiftContext(t,r),t<=o.maxNode&&this.buffer.push(t,r,n,4);}else this.pos=n,this.shiftContext(t,r),t<=this.p.parser.maxNode&&this.buffer.push(t,r,n,4);}},{key:"apply",value:function(e,t,n){65536&e?this.reduce(e):this.shift(e,t,n);}},{key:"useNode",value:function(e,t){var n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);var r=this.pos;this.reducePos=this.pos=r+e.length,this.pushState(t,r),this.buffer.push(n,r,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)));}},{key:"split",value:function(){for(var t=this,n=t.buffer.length;n>0&&t.buffer[n-2]>t.reducePos;)n-=4;for(var r=t.buffer.slice(n),i=t.bufferBase+n;t&&i==t.bufferBase;)t=t.parent;return new e(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,r,i,this.curContext,this.lookAhead,t)}},{key:"recoverByDelete",value:function(e,t){var n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,n?8:4),this.pos=this.reducePos=t,this.score-=190;}},{key:"canShift",value:function(e){for(var t=new uZ(this);;){var n=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(0==(65536&n))return !0;if(0==n)return !1;t.reduce(n);}}},{key:"recoverByInsert",value:function(e){if(this.stack.length>=300)return [];var t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){for(var n,r=[],i=0;i<t.length;i+=2)(n=t[i+1])!=this.state&&this.p.parser.hasAction(n,e)&&r.push(t[i],n);if(this.stack.length<120)for(var o=function(){var e=t[a+1];r.some((function(t,n){return 1&n&&t==e}))||r.push(t[a],e);},a=0;r.length<8&&a<t.length;a+=2)o();t=r;}for(var s=[],c=0;c<t.length&&s.length<4;c+=2){var u=t[c+1];if(u!=this.state){var l=this.split();l.pushState(u,this.pos),l.storeNode(0,l.pos,l.pos,4,!0),l.shiftContext(t[c],this.pos),l.score-=200,s.push(l);}}return s}},{key:"forceReduce",value:function(){var e=this.p.parser.stateSlot(this.state,5);if(0==(65536&e))return !1;var t=this.p.parser;if(!t.validAction(this.state,e)){var n=e>>19,r=65535&e,i=this.stack.length-3*n;if(i<0||t.getGoto(this.stack[i],r,!1)<0)return !1;this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100;}return this.reducePos=this.pos,this.reduce(e),!0}},{key:"forceAll",value:function(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}},{key:"deadEnd",get:function(){if(3!=this.stack.length)return !1;var e=this.p.parser;return 65535==e.data[e.stateSlot(this.state,1)]&&!e.stateSlot(this.state,4)}},{key:"restart",value:function(){this.state=this.stack[0],this.stack.length=0;}},{key:"sameState",value:function(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return !1;for(var t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return !1;return !0}},{key:"parser",get:function(){return this.p.parser}},{key:"dialectEnabled",value:function(e){return this.p.parser.dialect.flags[e]}},{key:"shiftContext",value:function(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)));}},{key:"reduceContext",value:function(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)));}},{key:"emitContext",value:function(){var e=this.buffer.length-1;(e<0||-3!=this.buffer[e])&&this.buffer.push(this.curContext.hash,this.reducePos,this.reducePos,-3);}},{key:"emitLookAhead",value:function(){var e=this.buffer.length-1;(e<0||-4!=this.buffer[e])&&this.buffer.push(this.lookAhead,this.reducePos,this.reducePos,-4);}},{key:"updateContext",value:function(e){if(e!=this.curContext.context){var t=new cZ(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t;}}},{key:"setLookAhead",value:function(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e);}},{key:"close",value:function(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead();}}],[{key:"start",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=t.parser.context;return new e(t,[],n,r,r,0,[],0,i?new cZ(i,i.start):null,0,null)}}]),e}(),cZ=qi((function e(t,n){Bi(this,e),this.tracker=t,this.context=n,this.hash=t.strict?t.hash(n):0;}));!function(e){e[e.Insert=200]="Insert",e[e.Delete=190]="Delete",e[e.Reduce=100]="Reduce",e[e.MaxNext=4]="MaxNext",e[e.MaxInsertStackDepth=300]="MaxInsertStackDepth",e[e.DampenInsertStackDepth=120]="DampenInsertStackDepth";}(oZ||(oZ={}));var uZ=function(){function e(t){Bi(this,e),this.start=t,this.state=t.state,this.stack=t.stack,this.base=this.stack.length;}return qi(e,[{key:"reduce",value:function(e){var t=65535&e,n=e>>19;0==n?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(n-1);var r=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=r;}}]),e}(),lZ=function(){function e(t,n,r){Bi(this,e),this.stack=t,this.pos=n,this.index=r,this.buffer=t.buffer,0==this.index&&this.maybeNext();}return qi(e,[{key:"maybeNext",value:function(){var e=this.stack.parent;null!=e&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer);}},{key:"id",get:function(){return this.buffer[this.index-4]}},{key:"start",get:function(){return this.buffer[this.index-3]}},{key:"end",get:function(){return this.buffer[this.index-2]}},{key:"size",get:function(){return this.buffer[this.index-1]}},{key:"next",value:function(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext();}},{key:"fork",value:function(){return new e(this.stack,this.pos,this.index)}}],[{key:"create",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.bufferBase+t.buffer.length;return new e(t,n,n-t.bufferBase)}}]),e}(),fZ=qi((function e(){Bi(this,e),this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0;})),hZ=new fZ,dZ=function(){function e(t,n){Bi(this,e),this.input=t,this.ranges=n,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=hZ,this.rangeIndex=0,this.pos=this.chunkPos=n[0].from,this.range=n[0],this.end=n[n.length-1].to,this.readNext();}return qi(e,[{key:"resolveOffset",value:function(e,t){for(var n=this.range,r=this.rangeIndex,i=this.pos+e;i<n.from;){if(!r)return null;var o=this.ranges[--r];i-=n.from-o.to,n=o;}for(;t<0?i>n.to:i>=n.to;){if(r==this.ranges.length-1)return null;var a=this.ranges[++r];i+=a.from-n.to,n=a;}return i}},{key:"clipPos",value:function(e){if(e>=this.range.from&&e<this.range.to)return e;var t,n=wi(this.ranges);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.to>e)return Math.max(e,r.from)}}catch(e){n.e(e);}finally{n.f();}return this.end}},{key:"peek",value:function(e){var t,n,r=this.chunkOff+e;if(r>=0&&r<this.chunk.length)t=this.pos+e,n=this.chunk.charCodeAt(r);else {var i=this.resolveOffset(e,1);if(null==i)return -1;if((t=i)>=this.chunk2Pos&&t<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(t-this.chunk2Pos);else {for(var o=this.rangeIndex,a=this.range;a.to<=t;)a=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=t),t+this.chunk2.length>a.to&&(this.chunk2=this.chunk2.slice(0,a.to-t)),n=this.chunk2.charCodeAt(0);}}return t>=this.token.lookAhead&&(this.token.lookAhead=t+1),n}},{key:"acceptToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t?this.resolveOffset(t,-1):this.pos;if(null==n||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n;}},{key:"getChunk",value:function(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){var e=this.chunk,t=this.chunkPos;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos;}else {this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;var n=this.input.chunk(this.pos),r=this.pos+n.length;this.chunk=r>this.range.to?n.slice(0,this.range.to-this.pos):n,this.chunkPos=this.pos,this.chunkOff=0;}}},{key:"readNext",value:function(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}},{key:"advance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from;}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}},{key:"setDone",value:function(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}},{key:"reset",value:function(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=hZ,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext();}return this}},{key:"read",value:function(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);var n,r="",i=wi(this.ranges);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.from>=t)break;o.to>e&&(r+=this.input.read(Math.max(o.from,e),Math.min(o.to,t)));}}catch(e){i.e(e);}finally{i.f();}return r}}]),e}(),vZ=function(){function e(t,n){Bi(this,e),this.data=t,this.id=n;}return qi(e,[{key:"token",value:function(e,t){!function(e,t,n,r){var i=0,o=1<<r,a=n.p.parser,s=a.dialect;e:for(;0!=(o&e[i]);){for(var c=e[i+1],u=i+3;u<c;u+=2)if((e[u+1]&o)>0){var l=e[u];if(s.allows(l)&&(-1==t.token.value||t.token.value==l||a.overrides(l,t.token.value))){t.acceptToken(l);break}}var f=t.next,h=0,d=e[i+2];if(!(t.next<0&&d>h&&65535==e[c+3*d-3])){for(;h<d;){var v=h+d>>1,p=c+v+(v<<1),m=e[p],g=e[p+1];if(f<m)d=v;else {if(!(f>=g)){i=e[p+2],t.advance();continue e}h=v+1;}}break}i=e[c+3*d-1];}}(this.data,e,t,this.id);}}]),e}();function pZ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Uint16Array;if("string"!=typeof e)return e;for(var n=null,r=0,i=0;r<e.length;){for(var o=0;;){var a=e.charCodeAt(r++),s=!1;if(126==a){o=65535;break}a>=92&&a--,a>=34&&a--;var c=a-32;if(c>=46&&(c-=46,s=!0),o+=c,s)break;o*=46;}n?n[i++]=o:n=new t(o);}return n}vZ.prototype.contextual=vZ.prototype.fallback=vZ.prototype.extend=!1;var mZ,gZ="undefined"!=typeof process&&process.env&&/\bparse\b/.test(process.env.LOG),yZ=null;function bZ(e,t,n){var r=e.cursor(yU.IncludeAnonymous);for(r.moveTo(t);;)if(!(n<0?r.childBefore(t):r.childAfter(t)))for(;;){if((n<0?r.to<t:r.from>t)&&!r.type.isError)return n<0?Math.max(0,Math.min(r.to-1,t-25)):Math.min(e.length,Math.max(r.from+1,t+25));if(n<0?r.prevSibling():r.nextSibling())break;if(!r.parent())return n<0?0:e.length}}!function(e){e[e.Margin=25]="Margin";}(mZ||(mZ={}));var wZ,xZ=function(){function e(t,n){Bi(this,e),this.fragments=t,this.nodeSet=n,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment();}return qi(e,[{key:"nextFragment",value:function(){var e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?bZ(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?bZ(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom;}else this.nextStart=1e9;}},{key:"nodeAt",value:function(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){var t=this.trees.length-1;if(t<0)return this.nextFragment(),null;var n=this.trees[t],r=this.index[t];if(r!=n.children.length){var i=n.children[r],o=this.start[t]+n.positions[r];if(o>e)return this.nextStart=o,null;if(i instanceof kU){if(o==e){if(o<this.safeFrom)return null;var a=o+i.length;if(a<=this.safeTo){var s=i.prop(pU.lookAhead);if(!s||a+s<this.fragment.to)return i}}this.index[t]++,o+i.length>=Math.max(this.safeFrom,e)&&(this.trees.push(i),this.start.push(o),this.index.push(0));}else this.index[t]++,this.nextStart=o+i.length;}else this.trees.pop(),this.start.pop(),this.index.pop();}}}]),e}(),kZ=function(){function e(t,n){Bi(this,e),this.stream=n,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=t.tokenizers.map((function(e){return new fZ}));}return qi(e,[{key:"getActions",value:function(e){for(var t=0,n=null,r=e.p.parser,i=r.tokenizers,o=r.stateSlot(e.state,3),a=e.curContext?e.curContext.hash:0,s=0,c=0;c<i.length;c++)if(0!=(1<<c&o)){var u=i[c],l=this.tokens[c];if((!n||u.fallback)&&((u.contextual||l.start!=e.pos||l.mask!=o||l.context!=a)&&(this.updateCachedToken(l,u,e),l.mask=o,l.context=a),l.lookAhead>l.end+25&&(s=Math.max(l.lookAhead,s)),0!=l.value)){var f=t;if(l.extended>-1&&(t=this.addActions(e,l.extended,l.end,t)),t=this.addActions(e,l.value,l.end,t),!u.extend&&(n=l,t>f))break}}for(;this.actions.length>t;)this.actions.pop();return s&&e.setLookAhead(s),n||e.pos!=this.stream.end||((n=new fZ).value=e.p.parser.eofTerm,n.start=n.end=e.pos,t=this.addActions(e,n.value,n.end,t)),this.mainToken=n,this.actions}},{key:"getMainToken",value:function(e){if(this.mainToken)return this.mainToken;var t=new fZ,n=e.pos,r=e.p;return t.start=n,t.end=Math.min(n+1,r.stream.end),t.value=n==r.stream.end?r.parser.eofTerm:0,t}},{key:"updateCachedToken",value:function(e,t,n){var r=this.stream.clipPos(n.pos);if(t.token(this.stream.reset(r,e),n),e.value>-1){for(var i=n.p.parser,o=0;o<i.specialized.length;o++)if(i.specialized[o]==e.value){var a=i.specializers[o](this.stream.read(e.start,e.end),n);if(a>=0&&n.p.parser.dialect.allows(a>>1)){0==(1&a)?e.value=a>>1:e.extended=a>>1;break}}}else e.value=0,e.end=this.stream.clipPos(r+1);}},{key:"putAction",value:function(e,t,n,r){for(var i=0;i<r;i+=3)if(this.actions[i]==e)return r;return this.actions[r++]=e,this.actions[r++]=t,this.actions[r++]=n,r}},{key:"addActions",value:function(e,t,n,r){for(var i=e.state,o=e.p.parser,a=o.data,s=0;s<2;s++)for(var c=o.stateSlot(i,s?2:1);;c+=3){if(65535==a[c]){if(1!=a[c+1]){0==r&&2==a[c+1]&&(r=this.putAction(_Z(a,c+2),t,n,r));break}c=_Z(a,c+2);}a[c]==t&&(r=this.putAction(_Z(a,c+1),t,n,r));}return r}}]),e}();!function(e){e[e.Distance=5]="Distance",e[e.MaxRemainingPerStep=3]="MaxRemainingPerStep",e[e.MinBufferLengthPrune=500]="MinBufferLengthPrune",e[e.ForceReduceLimit=10]="ForceReduceLimit",e[e.CutDepth=15e3]="CutDepth",e[e.CutTo=9e3]="CutTo";}(wZ||(wZ={}));var jZ=function(){function e(t,n,r,i){Bi(this,e),this.parser=t,this.input=n,this.ranges=i,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.stream=new dZ(n,i),this.tokens=new kZ(t,this.stream),this.topTerm=t.top[1];var o=i[0].from;this.stacks=[sZ.start(this,t.top[0],o)],this.fragments=r.length&&this.stream.end-o>4*t.bufferLength?new xZ(r,t.nodeSet):null;}return qi(e,[{key:"parsedPos",get:function(){return this.minStackPos}},{key:"advance",value:function(){for(var e,t,n=this.stacks,r=this.minStackPos,i=this.stacks=[],o=0;o<n.length;o++)for(var a=n[o];;){if(this.tokens.mainToken=null,a.pos>r)i.push(a);else {if(this.advanceStack(a,i,n))continue;e||(e=[],t=[]),e.push(a);var s=this.tokens.getMainToken(a);t.push(s.value,s.end);}break}if(!i.length){var c=e&&function(e){var t,n=null,r=wi(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=i.p.stoppedAt;(i.pos==i.p.stream.end||null!=o&&i.pos>o)&&i.p.parser.stateFlag(i.state,2)&&(!n||n.score<i.score)&&(n=i);}}catch(e){r.e(e);}finally{r.f();}return n}(e);if(c)return this.stackToTree(c);if(this.parser.strict)throw gZ&&e&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+r);this.recovering||(this.recovering=5);}if(this.recovering&&e){var u=null!=this.stoppedAt&&e[0].pos>this.stoppedAt?e[0]:this.runRecovery(e,t,i);if(u)return this.stackToTree(u.forceAll())}if(this.recovering){var l=1==this.recovering?1:3*this.recovering;if(i.length>l)for(i.sort((function(e,t){return t.score-e.score}));i.length>l;)i.pop();i.some((function(e){return e.reducePos>r}))&&this.recovering--;}else if(i.length>1)e:for(var f=0;f<i.length-1;f++)for(var h=i[f],d=f+1;d<i.length;d++){var v=i[d];if(h.sameState(v)||h.buffer.length>500&&v.buffer.length>500){if(!((h.score-v.score||h.buffer.length-v.buffer.length)>0)){i.splice(f--,1);continue e}i.splice(d--,1);}}this.minStackPos=i[0].pos;for(var p=1;p<i.length;p++)i[p].pos<this.minStackPos&&(this.minStackPos=i[p].pos);return null}},{key:"stopAt",value:function(e){if(null!=this.stoppedAt&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e;}},{key:"advanceStack",value:function(e,t,n){var r=e.pos,i=this.parser,o=gZ?this.stackID(e)+" -> ":"";if(null!=this.stoppedAt&&r>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments)for(var a=e.curContext&&e.curContext.tracker.strict,s=a?e.curContext.hash:0,c=this.fragments.nodeAt(r);c;){var u=this.parser.nodeSet.types[c.type.id]==c.type?i.getGoto(e.state,c.type.id):-1;if(u>-1&&c.length&&(!a||(c.prop(pU.contextHash)||0)==s))return e.useNode(c,u),gZ&&console.log(o+this.stackID(e)+" (via reuse of ".concat(i.getName(c.type.id),")")),!0;if(!(c instanceof kU)||0==c.children.length||c.positions[0]>0)break;var l=c.children[0];if(!(l instanceof kU&&0==c.positions[0]))break;c=l;}var f=i.stateSlot(e.state,4);if(f>0)return e.reduce(f),gZ&&console.log(o+this.stackID(e)+" (via always-reduce ".concat(i.getName(65535&f),")")),!0;if(e.stack.length>=15e3)for(;e.stack.length>9e3&&e.forceReduce(););for(var h=this.tokens.getActions(e),d=0;d<h.length;){var v=h[d++],p=h[d++],m=h[d++],g=d==h.length||!n,y=g?e:e.split();if(y.apply(v,p,m),gZ&&console.log(o+this.stackID(y)+" (via ".concat(0==(65536&v)?"shift":"reduce of ".concat(i.getName(65535&v))," for ").concat(i.getName(p)," @ ").concat(r).concat(y==e?"":", split",")")),g)return !0;y.pos>r?t.push(y):n.push(y);}return !1}},{key:"advanceFully",value:function(e,t){for(var n=e.pos;;){if(!this.advanceStack(e,null,null))return !1;if(e.pos>n)return SZ(e,t),!0}}},{key:"runRecovery",value:function(e,t,n){for(var r=null,i=!1,o=0;o<e.length;o++){var a=e[o],s=t[o<<1],c=t[1+(o<<1)],u=gZ?this.stackID(a)+" -> ":"";if(a.deadEnd){if(i)continue;if(i=!0,a.restart(),gZ&&console.log(u+this.stackID(a)+" (restarted)"),this.advanceFully(a,n))continue}for(var l=a.split(),f=u,h=0;l.forceReduce()&&h<10;h++){if(gZ&&console.log(f+this.stackID(l)+" (via force-reduce)"),this.advanceFully(l,n))break;gZ&&(f=this.stackID(l)+" -> ");}var d,v=wi(a.recoverByInsert(s));try{for(v.s();!(d=v.n()).done;){var p=d.value;gZ&&console.log(u+this.stackID(p)+" (via recover-insert)"),this.advanceFully(p,n);}}catch(e){v.e(e);}finally{v.f();}this.stream.end>a.pos?(c==a.pos&&(c++,s=0),a.recoverByDelete(s,c),gZ&&console.log(u+this.stackID(a)+" (via recover-delete ".concat(this.parser.getName(s),")")),SZ(a,n)):(!r||r.score<a.score)&&(r=a);}return r}},{key:"stackToTree",value:function(e){return e.close(),kU.build({buffer:lZ.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}},{key:"stackID",value:function(e){var t=(yZ||(yZ=new WeakMap)).get(e);return t||yZ.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}]),e}();function SZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(r.pos==e.pos&&r.sameState(e))return void(t[n].score<e.score&&(t[n]=e))}t.push(e);}var CZ=function(){function e(t,n,r){Bi(this,e),this.source=t,this.flags=n,this.disabled=r;}return qi(e,[{key:"allows",value:function(e){return !this.disabled||0==this.disabled[e]}}]),e}(),$Z=function(e){Pi(n,zU);var t=Ri(n);function n(e){var r,i;if(Bi(this,n),(i=t.call(this)).wrappers=[],14!=e.version)throw new RangeError("Parser version (".concat(e.version,") doesn't match runtime version (",14,")"));var o=e.nodeNames.split(" ");i.minRepeatTerm=o.length;for(var a=0;a<e.repeatNodeCount;a++)o.push("");for(var s=Object.keys(e.topRules).map((function(t){return e.topRules[t][1]})),c=[],u=0;u<o.length;u++)c.push([]);function l(e,t,n){c[e].push([t,t.deserialize(String(n))]);}if(e.nodeProps){var f,h=wi(e.nodeProps);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=d[0];"string"==typeof v&&(v=pU[v]);for(var p=1;p<d.length;){var m=d[p++];if(m>=0)l(m,v,d[p++]);else {for(var g=d[p+-m],y=-m;y>0;y--)l(d[p++],v,g);p++;}}}}catch(e){h.e(e);}finally{h.f();}}i.nodeSet=new bU(o.map((function(t,n){return gU.define({name:n>=i.minRepeatTerm?void 0:t,id:n,props:c[n],top:s.indexOf(n)>-1,error:0==n,skipped:e.skippedNodes&&e.skippedNodes.indexOf(n)>-1})}))),e.propSources&&(i.nodeSet=(r=i.nodeSet).extend.apply(r,Vi(e.propSources))),i.strict=!1,i.bufferLength=1024;var b=pZ(e.tokenData);i.context=e.context,i.specializerSpecs=e.specialized||[],i.specialized=new Uint16Array(i.specializerSpecs.length);for(var w=0;w<i.specializerSpecs.length;w++)i.specialized[w]=i.specializerSpecs[w].term;return i.specializers=i.specializerSpecs.map(MZ),i.states=pZ(e.states,Uint32Array),i.data=pZ(e.stateData),i.goto=pZ(e.goto),i.maxTerm=e.maxTerm,i.tokenizers=e.tokenizers.map((function(e){return "number"==typeof e?new vZ(b,e):e})),i.topRules=e.topRules,i.dialects=e.dialects||{},i.dynamicPrecedences=e.dynamicPrecedences||null,i.tokenPrecTable=e.tokenPrec,i.termNames=e.termNames||null,i.maxNode=i.nodeSet.types.length-1,i.dialect=i.parseDialect(),i.top=i.topRules[Object.keys(i.topRules)[0]],i}return qi(n,[{key:"createParse",value:function(e,t,n){var r,i=new jZ(this,e,t,n),o=wi(this.wrappers);try{for(o.s();!(r=o.n()).done;){i=(0,r.value)(i,e,t,n);}}catch(e){o.e(e);}finally{o.f();}return i}},{key:"getGoto",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.goto;if(t>=r[0])return -1;for(var i=r[t+1];;){var o=r[i++],a=1&o,s=r[i++];if(a&&n)return s;for(var c=i+(o>>1);i<c;i++)if(r[i]==e)return s;if(a)return -1}}},{key:"hasAction",value:function(e,t){for(var n=this.data,r=0;r<2;r++)for(var i,o=this.stateSlot(e,r?2:1);;o+=3){if(65535==(i=n[o])){if(1!=n[o+1]){if(2==n[o+1])return _Z(n,o+2);break}i=n[o=_Z(n,o+2)];}if(i==t||0==i)return _Z(n,o+1)}return 0}},{key:"stateSlot",value:function(e,t){return this.states[6*e+t]}},{key:"stateFlag",value:function(e,t){return (this.stateSlot(e,0)&t)>0}},{key:"validAction",value:function(e,t){if(t==this.stateSlot(e,4))return !0;for(var n=this.stateSlot(e,1);;n+=3){if(65535==this.data[n]){if(1!=this.data[n+1])return !1;n=_Z(this.data,n+2);}if(t==_Z(this.data,n+1))return !0}}},{key:"nextStates",value:function(e){for(var t=this,n=[],r=function(e){if(65535==t.data[e]){if(1!=t.data[e+1])return i=e,"break";e=_Z(t.data,e+2);}if(0==(1&t.data[e+2])){var r=t.data[e+1];n.some((function(e,t){return 1&t&&e==r}))||n.push(t.data[e],r);}i=e;},i=this.stateSlot(e,1);;i+=3){if("break"===r(i))break}return n}},{key:"overrides",value:function(e,t){var n=OZ(this.data,this.tokenPrecTable,t);return n<0||OZ(this.data,this.tokenPrecTable,e)<n}},{key:"configure",value:function(e){var t,r=Object.assign(Object.create(n.prototype),this);if(e.props&&(r.nodeSet=(t=this.nodeSet).extend.apply(t,Vi(e.props))),e.top){var i=this.topRules[e.top];if(!i)throw new RangeError("Invalid top rule name ".concat(e.top));r.top=i;}return e.tokenizers&&(r.tokenizers=this.tokenizers.map((function(t){var n=e.tokenizers.find((function(e){return e.from==t}));return n?n.to:t}))),e.specializers&&(r.specializers=this.specializers.slice(),r.specializerSpecs=this.specializerSpecs.map((function(t,n){var i=e.specializers.find((function(e){return e.from==t.external}));if(!i)return t;var o=Object.assign(Object.assign({},t),{external:i.to});return r.specializers[n]=MZ(o),o}))),e.contextTracker&&(r.context=e.contextTracker),e.dialect&&(r.dialect=this.parseDialect(e.dialect)),null!=e.strict&&(r.strict=e.strict),e.wrap&&(r.wrappers=r.wrappers.concat(e.wrap)),null!=e.bufferLength&&(r.bufferLength=e.bufferLength),r}},{key:"hasWrappers",value:function(){return this.wrappers.length>0}},{key:"getName",value:function(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}},{key:"eofTerm",get:function(){return this.maxNode+1}},{key:"topNode",get:function(){return this.nodeSet.types[this.top[1]]}},{key:"dynamicPrecedence",value:function(e){var t=this.dynamicPrecedences;return null==t?0:t[e]||0}},{key:"parseDialect",value:function(e){var t=Object.keys(this.dialects),n=t.map((function(){return !1}));if(e){var r,i=wi(e.split(" "));try{for(i.s();!(r=i.n()).done;){var o=r.value,a=t.indexOf(o);a>=0&&(n[a]=!0);}}catch(e){i.e(e);}finally{i.f();}}for(var s=null,c=0;c<t.length;c++)if(!n[c])for(var u,l=this.dialects[t[c]];65535!=(u=this.data[l++]);)(s||(s=new Uint8Array(this.maxTerm+1)))[u]=1;return new CZ(e,n,s)}}],[{key:"deserialize",value:function(e){return new n(e)}}]),n}();function _Z(e,t){return e[t]|e[t+1]<<16}function OZ(e,t,n){for(var r,i=t;65535!=(r=e[i]);i++)if(r==n)return i-t;return -1}function MZ(e){if(e.external){var t=e.extend?1:0;return function(n,r){return e.external(n,r)<<1|t}}return e.get}var EZ=JU({String:mJ.string,Number:mJ.number,"True False":mJ.bool,PropertyName:mJ.propertyName,Null:mJ.null,",":mJ.separator,"[ ]":mJ.squareBracket,"{ }":mJ.brace}),AZ=$Z.deserialize({version:14,states:"$bOVQPOOOOQO'#Cb'#CbOnQPO'#CeOvQPO'#CjOOQO'#Cp'#CpQOQPOOOOQO'#Cg'#CgO}QPO'#CfO!SQPO'#CrOOQO,59P,59PO![QPO,59PO!aQPO'#CuOOQO,59U,59UO!iQPO,59UOVQPO,59QOqQPO'#CkO!nQPO,59^OOQO1G.k1G.kOVQPO'#ClO!vQPO,59aOOQO1G.p1G.pOOQO1G.l1G.lOOQO,59V,59VOOQO-E6i-E6iOOQO,59W,59WOOQO-E6j-E6j",stateData:"#O~OcOS~OQSORSOSSOTSOWQO]ROePO~OVXOeUO~O[[O~PVOg^O~Oh_OVfX~OVaO~OhbO[iX~O[dO~Oh_OVfa~OhbO[ia~O",goto:"!kjPPPPPPkPPkqwPPk{!RPPP!XP!ePP!hXSOR^bQWQRf_TVQ_Q`WRg`QcZRicQTOQZRQe^RhbRYQR]R",nodeNames:" JsonText True False Null Number String } { Object Property PropertyName ] [ Array",maxTerm:25,nodeProps:[["openedBy",7,"{",12,"["],["closedBy",8,"}",13,"]"]],propSources:[EZ],skippedNodes:[0],repeatNodeCount:2,tokenData:"(p~RaXY!WYZ!W]^!Wpq!Wrs!]|}$i}!O$n!Q!R$w!R![&V![!]&h!}#O&m#P#Q&r#Y#Z&w#b#c'f#h#i'}#o#p(f#q#r(k~!]Oc~~!`Upq!]qr!]rs!rs#O!]#O#P!w#P~!]~!wOe~~!zXrs!]!P!Q!]#O#P!]#U#V!]#Y#Z!]#b#c!]#f#g!]#h#i!]#i#j#g~#jR!Q![#s!c!i#s#T#Z#s~#vR!Q![$P!c!i$P#T#Z$P~$SR!Q![$]!c!i$]#T#Z$]~$`R!Q![!]!c!i!]#T#Z!]~$nOh~~$qQ!Q!R$w!R![&V~$|RT~!O!P%V!g!h%k#X#Y%k~%YP!Q![%]~%bRT~!Q![%]!g!h%k#X#Y%k~%nR{|%w}!O%w!Q![%}~%zP!Q![%}~&SPT~!Q![%}~&[ST~!O!P%V!Q![&V!g!h%k#X#Y%k~&mOg~~&rO]~~&wO[~~&zP#T#U&}~'QP#`#a'T~'WP#g#h'Z~'^P#X#Y'a~'fOR~~'iP#i#j'l~'oP#`#a'r~'uP#`#a'x~'}OS~~(QP#f#g(T~(WP#i#j(Z~(^P#X#Y(a~(fOQ~~(kOW~~(pOV~",tokenizers:[0],topRules:{JsonText:[0,1]},tokenPrec:0}),PZ=xJ.define({name:"json",parser:AZ.configure({props:[BJ.add({Object:HJ({except:/^\s*\}/}),Array:HJ({except:/^\s*\]/})}),JJ.add({"Object Array":function(e){var t=e.firstChild,n=e.lastChild;return t&&t.to<n.from?{from:t.to,to:n.type.isError?e.to:n.from}:null}})]}),languageData:{closeBrackets:{brackets:["[","{",'"']},indentOnInput:/^\s*[\}\]]$/}});function TZ(e){bo(e,"svelte-1oo7hnc",".jse-status-bar.svelte-1oo7hnc.svelte-1oo7hnc{background:var(--jse-panel-background);color:var(--jse-panel-color-readonly);font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);margin:0;border-top:var(--jse-panel-border);border-left:var(--jse-main-border);border-right:var(--jse-main-border);display:flex;gap:var(--jse-padding)}.jse-status-bar.svelte-1oo7hnc.svelte-1oo7hnc:last-child{border-bottom:var(--jse-main-border)}.jse-status-bar.svelte-1oo7hnc .jse-status-bar-info.svelte-1oo7hnc{padding:2px}");}function RZ(e){var t,n,r;return {c:function(){t=$o("div"),n=Oo("Line: "),r=Oo(e[0]),Ro(t,"class","jse-status-bar-info svelte-1oo7hnc");},m:function(e,i){jo(e,t,i),yo(t,n),yo(t,r);},p:function(e,t){1&t&&Lo(r,e[0]);},d:function(e){e&&So(t);}}}function NZ(e){var t,n,r;return {c:function(){t=$o("div"),n=Oo("Column: "),r=Oo(e[1]),Ro(t,"class","jse-status-bar-info svelte-1oo7hnc");},m:function(e,i){jo(e,t,i),yo(t,n),yo(t,r);},p:function(e,t){2&t&&Lo(r,e[1]);},d:function(e){e&&So(t);}}}function IZ(e){var t,n,r,i;return {c:function(){t=$o("div"),n=Oo("Selection: "),r=Oo(e[2]),i=Oo(" characters"),Ro(t,"class","jse-status-bar-info svelte-1oo7hnc");},m:function(e,o){jo(e,t,o),yo(t,n),yo(t,r),yo(t,i);},p:function(e,t){4&t&&Lo(r,e[2]);},d:function(e){e&&So(t);}}}function DZ(e){var t,n,r,i=void 0!==e[0]&&RZ(e),o=void 0!==e[1]&&NZ(e),a=void 0!==e[2]&&e[2]>0&&IZ(e);return {c:function(){t=$o("div"),i&&i.c(),n=Mo(),o&&o.c(),r=Mo(),a&&a.c(),Ro(t,"class","jse-status-bar svelte-1oo7hnc");},m:function(e,s){jo(e,t,s),i&&i.m(t,null),yo(t,n),o&&o.m(t,null),yo(t,r),a&&a.m(t,null);},p:function(e,s){var c=Si(s,1)[0];void 0!==e[0]?i?i.p(e,c):((i=RZ(e)).c(),i.m(t,n)):i&&(i.d(1),i=null),void 0!==e[1]?o?o.p(e,c):((o=NZ(e)).c(),o.m(t,r)):o&&(o.d(1),o=null),void 0!==e[2]&&e[2]>0?a?a.p(e,c):((a=IZ(e)).c(),a.m(t,null)):a&&(a.d(1),a=null);},i:Ki,o:Ki,d:function(e){e&&So(t),i&&i.d(),o&&o.d(),a&&a.d();}}}function LZ(e,t,n){var r,i,o,a,s,c=t.editorState;return e.$$set=function(e){"editorState"in e&&n(3,c=e.editorState);},e.$$.update=function(){var t,u,l,f,h,d,v,p;8&e.$$.dirty&&n(4,r=null===(t=c)||void 0===t||null===(u=t.selection)||void 0===u||null===(l=u.main)||void 0===l?void 0:l.head);24&e.$$.dirty&&n(5,i=null===(f=c)||void 0===f||null===(h=f.doc)||void 0===h?void 0:h.lineAt(r));(32&e.$$.dirty&&n(0,o=i?i.number:void 0),48&e.$$.dirty&&n(1,a=i?r-i.from+1:void 0),8&e.$$.dirty)&&n(2,s=null===(d=c)||void 0===d||null===(v=d.selection)||void 0===v||null===(p=v.ranges)||void 0===p?void 0:p.reduce((function(e,t){return e+t.to-t.from}),0));},[o,a,s,c,r,i]}var BZ=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,LZ,DZ,to,{editorState:3},TZ),r}return qi(n)}(),zZ=hK.define([{tag:mJ.propertyName,color:"var(--jse-key-color)"},{tag:mJ.number,color:"var(--jse-value-color-number)"},{tag:mJ.bool,color:"var(--jse-value-color-boolean)"},{tag:mJ.string,color:"var(--jse-value-color-string)"},{tag:mJ.keyword,color:"var(--jse-value-color-null)"}]),qZ=mK(zZ),FZ=zZ.style;function VZ(e){var t=e.selection.main.head;return e.doc.lineAt(t)}function WZ(e,t){var n=0;e:for(var r=0;r<e.length;r++)switch(e[r]){case" ":n+=1;continue e;case"\t":n+=t-n%t;continue e;case"\r":continue e;default:break e}return n}zZ.style=function(e){return FZ(e||[])};var HZ=vB.define({combine:function(e){return nz(e,{highlightActiveBlock:!0,hideFirstIndent:!1})}}),UZ=function(){function e(t,n,r){Bi(this,e),this.lines=t,this.state=n,this.map=new Map,this.unitWidth=r;var i,o=wi(this.lines);try{for(o.s();!(i=o.n()).done;){var a=i.value;this.add(a);}}catch(e){o.e(e);}finally{o.f();}this.state.facet(HZ).highlightActiveBlock&&this.findAndSetActiveLines();}return qi(e,[{key:"has",value:function(e){return this.map.has("number"==typeof e?e:e.number)}},{key:"get",value:function(e){var t=this.map.get("number"==typeof e?e:e.number);if(!t)throw new Error("Line not found in indentation map");return t}},{key:"set",value:function(e,t,n){var r=!e.text.trim().length,i={line:e,col:t,level:n,empty:r};return this.map.set(i.line.number,i),i}},{key:"add",value:function(e){if(this.has(e))return this.get(e);if(!e.length||!e.text.trim().length){if(1===e.number)return this.set(e,0,0);if(e.number===this.state.doc.lines){var t=this.closestNonEmpty(e,-1);return this.set(e,0,t.level)}var n=this.closestNonEmpty(e,-1),r=this.closestNonEmpty(e,1);return n.level>=r.level?this.set(e,0,n.level):n.empty&&0===n.level&&0!==r.level?this.set(e,0,0):r.level>n.level?this.set(e,0,n.level+1):this.set(e,0,r.level)}var i=WZ(e.text,this.state.tabSize),o=Math.floor(i/this.unitWidth);return this.set(e,i,o)}},{key:"closestNonEmpty",value:function(e,t){for(var n=e.number+t;-1===t?n>=1:n<=this.state.doc.lines;){if(this.has(n)){var r=this.get(n);if(!r.empty)return r}var i=this.state.doc.line(n);if(i.text.trim().length){var o=WZ(i.text,this.state.tabSize),a=Math.floor(o/this.unitWidth);return this.set(i,o,a)}n+=t;}var s=this.state.doc.line(-1===t?1:this.state.doc.lines);return this.set(s,0,0)}},{key:"findAndSetActiveLines",value:function(){var e=VZ(this.state);if(this.has(e)){var t=this.get(e);if(this.has(t.line.number+1)){var n=this.get(t.line.number+1);n.level>t.level&&(t=n);}if(this.has(t.line.number-1)){var r=this.get(t.line.number-1);r.level>t.level&&(t=r);}if(0!==t.level){var i,o;for(t.active=t.level,i=t.line.number;i>1;i--)if(this.has(i-1)){var a=this.get(i-1);if(a.level<t.level)break;a.active=t.level;}for(o=t.line.number;o<this.state.doc.lines;o++)if(this.has(o+1)){var s=this.get(o+1);if(s.level<t.level)break;s.active=t.level;}}}}}]),e}(),JZ=jW.baseTheme({"&light":{"--indent-marker-bg-color":"#F0F1F2","--indent-marker-active-bg-color":"#E4E5E6"},"&dark":{"--indent-marker-bg-color":"#2B3245","--indent-marker-active-bg-color":"#3C445C"},".cm-line":{position:"relative"},".cm-indent-markers::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,background:"var(--indent-markers)",pointerEvents:"none",zIndex:"-1"}});function KZ(e,t,n,r){var i="repeating-linear-gradient(to right, var(".concat(e,") 0 ").concat("1px",", transparent ").concat("1px"," ").concat(t,"ch)");return "".concat(i," ").concat(n*t,".5ch/calc(").concat(t*r,"ch - 1px) no-repeat")}function GZ(e,t,n){var r=e.level,i=e.active;if(n&&0===r)return [];var o=n?1:0,a=[];if(void 0!==i){var s=i-o-1;s>0&&a.push(KZ("--indent-marker-bg-color",t,o,s)),a.push(KZ("--indent-marker-active-bg-color",t,i-1,1)),i!==r&&a.push(KZ("--indent-marker-bg-color",t,i,r-i));}else a.push(KZ("--indent-marker-bg-color",t,o,r-o));return a.join(",")}var QZ=function(){function e(t){Bi(this,e),this.view=t,this.unitWidth=NJ(t.state),this.currentLineNumber=VZ(t.state).number,this.generate(t.state);}return qi(e,[{key:"update",value:function(e){var t=NJ(e.state),n=t!==this.unitWidth;n&&(this.unitWidth=t);var r=VZ(e.state).number,i=r!==this.currentLineNumber;this.currentLineNumber=r;var o=e.state.facet(HZ).highlightActiveBlock&&i;(e.docChanged||e.viewportChanged||n||o)&&this.generate(e.state);}},{key:"generate",value:function(e){var t,n=new uz,r=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.state,r=new Set,i=wi(e.visibleRanges);try{for(i.s();!(t=i.n()).done;)for(var o=t.value,a=o.from,s=o.to,c=a;c<=s;){var u=n.doc.lineAt(c);r.has(u)||r.add(u),c=u.to+1;}}catch(e){i.e(e);}finally{i.f();}return r}(this.view,e),i=new UZ(r,e,this.unitWidth),o=e.facet(HZ).hideFirstIndent,a=wi(r);try{for(a.s();!(t=a.n()).done;){var s=t.value,c=i.get(s.number);if(null==c?void 0:c.level){var u=GZ(c,this.unitWidth,o);n.add(s.from,s.from,Dq.line({class:"cm-indent-markers",attributes:{style:"--indent-markers: ".concat(u)}}));}}}catch(e){a.e(e);}finally{a.f();}this.decorations=n.finish();}}]),e}();function YZ(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return [HZ.of(e),JZ,uF.fromClass(QZ,{decorations:function(e){return e.decorations}})]}function XZ(e){bo(e,"svelte-1yqirn0",'.jse-text-mode.svelte-1yqirn0.svelte-1yqirn0{flex:1;box-sizing:border-box;display:flex;flex-direction:column;background:var(--jse-background-color)}.jse-text-mode.no-main-menu.svelte-1yqirn0.svelte-1yqirn0{border-top:var(--jse-main-border)}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0{flex:1;display:flex;position:relative;flex-direction:column;overflow:hidden;min-width:0;min-height:0;border-left:var(--jse-main-border);border-right:var(--jse-main-border)}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0:last-child{border-bottom:var(--jse-main-border)}.jse-text-mode.svelte-1yqirn0 .jse-contents.jse-hidden.svelte-1yqirn0{visibility:hidden;position:absolute;top:0;left:0}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor{flex:1;overflow:hidden}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-scroller{font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);line-height:var(--jse-line-height);color:var(--jse-delimiter-color)}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-gutters{background:var(--jse-panel-background);color:var(--jse-panel-color-readonly);border-right:var(--jse-panel-border)}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-activeLine,.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-activeLineGutter{background:var(--jse-active-line-background-color)}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-selectionBackground{background:var(--jse-selection-background-color)}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-searchMatch{background-color:var(--jse-search-match-color);outline:var(--jse-search-match-outline)}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-searchMatch.cm-searchMatch-selected{background-color:var(--jse-search-match-active-color);outline:var(--jse-search-match-active-outline)}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-selectionMatch{background-color:var(--jse-search-match-background-color)}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-foldPlaceholder{background:var(--jse-tag-background);color:var(--jse-tag-color);border:none;padding:0 var(--jse-padding)}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-tooltip{font-size:var(--jse-font-size);font-family:var(--jse-font-family);color:var(--jse-tooltip-color);background:var(--jse-tooltip-background);border:var(--jse-tooltip-border)}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-diagnosticAction{background:var(--jse-tooltip-action-button-color);background:var(--jse-tooltip-action-button-background)}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-panels{border-bottom:var(--jse-panel-border)}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-search{background:var(--jse-panel-background);color:var(--jse-panel-color);font-family:var(--jse-font-family);font-size:var(--jse-font-size)}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-search input{font-family:var(--jse-font-family);font-size:var(--jse-font-size-text-mode-search);color:var(--jse-input-color);border:var(--jse-input-border);background:var(--jse-input-background);margin-right:2px}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-search button{font-family:var(--jse-font-family);font-size:var(--jse-font-size-text-mode-search);color:var(--jse-panel-button-color);background:var(--jse-panel-button-background);border:none;cursor:pointer;text-transform:capitalize;padding:calc(0.5 * var(--jse-padding)) var(--jse-padding);margin:0}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-search button:hover{color:var(--jse-panel-button-color-highlight);background:var(--jse-panel-button-background-highlight)}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-search label{font-family:var(--jse-font-family);font-size:var(--jse-font-size-text-mode-search);padding-left:var(--jse-padding)}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-search label input{margin-right:2px}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-search button[name="close"]{width:32px;height:32px;font-size:24px;line-height:24px;padding:0;right:0;top:-4px}.jse-text-mode.svelte-1yqirn0 .jse-contents.svelte-1yqirn0 .cm-editor .cm-cursor-primary{border-color:var(--jse-text-color)}.jse-text-mode.svelte-1yqirn0 .jse-contents .jse-loading-space.svelte-1yqirn0{flex:1}.jse-text-mode.svelte-1yqirn0 .jse-contents .jse-loading.svelte-1yqirn0{flex:2;text-align:center;color:var(--jse-panel-color-readonly);box-sizing:border-box;font-family:var(--jse-font-family);font-size:var(--jse-font-size)}.jse-text-mode.svelte-1yqirn0 .jse-contents.jse-preview.svelte-1yqirn0{flex:1;color:var(--jse-panel-color-readonly);overflow:auto;white-space:pre-wrap;word-break:break-word;padding:2px}');}function ZZ(e){var t=e.slice(),n=0===t[10].length;return t[93]=n,t}function e0(e){var t,n;return t=new AL({props:{readOnly:e[1],onFormat:e[16],onCompact:e[17],onSort:e[18],onTransform:e[19],onToggleSearch:e[20],onUndo:e[21],onRedo:e[22],canFormat:!e[93],canCompact:!e[93],canSort:!e[93],canTransform:!e[93],canUndo:e[11],canRedo:e[12],onRenderMenu:e[4]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};2&n[0]&&(r.readOnly=e[1]),1024&n[0]&&(r.canFormat=!e[93]),1024&n[0]&&(r.canCompact=!e[93]),1024&n[0]&&(r.canSort=!e[93]),1024&n[0]&&(r.canTransform=!e[93]),2048&n[0]&&(r.canUndo=e[11]),4096&n[0]&&(r.canRedo=e[12]),16&n[0]&&(r.onRenderMenu=e[4]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function t0(e){var t;return {c:function(){(t=$o("div")).innerHTML='<div class="jse-loading-space svelte-1yqirn0"></div> \n      <div class="jse-loading svelte-1yqirn0">loading...</div>',Ro(t,"class","jse-contents svelte-1yqirn0");},m:function(e,n){jo(e,t,n);},p:Ki,i:Ki,o:Ki,d:function(e){e&&So(t);}}}function n0(e){var t,n,r,i,o,a=e[92]&&r0(e),s=!e[92]&&i0(e);return {c:function(){t=$o("div"),n=Mo(),a&&a.c(),r=Mo(),s&&s.c(),i=Eo(),Ro(t,"class","jse-contents svelte-1yqirn0"),Fo(t,"jse-hidden",e[92]);},m:function(c,u){jo(c,t,u),e[50](t),jo(c,n,u),a&&a.m(c,u),jo(c,r,u),s&&s.m(c,u),jo(c,i,u),o=!0;},p:function(e,n){(!o||134219008&n[0])&&Fo(t,"jse-hidden",e[92]),e[92]?a?(a.p(e,n),1280&n[0]&&$a(a,1)):((a=r0(e)).c(),$a(a,1),a.m(r.parentNode,r)):a&&(Sa(),_a(a,1,1,(function(){a=null;})),Ca()),e[92]?s&&(Sa(),_a(s,1,1,(function(){s=null;})),Ca()):s?(s.p(e,n),1280&n[0]&&$a(s,1)):((s=i0(e)).c(),$a(s,1),s.m(i.parentNode,i));},i:function(e){o||($a(a),$a(s),o=!0);},o:function(e){_a(a),_a(s),o=!1;},d:function(o){o&&So(t),e[50](null),o&&So(n),a&&a.d(o),o&&So(r),s&&s.d(o),o&&So(i);}}}function r0(e){var t,n,r,i,o,a=QC(e[10]||"",2e4)+"";return t=new CP({props:{icon:MM,type:"error",message:"The JSON document is larger than ".concat(OL(10485760,1024),", ")+"and may crash your browser when loading it in text mode. Actual size: ".concat(OL(e[10].length,1024),"."),actions:[{text:"Open anyway",title:"Open the document in text mode. This may freeze or crash your browser.",onClick:e[23]},{text:"Open in tree mode",title:"Open the document in tree mode. Tree mode can handle large documents.",onClick:e[24]},{text:"Cancel",title:"Cancel opening this large document.",onClick:e[25]}]}}),{c:function(){Da(t.$$.fragment),n=Mo(),r=$o("div"),i=Oo(a),Ro(r,"class","jse-contents jse-preview svelte-1yqirn0");},m:function(e,a){La(t,e,a),jo(e,n,a),jo(e,r,a),yo(r,i),o=!0;},p:function(e,n){var r={};1024&n[0]&&(r.message="The JSON document is larger than ".concat(OL(10485760,1024),", ")+"and may crash your browser when loading it in text mode. Actual size: ".concat(OL(e[10].length,1024),".")),t.$set(r),(!o||1024&n[0])&&a!==(a=QC(e[10]||"",2e4)+"")&&Lo(i,a);},i:function(e){o||($a(t.$$.fragment,e),o=!0);},o:function(e){_a(t.$$.fragment,e),o=!1;},d:function(e){Ba(t,e),e&&So(n),e&&So(r);}}}function i0(e){var t,n,r,i,o,a=!e[13]&&e[0]&&eC(e[10]),s=e[3]&&o0(e),c=e[13]&&a0(e),u=a&&s0(e);return i=new IP({props:{validationErrors:e[9],selectError:e[26]}}),{c:function(){s&&s.c(),t=Mo(),c&&c.c(),n=Mo(),u&&u.c(),r=Mo(),Da(i.$$.fragment);},m:function(e,a){s&&s.m(e,a),jo(e,t,a),c&&c.m(e,a),jo(e,n,a),u&&u.m(e,a),jo(e,r,a),La(i,e,a),o=!0;},p:function(e,o){e[3]?s?(s.p(e,o),8&o[0]&&$a(s,1)):((s=o0(e)).c(),$a(s,1),s.m(t.parentNode,t)):s&&(Sa(),_a(s,1,1,(function(){s=null;})),Ca()),e[13]?c?(c.p(e,o),8192&o[0]&&$a(c,1)):((c=a0(e)).c(),$a(c,1),c.m(n.parentNode,n)):c&&(Sa(),_a(c,1,1,(function(){c=null;})),Ca()),9217&o[0]&&(a=!e[13]&&e[0]&&eC(e[10])),a?u?(u.p(e,o),9217&o[0]&&$a(u,1)):((u=s0(e)).c(),$a(u,1),u.m(r.parentNode,r)):u&&(Sa(),_a(u,1,1,(function(){u=null;})),Ca());var l={};512&o[0]&&(l.validationErrors=e[9]),i.$set(l);},i:function(e){o||($a(s),$a(c),$a(u),$a(i.$$.fragment,e),o=!0);},o:function(e){_a(s),_a(c),_a(u),_a(i.$$.fragment,e),o=!1;},d:function(e){s&&s.d(e),e&&So(t),c&&c.d(e),e&&So(n),u&&u.d(e),e&&So(r),Ba(i,e);}}}function o0(e){var t,n;return t=new BZ({props:{editorState:e[7]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};128&n[0]&&(r.editorState=e[7]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function a0(e){var t,n;return t=new CP({props:{type:"error",icon:MM,message:e[13].message,actions:e[14],onClick:e[28]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};8192&n[0]&&(r.message=e[13].message),16384&n[0]&&(r.actions=e[14]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function s0(e){var t,n;return t=new CP({props:{type:"success",message:"Do you want to format the JSON?",actions:[{icon:sI,text:"Format",title:"Format JSON: add proper indentation and new lines (Ctrl+I)",onClick:e[16]},{icon:CM,text:"No thanks",title:"Close this message",onClick:e[51]}]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n[0]&&(r.actions=[{icon:sI,text:"Format",title:"Format JSON: add proper indentation and new lines (Ctrl+I)",onClick:e[16]},{icon:CM,text:"No thanks",title:"Close this message",onClick:e[51]}]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function c0(e){var t,n,r,i,o,a=e[2]&&e0(ZZ(e)),s=[n0,t0],c=[];function u(e,t){return 0===t?function(e){var t=e.slice(),n=t[27](t[10],t[8]);return t[92]=n,t}(e):e}return r=function(e,t){return e[15]?1:0}(e),i=c[r]=s[r](u(e,r)),{c:function(){t=$o("div"),a&&a.c(),n=Mo(),i.c(),Ro(t,"class","jse-text-mode svelte-1yqirn0"),Fo(t,"no-main-menu",!e[2]);},m:function(i,s){jo(i,t,s),a&&a.m(t,null),yo(t,n),c[r].m(t,null),e[52](t),o=!0;},p:function(e,s){e[2]?a?(a.p(ZZ(e),s),4&s[0]&&$a(a,1)):((a=e0(ZZ(e))).c(),$a(a,1),a.m(t,n)):a&&(Sa(),_a(a,1,1,(function(){a=null;})),Ca()),i.p(u(e,r),s),(!o||4&s[0])&&Fo(t,"no-main-menu",!e[2]);},i:function(e){o||($a(a),$a(i),o=!0);},o:function(e){_a(a),_a(i),o=!1;},d:function(n){n&&So(t),a&&a.d(),c[r].d(),e[52](null);}}}function u0(e){return {from:e.from||0,to:e.to||0,message:e.message||"",actions:e.actions,severity:e.severity}}function l0(e,t,n){var r,i,o,a,s,c,u=t.readOnly,l=t.mainMenuBar,f=t.statusBar,h=t.askToFormat,d=t.externalContent,v=t.indentation,p=t.tabSize,m=t.escapeUnicodeCharacters,g=t.parser,y=t.validator,b=t.validationParser,w=t.onChange,x=t.onChangeMode,k=t.onError,j=t.onFocus,S=t.onBlur,C=t.onRenderMenu,$=t.onSortModal,_=t.onTransformModal,O=Ha("jsoneditor:TextMode"),M={key:"Mod-i",run:K,shift:G,preventDefault:!0},E="undefined"==typeof window;O("isSSR:",E);var A=!1,P=[],T=new OB,R=new OB,N=new OB,I=new OB,D=new OB,L=d,B=JS(L,v,g),z=m;ea(ji(xi().mark((function e(){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!E){e.next=2;break}return e.abrupt("return");case 2:try{a=te({target:o,initialText:pe(B,A)?"":r.escapeValue(B),readOnly:u,indentation:v});}catch(e){console.error(e);}case 3:case"end":return e.stop()}}),e)})))),ta((function(){a&&(O("Destroy CodeMirror editor"),a.destroy());}));var q=!1,F=!1,V=Oj(),W=Oj();function H(){a&&(O("focus"),a.focus());}var U=!1;function J(e){O("patch",e);var t=g.parse(B),n=tc(t,e),r=vc(t,e);return oe({text:g.stringify(n,null,v)}),{json:n,previousJson:t,undo:r,redo:e}}function K(){if(O("format"),u)return !1;try{var e=g.parse(B);return oe({text:g.stringify(e,null,v)}),n(0,h=!0),!0}catch(e){k(e);}return !1}function G(){if(O("compact"),u)return !1;try{var e=g.parse(B);return oe({text:g.stringify(e)}),n(0,h=!1),!0}catch(e){k(e);}return !1}function Q(){if(O("repair"),!u)try{oe({text:su(B)}),n(49,me="valid"),n(13,ge=null);}catch(e){k(e);}}function Y(e){var t=e.id,n=e.rootPath,r=e.onTransform,i=e.onClose;try{var o=g.parse(B);U=!0,_({id:t||W,json:o,rootPath:n||[],onTransform:function(e){r?r({operations:e,json:o,transformedJson:tc(o,e)}):(O("onTransform",e),J(e));},onClose:function(){U=!1,H(),i&&i();}});}catch(e){k(e);}}function X(e,t){O("setSelection",{anchor:e,head:t}),a&&a.dispatch(a.state.update({selection:{anchor:e,head:t},scrollIntoView:!0}));}function Z(e,t){if(1===t.state.selection.ranges.length){var n=t.state.selection.ranges[0],r=B.slice(n.from,n.to);if("{"===r||"["===r){var i=bc.parse(B),o=Object.keys(i.pointers).find((function(e){var t;return (null===(t=i.pointers[e].value)||void 0===t?void 0:t.pos)===n.from})),a=i.pointers[o];if(o&&a&&a.value&&a.valueEnd)O("pointer found, selecting inner contents of path:",o,a),X(a.value.pos+1,a.valueEnd.pos-1);}}}function ee(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return [zX.of({source:e,config:t}),BX,nZ]}(ye,{delay:300})}function te(e){var t=e.target,r=e.initialText,i=e.readOnly,o=e.indentation;O("Create CodeMirror editor",{readOnly:i,indentation:o});var s=tz.create({doc:r,extensions:[PW.of([SQ,M]),T.of(ee()),iZ(),aZ,qZ,YZ({hideFirstIndent:!0}),jW.domEventHandlers({dblclick:Z}),jW.updateListener.of((function(e){n(7,c=e.state),e.docChanged&&he();})),new PJ(PZ),KQ({top:!0}),R.of(tz.readOnly.of(i)),I.of(tz.tabSize.of(p)),N.of(le(o)),D.of(jW.theme({},{dark:ne()})),jW.lineWrapping]});return a=new jW({state:s,parent:t})}function ne(){return !!o&&getComputedStyle(o).getPropertyValue("--jse-theme").includes("dark")}function re(e){var t=e.path,n=e.message,i=function(e,t){try{var n=bc.parse(e),r=Ys(t),i=n.pointers[r];if(i)return {path:t,line:i.key?i.key.line:i.value?i.value.line:0,column:i.key?i.key.column:i.value?i.value.column:0,from:i.key?i.key.pos:i.value?i.value.pos:0,to:i.keyEnd?i.keyEnd.pos:i.valueEnd?i.valueEnd.pos:0}}catch(e){console.error(e);}return null}(r.escapeValue(B),t);return {path:t,line:i.line,column:i.column,from:i.from,to:i.to,message:n,severity:us.warning,actions:[]}}function ie(e,t){var n=e.line,r=e.column,i=e.position,o=e.message;return {path:[],line:n,column:r,from:i,to:i,severity:us.error,message:o,actions:t&&!u?[{name:"Auto repair",apply:function(){return Q()}}]:null}}function oe(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=JS(e,v,g),o=!zy(e,L),s=L;L=e,n(10,B=i),O("setCodeMirrorContent",{isChanged:o,forceUpdate:t}),a&&(o||t)&&(pe(B,A)||a.dispatch({changes:{from:0,to:a.state.doc.length,insert:r.escapeValue(B)}}),fe(),o&&ve(L,s));}function ae(){return (ae=ji(xi().mark((function e(){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O("refresh"),e.next=3,ce();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(){if(a){var e=a?r.unescapeValue(a.state.doc.toString()):"",t=e!==B;if(O("onChangeCodeMirrorValue",{isChanged:t}),t){var i=L;n(10,B=e),L={text:B},fe(),ve(L,i);}}}function ce(){return ue.apply(this,arguments)}function ue(){return (ue=ji(xi().mark((function e(){var t;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,da();case 2:a&&(t=ne(),O("updateTheme",{dark:t}),a.dispatch({effects:[D.reconfigure(jW.theme({},{dark:t}))]}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(e){return RJ.of("number"==typeof e?" ".repeat(e):e)}function fe(){n(11,q=fG(a.state)>0),n(12,F=hG(a.state)>0),O({canUndo:q,canRedo:F});}ta((function(){de();})),gP({onMount:ea,onDestroy:ta,getWindow:function(){return wC(s)},hasFocus:function(){return U&&document.hasFocus()||xC(s)},onFocus:j,onBlur:function(){de(),S();}});var he=am(se,300);function de(){he.flush();}function ve(e,t){w&&w(e,t,{contentErrors:be(),patchResult:null});}function pe(e,t){return !!e&&e.length>10485760&&!t}var me="valid",ge=null;function ye(){if(pe(B,A))return [];var e=be();return QP(e)?[u0(ie(e.parseError,e.isRepairable))]:YP(e)?e.validationErrors.map(re).map(u0):[]}function be(){O("validate:start"),de();var e=we(r.escapeValue(B),y,g,b);return QP(e)?(n(49,me=e.isRepairable?"repairable":"invalid"),n(13,ge=e.parseError),n(9,P=[])):(n(49,me="valid"),n(13,ge=null),n(9,P=(null==e?void 0:e.validationErrors)||[])),O("validate:end"),e}var we=dD(pP);function xe(){ge&&function(e){O("select parse error",e);var t=ie(e,!1);X(t.from,t.to),H();}(ge);}var ke={icon:sM,text:"Show me",title:"Move to the parse error location",onClick:xe};return e.$$set=function(e){"readOnly"in e&&n(1,u=e.readOnly),"mainMenuBar"in e&&n(2,l=e.mainMenuBar),"statusBar"in e&&n(3,f=e.statusBar),"askToFormat"in e&&n(0,h=e.askToFormat),"externalContent"in e&&n(29,d=e.externalContent),"indentation"in e&&n(30,v=e.indentation),"tabSize"in e&&n(31,p=e.tabSize),"escapeUnicodeCharacters"in e&&n(32,m=e.escapeUnicodeCharacters),"parser"in e&&n(33,g=e.parser),"validator"in e&&n(34,y=e.validator),"validationParser"in e&&n(35,b=e.validationParser),"onChange"in e&&n(36,w=e.onChange),"onChangeMode"in e&&n(37,x=e.onChangeMode),"onError"in e&&n(38,k=e.onError),"onFocus"in e&&n(39,j=e.onFocus),"onBlur"in e&&n(40,S=e.onBlur),"onRenderMenu"in e&&n(4,C=e.onRenderMenu),"onSortModal"in e&&n(41,$=e.onSortModal),"onTransformModal"in e&&n(42,_=e.onTransformModal);},e.$$.update=function(){2&e.$$.dirty[1]&&(r=nC({escapeControlCharacters:!1,escapeUnicodeCharacters:m})),536870912&e.$$.dirty[0]&&oe(d),8&e.$$.dirty[1]&&function(e){O("updateLinter",e),a&&a.dispatch({effects:T.reconfigure(ee())});}(y),1073741824&e.$$.dirty[0]&&function(e){a&&(O("updateIndentation",e),a.dispatch({effects:N.reconfigure(le(e))}));}(v),1&e.$$.dirty[1]&&function(e){a&&(O("updateTabSize",e),a.dispatch({effects:I.reconfigure(tz.tabSize.of(e))}));}(p),2&e.$$.dirty[0]&&function(e){a&&(O("updateReadOnly",e),a.dispatch({effects:[R.reconfigure(tz.readOnly.of(e))]}));}(u),131074&e.$$.dirty[1]&&z!==m&&(n(48,z=m),O("forceUpdateText",{escapeUnicodeCharacters:m}),a&&a.dispatch({changes:{from:0,to:a.state.doc.length,insert:r.escapeValue(B)}})),2&e.$$.dirty[0]|262144&e.$$.dirty[1]&&n(14,i="repairable"!==me||u?[ke]:[{icon:aM,text:"Auto repair",title:"Automatically repair JSON",onClick:Q},ke]);},[h,u,l,f,C,o,s,c,A,P,B,q,F,ge,i,E,K,G,function(){var e;if(!u)try{var t=g.parse(B);U=!0,$({id:V,json:t,rootPath:[],onSort:(e=ji(xi().mark((function e(t){var n;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.operations,O("onSort",n),J(n);case 3:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)}),onClose:function(){U=!1,H();}});}catch(e){k(e);}},function(){u||Y({rootPath:[]});},function(){a&&(o&&o.querySelector(".cm-search")?xY(a):wY(a));},function(){u||a&&(aG(a),H());},function(){u||a&&(sG(a),H());},function(){n(8,A=!0),oe(d,!0);},function(){x(as.tree);},function(){se();},function(e){O("select validation error",e);var t=re(e);X(t.from,t.to),H();},pe,xe,d,v,p,m,g,y,b,w,x,k,j,S,$,_,H,J,Y,function(){return ae.apply(this,arguments)},be,z,me,function(e){sa[e?"unshift":"push"]((function(){n(5,o=e);}));},function(){return n(0,h=!1)},function(e){sa[e?"unshift":"push"]((function(){n(6,s=e);}));}]}var f0=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,l0,c0,no,{readOnly:1,mainMenuBar:2,statusBar:3,askToFormat:0,externalContent:29,indentation:30,tabSize:31,escapeUnicodeCharacters:32,parser:33,validator:34,validationParser:35,onChange:36,onChangeMode:37,onError:38,onFocus:39,onBlur:40,onRenderMenu:4,onSortModal:41,onTransformModal:42,focus:43,patch:44,openTransformModal:45,refresh:46,validate:47},XZ,[-1,-1,-1,-1]),r}return qi(n,[{key:"focus",get:function(){return this.$$.ctx[43]}},{key:"patch",get:function(){return this.$$.ctx[44]}},{key:"openTransformModal",get:function(){return this.$$.ctx[45]}},{key:"refresh",get:function(){return this.$$.ctx[46]}},{key:"validate",get:function(){return this.$$.ctx[47]}}]),n}();function h0(e){var t,n;return t=new vT({props:{items:e[0]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&Si(n,1)[0]&&(r.items=e[0]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function d0(e,t,n){var r,i,o=t.json,a=t.readOnly,s=t.historyState,c=t.onSort,u=t.onTransform,l=t.onContextMenu,f=t.onUndo,h=t.onRedo,d=t.onRenderMenu;return e.$$set=function(e){"json"in e&&n(1,o=e.json),"readOnly"in e&&n(2,a=e.readOnly),"historyState"in e&&n(3,s=e.historyState),"onSort"in e&&n(4,c=e.onSort),"onTransform"in e&&n(5,u=e.onTransform),"onContextMenu"in e&&n(6,l=e.onContextMenu),"onUndo"in e&&n(7,f=e.onUndo),"onRedo"in e&&n(8,h=e.onRedo),"onRenderMenu"in e&&n(9,d=e.onRenderMenu);},e.$$.update=function(){510&e.$$.dirty&&n(10,r=a?[{type:"space"}]:[{type:"button",icon:mM,title:"Sort",className:"jse-sort",onClick:c,disabled:a||void 0===o},{type:"button",icon:iM,title:"Transform contents (filter, sort, project)",className:"jse-transform",onClick:u,disabled:a||void 0===o},{type:"button",icon:vM,title:bs,className:"jse-contextmenu",onClick:l},{type:"separator"},{type:"button",icon:lM,title:"Undo (Ctrl+Z)",className:"jse-undo",onClick:f,disabled:!s.canUndo},{type:"button",icon:uM,title:"Redo (Ctrl+Shift+Z)",className:"jse-redo",onClick:h,disabled:!s.canRedo},{type:"space"}]),1536&e.$$.dirty&&n(0,i=d(r)||r);},[i,o,a,s,c,u,l,f,h,d,r]}var v0=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,d0,h0,no,{json:1,readOnly:2,historyState:3,onSort:4,onTransform:5,onContextMenu:6,onUndo:7,onRedo:8,onRenderMenu:9}),r}return qi(n)}();function p0(e,t,n){var r=e.slice();return r[9]=t[n],r}function m0(e){var t,n,r,i=[e[9].props],o=e[9].component;function a(e){for(var t={},n=0;n<i.length;n+=1)t=Qi(t,i[n]);return {props:t}}return o&&(t=Wo(o,a())),{c:function(){t&&Da(t.$$.fragment),n=Eo();},m:function(e,i){t&&La(t,e,i),jo(e,n,i),r=!0;},p:function(e,r){var s=1&r?Ra(i,[Na(e[9].props)]):{};if(1&r&&o!==(o=e[9].component)){if(t){Sa();var c=t;_a(c.$$.fragment,1,0,(function(){Ba(c,1);})),Ca();}o?(Da((t=Wo(o,a())).$$.fragment),$a(t.$$.fragment,1),La(t,n.parentNode,n)):t=null;}else o&&t.$set(s);},i:function(e){r||(t&&$a(t.$$.fragment,e),r=!0);},o:function(e){t&&_a(t.$$.fragment,e),r=!1;},d:function(e){e&&So(n),t&&Ba(t,e);}}}function g0(e){for(var t,n,r=e[0],i=[],o=0;o<r.length;o+=1)i[o]=m0(p0(e,r,o));var a=function(e){return _a(i[e],1,1,(function(){i[e]=null;}))};return {c:function(){for(var e=0;e<i.length;e+=1)i[e].c();t=Eo();},m:function(e,r){for(var o=0;o<i.length;o+=1)i[o]&&i[o].m(e,r);jo(e,t,r),n=!0;},p:function(e,n){var o=Si(n,1)[0];if(1&o){var s;for(r=e[0],s=0;s<r.length;s+=1){var c=p0(e,r,s);i[s]?(i[s].p(c,o),$a(i[s],1)):(i[s]=m0(c),i[s].c(),$a(i[s],1),i[s].m(t.parentNode,t));}for(Sa(),s=r.length;s<i.length;s+=1)a(s);Ca();}},i:function(e){if(!n){for(var t=0;t<r.length;t+=1)$a(i[t]);n=!0;}},o:function(e){i=i.filter(Boolean);for(var t=0;t<i.length;t+=1)_a(i[t]);n=!1;},d:function(e){Co(i,e),e&&So(t);}}}function y0(e,t,n){var r,i,o=t.path,a=t.value,s=t.context,c=t.enforceString,u=t.selection,l=t.searchResultItems;function f(e,t){return s.onPatch(function(e,t){return e.flatMap((function(e){if(As(e)){var n=Qs(e.path);if(n.length>0){for(var r=[e],i=ly(n);i.length>0&&!Gs(t,i);)r.unshift({op:"add",path:Ys(i),value:{}}),i=ly(i);return r}}return e}))}(e,s.getJson()),t)}return e.$$set=function(e){"path"in e&&n(1,o=e.path),"value"in e&&n(2,a=e.value),"context"in e&&n(3,s=e.context),"enforceString"in e&&n(4,c=e.enforceString),"selection"in e&&n(5,u=e.selection),"searchResultItems"in e&&n(6,l=e.searchResultItems);},e.$$.update=function(){40&e.$$.dirty&&n(7,r=!s.readOnly&&p_(u)&&B_(u)),254&e.$$.dirty&&n(0,i=s.onRenderValue({path:o,value:a,readOnly:s.readOnly,enforceString:c,isEditing:r,parser:s.parser,normalization:s.normalization,selection:u,searchResultItems:l,onPatch:f,onPasteJson:s.onPasteJson,onSelect:s.onSelect,onFind:s.onFind,findNextInside:s.findNextInside,focus:s.focus}));},[i,o,a,s,c,u,l,r]}var b0=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,y0,g0,no,{path:1,value:2,context:3,enforceString:4,selection:5,searchResultItems:6}),r}return qi(n)}();function w0(e){bo(e,"svelte-l28mqd",".jse-inline-value.svelte-l28mqd{font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);line-height:var(--jse-line-height);border:none;padding:0 calc(0.5 * var(--jse-padding));background:transparent;color:inherit;cursor:pointer}.jse-inline-value.svelte-l28mqd:hover{background:var(--jse-hover-background-color)}.jse-inline-value.jse-selected.svelte-l28mqd{background:var(--jse-selection-background-color)}");}function x0(e){var t,n,r,i,o=QC(e[2].stringify(e[1]),50)+"";return {c:function(){t=$o("button"),n=Oo(o),Ro(t,"type","button"),Ro(t,"class","jse-inline-value svelte-l28mqd"),Fo(t,"jse-selected",e[3]);},m:function(o,a){jo(o,t,a),yo(t,n),r||(i=Ao(t,"dblclick",e[6]),r=!0);},p:function(e,r){var i=Si(r,1)[0];6&i&&o!==(o=QC(e[2].stringify(e[1]),50)+"")&&Lo(n,o),8&i&&Fo(t,"jse-selected",e[3]);},i:Ki,o:Ki,d:function(e){e&&So(t),r=!1,i();}}}function k0(e,t,n){var r,i=t.path,o=t.value,a=t.parser,s=t.isSelected,c=t.onEdit;return e.$$set=function(e){"path"in e&&n(0,i=e.path),"value"in e&&n(1,o=e.value),"parser"in e&&n(2,a=e.parser),"isSelected"in e&&n(3,s=e.isSelected),"onEdit"in e&&n(4,c=e.onEdit);},e.$$.update=function(){2&e.$$.dirty&&n(5,r=_s(o)?o.length:Object.keys(o).length),e.$$.dirty;},[i,o,a,s,c,r,function(){return c(i)}]}var j0=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,k0,x0,no,{path:0,value:1,parser:2,isSelected:3,onEdit:4},w0),r}return qi(n)}();function S0(e){bo(e,"svelte-h4fort",".jse-column-header.svelte-h4fort.svelte-h4fort{background:none;border:none;font-family:inherit;font-size:inherit;color:inherit;display:flex;gap:var(--jse-padding);padding:calc(0.5 * var(--jse-padding)) var(--jse-padding) calc(0.5 * var(--jse-padding)) calc(0.5 * var(--jse-padding));width:100%}.jse-column-header.svelte-h4fort.svelte-h4fort:hover{background:var(--jse-table-header-background-highlight)}.jse-column-header.svelte-h4fort.svelte-h4fort:not(.jse-column-header.jse-readonly){cursor:pointer}.jse-column-header.svelte-h4fort span.jse-column-sort-icon.svelte-h4fort{height:1em}");}function C0(e){var t,n,r,i;return n=new x$({props:{data:e[1]===fs.asc?dM:rM}}),{c:function(){t=$o("span"),Da(n.$$.fragment),Ro(t,"class","jse-column-sort-icon svelte-h4fort"),Ro(t,"title",r="Currently sorted in ".concat(e[2]," order"));},m:function(e,r){jo(e,t,r),La(n,t,null),i=!0;},p:function(e,o){var a={};2&o&&(a.data=e[1]===fs.asc?dM:rM),n.$set(a),(!i||4&o&&r!==(r="Currently sorted in ".concat(e[2]," order")))&&Ro(t,"title",r);},i:function(e){i||($a(n.$$.fragment,e),i=!0);},o:function(e){_a(n.$$.fragment,e),i=!1;},d:function(e){e&&So(t),Ba(n);}}}function $0(e){var t,n,r,i,o,a,s,c,u=QC(e[3],50)+"",l=void 0!==e[1]&&C0(e);return {c:function(){t=$o("button"),n=$o("span"),r=Oo(u),i=Mo(),l&&l.c(),Ro(n,"class","jse-column-name"),Ro(t,"type","button"),Ro(t,"class","jse-column-header svelte-h4fort"),Ro(t,"title",o=e[0]?e[3]:e[3]+" (Click to sort the data by this column)"),Fo(t,"jse-readonly",e[0]);},m:function(o,u){jo(o,t,u),yo(t,n),yo(n,r),yo(t,i),l&&l.m(t,null),a=!0,s||(c=Ao(t,"click",e[4]),s=!0);},p:function(e,n){var i=Si(n,1)[0];(!a||8&i)&&u!==(u=QC(e[3],50)+"")&&Lo(r,u),void 0!==e[1]?l?(l.p(e,i),2&i&&$a(l,1)):((l=C0(e)).c(),$a(l,1),l.m(t,null)):l&&(Sa(),_a(l,1,1,(function(){l=null;})),Ca()),(!a||9&i&&o!==(o=e[0]?e[3]:e[3]+" (Click to sort the data by this column)"))&&Ro(t,"title",o),(!a||1&i)&&Fo(t,"jse-readonly",e[0]);},i:function(e){a||($a(l),a=!0);},o:function(e){_a(l),a=!1;},d:function(e){e&&So(t),l&&l.d(),s=!1,c();}}}function _0(e,t,n){var r,i,o,a=t.path,s=t.sortedColumn,c=t.readOnly,u=t.onSort;return e.$$set=function(e){"path"in e&&n(5,a=e.path),"sortedColumn"in e&&n(6,s=e.sortedColumn),"readOnly"in e&&n(0,c=e.readOnly),"onSort"in e&&n(7,u=e.onSort);},e.$$.update=function(){var t;(32&e.$$.dirty&&n(3,r=By(a)?"values":FC(a)),96&e.$$.dirty)&&n(1,i=zy(a,null===(t=s)||void 0===t?void 0:t.path)?s.sortDirection:void 0);2&e.$$.dirty&&n(2,o=js[i]);},[c,i,o,r,function(){c||u({path:a,sortDirection:i===fs.asc?fs.desc:fs.asc});},a,s,u]}var O0,M0,E0=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,_0,$0,no,{path:5,sortedColumn:6,readOnly:0,onSort:7},S0),r}return qi(n)}();function A0(e,t){return O0||(M0=new WeakMap,O0=new ResizeObserver((function(e){var t,n=wi(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=M0.get(r.target);i&&i(r.target);}}catch(e){n.e(e);}finally{n.f();}}))),M0.set(e,t),O0.observe(e),{destroy:function(){M0.delete(e),O0.unobserve(e);}}}function P0(e){var t,n;return t=new kR({props:{items:e[1],tip:e[0]?"Tip: you can open this context menu via right-click or with Ctrl+Q":void 0}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};2&n[0]&&(r.items=e[1]),1&n[0]&&(r.tip=e[0]?"Tip: you can open this context menu via right-click or with Ctrl+Q":void 0),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function T0(e,t,n){var r,i,o,a,s,c,u,l,f,h,d,v=t.json,p=t.documentState,m=t.parser,g=t.showTip,y=t.onCloseContextMenu,b=t.onEditValue,w=t.onEditRow,x=t.onToggleEnforceString,k=t.onCut,j=t.onCopy,S=t.onPaste,C=t.onRemove,$=t.onDuplicateRow,_=t.onInsertBeforeRow,O=t.onInsertAfterRow,M=t.onRemoveRow;function E(){y(),b();}function A(){y(),w();}function P(){y(),x();}function T(){y(),k(!0);}function R(){y(),k(!1);}function N(){y(),j(!0);}function I(){y(),j(!1);}function D(){y(),S();}function L(){y(),C();}function B(){y(),$();}function z(){y(),_();}function q(){y(),O();}function F(){y(),M();}return e.$$set=function(e){"json"in e&&n(2,v=e.json),"documentState"in e&&n(3,p=e.documentState),"parser"in e&&n(4,m=e.parser),"showTip"in e&&n(0,g=e.showTip),"onCloseContextMenu"in e&&n(5,y=e.onCloseContextMenu),"onEditValue"in e&&n(6,b=e.onEditValue),"onEditRow"in e&&n(7,w=e.onEditRow),"onToggleEnforceString"in e&&n(8,x=e.onToggleEnforceString),"onCut"in e&&n(9,k=e.onCut),"onCopy"in e&&n(10,j=e.onCopy),"onPaste"in e&&n(11,S=e.onPaste),"onRemove"in e&&n(12,C=e.onRemove),"onDuplicateRow"in e&&n(13,$=e.onDuplicateRow),"onInsertBeforeRow"in e&&n(14,_=e.onInsertBeforeRow),"onInsertAfterRow"in e&&n(15,O=e.onInsertAfterRow),"onRemoveRow"in e&&n(16,M=e.onRemoveRow);},e.$$.update=function(){8&e.$$.dirty[0]&&n(22,r=p.selection),4&e.$$.dirty[0]&&n(25,i=void 0!==v),4194304&e.$$.dirty[0]&&n(17,o=null!=r),4194304&e.$$.dirty[0]&&n(26,a=null!=r&&By(r.focusPath)),4194308&e.$$.dirty[0]&&n(23,s=void 0!==v&&null!=r?Vs(v,r.focusPath):void 0),37748736&e.$$.dirty[0]&&n(18,c=i&&(m_(r)||v_(r)||p_(r))),e.$$.dirty[0],104857600&e.$$.dirty[0]&&i&&null!=r&&(m_(r)||p_(r)),71303172&e.$$.dirty[0]&&void 0!==v&&null!=r&&O_(r)&&!a&&Array.isArray(Vs(v,ly(r.focusPath))),37748736&e.$$.dirty[0]&&n(21,u=i&&null!=r&&O_(r)),10485760&e.$$.dirty[0]&&n(19,l=u&&!du(s)),262144&e.$$.dirty[0]&&n(24,f=c),e.$$.dirty[0],e.$$.dirty[0],29491200&e.$$.dirty[0]&&f&&q_(r)&&hu(s),29491200&e.$$.dirty[0]&&f&&q_(r)&&Array.isArray(s),29491200&e.$$.dirty[0]&&f&&q_(r)&&du(s),12582936&e.$$.dirty[0]&&n(20,h=null!=r&&r_(s,p.enforceStringMap,Ys(r.focusPath),m)),4063232&e.$$.dirty[0]&&n(1,d=[{type:"separator"},{type:"row",items:[{type:"column",items:[{type:"label",text:"Table cell:"},{type:"dropdown-button",main:{type:"button",onClick:E,icon:cM,text:"Edit",title:"Edit the value (Double-click on the value)",disabled:!u},width:"11em",items:[{type:"button",icon:cM,text:"Edit",title:"Edit the value (Double-click on the value)",onClick:E,disabled:!u},{type:"button",icon:h?e$:t$,text:"Enforce string",title:"Enforce keeping the value as string when it contains a numeric value",onClick:P,disabled:!l}]},{type:"dropdown-button",main:{type:"button",onClick:T,icon:QO,text:"Cut",title:"Cut selected contents, formatted with indentation (Ctrl+X)",disabled:!c},width:"10em",items:[{type:"button",icon:QO,text:"Cut formatted",title:"Cut selected contents, formatted with indentation (Ctrl+X)",onClick:T,disabled:!c},{type:"button",icon:QO,text:"Cut compacted",title:"Cut selected contents, without indentation (Ctrl+Shift+X)",onClick:R,disabled:!c}]},{type:"dropdown-button",main:{type:"button",onClick:N,icon:xM,text:"Copy",title:"Copy selected contents, formatted with indentation (Ctrl+C)",disabled:!c},width:"12em",items:[{type:"button",icon:xM,text:"Copy formatted",title:"Copy selected contents, formatted with indentation (Ctrl+C)",onClick:N,disabled:!c},{type:"button",icon:xM,text:"Copy compacted",title:"Copy selected contents, without indentation (Ctrl+Shift+C)",onClick:I,disabled:!c}]},{type:"button",onClick:D,icon:KO,text:"Paste",title:"Paste clipboard contents (Ctrl+V)",disabled:!o},{type:"button",onClick:L,icon:UO,text:"Remove",title:"Remove selected contents (Delete)",disabled:!c}]},{type:"column",items:[{type:"label",text:"Table row:"},{type:"button",onClick:A,icon:cM,text:"Edit row",title:"Edit the current row",disabled:!c},{type:"button",onClick:B,icon:_M,text:"Duplicate row",title:"Duplicate the current row",disabled:!o},{type:"button",onClick:z,icon:kM,text:"Insert before",title:"Insert a row before the current row",disabled:!o},{type:"button",onClick:q,icon:kM,text:"Insert after",title:"Insert a row after the current row",disabled:!o},{type:"button",onClick:F,icon:UO,text:"Remove row",title:"Remove current row",disabled:!o}]}]}]);},[g,d,v,p,m,y,b,w,x,k,j,S,C,$,_,O,M,o,c,l,h,u,r,s,f,i,a]}var R0=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,T0,P0,no,{json:2,documentState:3,parser:4,showTip:0,onCloseContextMenu:5,onEditValue:6,onEditRow:7,onToggleEnforceString:8,onCut:9,onCopy:10,onPaste:11,onRemove:12,onDuplicateRow:13,onInsertBeforeRow:14,onInsertAfterRow:15,onRemoveRow:16},null,[-1,-1]),r}return qi(n)}();function N0(e){bo(e,"svelte-1te5h1h",".jse-table-mode-welcome.svelte-1te5h1h.svelte-1te5h1h{flex:1;display:flex;flex-direction:column;overflow:auto;align-items:center;border-left:var(--jse-main-border);border-right:var(--jse-main-border)}.jse-table-mode-welcome.svelte-1te5h1h.svelte-1te5h1h:last-child{border-bottom:var(--jse-main-border)}.jse-table-mode-welcome.svelte-1te5h1h .jse-space.jse-before.svelte-1te5h1h{flex:1}.jse-table-mode-welcome.svelte-1te5h1h .jse-nested-arrays.svelte-1te5h1h{display:flex;flex-direction:column;gap:var(--jse-padding);max-width:300px;margin:var(--jse-padding);font-family:var(--jse-font-family);font-size:var(--jse-font-size)}.jse-table-mode-welcome.svelte-1te5h1h .jse-nested-arrays .jse-nested-arrays-info.svelte-1te5h1h{color:var(--jse-panel-color-readonly)}.jse-table-mode-welcome.svelte-1te5h1h .jse-nested-arrays button.jse-nested-array-action.svelte-1te5h1h{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;background:var(--jse-button-primary-background);color:var(--jse-button-primary-color);padding:var(--jse-padding) calc(2 * var(--jse-padding));border-radius:3px;text-align:left}.jse-table-mode-welcome.svelte-1te5h1h .jse-nested-arrays button.jse-nested-array-action.svelte-1te5h1h:hover{background:var(--jse-button-primary-background-highlight)}.jse-table-mode-welcome.svelte-1te5h1h .jse-nested-arrays button.jse-nested-array-action.svelte-1te5h1h:disabled{background:var(--jse-button-primary-background-disabled)}.jse-table-mode-welcome.svelte-1te5h1h .jse-nested-arrays button.jse-nested-array-action .jse-nested-array-count.svelte-1te5h1h{opacity:0.5;white-space:nowrap}.jse-table-mode-welcome.svelte-1te5h1h .jse-space.jse-after.svelte-1te5h1h{flex:2}");}function I0(e,t,n){var r=e.slice();r[12]=t[n];var i=Vs(r[0],r[12]).length;return r[13]=i,r}function D0(e){var t,n;return {c:function(){t=Oo(e[5]),n=Oo(" cannot be opened in table mode. You can open the document in tree mode instead.");},m:function(e,r){jo(e,t,r),jo(e,n,r);},p:function(e,n){32&n&&Lo(t,e[5]);},d:function(e){e&&So(t),e&&So(n);}}}function L0(e){var t;return {c:function(){t=Oo("An object cannot be opened in table mode. You can open a nested array instead, or open the\n        document in tree mode.");},m:function(e,n){jo(e,t,n);},p:Ki,d:function(e){e&&So(t);}}}function B0(e){var t,n,r,i,o,a,s,c,u,l,f,h,d,v=FC(e[12])+"",p=e[13]+"",m=1!==e[13]?"items":"item";function g(){return e[10](e[12])}return {c:function(){t=$o("button"),n=Oo(e[6]),r=Oo(' "'),i=Oo(v),o=Oo('"\n        '),a=$o("span"),s=Oo("("),c=Oo(p),u=Mo(),l=Oo(m),f=Oo(")"),Ro(a,"class","jse-nested-array-count svelte-1te5h1h"),Ro(t,"type","button"),Ro(t,"class","jse-nested-array-action svelte-1te5h1h");},m:function(e,v){jo(e,t,v),yo(t,n),yo(t,r),yo(t,i),yo(t,o),yo(t,a),yo(a,s),yo(a,c),yo(a,u),yo(a,l),yo(a,f),h||(d=Ao(t,"click",g),h=!0);},p:function(t,r){e=t,64&r&&Lo(n,e[6]),8&r&&v!==(v=FC(e[12])+"")&&Lo(i,v),9&r&&p!==(p=e[13]+"")&&Lo(c,p),9&r&&m!==(m=1!==e[13]?"items":"item")&&Lo(l,m);},d:function(e){e&&So(t),h=!1,d();}}}function z0(e){var t,n,r,i,o,a,s,c,u,l,f,h,d,v,p,m,g;function y(e,t){return e[4]?L0:D0}for(var b=y(e),w=b(e),x=e[3],k=[],j=0;j<x.length;j+=1)k[j]=B0(I0(e,x,j));return {c:function(){t=$o("div"),n=$o("div"),r=Mo(),i=$o("div"),o=$o("div"),a=Oo(e[5]),s=Mo(),c=$o("div"),w.c(),u=Mo();for(var m=0;m<k.length;m+=1)k[m].c();l=Mo(),f=$o("button"),h=Oo(e[6]),d=Oo(" in tree mode"),v=Mo(),p=$o("div"),Ro(n,"class","jse-space jse-before svelte-1te5h1h"),Ro(o,"class","jse-nested-arrays-title"),Ro(c,"class","jse-nested-arrays-info svelte-1te5h1h"),Ro(f,"type","button"),Ro(f,"class","jse-nested-array-action svelte-1te5h1h"),Ro(i,"class","jse-nested-arrays svelte-1te5h1h"),Ro(p,"class","jse-space jse-after svelte-1te5h1h"),Ro(t,"class","jse-table-mode-welcome svelte-1te5h1h");},m:function(y,b){jo(y,t,b),yo(t,n),yo(t,r),yo(t,i),yo(i,o),yo(o,a),yo(i,s),yo(i,c),w.m(c,null),yo(i,u);for(var x=0;x<k.length;x+=1)k[x]&&k[x].m(i,null);yo(i,l),yo(i,f),yo(f,h),yo(f,d),yo(t,v),yo(t,p),m||(g=Ao(f,"click",e[11]),m=!0);},p:function(e,t){var n=Si(t,1)[0];if(32&n&&Lo(a,e[5]),b===(b=y(e))&&w?w.p(e,n):(w.d(1),(w=b(e))&&(w.c(),w.m(c,null))),75&n){var r;for(x=e[3],r=0;r<x.length;r+=1){var o=I0(e,x,r);k[r]?k[r].p(o,n):(k[r]=B0(o),k[r].c(),k[r].m(i,l));}for(;r<k.length;r+=1)k[r].d(1);k.length=x.length;}64&n&&Lo(h,e[6]);},i:Ki,o:Ki,d:function(e){e&&So(t),w.d(),Co(k,e),m=!1,g();}}}function q0(e,t,n){var r,i,o,a,s=t.text,c=t.json,u=t.readOnly,l=t.parser,f=t.openJSONEditorModal,h=t.onChangeMode;return e.$$set=function(e){"text"in e&&n(7,s=e.text),"json"in e&&n(0,c=e.json),"readOnly"in e&&n(8,u=e.readOnly),"parser"in e&&n(9,l=e.parser),"openJSONEditorModal"in e&&n(1,f=e.openJSONEditorModal),"onChangeMode"in e&&n(2,h=e.onChangeMode);},e.$$.update=function(){256&e.$$.dirty&&n(6,r=u?"View":"Edit"),1&e.$$.dirty&&n(3,a=c?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=[];function r(e,i){Os(e)&&i.length<t&&Object.keys(e).forEach((function(t){r(e[t],i.concat(t));})),_s(e)&&n.push(i);}return r(e,[]),n}(c).slice(0,99).filter((function(e){return e.length>0})):[]),8&e.$$.dirty&&n(4,i=!By(a)),657&e.$$.dirty&&n(5,o=i?"Object with nested arrays":void 0!==c||""!==s&&void 0!==s?Os(c)?"An object":_s(c)?"An empty array":"A ".concat(mu(c,l)):"An empty document");},[c,f,h,a,i,o,r,s,u,l,function(e){return f(e)},function(){return h(as.tree)}]}var F0=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,q0,z0,no,{text:7,json:0,readOnly:8,parser:9,openJSONEditorModal:1,onChangeMode:2},N0),r}return qi(n)}();function V0(e){bo(e,"svelte-h4fort",".jse-column-header.svelte-h4fort{background:none;border:none;font-family:inherit;font-size:inherit;color:inherit;display:flex;gap:var(--jse-padding);padding:calc(0.5 * var(--jse-padding)) var(--jse-padding) calc(0.5 * var(--jse-padding)) calc(0.5 * var(--jse-padding));width:100%}.jse-column-header.svelte-h4fort:hover{background:var(--jse-table-header-background-highlight)}.jse-column-header.svelte-h4fort:not(.jse-column-header.jse-readonly){cursor:pointer}");}function W0(e){var t,n,r,i,o,a;return n=new x$({props:{data:$M}}),{c:function(){t=$o("button"),Da(n.$$.fragment),Ro(t,"type","button"),Ro(t,"class","jse-column-header svelte-h4fort"),Ro(t,"title",r="The Columns are created by sampling ".concat(e[1]," items out of ").concat(e[0],". ")+"If you're missing a column, click here to sample all of the items instead of a subset. This is slower.");},m:function(r,s){jo(r,t,s),La(n,t,null),i=!0,o||(a=Ao(t,"click",e[3]),o=!0);},p:function(e,n){var o=Si(n,1)[0];(!i||3&o&&r!==(r="The Columns are created by sampling ".concat(e[1]," items out of ").concat(e[0],". ")+"If you're missing a column, click here to sample all of the items instead of a subset. This is slower."))&&Ro(t,"title",r);},i:function(e){i||($a(n.$$.fragment,e),i=!0);},o:function(e){_a(n.$$.fragment,e),i=!1;},d:function(e){e&&So(t),Ba(n),o=!1,a();}}}function H0(e,t,n){var r=t.count,i=t.maxSampleCount,o=t.onRefresh;return e.$$set=function(e){"count"in e&&n(0,r=e.count),"maxSampleCount"in e&&n(1,i=e.maxSampleCount),"onRefresh"in e&&n(2,o=e.onRefresh);},[r,i,o,function(){return o()}]}var U0=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,H0,W0,no,{count:0,maxSampleCount:1,onRefresh:2},V0),r}return qi(n)}();function J0(e){bo(e,"svelte-hs49xj",".jse-table-mode.svelte-hs49xj.svelte-hs49xj{flex:1;display:flex;flex-direction:column;position:relative;background:var(--jse-background-color);min-width:0;min-height:0;font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);color:var(--jse-text-color)}.jse-table-mode.no-main-menu.svelte-hs49xj.svelte-hs49xj{border-top:var(--jse-main-border)}.jse-table-mode.svelte-hs49xj .jse-hidden-input-label.svelte-hs49xj{position:fixed;right:0;top:0;width:0;height:0}.jse-table-mode.svelte-hs49xj .jse-hidden-input-label .jse-hidden-input.svelte-hs49xj{width:0;height:0;padding:0;border:0;outline:none}.jse-table-mode.svelte-hs49xj .jse-contents.svelte-hs49xj{flex:1;align-items:start;flex-direction:column;display:flex;overflow:auto;overflow-anchor:none;border-left:var(--jse-main-border);border-right:var(--jse-main-border)}.jse-table-mode.svelte-hs49xj .jse-contents.svelte-hs49xj:last-child{border-bottom:var(--jse-main-border)}.jse-table-mode.svelte-hs49xj .jse-contents table.jse-table-main.svelte-hs49xj{border-collapse:collapse;border-spacing:0}.jse-table-mode.svelte-hs49xj .jse-contents table.jse-table-main .jse-table-invisible-start-section td.svelte-hs49xj,.jse-table-mode.svelte-hs49xj .jse-contents table.jse-table-main .jse-table-invisible-end-section td.svelte-hs49xj{margin:0;padding:0}.jse-table-mode.svelte-hs49xj .jse-contents table.jse-table-main .jse-table-invisible-end-section td.svelte-hs49xj{padding-bottom:var(--jse-padding)}.jse-table-mode.svelte-hs49xj .jse-contents table.jse-table-main .jse-table-row.svelte-hs49xj:hover{background-color:var(--jse-table-row-odd-background)}.jse-table-mode.svelte-hs49xj .jse-contents table.jse-table-main .jse-table-row .jse-table-cell.svelte-hs49xj{padding:0 var(--jse-padding) 0 0;vertical-align:top;white-space:nowrap;height:var(--jse-line-height)}.jse-table-mode.svelte-hs49xj .jse-contents table.jse-table-main .jse-table-row .jse-table-cell.jse-table-cell-header.svelte-hs49xj,.jse-table-mode.svelte-hs49xj .jse-contents table.jse-table-main .jse-table-row .jse-table-cell.jse-table-cell-gutter.svelte-hs49xj{font-weight:normal;text-align:left;color:var(--jse-text-readonly);background:var(--jse-table-header-background)}.jse-table-mode.svelte-hs49xj .jse-contents table.jse-table-main .jse-table-row .jse-table-cell.jse-table-cell-header.svelte-hs49xj{padding:0;position:sticky;top:0}.jse-table-mode.svelte-hs49xj .jse-contents table.jse-table-main .jse-table-row .jse-table-cell.jse-table-cell-header .jse-table-root-error.svelte-hs49xj{padding:calc(0.5 * var(--jse-padding)) var(--jse-padding) calc(0.5 * var(--jse-padding)) calc(0.5 * var(--jse-padding))}.jse-table-mode.svelte-hs49xj .jse-contents table.jse-table-main .jse-table-row .jse-table-cell.jse-table-cell-gutter.svelte-hs49xj{padding:0 var(--jse-padding) 0 calc(0.5 * var(--jse-padding))}.jse-table-mode.svelte-hs49xj .jse-contents table.jse-table-main .jse-table-row .jse-table-cell.jse-selected-value.svelte-hs49xj>.jse-value{background:var(--jse-selection-background-color)}.jse-table-mode.svelte-hs49xj .jse-contents table.jse-table-main .jse-table-row .jse-table-cell.svelte-hs49xj div{display:inline-flex}.jse-table-mode.svelte-hs49xj .jse-contents table.jse-table-main .jse-table-row .jse-table-cell.svelte-hs49xj div.jse-value{overflow-wrap:normal;white-space:nowrap;vertical-align:top;display:inline-block}.jse-table-mode.svelte-hs49xj .jse-contents table.jse-table-main .jse-table-row .jse-table-cell .jse-context-menu-anchor.svelte-hs49xj{position:relative;vertical-align:top}.jse-table-mode.svelte-hs49xj .jse-contents.jse-contents-loading.svelte-hs49xj{align-items:unset}.jse-table-mode.svelte-hs49xj .jse-contents.jse-contents-loading .jse-loading-space.svelte-hs49xj{flex:1}.jse-table-mode.svelte-hs49xj .jse-contents.jse-contents-loading .jse-loading.svelte-hs49xj{flex:2;text-align:center;color:var(--jse-panel-color-readonly);box-sizing:border-box;font-family:var(--jse-font-family);font-size:var(--jse-font-size)}");}function K0(e,t,n){var r=e.slice();r[120]=t[n],r[124]=n;var i=r[22].startIndex+r[124];r[121]=i;var o=r[21].rows[r[121]];return r[122]=o,r}function G0(e,t,n){var r,i=e.slice();i[125]=t[n],i[131]=n;var o=[String(i[121])].concat(i[125]);i[126]=o;var a=Vs(i[120],i[125]);i[127]=a;var s=i[46](i[126],i[10].selection);i[128]=s;var c=null===(r=i[122])||void 0===r?void 0:r.columns[i[131]];return i[129]=c,i}function Q0(e,t,n){var r=e.slice();return r[125]=t[n],r}function Y0(e){var t,n;return t=new v0({props:{json:e[7],readOnly:e[0],historyState:e[19],onSort:e[40],onTransform:e[41],onUndo:e[42],onRedo:e[43],onContextMenu:e[32],onRenderMenu:e[5]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};128&n[0]&&(r.json=e[7]),1&n[0]&&(r.readOnly=e[0]),524288&n[0]&&(r.historyState=e[19]),32&n[0]&&(r.onRenderMenu=e[5]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function X0(e){var t;return {c:function(){(t=$o("div")).innerHTML='<div class="jse-loading-space svelte-hs49xj"></div> \n      <div class="jse-loading svelte-hs49xj">loading...</div>',Ro(t,"class","jse-contents jse-contents-loading svelte-hs49xj");},m:function(e,n){jo(e,t,n);},p:Ki,i:Ki,o:Ki,d:function(e){e&&So(t);}}}function Z0(e){var t,n,r,i,o,a,s,c,u,l=[n1,t1,e1],f=[];function h(e,t){return e[24]?0:e[16]&&void 0!==e[15]&&""!==e[15]?1:2}return i=h(e),o=f[i]=l[i](e),{c:function(){t=$o("label"),n=$o("input"),r=Mo(),o.c(),a=Eo(),Ro(n,"type","text"),n.readOnly="readonly",Ro(n,"tabindex","-1"),Ro(n,"class","jse-hidden-input svelte-hs49xj"),Ro(t,"class","jse-hidden-input-label svelte-hs49xj");},m:function(o,l){jo(o,t,l),yo(t,n),e[71](n),jo(o,r,l),f[i].m(o,l),jo(o,a,l),s=!0,c||(u=Ao(n,"paste",e[37]),c=!0);},p:function(e,t){var n=i;(i=h(e))===n?f[i].p(e,t):(Sa(),_a(f[n],1,1,(function(){f[n]=null;})),Ca(),(o=f[i])?o.p(e,t):(o=f[i]=l[i](e)).c(),$a(o,1),o.m(a.parentNode,a));},i:function(e){s||($a(o),s=!0);},o:function(e){_a(o),s=!1;},d:function(n){n&&So(t),e[71](null),n&&So(r),f[i].d(n),n&&So(a),c=!1,u();}}}function e1(e){var t,n;return t=new F0({props:{text:e[15],json:e[7],readOnly:e[0],parser:e[2],openJSONEditorModal:e[39],onChangeMode:e[4]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};32768&n[0]&&(r.text=e[15]),128&n[0]&&(r.json=e[7]),1&n[0]&&(r.readOnly=e[0]),4&n[0]&&(r.parser=e[2]),16&n[0]&&(r.onChangeMode=e[4]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function t1(e){var t,n,r,i;return t=new CP({props:{type:"error",message:"The loaded JSON document is invalid and could not be repaired automatically.",actions:e[0]?[]:[{icon:oM,text:"Repair manually",onClick:e[35]}]}}),r=new HD({props:{text:e[15]||"",json:e[7],indentation:e[3],parser:e[2]}}),{c:function(){Da(t.$$.fragment),n=Mo(),Da(r.$$.fragment);},m:function(e,o){La(t,e,o),jo(e,n,o),La(r,e,o),i=!0;},p:function(e,n){var i={};1&n[0]&&(i.actions=e[0]?[]:[{icon:oM,text:"Repair manually",onClick:e[35]}]),t.$set(i);var o={};32768&n[0]&&(o.text=e[15]||""),128&n[0]&&(o.json=e[7]),8&n[0]&&(o.indentation=e[3]),4&n[0]&&(o.parser=e[2]),r.$set(o);},i:function(e){i||($a(t.$$.fragment,e),$a(r.$$.fragment,e),i=!0);},o:function(e){_a(t.$$.fragment,e),_a(r.$$.fragment,e),i=!1;},d:function(e){Ba(t,e),e&&So(n),Ba(r,e);}}}function n1(e){for(var t,n,r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b,w,x,k,j,S,C=!By(null===(t=e[21])||void 0===t?void 0:t.root),$=C&&r1(e),_=e[9],O=[],M=0;M<_.length;M+=1)O[M]=i1(Q0(e,_,M));for(var E=function(e){return _a(O[e],1,1,(function(){O[e]=null;}))},A=e[23]&&o1(e),P=e[22].visibleItems,T=[],R=0;R<P.length;R+=1)T[R]=v1(K0(e,P,R));var N=function(e){return _a(T[e],1,1,(function(){T[e]=null;}))},I=e[17]&&p1(e),D=e[18]&&m1(e);return x=new IP({props:{validationErrors:e[11],selectError:e[38]}}),{c:function(){n=$o("div"),r=$o("table"),i=$o("tbody"),o=$o("tr"),a=$o("th"),$&&$.c(),s=Mo();for(var t=0;t<O.length;t+=1)O[t].c();c=Mo(),A&&A.c(),u=Mo(),l=$o("tr"),f=$o("td"),d=Mo();for(var k=0;k<T.length;k+=1)T[k].c();v=Mo(),p=$o("tr"),m=$o("td"),y=Mo(),I&&I.c(),b=Mo(),D&&D.c(),w=Mo(),Da(x.$$.fragment),Ro(a,"class","jse-table-cell jse-table-cell-header svelte-hs49xj"),Ro(o,"class","jse-table-row jse-table-row-header svelte-hs49xj"),Ro(f,"colspan",h=e[9].length),Ro(f,"class","svelte-hs49xj"),zo(f,"height",e[22].startHeight+"px"),Ro(l,"class","jse-table-invisible-start-section"),Ro(m,"colspan",g=e[9].length),Ro(m,"class","svelte-hs49xj"),zo(m,"height",e[22].endHeight+"px"),Ro(p,"class","jse-table-invisible-end-section"),Ro(r,"class","jse-table-main svelte-hs49xj"),Ro(r,"cellpadding","0"),Ro(r,"cellspacing","0"),Ro(n,"class","jse-contents svelte-hs49xj");},m:function(t,h){jo(t,n,h),yo(n,r),yo(r,i),yo(i,o),yo(o,a),$&&$.m(a,null),yo(o,s);for(var g=0;g<O.length;g+=1)O[g]&&O[g].m(o,null);yo(o,c),A&&A.m(o,null),yo(i,u),yo(i,l),yo(l,f),yo(i,d);for(var C=0;C<T.length;C+=1)T[C]&&T[C].m(i,null);yo(i,v),yo(i,p),yo(p,m),e[74](n),jo(t,y,h),I&&I.m(t,h),jo(t,b,h),D&&D.m(t,h),jo(t,w,h),La(x,t,h),k=!0,j||(S=[fo(A0.call(null,n,e[44])),Ao(n,"scroll",e[28])],j=!0);},p:function(e,t){var n;if(2097152&t[0]&&(C=!By(null===(n=e[21])||void 0===n?void 0:n.root)),C?$?($.p(e,t),2097152&t[0]&&$a($,1)):(($=r1(e)).c(),$a($,1),$.m(a,null)):$&&(Sa(),_a($,1,1,(function(){$=null;})),Ca()),134219265&t[0]){var r;for(_=e[9],r=0;r<_.length;r+=1){var s=Q0(e,_,r);O[r]?(O[r].p(s,t),$a(O[r],1)):(O[r]=i1(s),O[r].c(),$a(O[r],1),O[r].m(o,c));}for(Sa(),r=_.length;r<O.length;r+=1)E(r);Ca();}if(e[23]?A?(A.p(e,t),8388608&t[0]&&$a(A,1)):((A=o1(e)).c(),$a(A,1),A.m(o,null)):A&&(Sa(),_a(A,1,1,(function(){A=null;})),Ca()),(!k||512&t[0]&&h!==(h=e[9].length))&&Ro(f,"colspan",h),4194304&t[0]&&zo(f,"height",e[22].startHeight+"px"),1156580869&t[0]|49408&t[1]){var u;for(P=e[22].visibleItems,u=0;u<P.length;u+=1){var l=K0(e,P,u);T[u]?(T[u].p(l,t),$a(T[u],1)):(T[u]=v1(l),T[u].c(),$a(T[u],1),T[u].m(i,v));}for(Sa(),u=P.length;u<T.length;u+=1)N(u);Ca();}(!k||512&t[0]&&g!==(g=e[9].length))&&Ro(m,"colspan",g),4194304&t[0]&&zo(m,"height",e[22].endHeight+"px"),e[17]?I?(I.p(e,t),131072&t[0]&&$a(I,1)):((I=p1(e)).c(),$a(I,1),I.m(b.parentNode,b)):I&&(Sa(),_a(I,1,1,(function(){I=null;})),Ca()),e[18]?D?(D.p(e,t),262144&t[0]&&$a(D,1)):((D=m1(e)).c(),$a(D,1),D.m(w.parentNode,w)):D&&(Sa(),_a(D,1,1,(function(){D=null;})),Ca());var d={};2048&t[0]&&(d.validationErrors=e[11]),x.$set(d);},i:function(e){if(!k){$a($);for(var t=0;t<_.length;t+=1)$a(O[t]);$a(A);for(var n=0;n<P.length;n+=1)$a(T[n]);$a(I),$a(D),$a(x.$$.fragment,e),k=!0;}},o:function(e){_a($),O=O.filter(Boolean);for(var t=0;t<O.length;t+=1)_a(O[t]);_a(A),T=T.filter(Boolean);for(var n=0;n<T.length;n+=1)_a(T[n]);_a(I),_a(D),_a(x.$$.fragment,e),k=!1;},d:function(t){t&&So(n),$&&$.d(),Co(O,t),A&&A.d(),Co(T,t),e[74](null),t&&So(y),I&&I.d(t),t&&So(b),D&&D.d(t),t&&So(w),Ba(x,t),j=!1,Zi(S);}}}function r1(e){var t,n,r,i;return r=new oN({props:{validationError:kD([],null===(t=e[21])||void 0===t?void 0:t.root),onExpand:_L}}),{c:function(){n=$o("div"),Da(r.$$.fragment),Ro(n,"class","jse-table-root-error svelte-hs49xj");},m:function(e,t){jo(e,n,t),La(r,n,null),i=!0;},p:function(e,t){var n,i={};2097152&t[0]&&(i.validationError=kD([],null===(n=e[21])||void 0===n?void 0:n.root)),r.$set(i);},i:function(e){i||($a(r.$$.fragment,e),i=!0);},o:function(e){_a(r.$$.fragment,e),i=!1;},d:function(e){e&&So(n),Ba(r);}}}function i1(e){var t,n,r;return n=new E0({props:{path:e[125],sortedColumn:e[10].sortedColumn,readOnly:e[0],onSort:e[27]}}),{c:function(){t=$o("th"),Da(n.$$.fragment),Ro(t,"class","jse-table-cell jse-table-cell-header svelte-hs49xj");},m:function(e,i){jo(e,t,i),La(n,t,null),r=!0;},p:function(e,t){var r={};512&t[0]&&(r.path=e[125]),1024&t[0]&&(r.sortedColumn=e[10].sortedColumn),1&t[0]&&(r.readOnly=e[0]),n.$set(r);},i:function(e){r||($a(n.$$.fragment,e),r=!0);},o:function(e){_a(n.$$.fragment,e),r=!1;},d:function(e){e&&So(t),Ba(n);}}}function o1(e){var t,n,r;return n=new U0({props:{count:e[7].length,maxSampleCount:e[8],onRefresh:e[72]}}),{c:function(){t=$o("th"),Da(n.$$.fragment),Ro(t,"class","jse-table-cell jse-table-cell-header svelte-hs49xj");},m:function(e,i){jo(e,t,i),La(n,t,null),r=!0;},p:function(e,t){var r={};128&t[0]&&(r.count=e[7].length),256&t[0]&&(r.maxSampleCount=e[8]),256&t[0]&&(r.onRefresh=e[72]),n.$set(r);},i:function(e){r||($a(n.$$.fragment,e),r=!0);},o:function(e){_a(n.$$.fragment,e),r=!1;},d:function(e){e&&So(t),Ba(n);}}}function a1(e){var t,n;return t=new oN({props:{validationError:kD([String(e[121])],e[122].row),onExpand:_L}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};6291456&n[0]&&(r.validationError=kD([String(e[121])],e[122].row)),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function s1(e){var t,n,r,i,o,a,s,c,u=e[121]+"",l=!By(null===(t=e[122])||void 0===t?void 0:t.row),f=l&&a1(e);function h(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return (t=e)[73].apply(t,[e[121]].concat(r))}return {c:function(){n=$o("th"),r=Oo(u),i=Mo(),f&&f.c(),Ro(n,"class","jse-table-cell jse-table-cell-gutter svelte-hs49xj");},m:function(e,t){jo(e,n,t),yo(n,r),yo(n,i),f&&f.m(n,null),a=!0,s||(c=fo(o=A0.call(null,n,h)),s=!0);},p:function(t,i){var s;e=t,(!a||4194304&i[0])&&u!==(u=e[121]+"")&&Lo(r,u),6291456&i[0]&&(l=!By(null===(s=e[122])||void 0===s?void 0:s.row)),l?f?(f.p(e,i),6291456&i[0]&&$a(f,1)):((f=a1(e)).c(),$a(f,1),f.m(n,null)):f&&(Sa(),_a(f,1,1,(function(){f=null;})),Ca()),o&&eo(o.update)&&4194304&i[0]&&o.update.call(null,h);},i:function(e){a||($a(f),a=!0);},o:function(e){_a(f),a=!1;},d:function(e){e&&So(n),f&&f.d(),s=!1,c();}}}function c1(e){var t,n;return t=new b0({props:{path:e[126],value:void 0!==e[127]?e[127]:"",enforceString:r_(e[127],e[10].enforceStringMap,Ys(e[126]),e[20].parser),selection:e[128]?e[10].selection:void 0,searchResultItems:e[26],context:e[20]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};4194816&n[0]&&(r.path=e[126]),4194816&n[0]&&(r.value=void 0!==e[127]?e[127]:""),5244416&n[0]&&(r.enforceString=r_(e[127],e[10].enforceStringMap,Ys(e[126]),e[20].parser)),4195840&n[0]&&(r.selection=e[128]?e[10].selection:void 0),1048576&n[0]&&(r.context=e[20]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function u1(e){var t,n;return t=new j0({props:{path:e[126],value:e[127],parser:e[2],isSelected:e[128],onEdit:e[39]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};4194816&n[0]&&(r.path=e[126]),4194816&n[0]&&(r.value=e[127]),4&n[0]&&(r.parser=e[2]),4195840&n[0]&&(r.isSelected=e[128]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function l1(e){var t,n,r,i;return n=new DR({props:{selected:!0,onContextMenu:e[30]}}),{c:function(){t=$o("div"),Da(n.$$.fragment),r=Mo(),Ro(t,"class","jse-context-menu-anchor svelte-hs49xj");},m:function(e,o){jo(e,t,o),La(n,t,null),jo(e,r,o),i=!0;},p:Ki,i:function(e){i||($a(n.$$.fragment,e),i=!0);},o:function(e){_a(n.$$.fragment,e),i=!1;},d:function(e){e&&So(t),Ba(n),e&&So(r);}}}function f1(e){var t,n;return t=new oN({props:{validationError:kD(e[126],e[129]),onExpand:_L}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};6291968&n[0]&&(r.validationError=kD(e[126],e[129])),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function h1(e){var t,n,r,i,o,a,s,c,u=!By(e[129]),l=[u1,c1],f=[];function h(e,t){return 4194816&t[0]&&(n=null),null==n&&(n=!!du(e[127])),n?0:1}r=h(e,[-1,-1,-1,-1,-1]),i=f[r]=l[r](e);var d=!e[0]&&e[128]&&!e[10].selection.edit&&l1(e),v=u&&f1(e);return {c:function(){t=$o("td"),i.c(),o=Eo(),d&&d.c(),a=Eo(),v&&v.c(),Ro(t,"class","jse-table-cell svelte-hs49xj"),Ro(t,"data-path",s=SC(e[126])),Fo(t,"jse-selected-value",e[128]&&p_(e[10].selection));},m:function(e,n){jo(e,t,n),f[r].m(t,null),yo(t,o),d&&d.m(t,null),yo(t,a),v&&v.m(t,null),c=!0;},p:function(e,n){var p=r;(r=h(e,n))===p?f[r].p(e,n):(Sa(),_a(f[p],1,1,(function(){f[p]=null;})),Ca(),(i=f[r])?i.p(e,n):(i=f[r]=l[r](e)).c(),$a(i,1),i.m(t,o)),e[0]||!e[128]||e[10].selection.edit?d&&(Sa(),_a(d,1,1,(function(){d=null;})),Ca()):d?(d.p(e,n),4195841&n[0]&&$a(d,1)):((d=l1(e)).c(),$a(d,1),d.m(t,a)),6291456&n[0]&&(u=!By(e[129])),u?v?(v.p(e,n),6291456&n[0]&&$a(v,1)):((v=f1(e)).c(),$a(v,1),v.m(t,null)):v&&(Sa(),_a(v,1,1,(function(){v=null;})),Ca()),(!c||4194816&n[0]&&s!==(s=SC(e[126])))&&Ro(t,"data-path",s),(!c||4195840&n[0]|32768&n[1])&&Fo(t,"jse-selected-value",e[128]&&p_(e[10].selection));},i:function(e){c||($a(i),$a(d),$a(v),c=!0);},o:function(e){_a(i),_a(d),_a(v),c=!1;},d:function(e){e&&So(t),f[r].d(),d&&d.d(),v&&v.d();}}}function d1(e){var t;return {c:function(){Ro(t=$o("td"),"class","jse-table-cell svelte-hs49xj");},m:function(e,n){jo(e,t,n);},d:function(e){e&&So(t);}}}function v1(e){for(var t,n,r,i,o=e[121],a=s1(e),s=e[9],c=[],u=0;u<s.length;u+=1)c[u]=h1(G0(e,s,u));var l=function(e){return _a(c[e],1,1,(function(){c[e]=null;}))},f=e[23]&&d1();return {c:function(){t=$o("tr"),a.c(),n=Mo();for(var e=0;e<c.length;e+=1)c[e].c();r=Mo(),f&&f.c(),Ro(t,"class","jse-table-row svelte-hs49xj");},m:function(e,o){jo(e,t,o),a.m(t,null),yo(t,n);for(var s=0;s<c.length;s+=1)c[s]&&c[s].m(t,null);yo(t,r),f&&f.m(t,null),i=!0;},p:function(e,i){if(4194304&i[0]&&no(o,o=e[121])?(Sa(),_a(a,1,1,Ki),Ca(),(a=s1(e)).c(),$a(a,1),a.m(t,n)):a.p(e,i),1148192261&i[0]|33024&i[1]){var u;for(s=e[9],u=0;u<s.length;u+=1){var h=G0(e,s,u);c[u]?(c[u].p(h,i),$a(c[u],1)):(c[u]=h1(h),c[u].c(),$a(c[u],1),c[u].m(t,r));}for(Sa(),u=s.length;u<c.length;u+=1)l(u);Ca();}e[23]?f||((f=d1()).c(),f.m(t,null)):f&&(f.d(1),f=null);},i:function(e){if(!i){$a(a);for(var t=0;t<s.length;t+=1)$a(c[t]);i=!0;}},o:function(e){_a(a),c=c.filter(Boolean);for(var t=0;t<c.length;t+=1)_a(c[t]);i=!1;},d:function(e){e&&So(t),a.d(e),Co(c,e),f&&f.d();}}}function p1(e){var t,n;return t=new CP({props:{type:"info",message:"You pasted a JSON ".concat(Array.isArray(e[17].contents)?"array":"object"," as text"),actions:[{icon:aM,text:"Paste as JSON instead",onMouseDown:e[33]},{text:"Leave as is",onClick:e[34]}]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};131072&n[0]&&(r.message="You pasted a JSON ".concat(Array.isArray(e[17].contents)?"array":"object"," as text")),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function m1(e){var t,n;return t=new CP({props:{type:"success",message:"The loaded JSON document was invalid but is successfully repaired.",actions:e[0]?[]:[{icon:OM,text:"Ok",onClick:e[6]},{icon:oM,text:"Repair manually instead",onClick:e[35]}]}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n[0]&&(r.actions=e[0]?[]:[{icon:OM,text:"Ok",onClick:e[6]},{icon:oM,text:"Repair manually instead",onClick:e[35]}]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function g1(e){var t,n,r,i,o,a,s,c=e[1]&&Y0(e),u=[Z0,X0],l=[];return r=function(e,t){return e[25]?1:0}(e),i=l[r]=u[r](e),{c:function(){t=$o("div"),c&&c.c(),n=Mo(),i.c(),Ro(t,"class","jse-table-mode svelte-hs49xj"),Fo(t,"no-main-menu",!e[1]);},m:function(i,u){jo(i,t,u),c&&c.m(t,null),yo(t,n),l[r].m(t,null),e[75](t),o=!0,a||(s=[Ao(t,"mousedown",e[29]),Ao(t,"keydown",e[36]),Ao(t,"contextmenu",e[31])],a=!0);},p:function(e,r){e[1]?c?(c.p(e,r),2&r[0]&&$a(c,1)):((c=Y0(e)).c(),$a(c,1),c.m(t,n)):c&&(Sa(),_a(c,1,1,(function(){c=null;})),Ca()),i.p(e,r),(!o||2&r[0])&&Fo(t,"no-main-menu",!e[1]);},i:function(e){o||($a(c),$a(i),o=!0);},o:function(e){_a(c),_a(i),o=!1;},d:function(n){n&&So(t),c&&c.d(),l[r].d(),e[75](null),a=!1,Zi(s);}}}function y1(e,t,n){var r,i,o,a,s=Ha("jsoneditor:TableMode"),c=ia("simple-modal").open,u=ia("absolute-popup"),l=u.openAbsolutePopup,f=u.closeAbsolutePopup,h=uP(),d=Oj(),v=Oj(),p="undefined"==typeof window;s("isSSR:",p);var m,g,y,b,w,x,k=t.readOnly,j=t.externalContent,S=t.mainMenuBar,C=t.escapeControlCharacters,$=t.escapeUnicodeCharacters,_=t.flattenColumns,O=t.parser,M=t.parseMemoizeOne,E=t.validator,A=t.validationParser,P=t.indentation,T=t.onChange,R=t.onChangeMode,N=t.onRenderValue,I=t.onRenderMenu,D=t.onFocus,L=t.onBlur,B=t.onSortModal,z=t.onTransformModal,q=t.onJSONEditorModal;gP({onMount:ea,onDestroy:ta,getWindow:function(){return wC(g)},hasFocus:function(){return U&&document.hasFocus()||xC(g)},onFocus:function(){D&&D();},onBlur:function(){L&&L();}});var F,V=void 0,W=1e4,H=[],U=!1,J={},K=600,G=0;function Q(e){s("updateSelection",e);var t="function"==typeof e?e(X.selection):e;zy(t,X.selection)||n(10,X=Oi(Oi({},X),{},{selection:t}));}function Y(e){void 0!==X.selection&&void 0!==e&&(X.selection&&Gs(e,X.selection.anchorPath)&&Gs(e,X.selection.focusPath)||(s("clearing selection: path does not exist anymore",X.selection),n(10,X=Oi(Oi({},X),{},{selection:S_(e,X)}))));}var X=L$(),Z=!1;var ee,te=fP({onChange:function(e){n(19,ne=e);}}),ne=te.getState();function re(e){var t=w,r=VS(e)?e.text!==x:!zy(t,e.json);if(s("update external content",{isChanged:r}),r){var i={json:w,text:x},o=w,a=X,c=x,u=Z;if(VS(e))try{n(7,w=M(e.text)),n(15,x=e.text),n(18,Z=!1),n(16,V=void 0);}catch(t){try{n(7,w=M(su(e.text))),n(15,x=e.text),n(18,Z=!0),n(16,V=void 0);}catch(e){n(7,w=void 0),n(15,x=j.text),n(18,Z=!1),n(16,V=void 0!==x&&""!==x?zS(x,t.message||t.toString()):void 0);}}else n(7,w=e.json),n(15,x=void 0),n(18,Z=!1),n(16,V=void 0);Y(w),X.sortedColumn&&n(10,X=Oi(Oi({},X),{},{sortedColumn:void 0})),ie({previousJson:o,previousState:a,previousText:c,previousTextIsRepaired:u});fe(i,null);}}function ie(e){var t=e.previousJson,n=e.previousState,r=e.previousText,i=e.previousTextIsRepaired;void 0===t&&void 0===r||(void 0!==w?void 0!==t?te.add({undo:{patch:[{op:"replace",path:"",value:t}],state:A_(n),json:void 0,text:r,textIsRepaired:i},redo:{patch:[{op:"replace",path:"",value:w}],state:A_(X),json:void 0,text:x,textIsRepaired:Z}}):te.add({undo:{patch:void 0,json:void 0,text:r,state:A_(n),textIsRepaired:i},redo:{patch:void 0,json:w,state:A_(X),text:x,textIsRepaired:Z}}):void 0!==t&&te.add({undo:{patch:void 0,json:t,state:A_(n),text:r,textIsRepaired:i},redo:{patch:void 0,json:void 0,text:x,textIsRepaired:Z,state:A_(X)}}));}var oe=[],ae=dD(vP);function se(e,t,r,i){hP((function(){var o;try{o=ae(e,t,r,i);}catch(e){o=[{path:[],message:"Failed to validate: "+e.message,severity:us.warning}];}zy(o,oe)||(s("validationErrors changed:",o),n(11,oe=o));}),(function(e){return s("validationErrors updated in ".concat(e," ms"))}));}function ce(){return s("validate"),V?{parseError:V,isRepairable:!1}:(se(w,E,O,A),By(oe)?null:{validationErrors:oe})}function ue(e,t){if(s("patch",e,t),void 0===w)throw new Error("Cannot apply patch: no JSON");var r={json:w},i=w,o=X,a=Z,c=uO(w,e),u=U$(w,X,e).json,l=SD(X,e,H),f="function"==typeof t?t(u,l):void 0;n(7,w=f&&void 0!==f.json?f.json:u);var h=f&&void 0!==f.state?f.state:l;n(10,X=h),n(15,x=void 0),n(18,Z=!1),n(17,F=void 0),n(16,V=void 0),te.add({undo:{patch:c,json:void 0,text:void 0,state:A_(o),textIsRepaired:a},redo:{patch:e,json:void 0,state:A_(h),text:void 0,textIsRepaired:Z}});var d={json:w,previousJson:i,undo:c,redo:e};return fe(r,d),d}function le(e,t){if(!k)return ue(e,t)}function fe(e,t){if(void 0!==e.json||void 0!==(null==e?void 0:e.text))if(void 0!==x)T({text:x,json:void 0},e,{contentErrors:ce(),patchResult:t});else if(void 0!==w){T({text:void 0,json:w},e,{contentErrors:ce(),patchResult:t});}}function he(e){s("handleFind",e);}function de(e){s("pasted json as text",e),n(17,F=e);}function ve(e){var t=parseInt(e[0]),n=[String(t+1)].concat(Vi(e.slice(1)));return Gs(w,n)?T_(n,!1):T_(e,!1)}function pe(){b&&(b.focus(),b.select());}function me(){X.selection||Q(function(){if(_s(w)&&!By(w)&&!By(H))return T_(["0"].concat(Vi(H[0])),!1)}());}function ge(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=gD(e,H,J,18),r=n-G,i=we(e);s("scrollTo",{path:e,top:n,scrollTop:G,elem:i});var o=y.getBoundingClientRect();if(i&&!t){var a=i.getBoundingClientRect();if(a.bottom>o.top&&a.top<o.bottom)return}var c=-o.height/4;return new Promise(i?function(t){h(i,{container:y,offset:c,duration:300,callback:function(){ye(e),t();}});}:function(i){var o;h(r,{container:y,offset:c,duration:300,callback:(o=ji(xi().mark((function r(){return xi().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,da();case 2:if(gD(e,H,J,18)===n){r.next=8;break}return r.next=6,ge(e,t);case 6:r.next=9;break;case 8:ye(e);case 9:i();case 10:case"end":return r.stop()}}),r)}))),function(){return o.apply(this,arguments)})});})}function ye(e){var t=we(e);if(t){var r=y.getBoundingClientRect(),i=t.getBoundingClientRect();if(i.right>r.right){var o=i.right-r.right;n(13,y.scrollLeft+=o,y);}if(i.left<r.left){var a=r.left-i.left;n(13,y.scrollLeft-=a,y);}}}function be(e){!function(e){var t=bD(e,H).rowIndex,r=gD(e,H,J,18),i=r+(J[t]||18),o=y.getBoundingClientRect(),a=G,s=G+o.height-18;if(i>s){var c=i-s;n(13,y.scrollTop+=c,y);}if(r<a){var u=a-r;n(13,y.scrollTop-=u,y);}}(e),ye(e);}function we(e){return y?y.querySelector('td[data-path="'.concat(SC(e),'"]')):null}function xe(e){var t=e.anchor,n=e.left,r=e.top,i=e.width,o=e.height,a=e.offsetTop,s=e.offsetLeft,c=e.showTip;U=!0;var u=l(R0,{json:w,documentState:X,parser:O,showTip:c,onEditValue:je,onEditRow:Se,onToggleEnforceString:Ce,onCut:Oe,onCopy:Ee,onPaste:_e,onRemove:Pe,onDuplicateRow:Te,onInsertBeforeRow:Re,onInsertAfterRow:Ne,onRemoveRow:Ie,onCloseContextMenu:function(){f(u),pe();}},{left:n,top:r,offsetTop:a,offsetLeft:s,width:i,height:o,anchor:t,closeOnOuterClick:!0,onClose:function(){U=!1,pe();}});}function ke(e){if(!k&&!B_(X.selection)){if(e&&(e.stopPropagation(),e.preventDefault()),e&&"contextmenu"===e.type&&e.target!==b)xe({left:e.clientX,top:e.clientY,width:260,height:336,showTip:!1});else {var t,n=null===(t=y)||void 0===t?void 0:t.querySelector(".jse-table-cell.jse-selected-value");if(n)xe({anchor:n,offsetTop:2,width:260,height:336,showTip:!1});else {var r,i=null===(r=y)||void 0===r?void 0:r.getBoundingClientRect();i&&xe({top:i.top+2,left:i.left+2,width:260,height:336,showTip:!1});}}return !1}}function je(){if(!k&&X.selection){var e=X.selection.focusPath;du(Vs(w,e))?qe(e):Q(T_(e,!0));}}function Se(){!k&&X.selection&&qe(X.selection.focusPath.slice(0,1));}function Ce(){if(!k&&p_(X.selection)){var e=X.selection.focusPath,t=Ys(e),n=Vs(w,e),r=!r_(n,X.enforceStringMap,t,O),i=r?String(n):bu(String(n),O);s("handleToggleEnforceString",{enforceString:r,value:n,updatedValue:i}),le([{op:"replace",path:t,value:i}],(function(e,n){return {state:H$(n,t,r)}}));}}function $e(){return ($e=ji(xi().mark((function e(){var t,n,r;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s("apply pasted json",F),n=(t=F).path,r=t.contents,Q(T_(n,!1)),e.next=5,da();case 5:le([{op:"replace",path:Ys(n),value:r}]);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _e(){c(HP,{},Oi(Oi({},vs),{},{styleWindow:{width:"450px"}}),{onClose:function(){return pe()}});}function Oe(e){return Me.apply(this,arguments)}function Me(){return (Me=ji(xi().mark((function e(t){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$D({json:w,documentState:X,indentation:t?P:void 0,readOnly:k,parser:O,onPatch:le});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ee(){return Ae.apply(this,arguments)}function Ae(){return Ae=ji(xi().mark((function e(){var t,n=arguments;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(n.length>0&&void 0!==n[0])||n[0],void 0!==w){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,OD({json:w,documentState:X,indentation:t?P:void 0,parser:O});case 5:case"end":return e.stop()}}),e)}))),Ae.apply(this,arguments)}function Pe(){AD({json:w,text:x,documentState:X,keepSelection:!0,readOnly:k,onChange:T,onPatch:le});}function Te(){PD({json:w,documentState:X,columns:H,readOnly:k,onPatch:le});}function Re(){TD({json:w,documentState:X,columns:H,readOnly:k,onPatch:le});}function Ne(){RD({json:w,documentState:X,columns:H,readOnly:k,onPatch:le});}function Ie(){ND({json:w,documentState:X,columns:H,readOnly:k,onPatch:le});}function De(){return (De=ji(xi().mark((function e(t){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,DD({char:t,selectInside:!1,refJsonEditor:g,json:w,documentState:X,readOnly:k,parser:O,onPatch:le,onReplaceJson:Le,onSelect:Q});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Le(e,t){var r=X,i=w,o=x,a={json:w,text:x},s=Z,c=F$(w,X,[],l_),u="function"==typeof t?t(e,c):void 0;n(7,w=u&&void 0!==u.json?u.json:e),n(10,X=u&&void 0!==u.state?u.state:c),n(15,x=void 0),n(18,Z=!1),n(16,V=void 0),Y(w),ie({previousJson:i,previousState:r,previousText:o,previousTextIsRepaired:s});fe(a,null);}function Be(e,t){s("handleChangeText");var r=X,i=w,o=x,a={json:w,text:x},c=Z;try{n(7,w=M(e)),n(10,X=F$(w,X,[],l_)),n(15,x=void 0),n(18,Z=!1),n(16,V=void 0);}catch(t){try{n(7,w=M(su(e))),n(10,X=F$(w,X,[],l_)),n(15,x=e),n(18,Z=!0),n(16,V=void 0);}catch(r){n(7,w=void 0),n(10,X=L$({json:w,expand:l_})),n(15,x=e),n(18,Z=!1),n(16,V=""!==x?zS(x,t.message||t.toString()):void 0);}}if("function"==typeof t){var u=t(w,X);n(7,w=u&&u.json?u.json:w),n(10,X=u&&u.state?u.state:X);}Y(w),ie({previousJson:i,previousState:r,previousText:o,previousTextIsRepaired:c});fe(a,null);}function ze(e){if(void 0!==w){var t=e.id,n=e.onTransform,r=e.onClose,i=e.rootPath||[];U=!0,z({id:t||v,json:w,rootPath:i||[],onTransform:function(e){n?n({operations:e,json:w,transformedJson:tc(w,e)}):(s("onTransform",i,e),le(e));},onClose:function(){U=!1,pe(),r&&r();}});}}function qe(e){s("openJSONEditorModal",{path:e}),U=!0,q({content:{json:Vs(w,e)},path:e,onPatch:ee.onPatch,onClose:function(){U=!1,pe();}});}function Fe(e,t){c(OT,{text:e,onParse:DS,onRepair:LS,onApply:t},Oi(Oi({},vs),{},{styleWindow:{width:"600px",height:"500px"},styleContent:{padding:0,height:"100%"}}),{onClose:function(){return pe()}});}function Ve(){if(!k&&te.getState().canUndo){var e=te.undo();if(e){var t={json:w,text:x};n(7,w=e.undo.patch?tc(w,e.undo.patch):e.undo.json),n(10,X=e.undo.state),n(15,x=e.undo.text),n(18,Z=e.undo.textIsRepaired),n(16,V=void 0),s("undo",{item:e,json:w}),fe(t,{json:w,previousJson:t.json,redo:e.undo.patch,undo:e.redo.patch}),pe(),X.selection&&ge(X.selection.focusPath,!1);}}}function We(){if(!k&&te.getState().canRedo){var e=te.redo();if(e){var t={json:w,text:x};n(7,w=e.redo.patch?tc(w,e.redo.patch):e.redo.json),n(10,X=e.redo.state),n(15,x=e.redo.text),n(18,Z=e.redo.textIsRepaired),n(16,V=void 0),s("redo",{item:e,json:w}),fe(t,{json:w,previousJson:t.json,redo:e.redo.patch,undo:e.undo.patch}),pe(),X.selection&&ge(X.selection.focusPath,!1);}}}function He(e,t){n(68,J[t]=e.getBoundingClientRect().height,J);}return e.$$set=function(e){"readOnly"in e&&n(0,k=e.readOnly),"externalContent"in e&&n(47,j=e.externalContent),"mainMenuBar"in e&&n(1,S=e.mainMenuBar),"escapeControlCharacters"in e&&n(48,C=e.escapeControlCharacters),"escapeUnicodeCharacters"in e&&n(49,$=e.escapeUnicodeCharacters),"flattenColumns"in e&&n(50,_=e.flattenColumns),"parser"in e&&n(2,O=e.parser),"parseMemoizeOne"in e&&n(51,M=e.parseMemoizeOne),"validator"in e&&n(52,E=e.validator),"validationParser"in e&&n(53,A=e.validationParser),"indentation"in e&&n(3,P=e.indentation),"onChange"in e&&n(54,T=e.onChange),"onChangeMode"in e&&n(4,R=e.onChangeMode),"onRenderValue"in e&&n(55,N=e.onRenderValue),"onRenderMenu"in e&&n(5,I=e.onRenderMenu),"onFocus"in e&&n(56,D=e.onFocus),"onBlur"in e&&n(57,L=e.onBlur),"onSortModal"in e&&n(58,B=e.onSortModal),"onTransformModal"in e&&n(59,z=e.onTransformModal),"onJSONEditorModal"in e&&n(60,q=e.onJSONEditorModal);},e.$$.update=function(){393216&e.$$.dirty[1]&&n(67,m=nC({escapeControlCharacters:C,escapeUnicodeCharacters:$})),65536&e.$$.dirty[1]&&re(j),896&e.$$.dirty[0]|524288&e.$$.dirty[1]&&n(9,H=_s(w)?function(e,t){var n,r=new Set(t.map(Ys)),i=new Set(e.map(Ys)),o=wi(r);try{for(o.s();!(n=o.n()).done;){var a=n.value;i.has(a)||r.delete(a);}}catch(e){o.e(e);}finally{o.f();}var s,c=wi(i);try{for(c.s();!(s=c.n()).done;){var u=s.value;r.has(u)||r.add(u);}}catch(e){c.e(e);}finally{c.f();}return Vi(r).map(Qs)}(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,r={};Array.isArray(e)&&RS(e,n,(function(e){hu(e)?pD(e,r,t):r[vD]=!0;}));var i=[];return vD in r&&i.push([]),mD(r,[],i,t),i}(w,_,W),H):[]),640&e.$$.dirty[0]&&n(24,r=w&&!By(H)),384&e.$$.dirty[0]&&n(23,i=Array.isArray(w)&&w.length>W),128&e.$$.dirty[0]|448&e.$$.dirty[2]&&n(22,o=function(e,t,n,r,i){for(var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:80,a=_s(n)?n.length:0,s=yD(r,i),c=e-o,u=t+2*o,l=function(e){return r[e]||i},f=0,h=0;h<c&&f<a;)h+=l(f),f++;f>0&&(h-=l(--f));for(var d=f,v=0;v<u&&d<a;)v+=l(d),d++;for(var p=0,m=d;m<a;m++)p+=l(m);var g=_s(n)?n.slice(f,d):[];return {startIndex:f,endIndex:d,startHeight:h,endHeight:p,averageItemHeight:s,visibleHeight:v,visibleItems:g}}(G,K,w,J,18)),128&e.$$.dirty[0]&&y&&y.scrollTo({top:y.scrollTop,left:y.scrollLeft}),1157&e.$$.dirty[0]|16777216&e.$$.dirty[1]|32&e.$$.dirty[2]&&n(20,ee={readOnly:k,parser:O,normalization:m,getJson:function(){return w},getDocumentState:function(){return X},findElement:we,findNextInside:ve,focus:pe,onPatch:le,onSelect:Q,onFind:he,onPasteJson:de,onRenderValue:N}),132&e.$$.dirty[0]|6291456&e.$$.dirty[1]&&se(w,E,O,A),2560&e.$$.dirty[0]&&n(21,a=xD(oe,H));},[k,S,O,P,R,I,function(){if(Z&&void 0!==w){var e=X,t=w,r=x,i={json:w,text:x},o=Z;n(15,x=void 0),n(18,Z=!1),Y(w),ie({previousJson:t,previousState:e,previousText:r,previousTextIsRepaired:o});fe(i,null);}return {json:w,text:x}},w,W,H,X,oe,g,y,b,x,V,F,Z,ne,ee,a,o,i,r,p,undefined,function(e){if(!k){s("onSortByHeader",e);var t=e.sortDirection===fs.desc?-1:1;le(xI(w,[],e.path,t),(function(t,n){return {state:Oi(Oi({},n),{},{sortedColumn:e})}}));}},function(e){n(70,G=e.target.scrollTop);},function(e){var t=null!=e&&e.target?CC(e.target):void 0;if(t){if(B_(X.selection)&&x_(X.selection,t,ss.value))return;Q(T_(t,!1)),pe(),e.preventDefault();}},xe,ke,function(e){k||xe({anchor:kC(e.target,"BUTTON"),offsetTop:0,width:260,height:336,showTip:!0});},function(){return $e.apply(this,arguments)},function(){s("clear pasted json"),n(17,F=void 0);},function(){R(as.text);},function(e){var t=_C(e);if(s("keydown",{combo:t,key:e.key}),"Ctrl+X"===t&&(e.preventDefault(),Oe(!0)),"Ctrl+Shift+X"===t&&(e.preventDefault(),Oe(!1)),"Ctrl+C"===t&&(e.preventDefault(),Ee(!0)),"Ctrl+Shift+C"===t&&(e.preventDefault(),Ee(!1)),"Ctrl+D"===t&&e.preventDefault(),"Delete"!==t&&"Backspace"!==t||(e.preventDefault(),Pe()),"Insert"===t&&e.preventDefault(),"Ctrl+A"===t&&e.preventDefault(),"Ctrl+Q"===t&&ke(e),"ArrowLeft"===t&&(e.preventDefault(),me(),X.selection)){var n=function(e,t){var n=bD(t.focusPath,e),r=n.rowIndex,i=n.columnIndex;return i>0?T_(wD({rowIndex:r,columnIndex:i-1},e),!1):t}(H,X.selection);Q(n),be(n.focusPath);}if("ArrowRight"===t&&(e.preventDefault(),me(),X.selection)){var r=function(e,t){var n=bD(t.focusPath,e),r=n.rowIndex,i=n.columnIndex;return i<e.length-1?T_(wD({rowIndex:r,columnIndex:i+1},e),!1):t}(H,X.selection);Q(r),be(r.focusPath);}if("ArrowUp"===t&&(e.preventDefault(),me(),X.selection)){var i=function(e,t){var n=bD(t.focusPath,e),r=n.rowIndex,i=n.columnIndex;return r>0?T_(wD({rowIndex:r-1,columnIndex:i},e),!1):t}(H,X.selection);Q(i),be(i.focusPath);}if("ArrowDown"===t&&(e.preventDefault(),me(),X.selection)){var o=function(e,t,n){var r=bD(n.focusPath,t),i=r.rowIndex,o=r.columnIndex;return i<e.length-1?T_(wD({rowIndex:i+1,columnIndex:o},t),!1):n}(w,H,X.selection);Q(o),be(o.focusPath);}if("Enter"===t&&X.selection&&p_(X.selection)){e.preventDefault();var a=X.selection.focusPath;du(Vs(w,a))?qe(a):k||Q(Oi(Oi({},X.selection),{},{edit:!0}));}if(1===t.replace(/^Shift\+/,"").length&&X.selection)return e.preventDefault(),void function(e){De.apply(this,arguments);}(e.key);if("Ctrl+Enter"===t&&p_(X.selection)){var c=Vs(w,X.selection.focusPath);yu(c)&&window.open(String(c),"_blank");}"Escape"===t&&X.selection&&(e.preventDefault(),Q(void 0)),"Ctrl+F"===t&&e.preventDefault(),"Ctrl+H"===t&&e.preventDefault(),"Ctrl+Z"===t&&(e.preventDefault(),Ve()),"Ctrl+Shift+Z"===t&&(e.preventDefault(),We());},function(e){e.preventDefault(),ED({clipboardText:e.clipboardData.getData("text/plain"),json:w,documentState:X,readOnly:k,parser:O,onPatch:le,onChangeText:Be,openRepairModal:Fe});},function(e){s("select validation error",e),Q(T_(e.path,!1)),ge(e.path);},qe,function(){!function(e){k||void 0===w||(U=!0,B({id:d,json:w,rootPath:e,onSort:function(t){var n=t.operations,r=t.itemPath,i=t.direction;s("onSort",n,e,r,i),le(n,(function(e,t){return {state:Oi(Oi({},t),{},{sortedColumn:{path:r,sortDirection:-1===i?fs.desc:fs.asc}})}}));},onClose:function(){U=!1,pe();}}));}([]);},function(){ze({rootPath:[]});},Ve,We,function(e){n(69,K=e.getBoundingClientRect().height);},He,function(e,t){return !!t&&!0===t.pointersMap[Ys(e)]},j,C,$,_,M,E,A,T,N,D,L,B,z,q,ce,ue,pe,ge,we,ze,m,J,K,G,function(e){sa[e?"unshift":"push"]((function(){n(14,b=e);}));},function(){return n(8,W=1/0)},function(e,t){return He(t,e)},function(e){sa[e?"unshift":"push"]((function(){n(13,y=e);}));},function(e){sa[e?"unshift":"push"]((function(){n(12,g=e);}));}]}var b1=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,y1,g1,no,{readOnly:0,externalContent:47,mainMenuBar:1,escapeControlCharacters:48,escapeUnicodeCharacters:49,flattenColumns:50,parser:2,parseMemoizeOne:51,validator:52,validationParser:53,indentation:3,onChange:54,onChangeMode:4,onRenderValue:55,onRenderMenu:5,onFocus:56,onBlur:57,onSortModal:58,onTransformModal:59,onJSONEditorModal:60,validate:61,patch:62,focus:63,acceptAutoRepair:6,scrollTo:64,findElement:65,openTransformModal:66},J0,[-1,-1,-1,-1,-1]),r}return qi(n,[{key:"validate",get:function(){return this.$$.ctx[61]}},{key:"patch",get:function(){return this.$$.ctx[62]}},{key:"focus",get:function(){return this.$$.ctx[63]}},{key:"acceptAutoRepair",get:function(){return this.$$.ctx[6]}},{key:"scrollTo",get:function(){return this.$$.ctx[64]}},{key:"findElement",get:function(){return this.$$.ctx[65]}},{key:"openTransformModal",get:function(){return this.$$.ctx[66]}}]),n}();function w1(e){var t,n,r={externalContent:e[0],readOnly:e[1],indentation:e[2],mainMenuBar:e[5],navigationBar:e[6],escapeControlCharacters:e[9],escapeUnicodeCharacters:e[10],parser:e[12],parseMemoizeOne:e[13],validator:e[14],validationParser:e[15],pathParser:e[16],onError:e[21],onChange:e[17],onChangeMode:e[20],onRenderValue:e[18],onClassName:e[19],onFocus:e[22],onBlur:e[23],onRenderMenu:e[30],onSortModal:e[24],onTransformModal:e[25],onJSONEditorModal:e[26]};return t=new aL({props:r}),e[45](t),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n[0]&&(r.externalContent=e[0]),2&n[0]&&(r.readOnly=e[1]),4&n[0]&&(r.indentation=e[2]),32&n[0]&&(r.mainMenuBar=e[5]),64&n[0]&&(r.navigationBar=e[6]),512&n[0]&&(r.escapeControlCharacters=e[9]),1024&n[0]&&(r.escapeUnicodeCharacters=e[10]),4096&n[0]&&(r.parser=e[12]),8192&n[0]&&(r.parseMemoizeOne=e[13]),16384&n[0]&&(r.validator=e[14]),32768&n[0]&&(r.validationParser=e[15]),65536&n[0]&&(r.pathParser=e[16]),2097152&n[0]&&(r.onError=e[21]),131072&n[0]&&(r.onChange=e[17]),1048576&n[0]&&(r.onChangeMode=e[20]),262144&n[0]&&(r.onRenderValue=e[18]),524288&n[0]&&(r.onClassName=e[19]),4194304&n[0]&&(r.onFocus=e[22]),8388608&n[0]&&(r.onBlur=e[23]),1073741824&n[0]&&(r.onRenderMenu=e[30]),16777216&n[0]&&(r.onSortModal=e[24]),33554432&n[0]&&(r.onTransformModal=e[25]),67108864&n[0]&&(r.onJSONEditorModal=e[26]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(n){e[45](null),Ba(t,n);}}}function x1(e){var t,n,r={externalContent:e[0],readOnly:e[1],mainMenuBar:e[5],escapeControlCharacters:e[9],escapeUnicodeCharacters:e[10],flattenColumns:e[11],parser:e[12],parseMemoizeOne:e[13],validator:e[14],validationParser:e[15],indentation:e[2],onChange:e[17],onChangeMode:e[20],onRenderValue:e[18],onFocus:e[22],onBlur:e[23],onRenderMenu:e[30],onSortModal:e[24],onTransformModal:e[25],onJSONEditorModal:e[26]};return t=new b1({props:r}),e[44](t),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n[0]&&(r.externalContent=e[0]),2&n[0]&&(r.readOnly=e[1]),32&n[0]&&(r.mainMenuBar=e[5]),512&n[0]&&(r.escapeControlCharacters=e[9]),1024&n[0]&&(r.escapeUnicodeCharacters=e[10]),2048&n[0]&&(r.flattenColumns=e[11]),4096&n[0]&&(r.parser=e[12]),8192&n[0]&&(r.parseMemoizeOne=e[13]),16384&n[0]&&(r.validator=e[14]),32768&n[0]&&(r.validationParser=e[15]),4&n[0]&&(r.indentation=e[2]),131072&n[0]&&(r.onChange=e[17]),1048576&n[0]&&(r.onChangeMode=e[20]),262144&n[0]&&(r.onRenderValue=e[18]),4194304&n[0]&&(r.onFocus=e[22]),8388608&n[0]&&(r.onBlur=e[23]),1073741824&n[0]&&(r.onRenderMenu=e[30]),16777216&n[0]&&(r.onSortModal=e[24]),33554432&n[0]&&(r.onTransformModal=e[25]),67108864&n[0]&&(r.onJSONEditorModal=e[26]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(n){e[44](null),Ba(t,n);}}}function k1(e){var t,n,r={externalContent:e[0],readOnly:e[1],indentation:e[2],tabSize:e[3],mainMenuBar:e[5],statusBar:e[7],askToFormat:e[8],escapeUnicodeCharacters:e[10],parser:e[12],validator:e[14],validationParser:e[15],onChange:e[17],onChangeMode:e[20],onError:e[21],onFocus:e[22],onBlur:e[23],onRenderMenu:e[30],onSortModal:e[24],onTransformModal:e[25]};return t=new f0({props:r}),e[43](t),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};1&n[0]&&(r.externalContent=e[0]),2&n[0]&&(r.readOnly=e[1]),4&n[0]&&(r.indentation=e[2]),8&n[0]&&(r.tabSize=e[3]),32&n[0]&&(r.mainMenuBar=e[5]),128&n[0]&&(r.statusBar=e[7]),256&n[0]&&(r.askToFormat=e[8]),1024&n[0]&&(r.escapeUnicodeCharacters=e[10]),4096&n[0]&&(r.parser=e[12]),16384&n[0]&&(r.validator=e[14]),32768&n[0]&&(r.validationParser=e[15]),131072&n[0]&&(r.onChange=e[17]),1048576&n[0]&&(r.onChangeMode=e[20]),2097152&n[0]&&(r.onError=e[21]),4194304&n[0]&&(r.onFocus=e[22]),8388608&n[0]&&(r.onBlur=e[23]),1073741824&n[0]&&(r.onRenderMenu=e[30]),16777216&n[0]&&(r.onSortModal=e[24]),33554432&n[0]&&(r.onTransformModal=e[25]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(n){e[43](null),Ba(t,n);}}}function j1(e){var t,n,r,i,o=[k1,x1,w1],a=[];function s(e,t){return e[4]===as.text||"code"===e[4]?0:e[4]===as.table?1:2}return t=s(e),n=a[t]=o[t](e),{c:function(){n.c(),r=Eo();},m:function(e,n){a[t].m(e,n),jo(e,r,n),i=!0;},p:function(e,i){var c=t;(t=s(e))===c?a[t].p(e,i):(Sa(),_a(a[c],1,1,(function(){a[c]=null;})),Ca(),(n=a[t])?n.p(e,i):(n=a[t]=o[t](e)).c(),$a(n,1),n.m(r.parentNode,r));},i:function(e){i||($a(n),i=!0);},o:function(e){_a(n),i=!1;},d:function(e){a[t].d(e),e&&So(r);}}}function S1(e,t,n){var r,i,o,a,s,c=t.content,u=t.readOnly,l=t.indentation,f=t.tabSize,h=t.mode,d=t.mainMenuBar,v=t.navigationBar,p=t.statusBar,m=t.askToFormat,g=t.escapeControlCharacters,y=t.escapeUnicodeCharacters,b=t.flattenColumns,w=t.parser,x=t.parseMemoizeOne,k=t.validator,j=t.validationParser,S=t.pathParser,C=t.insideModal,$=t.onChange,_=t.onRenderValue,O=t.onClassName,M=t.onRenderMenu,E=t.onChangeMode,A=t.onError,P=t.onFocus,T=t.onBlur,R=t.onSortModal,N=t.onTransformModal,I=t.onJSONEditorModal,D={separator:!0};function L(){return (L=ji(xi().mark((function e(){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=3;break}return e.next=3,o.refresh();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return e.$$set=function(e){"content"in e&&n(0,c=e.content),"readOnly"in e&&n(1,u=e.readOnly),"indentation"in e&&n(2,l=e.indentation),"tabSize"in e&&n(3,f=e.tabSize),"mode"in e&&n(4,h=e.mode),"mainMenuBar"in e&&n(5,d=e.mainMenuBar),"navigationBar"in e&&n(6,v=e.navigationBar),"statusBar"in e&&n(7,p=e.statusBar),"askToFormat"in e&&n(8,m=e.askToFormat),"escapeControlCharacters"in e&&n(9,g=e.escapeControlCharacters),"escapeUnicodeCharacters"in e&&n(10,y=e.escapeUnicodeCharacters),"flattenColumns"in e&&n(11,b=e.flattenColumns),"parser"in e&&n(12,w=e.parser),"parseMemoizeOne"in e&&n(13,x=e.parseMemoizeOne),"validator"in e&&n(14,k=e.validator),"validationParser"in e&&n(15,j=e.validationParser),"pathParser"in e&&n(16,S=e.pathParser),"insideModal"in e&&n(31,C=e.insideModal),"onChange"in e&&n(17,$=e.onChange),"onRenderValue"in e&&n(18,_=e.onRenderValue),"onClassName"in e&&n(19,O=e.onClassName),"onRenderMenu"in e&&n(32,M=e.onRenderMenu),"onChangeMode"in e&&n(20,E=e.onChangeMode),"onError"in e&&n(21,A=e.onError),"onFocus"in e&&n(22,P=e.onFocus),"onBlur"in e&&n(23,T=e.onBlur),"onSortModal"in e&&n(24,R=e.onSortModal),"onTransformModal"in e&&n(25,N=e.onTransformModal),"onJSONEditorModal"in e&&n(26,I=e.onJSONEditorModal);},e.$$.update=function(){1048592&e.$$.dirty[0]&&n(42,a=[{type:"button",text:"text",title:"Switch to text mode (current mode: ".concat(h,")"),className:"jse-group-button jse-first"+(h===as.text||"code"===h?" jse-selected":""),onClick:function(){return E(as.text)}},{type:"button",text:"tree",title:"Switch to tree mode (current mode: ".concat(h,")"),className:"jse-group-button "+(h===as.tree?" jse-selected":""),onClick:function(){return E(as.tree)}},{type:"button",text:"table",title:"Switch to table mode (current mode: ".concat(h,")"),className:"jse-group-button jse-last"+(h===as.table?" jse-selected":""),onClick:function(){return E(as.table)}}]),16&e.$$.dirty[0]|2051&e.$$.dirty[1]&&n(30,s=function(e){var t=UP(e[0])?a.concat(e):a.concat(D,e);return M(t,{mode:h,modal:C})||t});},[c,u,l,f,h,d,v,p,m,g,y,b,w,x,k,j,S,$,_,O,E,A,P,T,R,N,I,r,i,o,s,C,M,function(e){return r?r.patch(e):i?i.patch(e):o?o.patch(e):void 0},function(e){if(r)return r.expand(e);throw new Error('Method expand is not available in mode "'.concat(h,'"'))},function(e){if(o)o.openTransformModal(e);else if(r)r.openTransformModal(e);else {if(!i)throw new Error('Method transform is not available in mode "'.concat(h,'"'));i.openTransformModal(e);}},function(){if(o)return o.validate();if(r)return r.validate();if(i)return i.validate();throw new Error('Method validate is not available in mode "'.concat(h,'"'))},function(){return r?r.acceptAutoRepair():c},function(e){if(r)return r.scrollTo(e);if(i)return i.scrollTo(e);throw new Error('Method scrollTo is not available in mode "'.concat(h,'"'))},function(e){if(r)return r.findElement(e);if(i)return i.findElement(e);throw new Error('Method findElement is not available in mode "'.concat(h,'"'))},function(){o?o.focus():r?r.focus():i&&i.focus();},function(){return L.apply(this,arguments)},a,function(e){sa[e?"unshift":"push"]((function(){n(29,o=e);}));},function(e){sa[e?"unshift":"push"]((function(){n(28,i=e);}));},function(e){sa[e?"unshift":"push"]((function(){n(27,r=e);}));}]}var C1=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,S1,j1,to,{content:0,readOnly:1,indentation:2,tabSize:3,mode:4,mainMenuBar:5,navigationBar:6,statusBar:7,askToFormat:8,escapeControlCharacters:9,escapeUnicodeCharacters:10,flattenColumns:11,parser:12,parseMemoizeOne:13,validator:14,validationParser:15,pathParser:16,insideModal:31,onChange:17,onRenderValue:18,onClassName:19,onRenderMenu:32,onChangeMode:20,onError:21,onFocus:22,onBlur:23,onSortModal:24,onTransformModal:25,onJSONEditorModal:26,patch:33,expand:34,transform:35,validate:36,acceptAutoRepair:37,scrollTo:38,findElement:39,focus:40,refresh:41},null,[-1,-1]),r}return qi(n,[{key:"patch",get:function(){return this.$$.ctx[33]}},{key:"expand",get:function(){return this.$$.ctx[34]}},{key:"transform",get:function(){return this.$$.ctx[35]}},{key:"validate",get:function(){return this.$$.ctx[36]}},{key:"acceptAutoRepair",get:function(){return this.$$.ctx[37]}},{key:"scrollTo",get:function(){return this.$$.ctx[38]}},{key:"findElement",get:function(){return this.$$.ctx[39]}},{key:"focus",get:function(){return this.$$.ctx[40]}},{key:"refresh",get:function(){return this.$$.ctx[41]}}]),n}();function $1(e){bo(e,"svelte-1hibiw3",".jse-modal.svelte-1hibiw3.svelte-1hibiw3{--height:36px;--multi-item-height:28px;--multi-item-margin:2px;--multi-item-padding:2px 8px;--multi-item-border-radius:6px;--indicator-top:8px;flex:1;display:flex;flex-direction:column;min-width:0;min-height:0;font-family:var(--jse-font-family);font-size:var(--jse-font-size);line-height:normal;background:var(--jse-modal-background);color:var(--jse-text-color)}.jse-modal.svelte-1hibiw3 .jse-modal-contents.svelte-1hibiw3{padding:20px;overflow:auto;min-width:0;min-height:0}.jse-modal.svelte-1hibiw3 .jse-modal-contents .jse-actions.svelte-1hibiw3{display:flex;flex-direction:row;justify-content:flex-end;padding-top:var(--jse-padding)}.jse-modal.svelte-1hibiw3 .jse-modal-contents .jse-actions button.jse-primary.svelte-1hibiw3{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;background:var(--jse-button-primary-background);color:var(--jse-button-primary-color);padding:var(--jse-padding) calc(2 * var(--jse-padding));border-radius:3px}.jse-modal.svelte-1hibiw3 .jse-modal-contents .jse-actions button.jse-primary.svelte-1hibiw3:hover{background:var(--jse-button-primary-background-highlight)}.jse-modal.svelte-1hibiw3 .jse-modal-contents .jse-actions button.jse-primary.svelte-1hibiw3:disabled{background:var(--jse-button-primary-background-disabled)}.bg.jse-modal-bg{width:100%;height:100%;top:0;left:0;background:var(--jse-modal-overlay-background)}.bg.jse-modal-bg .jse-modal-window-wrap{margin:0}.bg.jse-modal-bg .jse-modal-window{max-width:90%;margin:4rem auto 2rem auto;border-radius:2px}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-sort{width:400px}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-transform{width:1200px;height:1200px;max-height:80%;display:flex}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-jsoneditor{width:800px;height:auto;min-height:500px;max-height:80%;display:flex}.bg.jse-modal-bg .jse-modal-content{flex:1;display:flex;max-height:calc(100vh - 6rem);padding:0}.jse-modal.jse-jsoneditor-modal.svelte-1hibiw3 .jse-modal-contents.svelte-1hibiw3{flex:1;display:flex;flex-direction:column;padding-top:0;--jse-theme-color:var(--jse-modal-theme-color);--jse-theme-color-highlight:var(--jse-modal-theme-color-highlight)}.jse-modal.jse-jsoneditor-modal.svelte-1hibiw3 .jse-modal-contents .jse-label.svelte-1hibiw3{font-weight:bold;display:block;box-sizing:border-box}.jse-modal.jse-jsoneditor-modal.svelte-1hibiw3 .jse-modal-contents .jse-label .jse-label-inner.svelte-1hibiw3{margin-top:calc(2 * var(--jse-padding));margin-bottom:calc(0.5 * var(--jse-padding));box-sizing:border-box}.jse-modal.jse-jsoneditor-modal.svelte-1hibiw3 .jse-modal-contents .jse-label .jse-label-inner button.svelte-1hibiw3{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;font-weight:bold;padding:0}.jse-modal.jse-jsoneditor-modal.svelte-1hibiw3 .jse-modal-contents .jse-modal-inline-editor.svelte-1hibiw3{flex:1;min-height:0;min-width:0;display:flex}.jse-modal.jse-jsoneditor-modal.svelte-1hibiw3 .jse-actions.svelte-1hibiw3{gap:var(--jse-padding);align-items:center}.jse-modal.jse-jsoneditor-modal.svelte-1hibiw3 .jse-actions .jse-error.svelte-1hibiw3{flex:1;color:var(--jse-error-color)}.jse-modal.jse-jsoneditor-modal.svelte-1hibiw3 .jse-actions button.jse-secondary.svelte-1hibiw3{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;background:var(--jse-button-secondary-background);color:var(--jse-button-secondary-color);padding:var(--jse-padding) calc(2 * var(--jse-padding));border-radius:3px}.jse-modal.jse-jsoneditor-modal.svelte-1hibiw3 .jse-actions button.jse-secondary.svelte-1hibiw3:hover{background:var(--jse-button-secondary-background-highlight)}.jse-modal.jse-jsoneditor-modal.svelte-1hibiw3 .jse-actions button.jse-secondary.svelte-1hibiw3:disabled{background:var(--jse-button-secondary-background-disabled)}.jse-modal.jse-jsoneditor-modal.svelte-1hibiw3 input.svelte-1hibiw3{border:var(--jse-input-border);outline:none;box-sizing:border-box;padding:calc(0.5 * var(--jse-padding));font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);color:inherit;background:var(--jse-input-background)}.jse-modal.jse-jsoneditor-modal.svelte-1hibiw3 input.svelte-1hibiw3:focus{border:var(--jse-input-border-focus)}.jse-modal.jse-jsoneditor-modal.svelte-1hibiw3 input.svelte-1hibiw3:read-only{background:var(--jse-input-background-readonly)}");}function _1(e){var t,n;return {c:function(){t=$o("div"),n=Oo(e[20]),Ro(t,"class","jse-error svelte-1hibiw3");},m:function(e,r){jo(e,t,r),yo(t,n);},p:function(e,t){1048576&t[0]&&Lo(n,e[20]);},d:function(e){e&&So(t);}}}function O1(e){var t,n,r,i,o,a;return n=new x$({props:{data:XO}}),{c:function(){t=$o("button"),Da(n.$$.fragment),r=Oo(" Back"),Ro(t,"type","button"),Ro(t,"class","jse-secondary svelte-1hibiw3");},m:function(s,c){jo(s,t,c),La(n,t,null),yo(t,r),i=!0,o||(a=Ao(t,"click",e[24]),o=!0);},p:Ki,i:function(e){i||($a(n.$$.fragment,e),i=!0);},o:function(e){_a(n.$$.fragment,e),i=!1;},d:function(e){e&&So(t),Ba(n),o=!1,a();}}}function M1(e){var t,n,r;return {c:function(){(t=$o("button")).textContent="Close",Ro(t,"type","button"),Ro(t,"class","jse-primary svelte-1hibiw3");},m:function(i,o){jo(i,t,o),n||(r=[Ao(t,"click",e[24]),fo(P1.call(null,t))],n=!0);},p:Ki,d:function(e){e&&So(t),n=!1,Zi(r);}}}function E1(e){var t,n,r;return {c:function(){(t=$o("button")).textContent="Apply",Ro(t,"type","button"),Ro(t,"class","jse-primary svelte-1hibiw3");},m:function(i,o){jo(i,t,o),n||(r=[Ao(t,"click",e[23]),fo(P1.call(null,t))],n=!0);},p:Ki,d:function(e){e&&So(t),n=!1,Zi(r);}}}function A1(e){var t,n,r,i,o,a,s,c,u,l,f,h,d,v,p,m,g,y,b;n=new qP({props:{title:"Edit nested content "+(e[19].length>1?" (".concat(e[19].length,")"):""),onClose:e[24]}}),h=new C1({props:{mode:Em(e[19]).mode,content:Em(e[19]).content,readOnly:e[0],indentation:e[1],tabSize:e[2],statusBar:e[5],askToFormat:e[6],mainMenuBar:e[3],navigationBar:e[4],escapeControlCharacters:e[7],escapeUnicodeCharacters:e[8],flattenColumns:e[9],parser:e[10],parseMemoizeOne:e[21],validator:e[11],validationParser:e[12],pathParser:e[13],insideModal:!0,onError:e[27],onChange:e[25],onChangeMode:e[26],onRenderValue:e[14],onClassName:e[15],onFocus:_L,onBlur:_L,onRenderMenu:e[16],onSortModal:e[17],onTransformModal:e[18],onJSONEditorModal:e[28]}});var w=e[20]&&_1(e),x=e[19].length>1&&O1(e);function k(e,t){return e[0]?M1:E1}var j=k(e),S=j(e);return {c:function(){t=$o("div"),Da(n.$$.fragment),r=Mo(),i=$o("div"),(o=$o("div")).innerHTML='<div class="jse-label-inner svelte-1hibiw3">Path</div>',a=Mo(),s=$o("input"),c=Mo(),(u=$o("div")).innerHTML='<div class="jse-label-inner svelte-1hibiw3">Contents</div>',l=Mo(),f=$o("div"),Da(h.$$.fragment),d=Mo(),v=$o("div"),w&&w.c(),p=Mo(),x&&x.c(),m=Mo(),S.c(),Ro(o,"class","jse-label svelte-1hibiw3"),Ro(s,"class","jse-path svelte-1hibiw3"),Ro(s,"type","text"),s.readOnly=!0,Ro(s,"title","Selected path"),s.value=e[22],Ro(u,"class","jse-label svelte-1hibiw3"),Ro(f,"class","jse-modal-inline-editor svelte-1hibiw3"),Ro(v,"class","jse-actions svelte-1hibiw3"),Ro(i,"class","jse-modal-contents svelte-1hibiw3"),Ro(t,"class","jse-modal jse-jsoneditor-modal svelte-1hibiw3");},m:function(k,j){jo(k,t,j),La(n,t,null),yo(t,r),yo(t,i),yo(i,o),yo(i,a),yo(i,s),yo(i,c),yo(i,u),yo(i,l),yo(i,f),La(h,f,null),yo(i,d),yo(i,v),w&&w.m(v,null),yo(v,p),x&&x.m(v,null),yo(v,m),S.m(v,null),g=!0,y||(b=fo(ST.call(null,t,e[24])),y=!0);},p:function(e,t){var r={};524288&t[0]&&(r.title="Edit nested content "+(e[19].length>1?" (".concat(e[19].length,")"):"")),n.$set(r),(!g||4194304&t[0]&&s.value!==e[22])&&(s.value=e[22]);var i={};524288&t[0]&&(i.mode=Em(e[19]).mode),524288&t[0]&&(i.content=Em(e[19]).content),1&t[0]&&(i.readOnly=e[0]),2&t[0]&&(i.indentation=e[1]),4&t[0]&&(i.tabSize=e[2]),32&t[0]&&(i.statusBar=e[5]),64&t[0]&&(i.askToFormat=e[6]),8&t[0]&&(i.mainMenuBar=e[3]),16&t[0]&&(i.navigationBar=e[4]),128&t[0]&&(i.escapeControlCharacters=e[7]),256&t[0]&&(i.escapeUnicodeCharacters=e[8]),512&t[0]&&(i.flattenColumns=e[9]),1024&t[0]&&(i.parser=e[10]),2097152&t[0]&&(i.parseMemoizeOne=e[21]),2048&t[0]&&(i.validator=e[11]),4096&t[0]&&(i.validationParser=e[12]),8192&t[0]&&(i.pathParser=e[13]),16384&t[0]&&(i.onRenderValue=e[14]),32768&t[0]&&(i.onClassName=e[15]),65536&t[0]&&(i.onRenderMenu=e[16]),131072&t[0]&&(i.onSortModal=e[17]),262144&t[0]&&(i.onTransformModal=e[18]),h.$set(i),e[20]?w?w.p(e,t):((w=_1(e)).c(),w.m(v,p)):w&&(w.d(1),w=null),e[19].length>1?x?(x.p(e,t),524288&t[0]&&$a(x,1)):((x=O1(e)).c(),$a(x,1),x.m(v,m)):x&&(Sa(),_a(x,1,1,(function(){x=null;})),Ca()),j===(j=k(e))&&S?S.p(e,t):(S.d(1),(S=j(e))&&(S.c(),S.m(v,null)));},i:function(e){g||($a(n.$$.fragment,e),$a(h.$$.fragment,e),$a(x),g=!0);},o:function(e){_a(n.$$.fragment,e),_a(h.$$.fragment,e),_a(x),g=!1;},d:function(e){e&&So(t),Ba(n),Ba(h),w&&w.d(),x&&x.d(),S.d(),y=!1,b();}}}function P1(e){e.focus();}function T1(e,t,n){var r,i,o,a=Ha("jsoneditor:JSONEditorModal"),s=t.content,c=t.path,u=t.onPatch,l=t.readOnly,f=t.indentation,h=t.tabSize,d=t.mainMenuBar,v=t.navigationBar,p=t.statusBar,m=t.askToFormat,g=t.escapeControlCharacters,y=t.escapeUnicodeCharacters,b=t.flattenColumns,w=t.parser,x=t.validator,k=t.validationParser,j=t.pathParser,S=t.onRenderValue,C=t.onClassName,$=t.onRenderMenu,_=t.onSortModal,O=t.onTransformModal,M=ia("simple-modal").close,E=[{mode:P(s),content:s,relativePath:c}],A=void 0;function P(e){return WS(e)&&_s(e.json)?as.table:as.tree}function T(e){a("handleChange",e);var t=Oi(Oi({},Em(E)),{},{content:e});n(19,E=[].concat(Vi(ly(E)),[t]));}return e.$$set=function(e){"content"in e&&n(29,s=e.content),"path"in e&&n(30,c=e.path),"onPatch"in e&&n(31,u=e.onPatch),"readOnly"in e&&n(0,l=e.readOnly),"indentation"in e&&n(1,f=e.indentation),"tabSize"in e&&n(2,h=e.tabSize),"mainMenuBar"in e&&n(3,d=e.mainMenuBar),"navigationBar"in e&&n(4,v=e.navigationBar),"statusBar"in e&&n(5,p=e.statusBar),"askToFormat"in e&&n(6,m=e.askToFormat),"escapeControlCharacters"in e&&n(7,g=e.escapeControlCharacters),"escapeUnicodeCharacters"in e&&n(8,y=e.escapeUnicodeCharacters),"flattenColumns"in e&&n(9,b=e.flattenColumns),"parser"in e&&n(10,w=e.parser),"validator"in e&&n(11,x=e.validator),"validationParser"in e&&n(12,k=e.validationParser),"pathParser"in e&&n(13,j=e.pathParser),"onRenderValue"in e&&n(14,S=e.onRenderValue),"onClassName"in e&&n(15,C=e.onClassName),"onRenderMenu"in e&&n(16,$=e.onRenderMenu),"onSortModal"in e&&n(17,_=e.onSortModal),"onTransformModal"in e&&n(18,O=e.onTransformModal);},e.$$.update=function(){524288&e.$$.dirty[0]&&n(32,r=E.flatMap((function(e){return e.relativePath}))),2&e.$$.dirty[1]&&n(22,i=By(r)?"(whole document)":FC(r)),1024&e.$$.dirty[0]&&n(21,o=dD(w.parse));},[l,f,h,d,v,p,m,g,y,b,w,x,k,j,S,C,$,_,O,E,A,o,i,function(){if(a("handleApply"),!l)try{n(20,A=void 0);var e=[{op:"replace",path:Ys(Em(E).relativePath),value:US(Em(E).content,w).json}];if(E.length>1){var t={json:tc(US(E[E.length-2].content,w).json,e)};n(19,E=ly(E)),T(t);}else u(e),M();}catch(e){n(20,A=e.toString());}},function(){a("handleClose"),E.length>1?(n(19,E=ly(E)),n(20,A=void 0)):M();},T,function(e){a("handleChangeMode",e);var t=Oi(Oi({},Em(E)),{},{mode:e});n(19,E=[].concat(Vi(ly(E)),[t]));},function(e){n(20,A=e.toString()),console.error(e);},function(e){var t=e.content,r=e.path;a("handleJSONEditorModal",{content:t,path:r});var i={mode:P(t),content:t,relativePath:r};n(19,E=[].concat(Vi(E),[i]));},s,c,u,r]}var R1=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,T1,A1,no,{content:29,path:30,onPatch:31,readOnly:0,indentation:1,tabSize:2,mainMenuBar:3,navigationBar:4,statusBar:5,askToFormat:6,escapeControlCharacters:7,escapeUnicodeCharacters:8,flattenColumns:9,parser:10,validator:11,validationParser:12,pathParser:13,onRenderValue:14,onClassName:15,onRenderMenu:16,onSortModal:17,onTransformModal:18},$1,[-1,-1]),r}return qi(n)}();function N1(e,t,n){var r=ia("simple-modal");return [r.open,r.close]}var I1=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,N1,null,no,{open:0,close:1}),r}return qi(n,[{key:"open",get:function(){return this.$$.ctx[0]}},{key:"close",get:function(){return this.$$.ctx[1]}}]),n}();function D1(e){bo(e,"svelte-sxaskb",':root{--jse-theme:light;--jse-font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu,\n    Cantarell, "Helvetica Neue", sans-serif;--jse-font-family-mono:consolas, menlo, monaco, "Ubuntu Mono", "source-code-pro", monospace;--jse-font-size-mono:14px;--jse-font-size:16px;--jse-font-size-text-mode-search:80%;--jse-line-height:calc(1em + 4px);--jse-indent-size:calc(1em + 4px);--jse-color-picker-button-size:1em;--jse-padding:10px;--jse-theme-color:#3883fa;--jse-theme-color-highlight:#5f9dff;--jse-background-color:#fff;--jse-text-color:#4d4d4d;--jse-text-readonly:#8d8d8d;--jse-text-color-inverse:#fff;--jse-error-color:#ee5341;--jse-warning-color:#fdc539;--jse-main-border:1px solid #d7d7d7;--jse-menu-color:var(--jse-text-color-inverse);--jse-menu-button-size:32px;--jse-modal-background:#f5f5f5;--jse-modal-overlay-background:rgba(0, 0, 0, 0.3);--jse-modal-code-background:rgba(0, 0, 0, 0.05);--jse-modal-theme-color:#707070;--jse-modal-theme-color-highlight:#646464;--jse-tooltip-color:var(--jse-text-color);--jse-tooltip-background:var(--jse-modal-background);--jse-tooltip-border:var(--jse-main-border);--jse-tooltip-action-button-color:var(--jse-text-color-inverse);--jse-tooltip-action-button-background:#4d4d4d;--jse-panel-background:#ebebeb;--jse-panel-color:var(--jse-text-color);--jse-panel-color-readonly:#b2b2b2;--jse-panel-border:var(--jse-main-border);--jse-panel-button-color:inherit;--jse-panel-button-background:transparent;--jse-panel-button-color-highlight:var(--jse-text-color);--jse-panel-button-background-highlight:#e0e0e0;--jse-navigation-bar-background:var(--jse-background-color);--jse-navigation-bar-background-highlight:#e5e5e5;--jse-navigation-bar-dropdown-color:#656565;--jse-context-menu-background:#656565;--jse-context-menu-background-highlight:#7a7a7a;--jse-context-menu-color:var(--jse-text-color-inverse);--jse-context-menu-color-disabled:#9d9d9d;--jse-context-menu-separator-color:#7a7a7a;--jse-context-menu-pointer-hover-background:#b2b2b2;--jse-context-menu-pointer-background:var(--jse-context-menu-background);--jse-context-menu-pointer-background-highlight:var(--jse-context-menu-background-highlight);--jse-context-menu-pointer-color:var(--jse-context-menu-color);--jse-context-menu-pointer-size:calc(1em + 4px);--jse-context-menu-tip-background:rgba(255, 255, 255, 0.2);--jse-context-menu-tip-color:inherit;--jse-key-color:#1a1a1a;--jse-value-color:#1a1a1a;--jse-value-color-number:#ee422e;--jse-value-color-boolean:#ff8c00;--jse-value-color-null:#004ed0;--jse-value-color-string:#008000;--jse-value-color-url:#008000;--jse-delimiter-color:rgba(0, 0, 0, 0.38);--jse-edit-outline:2px solid #656565;--jse-contents-background-color:transparent;--jse-contents-cursor:pointer;--jse-contents-selected-cursor:grab;--jse-selection-background-color:#d3d3d3;--jse-selection-background-inactive-color:#e8e8e8;--jse-hover-background-color:rgba(0, 0, 0, 0.06);--jse-active-line-background-color:rgba(0, 0, 0, 0.06);--jse-search-match-background-color:#99ff7780;--jse-collapsed-items-background-color:#f5f5f5;--jse-collapsed-items-selected-background-color:#c2c2c2;--jse-collapsed-items-link-color:rgba(0, 0, 0, 0.38);--jse-collapsed-items-link-color-highlight:#ee5341;--jse-search-match-color:#ffe665;--jse-search-match-outline:1px solid #ffd700;--jse-search-match-active-color:#ffd700;--jse-search-match-active-outline:1px solid #e1be00;--jse-tag-background:rgba(0, 0, 0, 0.2);--jse-tag-color:var(--jse-text-color-inverse);--jse-table-header-background:#f5f5f5;--jse-table-header-background-highlight:#e8e8e8;--jse-table-row-odd-background:rgba(0, 0, 0, 0.05);--jse-controls-box-shadow:0 2px 6px 0 rgba(0, 0, 0, 0.24);--jse-input-background:var(--jse-background-color);--jse-input-background-readonly:transparent;--jse-input-border:1px solid #d8dbdf;--jse-input-border-focus:1px solid var(--jse-theme-color);--jse-input-radius:3px;--jse-button-background:#e0e0e0;--jse-button-background-highlight:#e7e7e7;--jse-button-color:var(--jse-text-color);--jse-button-primary-background:var(--jse-theme-color);--jse-button-primary-background-highlight:var(--jse-theme-color-highlight);--jse-button-primary-background-disabled:#9d9d9d;--jse-button-primary-color:var(--jse-text-color-inverse);--jse-button-secondary-background:#d3d3d3;--jse-button-secondary-background-highlight:#e1e1e1;--jse-button-secondary-background-disabled:#9d9d9d;--jse-button-secondary-color:var(--jse-text-color);--jse-a-color:#156fc5;--jse-a-color-highlight:#0f508d;--jse-message-error-background:var(--jse-error-color);--jse-message-error-color:var(--jse-text-color-inverse);--jse-message-warning-background:#ffde5c;--jse-message-warning-color:var(--jse-text-color);--jse-message-success-background:#9ac45d;--jse-message-success-color:var(--jse-text-color-inverse);--jse-message-info-background:#4f91ff;--jse-message-info-color:var(--jse-text-color-inverse);--jse-message-action-background:rgba(255, 255, 255, 0.2);--jse-message-action-background-highlight:rgba(255, 255, 255, 0.3);--item-is-active-bg:#3883fa;--border:1px solid #d8dbdf;--border-radius:3px;--background:#fff;--padding:0 10px;--multi-select-padding:0 10px;--jse-color-picker-background:var(--jse-panel-background);--jse-color-picker-border-box-shadow:#cbcbcb 0 0 0 1px}.jse-main.svelte-sxaskb{width:100%;height:100%;min-width:0;min-height:150px;font-family:var(--jse-font-family);font-size:var(--jse-font-size);line-height:normal;position:relative;display:flex;flex-direction:row}');}function L1(e){var t,n,r={mode:e[1],content:e[0],readOnly:e[2],indentation:e[3],tabSize:e[4],statusBar:e[7],askToFormat:e[8],mainMenuBar:e[5],navigationBar:e[6],escapeControlCharacters:e[9],escapeUnicodeCharacters:e[10],flattenColumns:e[11],parser:e[12],parseMemoizeOne:e[25],validator:e[13],validationParser:e[14],pathParser:e[15],insideModal:!1,onError:e[19],onChange:e[26],onChangeMode:e[29],onRenderValue:e[16],onClassName:e[17],onFocus:e[27],onBlur:e[28],onRenderMenu:e[18],onSortModal:e[31],onTransformModal:e[30],onJSONEditorModal:e[32]};return t=new C1({props:r}),e[57](t),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};2&n[0]&&(r.mode=e[1]),1&n[0]&&(r.content=e[0]),4&n[0]&&(r.readOnly=e[2]),8&n[0]&&(r.indentation=e[3]),16&n[0]&&(r.tabSize=e[4]),128&n[0]&&(r.statusBar=e[7]),256&n[0]&&(r.askToFormat=e[8]),32&n[0]&&(r.mainMenuBar=e[5]),64&n[0]&&(r.navigationBar=e[6]),512&n[0]&&(r.escapeControlCharacters=e[9]),1024&n[0]&&(r.escapeUnicodeCharacters=e[10]),2048&n[0]&&(r.flattenColumns=e[11]),4096&n[0]&&(r.parser=e[12]),33554432&n[0]&&(r.parseMemoizeOne=e[25]),8192&n[0]&&(r.validator=e[13]),16384&n[0]&&(r.validationParser=e[14]),32768&n[0]&&(r.pathParser=e[15]),524288&n[0]&&(r.onError=e[19]),65536&n[0]&&(r.onRenderValue=e[16]),131072&n[0]&&(r.onClassName=e[17]),262144&n[0]&&(r.onRenderMenu=e[18]),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(n){e[57](null),Ba(t,n);}}}function B1(e){var t,n,r,i,o,a=e[20];function s(t){e[56](t);}var c={};void 0!==e[23]&&(c.open=e[23]),t=new I1({props:c}),sa.push((function(){return Ia(t,"open",s)}));var u=L1(e);return {c:function(){Da(t.$$.fragment),r=Mo(),i=$o("div"),u.c(),Ro(i,"class","jse-main svelte-sxaskb"),Fo(i,"jse-focus",e[21]);},m:function(e,n){La(t,e,n),jo(e,r,n),jo(e,i,n),u.m(i,null),o=!0;},p:function(e,r){var s={};!n&&8388608&r[0]&&(n=!0,s.open=e[23],pa((function(){return n=!1}))),t.$set(s),1048576&r[0]&&no(a,a=e[20])?(Sa(),_a(u,1,1,Ki),Ca(),(u=L1(e)).c(),$a(u,1),u.m(i,null)):u.p(e,r),(!o||2097152&r[0])&&Fo(i,"jse-focus",e[21]);},i:function(e){o||($a(t.$$.fragment,e),$a(u),o=!0);},o:function(e){_a(t.$$.fragment,e),_a(u),o=!1;},d:function(e){Ba(t,e),e&&So(r),e&&So(i),u.d(e);}}}function z1(e){var t,n;return t=new hs({props:{closeOnEsc:!1,$$slots:{default:[B1]},$$scope:{ctx:e}}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};50331647&n[0]|536870912&n[1]&&(r.$$scope={dirty:n,ctx:e}),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function q1(e){for(var t,n,r,i=[{show:null===(t=e[24])||void 0===t?void 0:t.component},gs,{closeOnEsc:!1}],o={$$slots:{default:[z1]},$$scope:{ctx:e}},a=0;a<i.length;a+=1)o=Qi(o,i[a]);return (n=new hs({props:o})).$on("close",e[33]),{c:function(){Da(n.$$.fragment);},m:function(e,t){La(n,e,t),r=!0;},p:function(e,t){var r,o=16777216&t[0]?Ra(i,[16777216&t[0]&&{show:null===(r=e[24])||void 0===r?void 0:r.component},0&t&&Na(gs),i[2]]):{};50331647&t[0]|536870912&t[1]&&(o.$$scope={dirty:t,ctx:e}),n.$set(o);},i:function(e){r||($a(n.$$.fragment,e),r=!0);},o:function(e){_a(n.$$.fragment,e),r=!1;},d:function(e){Ba(n,e);}}}function F1(e){var t,n;return t=new qC({props:{$$slots:{default:[q1]},$$scope:{ctx:e}}}),{c:function(){Da(t.$$.fragment);},m:function(e,r){La(t,e,r),n=!0;},p:function(e,n){var r={};67108863&n[0]|536870912&n[1]&&(r.$$scope={dirty:n,ctx:e}),t.$set(r);},i:function(e){n||($a(t.$$.fragment,e),n=!0);},o:function(e){_a(t.$$.fragment,e),n=!1;},d:function(e){Ba(t,e);}}}function V1(e,t,n){var r,i,o,a=Ha("jsoneditor:JSONEditor"),s=t.content,c=void 0===s?{text:""}:s,u=t.readOnly,l=void 0!==u&&u,f=t.indentation,h=void 0===f?2:f,d=t.tabSize,v=void 0===d?4:d,p=t.mode,m=void 0===p?as.tree:p,g=t.mainMenuBar,y=void 0===g||g,b=t.navigationBar,w=void 0===b||b,x=t.statusBar,k=void 0===x||x,j=t.askToFormat,S=void 0===j||j,C=t.escapeControlCharacters,$=void 0!==C&&C,_=t.escapeUnicodeCharacters,O=void 0!==_&&_,M=t.flattenColumns,E=void 0===M||M,A=t.parser,P=void 0===A?JSON:A,T=t.validator,R=void 0===T?null:T,N=t.validationParser,I=void 0===N?JSON:N,D=t.pathParser,L=void 0===D?{parse:VC,stringify:FC}:D,B=t.queryLanguages,z=void 0===B?[XC]:B,q=t.queryLanguageId,F=void 0===q?z[0].id:q,V=t.onChangeQueryLanguage,W=void 0===V?_L:V,H=t.onChange,U=void 0===H?null:H,J=t.onRenderValue,K=void 0===J?HO:J,G=t.onClassName,Q=void 0===G?function(){}:G,Y=t.onRenderMenu,X=void 0===Y?_L:Y,Z=t.onChangeMode,ee=void 0===Z?_L:Z,te=t.onError,ne=void 0===te?function(e){console.error(e),alert(e.toString());}:te,re=t.onFocus,ie=void 0===re?_L:re,oe=t.onBlur,ae=void 0===oe?_L:oe,se=Cs(),ce=!1,ue=null,le=P;function fe(){return (fe=ji(xi().mark((function e(t){var r;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a("set"),!(r=qS(t))){e.next=4;break}throw new Error(r);case 4:return n(20,se=Cs()),n(0,c=t),e.next=8,da();case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(){return (he=ji(xi().mark((function e(t){var r;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a("update"),!(r=qS(t))){e.next=4;break}throw new Error(r);case 4:return n(0,c=t),e.next=7,da();case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(){return de=ji(xi().mark((function e(t){var r;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!VS(c)){e.next=8;break}e.prev=1,n(0,c={json:P.parse(c.text),text:void 0}),e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(1),new Error("Cannot apply patch: current document contains invalid JSON");case 8:return r=i.patch(t),e.next=11,da();case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}}),e,null,[[1,5]])}))),de.apply(this,arguments)}function ve(){return (ve=ji(xi().mark((function e(t){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.expand(t),e.next=3,da();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(){return pe=ji(xi().mark((function e(){var t;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.acceptAutoRepair(),e.next=3,da();case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)}))),pe.apply(this,arguments)}function me(){return (me=ji(xi().mark((function e(t){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.scrollTo(t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ge(){return ye.apply(this,arguments)}function ye(){return (ye=ji(xi().mark((function e(){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.focus(),e.next=3,da();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(){return (be=ji(xi().mark((function e(){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.refresh();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function we(){return (we=ji(xi().mark((function e(t){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.$set(t),e.next=3,da();case 3:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function xe(){return (xe=ji(xi().mark((function e(){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.$destroy(),e.next=3,da();case 3:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function ke(){return (ke=ji(xi().mark((function e(t){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m!==t){e.next=2;break}return e.abrupt("return");case 2:return n(1,m=t),e.next=5,da();case 5:ge(),ee(t);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function je(e){a("handleChangeQueryLanguage",e),n(34,F=e),W(e);}function Se(e){var t=e.id,n=e.json,i=e.rootPath,a=e.onTransform,s=e.onClose;l||o(yL,{id:t,json:n,rootPath:i,indentation:h,escapeControlCharacters:$,escapeUnicodeCharacters:O,parser:P,parseMemoizeOne:r,validationParser:I,pathParser:L,queryLanguages:z,queryLanguageId:F,onChangeQueryLanguage:je,onRenderValue:K,onClassName:Q,onTransform:a},ms,{onClose:s});}function Ce(e){var t=e.id,n=e.json,r=e.rootPath,i=e.onSort,a=e.onClose;l||o($L,{id:t,json:n,rootPath:r,onSort:i},ps,{onClose:a});}return e.$$set=function(e){"content"in e&&n(0,c=e.content),"readOnly"in e&&n(2,l=e.readOnly),"indentation"in e&&n(3,h=e.indentation),"tabSize"in e&&n(4,v=e.tabSize),"mode"in e&&n(1,m=e.mode),"mainMenuBar"in e&&n(5,y=e.mainMenuBar),"navigationBar"in e&&n(6,w=e.navigationBar),"statusBar"in e&&n(7,k=e.statusBar),"askToFormat"in e&&n(8,S=e.askToFormat),"escapeControlCharacters"in e&&n(9,$=e.escapeControlCharacters),"escapeUnicodeCharacters"in e&&n(10,O=e.escapeUnicodeCharacters),"flattenColumns"in e&&n(11,E=e.flattenColumns),"parser"in e&&n(12,P=e.parser),"validator"in e&&n(13,R=e.validator),"validationParser"in e&&n(14,I=e.validationParser),"pathParser"in e&&n(15,L=e.pathParser),"queryLanguages"in e&&n(35,z=e.queryLanguages),"queryLanguageId"in e&&n(34,F=e.queryLanguageId),"onChangeQueryLanguage"in e&&n(36,W=e.onChangeQueryLanguage),"onChange"in e&&n(37,U=e.onChange),"onRenderValue"in e&&n(16,K=e.onRenderValue),"onClassName"in e&&n(17,Q=e.onClassName),"onRenderMenu"in e&&n(18,X=e.onRenderMenu),"onChangeMode"in e&&n(38,ee=e.onChangeMode),"onError"in e&&n(19,ne=e.onError),"onFocus"in e&&n(39,ie=e.onFocus),"onBlur"in e&&n(40,ae=e.onBlur);},e.$$.update=function(){if(4097&e.$$.dirty[0]|16777216&e.$$.dirty[1]&&(ZS(P,le)||(a("parser changed, recreate editor"),WS(c)&&n(0,c={json:P.parse(le.stringify(c.json))}),n(55,le=P),n(20,se=Cs()))),1&e.$$.dirty[0]){var t=qS(c);t&&console.error("Error: "+t);}4096&e.$$.dirty[0]&&n(25,r=dD(P.parse)),2&e.$$.dirty[0]&&(a("mode changed to",m),"code"===m&&console.warn('Deprecation warning: "code" mode is renamed to "text". Please use mode="text" instead.'));},[c,m,l,h,v,y,w,k,S,$,O,E,P,R,I,L,K,Q,X,ne,se,ce,i,o,ue,r,function(e,t,r){n(0,c=e),U&&U(e,t,r);},function(){n(21,ce=!0),ie&&ie();},function(){n(21,ce=!1),ae&&ae();},function(e){return ke.apply(this,arguments)},Se,Ce,function(e){var t=e.content,r=e.path,i=e.onPatch,o=e.onClose;a("onJSONEditorModal",{content:t,path:r}),n(24,ue={component:is(R1,{content:t,path:r,onPatch:i,readOnly:l,indentation:h,tabSize:v,mainMenuBar:y,navigationBar:w,statusBar:k,askToFormat:S,escapeControlCharacters:$,escapeUnicodeCharacters:O,flattenColumns:E,parser:P,validator:void 0,validationParser:I,pathParser:L,onRenderValue:K,onClassName:Q,onRenderMenu:X,onSortModal:Ce,onTransformModal:Se}),callbacks:{onClose:o}});},function(){var e,t,r;null===(e=ue)||void 0===e||null===(t=e.callbacks)||void 0===t||null===(r=t.onClose)||void 0===r||r.call(t),n(24,ue=null);},F,z,W,U,ee,ie,ae,function(){return c},function(e){return fe.apply(this,arguments)},function(e){return he.apply(this,arguments)},function(e){return de.apply(this,arguments)},function(e){return ve.apply(this,arguments)},function(e){i.transform(e);},function(){return i.validate()},function(){return pe.apply(this,arguments)},function(e){return me.apply(this,arguments)},function(e){return i.findElement(e)},ge,function(){return be.apply(this,arguments)},function(e){return we.apply(this,arguments)},function(){return xe.apply(this,arguments)},le,function(e){n(23,o=e);},function(e){sa[e?"unshift":"push"]((function(){n(22,i=e);}));}]}var W1=function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,V1,F1,no,{content:0,readOnly:2,indentation:3,tabSize:4,mode:1,mainMenuBar:5,navigationBar:6,statusBar:7,askToFormat:8,escapeControlCharacters:9,escapeUnicodeCharacters:10,flattenColumns:11,parser:12,validator:13,validationParser:14,pathParser:15,queryLanguages:35,queryLanguageId:34,onChangeQueryLanguage:36,onChange:37,onRenderValue:16,onClassName:17,onRenderMenu:18,onChangeMode:38,onError:19,onFocus:39,onBlur:40,get:41,set:42,update:43,patch:44,expand:45,transform:46,validate:47,acceptAutoRepair:48,scrollTo:49,findElement:50,focus:51,refresh:52,updateProps:53,destroy:54},D1,[-1,-1]),r}return qi(n,[{key:"get",get:function(){return this.$$.ctx[41]}},{key:"set",get:function(){return this.$$.ctx[42]}},{key:"update",get:function(){return this.$$.ctx[43]}},{key:"patch",get:function(){return this.$$.ctx[44]}},{key:"expand",get:function(){return this.$$.ctx[45]}},{key:"transform",get:function(){return this.$$.ctx[46]}},{key:"validate",get:function(){return this.$$.ctx[47]}},{key:"acceptAutoRepair",get:function(){return this.$$.ctx[48]}},{key:"scrollTo",get:function(){return this.$$.ctx[49]}},{key:"findElement",get:function(){return this.$$.ctx[50]}},{key:"focus",get:function(){return this.$$.ctx[51]}},{key:"refresh",get:function(){return this.$$.ctx[52]}},{key:"updateProps",get:function(){return this.$$.ctx[53]}},{key:"destroy",get:function(){return this.$$.ctx[54]}}]),n}();function H1(e){bo(e,"svelte-rc6e9m",".jse-value.jse-string.svelte-rc6e9m{color:var(--jse-value-color-string)}.jse-value.jse-object.svelte-rc6e9m,.jse-value.jse-array.svelte-rc6e9m{min-width:16px;color:var(--jse-delimiter-color)}.jse-value.jse-number.svelte-rc6e9m{color:var(--jse-value-color-number)}.jse-value.jse-boolean.svelte-rc6e9m{color:var(--jse-value-color-boolean)}.jse-value.jse-null.svelte-rc6e9m{color:var(--jse-value-color-null)}.jse-value.jse-invalid.svelte-rc6e9m{color:var(--jse-text-color)}.jse-value.jse-url.svelte-rc6e9m{color:var(--jse-value-color-url);text-decoration:underline}.jse-enum-value.svelte-rc6e9m{background:var(--jse-hover-background-color);border:none;padding:0;font-family:inherit;font-size:inherit;cursor:pointer;outline:none}.jse-enum-value.jse-selected.svelte-rc6e9m{background:var(--jse-selection-background-color);color:inherit}.jse-enum-value.jse-value.svelte-rc6e9m:focus{color:var(--jse-text-color)}.jse-json-node.jse-selected .jse-enum-value.svelte-rc6e9m{background:transparent}");}function U1(e,t,n){var r=e.slice();return r[13]=t[n],r}function J1(e){var t,n,r,i=e[13].text+"";return {c:function(){t=$o("option"),n=Oo(i),t.__value=r=e[13].value,t.value=t.__value;},m:function(e,r){jo(e,t,r),yo(t,n);},p:function(e,o){4&o&&i!==(i=e[13].text+"")&&Lo(n,i),4&o&&r!==(r=e[13].value)&&(t.__value=r,t.value=t.__value);},d:function(e){e&&So(t);}}}function K1(e){for(var t,n,r,i,o=e[2],a=[],s=0;s<o.length;s+=1)a[s]=J1(U1(e,o,s));return {c:function(){t=$o("select");for(var r=0;r<a.length;r+=1)a[r].c();Ro(t,"class",n=lo("jse-enum-value ".concat(U_(e[4],e[0])))+" svelte-rc6e9m"),void 0===e[4]&&va((function(){return e[10].call(t)})),Fo(t,"jse-selected",p_(e[1]));},m:function(n,o){jo(n,t,o);for(var s=0;s<a.length;s+=1)a[s]&&a[s].m(t,null);qo(t,e[4],!0),e[11](t),r||(i=[Ao(t,"change",e[10]),Ao(t,"change",e[5]),Ao(t,"mousedown",G1)],r=!0);},p:function(e,r){var i=Si(r,1)[0];if(4&i){var s;for(o=e[2],s=0;s<o.length;s+=1){var c=U1(e,o,s);a[s]?a[s].p(c,i):(a[s]=J1(c),a[s].c(),a[s].m(t,null));}for(;s<a.length;s+=1)a[s].d(1);a.length=o.length;}17&i&&n!==(n=lo("jse-enum-value ".concat(U_(e[4],e[0])))+" svelte-rc6e9m")&&Ro(t,"class",n),16&i&&qo(t,e[4]),19&i&&Fo(t,"jse-selected",p_(e[1]));},i:Ki,o:Ki,d:function(n){n&&So(t),Co(a,n),e[11](null),r=!1,Zi(i);}}}function G1(e){e.stopPropagation();}function Q1(e,t,n){var r,i=t.path,o=t.value,a=t.parser,s=t.readOnly,c=t.selection,u=t.onPatch,l=t.options,f=o;return e.$$set=function(e){"path"in e&&n(6,i=e.path),"value"in e&&n(7,o=e.value),"parser"in e&&n(0,a=e.parser),"readOnly"in e&&n(8,s=e.readOnly),"selection"in e&&n(1,c=e.selection),"onPatch"in e&&n(9,u=e.onPatch),"options"in e&&n(2,l=e.options);},e.$$.update=function(){128&e.$$.dirty&&n(4,f=o),2&e.$$.dirty&&function(e){e&&r&&r.focus();}(c);},[a,c,l,r,f,function(e){e.stopPropagation(),s||u([{op:"replace",path:Ys(i),value:f}]);},i,o,s,u,function(){var e;e=this.querySelector(":checked"),f=e&&e.__value,n(4,f),n(7,o);},function(e){sa[e?"unshift":"push"]((function(){n(3,r=e),n(2,l);}));}]}(function(e){Pi(n,Fa);var t=Ri(n);function n(e){var r;return Bi(this,n),qa(Ii(r=t.call(this)),e,Q1,K1,no,{path:6,value:7,parser:0,readOnly:8,selection:1,onPatch:9,options:2},H1),r}return qi(n)})();var t2,n2={exports:{}},r2={},i2={},o2={},a2={},s2={},c2={};function u2(){return t2||(t2=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;var r=qi((function e(){Bi(this,e);}));e._CodeOrName=r,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var i=function(t){Pi(r,t);var n=Ri(r);function r(t){var i;if(Bi(this,r),i=n.call(this),!e.IDENTIFIER.test(t))throw new Error("CodeGen: name must be a valid identifier");return i.str=t,i}return qi(r,[{key:"toString",value:function(){return this.str}},{key:"emptyStr",value:function(){return !1}},{key:"names",get:function(){return Mi({},this.str,1)}}]),r}(r);e.Name=i;var o=function(e){Pi(n,e);var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this))._items="string"==typeof e?[e]:e,r}return qi(n,[{key:"toString",value:function(){return this.str}},{key:"emptyStr",value:function(){if(this._items.length>1)return !1;var e=this._items[0];return ""===e||'""'===e}},{key:"str",get:function(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce((function(e,t){return "".concat(e).concat(t)}),"")}},{key:"names",get:function(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce((function(e,t){return t instanceof i&&(e[t.str]=(e[t.str]||0)+1),e}),{})}}]),n}(r);function a(e){for(var t=[e[0]],n=0,r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];for(;n<i.length;)u(t,i[n]),t.push(e[++n]);return new o(t)}e._Code=o,e.nil=new o(""),e._=a;var s=new o("+");function c(e){for(var t=[h(e[0])],n=0,r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];for(;n<i.length;)t.push(s),u(t,i[n]),t.push(s,h(e[++n]));return l(t),new o(t)}function u(e,t){t instanceof o?e.push.apply(e,Vi(t._items)):t instanceof i?e.push(t):e.push(function(e){return "number"==typeof e||"boolean"==typeof e||null===e?e:h(Array.isArray(e)?e.join(","):e)}(t));}function l(e){for(var t=1;t<e.length-1;){if(e[t]===s){var n=f(e[t-1],e[t+1]);if(void 0!==n){e.splice(t-1,3,n);continue}e[t++]="+";}t++;}}function f(e,t){if('""'===t)return e;if('""'===e)return t;if("string"==typeof e){if(t instanceof i||'"'!==e[e.length-1])return;return "string"!=typeof t?"".concat(e.slice(0,-1)).concat(t,'"'):'"'===t[0]?e.slice(0,-1)+t.slice(1):void 0}return "string"!=typeof t||'"'!==t[0]||e instanceof i?void 0:'"'.concat(e).concat(t.slice(1))}function h(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.str=c,e.addCodeArg=u,e.strConcat=function(e,n){return n.emptyStr()?e:e.emptyStr()?n:c(t||(t=yi(["","",""])),e,n)},e.stringify=function(e){return new o(h(e))},e.safeStringify=h,e.getProperty=function(t){return "string"==typeof t&&e.IDENTIFIER.test(t)?new o(".".concat(t)):a(n||(n=yi(["[","]"])),t)},e.getEsmExportName=function(t){if("string"==typeof t&&e.IDENTIFIER.test(t))return new o("".concat(t));throw new Error("CodeGen: invalid export name: ".concat(t,", use explicit $id name mapping"))},e.regexpCode=function(e){return new o(e.toString())};}(c2)),c2}var l2,f2,h2={};function d2(){return l2||(l2=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;var t,n=u2(),c=function(e){Pi(n,mi(Error));var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this,'CodeGen: "code" for '.concat(e," not defined"))).value=e.value,r}return qi(n)}();!function(e){e[e.Started=0]="Started",e[e.Completed=1]="Completed";}(t=e.UsedValueState||(e.UsedValueState={})),e.varKinds={const:new n.Name("const"),let:new n.Name("let"),var:new n.Name("var")};var u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.prefixes,r=t.parent;Bi(this,e),this._names={},this._prefixes=n,this._parent=r;}return qi(e,[{key:"toName",value:function(e){return e instanceof n.Name?e:this.name(e)}},{key:"name",value:function(e){return new n.Name(this._newName(e))}},{key:"_newName",value:function(e){var t=this._names[e]||this._nameGroup(e);return "".concat(e).concat(t.index++)}},{key:"_nameGroup",value:function(e){var t,n;if((null===(n=null===(t=this._parent)||void 0===t?void 0:t._prefixes)||void 0===n?void 0:n.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error('CodeGen: prefix "'.concat(e,'" is not allowed in this scope'));return this._names[e]={prefix:e,index:0}}}]),e}();e.Scope=u;var l=function(e){Pi(i,e);var t=Ri(i);function i(e,n){var r;return Bi(this,i),(r=t.call(this,n)).prefix=e,r}return qi(i,[{key:"setValue",value:function(e,t){var i=t.property,o=t.itemIndex;this.value=e,this.scopePath=(0, n._)(r$1||(r$1=yi([".","[","]"])),new n.Name(i),o);}}]),i}(n.Name);e.ValueScopeName=l;var f=(0, n._)(i||(i=yi(["\n"],["\\n"]))),h=function(r){Pi(u,r);var i=Ri(u);function u(e){var t;return Bi(this,u),(t=i.call(this,e))._values={},t._scope=e.scope,t.opts=Oi(Oi({},e),{},{_n:e.lines?f:n.nil}),t}return qi(u,[{key:"get",value:function(){return this._scope}},{key:"name",value:function(e){return new l(e,this._newName(e))}},{key:"value",value:function(e,t){var n;if(void 0===t.ref)throw new Error("CodeGen: ref must be passed in value");var r=this.toName(e),i=r.prefix,o=null!==(n=t.key)&&void 0!==n?n:t.ref,a=this._values[i];if(a){var s=a.get(o);if(s)return s}else a=this._values[i]=new Map;a.set(o,r);var c=this._scope[i]||(this._scope[i]=[]),u=c.length;return c[u]=t.ref,r.setValue(t,{property:i,itemIndex:u}),r}},{key:"getValue",value:function(e,t){var n=this._values[e];if(n)return n.get(t)}},{key:"scopeRefs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._values;return this._reduceValues(t,(function(t){if(void 0===t.scopePath)throw new Error('CodeGen: name "'.concat(t,'" has no value'));return (0, n._)(o||(o=yi(["","",""])),e,t.scopePath)}))}},{key:"scopeCode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._values,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this._reduceValues(e,(function(e){if(void 0===e.value)throw new Error('CodeGen: name "'.concat(e,'" has no value'));return e.value.code}),t,n)}},{key:"_reduceValues",value:function(r,i){var o=this,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=arguments.length>3?arguments[3]:void 0,f=n.nil,h=function(){var h=r[d];if(!h)return "continue";var v=u[d]=u[d]||new Map;h.forEach((function(r){if(!v.has(r)){v.set(r,t.Started);var u=i(r);if(u){var h=o.opts.es5?e.varKinds.var:e.varKinds.const;f=(0, n._)(a||(a=yi(["",""," "," = ",";",""])),f,h,r,u,o.opts._n);}else {if(!(u=null==l?void 0:l(r)))throw new c(r);f=(0, n._)(s||(s=yi(["","","",""])),f,u,o.opts._n);}v.set(r,t.Completed);}}));};for(var d in r)h();return f}}]),u}(u);e.ValueScope=h;}(h2)),h2}function v2(){return f2||(f2=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;var t=u2(),n=d2(),r=u2();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return r.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return r.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return r.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}});var i=d2();Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return i.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return i.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return i.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return i.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};var o=function(){function e(){Bi(this,e);}return qi(e,[{key:"optimizeNodes",value:function(){return this}},{key:"optimizeNames",value:function(e,t){return this}}]),e}(),a=function(e){Pi(i,e);var r=Ri(i);function i(e,t,n){var o;return Bi(this,i),(o=r.call(this)).varKind=e,o.name=t,o.rhs=n,o}return qi(i,[{key:"render",value:function(e){var t=e.es5,r=e._n,i=t?n.varKinds.var:this.varKind,o=void 0===this.rhs?"":" = ".concat(this.rhs);return "".concat(i," ").concat(this.name).concat(o,";")+r}},{key:"optimizeNames",value:function(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=I(this.rhs,e,t)),this}},{key:"names",get:function(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}]),i}(o),s=function(e){Pi(r,e);var n=Ri(r);function r(e,t,i){var o;return Bi(this,r),(o=n.call(this)).lhs=e,o.rhs=t,o.sideEffects=i,o}return qi(r,[{key:"render",value:function(e){var t=e._n;return "".concat(this.lhs," = ").concat(this.rhs,";")+t}},{key:"optimizeNames",value:function(e,n){if(!(this.lhs instanceof t.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=I(this.rhs,e,n),this}},{key:"names",get:function(){return N(this.lhs instanceof t.Name?{}:Oi({},this.lhs.names),this.rhs)}}]),r}(o),v=function(e){Pi(n,e);var t=Ri(n);function n(e,r,i,o){var a;return Bi(this,n),(a=t.call(this,e,i,o)).op=r,a}return qi(n,[{key:"render",value:function(e){var t=e._n;return "".concat(this.lhs," ").concat(this.op,"= ").concat(this.rhs,";")+t}}]),n}(s),p=function(e){Pi(n,e);var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this)).label=e,r.names={},r}return qi(n,[{key:"render",value:function(e){var t=e._n;return "".concat(this.label,":")+t}}]),n}(o),m=function(e){Pi(n,e);var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this)).label=e,r.names={},r}return qi(n,[{key:"render",value:function(e){var t=e._n,n=this.label?" ".concat(this.label):"";return "break".concat(n,";")+t}}]),n}(o),g=function(e){Pi(n,e);var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this)).error=e,r}return qi(n,[{key:"render",value:function(e){var t=e._n;return "throw ".concat(this.error,";")+t}},{key:"names",get:function(){return this.error.names}}]),n}(o),y=function(e){Pi(r,e);var n=Ri(r);function r(e){var t;return Bi(this,r),(t=n.call(this)).code=e,t}return qi(r,[{key:"render",value:function(e){var t=e._n;return "".concat(this.code,";")+t}},{key:"optimizeNodes",value:function(){return "".concat(this.code)?this:void 0}},{key:"optimizeNames",value:function(e,t){return this.code=I(this.code,e,t),this}},{key:"names",get:function(){return this.code instanceof t._CodeOrName?this.code.names:{}}}]),r}(o),b=function(e){Pi(n,e);var t=Ri(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Bi(this,n),(e=t.call(this)).nodes=r,e}return qi(n,[{key:"render",value:function(e){return this.nodes.reduce((function(t,n){return t+n.render(e)}),"")}},{key:"optimizeNodes",value:function(){for(var e=this.nodes,t=e.length;t--;){var n=e[t].optimizeNodes();Array.isArray(n)?e.splice.apply(e,[t,1].concat(Vi(n))):n?e[t]=n:e.splice(t,1);}return e.length>0?this:void 0}},{key:"optimizeNames",value:function(e,t){for(var n=this.nodes,r=n.length;r--;){var i=n[r];i.optimizeNames(e,t)||(D(e,i.names),n.splice(r,1));}return n.length>0?this:void 0}},{key:"names",get:function(){return this.nodes.reduce((function(e,t){return R(e,t.names)}),{})}}]),n}(o),w=function(e){Pi(n,e);var t=Ri(n);function n(){return Bi(this,n),t.apply(this,arguments)}return qi(n,[{key:"render",value:function(e){return "{"+e._n+Ei(Li(n.prototype),"render",this).call(this,e)+"}"+e._n}}]),n}(b),x=function(e){Pi(n,e);var t=Ri(n);function n(){return Bi(this,n),t.apply(this,arguments)}return qi(n)}(b),k=function(e){Pi(n,e);var t=Ri(n);function n(){return Bi(this,n),t.apply(this,arguments)}return qi(n)}(w);k.kind="else";var j=function(e){Pi(n,e);var t=Ri(n);function n(e,r){var i;return Bi(this,n),(i=t.call(this,r)).condition=e,i}return qi(n,[{key:"render",value:function(e){var t="if(".concat(this.condition,")")+Ei(Li(n.prototype),"render",this).call(this,e);return this.else&&(t+="else "+this.else.render(e)),t}},{key:"optimizeNodes",value:function(){Ei(Li(n.prototype),"optimizeNodes",this).call(this);var e=this.condition;if(!0===e)return this.nodes;var t=this.else;if(t){var r=t.optimizeNodes();t=this.else=Array.isArray(r)?new k(r):r;}return t?!1===e?t instanceof n?t:t.nodes:this.nodes.length?this:new n(L(e),t instanceof n?[t]:t.nodes):!1!==e&&this.nodes.length?this:void 0}},{key:"optimizeNames",value:function(e,t){var r;if(this.else=null===(r=this.else)||void 0===r?void 0:r.optimizeNames(e,t),Ei(Li(n.prototype),"optimizeNames",this).call(this,e,t)||this.else)return this.condition=I(this.condition,e,t),this}},{key:"names",get:function(){var e=Ei(Li(n.prototype),"names",this);return N(e,this.condition),this.else&&R(e,this.else.names),e}}]),n}(w);j.kind="if";var S=function(e){Pi(n,e);var t=Ri(n);function n(){return Bi(this,n),t.apply(this,arguments)}return qi(n)}(w);S.kind="for";var C=function(e){Pi(n,e);var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this)).iteration=e,r}return qi(n,[{key:"render",value:function(e){return "for(".concat(this.iteration,")")+Ei(Li(n.prototype),"render",this).call(this,e)}},{key:"optimizeNames",value:function(e,t){if(Ei(Li(n.prototype),"optimizeNames",this).call(this,e,t))return this.iteration=I(this.iteration,e,t),this}},{key:"names",get:function(){return R(Ei(Li(n.prototype),"names",this),this.iteration.names)}}]),n}(S),$=function(e){Pi(r,e);var t=Ri(r);function r(e,n,i,o){var a;return Bi(this,r),(a=t.call(this)).varKind=e,a.name=n,a.from=i,a.to=o,a}return qi(r,[{key:"render",value:function(e){var t=e.es5?n.varKinds.var:this.varKind,i=this.name,o=this.from,a=this.to;return "for(".concat(t," ").concat(i,"=").concat(o,"; ").concat(i,"<").concat(a,"; ").concat(i,"++)")+Ei(Li(r.prototype),"render",this).call(this,e)}},{key:"names",get:function(){var e=N(Ei(Li(r.prototype),"names",this),this.from);return N(e,this.to)}}]),r}(S),_=function(e){Pi(n,e);var t=Ri(n);function n(e,r,i,o){var a;return Bi(this,n),(a=t.call(this)).loop=e,a.varKind=r,a.name=i,a.iterable=o,a}return qi(n,[{key:"render",value:function(e){return "for(".concat(this.varKind," ").concat(this.name," ").concat(this.loop," ").concat(this.iterable,")")+Ei(Li(n.prototype),"render",this).call(this,e)}},{key:"optimizeNames",value:function(e,t){if(Ei(Li(n.prototype),"optimizeNames",this).call(this,e,t))return this.iterable=I(this.iterable,e,t),this}},{key:"names",get:function(){return R(Ei(Li(n.prototype),"names",this),this.iterable.names)}}]),n}(S),O=function(e){Pi(n,e);var t=Ri(n);function n(e,r,i){var o;return Bi(this,n),(o=t.call(this)).name=e,o.args=r,o.async=i,o}return qi(n,[{key:"render",value:function(e){var t=this.async?"async ":"";return "".concat(t,"function ").concat(this.name,"(").concat(this.args,")")+Ei(Li(n.prototype),"render",this).call(this,e)}}]),n}(w);O.kind="func";var M=function(e){Pi(n,e);var t=Ri(n);function n(){return Bi(this,n),t.apply(this,arguments)}return qi(n,[{key:"render",value:function(e){return "return "+Ei(Li(n.prototype),"render",this).call(this,e)}}]),n}(b);M.kind="return";var E=function(e){Pi(n,e);var t=Ri(n);function n(){return Bi(this,n),t.apply(this,arguments)}return qi(n,[{key:"render",value:function(e){var t="try"+Ei(Li(n.prototype),"render",this).call(this,e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}},{key:"optimizeNodes",value:function(){var e,t;return Ei(Li(n.prototype),"optimizeNodes",this).call(this),null===(e=this.catch)||void 0===e||e.optimizeNodes(),null===(t=this.finally)||void 0===t||t.optimizeNodes(),this}},{key:"optimizeNames",value:function(e,t){var r,i;return Ei(Li(n.prototype),"optimizeNames",this).call(this,e,t),null===(r=this.catch)||void 0===r||r.optimizeNames(e,t),null===(i=this.finally)||void 0===i||i.optimizeNames(e,t),this}},{key:"names",get:function(){var e=Ei(Li(n.prototype),"names",this);return this.catch&&R(e,this.catch.names),this.finally&&R(e,this.finally.names),e}}]),n}(w),A=function(e){Pi(n,e);var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this)).error=e,r}return qi(n,[{key:"render",value:function(e){return "catch(".concat(this.error,")")+Ei(Li(n.prototype),"render",this).call(this,e)}}]),n}(w);A.kind="catch";var P=function(e){Pi(n,e);var t=Ri(n);function n(){return Bi(this,n),t.apply(this,arguments)}return qi(n,[{key:"render",value:function(e){return "finally"+Ei(Li(n.prototype),"render",this).call(this,e)}}]),n}(w);P.kind="finally";var T=function(){function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Bi(this,r),this._values={},this._blockStarts=[],this._constants={},this.opts=Oi(Oi({},t),{},{_n:t.lines?"\n":""}),this._extScope=e,this._scope=new n.Scope({parent:e}),this._nodes=[new x];}return qi(r,[{key:"toString",value:function(){return this._root.render(this.opts)}},{key:"name",value:function(e){return this._scope.name(e)}},{key:"scopeName",value:function(e){return this._extScope.name(e)}},{key:"scopeValue",value:function(e,t){var n=this._extScope.value(e,t);return (this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}},{key:"getScopeValue",value:function(e,t){return this._extScope.getValue(e,t)}},{key:"scopeRefs",value:function(e){return this._extScope.scopeRefs(e,this._values)}},{key:"scopeCode",value:function(){return this._extScope.scopeCode(this._values)}},{key:"_def",value:function(e,t,n,r){var i=this._scope.toName(t);return void 0!==n&&r&&(this._constants[i.str]=n),this._leafNode(new a(e,i,n)),i}},{key:"const",value:function(e,t,r){return this._def(n.varKinds.const,e,t,r)}},{key:"let",value:function(e,t,r){return this._def(n.varKinds.let,e,t,r)}},{key:"var",value:function(e,t,r){return this._def(n.varKinds.var,e,t,r)}},{key:"assign",value:function(e,t,n){return this._leafNode(new s(e,t,n))}},{key:"add",value:function(t,n){return this._leafNode(new v(t,e.operators.ADD,n))}},{key:"code",value:function(e){return "function"==typeof e?e():e!==t.nil&&this._leafNode(new y(e)),this}},{key:"object",value:function(){for(var e=["{"],n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(var o=0,a=r;o<a.length;o++){var s=Si(a[o],2),c=s[0],u=s[1];e.length>1&&e.push(","),e.push(c),(c!==u||this.opts.es5)&&(e.push(":"),(0, t.addCodeArg)(e,u));}return e.push("}"),new t._Code(e)}},{key:"if",value:function(e,t,n){if(this._blockNode(new j(e)),t&&n)this.code(t).else().code(n).endIf();else if(t)this.code(t).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}},{key:"elseIf",value:function(e){return this._elseNode(new j(e))}},{key:"else",value:function(){return this._elseNode(new k)}},{key:"endIf",value:function(){return this._endBlockNode(j,k)}},{key:"_for",value:function(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}},{key:"for",value:function(e,t){return this._for(new C(e),t)}},{key:"forRange",value:function(e,t,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.opts.es5?n.varKinds.var:n.varKinds.let,a=this._scope.toName(e);return this._for(new $(o,a,t,r),(function(){return i(a)}))}},{key:"forOf",value:function(e,r,i){var o=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.varKinds.const,s=this._scope.toName(e);if(this.opts.es5){var l=r instanceof t.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0, t._)(c||(c=yi(["",".length"])),l),(function(e){o.var(s,(0, t._)(u||(u=yi(["","[","]"])),l,e)),i(s);}))}return this._for(new _("of",a,s,r),(function(){return i(s)}))}},{key:"forIn",value:function(e,r,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.opts.es5?n.varKinds.var:n.varKinds.const;if(this.opts.ownProperties)return this.forOf(e,(0, t._)(l||(l=yi(["Object.keys(",")"])),r),i);var a=this._scope.toName(e);return this._for(new _("in",o,a,r),(function(){return i(a)}))}},{key:"endFor",value:function(){return this._endBlockNode(S)}},{key:"label",value:function(e){return this._leafNode(new p(e))}},{key:"break",value:function(e){return this._leafNode(new m(e))}},{key:"return",value:function(e){var t=new M;if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(M)}},{key:"try",value:function(e,t,n){if(!t&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');var r=new E;if(this._blockNode(r),this.code(e),t){var i=this.name("e");this._currNode=r.catch=new A(i),t(i);}return n&&(this._currNode=r.finally=new P,this.code(n)),this._endBlockNode(A,P)}},{key:"throw",value:function(e){return this._leafNode(new g(e))}},{key:"block",value:function(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}},{key:"endBlock",value:function(e){var t=this._blockStarts.pop();if(void 0===t)throw new Error("CodeGen: not in self-balancing block");var n=this._nodes.length-t;if(n<0||void 0!==e&&n!==e)throw new Error("CodeGen: wrong number of nodes: ".concat(n," vs ").concat(e," expected"));return this._nodes.length=t,this}},{key:"func",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.nil,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return this._blockNode(new O(e,n,r)),i&&this.code(i).endFunc(),this}},{key:"endFunc",value:function(){return this._endBlockNode(O)}},{key:"optimize",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants);}},{key:"_leafNode",value:function(e){return this._currNode.nodes.push(e),this}},{key:"_blockNode",value:function(e){this._currNode.nodes.push(e),this._nodes.push(e);}},{key:"_endBlockNode",value:function(e,t){var n=this._currNode;if(n instanceof e||t&&n instanceof t)return this._nodes.pop(),this;throw new Error('CodeGen: not in block "'.concat(t?"".concat(e.kind,"/").concat(t.kind):e.kind,'"'))}},{key:"_elseNode",value:function(e){var t=this._currNode;if(!(t instanceof j))throw new Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}},{key:"_root",get:function(){return this._nodes[0]}},{key:"_currNode",get:function(){var e=this._nodes;return e[e.length-1]},set:function(e){var t=this._nodes;t[t.length-1]=e;}}]),r}();function R(e,t){for(var n in t)e[n]=(e[n]||0)+(t[n]||0);return e}function N(e,n){return n instanceof t._CodeOrName?R(e,n.names):e}function I(e,n,r){return e instanceof t.Name?i(e):function(e){return e instanceof t._Code&&e._items.some((function(e){return e instanceof t.Name&&1===n[e.str]&&void 0!==r[e.str]}))}(e)?new t._Code(e._items.reduce((function(e,n){return n instanceof t.Name&&(n=i(n)),n instanceof t._Code?e.push.apply(e,Vi(n._items)):e.push(n),e}),[])):e;function i(e){var t=r[e.str];return void 0===t||1!==n[e.str]?e:(delete n[e.str],t)}}function D(e,t){for(var n in t)e[n]=(e[n]||0)-(t[n]||0);}function L(e){return "boolean"==typeof e||"number"==typeof e||null===e?!e:(0, t._)(f||(f=yi(["!",""])),F(e))}e.CodeGen=T,e.not=L;var B=q(e.operators.AND);e.and=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(B)};var z=q(e.operators.OR);function q(e){return function(n,r){return n===t.nil?r:r===t.nil?n:(0, t._)(h||(h=yi([""," "," ",""])),F(n),e,F(r))}}function F(e){return e instanceof t.Name?e:(0, t._)(d||(d=yi(["(",")"])),e)}e.or=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(z)};}(s2)),s2}var p2={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkStrictMode=e.getErrorPath=e.Type=e.useFunc=e.setEvaluated=e.evaluatedPropsToName=e.mergeEvaluated=e.eachItem=e.unescapeJsonPointer=e.escapeJsonPointer=e.escapeFragment=e.unescapeFragment=e.schemaRefOrVal=e.schemaHasRulesButRef=e.schemaHasRules=e.checkUnknownRules=e.alwaysValidSchema=e.toHash=void 0;var t=v2(),n=u2();function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.schema,n=e.opts,r=e.self;if(n.strictSchema&&"boolean"!=typeof t){var i=r.RULES.keywords;for(var o in t)i[o]||h(e,'unknown keyword: "'.concat(o,'"'));}}function i(e,t){if("boolean"==typeof e)return !e;for(var n in e)if(t[n])return !0;return !1}function o(e){return "number"==typeof e?"".concat(e):e.replace(/~/g,"~0").replace(/\//g,"~1")}function a(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function s(e){var n=e.mergeNames,r=e.mergeToName,i=e.mergeValues,o=e.resultToName;return function(e,a,s,c){var u=void 0===s?a:s instanceof t.Name?(a instanceof t.Name?n(e,a,s):r(e,a,s),s):a instanceof t.Name?(r(e,s,a),a):i(a,s);return c!==t.Name||u instanceof t.Name?u:o(e,u)}}function c(e,n){if(!0===n)return e.var("props",!0);var r=e.var("props",(0, t._)($||($=yi(["{}"]))));return void 0!==n&&u(e,r,n),r}function u(e,n,r){Object.keys(r).forEach((function(r){return e.assign((0, t._)(_||(_=yi(["","",""])),n,(0, t.getProperty)(r)),!0)}));}e.toHash=function(e){var t,n={},r=wi(e);try{for(r.s();!(t=r.n()).done;){n[t.value]=!0;}}catch(e){r.e(e);}finally{r.f();}return n},e.alwaysValidSchema=function(e,t){return "boolean"==typeof t?t:0===Object.keys(t).length||(r(e,t),!i(t,e.self.RULES.all))},e.checkUnknownRules=r,e.schemaHasRules=i,e.schemaHasRulesButRef=function(e,t){if("boolean"==typeof e)return !e;for(var n in e)if("$ref"!==n&&t.all[n])return !0;return !1},e.schemaRefOrVal=function(e,n,r,i){var o=e.topSchemaRef,a=e.schemaPath;if(!i){if("number"==typeof n||"boolean"==typeof n)return n;if("string"==typeof n)return (0, t._)(v||(v=yi(["",""])),n)}return (0, t._)(p||(p=yi(["","","",""])),o,a,(0, t.getProperty)(r))},e.unescapeFragment=function(e){return a(decodeURIComponent(e))},e.escapeFragment=function(e){return encodeURIComponent(o(e))},e.escapeJsonPointer=o,e.unescapeJsonPointer=a,e.eachItem=function(e,t){if(Array.isArray(e)){var n,r=wi(e);try{for(r.s();!(n=r.n()).done;){t(n.value);}}catch(e){r.e(e);}finally{r.f();}}else t(e);},e.mergeEvaluated={props:s({mergeNames:function(e,n,r){return e.if((0, t._)(m||(m=yi([""," !== true && "," !== undefined"])),r,n),(function(){e.if((0, t._)(g||(g=yi([""," === true"])),n),(function(){return e.assign(r,!0)}),(function(){return e.assign(r,(0, t._)(y||(y=yi([""," || {}"])),r)).code((0, t._)(b||(b=yi(["Object.assign(",", ",")"])),r,n))}));}))},mergeToName:function(e,n,r){return e.if((0, t._)(w||(w=yi([""," !== true"])),r),(function(){!0===n?e.assign(r,!0):(e.assign(r,(0, t._)(x||(x=yi([""," || {}"])),r)),u(e,r,n));}))},mergeValues:function(e,t){return !0===e||Oi(Oi({},e),t)},resultToName:c}),items:s({mergeNames:function(e,n,r){return e.if((0, t._)(k||(k=yi([""," !== true && "," !== undefined"])),r,n),(function(){return e.assign(r,(0, t._)(j||(j=yi([""," === true ? true : "," > "," ? "," : ",""])),n,r,n,r,n))}))},mergeToName:function(e,n,r){return e.if((0, t._)(S||(S=yi([""," !== true"])),r),(function(){return e.assign(r,!0===n||(0, t._)(C||(C=yi([""," > "," ? "," : ",""])),r,n,r,n))}))},mergeValues:function(e,t){return !0===e||Math.max(e,t)},resultToName:function(e,t){return e.var("items",t)}})},e.evaluatedPropsToName=c,e.setEvaluated=u;var l,f={};function h(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.opts.strictSchema;if(n){if(t="strict mode: ".concat(t),!0===n)throw new Error(t);e.self.logger.warn(t);}}e.useFunc=function(e,t){return e.scopeValue("func",{ref:t,code:f[t.code]||(f[t.code]=new n._Code(t.code))})},function(e){e[e.Num=0]="Num",e[e.Str=1]="Str";}(l=e.Type||(e.Type={})),e.getErrorPath=function(e,n,r){if(e instanceof t.Name){var i=n===l.Num;return r?i?(0, t._)(O||(O=yi(['"[" + ',' + "]"'])),e):(0, t._)(M||(M=yi(['"[\'" + ',' + "\']"'])),e):i?(0, t._)(E||(E=yi(['"/" + ',""])),e):(0, t._)(A||(A=yi(['"/" + ','.replace(/~/g, "~0").replace(/\\//g, "~1")'],['"/" + ','.replace(/~/g, "~0").replace(/\\\\//g, "~1")'])),e)}return r?(0, t.getProperty)(e).toString():"/"+o(e)},e.checkStrictMode=h;}(p2);var m2,g2,y2,b2={};function w2(){if(m2)return b2;m2=1,Object.defineProperty(b2,"__esModule",{value:!0});var e=v2(),t={data:new e.Name("data"),valCxt:new e.Name("valCxt"),instancePath:new e.Name("instancePath"),parentData:new e.Name("parentData"),parentDataProperty:new e.Name("parentDataProperty"),rootData:new e.Name("rootData"),dynamicAnchors:new e.Name("dynamicAnchors"),vErrors:new e.Name("vErrors"),errors:new e.Name("errors"),this:new e.Name("this"),self:new e.Name("self"),scope:new e.Name("scope"),json:new e.Name("json"),jsonPos:new e.Name("jsonPos"),jsonLen:new e.Name("jsonLen"),jsonPart:new e.Name("jsonPart")};return b2.default=t,b2}function x2(){return g2||(g2=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;var t=v2(),n=p2,r=w2();function i(e,n){var i=e.const("err",n);e.if((0, t._)(H||(H=yi([""," === null"])),r.default.vErrors),(function(){return e.assign(r.default.vErrors,(0, t._)(U||(U=yi(["[","]"])),i))}),(0, t._)(J||(J=yi(["",".push(",")"])),r.default.vErrors,i)),e.code((0, t._)(K||(K=yi(["","++"])),r.default.errors));}function o(e,n){var r=e.gen,i=e.validateName;e.schemaEnv.$async?r.throw((0, t._)(G||(G=yi(["new ","(",")"])),e.ValidationError,n)):(r.assign((0, t._)(Q||(Q=yi(["",".errors"])),i),n),r.return(!1));}e.keywordError={message:function(e){var n=e.keyword;return (0, t.str)(P||(P=yi(['must pass "','" keyword validation'])),n)}},e.keyword$DataError={message:function(e){var n=e.keyword,r=e.schemaType;return r?(0, t.str)(T||(T=yi(['"','" keyword must be '," ($data)"])),n,r):(0, t.str)(R||(R=yi(['"','" keyword is invalid ($data)'])),n)}},e.reportError=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.keywordError,a=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,u=n.it,l=u.gen,f=u.compositeRule,h=u.allErrors,d=s(n,r,a);(null!=c?c:f||h)?i(l,d):o(u,(0, t._)(N||(N=yi(["[","]"])),d));},e.reportExtraError=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.keywordError,a=arguments.length>2?arguments[2]:void 0,c=t.it,u=c.gen,l=c.compositeRule,f=c.allErrors,h=s(t,n,a);i(u,h),l||f||o(c,r.default.vErrors);},e.resetErrorsCount=function(e,n){e.assign(r.default.errors,n),e.if((0, t._)(I||(I=yi([""," !== null"])),r.default.vErrors),(function(){return e.if(n,(function(){return e.assign((0, t._)(D||(D=yi(["",".length"])),r.default.vErrors),n)}),(function(){return e.assign(r.default.vErrors,null)}))}));},e.extendErrors=function(e){var n=e.gen,i=e.keyword,o=e.schemaValue,a=e.data,s=e.errsCount,c=e.it;if(void 0===s)throw new Error("ajv implementation error");var u=n.name("err");n.forRange("i",s,r.default.errors,(function(e){n.const(u,(0, t._)(L||(L=yi(["","[","]"])),r.default.vErrors,e)),n.if((0, t._)(B||(B=yi(["",".instancePath === undefined"])),u),(function(){return n.assign((0, t._)(z||(z=yi(["",".instancePath"])),u),(0, t.strConcat)(r.default.instancePath,c.errorPath))})),n.assign((0, t._)(q||(q=yi(["",".schemaPath"])),u),(0, t.str)(F||(F=yi(["","/",""])),c.errSchemaPath,i)),c.opts.verbose&&(n.assign((0, t._)(V||(V=yi(["",".schema"])),u),o),n.assign((0, t._)(W||(W=yi(["",".data"])),u),a));}));};var a={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function s(e,n,r){return !1===e.it.createErrors?(0, t._)(Y||(Y=yi(["{}"]))):function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.gen,i=[c(e.it,n),u(e,n)];return l(e,t,i),r.object.apply(r,i)}(e,n,r)}function c(e,i){var o=e.errorPath,a=i.instancePath,s=a?(0, t.str)(X||(X=yi(["","",""])),o,(0, n.getErrorPath)(a,n.Type.Str)):o;return [r.default.instancePath,(0, t.strConcat)(r.default.instancePath,s)]}function u(e,r){var i=e.keyword,o=e.it.errSchemaPath,s=r.schemaPath,c=r.parentSchema?o:(0, t.str)(Z||(Z=yi(["","/",""])),o,i);return s&&(c=(0, t.str)(ee||(ee=yi(["","",""])),c,(0, n.getErrorPath)(s,n.Type.Str))),[a.schemaPath,c]}function l(e,n,i){var o=n.params,s=n.message,c=e.keyword,u=e.data,l=e.schemaValue,f=e.it,h=f.opts,d=f.propertyName,v=f.topSchemaRef,p=f.schemaPath;i.push([a.keyword,c],[a.params,"function"==typeof o?o(e):o||(0, t._)(te||(te=yi(["{}"])))]),h.messages&&i.push([a.message,"function"==typeof s?s(e):s]),h.verbose&&i.push([a.schema,l],[a.parentSchema,(0, t._)(ne||(ne=yi(["","",""])),v,p)],[r.default.data,u]),d&&i.push([a.propertyName,d]);}}(a2)),a2}var k2={},j2={};Object.defineProperty(j2,"__esModule",{value:!0}),j2.getRules=j2.isJSONType=void 0;var S2=new Set(["string","number","integer","boolean","null","object","array"]);j2.isJSONType=function(e){return "string"==typeof e&&S2.has(e)},j2.getRules=function(){var e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return {types:Oi(Oi({},e),{},{integer:!0,boolean:!0,null:!0}),rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}};var C2,$2={};function _2(){if(C2)return $2;function e(e,n){return n.rules.some((function(n){return t(e,n)}))}function t(e,t){var n;return void 0!==e[t.keyword]||(null===(n=t.definition.implements)||void 0===n?void 0:n.some((function(t){return void 0!==e[t]})))}return C2=1,Object.defineProperty($2,"__esModule",{value:!0}),$2.shouldUseRule=$2.shouldUseGroup=$2.schemaHasRulesForType=void 0,$2.schemaHasRulesForType=function(t,n){var r=t.schema,i=t.self.RULES.types[n];return i&&!0!==i&&e(r,i)},$2.shouldUseGroup=e,$2.shouldUseRule=t,$2}!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.reportTypeError=e.checkDataTypes=e.checkDataType=e.coerceAndCheckDataType=e.getJSONTypes=e.getSchemaTypes=e.DataType=void 0;var t,n=j2,r=_2(),i=x2(),o=v2(),a=p2;function s(e){var t=Array.isArray(e)?e:e?[e]:[];if(t.every(n.isJSONType))return t;throw new Error("type must be JSONType or JSONType[]: "+t.join(","))}!function(e){e[e.Correct=0]="Correct",e[e.Wrong=1]="Wrong";}(t=e.DataType||(e.DataType={})),e.getSchemaTypes=function(e){var t=s(e.type);if(t.includes("null")){if(!1===e.nullable)throw new Error("type: null contradicts nullable: false")}else {if(!t.length&&void 0!==e.nullable)throw new Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null");}return t},e.getJSONTypes=s,e.coerceAndCheckDataType=function(e,n){var i=e.gen,a=e.data,s=e.opts,u=function(e,t){return t?e.filter((function(e){return c.has(e)||"array"===t&&"array"===e})):[]}(n,s.coerceTypes),f=n.length>0&&!(0===u.length&&1===n.length&&(0, r.schemaHasRulesForType)(e,n[0]));if(f){var d=l(n,a,s.strictNumbers,t.Wrong);i.if(d,(function(){u.length?function(e,t,n){var r=e.gen,i=e.data,a=e.opts,s=r.let("dataType",(0, o._)(ie||(ie=yi(["typeof ",""])),i)),u=r.let("coerced",(0, o._)(oe||(oe=yi(["undefined"]))));"array"===a.coerceTypes&&r.if((0, o._)(ae||(ae=yi([""," == 'object' && Array.isArray(",") && ",".length == 1"])),s,i,i),(function(){return r.assign(i,(0, o._)(se||(se=yi(["","[0]"])),i)).assign(s,(0, o._)(ce||(ce=yi(["typeof ",""])),i)).if(l(t,i,a.strictNumbers),(function(){return r.assign(u,i)}))}));r.if((0, o._)(ue||(ue=yi([""," !== undefined"])),u));var f,d=wi(n);try{for(d.s();!(f=d.n()).done;){var v=f.value;(c.has(v)||"array"===v&&"array"===a.coerceTypes)&&p(v);}}catch(e){d.e(e);}finally{d.f();}function p(e){switch(e){case"string":return void r.elseIf((0, o._)(fe||(fe=yi(["",' == "number" || ',' == "boolean"'])),s,s)).assign(u,(0, o._)(he||(he=yi(['"" + ',""])),i)).elseIf((0, o._)(de||(de=yi([""," === null"])),i)).assign(u,(0, o._)(ve||(ve=yi(['""']))));case"number":return void r.elseIf((0, o._)(pe||(pe=yi(["",' == "boolean" || '," === null\n              || (",' == "string" && '," && "," == +",")"])),s,i,s,i,i,i)).assign(u,(0, o._)(me||(me=yi(["+",""])),i));case"integer":return void r.elseIf((0, o._)(ge||(ge=yi(["",' === "boolean" || '," === null\n              || (",' === "string" && '," && "," == +"," && !("," % 1))"])),s,i,s,i,i,i,i)).assign(u,(0, o._)(ye||(ye=yi(["+",""])),i));case"boolean":return void r.elseIf((0, o._)(be||(be=yi(["",' === "false" || '," === 0 || "," === null"])),i,i,i)).assign(u,!1).elseIf((0, o._)(we||(we=yi(["",' === "true" || '," === 1"])),i,i)).assign(u,!0);case"null":return r.elseIf((0, o._)(xe||(xe=yi(["",' === "" || '," === 0 || "," === false"])),i,i,i)),void r.assign(u,null);case"array":r.elseIf((0, o._)(ke||(ke=yi(["",' === "string" || ',' === "number"\n              || ',' === "boolean" || '," === null"])),s,s,s,i)).assign(u,(0, o._)(je||(je=yi(["[","]"])),i));}}r.else(),h(e),r.endIf(),r.if((0, o._)(le||(le=yi([""," !== undefined"])),u),(function(){r.assign(i,u),function(e,t){var n=e.gen,r=e.parentData,i=e.parentDataProperty;n.if((0, o._)(Se||(Se=yi([""," !== undefined"])),r),(function(){return n.assign((0, o._)(Ce||(Ce=yi(["","[","]"])),r,i),t)}));}(e,u);}));}(e,n,u):h(e);}));}return f};var c=new Set(["string","number","integer","boolean","null"]);function u(e,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.Correct,s=a===t.Correct?o.operators.EQ:o.operators.NEQ;switch(e){case"null":return (0, o._)($e||($e=yi([""," "," null"])),n,s);case"array":i=(0, o._)(_e||(_e=yi(["Array.isArray(",")"])),n);break;case"object":i=(0, o._)(Oe||(Oe=yi([""," && typeof ",' == "object" && !Array.isArray(',")"])),n,n,n);break;case"integer":i=c((0, o._)(Me||(Me=yi(["!("," % 1) && !isNaN(",")"])),n,n));break;case"number":i=c();break;default:return (0, o._)(Ee||(Ee=yi(["typeof "," "," ",""])),n,s,e)}return a===t.Correct?i:(0, o.not)(i);function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.nil;return (0, o.and)((0, o._)(Ae||(Ae=yi(["typeof ",' == "number"'])),n),e,r?(0, o._)(Pe||(Pe=yi(["isFinite(",")"])),n):o.nil)}}function l(e,t,n,r){if(1===e.length)return u(e[0],t,n,r);var i,s=(0, a.toHash)(e);if(s.array&&s.object){var c=(0, o._)(Te||(Te=yi(["typeof ",' != "object"'])),t);i=s.null?c:(0, o._)(Re||(Re=yi(["!"," || ",""])),t,c),delete s.null,delete s.array,delete s.object;}else i=o.nil;for(var l in s.number&&delete s.integer,s)i=(0, o.and)(i,u(l,t,n,r));return i}e.checkDataType=u,e.checkDataTypes=l;var f={message:function(e){var t=e.schema;return "must be ".concat(t)},params:function(e){var t=e.schema,n=e.schemaValue;return "string"==typeof t?(0, o._)(Ne||(Ne=yi(["{type: ","}"])),t):(0, o._)(Ie||(Ie=yi(["{type: ","}"])),n)}};function h(e){var t=function(e){var t=e.gen,n=e.data,r=e.schema,i=(0, a.schemaRefOrVal)(e,r,"type");return {gen:t,keyword:"type",data:n,schema:r.type,schemaCode:i,schemaValue:i,parentSchema:r,params:{},it:e}}(e);(0, i.reportError)(t,f);}e.reportTypeError=h;}(k2);var O2,M2={};var E2,A2,P2={},T2={};function R2(){if(E2)return T2;E2=1,Object.defineProperty(T2,"__esModule",{value:!0}),T2.validateUnion=T2.validateArray=T2.usePattern=T2.callValidateCode=T2.schemaProperties=T2.allSchemaProperties=T2.noPropertyInData=T2.propertyInData=T2.isOwnProperty=T2.hasPropFunc=T2.reportMissingProp=T2.checkMissingProp=T2.checkReportMissingProp=void 0;var e=v2(),t=p2,n=w2(),r=p2;function i(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0, e._)(Ve||(Ve=yi(["Object.prototype.hasOwnProperty"])))})}function o(t,n,r){return (0, e._)(We||(We=yi(["",".call(",", ",")"])),i(t),n,r)}function a(t,n,r,i){var a=(0, e._)(Je||(Je=yi(["",""," === undefined"])),n,(0, e.getProperty)(r));return i?(0, e.or)(a,(0, e.not)(o(t,n,r))):a}function s(e){return e?Object.keys(e).filter((function(e){return "__proto__"!==e})):[]}T2.checkReportMissingProp=function(t,n){var r=t.gen,i=t.data,o=t.it;r.if(a(r,i,n,o.opts.ownProperties),(function(){t.setParams({missingProperty:(0, e._)(qe||(qe=yi(["",""])),n)},!0),t.error();}));},T2.checkMissingProp=function(t,n,r){var i=t.gen,o=t.data,s=t.it.opts;return e.or.apply(void 0,Vi(n.map((function(t){return (0, e.and)(a(i,o,t,s.ownProperties),(0, e._)(Fe||(Fe=yi([""," = ",""])),r,t))}))))},T2.reportMissingProp=function(e,t){e.setParams({missingProperty:t},!0),e.error();},T2.hasPropFunc=i,T2.isOwnProperty=o,T2.propertyInData=function(t,n,r,i){var a=(0, e._)(He||(He=yi(["",""," !== undefined"])),n,(0, e.getProperty)(r));return i?(0, e._)(Ue||(Ue=yi([""," && ",""])),a,o(t,n,r)):a},T2.noPropertyInData=a,T2.allSchemaProperties=s,T2.schemaProperties=function(e,n){return s(n).filter((function(r){return !(0, t.alwaysValidSchema)(e,n[r])}))},T2.callValidateCode=function(t,r,i,o){var a=t.schemaCode,s=t.data,c=t.it,u=c.gen,l=c.topSchemaRef,f=c.schemaPath,h=c.errorPath,d=t.it,v=o?(0, e._)(Ke||(Ke=yi(["",", ",", ","",""])),a,s,l,f):s,p=[[n.default.instancePath,(0, e.strConcat)(n.default.instancePath,h)],[n.default.parentData,d.parentData],[n.default.parentDataProperty,d.parentDataProperty],[n.default.rootData,n.default.rootData]];d.opts.dynamicRef&&p.push([n.default.dynamicAnchors,n.default.dynamicAnchors]);var m=(0, e._)(Ge||(Ge=yi(["",", ",""])),v,u.object.apply(u,p));return i!==e.nil?(0, e._)(Qe||(Qe=yi(["",".call(",", ",")"])),r,i,m):(0, e._)(Ye||(Ye=yi(["","(",")"])),r,m)};var c=(0, e._)(Xe||(Xe=yi(["new RegExp"])));return T2.usePattern=function(t,n){var i=t.gen,o=t.it.opts,a=o.unicodeRegExp?"u":"",s=o.code.regExp,u=s(n,a);return i.scopeValue("pattern",{key:u.toString(),ref:u,code:(0, e._)(Ze||(Ze=yi(["","(",", ",")"])),"new RegExp"===s.code?c:(0, r.useFunc)(i,s),n,a)})},T2.validateArray=function(n){var r=n.gen,i=n.data,o=n.keyword,a=n.it,s=r.name("valid");if(a.allErrors){var c=r.let("valid",!0);return u((function(){return r.assign(c,!1)})),c}return r.var(s,!0),u((function(){return r.break()})),s;function u(a){var c=r.const("len",(0, e._)(et||(et=yi(["",".length"])),i));r.forRange("i",0,c,(function(i){n.subschema({keyword:o,dataProp:i,dataPropType:t.Type.Num},s),r.if((0, e.not)(s),a);}));}},T2.validateUnion=function(n){var r=n.gen,i=n.schema,o=n.keyword,a=n.it;if(!Array.isArray(i))throw new Error("ajv implementation error");if(!i.some((function(e){return (0, t.alwaysValidSchema)(a,e)}))||a.opts.unevaluated){var s=r.let("valid",!1),c=r.name("_valid");r.block((function(){return i.forEach((function(t,i){var a=n.subschema({keyword:o,schemaProp:i,compositeRule:!0},c);r.assign(s,(0, e._)(tt||(tt=yi([""," || ",""])),s,c)),n.mergeValidEvaluated(a,c)||r.if((0, e.not)(s));}))})),n.result(s,(function(){return n.reset()}),(function(){return n.error(!0)}));}},T2}function N2(){if(A2)return P2;A2=1,Object.defineProperty(P2,"__esModule",{value:!0}),P2.validateKeywordUsage=P2.validSchemaType=P2.funcKeywordCode=P2.macroKeywordCode=void 0;var e=v2(),t=w2(),n=R2(),r=x2();function i(t){var n=t.gen,r=t.data,i=t.it;n.if(i.parentData,(function(){return n.assign(r,(0, e._)(ct||(ct=yi(["","[","]"])),i.parentData,i.parentDataProperty))}));}function o(t,n,r){if(void 0===r)throw new Error('keyword "'.concat(n,'" failed to compile'));return t.scopeValue("keyword","function"==typeof r?{ref:r}:{ref:r,code:(0, e.stringify)(r)})}return P2.macroKeywordCode=function(t,n){var r=t.gen,i=t.keyword,a=t.schema,s=t.parentSchema,c=t.it,u=n.macro.call(c.self,a,s,c),l=o(r,i,u);!1!==c.opts.validateSchema&&c.self.validateSchema(u,!0);var f=r.name("valid");t.subschema({schema:u,schemaPath:e.nil,errSchemaPath:"".concat(c.errSchemaPath,"/").concat(i),topSchemaRef:l,compositeRule:!0},f),t.pass(f,(function(){return t.error(!0)}));},P2.funcKeywordCode=function(a,s){var c,u=a.gen,l=a.keyword,f=a.schema,h=a.parentSchema,d=a.$data,v=a.it;!function(e,t){var n=e.schemaEnv;if(t.async&&!n.$async)throw new Error("async keyword in sync schema")}(v,s);var p=!d&&s.compile?s.compile.call(v.self,f,h,v):s.validate,m=o(u,l,p),g=u.let("valid");function y(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.async?(0, e._)(at||(at=yi(["await "]))):e.nil,i=v.opts.passContext?t.default.this:t.default.self,o=!("compile"in s&&!d||!1===s.schema);u.assign(g,(0, e._)(st||(st=yi(["","",""])),r,(0, n.callValidateCode)(a,m,i,o)),s.modifying);}function b(t){var n;u.if((0, e.not)(null!==(n=s.valid)&&void 0!==n?n:g),t);}a.block$data(g,(function(){if(!1===s.errors)y(),s.modifying&&i(a),b((function(){return a.error()}));else {var n=s.async?function(){var t=u.let("ruleErrs",null);return u.try((function(){return y((0, e._)(nt||(nt=yi(["await "]))))}),(function(n){return u.assign(g,!1).if((0, e._)(rt||(rt=yi([""," instanceof ",""])),n,v.ValidationError),(function(){return u.assign(t,(0, e._)(it||(it=yi(["",".errors"])),n))}),(function(){return u.throw(n)}))})),t}():(o=(0, e._)(ot||(ot=yi(["",".errors"])),m),u.assign(o,null),y(e.nil),o);s.modifying&&i(a),b((function(){return function(n,i){var o=n.gen;o.if((0, e._)(ut||(ut=yi(["Array.isArray(",")"])),i),(function(){o.assign(t.default.vErrors,(0, e._)(lt||(lt=yi([""," === null ? "," : ",".concat(",")"])),t.default.vErrors,i,t.default.vErrors,i)).assign(t.default.errors,(0, e._)(ft||(ft=yi(["",".length"])),t.default.vErrors)),(0, r.extendErrors)(n);}),(function(){return n.error()}));}(a,n)}));}var o;})),a.ok(null!==(c=s.valid)&&void 0!==c?c:g);},P2.validSchemaType=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return !t.length||t.some((function(t){return "array"===t?Array.isArray(e):"object"===t?e&&"object"==Ji(e)&&!Array.isArray(e):Ji(e)==t||n&&void 0===e}))},P2.validateKeywordUsage=function(e,t,n){var r=e.schema,i=e.opts,o=e.self,a=e.errSchemaPath;if(Array.isArray(t.keyword)?!t.keyword.includes(n):t.keyword!==n)throw new Error("ajv implementation error");var s=t.dependencies;if(null==s?void 0:s.some((function(e){return !Object.prototype.hasOwnProperty.call(r,e)})))throw new Error("parent schema must have dependencies of ".concat(n,": ").concat(s.join(",")));if(t.validateSchema&&!t.validateSchema(r[n])){var c='keyword "'.concat(n,'" value is invalid at path "').concat(a,'": ')+o.errorsText(t.validateSchema.errors);if("log"!==i.validateSchema)throw new Error(c);o.logger.error(c);}},P2}var I2,D2={};var L2={},B2=function e(t,n){if(t===n)return !0;if(t&&n&&"object"==Ji(t)&&"object"==Ji(n)){if(t.constructor!==n.constructor)return !1;var r,i,o;if(Array.isArray(t)){if((r=t.length)!=n.length)return !1;for(i=r;0!=i--;)if(!e(t[i],n[i]))return !1;return !0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(o=Object.keys(t)).length)!==Object.keys(n).length)return !1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return !1;for(i=r;0!=i--;){var a=o[i];if(!e(t[a],n[a]))return !1}return !0}return t!=t&&n!=n},z2={exports:{}},q2=z2.exports=function(e,t,n){"function"==typeof t&&(n=t,t={}),F2(t,"function"==typeof(n=t.cb||n)?n:n.pre||function(){},n.post||function(){},e,"",e);};function F2(e,t,n,r,i,o,a,s,c,u){if(r&&"object"==Ji(r)&&!Array.isArray(r)){for(var l in t(r,i,o,a,s,c,u),r){var f=r[l];if(Array.isArray(f)){if(l in q2.arrayKeywords)for(var h=0;h<f.length;h++)F2(e,t,n,f[h],i+"/"+l+"/"+h,o,i,l,r,h);}else if(l in q2.propsKeywords){if(f&&"object"==Ji(f))for(var d in f)F2(e,t,n,f[d],i+"/"+l+"/"+d.replace(/~/g,"~0").replace(/\//g,"~1"),o,i,l,r,d);}else (l in q2.keywords||e.allKeys&&!(l in q2.skipKeywords))&&F2(e,t,n,f,i+"/"+l,o,i,l,r);}n(r,i,o,a,s,c,u);}}q2.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},q2.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},q2.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},q2.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};var V2=z2.exports;Object.defineProperty(L2,"__esModule",{value:!0}),L2.getSchemaRefs=L2.resolveUrl=L2.normalizeId=L2._getFullPath=L2.getFullPath=L2.inlineRef=void 0;var W2=p2,H2=B2,U2=V2,J2=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);L2.inlineRef=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return "boolean"==typeof e||(!0===t?!G2(e):!!t&&Q2(e)<=t)};var K2=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function G2(e){for(var t in e){if(K2.has(t))return !0;var n=e[t];if(Array.isArray(n)&&n.some(G2))return !0;if("object"==Ji(n)&&G2(n))return !0}return !1}function Q2(e){var t=0;for(var n in e){if("$ref"===n)return 1/0;if(t++,!J2.has(n)&&("object"==Ji(e[n])&&(0, W2.eachItem)(e[n],(function(e){return t+=Q2(e)})),t===1/0))return 1/0}return t}function Y2(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;!1!==n&&(t=e3(t));var r=e.parse(t);return X2(e,r)}function X2(e,t){return e.serialize(t).split("#")[0]+"#"}L2.getFullPath=Y2,L2._getFullPath=X2;var Z2=/#\/?$/;function e3(e){return e?e.replace(Z2,""):""}L2.normalizeId=e3,L2.resolveUrl=function(e,t,n){return n=e3(n),e.resolve(t,n)};var t3,n3=/^[a-z_][-a-z0-9._]*$/i;function r3(){if(t3)return i2;t3=1,Object.defineProperty(i2,"__esModule",{value:!0}),i2.getData=i2.KeywordCxt=i2.validateFunctionCode=void 0;var e=function(){if(y2)return o2;y2=1,Object.defineProperty(o2,"__esModule",{value:!0}),o2.boolOrEmptySchema=o2.topBoolOrEmptySchema=void 0;var e=x2(),t=v2(),n=w2(),r={message:"boolean schema is false"};function i(t,n){var i={gen:t.gen,keyword:"false schema",data:t.data,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0, e.reportError)(i,r,void 0,n);}return o2.topBoolOrEmptySchema=function(e){var r=e.gen,o=e.schema,a=e.validateName;!1===o?i(e,!1):"object"==Ji(o)&&!0===o.$async?r.return(n.default.data):(r.assign((0, t._)(re||(re=yi(["",".errors"])),a),null),r.return(!0));},o2.boolOrEmptySchema=function(e,t){var n=e.gen;!1===e.schema?(n.var(t,!1),i(e)):n.var(t,!0);},o2}(),t=k2,n=_2(),r=k2,i=function(){if(O2)return M2;O2=1,Object.defineProperty(M2,"__esModule",{value:!0}),M2.assignDefaults=void 0;var e=v2(),t=p2;function n(n,r,i){var o=n.gen,a=n.compositeRule,s=n.data,c=n.opts;if(void 0!==i){var u=(0, e._)(De||(De=yi(["","",""])),s,(0, e.getProperty)(r));if(a)(0, t.checkStrictMode)(n,"default is ignored for: ".concat(u));else {var l=(0, e._)(Le||(Le=yi([""," === undefined"])),u);"empty"===c.useDefaults&&(l=(0, e._)(Be||(Be=yi([""," || "," === null || ",' === ""'])),l,u,u)),o.if(l,(0, e._)(ze||(ze=yi([""," = ",""])),u,(0, e.stringify)(i)));}}}return M2.assignDefaults=function(e,t){var r=e.schema,i=r.properties,o=r.items;if("object"===t&&i)for(var a in i)n(e,a,i[a].default);else "array"===t&&Array.isArray(o)&&o.forEach((function(t,r){return n(e,r,t.default)}));},M2}(),o=N2(),a=function(){if(I2)return D2;I2=1,Object.defineProperty(D2,"__esModule",{value:!0}),D2.extendSubschemaMode=D2.extendSubschemaData=D2.getSubschema=void 0;var e=v2(),t=p2;return D2.getSubschema=function(n,r){var i=r.keyword,o=r.schemaProp,a=r.schema,s=r.schemaPath,c=r.errSchemaPath,u=r.topSchemaRef;if(void 0!==i&&void 0!==a)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==i){var l=n.schema[i];return void 0===o?{schema:l,schemaPath:(0, e._)(ht||(ht=yi(["","",""])),n.schemaPath,(0, e.getProperty)(i)),errSchemaPath:"".concat(n.errSchemaPath,"/").concat(i)}:{schema:l[o],schemaPath:(0, e._)(dt||(dt=yi(["","","",""])),n.schemaPath,(0, e.getProperty)(i),(0, e.getProperty)(o)),errSchemaPath:"".concat(n.errSchemaPath,"/").concat(i,"/").concat((0, t.escapeFragment)(o))}}if(void 0!==a){if(void 0===s||void 0===c||void 0===u)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return {schema:a,schemaPath:s,topSchemaRef:u,errSchemaPath:c}}throw new Error('either "keyword" or "schema" must be passed')},D2.extendSubschemaData=function(n,r,i){var o=i.dataProp,a=i.dataPropType,s=i.data,c=i.dataTypes,u=i.propertyName;if(void 0!==s&&void 0!==o)throw new Error('both "data" and "dataProp" passed, only one allowed');var l=r.gen;if(void 0!==o){var f=r.errorPath,h=r.dataPathArr,d=r.opts;v(l.let("data",(0, e._)(vt||(vt=yi(["","",""])),r.data,(0, e.getProperty)(o)),!0)),n.errorPath=(0, e.str)(pt||(pt=yi(["","",""])),f,(0, t.getErrorPath)(o,a,d.jsPropertySyntax)),n.parentDataProperty=(0, e._)(mt||(mt=yi(["",""])),o),n.dataPathArr=[].concat(Vi(h),[n.parentDataProperty]);}function v(e){n.data=e,n.dataLevel=r.dataLevel+1,n.dataTypes=[],r.definedProperties=new Set,n.parentData=r.data,n.dataNames=[].concat(Vi(r.dataNames),[e]);}void 0!==s&&(v(s instanceof e.Name?s:l.let("data",s,!0)),void 0!==u&&(n.propertyName=u)),c&&(n.dataTypes=c);},D2.extendSubschemaMode=function(e,t){var n=t.jtdDiscriminator,r=t.jtdMetadata,i=t.compositeRule,o=t.createErrors,a=t.allErrors;void 0!==i&&(e.compositeRule=i),void 0!==o&&(e.createErrors=o),void 0!==a&&(e.allErrors=a),e.jtdDiscriminator=n,e.jtdMetadata=r;},D2}(),s=v2(),c=w2(),u=L2,l=p2,f=x2();function h(e,t){var n=e.gen,r=e.validateName,i=e.schema,o=e.schemaEnv,a=e.opts;a.code.es5?n.func(r,(0, s._)(gt||(gt=yi(["",", ",""])),c.default.data,c.default.valCxt),o.$async,(function(){n.code((0, s._)(yt||(yt=yi(['"use strict"; ',""])),d(i,a))),function(e,t){e.if(c.default.valCxt,(function(){e.var(c.default.instancePath,(0, s._)(kt||(kt=yi(["",".",""])),c.default.valCxt,c.default.instancePath)),e.var(c.default.parentData,(0, s._)(jt||(jt=yi(["",".",""])),c.default.valCxt,c.default.parentData)),e.var(c.default.parentDataProperty,(0, s._)(St||(St=yi(["",".",""])),c.default.valCxt,c.default.parentDataProperty)),e.var(c.default.rootData,(0, s._)(Ct||(Ct=yi(["",".",""])),c.default.valCxt,c.default.rootData)),t.dynamicRef&&e.var(c.default.dynamicAnchors,(0, s._)($t||($t=yi(["",".",""])),c.default.valCxt,c.default.dynamicAnchors));}),(function(){e.var(c.default.instancePath,(0, s._)(_t||(_t=yi(['""'])))),e.var(c.default.parentData,(0, s._)(Ot||(Ot=yi(["undefined"])))),e.var(c.default.parentDataProperty,(0, s._)(Mt||(Mt=yi(["undefined"])))),e.var(c.default.rootData,c.default.data),t.dynamicRef&&e.var(c.default.dynamicAnchors,(0, s._)(Et||(Et=yi(["{}"]))));}));}(n,a),n.code(t);})):n.func(r,(0, s._)(bt||(bt=yi(["",", ",""])),c.default.data,function(e){return (0, s._)(wt||(wt=yi(["{",'="", ',", ",", ","=","","}={}"])),c.default.instancePath,c.default.parentData,c.default.parentDataProperty,c.default.rootData,c.default.data,e.dynamicRef?(0, s._)(xt||(xt=yi([", ","={}"])),c.default.dynamicAnchors):s.nil)}(a)),o.$async,(function(){return n.code(d(i,a)).code(t)}));}function d(e,t){var n="object"==Ji(e)&&e[t.schemaId];return n&&(t.code.source||t.code.process)?(0, s._)(Lt||(Lt=yi(["/*# sourceURL="," */"])),n):s.nil}function v(t,n){m(t)&&(g(t),p(t))?function(e,t){var n=e.schema,r=e.gen;e.opts.$comment&&n.$comment&&b(e);((function(e){var t=e.schema[e.opts.schemaId];t&&(e.baseId=(0, u.resolveUrl)(e.opts.uriResolver,e.baseId,t));}))(e),function(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}(e);var i=r.const("_errs",c.default.errors);y(e,i),r.var(t,(0, s._)(Bt||(Bt=yi([""," === ",""])),i,c.default.errors));}(t,n):(0, e.boolOrEmptySchema)(t,n);}function p(e){var t=e.schema,n=e.self;if("boolean"==typeof t)return !t;for(var r in t)if(n.RULES.all[r])return !0;return !1}function m(e){return "boolean"!=typeof e.schema}function g(e){(0, l.checkUnknownRules)(e),function(e){var t=e.schema,n=e.errSchemaPath,r=e.opts,i=e.self;t.$ref&&r.ignoreKeywordsWithRef&&(0, l.schemaHasRulesButRef)(t,i.RULES)&&i.logger.warn('$ref: keywords ignored in schema at path "'.concat(n,'"'));}(e);}function y(e,n){if(e.opts.jtd)return w(e,[],!1,n);var r=(0, t.getSchemaTypes)(e.schema);w(e,r,!(0, t.coerceAndCheckDataType)(e,r),n);}function b(e){var t=e.gen,n=e.schemaEnv,r=e.schema,i=e.errSchemaPath,o=e.opts,a=r.$comment;if(!0===o.$comment)t.code((0, s._)(zt||(zt=yi(["",".logger.log(",")"])),c.default.self,a));else if("function"==typeof o.$comment){var u=(0, s.str)(qt||(qt=yi(["","/$comment"])),i),l=t.scopeValue("root",{ref:n.root});t.code((0, s._)(Ft||(Ft=yi(["",".opts.$comment(",", ",", ",".schema)"])),c.default.self,a,u,l));}}function w(e,t,i,o){var a=e.gen,u=e.schema,f=e.data,h=e.allErrors,d=e.opts,v=e.self.RULES;function p(l){(0, n.shouldUseGroup)(u,l)&&(l.type?(a.if((0, r.checkDataType)(l.type,f,d.strictNumbers)),x(e,l),1===t.length&&t[0]===l.type&&i&&(a.else(),(0, r.reportTypeError)(e)),a.endIf()):x(e,l),h||a.if((0, s._)(Gt||(Gt=yi([""," === ",""])),c.default.errors,o||0)));}!u.$ref||!d.ignoreKeywordsWithRef&&(0, l.schemaHasRulesButRef)(u,v)?(d.jtd||function(e,t){if(e.schemaEnv.meta||!e.opts.strictTypes)return;((function(e,t){if(!t.length)return;if(!e.dataTypes.length)return void(e.dataTypes=t);t.forEach((function(t){j(e.dataTypes,t)||S(e,'type "'.concat(t,'" not allowed by context "').concat(e.dataTypes.join(","),'"'));})),function(e,t){var n,r=[],i=wi(e.dataTypes);try{for(i.s();!(n=i.n()).done;){var o=n.value;j(t,o)?r.push(o):t.includes("integer")&&"number"===o&&r.push("integer");}}catch(e){i.e(e);}finally{i.f();}e.dataTypes=r;}(e,t);}))(e,t),e.opts.allowUnionTypes||function(e,t){t.length>1&&(2!==t.length||!t.includes("null"))&&S(e,"use allowUnionTypes to allow union type keyword");}(e,t);!function(e,t){var r=e.self.RULES.all;for(var i in r){var o=r[i];if("object"==Ji(o)&&(0, n.shouldUseRule)(e.schema,o)){var a=o.definition.type;a.length&&!a.some((function(e){return k(t,e)}))&&S(e,'missing type "'.concat(a.join(","),'" for keyword "').concat(i,'"'));}}}(e,e.dataTypes);}(e,t),a.block((function(){var e,t=wi(v.rules);try{for(t.s();!(e=t.n()).done;){p(e.value);}}catch(e){t.e(e);}finally{t.f();}p(v.post);}))):a.block((function(){return $(e,"$ref",v.all.$ref.definition)}));}function x(e,t){var r=e.gen,o=e.schema;e.opts.useDefaults&&(0, i.assignDefaults)(e,t.type),r.block((function(){var r,i=wi(t.rules);try{for(i.s();!(r=i.n()).done;){var a=r.value;(0,n.shouldUseRule)(o,a)&&$(e,a.keyword,a.definition,t.type);}}catch(e){i.e(e);}finally{i.f();}}));}function k(e,t){return e.includes(t)||"number"===t&&e.includes("integer")}function j(e,t){return e.includes(t)||"integer"===t&&e.includes("number")}function S(e,t){var n=e.schemaEnv.baseId+e.errSchemaPath;t+=' at "'.concat(n,'" (strictTypes)'),(0, l.checkStrictMode)(e,t,e.opts.strictTypes);}i2.validateFunctionCode=function(t){m(t)&&(g(t),p(t))?function(e){var t=e.schema,n=e.opts,r=e.gen;h(e,(function(){n.$comment&&t.$comment&&b(e),function(e){var t=e.schema,n=e.opts;void 0!==t.default&&n.useDefaults&&n.strictSchema&&(0, l.checkStrictMode)(e,"default is ignored in the schema root");}(e),r.let(c.default.vErrors,null),r.let(c.default.errors,0),n.unevaluated&&function(e){var t=e.gen,n=e.validateName;e.evaluated=t.const("evaluated",(0, s._)(At||(At=yi(["",".evaluated"])),n)),t.if((0, s._)(Pt||(Pt=yi(["",".dynamicProps"])),e.evaluated),(function(){return t.assign((0, s._)(Tt||(Tt=yi(["",".props"])),e.evaluated),(0, s._)(Rt||(Rt=yi(["undefined"]))))})),t.if((0, s._)(Nt||(Nt=yi(["",".dynamicItems"])),e.evaluated),(function(){return t.assign((0, s._)(It||(It=yi(["",".items"])),e.evaluated),(0, s._)(Dt||(Dt=yi(["undefined"]))))}));}(e),y(e),function(e){var t=e.gen,n=e.schemaEnv,r=e.validateName,i=e.ValidationError,o=e.opts;n.$async?t.if((0, s._)(Vt||(Vt=yi([""," === 0"])),c.default.errors),(function(){return t.return(c.default.data)}),(function(){return t.throw((0, s._)(Wt||(Wt=yi(["new ","(",")"])),i,c.default.vErrors))})):(t.assign((0, s._)(Ht||(Ht=yi(["",".errors"])),r),c.default.vErrors),o.unevaluated&&function(e){var t=e.gen,n=e.evaluated,r=e.props,i=e.items;r instanceof s.Name&&t.assign((0, s._)(Jt||(Jt=yi(["",".props"])),n),r);i instanceof s.Name&&t.assign((0, s._)(Kt||(Kt=yi(["",".items"])),n),i);}(e),t.return((0, s._)(Ut||(Ut=yi([""," === 0"])),c.default.errors)));}(e);}));}(t):h(t,(function(){return (0, e.topBoolOrEmptySchema)(t)}));};var C=function(){function e(t,n,r){if(Bi(this,e),(0, o.validateKeywordUsage)(t,n,r),this.gen=t.gen,this.allErrors=t.allErrors,this.keyword=r,this.data=t.data,this.schema=t.schema[r],this.$data=n.$data&&t.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0, l.schemaRefOrVal)(t,this.schema,r,this.$data),this.schemaType=n.schemaType,this.parentSchema=t.schema,this.params={},this.it=t,this.def=n,this.$data)this.schemaCode=t.gen.const("vSchema",M(this.$data,t));else if(this.schemaCode=this.schemaValue,!(0, o.validSchemaType)(this.schema,n.schemaType,n.allowUndefined))throw new Error("".concat(r," value must be ").concat(JSON.stringify(n.schemaType)));("code"in n?n.trackErrors:!1!==n.errors)&&(this.errsCount=t.gen.const("_errs",c.default.errors));}return qi(e,[{key:"result",value:function(e,t,n){this.failResult((0, s.not)(e),t,n);}},{key:"failResult",value:function(e,t,n){this.gen.if(e),n?n():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else();}},{key:"pass",value:function(e,t){this.failResult((0, s.not)(e),void 0,t);}},{key:"fail",value:function(e){if(void 0===e)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else();}},{key:"fail$data",value:function(e){if(!this.$data)return this.fail(e);var t=this.schemaCode;this.fail((0, s._)(Qt||(Qt=yi([""," !== undefined && (",")"])),t,(0, s.or)(this.invalid$data(),e)));}},{key:"error",value:function(e,t,n){if(t)return this.setParams(t),this._error(e,n),void this.setParams({});this._error(e,n);}},{key:"_error",value:function(e,t){(e?f.reportExtraError:f.reportError)(this,this.def.error,t);}},{key:"$dataError",value:function(){(0, f.reportError)(this,this.def.$dataError||f.keyword$DataError);}},{key:"reset",value:function(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');(0, f.resetErrorsCount)(this.gen,this.errsCount);}},{key:"ok",value:function(e){this.allErrors||this.gen.if(e);}},{key:"setParams",value:function(e,t){t?Object.assign(this.params,e):this.params=e;}},{key:"block$data",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.nil;this.gen.block((function(){n.check$data(e,r),t();}));}},{key:"check$data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.nil,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.nil;if(this.$data){var n=this.gen,r=this.schemaCode,i=this.schemaType,o=this.def;n.if((0, s.or)((0, s._)(Yt||(Yt=yi([""," === undefined"])),r),t)),e!==s.nil&&n.assign(e,!0),(i.length||o.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==s.nil&&n.assign(e,!1)),n.else();}}},{key:"invalid$data",value:function(){var e=this.gen,t=this.schemaCode,n=this.schemaType,i=this.def,o=this.it;return (0, s.or)(function(){if(n.length){if(!(t instanceof s.Name))throw new Error("ajv implementation error");var e=Array.isArray(n)?n:[n];return (0, s._)(Xt||(Xt=yi(["",""])),(0, r.checkDataTypes)(e,t,o.opts.strictNumbers,r.DataType.Wrong))}return s.nil}(),function(){if(i.validateSchema){var n=e.scopeValue("validate$data",{ref:i.validateSchema});return (0, s._)(Zt||(Zt=yi(["!","(",")"])),n,t)}return s.nil}())}},{key:"subschema",value:function(e,t){var n=(0, a.getSubschema)(this.it,e);(0, a.extendSubschemaData)(n,this.it,e),(0, a.extendSubschemaMode)(n,e);var r=Oi(Oi(Oi({},this.it),n),{},{items:void 0,props:void 0});return v(r,t),r}},{key:"mergeEvaluated",value:function(e,t){var n=this.it,r=this.gen;n.opts.unevaluated&&(!0!==n.props&&void 0!==e.props&&(n.props=l.mergeEvaluated.props(r,e.props,n.props,t)),!0!==n.items&&void 0!==e.items&&(n.items=l.mergeEvaluated.items(r,e.items,n.items,t)));}},{key:"mergeValidEvaluated",value:function(e,t){var n=this,r=this.it,i=this.gen;if(r.opts.unevaluated&&(!0!==r.props||!0!==r.items))return i.if(t,(function(){return n.mergeEvaluated(e,s.Name)})),!0}}]),e}();function $(e,t,n,r){var i=new C(e,n,t);"code"in n?n.code(i,r):i.$data&&n.validate?(0, o.funcKeywordCode)(i,n):"macro"in n?(0, o.macroKeywordCode)(i,n):(n.compile||n.validate)&&(0, o.funcKeywordCode)(i,n);}i2.KeywordCxt=C;var _=/^\/(?:[^~]|~0|~1)*$/,O=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function M(e,t){var n,r,i=t.dataLevel,o=t.dataNames,a=t.dataPathArr;if(""===e)return c.default.rootData;if("/"===e[0]){if(!_.test(e))throw new Error("Invalid JSON-pointer: ".concat(e));n=e,r=c.default.rootData;}else {var u=O.exec(e);if(!u)throw new Error("Invalid JSON-pointer: ".concat(e));var f=+u[1];if("#"===(n=u[2])){if(f>=i)throw new Error(m("property/index",f));return a[i-f]}if(f>i)throw new Error(m("data",f));if(r=o[i-f],!n)return r}var h,d=r,v=wi(n.split("/"));try{for(v.s();!(h=v.n()).done;){var p=h.value;p&&(r=(0,s._)(en||(en=yi(["","",""])),r,(0,s.getProperty)((0,l.unescapeJsonPointer)(p))),d=(0,s._)(tn||(tn=yi([""," && ",""])),d,r));}}catch(e){v.e(e);}finally{v.f();}return d;function m(e,t){return "Cannot access ".concat(e," ").concat(t," levels up, current level is ").concat(i)}}return i2.getData=M,i2}L2.getSchemaRefs=function(e,t){var n=this;if("boolean"==typeof e)return {};var r=this.opts,i=r.schemaId,o=r.uriResolver,a=e3(e[i]||t),s={"":a},c=Y2(o,a,!1),u={},l=new Set;return U2(e,{allKeys:!0},(function(e,t,r,o){if(void 0!==o){var a=c+t,d=s[o];"string"==typeof e[i]&&(d=v.call(n,e[i])),p.call(n,e.$anchor),p.call(n,e.$dynamicAnchor),s[t]=d;}function v(t){var n=this.opts.uriResolver.resolve;if(t=e3(d?n(d,t):t),l.has(t))throw h(t);l.add(t);var r=this.refs[t];return "string"==typeof r&&(r=this.refs[r]),"object"==Ji(r)?f(e,r.schema,t):t!==e3(a)&&("#"===t[0]?(f(e,u[t],t),u[t]=e):this.refs[t]=a),t}function p(e){if("string"==typeof e){if(!n3.test(e))throw new Error('invalid anchor "'.concat(e,'"'));v.call(this,"#".concat(e));}}})),u;function f(e,t,n){if(void 0!==t&&!H2(e,t))throw h(n)}function h(e){return new Error('reference "'.concat(e,'" resolves to more than one schema'))}};var i3,o3={};function a3(){if(i3)return o3;i3=1,Object.defineProperty(o3,"__esModule",{value:!0});var e=function(e){Pi(n,mi(Error));var t=Ri(n);function n(e){var r;return Bi(this,n),(r=t.call(this,"validation failed")).errors=e,r.ajv=r.validation=!0,r}return qi(n)}();return o3.default=e,o3}var s3,c3={};function u3(){if(s3)return c3;s3=1,Object.defineProperty(c3,"__esModule",{value:!0});var e=L2,t=function(t){Pi(r,mi(Error));var n=Ri(r);function r(t,i,o,a){var s;return Bi(this,r),(s=n.call(this,a||"can't resolve reference ".concat(o," from id ").concat(i))).missingRef=(0, e.resolveUrl)(t,i,o),s.missingSchema=(0, e.normalizeId)((0, e.getFullPath)(t,s.missingRef)),s}return qi(r)}();return c3.default=t,c3}var l3={};Object.defineProperty(l3,"__esModule",{value:!0}),l3.resolveSchema=l3.getCompilingSchema=l3.resolveRef=l3.compileSchema=l3.SchemaEnv=void 0;var f3=v2(),h3=a3(),d3=w2(),v3=L2,p3=p2,m3=r3(),g3=qi((function e(t){var n,r;Bi(this,e),this.refs={},this.dynamicAnchors={},"object"==Ji(t.schema)&&(r=t.schema),this.schema=t.schema,this.schemaId=t.schemaId,this.root=t.root||this,this.baseId=null!==(n=t.baseId)&&void 0!==n?n:(0, v3.normalizeId)(null==r?void 0:r[t.schemaId||"$id"]),this.schemaPath=t.schemaPath,this.localRefs=t.localRefs,this.meta=t.meta,this.$async=null==r?void 0:r.$async,this.refs={};}));function y3(e){var t=w3.call(this,e);if(t)return t;var n,r=(0, v3.getFullPath)(this.opts.uriResolver,e.root.baseId),i=this.opts.code,o=i.es5,a=i.lines,s=this.opts.ownProperties,c=new f3.CodeGen(this.scope,{es5:o,lines:a,ownProperties:s});e.$async&&(n=c.scopeValue("Error",{ref:h3.default,code:(0, f3._)(nn||(nn=yi(['require("ajv/dist/runtime/validation_error").default'])))}));var u=c.scopeName("validate");e.validateName=u;var l,f={gen:c,allErrors:this.opts.allErrors,data:d3.default.data,parentData:d3.default.parentData,parentDataProperty:d3.default.parentDataProperty,dataNames:[d3.default.data],dataPathArr:[f3.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:c.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:(0, f3.stringify)(e.schema)}:{ref:e.schema}),validateName:u,ValidationError:n,schema:e.schema,schemaEnv:e,rootId:r,baseId:e.baseId||r,schemaPath:f3.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0, f3._)(rn||(rn=yi(['""']))),opts:this.opts,self:this};try{this._compilations.add(e),(0,m3.validateFunctionCode)(f),c.optimize(this.opts.code.optimize);var h=c.toString();l="".concat(c.scopeRefs(d3.default.scope),"return ").concat(h),this.opts.code.process&&(l=this.opts.code.process(l,e));var d=new Function("".concat(d3.default.self),"".concat(d3.default.scope),l)(this,this.scope.get());if(this.scope.value(u,{ref:d}),d.errors=null,d.schema=e.schema,d.schemaEnv=e,e.$async&&(d.$async=!0),!0===this.opts.code.source&&(d.source={validateName:u,validateCode:h,scopeValues:c._values}),this.opts.unevaluated){var v=f.props,p=f.items;d.evaluated={props:v instanceof f3.Name?void 0:v,items:p instanceof f3.Name?void 0:p,dynamicProps:v instanceof f3.Name,dynamicItems:p instanceof f3.Name},d.source&&(d.source.evaluated=(0,f3.stringify)(d.evaluated));}return e.validate=d,e}catch(t){throw delete e.validate,delete e.validateName,l&&this.logger.error("Error compiling schema, function code:",l),t}finally{this._compilations.delete(e);}}function b3(e){return (0, v3.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:y3.call(this,e)}function w3(e){var t,n,r,i=wi(this._compilations);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(r=e,(n=o).schema===r.schema&&n.root===r.root&&n.baseId===r.baseId)return o}}catch(e){i.e(e);}finally{i.f();}}function x3(e,t){for(var n;"string"==typeof(n=this.refs[t]);)t=n;return n||this.schemas[t]||k3.call(this,e,t)}function k3(e,t){var n=this.opts.uriResolver.parse(t),r=(0, v3._getFullPath)(this.opts.uriResolver,n),i=(0, v3.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&r===i)return S3.call(this,n,e);var o=(0, v3.normalizeId)(r),a=this.refs[o]||this.schemas[o];if("string"==typeof a){var s=k3.call(this,e,a);if("object"!==Ji(null==s?void 0:s.schema))return;return S3.call(this,n,s)}if("object"===Ji(null==a?void 0:a.schema)){if(a.validate||y3.call(this,a),o===(0, v3.normalizeId)(t)){var c=a.schema,u=this.opts.schemaId,l=c[u];return l&&(i=(0, v3.resolveUrl)(this.opts.uriResolver,i,l)),new g3({schema:c,schemaId:u,root:e,baseId:i})}return S3.call(this,n,a)}}l3.SchemaEnv=g3,l3.compileSchema=y3,l3.resolveRef=function(e,t,n){var r;n=(0, v3.resolveUrl)(this.opts.uriResolver,t,n);var i=e.refs[n];if(i)return i;var o=x3.call(this,e,n);if(void 0===o){var a=null===(r=e.localRefs)||void 0===r?void 0:r[n],s=this.opts.schemaId;a&&(o=new g3({schema:a,schemaId:s,root:e,baseId:t}));}return void 0!==o?e.refs[n]=b3.call(this,o):void 0},l3.getCompilingSchema=w3,l3.resolveSchema=k3;var j3=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function S3(e,t){var n,r=t.baseId,i=t.schema,o=t.root;if("/"===(null===(n=e.fragment)||void 0===n?void 0:n[0])){var a,s,c=wi(e.fragment.slice(1).split("/"));try{for(c.s();!(a=c.n()).done;){var u=a.value;if("boolean"==typeof i)return;var l=i[(0,p3.unescapeFragment)(u)];if(void 0===l)return;var f="object"===Ji(i=l)&&i[this.opts.schemaId];!j3.has(u)&&f&&(r=(0,v3.resolveUrl)(this.opts.uriResolver,r,f));}}catch(e){c.e(e);}finally{c.f();}if("boolean"!=typeof i&&i.$ref&&!(0, p3.schemaHasRulesButRef)(i,this.RULES)){var h=(0, v3.resolveUrl)(this.opts.uriResolver,r,i.$ref);s=k3.call(this,o,h);}var d=this.opts.schemaId;return (s=s||new g3({schema:i,schemaId:d,root:o,baseId:r})).schema!==s.root.schema?s:void 0}}var C3={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1},$3={},_3={exports:{}};!function(e){function t(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t.length>1){t[0]=t[0].slice(0,-1);for(var r=t.length-1,i=1;i<r;++i)t[i]=t[i].slice(1,-1);return t[r]=t[r].slice(1),t.join("")}return t[0]}function n(e){return "(?:"+e+")"}function r(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function i(e){return e.toUpperCase()}function o(e){return null!=e?e instanceof Array?e:"number"!=typeof e.length||e.split||e.setInterval||e.call?[e]:Array.prototype.slice.call(e):[]}function a(e,t){var n=e;if(t)for(var r in t)n[r]=t[r];return n}function s(e){var r="[A-Za-z]",i="[0-9]",o=t(i,"[A-Fa-f]"),a=n(n("%[EFef]"+o+"%"+o+o+"%"+o+o)+"|"+n("%[89A-Fa-f]"+o+"%"+o+o)+"|"+n("%"+o+o)),s="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",c=t("[\\:\\/\\?\\#\\[\\]\\@]",s),u=e?"[\\uE000-\\uF8FF]":"[]",l=t(r,i,"[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]");n(r+t(r,i,"[\\+\\-\\.]")+"*"),n(n(a+"|"+t(l,s,"[\\:]"))+"*");var f=n(n("25[0-5]")+"|"+n("2[0-4]"+i)+"|"+n("1"+i+i)+"|"+n("0?[1-9]"+i)+"|0?0?"+i),h=n(f+"\\."+f+"\\."+f+"\\."+f),d=n(o+"{1,4}"),v=n(n(d+"\\:"+d)+"|"+h),p=n(n(d+"\\:")+"{6}"+v),m=n("\\:\\:"+n(d+"\\:")+"{5}"+v),g=n(n(d)+"?\\:\\:"+n(d+"\\:")+"{4}"+v),y=n(n(n(d+"\\:")+"{0,1}"+d)+"?\\:\\:"+n(d+"\\:")+"{3}"+v),b=n(n(n(d+"\\:")+"{0,2}"+d)+"?\\:\\:"+n(d+"\\:")+"{2}"+v),w=n(n(n(d+"\\:")+"{0,3}"+d)+"?\\:\\:"+d+"\\:"+v),x=n(n(n(d+"\\:")+"{0,4}"+d)+"?\\:\\:"+v),k=n(n(n(d+"\\:")+"{0,5}"+d)+"?\\:\\:"+d),j=n(n(n(d+"\\:")+"{0,6}"+d)+"?\\:\\:"),S=n([p,m,g,y,b,w,x,k,j].join("|")),C=n(n(l+"|"+a)+"+");n("[vV]"+o+"+\\."+t(l,s,"[\\:]")+"+"),n(n(a+"|"+t(l,s))+"*");var $=n(a+"|"+t(l,s,"[\\:\\@]"));return n(n(a+"|"+t(l,s,"[\\@]"))+"+"),n(n($+"|"+t("[\\/\\?]",u))+"*"),{NOT_SCHEME:new RegExp(t("[^]",r,i,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",l,s),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",l,s),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",l,s),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",l,s),"g"),NOT_QUERY:new RegExp(t("[^\\%]",l,s,"[\\:\\@\\/\\?]",u),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",l,s,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",l,s),"g"),UNRESERVED:new RegExp(l,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",l,c),"g"),PCT_ENCODED:new RegExp(a,"g"),IPV4ADDRESS:new RegExp("^("+h+")$"),IPV6ADDRESS:new RegExp("^\\[?("+S+")"+n(n("\\%25|\\%(?!"+o+"{2})")+"("+C+")")+"?\\]?$")}}var c=s(!1),u=s(!0),l=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e;}finally{try{!r&&s.return&&s.return();}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},h=2147483647,d=36,v=1,p=26,m=38,g=700,y=72,b=128,w="-",x=/^xn--/,k=/[^\0-\x7E]/,j=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},C=d-v,$=Math.floor,_=String.fromCharCode;function O(e){throw new RangeError(S[e])}function M(e,t){for(var n=[],r=e.length;r--;)n[r]=t(e[r]);return n}function E(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+M((e=e.replace(j,".")).split("."),t).join(".")}function A(e){for(var t=[],n=0,r=e.length;n<r;){var i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){var o=e.charCodeAt(n++);56320==(64512&o)?t.push(((1023&i)<<10)+(1023&o)+65536):(t.push(i),n--);}else t.push(i);}return t}var P=function(e){return String.fromCodePoint.apply(String,f(e))},T=function(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:d},R=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},N=function(e,t,n){var r=0;for(e=n?$(e/g):e>>1,e+=$(e/t);e>C*p>>1;r+=d)e=$(e/C);return $(r+(C+1)*e/(e+m))},I=function(e){var t=[],n=e.length,r=0,i=b,o=y,a=e.lastIndexOf(w);a<0&&(a=0);for(var s=0;s<a;++s)e.charCodeAt(s)>=128&&O("not-basic"),t.push(e.charCodeAt(s));for(var c=a>0?a+1:0;c<n;){for(var u=r,l=1,f=d;;f+=d){c>=n&&O("invalid-input");var m=T(e.charCodeAt(c++));(m>=d||m>$((h-r)/l))&&O("overflow"),r+=m*l;var g=f<=o?v:f>=o+p?p:f-o;if(m<g)break;var x=d-g;l>$(h/x)&&O("overflow"),l*=x;}var k=t.length+1;o=N(r-u,k,0==u),$(r/k)>h-i&&O("overflow"),i+=$(r/k),r%=k,t.splice(r++,0,i);}return String.fromCodePoint.apply(String,t)},D=function(e){var t=[],n=(e=A(e)).length,r=b,i=0,o=y,a=!0,s=!1,c=void 0;try{for(var u,l=e[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var f=u.value;f<128&&t.push(_(f));}}catch(e){s=!0,c=e;}finally{try{!a&&l.return&&l.return();}finally{if(s)throw c}}var m=t.length,g=m;for(m&&t.push(w);g<n;){var x=h,k=!0,j=!1,S=void 0;try{for(var C,M=e[Symbol.iterator]();!(k=(C=M.next()).done);k=!0){var E=C.value;E>=r&&E<x&&(x=E);}}catch(e){j=!0,S=e;}finally{try{!k&&M.return&&M.return();}finally{if(j)throw S}}var P=g+1;x-r>$((h-i)/P)&&O("overflow"),i+=(x-r)*P,r=x;var T=!0,I=!1,D=void 0;try{for(var L,B=e[Symbol.iterator]();!(T=(L=B.next()).done);T=!0){var z=L.value;if(z<r&&++i>h&&O("overflow"),z==r){for(var q=i,F=d;;F+=d){var V=F<=o?v:F>=o+p?p:F-o;if(q<V)break;var W=q-V,H=d-V;t.push(_(R(V+W%H,0))),q=$(W/H);}t.push(_(R(q,0))),o=N(i,P,g==m),i=0,++g;}}}catch(e){I=!0,D=e;}finally{try{!T&&B.return&&B.return();}finally{if(I)throw D}}++i,++r;}return t.join("")},L=function(e){return E(e,(function(e){return x.test(e)?I(e.slice(4).toLowerCase()):e}))},B=function(e){return E(e,(function(e){return k.test(e)?"xn--"+D(e):e}))},z={version:"2.1.0",ucs2:{decode:A,encode:P},decode:I,encode:D,toASCII:B,toUnicode:L},q={};function F(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function V(e){for(var t="",n=0,r=e.length;n<r;){var i=parseInt(e.substr(n+1,2),16);if(i<128)t+=String.fromCharCode(i),n+=3;else if(i>=194&&i<224){if(r-n>=6){var o=parseInt(e.substr(n+4,2),16);t+=String.fromCharCode((31&i)<<6|63&o);}else t+=e.substr(n,6);n+=6;}else if(i>=224){if(r-n>=9){var a=parseInt(e.substr(n+4,2),16),s=parseInt(e.substr(n+7,2),16);t+=String.fromCharCode((15&i)<<12|(63&a)<<6|63&s);}else t+=e.substr(n,9);n+=9;}else t+=e.substr(n,3),n+=3;}return t}function W(e,t){function n(e){var n=V(e);return n.match(t.UNRESERVED)?n:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,n).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,n).replace(t.NOT_USERINFO,F).replace(t.PCT_ENCODED,i)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,n).toLowerCase().replace(t.NOT_HOST,F).replace(t.PCT_ENCODED,i)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,n).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,F).replace(t.PCT_ENCODED,i)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,n).replace(t.NOT_QUERY,F).replace(t.PCT_ENCODED,i)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,n).replace(t.NOT_FRAGMENT,F).replace(t.PCT_ENCODED,i)),e}function H(e){return e.replace(/^0*(.*)/,"$1")||"0"}function U(e,t){var n=e.match(t.IPV4ADDRESS)||[],r=l(n,2)[1];return r?r.split(".").map(H).join("."):e}function J(e,t){var n=e.match(t.IPV6ADDRESS)||[],r=l(n,3),i=r[1],o=r[2];if(i){for(var a=i.toLowerCase().split("::").reverse(),s=l(a,2),c=s[0],u=s[1],f=u?u.split(":").map(H):[],h=c.split(":").map(H),d=t.IPV4ADDRESS.test(h[h.length-1]),v=d?7:8,p=h.length-v,m=Array(v),g=0;g<v;++g)m[g]=f[g]||h[p+g]||"";d&&(m[v-1]=U(m[v-1],t));var y=m.reduce((function(e,t,n){if(!t||"0"===t){var r=e[e.length-1];r&&r.index+r.length===n?r.length++:e.push({index:n,length:1});}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],b=void 0;if(y&&y.length>1){var w=m.slice(0,y.index),x=m.slice(y.index+y.length);b=w.join(":")+"::"+x.join(":");}else b=m.join(":");return o&&(b+="%"+o),b}return e}var K=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,G=void 0==="".match(/(){0}/)[1];function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},r=!1!==t.iri?u:c;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var i=e.match(K);if(i){G?(n.scheme=i[1],n.userinfo=i[3],n.host=i[4],n.port=parseInt(i[5],10),n.path=i[6]||"",n.query=i[7],n.fragment=i[8],isNaN(n.port)&&(n.port=i[5])):(n.scheme=i[1]||void 0,n.userinfo=-1!==e.indexOf("@")?i[3]:void 0,n.host=-1!==e.indexOf("//")?i[4]:void 0,n.port=parseInt(i[5],10),n.path=i[6]||"",n.query=-1!==e.indexOf("?")?i[7]:void 0,n.fragment=-1!==e.indexOf("#")?i[8]:void 0,isNaN(n.port)&&(n.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?i[4]:void 0)),n.host&&(n.host=J(U(n.host,r),r)),void 0!==n.scheme||void 0!==n.userinfo||void 0!==n.host||void 0!==n.port||n.path||void 0!==n.query?void 0===n.scheme?n.reference="relative":void 0===n.fragment?n.reference="absolute":n.reference="uri":n.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==n.reference&&(n.error=n.error||"URI is not a "+t.reference+" reference.");var o=q[(t.scheme||n.scheme||"").toLowerCase()];if(t.unicodeSupport||o&&o.unicodeSupport)W(n,r);else {if(n.host&&(t.domainHost||o&&o.domainHost))try{n.host=z.toASCII(n.host.replace(r.PCT_ENCODED,V).toLowerCase());}catch(e){n.error=n.error||"Host's domain name can not be converted to ASCII via punycode: "+e;}W(n,c);}o&&o.parse&&o.parse(n,t);}else n.error=n.error||"URI can not be parsed.";return n}function Y(e,t){var n=!1!==t.iri?u:c,r=[];return void 0!==e.userinfo&&(r.push(e.userinfo),r.push("@")),void 0!==e.host&&r.push(J(U(String(e.host),n),n).replace(n.IPV6ADDRESS,(function(e,t,n){return "["+t+(n?"%25"+n:"")+"]"}))),"number"!=typeof e.port&&"string"!=typeof e.port||(r.push(":"),r.push(String(e.port))),r.length?r.join(""):void 0}var X=/^\.\.?\//,Z=/^\/\.(\/|$)/,ee=/^\/\.\.(\/|$)/,te=/^\/?(?:.|\n)*?(?=\/|$)/;function ne(e){for(var t=[];e.length;)if(e.match(X))e=e.replace(X,"");else if(e.match(Z))e=e.replace(Z,"/");else if(e.match(ee))e=e.replace(ee,"/"),t.pop();else if("."===e||".."===e)e="";else {var n=e.match(te);if(!n)throw new Error("Unexpected dot segment condition");var r=n[0];e=e.slice(r.length),t.push(r);}return t.join("")}function re(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.iri?u:c,r=[],i=q[(t.scheme||e.scheme||"").toLowerCase()];if(i&&i.serialize&&i.serialize(e,t),e.host)if(n.IPV6ADDRESS.test(e.host));else if(t.domainHost||i&&i.domainHost)try{e.host=t.iri?z.toUnicode(e.host):z.toASCII(e.host.replace(n.PCT_ENCODED,V).toLowerCase());}catch(n){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+n;}W(e,n),"suffix"!==t.reference&&e.scheme&&(r.push(e.scheme),r.push(":"));var o=Y(e,t);if(void 0!==o&&("suffix"!==t.reference&&r.push("//"),r.push(o),e.path&&"/"!==e.path.charAt(0)&&r.push("/")),void 0!==e.path){var a=e.path;t.absolutePath||i&&i.absolutePath||(a=ne(a)),void 0===o&&(a=a.replace(/^\/\//,"/%2F")),r.push(a);}return void 0!==e.query&&(r.push("?"),r.push(e.query)),void 0!==e.fragment&&(r.push("#"),r.push(e.fragment)),r.join("")}function ie(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={};return arguments[3]||(e=Q(re(e,n),n),t=Q(re(t,n),n)),!(n=n||{}).tolerant&&t.scheme?(r.scheme=t.scheme,r.userinfo=t.userinfo,r.host=t.host,r.port=t.port,r.path=ne(t.path||""),r.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(r.userinfo=t.userinfo,r.host=t.host,r.port=t.port,r.path=ne(t.path||""),r.query=t.query):(t.path?("/"===t.path.charAt(0)?r.path=ne(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?r.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:r.path=t.path:r.path="/"+t.path,r.path=ne(r.path)),r.query=t.query):(r.path=e.path,void 0!==t.query?r.query=t.query:r.query=e.query),r.userinfo=e.userinfo,r.host=e.host,r.port=e.port),r.scheme=e.scheme),r.fragment=t.fragment,r}function oe(e,t,n){var r=a({scheme:"null"},n);return re(ie(Q(e,r),Q(t,r),r,!0),r)}function ae(e,t){return "string"==typeof e?e=re(Q(e,t),t):"object"===r(e)&&(e=Q(re(e,t),t)),e}function se(e,t,n){return "string"==typeof e?e=re(Q(e,n),n):"object"===r(e)&&(e=re(e,n)),"string"==typeof t?t=re(Q(t,n),n):"object"===r(t)&&(t=re(t,n)),e===t}function ce(e,t){return e&&e.toString().replace(t&&t.iri?u.ESCAPE:c.ESCAPE,F)}function ue(e,t){return e&&e.toString().replace(t&&t.iri?u.PCT_ENCODED:c.PCT_ENCODED,V)}var le={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){var n="https"===String(e.scheme).toLowerCase();return e.port!==(n?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},fe={scheme:"https",domainHost:le.domainHost,parse:le.parse,serialize:le.serialize};function he(e){return "boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}var de={scheme:"ws",domainHost:!0,parse:function(e,t){var n=e;return n.secure=he(n),n.resourceName=(n.path||"/")+(n.query?"?"+n.query:""),n.path=void 0,n.query=void 0,n},serialize:function(e,t){if(e.port!==(he(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){var n=e.resourceName.split("?"),r=l(n,2),i=r[0],o=r[1];e.path=i&&"/"!==i?i:void 0,e.query=o,e.resourceName=void 0;}return e.fragment=void 0,e}},ve={scheme:"wss",domainHost:de.domainHost,parse:de.parse,serialize:de.serialize},pe={},me="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",ge="[0-9A-Fa-f]",ye=n(n("%[EFef]"+ge+"%"+ge+ge+"%"+ge+ge)+"|"+n("%[89A-Fa-f]"+ge+"%"+ge+ge)+"|"+n("%"+ge+ge)),be="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",we=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),xe="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",ke=new RegExp(me,"g"),je=new RegExp(ye,"g"),Se=new RegExp(t("[^]",be,"[\\.]",'[\\"]',we),"g"),Ce=new RegExp(t("[^]",me,xe),"g"),$e=Ce;function _e(e){var t=V(e);return t.match(ke)?t:e}var Oe={scheme:"mailto",parse:function(e,t){var n=e,r=n.to=n.path?n.path.split(","):[];if(n.path=void 0,n.query){for(var i=!1,o={},a=n.query.split("&"),s=0,c=a.length;s<c;++s){var u=a[s].split("=");switch(u[0]){case"to":for(var l=u[1].split(","),f=0,h=l.length;f<h;++f)r.push(l[f]);break;case"subject":n.subject=ue(u[1],t);break;case"body":n.body=ue(u[1],t);break;default:i=!0,o[ue(u[0],t)]=ue(u[1],t);}}i&&(n.headers=o);}n.query=void 0;for(var d=0,v=r.length;d<v;++d){var p=r[d].split("@");if(p[0]=ue(p[0]),t.unicodeSupport)p[1]=ue(p[1],t).toLowerCase();else try{p[1]=z.toASCII(ue(p[1],t).toLowerCase());}catch(e){n.error=n.error||"Email address's domain name can not be converted to ASCII via punycode: "+e;}r[d]=p.join("@");}return n},serialize:function(e,t){var n=e,r=o(e.to);if(r){for(var a=0,s=r.length;a<s;++a){var c=String(r[a]),u=c.lastIndexOf("@"),l=c.slice(0,u).replace(je,_e).replace(je,i).replace(Se,F),f=c.slice(u+1);try{f=t.iri?z.toUnicode(f):z.toASCII(ue(f,t).toLowerCase());}catch(e){n.error=n.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e;}r[a]=l+"@"+f;}n.path=r.join(",");}var h=e.headers=e.headers||{};e.subject&&(h.subject=e.subject),e.body&&(h.body=e.body);var d=[];for(var v in h)h[v]!==pe[v]&&d.push(v.replace(je,_e).replace(je,i).replace(Ce,F)+"="+h[v].replace(je,_e).replace(je,i).replace($e,F));return d.length&&(n.query=d.join("&")),n}},Me=/^([^\:]+)\:(.*)/,Ee={scheme:"urn",parse:function(e,t){var n=e.path&&e.path.match(Me),r=e;if(n){var i=t.scheme||r.scheme||"urn",o=n[1].toLowerCase(),a=n[2],s=i+":"+(t.nid||o),c=q[s];r.nid=o,r.nss=a,r.path=void 0,c&&(r=c.parse(r,t));}else r.error=r.error||"URN can not be parsed.";return r},serialize:function(e,t){var n=t.scheme||e.scheme||"urn",r=e.nid,i=n+":"+(t.nid||r),o=q[i];o&&(e=o.serialize(e,t));var a=e,s=e.nss;return a.path=(r||t.nid)+":"+s,a}},Ae=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Pe={scheme:"urn:uuid",parse:function(e,t){var n=e;return n.uuid=n.nss,n.nss=void 0,t.tolerant||n.uuid&&n.uuid.match(Ae)||(n.error=n.error||"UUID is not valid."),n},serialize:function(e,t){var n=e;return n.nss=(e.uuid||"").toLowerCase(),n}};q[le.scheme]=le,q[fe.scheme]=fe,q[de.scheme]=de,q[ve.scheme]=ve,q[Oe.scheme]=Oe,q[Ee.scheme]=Ee,q[Pe.scheme]=Pe,e.SCHEMES=q,e.pctEncChar=F,e.pctDecChars=V,e.parse=Q,e.removeDotSegments=ne,e.serialize=re,e.resolveComponents=ie,e.resolve=oe,e.normalize=ae,e.equal=se,e.escapeComponent=ce,e.unescapeComponent=ue,Object.defineProperty(e,"__esModule",{value:!0});}(_3.exports);var O3=_3.exports;Object.defineProperty($3,"__esModule",{value:!0});var M3=O3;M3.code='require("ajv/dist/runtime/uri").default',$3.default=M3,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=r3();Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var n=v2();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return n.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return n.CodeGen}});var r=a3(),i=u3(),o=j2,a=l3,s=v2(),c=L2,u=k2,l=p2,f=C3,h=$3,d=function(e,t){return new RegExp(e,t)};d.code="new RegExp";var v=["removeAdditional","useDefaults","coerceTypes"],p=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),m={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},g={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function y(e){var t,n,r,i,o,a,s,c,u,l,f,v,p,m,g,y,b,w,x,k,j,S,C,$,_,O=e.strict,M=null===(t=e.code)||void 0===t?void 0:t.optimize,E=!0===M||void 0===M?1:M||0,A=null!==(r=null===(n=e.code)||void 0===n?void 0:n.regExp)&&void 0!==r?r:d,P=null!==(i=e.uriResolver)&&void 0!==i?i:h.default;return {strictSchema:null===(a=null!==(o=e.strictSchema)&&void 0!==o?o:O)||void 0===a||a,strictNumbers:null===(c=null!==(s=e.strictNumbers)&&void 0!==s?s:O)||void 0===c||c,strictTypes:null!==(l=null!==(u=e.strictTypes)&&void 0!==u?u:O)&&void 0!==l?l:"log",strictTuples:null!==(v=null!==(f=e.strictTuples)&&void 0!==f?f:O)&&void 0!==v?v:"log",strictRequired:null!==(m=null!==(p=e.strictRequired)&&void 0!==p?p:O)&&void 0!==m&&m,code:e.code?Oi(Oi({},e.code),{},{optimize:E,regExp:A}):{optimize:E,regExp:A},loopRequired:null!==(g=e.loopRequired)&&void 0!==g?g:200,loopEnum:null!==(y=e.loopEnum)&&void 0!==y?y:200,meta:null===(b=e.meta)||void 0===b||b,messages:null===(w=e.messages)||void 0===w||w,inlineRefs:null===(x=e.inlineRefs)||void 0===x||x,schemaId:null!==(k=e.schemaId)&&void 0!==k?k:"$id",addUsedSchema:null===(j=e.addUsedSchema)||void 0===j||j,validateSchema:null===(S=e.validateSchema)||void 0===S||S,validateFormats:null===(C=e.validateFormats)||void 0===C||C,unicodeRegExp:null===($=e.unicodeRegExp)||void 0===$||$,int32range:null===(_=e.int32range)||void 0===_||_,uriResolver:P}}var b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Bi(this,e),this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,t=this.opts=Oi(Oi({},t),y(t));var n=this.opts.code,r=n.es5,i=n.lines;this.scope=new s.ValueScope({scope:{},prefixes:p,es5:r,lines:i}),this.logger=_(t.logger);var a=t.validateFormats;t.validateFormats=!1,this.RULES=(0, o.getRules)(),w.call(this,m,t,"NOT SUPPORTED"),w.call(this,g,t,"DEPRECATED","warn"),this._metaOpts=C.call(this),t.formats&&j.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),t.keywords&&S.call(this,t.keywords),"object"==Ji(t.meta)&&this.addMetaSchema(t.meta),k.call(this),t.validateFormats=a;}return qi(e,[{key:"_addVocabularies",value:function(){this.addKeyword("$async");}},{key:"_addDefaultMetaSchema",value:function(){var e=this.opts,t=e.$data,n=e.meta,r=e.schemaId,i=f;"id"===r&&((i=Oi({},f)).id=i.$id,delete i.$id),n&&t&&this.addMetaSchema(i,i[r],!1);}},{key:"defaultMeta",value:function(){var e=this.opts,t=e.meta,n=e.schemaId;return this.opts.defaultMeta="object"==Ji(t)?t[n]||t:void 0}},{key:"validate",value:function(e,t){var n;if("string"==typeof e){if(!(n=this.getSchema(e)))throw new Error('no schema with key or ref "'.concat(e,'"'))}else n=this.compile(e);var r=n(t);return "$async"in n||(this.errors=n.errors),r}},{key:"compile",value:function(e,t){var n=this._addSchema(e,t);return n.validate||this._compileSchemaEnv(n)}},{key:"compileAsync",value:function(e,t){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");var n=this.opts.loadSchema;return r.call(this,e,t);function r(e,t){return o.apply(this,arguments)}function o(){return (o=ji(xi().mark((function e(t,n){var r;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.call(this,t.$schema);case 2:return r=this._addSchema(t,n),e.abrupt("return",r.validate||c.call(this,r));case 4:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function a(e){return s.apply(this,arguments)}function s(){return (s=ji(xi().mark((function e(t){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||this.getSchema(t)){e.next=3;break}return e.next=3,r.call(this,{$ref:t},!0);case 3:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function c(e){return u.apply(this,arguments)}function u(){return (u=ji(xi().mark((function e(t){return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",this._compileSchemaEnv(t));case 4:if(e.prev=4,e.t0=e.catch(0),e.t0 instanceof i.default){e.next=8;break}throw e.t0;case 8:return l.call(this,e.t0),e.next=11,f.call(this,e.t0.missingSchema);case 11:return e.abrupt("return",c.call(this,t));case 12:case"end":return e.stop()}}),e,this,[[0,4]])})))).apply(this,arguments)}function l(e){var t=e.missingSchema,n=e.missingRef;if(this.refs[t])throw new Error("AnySchema ".concat(t," is loaded but ").concat(n," cannot be resolved"))}function f(e){return h.apply(this,arguments)}function h(){return h=ji(xi().mark((function e(n){var r;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.call(this,n);case 2:if(r=e.sent,this.refs[n]){e.next=6;break}return e.next=6,a.call(this,r.$schema);case 6:this.refs[n]||this.addSchema(r,n,t);case 7:case"end":return e.stop()}}),e,this)}))),h.apply(this,arguments)}function d(e){return v.apply(this,arguments)}function v(){return v=ji(xi().mark((function e(t){var r;return xi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this._loading[t])){e.next=3;break}return e.abrupt("return",r);case 3:return e.prev=3,e.next=6,this._loading[t]=n(t);case 6:return e.abrupt("return",e.sent);case 7:return e.prev=7,delete this._loading[t],e.finish(7);case 10:case"end":return e.stop()}}),e,this,[[3,,7,10]])}))),v.apply(this,arguments)}}},{key:"addSchema",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.opts.validateSchema;if(Array.isArray(e)){var o,a=wi(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;this.addSchema(s,void 0,n,i);}}catch(e){a.e(e);}finally{a.f();}return this}if("object"===Ji(e)){var u=this.opts.schemaId;if(void 0!==(r=e[u])&&"string"!=typeof r)throw new Error("schema ".concat(u," must be string"))}return t=(0, c.normalizeId)(t||r),this._checkUnique(t),this.schemas[t]=this._addSchema(e,n,t,i,!0),this}},{key:"addMetaSchema",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.opts.validateSchema;return this.addSchema(e,t,!0,n),this}},{key:"validateSchema",value:function(e,t){if("boolean"==typeof e)return !0;var n;if(void 0!==(n=e.$schema)&&"string"!=typeof n)throw new Error("$schema must be a string");if(!(n=n||this.opts.defaultMeta||this.defaultMeta()))return this.logger.warn("meta-schema not available"),this.errors=null,!0;var r=this.validate(n,e);if(!r&&t){var i="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(i);this.logger.error(i);}return r}},{key:"getSchema",value:function(e){for(var t;"string"==typeof(t=x.call(this,e));)e=t;if(void 0===t){var n=this.opts.schemaId,r=new a.SchemaEnv({schema:{},schemaId:n});if(!(t=a.resolveSchema.call(this,r,e)))return;this.refs[e]=t;}return t.validate||this._compileSchemaEnv(t)}},{key:"removeSchema",value:function(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(Ji(e)){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":var t=x.call(this,e);return "object"==Ji(t)&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this;case"object":var n=e;this._cache.delete(n);var r=e[this.opts.schemaId];return r&&(r=(0, c.normalizeId)(r),delete this.schemas[r],delete this.refs[r]),this;default:throw new Error("ajv.removeSchema: invalid parameter")}}},{key:"addVocabulary",value:function(e){var t,n=wi(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.addKeyword(r);}}catch(e){n.e(e);}finally{n.f();}return this}},{key:"addKeyword",value:function(e,t){var n,r=this;if("string"==typeof e)n=e,"object"==Ji(t)&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=n);else {if("object"!=Ji(e)||void 0!==t)throw new Error("invalid addKeywords parameters");if(n=(t=e).keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(M.call(this,n,t),!t)return (0, l.eachItem)(n,(function(e){return E.call(r,e)})),this;P.call(this,t);var i=Oi(Oi({},t),{},{type:(0, u.getJSONTypes)(t.type),schemaType:(0, u.getJSONTypes)(t.schemaType)});return (0, l.eachItem)(n,0===i.type.length?function(e){return E.call(r,e,i)}:function(e){return i.type.forEach((function(t){return E.call(r,e,i,t)}))}),this}},{key:"getKeyword",value:function(e){var t=this.RULES.all[e];return "object"==Ji(t)?t.definition:!!t}},{key:"removeKeyword",value:function(e){var t=this.RULES;delete t.keywords[e],delete t.all[e];var n,r=wi(t.rules);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=i.rules.findIndex((function(t){return t.keyword===e}));o>=0&&i.rules.splice(o,1);}}catch(e){r.e(e);}finally{r.f();}return this}},{key:"addFormat",value:function(e,t){return "string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this}},{key:"errorsText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.errors,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.separator,r=void 0===n?", ":n,i=t.dataVar,o=void 0===i?"data":i;return e&&0!==e.length?e.map((function(e){return "".concat(o).concat(e.instancePath," ").concat(e.message)})).reduce((function(e,t){return e+r+t})):"No errors"}},{key:"$dataMetaSchema",value:function(e,t){var n=this.RULES.all;e=JSON.parse(JSON.stringify(e));var r,i=wi(t);try{for(i.s();!(r=i.n()).done;){var o,a=r.value.split("/").slice(1),s=e,c=wi(a);try{for(c.s();!(o=c.n()).done;){s=s[o.value];}}catch(e){c.e(e);}finally{c.f();}for(var u in n){var l=n[u];if("object"==Ji(l)){var f=l.definition.$data,h=s[u];f&&h&&(s[u]=R(h));}}}}catch(e){i.e(e);}finally{i.f();}return e}},{key:"_removeAllSchemas",value:function(e,t){for(var n in e){var r=e[n];t&&!t.test(n)||("string"==typeof r?delete e[n]:r&&!r.meta&&(this._cache.delete(r.schema),delete e[n]));}}},{key:"_addSchema",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.opts.validateSchema,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.opts.addUsedSchema,s=this.opts.schemaId;if("object"==Ji(e))r=e[s];else {if(this.opts.jtd)throw new Error("schema must be object");if("boolean"!=typeof e)throw new Error("schema must be object or boolean")}var u=this._cache.get(e);if(void 0!==u)return u;n=(0, c.normalizeId)(r||n);var l=c.getSchemaRefs.call(this,e,n);return u=new a.SchemaEnv({schema:e,schemaId:s,meta:t,baseId:n,localRefs:l}),this._cache.set(u.schema,u),o&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=u),i&&this.validateSchema(e,!0),u}},{key:"_checkUnique",value:function(e){if(this.schemas[e]||this.refs[e])throw new Error('schema with key or id "'.concat(e,'" already exists'))}},{key:"_compileSchemaEnv",value:function(e){if(e.meta?this._compileMetaSchema(e):a.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}},{key:"_compileMetaSchema",value:function(e){var t=this.opts;this.opts=this._metaOpts;try{a.compileSchema.call(this,e);}finally{this.opts=t;}}}]),e}();function w(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"error";for(var i in e){var o=i;o in t&&this.logger[r]("".concat(n,": option ").concat(i,". ").concat(e[o]));}}function x(e){return e=(0, c.normalizeId)(e),this.schemas[e]||this.refs[e]}function k(){var e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(var t in e)this.addSchema(e[t],t);}function j(){for(var e in this.opts.formats){var t=this.opts.formats[e];t&&this.addFormat(e,t);}}function S(e){if(Array.isArray(e))this.addVocabulary(e);else for(var t in this.logger.warn("keywords option as map is deprecated, pass array"),e){var n=e[t];n.keyword||(n.keyword=t),this.addKeyword(n);}}function C(){var e,t=Oi({},this.opts),n=wi(v);try{for(n.s();!(e=n.n()).done;){delete t[e.value];}}catch(e){n.e(e);}finally{n.f();}return t}e.default=b,b.ValidationError=r.default,b.MissingRefError=i.default;var $={log:function(){},warn:function(){},error:function(){}};function _(e){if(!1===e)return $;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods")}var O=/^[a-z_$][a-z0-9_$:-]*$/i;function M(e,t){var n=this.RULES;if((0, l.eachItem)(e,(function(e){if(n.keywords[e])throw new Error("Keyword ".concat(e," is already defined"));if(!O.test(e))throw new Error("Keyword ".concat(e," has invalid name"))})),t&&t.$data&&!("code"in t)&&!("validate"in t))throw new Error('$data keyword must have "code" or "validate" function')}function E(e,t,n){var r,i=this,o=null==t?void 0:t.post;if(n&&o)throw new Error('keyword with "post" flag cannot have "type"');var a=this.RULES,s=o?a.post:a.rules.find((function(e){return e.type===n}));if(s||(s={type:n,rules:[]},a.rules.push(s)),a.keywords[e]=!0,t){var c={keyword:e,definition:Oi(Oi({},t),{},{type:(0, u.getJSONTypes)(t.type),schemaType:(0, u.getJSONTypes)(t.schemaType)})};t.before?A.call(this,s,c,t.before):s.rules.push(c),a.all[e]=c,null===(r=t.implements)||void 0===r||r.forEach((function(e){return i.addKeyword(e)}));}}function A(e,t,n){var r=e.rules.findIndex((function(e){return e.keyword===n}));r>=0?e.rules.splice(r,0,t):(e.rules.push(t),this.logger.warn("rule ".concat(n," is not defined")));}function P(e){var t=e.metaSchema;void 0!==t&&(e.$data&&this.opts.$data&&(t=R(t)),e.validateSchema=this.compile(t,!0));}var T={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function R(e){return {anyOf:[e,T]}}}(r2);var E3={},A3={},P3={};Object.defineProperty(P3,"__esModule",{value:!0});var T3={keyword:"id",code:function(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};P3.default=T3;var R3={};Object.defineProperty(R3,"__esModule",{value:!0}),R3.callRef=R3.getValidate=void 0;var N3=u3(),I3=R2(),D3=v2(),L3=w2(),B3=l3,z3=p2,q3={keyword:"$ref",schemaType:"string",code:function(e){var t=e.gen,n=e.schema,r=e.it,i=r.baseId,o=r.schemaEnv,a=r.validateName,s=r.opts,c=r.self,u=o.root;if(("#"===n||"#/"===n)&&i===u.baseId)return function(){if(o===u)return V3(e,a,o,o.$async);var n=t.scopeValue("root",{ref:u});return V3(e,(0, D3._)(on||(on=yi(["",".validate"])),n),u,u.$async)}();var l,f,h,d,v=B3.resolveRef.call(c,u,i,n);if(void 0===v)throw new N3.default(r.opts.uriResolver,i,n);return v instanceof B3.SchemaEnv?function(t){var n=F3(e,t);V3(e,n,t,t.$async);}(v):(l=v,f=t.scopeValue("schema",!0===s.code.source?{ref:l,code:(0, D3.stringify)(l)}:{ref:l}),h=t.name("valid"),d=e.subschema({schema:l,dataTypes:[],schemaPath:D3.nil,topSchemaRef:f,errSchemaPath:n},h),e.mergeEvaluated(d),void e.ok(h))}};function F3(e,t){var n=e.gen;return t.validate?n.scopeValue("validate",{ref:t.validate}):(0, D3._)(an||(an=yi(["",".validate"])),n.scopeValue("wrapper",{ref:t}))}function V3(e,t,n,r){var i=e.gen,o=e.it,a=o.allErrors,s=o.schemaEnv,c=o.opts.passContext?L3.default.this:D3.nil;function u(e){var t=(0, D3._)(un||(un=yi(["",".errors"])),e);i.assign(L3.default.vErrors,(0, D3._)(ln||(ln=yi([""," === null ? "," : ",".concat(",")"])),L3.default.vErrors,t,L3.default.vErrors,t)),i.assign(L3.default.errors,(0, D3._)(fn||(fn=yi(["",".length"])),L3.default.vErrors));}function l(e){var t;if(o.opts.unevaluated){var r=null===(t=null==n?void 0:n.validate)||void 0===t?void 0:t.evaluated;if(!0!==o.props)if(r&&!r.dynamicProps)void 0!==r.props&&(o.props=z3.mergeEvaluated.props(i,r.props,o.props));else {var a=i.var("props",(0, D3._)(hn||(hn=yi(["",".evaluated.props"])),e));o.props=z3.mergeEvaluated.props(i,a,o.props,D3.Name);}if(!0!==o.items)if(r&&!r.dynamicItems)void 0!==r.items&&(o.items=z3.mergeEvaluated.items(i,r.items,o.items));else {var s=i.var("items",(0, D3._)(dn||(dn=yi(["",".evaluated.items"])),e));o.items=z3.mergeEvaluated.items(i,s,o.items,D3.Name);}}}r?function(){if(!s.$async)throw new Error("async schema referenced by sync schema");var n=i.let("valid");i.try((function(){i.code((0, D3._)(sn||(sn=yi(["await ",""])),(0, I3.callValidateCode)(e,t,c))),l(t),a||i.assign(n,!0);}),(function(e){i.if((0, D3._)(cn||(cn=yi(["!("," instanceof ",")"])),e,o.ValidationError),(function(){return i.throw(e)})),u(e),a||i.assign(n,!1);})),e.ok(n);}():e.result((0, I3.callValidateCode)(e,t,c),(function(){return l(t)}),(function(){return u(t)}));}R3.getValidate=F3,R3.callRef=V3,R3.default=q3,Object.defineProperty(A3,"__esModule",{value:!0});var W3=R3,H3=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",P3.default,W3.default];A3.default=H3;var U3={},J3={};Object.defineProperty(J3,"__esModule",{value:!0});var K3=v2(),G3=K3.operators,Q3={maximum:{okStr:"<=",ok:G3.LTE,fail:G3.GT},minimum:{okStr:">=",ok:G3.GTE,fail:G3.LT},exclusiveMaximum:{okStr:"<",ok:G3.LT,fail:G3.GTE},exclusiveMinimum:{okStr:">",ok:G3.GT,fail:G3.LTE}},Y3={message:function(e){var t=e.keyword,n=e.schemaCode;return (0, K3.str)(vn||(vn=yi(["must be "," ",""])),Q3[t].okStr,n)},params:function(e){var t=e.keyword,n=e.schemaCode;return (0, K3._)(pn||(pn=yi(["{comparison: ",", limit: ","}"])),Q3[t].okStr,n)}},X3={keyword:Object.keys(Q3),type:"number",schemaType:"number",$data:!0,error:Y3,code:function(e){var t=e.keyword,n=e.data,r=e.schemaCode;e.fail$data((0, K3._)(mn||(mn=yi([""," "," "," || isNaN(",")"])),n,Q3[t].fail,r,n));}};J3.default=X3;var Z3={};Object.defineProperty(Z3,"__esModule",{value:!0});var e4=v2(),t4={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:function(e){var t=e.schemaCode;return (0, e4.str)(gn||(gn=yi(["must be multiple of ",""])),t)},params:function(e){var t=e.schemaCode;return (0, e4._)(yn||(yn=yi(["{multipleOf: ","}"])),t)}},code:function(e){var t=e.gen,n=e.data,r=e.schemaCode,i=e.it.opts.multipleOfPrecision,o=t.let("res"),a=i?(0, e4._)(bn||(bn=yi(["Math.abs(Math.round(",") - ",") > 1e-",""])),o,o,i):(0, e4._)(wn||(wn=yi([""," !== parseInt(",")"])),o,o);e.fail$data((0, e4._)(xn||(xn=yi(["("," === 0 || ("," = ","/",", ","))"])),r,o,n,r,a));}};Z3.default=t4;var n4={},r4={};function i4(e){for(var t,n=e.length,r=0,i=0;i<n;)r++,(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<n&&56320==(64512&(t=e.charCodeAt(i)))&&i++;return r}Object.defineProperty(r4,"__esModule",{value:!0}),r4.default=i4,i4.code='require("ajv/dist/runtime/ucs2length").default',Object.defineProperty(n4,"__esModule",{value:!0});var o4=v2(),a4=p2,s4=r4,c4={message:function(e){var t=e.keyword,n=e.schemaCode,r="maxLength"===t?"more":"fewer";return (0, o4.str)(kn||(kn=yi(["must NOT have "," than "," characters"])),r,n)},params:function(e){var t=e.schemaCode;return (0, o4._)(jn||(jn=yi(["{limit: ","}"])),t)}},u4={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:c4,code:function(e){var t=e.keyword,n=e.data,r=e.schemaCode,i=e.it,o="maxLength"===t?o4.operators.GT:o4.operators.LT,a=!1===i.opts.unicode?(0, o4._)(Sn||(Sn=yi(["",".length"])),n):(0, o4._)(Cn||(Cn=yi(["","(",")"])),(0, a4.useFunc)(e.gen,s4.default),n);e.fail$data((0, o4._)($n||($n=yi([""," "," ",""])),a,o,r));}};n4.default=u4;var l4={};Object.defineProperty(l4,"__esModule",{value:!0});var f4=R2(),h4=v2(),d4={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:function(e){var t=e.schemaCode;return (0, h4.str)(_n||(_n=yi(['must match pattern "','"'])),t)},params:function(e){var t=e.schemaCode;return (0, h4._)(On||(On=yi(["{pattern: ","}"])),t)}},code:function(e){var t=e.data,n=e.$data,r=e.schema,i=e.schemaCode,o=e.it.opts.unicodeRegExp?"u":"",a=n?(0, h4._)(Mn||(Mn=yi(["(new RegExp(",", ","))"])),i,o):(0, f4.usePattern)(e,r);e.fail$data((0, h4._)(En||(En=yi(["!",".test(",")"])),a,t));}};l4.default=d4;var v4={};Object.defineProperty(v4,"__esModule",{value:!0});var p4=v2(),m4={message:function(e){var t=e.keyword,n=e.schemaCode,r="maxProperties"===t?"more":"fewer";return (0, p4.str)(An||(An=yi(["must NOT have "," than "," properties"])),r,n)},params:function(e){var t=e.schemaCode;return (0, p4._)(Pn||(Pn=yi(["{limit: ","}"])),t)}},g4={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:m4,code:function(e){var t=e.keyword,n=e.data,r=e.schemaCode,i="maxProperties"===t?p4.operators.GT:p4.operators.LT;e.fail$data((0, p4._)(Tn||(Tn=yi(["Object.keys(",").length "," ",""])),n,i,r));}};v4.default=g4;var y4={};Object.defineProperty(y4,"__esModule",{value:!0});var b4=R2(),w4=v2(),x4=p2,k4={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:function(e){var t=e.params.missingProperty;return (0, w4.str)(Rn||(Rn=yi(["must have required property '","'"])),t)},params:function(e){var t=e.params.missingProperty;return (0, w4._)(Nn||(Nn=yi(["{missingProperty: ","}"])),t)}},code:function(e){var t=e.gen,n=e.schema,r=e.schemaCode,i=e.data,o=e.$data,a=e.it,s=a.opts;if(o||0!==n.length){var c=n.length>=s.loopRequired;if(a.allErrors?function(){if(c||o)e.block$data(w4.nil,m);else {var t,r=wi(n);try{for(r.s();!(t=r.n()).done;){var i=t.value;(0,b4.checkReportMissingProp)(e,i);}}catch(e){r.e(e);}finally{r.f();}}}():function(){var a=t.let("missing");if(c||o){var u=t.let("valid",!0);e.block$data(u,(function(){return function(n,o){e.setParams({missingProperty:n}),t.forOf(n,r,(function(){t.assign(o,(0, b4.propertyInData)(t,i,n,s.ownProperties)),t.if((0, w4.not)(o),(function(){e.error(),t.break();}));}),w4.nil);}(a,u)})),e.ok(u);}else t.if((0, b4.checkMissingProp)(e,n,a)),(0, b4.reportMissingProp)(e,a),t.else();}(),s.strictRequired){var u,l=e.parentSchema.properties,f=e.it.definedProperties,h=wi(n);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(void 0===(null==l?void 0:l[d])&&!f.has(d)){var v=a.schemaEnv.baseId+a.errSchemaPath,p='required property "'.concat(d,'" is not defined at "').concat(v,'" (strictRequired)');(0,x4.checkStrictMode)(a,p,a.opts.strictRequired);}}}catch(e){h.e(e);}finally{h.f();}}}function m(){t.forOf("prop",r,(function(n){e.setParams({missingProperty:n}),t.if((0, b4.noPropertyInData)(t,i,n,s.ownProperties),(function(){return e.error()}));}));}}};y4.default=k4;var j4={};Object.defineProperty(j4,"__esModule",{value:!0});var S4=v2(),C4={message:function(e){var t=e.keyword,n=e.schemaCode,r="maxItems"===t?"more":"fewer";return (0, S4.str)(In||(In=yi(["must NOT have "," than "," items"])),r,n)},params:function(e){var t=e.schemaCode;return (0, S4._)(Dn||(Dn=yi(["{limit: ","}"])),t)}},$4={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:C4,code:function(e){var t=e.keyword,n=e.data,r=e.schemaCode,i="maxItems"===t?S4.operators.GT:S4.operators.LT;e.fail$data((0, S4._)(Ln||(Ln=yi(["",".length "," ",""])),n,i,r));}};j4.default=$4;var _4={},O4={};Object.defineProperty(O4,"__esModule",{value:!0});var M4=B2;M4.code='require("ajv/dist/runtime/equal").default',O4.default=M4,Object.defineProperty(_4,"__esModule",{value:!0});var E4=k2,A4=v2(),P4=p2,T4=O4,R4={message:function(e){var t=e.params,n=t.i,r=t.j;return (0, A4.str)(Bn||(Bn=yi(["must NOT have duplicate items (items ## "," and "," are identical)"])),r,n)},params:function(e){var t=e.params,n=t.i,r=t.j;return (0, A4._)(zn||(zn=yi(["{i: ",", j: ","}"])),n,r)}},N4={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:R4,code:function(e){var t=e.gen,n=e.data,r=e.$data,i=e.schema,o=e.parentSchema,a=e.schemaCode,s=e.it;if(r||i){var c=t.let("valid"),u=o.items?(0, E4.getSchemaTypes)(o.items):[];e.block$data(c,(function(){var r=t.let("i",(0, A4._)(Fn||(Fn=yi(["",".length"])),n)),i=t.let("j");e.setParams({i:r,j:i}),t.assign(c,!0),t.if((0, A4._)(Vn||(Vn=yi([""," > 1"])),r),(function(){return (u.length>0&&!u.some((function(e){return "object"===e||"array"===e}))?l:f)(r,i)}));}),(0, A4._)(qn||(qn=yi([""," === false"])),a)),e.ok(c);}function l(r,i){var o=t.name("item"),a=(0, E4.checkDataTypes)(u,o,s.opts.strictNumbers,E4.DataType.Wrong),l=t.const("indices",(0, A4._)(Wn||(Wn=yi(["{}"]))));t.for((0, A4._)(Hn||(Hn=yi([";","--;"])),r),(function(){t.let(o,(0, A4._)(Un||(Un=yi(["","[","]"])),n,r)),t.if(a,(0, A4._)(Jn||(Jn=yi(["continue"])))),u.length>1&&t.if((0, A4._)(Kn||(Kn=yi(["typeof ",' == "string"'])),o),(0, A4._)(Gn||(Gn=yi(["",' += "_"'])),o)),t.if((0, A4._)(Qn||(Qn=yi(["typeof ","[",'] == "number"'])),l,o),(function(){t.assign(i,(0, A4._)(Yn||(Yn=yi(["","[","]"])),l,o)),e.error(),t.assign(c,!1).break();})).code((0, A4._)(Xn||(Xn=yi(["","[","] = ",""])),l,o,r));}));}function f(r,i){var o=(0, P4.useFunc)(t,T4.default),a=t.name("outer");t.label(a).for((0, A4._)(Zn||(Zn=yi([";","--;"])),r),(function(){return t.for((0, A4._)(er||(er=yi([""," = ","; ","--;"])),i,r,i),(function(){return t.if((0, A4._)(tr||(tr=yi(["","(","[","], ","[","])"])),o,n,r,n,i),(function(){e.error(),t.assign(c,!1).break(a);}))}))}));}}};_4.default=N4;var I4={};Object.defineProperty(I4,"__esModule",{value:!0});var D4=v2(),L4=p2,B4=O4,z4={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:function(e){var t=e.schemaCode;return (0, D4._)(nr||(nr=yi(["{allowedValue: ","}"])),t)}},code:function(e){var t=e.gen,n=e.data,r=e.$data,i=e.schemaCode,o=e.schema;r||o&&"object"==Ji(o)?e.fail$data((0, D4._)(rr||(rr=yi(["!","(",", ",")"])),(0, L4.useFunc)(t,B4.default),n,i)):e.fail((0, D4._)(ir||(ir=yi([""," !== ",""])),o,n));}};I4.default=z4;var q4={};Object.defineProperty(q4,"__esModule",{value:!0});var F4=v2(),V4=p2,W4=O4,H4={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:function(e){var t=e.schemaCode;return (0, F4._)(or||(or=yi(["{allowedValues: ","}"])),t)}},code:function(e){var t=e.gen,n=e.data,r=e.$data,i=e.schema,o=e.schemaCode,a=e.it;if(!r&&0===i.length)throw new Error("enum must have non-empty array");var s,c,u=i.length>=a.opts.loopEnum,l=function(){return null!=s?s:s=(0, V4.useFunc)(t,W4.default)};if(u||r)c=t.let("valid"),e.block$data(c,(function(){t.assign(c,!1),t.forOf("v",o,(function(e){return t.if((0, F4._)(ar||(ar=yi(["","(",", ",")"])),l(),n,e),(function(){return t.assign(c,!0).break()}))}));}));else {if(!Array.isArray(i))throw new Error("ajv implementation error");var f=t.const("vSchema",o);c=F4.or.apply(void 0,Vi(i.map((function(e,t){return function(e,t){var r=i[t];return "object"===Ji(r)&&null!==r?(0, F4._)(sr||(sr=yi(["","(",", ","[","])"])),l(),n,e,t):(0, F4._)(cr||(cr=yi([""," === ",""])),n,r)}(f,t)}))));}e.pass(c);}};q4.default=H4,Object.defineProperty(U3,"__esModule",{value:!0});var U4=Z3,J4=n4,K4=l4,G4=v4,Q4=y4,Y4=j4,X4=_4,Z4=I4,e5=q4,t5=[J3.default,U4.default,J4.default,K4.default,G4.default,Q4.default,Y4.default,X4.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},Z4.default,e5.default];U3.default=t5;var n5={},r5={};Object.defineProperty(r5,"__esModule",{value:!0}),r5.validateAdditionalItems=void 0;var i5=v2(),o5=p2,a5={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:function(e){var t=e.params.len;return (0, i5.str)(ur||(ur=yi(["must NOT have more than "," items"])),t)},params:function(e){var t=e.params.len;return (0, i5._)(lr||(lr=yi(["{limit: ","}"])),t)}},code:function(e){var t=e.parentSchema,n=e.it,r=t.items;Array.isArray(r)?s5(e,r):(0, o5.checkStrictMode)(n,'"additionalItems" is ignored when "items" is not an array of schemas');}};function s5(e,t){var n=e.gen,r=e.schema,i=e.data,o=e.keyword,a=e.it;a.items=!0;var s=n.const("len",(0, i5._)(fr||(fr=yi(["",".length"])),i));if(!1===r)e.setParams({len:t.length}),e.pass((0, i5._)(hr||(hr=yi([""," <= ",""])),s,t.length));else if("object"==Ji(r)&&!(0, o5.alwaysValidSchema)(a,r)){var c=n.var("valid",(0, i5._)(dr||(dr=yi([""," <= ",""])),s,t.length));n.if((0, i5.not)(c),(function(){return function(r){n.forRange("i",t.length,s,(function(t){e.subschema({keyword:o,dataProp:t,dataPropType:o5.Type.Num},r),a.allErrors||n.if((0, i5.not)(r),(function(){return n.break()}));}));}(c)})),e.ok(c);}}r5.validateAdditionalItems=s5,r5.default=a5;var c5={},u5={};Object.defineProperty(u5,"__esModule",{value:!0}),u5.validateTuple=void 0;var l5=v2(),f5=p2,h5=R2(),d5={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code:function(e){var t=e.schema,n=e.it;if(Array.isArray(t))return v5(e,"additionalItems",t);n.items=!0,(0, f5.alwaysValidSchema)(n,t)||e.ok((0, h5.validateArray)(e));}};function v5(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.schema,r=e.gen,i=e.parentSchema,o=e.data,a=e.keyword,s=e.it;l(i),s.opts.unevaluated&&n.length&&!0!==s.items&&(s.items=f5.mergeEvaluated.items(r,n.length,s.items));var c=r.name("valid"),u=r.const("len",(0, l5._)(vr||(vr=yi(["",".length"])),o));function l(e){var r=s.opts,i=s.errSchemaPath,o=n.length,c=o===e.minItems&&(o===e.maxItems||!1===e[t]);if(r.strictTuples&&!c){var u='"'.concat(a,'" is ').concat(o,"-tuple, but minItems or maxItems/").concat(t,' are not specified or different at path "').concat(i,'"');(0, f5.checkStrictMode)(s,u,r.strictTuples);}}n.forEach((function(t,n){(0, f5.alwaysValidSchema)(s,t)||(r.if((0, l5._)(pr||(pr=yi([""," > ",""])),u,n),(function(){return e.subschema({keyword:a,schemaProp:n,dataProp:n},c)})),e.ok(c));}));}u5.validateTuple=v5,u5.default=d5,Object.defineProperty(c5,"__esModule",{value:!0});var p5=u5,m5={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:function(e){return (0, p5.validateTuple)(e,"items")}};c5.default=m5;var g5={};Object.defineProperty(g5,"__esModule",{value:!0});var y5=v2(),b5=p2,w5=R2(),x5=r5,k5={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:function(e){var t=e.params.len;return (0, y5.str)(mr||(mr=yi(["must NOT have more than "," items"])),t)},params:function(e){var t=e.params.len;return (0, y5._)(gr||(gr=yi(["{limit: ","}"])),t)}},code:function(e){var t=e.schema,n=e.parentSchema,r=e.it,i=n.prefixItems;r.items=!0,(0, b5.alwaysValidSchema)(r,t)||(i?(0, x5.validateAdditionalItems)(e,i):e.ok((0, w5.validateArray)(e)));}};g5.default=k5;var j5={};Object.defineProperty(j5,"__esModule",{value:!0});var S5=v2(),C5=p2,$5={message:function(e){var t=e.params,n=t.min,r=t.max;return void 0===r?(0, S5.str)(yr||(yr=yi(["must contain at least "," valid item(s)"])),n):(0, S5.str)(br||(br=yi(["must contain at least "," and no more than "," valid item(s)"])),n,r)},params:function(e){var t=e.params,n=t.min,r=t.max;return void 0===r?(0, S5._)(wr||(wr=yi(["{minContains: ","}"])),n):(0, S5._)(xr||(xr=yi(["{minContains: ",", maxContains: ","}"])),n,r)}},_5={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:$5,code:function(e){var t,n,r=e.gen,i=e.schema,o=e.parentSchema,a=e.data,s=e.it,c=o.minContains,u=o.maxContains;s.opts.next?(t=void 0===c?1:c,n=u):t=1;var l=r.const("len",(0, S5._)(kr||(kr=yi(["",".length"])),a));if(e.setParams({min:t,max:n}),void 0!==n||0!==t){if(void 0!==n&&t>n)return (0, C5.checkStrictMode)(s,'"minContains" > "maxContains" is always invalid'),void e.fail();if((0, C5.alwaysValidSchema)(s,i)){var f=(0, S5._)(jr||(jr=yi([""," >= ",""])),l,t);return void 0!==n&&(f=(0, S5._)(Sr||(Sr=yi([""," && "," <= ",""])),f,l,n)),void e.pass(f)}s.items=!0;var h=r.name("valid");void 0===n&&1===t?v(h,(function(){return r.if(h,(function(){return r.break()}))})):0===t?(r.let(h,!0),void 0!==n&&r.if((0, S5._)(Cr||(Cr=yi(["",".length > 0"])),a),d)):(r.let(h,!1),d()),e.result(h,(function(){return e.reset()}));}else (0, C5.checkStrictMode)(s,'"minContains" == 0 without "maxContains": "contains" keyword ignored');function d(){var e=r.name("_valid"),i=r.let("count",0);v(e,(function(){return r.if(e,(function(){return function(e){r.code((0, S5._)($r||($r=yi(["","++"])),e)),void 0===n?r.if((0, S5._)(_r||(_r=yi([""," >= ",""])),e,t),(function(){return r.assign(h,!0).break()})):(r.if((0, S5._)(Or||(Or=yi([""," > ",""])),e,n),(function(){return r.assign(h,!1).break()})),1===t?r.assign(h,!0):r.if((0, S5._)(Mr||(Mr=yi([""," >= ",""])),e,t),(function(){return r.assign(h,!0)})));}(i)}))}));}function v(t,n){r.forRange("i",0,l,(function(r){e.subschema({keyword:"contains",dataProp:r,dataPropType:C5.Type.Num,compositeRule:!0},t),n();}));}}};j5.default=_5;var O5={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;var t=v2(),n=p2,r=R2();e.error={message:function(e){var n=e.params,r=n.property,i=n.depsCount,o=n.deps,a=1===i?"property":"properties";return (0, t.str)(Er||(Er=yi(["must have "," "," when property "," is present"])),a,o,r)},params:function(e){var n=e.params,r=n.property,i=n.depsCount,o=n.deps,a=n.missingProperty;return (0, t._)(Ar||(Ar=yi(["{property: ",",\n    missingProperty: ",",\n    depsCount: ",",\n    deps: ","}"])),r,a,i,o)}};var i={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code:function(e){var t=Si(function(e){var t=e.schema,n={},r={};for(var i in t){if("__proto__"!==i)(Array.isArray(t[i])?n:r)[i]=t[i];}return [n,r]}(e),2),n=t[0],r=t[1];o(e,n),a(e,r);}};function o(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.schema,i=e.gen,o=e.data,a=e.it;if(0!==Object.keys(n).length){var s=i.let("missing"),c=function(){var c=n[u];if(0===c.length)return "continue";var l=(0, r.propertyInData)(i,o,u,a.opts.ownProperties);e.setParams({property:u,depsCount:c.length,deps:c.join(", ")}),a.allErrors?i.if(l,(function(){var t,n=wi(c);try{for(n.s();!(t=n.n()).done;){var i=t.value;(0,r.checkReportMissingProp)(e,i);}}catch(e){n.e(e);}finally{n.f();}})):(i.if((0, t._)(Pr||(Pr=yi([""," && (",")"])),l,(0, r.checkMissingProp)(e,c,s))),(0, r.reportMissingProp)(e,s),i.else());};for(var u in n)c();}}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.schema,i=e.gen,o=e.data,a=e.keyword,s=e.it,c=i.name("valid"),u=function(u){if((0, n.alwaysValidSchema)(s,t[u]))return "continue";i.if((0, r.propertyInData)(i,o,u,s.opts.ownProperties),(function(){var t=e.subschema({keyword:a,schemaProp:u},c);e.mergeValidEvaluated(t,c);}),(function(){return i.var(c,!0)})),e.ok(c);};for(var l in t)u(l);}e.validatePropertyDeps=o,e.validateSchemaDeps=a,e.default=i;}(O5);var M5={};Object.defineProperty(M5,"__esModule",{value:!0});var E5=v2(),A5=p2,P5={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:function(e){var t=e.params;return (0, E5._)(Tr||(Tr=yi(["{propertyName: ","}"])),t.propertyName)}},code:function(e){var t=e.gen,n=e.schema,r=e.data,i=e.it;if(!(0, A5.alwaysValidSchema)(i,n)){var o=t.name("valid");t.forIn("key",r,(function(n){e.setParams({propertyName:n}),e.subschema({keyword:"propertyNames",data:n,dataTypes:["string"],propertyName:n,compositeRule:!0},o),t.if((0, E5.not)(o),(function(){e.error(!0),i.allErrors||t.break();}));})),e.ok(o);}}};M5.default=P5;var T5={};Object.defineProperty(T5,"__esModule",{value:!0});var R5=R2(),N5=v2(),I5=w2(),D5=p2,L5={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:function(e){var t=e.params;return (0, N5._)(Rr||(Rr=yi(["{additionalProperty: ","}"])),t.additionalProperty)}},code:function(e){var t=e.gen,n=e.schema,r=e.parentSchema,i=e.data,o=e.errsCount,a=e.it;if(!o)throw new Error("ajv implementation error");var s=a.allErrors,c=a.opts;if(a.props=!0,"all"===c.removeAdditional||!(0, D5.alwaysValidSchema)(a,n)){var u=(0, R5.allSchemaProperties)(r.properties),l=(0, R5.allSchemaProperties)(r.patternProperties);t.forIn("key",i,(function(n){u.length||l.length?t.if(function(n){var i;if(u.length>8){var o=(0, D5.schemaRefOrVal)(a,r.properties,"properties");i=(0, R5.isOwnProperty)(t,o,n);}else i=u.length?N5.or.apply(void 0,Vi(u.map((function(e){return (0, N5._)(Ir||(Ir=yi([""," === ",""])),n,e)})))):N5.nil;return l.length&&(i=N5.or.apply(void 0,[i].concat(Vi(l.map((function(t){return (0, N5._)(Dr||(Dr=yi(["",".test(",")"])),(0, R5.usePattern)(e,t),n)})))))),(0, N5.not)(i)}(n),(function(){return h(n)})):h(n);})),e.ok((0, N5._)(Nr||(Nr=yi([""," === ",""])),o,I5.default.errors));}function f(e){t.code((0, N5._)(Lr||(Lr=yi(["delete ","[","]"])),i,e));}function h(r){if("all"===c.removeAdditional||c.removeAdditional&&!1===n)f(r);else {if(!1===n)return e.setParams({additionalProperty:r}),e.error(),void(s||t.break());if("object"==Ji(n)&&!(0, D5.alwaysValidSchema)(a,n)){var i=t.name("valid");"failing"===c.removeAdditional?(d(r,i,!1),t.if((0, N5.not)(i),(function(){e.reset(),f(r);}))):(d(r,i),s||t.if((0, N5.not)(i),(function(){return t.break()})));}}}function d(t,n,r){var i={keyword:"additionalProperties",dataProp:t,dataPropType:D5.Type.Str};!1===r&&Object.assign(i,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(i,n);}}};T5.default=L5;var B5={};Object.defineProperty(B5,"__esModule",{value:!0});var z5=r3(),q5=R2(),F5=p2,V5=T5,W5={keyword:"properties",type:"object",schemaType:"object",code:function(e){var t=e.gen,n=e.schema,r=e.parentSchema,i=e.data,o=e.it;"all"===o.opts.removeAdditional&&void 0===r.additionalProperties&&V5.default.code(new z5.KeywordCxt(o,V5.default,"additionalProperties"));var a,s=(0, q5.allSchemaProperties)(n),c=wi(s);try{for(c.s();!(a=c.n()).done;){var u=a.value;o.definedProperties.add(u);}}catch(e){c.e(e);}finally{c.f();}o.opts.unevaluated&&s.length&&!0!==o.props&&(o.props=F5.mergeEvaluated.props(t,(0, F5.toHash)(s),o.props));var l=s.filter((function(e){return !(0, F5.alwaysValidSchema)(o,n[e])}));if(0!==l.length){var f,h=t.name("valid"),d=wi(l);try{for(d.s();!(f=d.n()).done;){var v=f.value;p(v)?m(v):(t.if((0,q5.propertyInData)(t,i,v,o.opts.ownProperties)),m(v),o.allErrors||t.else().var(h,!0),t.endIf()),e.it.definedProperties.add(v),e.ok(h);}}catch(e){d.e(e);}finally{d.f();}}function p(e){return o.opts.useDefaults&&!o.compositeRule&&void 0!==n[e].default}function m(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t},h);}}};B5.default=W5;var H5={};Object.defineProperty(H5,"__esModule",{value:!0});var U5=R2(),J5=v2(),K5=p2,G5=p2,Q5={keyword:"patternProperties",type:"object",schemaType:"object",code:function(e){var t=e.gen,n=e.schema,r=e.data,i=e.parentSchema,o=e.it,a=o.opts,s=(0, U5.allSchemaProperties)(n),c=s.filter((function(e){return (0, K5.alwaysValidSchema)(o,n[e])}));if(0!==s.length&&(c.length!==s.length||o.opts.unevaluated&&!0!==o.props)){var u=a.strictSchema&&!a.allowMatchingProperties&&i.properties,l=t.name("valid");!0===o.props||o.props instanceof J5.Name||(o.props=(0, G5.evaluatedPropsToName)(t,o.props));var f=o.props;!function(){var e,n=wi(s);try{for(n.s();!(e=n.n()).done;){var r=e.value;u&&h(r),o.allErrors?d(r):(t.var(l,!0),d(r),t.if(l));}}catch(e){n.e(e);}finally{n.f();}}();}function h(e){for(var t in u)new RegExp(e).test(t)&&(0, K5.checkStrictMode)(o,"property ".concat(t," matches pattern ").concat(e," (use allowMatchingProperties)"));}function d(n){t.forIn("key",r,(function(r){t.if((0, J5._)(Br||(Br=yi(["",".test(",")"])),(0, U5.usePattern)(e,n),r),(function(){var i=c.includes(n);i||e.subschema({keyword:"patternProperties",schemaProp:n,dataProp:r,dataPropType:G5.Type.Str},l),o.opts.unevaluated&&!0!==f?t.assign((0, J5._)(zr||(zr=yi(["","[","]"])),f,r),!0):i||o.allErrors||t.if((0, J5.not)(l),(function(){return t.break()}));}));}));}}};H5.default=Q5;var Y5={};Object.defineProperty(Y5,"__esModule",{value:!0});var X5=p2,Z5={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code:function(e){var t=e.gen,n=e.schema,r=e.it;if((0, X5.alwaysValidSchema)(r,n))e.fail();else {var i=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},i),e.failResult(i,(function(){return e.reset()}),(function(){return e.error()}));}},error:{message:"must NOT be valid"}};Y5.default=Z5;var e8={};Object.defineProperty(e8,"__esModule",{value:!0});var t8={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:R2().validateUnion,error:{message:"must match a schema in anyOf"}};e8.default=t8;var n8={};Object.defineProperty(n8,"__esModule",{value:!0});var r8=v2(),i8=p2,o8={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:function(e){var t=e.params;return (0, r8._)(qr||(qr=yi(["{passingSchemas: ","}"])),t.passing)}},code:function(e){var t=e.gen,n=e.schema,r=e.parentSchema,i=e.it;if(!Array.isArray(n))throw new Error("ajv implementation error");if(!i.opts.discriminator||!r.discriminator){var o=n,a=t.let("valid",!1),s=t.let("passing",null),c=t.name("_valid");e.setParams({passing:s}),t.block((function(){o.forEach((function(n,r){var o;(0, i8.alwaysValidSchema)(i,n)?t.var(c,!0):o=e.subschema({keyword:"oneOf",schemaProp:r,compositeRule:!0},c),r>0&&t.if((0, r8._)(Fr||(Fr=yi([""," && ",""])),c,a)).assign(a,!1).assign(s,(0, r8._)(Vr||(Vr=yi(["[",", ","]"])),s,r)).else(),t.if(c,(function(){t.assign(a,!0),t.assign(s,r),o&&e.mergeEvaluated(o,r8.Name);}));}));})),e.result(a,(function(){return e.reset()}),(function(){return e.error(!0)}));}}};n8.default=o8;var a8={};Object.defineProperty(a8,"__esModule",{value:!0});var s8=p2,c8={keyword:"allOf",schemaType:"array",code:function(e){var t=e.gen,n=e.schema,r=e.it;if(!Array.isArray(n))throw new Error("ajv implementation error");var i=t.name("valid");n.forEach((function(t,n){if(!(0, s8.alwaysValidSchema)(r,t)){var o=e.subschema({keyword:"allOf",schemaProp:n},i);e.ok(i),e.mergeEvaluated(o);}}));}};a8.default=c8;var u8={};Object.defineProperty(u8,"__esModule",{value:!0});var l8=v2(),f8=p2,h8={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:function(e){var t=e.params;return (0, l8.str)(Wr||(Wr=yi(['must match "','" schema'])),t.ifClause)},params:function(e){var t=e.params;return (0, l8._)(Hr||(Hr=yi(["{failingKeyword: ","}"])),t.ifClause)}},code:function(e){var t=e.gen,n=e.parentSchema,r=e.it;void 0===n.then&&void 0===n.else&&(0, f8.checkStrictMode)(r,'"if" without "then" and "else" is ignored');var i=d8(r,"then"),o=d8(r,"else");if(i||o){var a,s=t.let("valid",!0),c=t.name("_valid");if(a=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},c),e.mergeEvaluated(a),e.reset(),i&&o){var u=t.let("ifClause");e.setParams({ifClause:u}),t.if(c,l("then",u),l("else",u));}else i?t.if(c,l("then")):t.if((0, l8.not)(c),l("else"));e.pass(s,(function(){return e.error(!0)}));}function l(n,r){return function(){var i=e.subschema({keyword:n},c);t.assign(s,c),e.mergeValidEvaluated(i,s),r?t.assign(r,(0, l8._)(Ur||(Ur=yi(["",""])),n)):e.setParams({ifClause:n});}}}};function d8(e,t){var n=e.schema[t];return void 0!==n&&!(0, f8.alwaysValidSchema)(e,n)}u8.default=h8;var v8={};Object.defineProperty(v8,"__esModule",{value:!0});var p8=p2,m8={keyword:["then","else"],schemaType:["object","boolean"],code:function(e){var t=e.keyword,n=e.parentSchema,r=e.it;void 0===n.if&&(0, p8.checkStrictMode)(r,'"'.concat(t,'" without "if" is ignored'));}};v8.default=m8,Object.defineProperty(n5,"__esModule",{value:!0});var g8=r5,y8=c5,b8=u5,w8=g5,x8=j5,k8=O5,j8=M5,S8=T5,C8=B5,$8=H5,_8=Y5,O8=e8,M8=n8,E8=a8,A8=u8,P8=v8;n5.default=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[_8.default,O8.default,M8.default,E8.default,A8.default,P8.default,j8.default,S8.default,k8.default,C8.default,$8.default];return e?t.push(y8.default,w8.default):t.push(g8.default,b8.default),t.push(x8.default),t};var T8={},R8={};Object.defineProperty(R8,"__esModule",{value:!0});var N8=v2(),I8={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:function(e){var t=e.schemaCode;return (0, N8.str)(Jr||(Jr=yi(['must match format "','"'])),t)},params:function(e){var t=e.schemaCode;return (0, N8._)(Kr||(Kr=yi(["{format: ","}"])),t)}},code:function(e,t){var n=e.gen,r=e.data,i=e.$data,o=e.schema,a=e.schemaCode,s=e.it,c=s.opts,u=s.errSchemaPath,l=s.schemaEnv,f=s.self;c.validateFormats&&(i?function(){var i=n.scopeValue("formats",{ref:f.formats,code:c.code.formats}),o=n.const("fDef",(0, N8._)(Gr||(Gr=yi(["","[","]"])),i,a)),s=n.let("fType"),u=n.let("format");n.if((0, N8._)(Qr||(Qr=yi(["typeof ",' == "object" && !('," instanceof RegExp)"])),o,o),(function(){return n.assign(s,(0, N8._)(Yr||(Yr=yi(["",'.type || "string"'])),o)).assign(u,(0, N8._)(Xr||(Xr=yi(["",".validate"])),o))}),(function(){return n.assign(s,(0, N8._)(Zr||(Zr=yi(['"string"'])))).assign(u,o)})),e.fail$data((0, N8.or)(!1===c.strictSchema?N8.nil:(0, N8._)(ei||(ei=yi([""," && !",""])),a,u),(h=l.$async?(0, N8._)(ti||(ti=yi(["(",".async ? await ","(",") : ","(","))"])),o,u,r,u,r):(0, N8._)(ni||(ni=yi(["","(",")"])),u,r),d=(0, N8._)(ri||(ri=yi(["(typeof ",' == "function" ? '," : ",".test(","))"])),u,h,u,r),(0, N8._)(ii||(ii=yi([""," && "," !== true && "," === "," && !",""])),u,u,s,t,d))));var h,d;}():function(){var i=f.formats[o];if(!i)return void function(){if(!1===c.strictSchema)return void f.logger.warn(e());throw new Error(e());function e(){return 'unknown format "'.concat(o,'" ignored in schema at path "').concat(u,'"')}}();if(!0===i)return;var a=Si(function(e){var t=e instanceof RegExp?(0, N8.regexpCode)(e):c.code.formats?(0, N8._)(oi||(oi=yi(["","",""])),c.code.formats,(0, N8.getProperty)(o)):void 0,r=n.scopeValue("formats",{key:o,ref:e,code:t});if("object"==Ji(e)&&!(e instanceof RegExp))return [e.type||"string",e.validate,(0, N8._)(ai||(ai=yi(["",".validate"])),r)];return ["string",e,r]}(i),3),s=a[0],h=a[1],d=a[2];s===t&&e.pass(function(){if("object"==Ji(i)&&!(i instanceof RegExp)&&i.async){if(!l.$async)throw new Error("async format in sync schema");return (0, N8._)(si||(si=yi(["await ","(",")"])),d,r)}return "function"==typeof h?(0, N8._)(ci||(ci=yi(["","(",")"])),d,r):(0, N8._)(ui||(ui=yi(["",".test(",")"])),d,r)}());}());}};R8.default=I8,Object.defineProperty(T8,"__esModule",{value:!0});var D8=[R8.default];T8.default=D8;var L8={};Object.defineProperty(L8,"__esModule",{value:!0}),L8.contentVocabulary=L8.metadataVocabulary=void 0,L8.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],L8.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"],Object.defineProperty(E3,"__esModule",{value:!0});var B8=U3,z8=n5,q8=T8,F8=L8,V8=[A3.default,B8.default,(0, z8.default)(),q8.default,F8.metadataVocabulary,F8.contentVocabulary];E3.default=V8;var W8={},H8={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.DiscrError=void 0,(t=e.DiscrError||(e.DiscrError={})).Tag="tag",t.Mapping="mapping";}(H8),Object.defineProperty(W8,"__esModule",{value:!0});var U8=v2(),J8=H8,K8=l3,G8=p2,Q8={keyword:"discriminator",type:"object",schemaType:"object",error:{message:function(e){var t=e.params,n=t.discrError,r=t.tagName;return n===J8.DiscrError.Tag?'tag "'.concat(r,'" must be string'):'value of tag "'.concat(r,'" must be in oneOf')},params:function(e){var t=e.params,n=t.discrError,r=t.tag,i=t.tagName;return (0, U8._)(li||(li=yi(["{error: ",", tag: ",", tagValue: ","}"])),n,i,r)}},code:function(e){var t=e.gen,n=e.data,r=e.schema,i=e.parentSchema,o=e.it,a=i.oneOf;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");var s=r.propertyName;if("string"!=typeof s)throw new Error("discriminator: requires propertyName");if(r.mapping)throw new Error("discriminator: mapping is not supported");if(!a)throw new Error("discriminator: requires oneOf keyword");var c=t.let("valid",!1),u=t.const("tag",(0, U8._)(fi||(fi=yi(["","",""])),n,(0, U8.getProperty)(s)));function l(n){var r=t.name("valid"),i=e.subschema({keyword:"oneOf",schemaProp:n},r);return e.mergeEvaluated(i,U8.Name),r}t.if((0, U8._)(hi||(hi=yi(["typeof ",' == "string"'])),u),(function(){return function(){var n=function(){for(var e,t={},n=f(i),r=!0,c=0;c<a.length;c++){var u=a[c];(null==u?void 0:u.$ref)&&!(0, G8.schemaHasRulesButRef)(u,o.self.RULES)&&(u=K8.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,null==u?void 0:u.$ref))instanceof K8.SchemaEnv&&(u=u.schema);var l=null===(e=null==u?void 0:u.properties)||void 0===e?void 0:e[s];if("object"!=Ji(l))throw new Error('discriminator: oneOf subschemas (or referenced schemas) must have "properties/'.concat(s,'"'));r=r&&(n||f(u)),h(l,c);}if(!r)throw new Error('discriminator: "'.concat(s,'" must be required'));return t;function f(e){var t=e.required;return Array.isArray(t)&&t.includes(s)}function h(e,t){if(e.const)d(e.const,t);else {if(!e.enum)throw new Error('discriminator: "properties/'.concat(s,'" must have "const" or "enum"'));var n,r=wi(e.enum);try{for(r.s();!(n=r.n()).done;){d(n.value,t);}}catch(e){r.e(e);}finally{r.f();}}}function d(e,n){if("string"!=typeof e||e in t)throw new Error('discriminator: "'.concat(s,'" values must be unique strings'));t[e]=n;}}();for(var r in t.if(!1),n)t.elseIf((0, U8._)(di||(di=yi([""," === ",""])),u,r)),t.assign(c,l(n[r]));t.else(),e.error(!1,{discrError:J8.DiscrError.Mapping,tag:u,tagName:s}),t.endIf();}()}),(function(){return e.error(!1,{discrError:J8.DiscrError.Tag,tag:u,tagName:s})})),e.ok(c);}};W8.default=Q8;var Y8={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var n=E3,r=W8,i=Y8,o=["/properties"],a="http://json-schema.org/draft-07/schema",s=function(e){Pi(s,e);var t=Ri(s);function s(){return Bi(this,s),t.apply(this,arguments)}return qi(s,[{key:"_addVocabularies",value:function(){var e=this;Ei(Li(s.prototype),"_addVocabularies",this).call(this),n.default.forEach((function(t){return e.addVocabulary(t)})),this.opts.discriminator&&this.addKeyword(r.default);}},{key:"_addDefaultMetaSchema",value:function(){if(Ei(Li(s.prototype),"_addDefaultMetaSchema",this).call(this),this.opts.meta){var e=this.opts.$data?this.$dataMetaSchema(i,o):i;this.addMetaSchema(e,a,!1),this.refs["http://json-schema.org/schema"]=a;}}},{key:"defaultMeta",value:function(){return this.opts.defaultMeta=Ei(Li(s.prototype),"defaultMeta",this).call(this)||(this.getSchema(a)?a:void 0)}}]),s}(r2.default);e.exports=t=s,Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var c=r3();Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return c.KeywordCxt}});var u=v2();Object.defineProperty(t,"_",{enumerable:!0,get:function(){return u._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return u.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return u.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return u.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return u.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return u.CodeGen}});var l=a3();Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return l.default}});var f=u3();Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return f.default}});}(n2,n2.exports);yc(n2.exports);var n6={};!function(e){function t(e){return null!==e&&"[object Array]"===Object.prototype.toString.call(e)}function n(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function r(e,i){if(e===i)return !0;if(Object.prototype.toString.call(e)!==Object.prototype.toString.call(i))return !1;if(!0===t(e)){if(e.length!==i.length)return !1;for(var o=0;o<e.length;o++)if(!1===r(e[o],i[o]))return !1;return !0}if(!0===n(e)){var a={};for(var s in e)if(hasOwnProperty.call(e,s)){if(!1===r(e[s],i[s]))return !1;a[s]=!0;}for(var c in i)if(hasOwnProperty.call(i,c)&&!0!==a[c])return !1;return !0}return !1}function i(e){if(""===e||!1===e||null===e)return !0;if(t(e)&&0===e.length)return !0;if(n(e)){for(var r in e)if(e.hasOwnProperty(r))return !1;return !0}return !1}var o;o="function"==typeof String.prototype.trimLeft?function(e){return e.trimLeft()}:function(e){return e.match(/^\s*(.*)/)[1]};var a=0,s=2,c={0:"number",1:"any",2:"string",3:"array",4:"object",5:"boolean",6:"expression",7:"null",8:"Array<number>",9:"Array<string>"},u="EOF",l="UnquotedIdentifier",f="QuotedIdentifier",h="Rbracket",d="Rparen",v="Comma",p="Colon",m="Rbrace",g="Number",y="Current",b="Expref",w="Pipe",x="Or",k="And",j="EQ",S="GT",C="LT",$="GTE",_="LTE",O="NE",M="Flatten",E="Star",A="Filter",P="Dot",T="Not",R="Lbrace",N="Lbracket",I="Lparen",D="Literal",L={".":P,"*":E,",":v,":":p,"{":R,"}":m,"]":h,"(":I,")":d,"@":y},B={"<":!0,">":!0,"=":!0,"!":!0},z={" ":!0,"\t":!0,"\n":!0};function q(e){return e>="0"&&e<="9"||"-"===e}function F(){}F.prototype={tokenize:function(e){var t,n,r,i,o=[];for(this._current=0;this._current<e.length;)if((i=e[this._current])>="a"&&i<="z"||i>="A"&&i<="Z"||"_"===i)t=this._current,n=this._consumeUnquotedIdentifier(e),o.push({type:l,value:n,start:t});else if(void 0!==L[e[this._current]])o.push({type:L[e[this._current]],value:e[this._current],start:this._current}),this._current++;else if(q(e[this._current]))r=this._consumeNumber(e),o.push(r);else if("["===e[this._current])r=this._consumeLBracket(e),o.push(r);else if('"'===e[this._current])t=this._current,n=this._consumeQuotedIdentifier(e),o.push({type:f,value:n,start:t});else if("'"===e[this._current])t=this._current,n=this._consumeRawStringLiteral(e),o.push({type:D,value:n,start:t});else if("`"===e[this._current]){t=this._current;var a=this._consumeLiteral(e);o.push({type:D,value:a,start:t});}else if(void 0!==B[e[this._current]])o.push(this._consumeOperator(e));else if(void 0!==z[e[this._current]])this._current++;else if("&"===e[this._current])t=this._current,this._current++,"&"===e[this._current]?(this._current++,o.push({type:k,value:"&&",start:t})):o.push({type:b,value:"&",start:t});else {if("|"!==e[this._current]){var s=new Error("Unknown character:"+e[this._current]);throw s.name="LexerError",s}t=this._current,this._current++,"|"===e[this._current]?(this._current++,o.push({type:x,value:"||",start:t})):o.push({type:w,value:"|",start:t});}return o},_consumeUnquotedIdentifier:function(e){var t,n=this._current;for(this._current++;this._current<e.length&&((t=e[this._current])>="a"&&t<="z"||t>="A"&&t<="Z"||t>="0"&&t<="9"||"_"===t);)this._current++;return e.slice(n,this._current)},_consumeQuotedIdentifier:function(e){var t=this._current;this._current++;for(var n=e.length;'"'!==e[this._current]&&this._current<n;){var r=this._current;"\\"!==e[r]||"\\"!==e[r+1]&&'"'!==e[r+1]?r++:r+=2,this._current=r;}return this._current++,JSON.parse(e.slice(t,this._current))},_consumeRawStringLiteral:function(e){var t=this._current;this._current++;for(var n=e.length;"'"!==e[this._current]&&this._current<n;){var r=this._current;"\\"!==e[r]||"\\"!==e[r+1]&&"'"!==e[r+1]?r++:r+=2,this._current=r;}return this._current++,e.slice(t+1,this._current-1).replace("\\'","'")},_consumeNumber:function(e){var t=this._current;this._current++;for(var n=e.length;q(e[this._current])&&this._current<n;)this._current++;var r=parseInt(e.slice(t,this._current));return {type:g,value:r,start:t}},_consumeLBracket:function(e){var t=this._current;return this._current++,"?"===e[this._current]?(this._current++,{type:A,value:"[?",start:t}):"]"===e[this._current]?(this._current++,{type:M,value:"[]",start:t}):{type:N,value:"[",start:t}},_consumeOperator:function(e){var t=this._current,n=e[t];return this._current++,"!"===n?"="===e[this._current]?(this._current++,{type:O,value:"!=",start:t}):{type:T,value:"!",start:t}:"<"===n?"="===e[this._current]?(this._current++,{type:_,value:"<=",start:t}):{type:C,value:"<",start:t}:">"===n?"="===e[this._current]?(this._current++,{type:$,value:">=",start:t}):{type:S,value:">",start:t}:"="===n&&"="===e[this._current]?(this._current++,{type:j,value:"==",start:t}):void 0},_consumeLiteral:function(e){this._current++;for(var t,n=this._current,r=e.length;"`"!==e[this._current]&&this._current<r;){var i=this._current;"\\"!==e[i]||"\\"!==e[i+1]&&"`"!==e[i+1]?i++:i+=2,this._current=i;}var a=o(e.slice(n,this._current));return a=a.replace("\\`","`"),t=this._looksLikeJSON(a)?JSON.parse(a):JSON.parse('"'+a+'"'),this._current++,t},_looksLikeJSON:function(e){if(""===e)return !1;if('[{"'.indexOf(e[0])>=0)return !0;if(["true","false","null"].indexOf(e)>=0)return !0;if(!("-0123456789".indexOf(e[0])>=0))return !1;try{return JSON.parse(e),!0}catch(e){return !1}}};var V={};function W(){}function H(e){this.runtime=e;}function U(e){this._interpreter=e,this.functionTable={abs:{_func:this._functionAbs,_signature:[{types:[a]}]},avg:{_func:this._functionAvg,_signature:[{types:[8]}]},ceil:{_func:this._functionCeil,_signature:[{types:[a]}]},contains:{_func:this._functionContains,_signature:[{types:[s,3]},{types:[1]}]},ends_with:{_func:this._functionEndsWith,_signature:[{types:[s]},{types:[s]}]},floor:{_func:this._functionFloor,_signature:[{types:[a]}]},length:{_func:this._functionLength,_signature:[{types:[s,3,4]}]},map:{_func:this._functionMap,_signature:[{types:[6]},{types:[3]}]},max:{_func:this._functionMax,_signature:[{types:[8,9]}]},merge:{_func:this._functionMerge,_signature:[{types:[4],variadic:!0}]},max_by:{_func:this._functionMaxBy,_signature:[{types:[3]},{types:[6]}]},sum:{_func:this._functionSum,_signature:[{types:[8]}]},starts_with:{_func:this._functionStartsWith,_signature:[{types:[s]},{types:[s]}]},min:{_func:this._functionMin,_signature:[{types:[8,9]}]},min_by:{_func:this._functionMinBy,_signature:[{types:[3]},{types:[6]}]},type:{_func:this._functionType,_signature:[{types:[1]}]},keys:{_func:this._functionKeys,_signature:[{types:[4]}]},values:{_func:this._functionValues,_signature:[{types:[4]}]},sort:{_func:this._functionSort,_signature:[{types:[9,8]}]},sort_by:{_func:this._functionSortBy,_signature:[{types:[3]},{types:[6]}]},join:{_func:this._functionJoin,_signature:[{types:[s]},{types:[9]}]},reverse:{_func:this._functionReverse,_signature:[{types:[s,3]}]},to_array:{_func:this._functionToArray,_signature:[{types:[1]}]},to_string:{_func:this._functionToString,_signature:[{types:[1]}]},to_number:{_func:this._functionToNumber,_signature:[{types:[1]}]},not_null:{_func:this._functionNotNull,_signature:[{types:[1],variadic:!0}]}};}V.EOF=0,V.UnquotedIdentifier=0,V.QuotedIdentifier=0,V.Rbracket=0,V.Rparen=0,V.Comma=0,V.Rbrace=0,V.Number=0,V.Current=0,V.Expref=0,V.Pipe=1,V.Or=2,V.And=3,V.EQ=5,V.GT=5,V.LT=5,V.GTE=5,V.LTE=5,V.NE=5,V.Flatten=9,V.Star=20,V.Filter=21,V.Dot=40,V.Not=45,V.Lbrace=50,V.Lbracket=55,V.Lparen=60,W.prototype={parse:function(e){this._loadTokens(e),this.index=0;var t=this.expression(0);if(this._lookahead(0)!==u){var n=this._lookaheadToken(0),r=new Error("Unexpected token type: "+n.type+", value: "+n.value);throw r.name="ParserError",r}return t},_loadTokens:function(e){var t=(new F).tokenize(e);t.push({type:u,value:"",start:e.length}),this.tokens=t;},expression:function(e){var t=this._lookaheadToken(0);this._advance();for(var n=this.nud(t),r=this._lookahead(0);e<V[r];)this._advance(),n=this.led(r,n),r=this._lookahead(0);return n},_lookahead:function(e){return this.tokens[this.index+e].type},_lookaheadToken:function(e){return this.tokens[this.index+e]},_advance:function(){this.index++;},nud:function(e){var t,n;switch(e.type){case D:return {type:"Literal",value:e.value};case l:return {type:"Field",name:e.value};case f:var r={type:"Field",name:e.value};if(this._lookahead(0)===I)throw new Error("Quoted identifier not allowed for function names.");return r;case T:return {type:"NotExpression",children:[t=this.expression(V.Not)]};case E:return t=null,{type:"ValueProjection",children:[{type:"Identity"},t=this._lookahead(0)===h?{type:"Identity"}:this._parseProjectionRHS(V.Star)]};case A:return this.led(e.type,{type:"Identity"});case R:return this._parseMultiselectHash();case M:return {type:"Projection",children:[{type:M,children:[{type:"Identity"}]},t=this._parseProjectionRHS(V.Flatten)]};case N:return this._lookahead(0)===g||this._lookahead(0)===p?(t=this._parseIndexExpression(),this._projectIfSlice({type:"Identity"},t)):this._lookahead(0)===E&&this._lookahead(1)===h?(this._advance(),this._advance(),{type:"Projection",children:[{type:"Identity"},t=this._parseProjectionRHS(V.Star)]}):this._parseMultiselectList();case y:return {type:y};case b:return {type:"ExpressionReference",children:[n=this.expression(V.Expref)]};case I:for(var i=[];this._lookahead(0)!==d;)this._lookahead(0)===y?(n={type:y},this._advance()):n=this.expression(0),i.push(n);return this._match(d),i[0];default:this._errorToken(e);}},led:function(e,t){var n;switch(e){case P:var r=V.Dot;return this._lookahead(0)!==E?{type:"Subexpression",children:[t,n=this._parseDotRHS(r)]}:(this._advance(),{type:"ValueProjection",children:[t,n=this._parseProjectionRHS(r)]});case w:return n=this.expression(V.Pipe),{type:w,children:[t,n]};case x:return {type:"OrExpression",children:[t,n=this.expression(V.Or)]};case k:return {type:"AndExpression",children:[t,n=this.expression(V.And)]};case I:for(var i,o=t.name,a=[];this._lookahead(0)!==d;)this._lookahead(0)===y?(i={type:y},this._advance()):i=this.expression(0),this._lookahead(0)===v&&this._match(v),a.push(i);return this._match(d),{type:"Function",name:o,children:a};case A:var s=this.expression(0);return this._match(h),{type:"FilterProjection",children:[t,n=this._lookahead(0)===M?{type:"Identity"}:this._parseProjectionRHS(V.Filter),s]};case M:return {type:"Projection",children:[{type:M,children:[t]},this._parseProjectionRHS(V.Flatten)]};case j:case O:case S:case $:case C:case _:return this._parseComparator(t,e);case N:var c=this._lookaheadToken(0);return c.type===g||c.type===p?(n=this._parseIndexExpression(),this._projectIfSlice(t,n)):(this._match(E),this._match(h),{type:"Projection",children:[t,n=this._parseProjectionRHS(V.Star)]});default:this._errorToken(this._lookaheadToken(0));}},_match:function(e){if(this._lookahead(0)!==e){var t=this._lookaheadToken(0),n=new Error("Expected "+e+", got: "+t.type);throw n.name="ParserError",n}this._advance();},_errorToken:function(e){var t=new Error("Invalid token ("+e.type+'): "'+e.value+'"');throw t.name="ParserError",t},_parseIndexExpression:function(){if(this._lookahead(0)===p||this._lookahead(1)===p)return this._parseSliceExpression();var e={type:"Index",value:this._lookaheadToken(0).value};return this._advance(),this._match(h),e},_projectIfSlice:function(e,t){var n={type:"IndexExpression",children:[e,t]};return "Slice"===t.type?{type:"Projection",children:[n,this._parseProjectionRHS(V.Star)]}:n},_parseSliceExpression:function(){for(var e=[null,null,null],t=0,n=this._lookahead(0);n!==h&&t<3;){if(n===p)t++,this._advance();else {if(n!==g){var r=this._lookahead(0),i=new Error("Syntax error, unexpected token: "+r.value+"("+r.type+")");throw i.name="Parsererror",i}e[t]=this._lookaheadToken(0).value,this._advance();}n=this._lookahead(0);}return this._match(h),{type:"Slice",children:e}},_parseComparator:function(e,t){return {type:"Comparator",name:t,children:[e,this.expression(V[t])]}},_parseDotRHS:function(e){var t=this._lookahead(0);return [l,f,E].indexOf(t)>=0?this.expression(e):t===N?(this._match(N),this._parseMultiselectList()):t===R?(this._match(R),this._parseMultiselectHash()):void 0},_parseProjectionRHS:function(e){var t;if(V[this._lookahead(0)]<10)t={type:"Identity"};else if(this._lookahead(0)===N)t=this.expression(e);else if(this._lookahead(0)===A)t=this.expression(e);else {if(this._lookahead(0)!==P){var n=this._lookaheadToken(0),r=new Error("Sytanx error, unexpected token: "+n.value+"("+n.type+")");throw r.name="ParserError",r}this._match(P),t=this._parseDotRHS(e);}return t},_parseMultiselectList:function(){for(var e=[];this._lookahead(0)!==h;){var t=this.expression(0);if(e.push(t),this._lookahead(0)===v&&(this._match(v),this._lookahead(0)===h))throw new Error("Unexpected token Rbracket")}return this._match(h),{type:"MultiSelectList",children:e}},_parseMultiselectHash:function(){for(var e,t,n,r=[],i=[l,f];;){if(e=this._lookaheadToken(0),i.indexOf(e.type)<0)throw new Error("Expecting an identifier token, got: "+e.type);if(t=e.value,this._advance(),this._match(p),n={type:"KeyValuePair",name:t,value:this.expression(0)},r.push(n),this._lookahead(0)===v)this._match(v);else if(this._lookahead(0)===m){this._match(m);break}}return {type:"MultiSelectHash",children:r}}},H.prototype={search:function(e,t){return this.visit(e,t)},visit:function(e,o){var a,s,c,u,l,f,h,d,v;switch(e.type){case"Field":return null!==o&&n(o)?void 0===(f=o[e.name])?null:f:null;case"Subexpression":for(c=this.visit(e.children[0],o),v=1;v<e.children.length;v++)if(null===(c=this.visit(e.children[1],c)))return null;return c;case"IndexExpression":return h=this.visit(e.children[0],o),this.visit(e.children[1],h);case"Index":if(!t(o))return null;var p=e.value;return p<0&&(p=o.length+p),void 0===(c=o[p])&&(c=null),c;case"Slice":if(!t(o))return null;var m=e.children.slice(0),g=this.computeSliceParams(o.length,m),x=g[0],k=g[1],E=g[2];if(c=[],E>0)for(v=x;v<k;v+=E)c.push(o[v]);else for(v=x;v>k;v+=E)c.push(o[v]);return c;case"Projection":var A=this.visit(e.children[0],o);if(!t(A))return null;for(d=[],v=0;v<A.length;v++)null!==(s=this.visit(e.children[1],A[v]))&&d.push(s);return d;case"ValueProjection":if(!n(A=this.visit(e.children[0],o)))return null;d=[];var P=function(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;r++)n.push(e[t[r]]);return n}(A);for(v=0;v<P.length;v++)null!==(s=this.visit(e.children[1],P[v]))&&d.push(s);return d;case"FilterProjection":if(!t(A=this.visit(e.children[0],o)))return null;var T=[],R=[];for(v=0;v<A.length;v++)i(a=this.visit(e.children[2],A[v]))||T.push(A[v]);for(var N=0;N<T.length;N++)null!==(s=this.visit(e.children[1],T[N]))&&R.push(s);return R;case"Comparator":switch(u=this.visit(e.children[0],o),l=this.visit(e.children[1],o),e.name){case j:c=r(u,l);break;case O:c=!r(u,l);break;case S:c=u>l;break;case $:c=u>=l;break;case C:c=u<l;break;case _:c=u<=l;break;default:throw new Error("Unknown comparator: "+e.name)}return c;case M:var I=this.visit(e.children[0],o);if(!t(I))return null;var D=[];for(v=0;v<I.length;v++)t(s=I[v])?D.push.apply(D,s):D.push(s);return D;case"Identity":return o;case"MultiSelectList":if(null===o)return null;for(d=[],v=0;v<e.children.length;v++)d.push(this.visit(e.children[v],o));return d;case"MultiSelectHash":if(null===o)return null;var L;for(d={},v=0;v<e.children.length;v++)d[(L=e.children[v]).name]=this.visit(L.value,o);return d;case"OrExpression":return i(a=this.visit(e.children[0],o))&&(a=this.visit(e.children[1],o)),a;case"AndExpression":return !0===i(u=this.visit(e.children[0],o))?u:this.visit(e.children[1],o);case"NotExpression":return i(u=this.visit(e.children[0],o));case"Literal":return e.value;case w:return h=this.visit(e.children[0],o),this.visit(e.children[1],h);case y:return o;case"Function":var B=[];for(v=0;v<e.children.length;v++)B.push(this.visit(e.children[v],o));return this.runtime.callFunction(e.name,B);case"ExpressionReference":var z=e.children[0];return z.jmespathType=b,z;default:throw new Error("Unknown node type: "+e.type)}},computeSliceParams:function(e,t){var n=t[0],r=t[1],i=t[2],o=[null,null,null];if(null===i)i=1;else if(0===i){var a=new Error("Invalid slice, step cannot be 0");throw a.name="RuntimeError",a}var s=i<0;return n=null===n?s?e-1:0:this.capSliceRange(e,n,i),r=null===r?s?-1:e:this.capSliceRange(e,r,i),o[0]=n,o[1]=r,o[2]=i,o},capSliceRange:function(e,t,n){return t<0?(t+=e)<0&&(t=n<0?-1:0):t>=e&&(t=n<0?e-1:e),t}},U.prototype={callFunction:function(e,t){var n=this.functionTable[e];if(void 0===n)throw new Error("Unknown function: "+e+"()");return this._validateArgs(e,t,n._signature),n._func.call(this,t)},_validateArgs:function(e,t,n){var r,i,o,a;if(n[n.length-1].variadic){if(t.length<n.length)throw r=1===n.length?" argument":" arguments",new Error("ArgumentError: "+e+"() takes at least"+n.length+r+" but received "+t.length)}else if(t.length!==n.length)throw r=1===n.length?" argument":" arguments",new Error("ArgumentError: "+e+"() takes "+n.length+r+" but received "+t.length);for(var s=0;s<n.length;s++){a=!1,i=n[s].types,o=this._getTypeName(t[s]);for(var u=0;u<i.length;u++)if(this._typeMatches(o,i[u],t[s])){a=!0;break}if(!a){var l=i.map((function(e){return c[e]})).join(",");throw new Error("TypeError: "+e+"() expected argument "+(s+1)+" to be type "+l+" but received type "+c[o]+" instead.")}}},_typeMatches:function(e,t,n){if(1===t)return !0;if(9!==t&&8!==t&&3!==t)return e===t;if(3===t)return 3===e;if(3===e){var r;8===t?r=a:9===t&&(r=s);for(var i=0;i<n.length;i++)if(!this._typeMatches(this._getTypeName(n[i]),r,n[i]))return !1;return !0}},_getTypeName:function(e){switch(Object.prototype.toString.call(e)){case"[object String]":return s;case"[object Number]":return a;case"[object Array]":return 3;case"[object Boolean]":return 5;case"[object Null]":return 7;case"[object Object]":return e.jmespathType===b?6:4}},_functionStartsWith:function(e){return 0===e[0].lastIndexOf(e[1])},_functionEndsWith:function(e){var t=e[0],n=e[1];return -1!==t.indexOf(n,t.length-n.length)},_functionReverse:function(e){if(this._getTypeName(e[0])===s){for(var t=e[0],n="",r=t.length-1;r>=0;r--)n+=t[r];return n}var i=e[0].slice(0);return i.reverse(),i},_functionAbs:function(e){return Math.abs(e[0])},_functionCeil:function(e){return Math.ceil(e[0])},_functionAvg:function(e){for(var t=0,n=e[0],r=0;r<n.length;r++)t+=n[r];return t/n.length},_functionContains:function(e){return e[0].indexOf(e[1])>=0},_functionFloor:function(e){return Math.floor(e[0])},_functionLength:function(e){return n(e[0])?Object.keys(e[0]).length:e[0].length},_functionMap:function(e){for(var t=[],n=this._interpreter,r=e[0],i=e[1],o=0;o<i.length;o++)t.push(n.visit(r,i[o]));return t},_functionMerge:function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];for(var i in r)t[i]=r[i];}return t},_functionMax:function(e){if(e[0].length>0){if(this._getTypeName(e[0][0])===a)return Math.max.apply(Math,e[0]);for(var t=e[0],n=t[0],r=1;r<t.length;r++)n.localeCompare(t[r])<0&&(n=t[r]);return n}return null},_functionMin:function(e){if(e[0].length>0){if(this._getTypeName(e[0][0])===a)return Math.min.apply(Math,e[0]);for(var t=e[0],n=t[0],r=1;r<t.length;r++)t[r].localeCompare(n)<0&&(n=t[r]);return n}return null},_functionSum:function(e){for(var t=0,n=e[0],r=0;r<n.length;r++)t+=n[r];return t},_functionType:function(e){switch(this._getTypeName(e[0])){case a:return "number";case s:return "string";case 3:return "array";case 4:return "object";case 5:return "boolean";case 6:return "expref";case 7:return "null"}},_functionKeys:function(e){return Object.keys(e[0])},_functionValues:function(e){for(var t=e[0],n=Object.keys(t),r=[],i=0;i<n.length;i++)r.push(t[n[i]]);return r},_functionJoin:function(e){var t=e[0];return e[1].join(t)},_functionToArray:function(e){return 3===this._getTypeName(e[0])?e[0]:[e[0]]},_functionToString:function(e){return this._getTypeName(e[0])===s?e[0]:JSON.stringify(e[0])},_functionToNumber:function(e){var t,n=this._getTypeName(e[0]);return n===a?e[0]:n!==s||(t=+e[0],isNaN(t))?null:t},_functionNotNull:function(e){for(var t=0;t<e.length;t++)if(7!==this._getTypeName(e[t]))return e[t];return null},_functionSort:function(e){var t=e[0].slice(0);return t.sort(),t},_functionSortBy:function(e){var t=e[0].slice(0);if(0===t.length)return t;var n=this._interpreter,r=e[1],i=this._getTypeName(n.visit(r,t[0]));if([a,s].indexOf(i)<0)throw new Error("TypeError");for(var o=this,c=[],u=0;u<t.length;u++)c.push([u,t[u]]);c.sort((function(e,t){var a=n.visit(r,e[1]),s=n.visit(r,t[1]);if(o._getTypeName(a)!==i)throw new Error("TypeError: expected "+i+", received "+o._getTypeName(a));if(o._getTypeName(s)!==i)throw new Error("TypeError: expected "+i+", received "+o._getTypeName(s));return a>s?1:a<s?-1:e[0]-t[0]}));for(var l=0;l<c.length;l++)t[l]=c[l][1];return t},_functionMaxBy:function(e){for(var t,n,r=e[1],i=e[0],o=this.createKeyFunction(r,[a,s]),c=-1/0,u=0;u<i.length;u++)(n=o(i[u]))>c&&(c=n,t=i[u]);return t},_functionMinBy:function(e){for(var t,n,r=e[1],i=e[0],o=this.createKeyFunction(r,[a,s]),c=1/0,u=0;u<i.length;u++)(n=o(i[u]))<c&&(c=n,t=i[u]);return t},createKeyFunction:function(e,t){var n=this,r=this._interpreter;return function(i){var o=r.visit(e,i);if(t.indexOf(n._getTypeName(o))<0){var a="TypeError: expected one of "+t+", received "+n._getTypeName(o);throw new Error(a)}return o}}},e.tokenize=function(e){return (new F).tokenize(e)},e.compile=function(e){return (new W).parse(e)},e.search=function(e,t){var n=new W,r=new U,i=new H(r);r._interpreter=i;var o=n.parse(t);return i.search(o,e)},e.strictDeepEqual=r;}(n6);yc(n6);/*!
 * vanilla-picker v2.12.1
 * https://vanilla-picker.js.org
 *
 * Copyright 2017-2021 Andreas Borgen (https://github.com/Sphinxxxx), Adam Brooks (https://github.com/dissimulate)
 * Released under the ISC license.
 */var s6=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},c6=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u6=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e;}finally{try{!r&&s.return&&s.return();}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};String.prototype.startsWith=String.prototype.startsWith||function(e){return 0===this.indexOf(e)},String.prototype.padStart=String.prototype.padStart||function(e,t){for(var n=this;n.length<e;)n=t+n;return n};var l6={cb:"0f8ff",tqw:"aebd7",q:"-ffff",qmrn:"7fffd4",zr:"0ffff",bg:"5f5dc",bsq:"e4c4",bck:"---",nch:"ebcd",b:"--ff",bvt:"8a2be2",brwn:"a52a2a",brw:"deb887",ctb:"5f9ea0",hrt:"7fff-",chcT:"d2691e",cr:"7f50",rnw:"6495ed",crns:"8dc",crms:"dc143c",cn:"-ffff",Db:"--8b",Dcn:"-8b8b",Dgnr:"b8860b",Dgr:"a9a9a9",Dgrn:"-64-",Dkhk:"bdb76b",Dmgn:"8b-8b",Dvgr:"556b2f",Drng:"8c-",Drch:"9932cc",Dr:"8b--",Dsmn:"e9967a",Dsgr:"8fbc8f",DsTb:"483d8b",DsTg:"2f4f4f",Dtrq:"-ced1",Dvt:"94-d3",ppnk:"1493",pskb:"-bfff",mgr:"696969",grb:"1e90ff",rbrc:"b22222",rwht:"af0",stg:"228b22",chs:"-ff",gnsb:"dcdcdc",st:"8f8ff",g:"d7-",gnr:"daa520",gr:"808080",grn:"-8-0",grnw:"adff2f",hnw:"0fff0",htpn:"69b4",nnr:"cd5c5c",ng:"4b-82",vr:"0",khk:"0e68c",vnr:"e6e6fa",nrb:"0f5",wngr:"7cfc-",mnch:"acd",Lb:"add8e6",Lcr:"08080",Lcn:"e0ffff",Lgnr:"afad2",Lgr:"d3d3d3",Lgrn:"90ee90",Lpnk:"b6c1",Lsmn:"a07a",Lsgr:"20b2aa",Lskb:"87cefa",LsTg:"778899",Lstb:"b0c4de",Lw:"e0",m:"-ff-",mgrn:"32cd32",nn:"af0e6",mgnt:"-ff",mrn:"8--0",mqm:"66cdaa",mmb:"--cd",mmrc:"ba55d3",mmpr:"9370db",msg:"3cb371",mmsT:"7b68ee","":"-fa9a",mtr:"48d1cc",mmvt:"c71585",mnLb:"191970",ntc:"5fffa",mstr:"e4e1",mccs:"e4b5",vjw:"dead",nv:"--80",c:"df5e6",v:"808-0",vrb:"6b8e23",rng:"a5-",rngr:"45-",rch:"da70d6",pgnr:"eee8aa",pgrn:"98fb98",ptrq:"afeeee",pvtr:"db7093",ppwh:"efd5",pchp:"dab9",pr:"cd853f",pnk:"c0cb",pm:"dda0dd",pwrb:"b0e0e6",prp:"8-080",cc:"663399",r:"--",sbr:"bc8f8f",rb:"4169e1",sbrw:"8b4513",smn:"a8072",nbr:"4a460",sgrn:"2e8b57",ssh:"5ee",snn:"a0522d",svr:"c0c0c0",skb:"87ceeb",sTb:"6a5acd",sTgr:"708090",snw:"afa",n:"-ff7f",stb:"4682b4",tn:"d2b48c",t:"-8080",thst:"d8bfd8",tmT:"6347",trqs:"40e0d0",vt:"ee82ee",whT:"5deb3",wht:"",hts:"5f5f5",w:"-",wgrn:"9acd32"};function f6(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=t>0?e.toFixed(t).replace(/0+$/,"").replace(/\.$/,""):e.toString();return n||"0"}var h6=function(){function e(t,n,r,i){s6(this,e);var o=this;if(void 0===t);else if(Array.isArray(t))this.rgba=t;else if(void 0===r){var a=t&&""+t;a&&function(t){if(t.startsWith("hsl")){var n=t.match(/([\-\d\.e]+)/g).map(Number),r=u6(n,4),i=r[0],a=r[1],s=r[2],c=r[3];void 0===c&&(c=1),i/=360,a/=100,s/=100,o.hsla=[i,a,s,c];}else if(t.startsWith("rgb")){var u=t.match(/([\-\d\.e]+)/g).map(Number),l=u6(u,4),f=l[0],h=l[1],d=l[2],v=l[3];void 0===v&&(v=1),o.rgba=[f,h,d,v];}else t.startsWith("#")?o.rgba=e.hexToRgb(t):o.rgba=e.nameToRgb(t)||e.hexToRgb(t);}(a.toLowerCase());}else this.rgba=[t,n,r,void 0===i?1:i];}return c6(e,[{key:"printRGB",value:function(e){var t=(e?this.rgba:this.rgba.slice(0,3)).map((function(e,t){return f6(e,3===t?3:0)}));return e?"rgba("+t+")":"rgb("+t+")"}},{key:"printHSL",value:function(e){var t=[360,100,100,1],n=["","%","%",""],r=(e?this.hsla:this.hsla.slice(0,3)).map((function(e,r){return f6(e*t[r],3===r?3:1)+n[r]}));return e?"hsla("+r+")":"hsl("+r+")"}},{key:"printHex",value:function(e){var t=this.hex;return e?t:t.substring(0,7)}},{key:"rgba",get:function(){if(this._rgba)return this._rgba;if(!this._hsla)throw new Error("No color is set");return this._rgba=e.hslToRgb(this._hsla)},set:function(e){3===e.length&&(e[3]=1),this._rgba=e,this._hsla=null;}},{key:"rgbString",get:function(){return this.printRGB()}},{key:"rgbaString",get:function(){return this.printRGB(!0)}},{key:"hsla",get:function(){if(this._hsla)return this._hsla;if(!this._rgba)throw new Error("No color is set");return this._hsla=e.rgbToHsl(this._rgba)},set:function(e){3===e.length&&(e[3]=1),this._hsla=e,this._rgba=null;}},{key:"hslString",get:function(){return this.printHSL()}},{key:"hslaString",get:function(){return this.printHSL(!0)}},{key:"hex",get:function(){var e=this.rgba.map((function(e,t){return t<3?e.toString(16):Math.round(255*e).toString(16)}));return "#"+e.map((function(e){return e.padStart(2,"0")})).join("")},set:function(t){this.rgba=e.hexToRgb(t);}}],[{key:"hexToRgb",value:function(e){var t=(e.startsWith("#")?e.slice(1):e).replace(/^(\w{3})$/,"$1F").replace(/^(\w)(\w)(\w)(\w)$/,"$1$1$2$2$3$3$4$4").replace(/^(\w{6})$/,"$1FF");if(!t.match(/^([0-9a-fA-F]{8})$/))throw new Error("Unknown hex color; "+e);var n=t.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map((function(e){return parseInt(e,16)}));return n[3]=n[3]/255,n}},{key:"nameToRgb",value:function(t){var n=t.toLowerCase().replace("at","T").replace(/[aeiouyldf]/g,"").replace("ght","L").replace("rk","D").slice(-5,4),r=l6[n];return void 0===r?r:e.hexToRgb(r.replace(/\-/g,"00").padStart(6,"f"))}},{key:"rgbToHsl",value:function(e){var t=u6(e,4),n=t[0],r=t[1],i=t[2],o=t[3];n/=255,r/=255,i/=255;var a=Math.max(n,r,i),s=Math.min(n,r,i),c=void 0,u=void 0,l=(a+s)/2;if(a===s)c=u=0;else {var f=a-s;switch(u=l>.5?f/(2-a-s):f/(a+s),a){case n:c=(r-i)/f+(r<i?6:0);break;case r:c=(i-n)/f+2;break;case i:c=(n-r)/f+4;}c/=6;}return [c,u,l,o]}},{key:"hslToRgb",value:function(e){var t=u6(e,4),n=t[0],r=t[1],i=t[2],o=t[3],a=void 0,s=void 0,c=void 0;if(0===r)a=s=c=i;else {var u=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},l=i<.5?i*(1+r):i+r-i*r,f=2*i-l;a=u(f,l,n+1/3),s=u(f,l,n),c=u(f,l,n-1/3);}var h=[255*a,255*s,255*c].map(Math.round);return h[3]=o,h}}]),e}(),d6=function(){function e(){s6(this,e),this._events=[];}return c6(e,[{key:"add",value:function(e,t,n){e.addEventListener(t,n,!1),this._events.push({target:e,type:t,handler:n});}},{key:"remove",value:function(t,n,r){this._events=this._events.filter((function(i){var o=!0;return t&&t!==i.target&&(o=!1),n&&n!==i.type&&(o=!1),r&&r!==i.handler&&(o=!1),o&&e._doRemove(i.target,i.type,i.handler),!o}));}},{key:"destroy",value:function(){this._events.forEach((function(t){return e._doRemove(t.target,t.type,t.handler)})),this._events=[];}}],[{key:"_doRemove",value:function(e,t,n){e.removeEventListener(t,n,!1);}}]),e}();function v6(e,t,n){var r=!1;function i(e,t,n){return Math.max(t,Math.min(e,n))}function o(e,o,a){if(a&&(r=!0),r){e.preventDefault();var s=t.getBoundingClientRect(),c=s.width,u=s.height,l=o.clientX,f=o.clientY,h=i(l-s.left,0,c),d=i(f-s.top,0,u);n(h/c,d/u);}}function a(e,t){1===(void 0===e.buttons?e.which:e.buttons)?o(e,e,t):r=!1;}function s(e,t){1===e.touches.length?o(e,e.touches[0],t):r=!1;}e.add(t,"mousedown",(function(e){a(e,!0);})),e.add(t,"touchstart",(function(e){s(e,!0);})),e.add(window,"mousemove",a),e.add(t,"touchmove",s),e.add(window,"mouseup",(function(e){r=!1;})),e.add(t,"touchend",(function(e){r=!1;})),e.add(t,"touchcancel",(function(e){r=!1;}));}function p6(e,t){return (t||document).querySelector(e)}function m6(e){e.preventDefault(),e.stopPropagation();}function g6(e,t,n,r,i){e.add(t,"keydown",(function(e){n.indexOf(e.key)>=0&&(i&&m6(e),r(e));}));}var y6=function(){function e(t){s6(this,e),this.settings={popup:"right",layout:"default",alpha:!0,editor:!0,editorFormat:"hex",cancelButton:!1,defaultColor:"#0cf"},this._events=new d6,this.onChange=null,this.onDone=null,this.onOpen=null,this.onClose=null,this.setOptions(t);}return c6(e,[{key:"setOptions",value:function(e){var t=this;if(e){var n=this.settings;if(e instanceof HTMLElement)n.parent=e;else {n.parent&&e.parent&&n.parent!==e.parent&&(this._events.remove(n.parent),this._popupInited=!1),function(e,t,n){for(var r in e)n&&n.indexOf(r)>=0||(t[r]=e[r]);}(e,n),e.onChange&&(this.onChange=e.onChange),e.onDone&&(this.onDone=e.onDone),e.onOpen&&(this.onOpen=e.onOpen),e.onClose&&(this.onClose=e.onClose);var r=e.color||e.colour;r&&this._setColor(r);}var i=n.parent;if(i&&n.popup&&!this._popupInited){var o=function(e){return t.openHandler(e)};this._events.add(i,"click",o),g6(this._events,i,[" ","Spacebar","Enter"],o),this._popupInited=!0;}else e.parent&&!n.popup&&this.show();}}},{key:"openHandler",value:function(e){if(this.show()){e&&e.preventDefault(),this.settings.parent.style.pointerEvents="none";var t=e&&"keydown"===e.type?this._domEdit:this.domElement;setTimeout((function(){return t.focus()}),100),this.onOpen&&this.onOpen(this.colour);}}},{key:"closeHandler",value:function(e){var t=e&&e.type,n=!1;if(e)if("mousedown"===t||"focusin"===t){var r=(this.__containedEvent||0)+100;e.timeStamp>r&&(n=!0);}else m6(e),n=!0;else n=!0;n&&this.hide()&&(this.settings.parent.style.pointerEvents="","mousedown"!==t&&this.settings.parent.focus(),this.onClose&&this.onClose(this.colour));}},{key:"movePopup",value:function(e,t){this.closeHandler(),this.setOptions(e),t&&this.openHandler();}},{key:"setColor",value:function(e,t){this._setColor(e,{silent:t});}},{key:"_setColor",value:function(e,t){if("string"==typeof e&&(e=e.trim()),e){t=t||{};var n=void 0;try{n=new h6(e);}catch(e){if(t.failSilently)return;throw e}if(!this.settings.alpha){var r=n.hsla;r[3]=1,n.hsla=r;}this.colour=this.color=n,this._setHSLA(null,null,null,null,t);}}},{key:"setColour",value:function(e,t){this.setColor(e,t);}},{key:"show",value:function(){if(!this.settings.parent)return !1;if(this.domElement){var e=this._toggleDOM(!0);return this._setPosition(),e}var t,n,r=this.settings.template||'<div class="picker_wrapper" tabindex="-1"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input aria-label="Type a color name or hex value"/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div><div class="picker_cancel"><button>Cancel</button></div></div>',i=(t=r,(n=document.createElement("div")).innerHTML=t,n.firstElementChild);return this.domElement=i,this._domH=p6(".picker_hue",i),this._domSL=p6(".picker_sl",i),this._domA=p6(".picker_alpha",i),this._domEdit=p6(".picker_editor input",i),this._domSample=p6(".picker_sample",i),this._domOkay=p6(".picker_done button",i),this._domCancel=p6(".picker_cancel button",i),i.classList.add("layout_"+this.settings.layout),this.settings.alpha||i.classList.add("no_alpha"),this.settings.editor||i.classList.add("no_editor"),this.settings.cancelButton||i.classList.add("no_cancel"),this._ifPopup((function(){return i.classList.add("popup")})),this._setPosition(),this.colour?this._updateUI():this._setColor(this.settings.defaultColor),this._bindEvents(),!0}},{key:"hide",value:function(){return this._toggleDOM(!1)}},{key:"destroy",value:function(){this._events.destroy(),this.domElement&&this.settings.parent.removeChild(this.domElement);}},{key:"_bindEvents",value:function(){var e=this,t=this,n=this.domElement,r=this._events;function i(e,t,n){r.add(e,t,n);}i(n,"click",(function(e){return e.preventDefault()})),v6(r,this._domH,(function(e,n){return t._setHSLA(e)})),v6(r,this._domSL,(function(e,n){return t._setHSLA(null,e,1-n)})),this.settings.alpha&&v6(r,this._domA,(function(e,n){return t._setHSLA(null,null,null,1-n)}));var o=this._domEdit;i(o,"input",(function(e){t._setColor(this.value,{fromEditor:!0,failSilently:!0});})),i(o,"focus",(function(e){var t=this;t.selectionStart===t.selectionEnd&&t.select();})),this._ifPopup((function(){var t=function(t){return e.closeHandler(t)};i(window,"mousedown",t),i(window,"focusin",t),g6(r,n,["Esc","Escape"],t);var o=function(t){e.__containedEvent=t.timeStamp;};i(n,"mousedown",o),i(n,"focusin",o),i(e._domCancel,"click",t);}));var a=function(t){e._ifPopup((function(){return e.closeHandler(t)})),e.onDone&&e.onDone(e.colour);};i(this._domOkay,"click",a),g6(r,n,["Enter"],a);}},{key:"_setPosition",value:function(){var e=this.settings.parent,t=this.domElement;e!==t.parentNode&&e.appendChild(t),this._ifPopup((function(n){"static"===getComputedStyle(e).position&&(e.style.position="relative");var r=!0===n?"popup_right":"popup_"+n;["popup_top","popup_bottom","popup_left","popup_right"].forEach((function(e){e===r?t.classList.add(e):t.classList.remove(e);})),t.classList.add(r);}));}},{key:"_setHSLA",value:function(e,t,n,r,i){i=i||{};var o=this.colour,a=o.hsla;[e,t,n,r].forEach((function(e,t){(e||0===e)&&(a[t]=e);})),o.hsla=a,this._updateUI(i),this.onChange&&!i.silent&&this.onChange(o);}},{key:"_updateUI",value:function(e){if(this.domElement){e=e||{};var t=this.colour,n=t.hsla,r="hsl("+360*n[0]+", 100%, 50%)",i=t.hslString,o=t.hslaString,a=this._domH,s=this._domSL,c=this._domA,u=p6(".picker_selector",a),l=p6(".picker_selector",s),f=p6(".picker_selector",c);y(0,u,n[0]),this._domSL.style.backgroundColor=this._domH.style.color=r,y(0,l,n[1]),b(0,l,1-n[2]),s.style.color=i,b(0,f,1-n[3]);var h=i,d=h.replace("hsl","hsla").replace(")",", 0)"),v="linear-gradient("+[h,d]+")";if(this._domA.style.background=v+", linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0 / 2em 2em,\n                   linear-gradient(45deg, lightgrey 25%,       white 25%,       white 75%, lightgrey 75%) 1em 1em / 2em 2em",!e.fromEditor){var p=this.settings.editorFormat,m=this.settings.alpha,g=void 0;switch(p){case"rgb":g=t.printRGB(m);break;case"hsl":g=t.printHSL(m);break;default:g=t.printHex(m);}this._domEdit.value=g;}this._domSample.style.color=o;}function y(e,t,n){t.style.left=100*n+"%";}function b(e,t,n){t.style.top=100*n+"%";}}},{key:"_ifPopup",value:function(e,t){this.settings.parent&&this.settings.popup?e&&e(this.settings.popup):t&&t();}},{key:"_toggleDOM",value:function(e){var t=this.domElement;if(!t)return !1;var n=e?"":"none",r=t.style.display!==n;return r&&(t.style.display=n),r}}]),e}(),b6=document.createElement("style");b6.textContent='.picker_wrapper.no_alpha .picker_alpha{display:none}.picker_wrapper.no_editor .picker_editor{position:absolute;z-index:-1;opacity:0}.picker_wrapper.no_cancel .picker_cancel{display:none}.layout_default.picker_wrapper{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:stretch;font-size:10px;width:25em;padding:.5em}.layout_default.picker_wrapper input,.layout_default.picker_wrapper button{font-size:1rem}.layout_default.picker_wrapper>*{margin:.5em}.layout_default.picker_wrapper::before{content:"";display:block;width:100%;height:0;order:1}.layout_default .picker_slider,.layout_default .picker_selector{padding:1em}.layout_default .picker_hue{width:100%}.layout_default .picker_sl{flex:1 1 auto}.layout_default .picker_sl::before{content:"";display:block;padding-bottom:100%}.layout_default .picker_editor{order:1;width:6.5rem}.layout_default .picker_editor input{width:100%;height:100%}.layout_default .picker_sample{order:1;flex:1 1 auto}.layout_default .picker_done,.layout_default .picker_cancel{order:1}.picker_wrapper{box-sizing:border-box;background:#f2f2f2;box-shadow:0 0 0 1px silver;cursor:default;font-family:sans-serif;color:#444;pointer-events:auto}.picker_wrapper:focus{outline:none}.picker_wrapper button,.picker_wrapper input{box-sizing:border-box;border:none;box-shadow:0 0 0 1px silver;outline:none}.picker_wrapper button:focus,.picker_wrapper button:active,.picker_wrapper input:focus,.picker_wrapper input:active{box-shadow:0 0 2px 1px #1e90ff}.picker_wrapper button{padding:.4em .6em;cursor:pointer;background-color:#f5f5f5;background-image:linear-gradient(0deg, gainsboro, transparent)}.picker_wrapper button:active{background-image:linear-gradient(0deg, transparent, gainsboro)}.picker_wrapper button:hover{background-color:#fff}.picker_selector{position:absolute;z-index:1;display:block;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);border:2px solid #fff;border-radius:100%;box-shadow:0 0 3px 1px #67b9ff;background:currentColor;cursor:pointer}.picker_slider .picker_selector{border-radius:2px}.picker_hue{position:relative;background-image:linear-gradient(90deg, red, yellow, lime, cyan, blue, magenta, red);box-shadow:0 0 0 1px silver}.picker_sl{position:relative;box-shadow:0 0 0 1px silver;background-image:linear-gradient(180deg, white, rgba(255, 255, 255, 0) 50%),linear-gradient(0deg, black, rgba(0, 0, 0, 0) 50%),linear-gradient(90deg, #808080, rgba(128, 128, 128, 0))}.picker_alpha,.picker_sample{position:relative;background:linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0/2em 2em,linear-gradient(45deg, lightgrey 25%, white 25%, white 75%, lightgrey 75%) 1em 1em/2em 2em;box-shadow:0 0 0 1px silver}.picker_alpha .picker_selector,.picker_sample .picker_selector{background:none}.picker_editor input{font-family:monospace;padding:.2em .4em}.picker_sample::before{content:"";position:absolute;display:block;width:100%;height:100%;background:currentColor}.picker_arrow{position:absolute;z-index:-1}.picker_wrapper.popup{position:absolute;z-index:2;margin:1.5em}.picker_wrapper.popup,.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{background:#f2f2f2;box-shadow:0 0 10px 1px rgba(0,0,0,.4)}.picker_wrapper.popup .picker_arrow{width:3em;height:3em;margin:0}.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{content:"";display:block;position:absolute;top:0;left:0;z-index:-99}.picker_wrapper.popup .picker_arrow::before{width:100%;height:100%;-webkit-transform:skew(45deg);transform:skew(45deg);-webkit-transform-origin:0 100%;transform-origin:0 100%}.picker_wrapper.popup .picker_arrow::after{width:150%;height:150%;box-shadow:none}.popup.popup_top{bottom:100%;left:0}.popup.popup_top .picker_arrow{bottom:0;left:0;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.popup.popup_bottom{top:100%;left:0}.popup.popup_bottom .picker_arrow{top:0;left:0;-webkit-transform:rotate(90deg) scale(1, -1);transform:rotate(90deg) scale(1, -1)}.popup.popup_left{top:0;right:100%}.popup.popup_left .picker_arrow{top:0;right:0;-webkit-transform:scale(-1, 1);transform:scale(-1, 1)}.popup.popup_right{top:0;left:100%}.popup.popup_right .picker_arrow{top:0;left:0}',document.documentElement.firstElementChild.appendChild(b6),y6.StyleElement=b6;var w6=Object.freeze({__proto__:null,default:y6});

function SvelteJSONEditor(props) {
    const refContainer = useRef(null);
    const refEditor = useRef(null);
    useEffect(() => {
        // @ts-ignore
        refEditor.current = new W1({
            // @ts-ignore
            target: refContainer.current,
            props: {}
        });
        return () => {
            // destroy editor
            if (refEditor.current) {
                // @ts-ignore
                refEditor.current.destroy();
                refEditor.current = null;
            }
        };
    }, []);
    // update props
    useEffect(() => {
        if (refEditor.current) {
            // @ts-ignore
            refEditor.current.updateProps(props);
        }
    }, [props]);
    return jsx("div", { className: "vanilla-jsoneditor-react", ref: refContainer });
}

const rdiff = require('recursive-diff');
const grammarHistory = (function () {
    let grammarHistory = [];
    const getHistory = function () {
        return grammarHistory; // Or pull this from cookie/localStorage
    };
    const pushToHistory = function (currentGrammar) {
        grammarHistory.push(currentGrammar);
        // Also set this in cookie/localStorage
    };
    const calculateAndPushDiff = function (currentGrammar, nextGrammar) {
        // let ret: any = {};
        console.log(`Current Knots: ${currentGrammar}`);
        console.log(`Next Knots:  ${nextGrammar}`);
        const parsed = JSON.parse(nextGrammar);
        const reparsed = JSON.parse(JSON.stringify(nextGrammar));
        console.log(`Parsed: ${parsed}`);
        console.log(`Reparsed: ${reparsed}`);
        console.log(JSON.stringify(currentGrammar.knots));
        const diff = rdiff.getDiff(currentGrammar.knots, nextGrammar.knots);
        console.log(`Diff: ${JSON.stringify(diff)}`);
        return diff;
    };
    const getLength = function () {
        return grammarHistory.length;
    };
    return {
        getHistory: getHistory,
        pushToHistory: pushToHistory,
        getLength: getLength,
        calculateAndPushDiff: calculateAndPushDiff
    };
})();

const GrammarPanelContainer = ({ obj, viewId, initialGrammar, camera, filterKnots, inputId, setCamera, addNewMessage, applyGrammarButtonId, linkMapAndGrammarId }) => {
    const [grammar, _setCode] = useState('');
    const grammarStateRef = useRef(grammar);
    const setCode = (data) => {
        grammarStateRef.current = data;
        _setCode(data);
    };
    const [tempGrammar, _setTempGrammar] = useState('');
    const tempGrammarStateRef = useRef(tempGrammar);
    const setTempGrammar = (data) => {
        tempGrammarStateRef.current = data;
        _setTempGrammar(data);
    };
    const [refresh, setRefresh] = useState(false);
    const [showEditor, setShowEditor] = useState(true);
    const [readOnly, setReadOnly] = useState(false);
    const url = process.env.REACT_APP_BACKEND_SERVICE_URL;
    // useEffect(() => {
    //     console.log('History Length', grammarHistory.length);
    // }, [grammarHistory])
    const applyGrammar = async () => {
        if (grammarHistory.getLength() == 0) {
            grammarHistory.pushToHistory(JSON.stringify(grammarStateRef.current));
            grammarHistory.pushToHistory(JSON.stringify(tempGrammarStateRef.current));
        }
        else {
            grammarHistory.pushToHistory(JSON.stringify(tempGrammarStateRef.current));
        }
        console.log(`Grammar History length -> ${grammarHistory.getLength()}`);
        // const diffs = changesets.diff(grammarStateRef, tempGrammarStateRef);
        grammarHistory.calculateAndPushDiff(grammarStateRef.current, tempGrammarStateRef.current);
        //console.log(diffs);
        if (tempGrammarStateRef.current != '') {
            try {
                JSON.parse(tempGrammarStateRef.current); // testing if temp grammar contains a valid grammar
            }
            catch (err) {
                console.error('Grammar is not valid');
                return;
            }
        }
        // let sendGrammar = addCamera(grammar, camera);
        let sendGrammar = '';
        if (select('#' + linkMapAndGrammarId).property("checked")) {
            if (tempGrammarStateRef.current == '') {
                sendGrammar = addCameraAndFilter(grammarStateRef.current, camera, filterKnots);
            }
            else {
                sendGrammar = addCameraAndFilter(tempGrammarStateRef.current, camera, filterKnots);
            }
        }
        else {
            if (tempGrammarStateRef.current == '') {
                sendGrammar = grammarStateRef.current;
            }
            else {
                sendGrammar = tempGrammarStateRef.current;
            }
        }
        setCode(sendGrammar);
        setTempGrammar('');
        const data = { "grammar": sendGrammar };
        fetch(url + "/updateGrammar", {
            method: 'POST',
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
            .then((response) => {
            console.log(response);
            obj.processGrammar(JSON.parse(grammarStateRef.current));
        })
            .catch(error => {
            console.error('Request to update grammar failed: ', error);
        });
    };
    const addCameraAndFilter = (grammar, camera, filterKnots) => {
        if (grammar == '') {
            return '';
        }
        if (camera.position.length == 0 && filterKnots.length == 0) {
            return grammar;
        }
        let parsedGrammar = JSON.parse(grammar);
        for (const component of parsedGrammar.components) { // Grammar camera is the same for all map views
            if ("map" in component) {
                if (camera.position.length != 0)
                    component.map.camera = camera;
                if (filterKnots.length != 0)
                    component.map.filterKnots = filterKnots;
                else if (component.map.filterKnots != undefined)
                    delete component.map.filterKnots;
            }
        }
        return JSON.stringify(parsedGrammar, null, 4);
    };
    const updateLocalNominatim = (camera, filterKnots) => {
        setTempGrammar(addCameraAndFilter(grammarStateRef.current, camera, filterKnots)); // overwrite previous changes with grammar integrated with camera and filter knots
    };
    const updateCameraNominatim = (place) => {
        fetch(url + "/solveNominatim?text=" + place, {
            method: 'GET'
        })
            .then(async (response) => {
            let responseJson = await response.json();
            updateLocalNominatim(responseJson, filterKnots);
            setCamera(responseJson);
            select('#' + linkMapAndGrammarId).property("checked", true);
        })
            .catch(error => {
            console.error('Error trying to resolve nominatim: ', error);
        });
    };
    // run only once to load the initial data
    useEffect(() => {
        let stringData = JSON.stringify(initialGrammar, null, 4);
        setCode(stringData);
        select('#' + inputId).on("keydown", function (e) {
            if (e.key == 'Enter') {
                select('#' + linkMapAndGrammarId).property("checked", false);
                let inputValue = select('#' + inputId).attr("value");
                if (inputValue != undefined && !Array.isArray(inputValue)) {
                    updateCameraNominatim(inputValue.toString());
                }
                else {
                    throw Error("Invalid place");
                }
            }
        });
        select('#' + applyGrammarButtonId).on("click", function (e) {
            applyGrammar();
        });
        select('#' + linkMapAndGrammarId).on('change', function (e) {
            setRefresh(!refresh);
        });
    }, []);
    const checkIfAddCameraAndFilter = (grammar, camera, tempGrammar, filterKnots) => {
        let inputLink = select('#' + linkMapAndGrammarId);
        let returnedGrammar = {};
        if (inputLink.empty()) {
            if (tempGrammar != '') {
                returnedGrammar.text = tempGrammar;
            }
            else if (grammar != '') {
                returnedGrammar.json = JSON.parse(grammar);
            }
            else {
                returnedGrammar.json = {};
            }
            return returnedGrammar;
        }
        let mapAndGrammarLinked = inputLink.property("checked");
        if (mapAndGrammarLinked) {
            let mergedGrammar = addCameraAndFilter(grammar, camera, filterKnots);
            if (mergedGrammar != '') {
                returnedGrammar.json = JSON.parse(mergedGrammar);
            }
            else {
                returnedGrammar.json = {};
            }
            return returnedGrammar;
        }
        else {
            if (tempGrammar != '') {
                returnedGrammar.text = tempGrammar;
            }
            else if (grammar != '') {
                returnedGrammar.json = JSON.parse(grammar);
            }
            else {
                returnedGrammar.json = {};
            }
            return returnedGrammar;
        }
    };
    const updateGrammarContent = (grammarObj) => {
        if (grammarObj.text != undefined) {
            setTempGrammar(grammarObj.text);
        }
        else {
            setTempGrammar(JSON.stringify(grammarObj.json, null, 4));
        }
    };
    return (jsx(React__default.Fragment, { children: showEditor && (jsxs(Fragment, { children: [jsx("div", { className: "my-editor", style: { overflow: "auto", fontSize: "24px", height: "max(90%,calc(100% - 40px))" }, children: jsx(SvelteJSONEditor, { content: checkIfAddCameraAndFilter(grammar, camera, tempGrammar, filterKnots), readOnly: readOnly, onChange: updateGrammarContent, mode: 'text', indentation: 4 }) }), jsxs("div", { className: "d-flex align-items-center justify-content-center", style: { overflow: "auto", height: "min(10%, 40px)" }, children: [jsx(Button, { variant: "secondary", id: applyGrammarButtonId, style: { marginRight: "10px" }, children: "Apply Grammar" }), jsx("input", { name: "linkMapAndGrammar", type: "checkbox", id: linkMapAndGrammarId, style: { marginRight: "5px" } }), jsx("label", { htmlFor: "linkMapAndGrammar", children: "Link" })] })] })) }));
};

const MapRendererContainer = ({ obj, viewId }) => {
    return (jsx(React__default.Fragment, { children: jsxs("div", { style: { padding: 0, width: "100%", height: "100%" }, children: [jsx("div", { id: viewId, className: "mapView" }), jsx("div", { id: 'svg_div', children: jsx("svg", { id: 'svg_element', xmlns: "http://www.w3.org/2000/svg", style: { "display": "none" } }) })] }) }));
};

var cjs = {exports: {}};

var Draggable$2 = {};

function r(e){var t,f,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=" "),n+=f);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function clsx(){for(var e,t,f=0,n="";f<arguments.length;)(e=arguments[f++])&&(t=r(e))&&(n&&(n+=" "),n+=t);return n}

var clsx_m = /*#__PURE__*/Object.freeze({
    __proto__: null,
    clsx: clsx,
    default: clsx
});

var require$$3 = /*@__PURE__*/getAugmentedNamespace(clsx_m);

var domFns = {};

var shims = {};

Object.defineProperty(shims, "__esModule", {
  value: true
});
shims.dontSetMe = dontSetMe;
shims.findInArray = findInArray;
shims.int = int;
shims.isFunction = isFunction;
shims.isNum = isNum;

// @credits https://gist.github.com/rogozhnikoff/a43cfed27c41e4e68cdc
function findInArray(array
/*: Array<any> | TouchList*/
, callback
/*: Function*/
)
/*: any*/
{
  for (var i = 0, length = array.length; i < length; i++) {
    if (callback.apply(callback, [array[i], i, array])) return array[i];
  }
}

function isFunction(func
/*: any*/
)
/*: boolean %checks*/
{
  // $FlowIgnore[method-unbinding]
  return typeof func === 'function' || Object.prototype.toString.call(func) === '[object Function]';
}

function isNum(num
/*: any*/
)
/*: boolean %checks*/
{
  return typeof num === 'number' && !isNaN(num);
}

function int(a
/*: string*/
)
/*: number*/
{
  return parseInt(a, 10);
}

function dontSetMe(props
/*: Object*/
, propName
/*: string*/
, componentName
/*: string*/
)
/*: ?Error*/
{
  if (props[propName]) {
    return new Error("Invalid prop ".concat(propName, " passed to ").concat(componentName, " - do not set this, set it on the child."));
  }
}

var getPrefix$1 = {};

Object.defineProperty(getPrefix$1, "__esModule", {
  value: true
});
getPrefix$1.browserPrefixToKey = browserPrefixToKey;
getPrefix$1.browserPrefixToStyle = browserPrefixToStyle;
getPrefix$1.default = void 0;
getPrefix$1.getPrefix = getPrefix;
var prefixes = ['Moz', 'Webkit', 'O', 'ms'];

function getPrefix()
/*: string*/
{
  var _window$document, _window$document$docu;

  var prop
  /*: string*/
  = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'transform';
  // Ensure we're running in an environment where there is actually a global
  // `window` obj
  if (typeof window === 'undefined') return ''; // If we're in a pseudo-browser server-side environment, this access
  // path may not exist, so bail out if it doesn't.

  var style = (_window$document = window.document) === null || _window$document === void 0 ? void 0 : (_window$document$docu = _window$document.documentElement) === null || _window$document$docu === void 0 ? void 0 : _window$document$docu.style;
  if (!style) return '';
  if (prop in style) return '';

  for (var i = 0; i < prefixes.length; i++) {
    if (browserPrefixToKey(prop, prefixes[i]) in style) return prefixes[i];
  }

  return '';
}

function browserPrefixToKey(prop
/*: string*/
, prefix
/*: string*/
)
/*: string*/
{
  return prefix ? "".concat(prefix).concat(kebabToTitleCase(prop)) : prop;
}

function browserPrefixToStyle(prop
/*: string*/
, prefix
/*: string*/
)
/*: string*/
{
  return prefix ? "-".concat(prefix.toLowerCase(), "-").concat(prop) : prop;
}

function kebabToTitleCase(str
/*: string*/
)
/*: string*/
{
  var out = '';
  var shouldCapitalize = true;

  for (var i = 0; i < str.length; i++) {
    if (shouldCapitalize) {
      out += str[i].toUpperCase();
      shouldCapitalize = false;
    } else if (str[i] === '-') {
      shouldCapitalize = true;
    } else {
      out += str[i];
    }
  }

  return out;
} // Default export is the prefix itself, like 'Moz', 'Webkit', etc
// Note that you may have to re-test for certain things; for instance, Chrome 50
// can handle unprefixed `transform`, but not unprefixed `user-select`


var _default = (getPrefix()
/*: string*/
);

getPrefix$1.default = _default;

function _typeof$1(obj) { "@babel/helpers - typeof"; return _typeof$1 = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof$1(obj); }

Object.defineProperty(domFns, "__esModule", {
  value: true
});
domFns.addClassName = addClassName;
domFns.addEvent = addEvent;
domFns.addUserSelectStyles = addUserSelectStyles;
domFns.createCSSTransform = createCSSTransform;
domFns.createSVGTransform = createSVGTransform;
domFns.getTouch = getTouch;
domFns.getTouchIdentifier = getTouchIdentifier;
domFns.getTranslation = getTranslation;
domFns.innerHeight = innerHeight$1;
domFns.innerWidth = innerWidth$1;
domFns.matchesSelector = matchesSelector;
domFns.matchesSelectorAndParentsTo = matchesSelectorAndParentsTo;
domFns.offsetXYFromParent = offsetXYFromParent;
domFns.outerHeight = outerHeight;
domFns.outerWidth = outerWidth;
domFns.removeClassName = removeClassName;
domFns.removeEvent = removeEvent;
domFns.removeUserSelectStyles = removeUserSelectStyles;

var _shims$2 = shims;

var _getPrefix = _interopRequireWildcard$1(getPrefix$1);

function _getRequireWildcardCache$1(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache$1 = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard$1(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof$1(obj) !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache$1(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty$1(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }

function _defineProperty$1(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var matchesSelectorFunc = '';

function matchesSelector(el
/*: Node*/
, selector
/*: string*/
)
/*: boolean*/
{
  if (!matchesSelectorFunc) {
    matchesSelectorFunc = (0, _shims$2.findInArray)(['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'], function (method) {
      // $FlowIgnore: Doesn't think elements are indexable
      return (0, _shims$2.isFunction)(el[method]);
    });
  } // Might not be found entirely (not an Element?) - in that case, bail
  // $FlowIgnore: Doesn't think elements are indexable


  if (!(0, _shims$2.isFunction)(el[matchesSelectorFunc])) return false; // $FlowIgnore: Doesn't think elements are indexable

  return el[matchesSelectorFunc](selector);
} // Works up the tree to the draggable itself attempting to match selector.


function matchesSelectorAndParentsTo(el
/*: Node*/
, selector
/*: string*/
, baseNode
/*: Node*/
)
/*: boolean*/
{
  var node = el;

  do {
    if (matchesSelector(node, selector)) return true;
    if (node === baseNode) return false;
    node = node.parentNode;
  } while (node);

  return false;
}

function addEvent(el
/*: ?Node*/
, event
/*: string*/
, handler
/*: Function*/
, inputOptions
/*: Object*/
)
/*: void*/
{
  if (!el) return;

  var options = _objectSpread({
    capture: true
  }, inputOptions); // $FlowIgnore[method-unbinding]


  if (el.addEventListener) {
    el.addEventListener(event, handler, options);
  } else if (el.attachEvent) {
    el.attachEvent('on' + event, handler);
  } else {
    // $FlowIgnore: Doesn't think elements are indexable
    el['on' + event] = handler;
  }
}

function removeEvent(el
/*: ?Node*/
, event
/*: string*/
, handler
/*: Function*/
, inputOptions
/*: Object*/
)
/*: void*/
{
  if (!el) return;

  var options = _objectSpread({
    capture: true
  }, inputOptions); // $FlowIgnore[method-unbinding]


  if (el.removeEventListener) {
    el.removeEventListener(event, handler, options);
  } else if (el.detachEvent) {
    el.detachEvent('on' + event, handler);
  } else {
    // $FlowIgnore: Doesn't think elements are indexable
    el['on' + event] = null;
  }
}

function outerHeight(node
/*: HTMLElement*/
)
/*: number*/
{
  // This is deliberately excluding margin for our calculations, since we are using
  // offsetTop which is including margin. See getBoundPosition
  var height = node.clientHeight;
  var computedStyle = node.ownerDocument.defaultView.getComputedStyle(node);
  height += (0, _shims$2.int)(computedStyle.borderTopWidth);
  height += (0, _shims$2.int)(computedStyle.borderBottomWidth);
  return height;
}

function outerWidth(node
/*: HTMLElement*/
)
/*: number*/
{
  // This is deliberately excluding margin for our calculations, since we are using
  // offsetLeft which is including margin. See getBoundPosition
  var width = node.clientWidth;
  var computedStyle = node.ownerDocument.defaultView.getComputedStyle(node);
  width += (0, _shims$2.int)(computedStyle.borderLeftWidth);
  width += (0, _shims$2.int)(computedStyle.borderRightWidth);
  return width;
}

function innerHeight$1(node
/*: HTMLElement*/
)
/*: number*/
{
  var height = node.clientHeight;
  var computedStyle = node.ownerDocument.defaultView.getComputedStyle(node);
  height -= (0, _shims$2.int)(computedStyle.paddingTop);
  height -= (0, _shims$2.int)(computedStyle.paddingBottom);
  return height;
}

function innerWidth$1(node
/*: HTMLElement*/
)
/*: number*/
{
  var width = node.clientWidth;
  var computedStyle = node.ownerDocument.defaultView.getComputedStyle(node);
  width -= (0, _shims$2.int)(computedStyle.paddingLeft);
  width -= (0, _shims$2.int)(computedStyle.paddingRight);
  return width;
}
/*:: interface EventWithOffset {
  clientX: number, clientY: number
}*/


// Get from offsetParent
function offsetXYFromParent(evt
/*: EventWithOffset*/
, offsetParent
/*: HTMLElement*/
, scale
/*: number*/
)
/*: ControlPosition*/
{
  var isBody = offsetParent === offsetParent.ownerDocument.body;
  var offsetParentRect = isBody ? {
    left: 0,
    top: 0
  } : offsetParent.getBoundingClientRect();
  var x = (evt.clientX + offsetParent.scrollLeft - offsetParentRect.left) / scale;
  var y = (evt.clientY + offsetParent.scrollTop - offsetParentRect.top) / scale;
  return {
    x: x,
    y: y
  };
}

function createCSSTransform(controlPos
/*: ControlPosition*/
, positionOffset
/*: PositionOffsetControlPosition*/
)
/*: Object*/
{
  var translation = getTranslation(controlPos, positionOffset, 'px');
  return _defineProperty$1({}, (0, _getPrefix.browserPrefixToKey)('transform', _getPrefix.default), translation);
}

function createSVGTransform(controlPos
/*: ControlPosition*/
, positionOffset
/*: PositionOffsetControlPosition*/
)
/*: string*/
{
  var translation = getTranslation(controlPos, positionOffset, '');
  return translation;
}

function getTranslation(_ref2, positionOffset
/*: PositionOffsetControlPosition*/
, unitSuffix
/*: string*/
)
/*: string*/
{
  var x = _ref2.x,
      y = _ref2.y;
  var translation = "translate(".concat(x).concat(unitSuffix, ",").concat(y).concat(unitSuffix, ")");

  if (positionOffset) {
    var defaultX = "".concat(typeof positionOffset.x === 'string' ? positionOffset.x : positionOffset.x + unitSuffix);
    var defaultY = "".concat(typeof positionOffset.y === 'string' ? positionOffset.y : positionOffset.y + unitSuffix);
    translation = "translate(".concat(defaultX, ", ").concat(defaultY, ")") + translation;
  }

  return translation;
}

function getTouch(e
/*: MouseTouchEvent*/
, identifier
/*: number*/
)
/*: ?{clientX: number, clientY: number}*/
{
  return e.targetTouches && (0, _shims$2.findInArray)(e.targetTouches, function (t) {
    return identifier === t.identifier;
  }) || e.changedTouches && (0, _shims$2.findInArray)(e.changedTouches, function (t) {
    return identifier === t.identifier;
  });
}

function getTouchIdentifier(e
/*: MouseTouchEvent*/
)
/*: ?number*/
{
  if (e.targetTouches && e.targetTouches[0]) return e.targetTouches[0].identifier;
  if (e.changedTouches && e.changedTouches[0]) return e.changedTouches[0].identifier;
} // User-select Hacks:
//
// Useful for preventing blue highlights all over everything when dragging.
// Note we're passing `document` b/c we could be iframed


function addUserSelectStyles(doc
/*: ?Document*/
) {
  if (!doc) return;
  var styleEl = doc.getElementById('react-draggable-style-el');

  if (!styleEl) {
    styleEl = doc.createElement('style');
    styleEl.type = 'text/css';
    styleEl.id = 'react-draggable-style-el';
    styleEl.innerHTML = '.react-draggable-transparent-selection *::-moz-selection {all: inherit;}\n';
    styleEl.innerHTML += '.react-draggable-transparent-selection *::selection {all: inherit;}\n';
    doc.getElementsByTagName('head')[0].appendChild(styleEl);
  }

  if (doc.body) addClassName(doc.body, 'react-draggable-transparent-selection');
}

function removeUserSelectStyles(doc
/*: ?Document*/
) {
  if (!doc) return;

  try {
    if (doc.body) removeClassName(doc.body, 'react-draggable-transparent-selection'); // $FlowIgnore: IE

    if (doc.selection) {
      // $FlowIgnore: IE
      doc.selection.empty();
    } else {
      // Remove selection caused by scroll, unless it's a focused input
      // (we use doc.defaultView in case we're in an iframe)
      var selection = (doc.defaultView || window).getSelection();

      if (selection && selection.type !== 'Caret') {
        selection.removeAllRanges();
      }
    }
  } catch (e) {// probably IE
  }
}

function addClassName(el
/*: HTMLElement*/
, className
/*: string*/
) {
  if (el.classList) {
    el.classList.add(className);
  } else {
    if (!el.className.match(new RegExp("(?:^|\\s)".concat(className, "(?!\\S)")))) {
      el.className += " ".concat(className);
    }
  }
}

function removeClassName(el
/*: HTMLElement*/
, className
/*: string*/
) {
  if (el.classList) {
    el.classList.remove(className);
  } else {
    el.className = el.className.replace(new RegExp("(?:^|\\s)".concat(className, "(?!\\S)"), 'g'), '');
  }
}

var positionFns = {};

Object.defineProperty(positionFns, "__esModule", {
  value: true
});
positionFns.canDragX = canDragX;
positionFns.canDragY = canDragY;
positionFns.createCoreData = createCoreData;
positionFns.createDraggableData = createDraggableData;
positionFns.getBoundPosition = getBoundPosition;
positionFns.getControlPosition = getControlPosition;
positionFns.snapToGrid = snapToGrid;

var _shims$1 = shims;

var _domFns$1 = domFns;

function getBoundPosition(draggable
/*: Draggable*/
, x
/*: number*/
, y
/*: number*/
)
/*: [number, number]*/
{
  // If no bounds, short-circuit and move on
  if (!draggable.props.bounds) return [x, y]; // Clone new bounds

  var bounds = draggable.props.bounds;
  bounds = typeof bounds === 'string' ? bounds : cloneBounds(bounds);
  var node = findDOMNode(draggable);

  if (typeof bounds === 'string') {
    var ownerDocument = node.ownerDocument;
    var ownerWindow = ownerDocument.defaultView;
    var boundNode;

    if (bounds === 'parent') {
      boundNode = node.parentNode;
    } else {
      boundNode = ownerDocument.querySelector(bounds);
    }

    if (!(boundNode instanceof ownerWindow.HTMLElement)) {
      throw new Error('Bounds selector "' + bounds + '" could not find an element.');
    }

    var boundNodeEl
    /*: HTMLElement*/
    = boundNode; // for Flow, can't seem to refine correctly

    var nodeStyle = ownerWindow.getComputedStyle(node);
    var boundNodeStyle = ownerWindow.getComputedStyle(boundNodeEl); // Compute bounds. This is a pain with padding and offsets but this gets it exactly right.

    bounds = {
      left: -node.offsetLeft + (0, _shims$1.int)(boundNodeStyle.paddingLeft) + (0, _shims$1.int)(nodeStyle.marginLeft),
      top: -node.offsetTop + (0, _shims$1.int)(boundNodeStyle.paddingTop) + (0, _shims$1.int)(nodeStyle.marginTop),
      right: (0, _domFns$1.innerWidth)(boundNodeEl) - (0, _domFns$1.outerWidth)(node) - node.offsetLeft + (0, _shims$1.int)(boundNodeStyle.paddingRight) - (0, _shims$1.int)(nodeStyle.marginRight),
      bottom: (0, _domFns$1.innerHeight)(boundNodeEl) - (0, _domFns$1.outerHeight)(node) - node.offsetTop + (0, _shims$1.int)(boundNodeStyle.paddingBottom) - (0, _shims$1.int)(nodeStyle.marginBottom)
    };
  } // Keep x and y below right and bottom limits...


  if ((0, _shims$1.isNum)(bounds.right)) x = Math.min(x, bounds.right);
  if ((0, _shims$1.isNum)(bounds.bottom)) y = Math.min(y, bounds.bottom); // But above left and top limits.

  if ((0, _shims$1.isNum)(bounds.left)) x = Math.max(x, bounds.left);
  if ((0, _shims$1.isNum)(bounds.top)) y = Math.max(y, bounds.top);
  return [x, y];
}

function snapToGrid(grid
/*: [number, number]*/
, pendingX
/*: number*/
, pendingY
/*: number*/
)
/*: [number, number]*/
{
  var x = Math.round(pendingX / grid[0]) * grid[0];
  var y = Math.round(pendingY / grid[1]) * grid[1];
  return [x, y];
}

function canDragX(draggable
/*: Draggable*/
)
/*: boolean*/
{
  return draggable.props.axis === 'both' || draggable.props.axis === 'x';
}

function canDragY(draggable
/*: Draggable*/
)
/*: boolean*/
{
  return draggable.props.axis === 'both' || draggable.props.axis === 'y';
} // Get {x, y} positions from event.


function getControlPosition(e
/*: MouseTouchEvent*/
, touchIdentifier
/*: ?number*/
, draggableCore
/*: DraggableCore*/
)
/*: ?ControlPosition*/
{
  var touchObj = typeof touchIdentifier === 'number' ? (0, _domFns$1.getTouch)(e, touchIdentifier) : null;
  if (typeof touchIdentifier === 'number' && !touchObj) return null; // not the right touch

  var node = findDOMNode(draggableCore); // User can provide an offsetParent if desired.

  var offsetParent = draggableCore.props.offsetParent || node.offsetParent || node.ownerDocument.body;
  return (0, _domFns$1.offsetXYFromParent)(touchObj || e, offsetParent, draggableCore.props.scale);
} // Create an data object exposed by <DraggableCore>'s events


function createCoreData(draggable
/*: DraggableCore*/
, x
/*: number*/
, y
/*: number*/
)
/*: DraggableData*/
{
  var state = draggable.state;
  var isStart = !(0, _shims$1.isNum)(state.lastX);
  var node = findDOMNode(draggable);

  if (isStart) {
    // If this is our first move, use the x and y as last coords.
    return {
      node: node,
      deltaX: 0,
      deltaY: 0,
      lastX: x,
      lastY: y,
      x: x,
      y: y
    };
  } else {
    // Otherwise calculate proper values.
    return {
      node: node,
      deltaX: x - state.lastX,
      deltaY: y - state.lastY,
      lastX: state.lastX,
      lastY: state.lastY,
      x: x,
      y: y
    };
  }
} // Create an data exposed by <Draggable>'s events


function createDraggableData(draggable
/*: Draggable*/
, coreData
/*: DraggableData*/
)
/*: DraggableData*/
{
  var scale = draggable.props.scale;
  return {
    node: coreData.node,
    x: draggable.state.x + coreData.deltaX / scale,
    y: draggable.state.y + coreData.deltaY / scale,
    deltaX: coreData.deltaX / scale,
    deltaY: coreData.deltaY / scale,
    lastX: draggable.state.x,
    lastY: draggable.state.y
  };
} // A lot faster than stringify/parse


function cloneBounds(bounds
/*: Bounds*/
)
/*: Bounds*/
{
  return {
    left: bounds.left,
    top: bounds.top,
    right: bounds.right,
    bottom: bounds.bottom
  };
}

function findDOMNode(draggable
/*: Draggable | DraggableCore*/
)
/*: HTMLElement*/
{
  var node = draggable.findDOMNode();

  if (!node) {
    throw new Error('<DraggableCore>: Unmounted during event!');
  } // $FlowIgnore we can't assert on HTMLElement due to tests... FIXME


  return node;
}

var DraggableCore$2 = {};

var log$1 = {};

Object.defineProperty(log$1, "__esModule", {
  value: true
});
log$1.default = log;

/*eslint no-console:0*/
function log() {
}

function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

Object.defineProperty(DraggableCore$2, "__esModule", {
  value: true
});
DraggableCore$2.default = void 0;

var React = _interopRequireWildcard(React__default);

var _propTypes = _interopRequireDefault(PropTypes);

var _reactDom = _interopRequireDefault(require$$2);

var _domFns = domFns;

var _positionFns = positionFns;

var _shims = shims;

var _log = _interopRequireDefault(log$1);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, "prototype", { writable: false }); return Constructor; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, "prototype", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } else if (call !== void 0) { throw new TypeError("Derived constructors may only return object or undefined"); } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

// Simple abstraction for dragging events names.
var eventsFor = {
  touch: {
    start: 'touchstart',
    move: 'touchmove',
    stop: 'touchend'
  },
  mouse: {
    start: 'mousedown',
    move: 'mousemove',
    stop: 'mouseup'
  }
}; // Default to mouse events.

var dragEventFor = eventsFor.mouse;
/*:: type DraggableCoreState = {
  dragging: boolean,
  lastX: number,
  lastY: number,
  touchIdentifier: ?number
};*/

/*:: export type DraggableData = {
  node: HTMLElement,
  x: number, y: number,
  deltaX: number, deltaY: number,
  lastX: number, lastY: number,
};*/

/*:: export type DraggableEventHandler = (e: MouseEvent, data: DraggableData) => void | false;*/

/*:: export type ControlPosition = {x: number, y: number};*/

/*:: export type PositionOffsetControlPosition = {x: number|string, y: number|string};*/

/*:: export type DraggableCoreDefaultProps = {
  allowAnyClick: boolean,
  disabled: boolean,
  enableUserSelectHack: boolean,
  onStart: DraggableEventHandler,
  onDrag: DraggableEventHandler,
  onStop: DraggableEventHandler,
  onMouseDown: (e: MouseEvent) => void,
  scale: number,
};*/

/*:: export type DraggableCoreProps = {
  ...DraggableCoreDefaultProps,
  cancel: string,
  children: ReactElement<any>,
  offsetParent: HTMLElement,
  grid: [number, number],
  handle: string,
  nodeRef?: ?React.ElementRef<any>,
};*/

//
// Define <DraggableCore>.
//
// <DraggableCore> is for advanced usage of <Draggable>. It maintains minimal internal state so it can
// work well with libraries that require more control over the element.
//
var DraggableCore$1 = /*#__PURE__*/function (_React$Component) {
  _inherits(DraggableCore, _React$Component);

  var _super = _createSuper(DraggableCore);

  function DraggableCore() {
    var _this;

    _classCallCheck(this, DraggableCore);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _super.call.apply(_super, [this].concat(args));

    _defineProperty(_assertThisInitialized(_this), "state", {
      dragging: false,
      // Used while dragging to determine deltas.
      lastX: NaN,
      lastY: NaN,
      touchIdentifier: null
    });

    _defineProperty(_assertThisInitialized(_this), "mounted", false);

    _defineProperty(_assertThisInitialized(_this), "handleDragStart", function (e) {
      // Make it possible to attach event handlers on top of this one.
      _this.props.onMouseDown(e); // Only accept left-clicks.


      if (!_this.props.allowAnyClick && typeof e.button === 'number' && e.button !== 0) return false; // Get nodes. Be sure to grab relative document (could be iframed)

      var thisNode = _this.findDOMNode();

      if (!thisNode || !thisNode.ownerDocument || !thisNode.ownerDocument.body) {
        throw new Error('<DraggableCore> not mounted on DragStart!');
      }

      var ownerDocument = thisNode.ownerDocument; // Short circuit if handle or cancel prop was provided and selector doesn't match.

      if (_this.props.disabled || !(e.target instanceof ownerDocument.defaultView.Node) || _this.props.handle && !(0, _domFns.matchesSelectorAndParentsTo)(e.target, _this.props.handle, thisNode) || _this.props.cancel && (0, _domFns.matchesSelectorAndParentsTo)(e.target, _this.props.cancel, thisNode)) {
        return;
      } // Prevent scrolling on mobile devices, like ipad/iphone.
      // Important that this is after handle/cancel.


      if (e.type === 'touchstart') e.preventDefault(); // Set touch identifier in component state if this is a touch event. This allows us to
      // distinguish between individual touches on multitouch screens by identifying which
      // touchpoint was set to this element.

      var touchIdentifier = (0, _domFns.getTouchIdentifier)(e);

      _this.setState({
        touchIdentifier: touchIdentifier
      }); // Get the current drag point from the event. This is used as the offset.


      var position = (0, _positionFns.getControlPosition)(e, touchIdentifier, _assertThisInitialized(_this));
      if (position == null) return; // not possible but satisfies flow

      var x = position.x,
          y = position.y; // Create an event object with all the data parents need to make a decision here.

      var coreEvent = (0, _positionFns.createCoreData)(_assertThisInitialized(_this), x, y);
      (0, _log.default)('DraggableCore: handleDragStart: %j', coreEvent); // Call event handler. If it returns explicit false, cancel.

      (0, _log.default)('calling', _this.props.onStart);

      var shouldUpdate = _this.props.onStart(e, coreEvent);

      if (shouldUpdate === false || _this.mounted === false) return; // Add a style to the body to disable user-select. This prevents text from
      // being selected all over the page.

      if (_this.props.enableUserSelectHack) (0, _domFns.addUserSelectStyles)(ownerDocument); // Initiate dragging. Set the current x and y as offsets
      // so we know how much we've moved during the drag. This allows us
      // to drag elements around even if they have been moved, without issue.

      _this.setState({
        dragging: true,
        lastX: x,
        lastY: y
      }); // Add events to the document directly so we catch when the user's mouse/touch moves outside of
      // this element. We use different events depending on whether or not we have detected that this
      // is a touch-capable device.


      (0, _domFns.addEvent)(ownerDocument, dragEventFor.move, _this.handleDrag);
      (0, _domFns.addEvent)(ownerDocument, dragEventFor.stop, _this.handleDragStop);
    });

    _defineProperty(_assertThisInitialized(_this), "handleDrag", function (e) {
      // Get the current drag point from the event. This is used as the offset.
      var position = (0, _positionFns.getControlPosition)(e, _this.state.touchIdentifier, _assertThisInitialized(_this));
      if (position == null) return;
      var x = position.x,
          y = position.y; // Snap to grid if prop has been provided

      if (Array.isArray(_this.props.grid)) {
        var deltaX = x - _this.state.lastX,
            deltaY = y - _this.state.lastY;

        var _snapToGrid = (0, _positionFns.snapToGrid)(_this.props.grid, deltaX, deltaY);

        var _snapToGrid2 = _slicedToArray(_snapToGrid, 2);

        deltaX = _snapToGrid2[0];
        deltaY = _snapToGrid2[1];
        if (!deltaX && !deltaY) return; // skip useless drag

        x = _this.state.lastX + deltaX, y = _this.state.lastY + deltaY;
      }

      var coreEvent = (0, _positionFns.createCoreData)(_assertThisInitialized(_this), x, y);
      (0, _log.default)('DraggableCore: handleDrag: %j', coreEvent); // Call event handler. If it returns explicit false, trigger end.

      var shouldUpdate = _this.props.onDrag(e, coreEvent);

      if (shouldUpdate === false || _this.mounted === false) {
        try {
          // $FlowIgnore
          _this.handleDragStop(new MouseEvent('mouseup'));
        } catch (err) {
          // Old browsers
          var event = ((document.createEvent('MouseEvents')
          /*: any*/
          )
          /*: MouseTouchEvent*/
          ); // I see why this insanity was deprecated
          // $FlowIgnore

          event.initMouseEvent('mouseup', true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);

          _this.handleDragStop(event);
        }

        return;
      }

      _this.setState({
        lastX: x,
        lastY: y
      });
    });

    _defineProperty(_assertThisInitialized(_this), "handleDragStop", function (e) {
      if (!_this.state.dragging) return;
      var position = (0, _positionFns.getControlPosition)(e, _this.state.touchIdentifier, _assertThisInitialized(_this));
      if (position == null) return;
      var x = position.x,
          y = position.y; // Snap to grid if prop has been provided

      if (Array.isArray(_this.props.grid)) {
        var deltaX = x - _this.state.lastX || 0;
        var deltaY = y - _this.state.lastY || 0;

        var _snapToGrid3 = (0, _positionFns.snapToGrid)(_this.props.grid, deltaX, deltaY);

        var _snapToGrid4 = _slicedToArray(_snapToGrid3, 2);

        deltaX = _snapToGrid4[0];
        deltaY = _snapToGrid4[1];
        x = _this.state.lastX + deltaX, y = _this.state.lastY + deltaY;
      }

      var coreEvent = (0, _positionFns.createCoreData)(_assertThisInitialized(_this), x, y); // Call event handler

      var shouldContinue = _this.props.onStop(e, coreEvent);

      if (shouldContinue === false || _this.mounted === false) return false;

      var thisNode = _this.findDOMNode();

      if (thisNode) {
        // Remove user-select hack
        if (_this.props.enableUserSelectHack) (0, _domFns.removeUserSelectStyles)(thisNode.ownerDocument);
      }

      (0, _log.default)('DraggableCore: handleDragStop: %j', coreEvent); // Reset the el.

      _this.setState({
        dragging: false,
        lastX: NaN,
        lastY: NaN
      });

      if (thisNode) {
        // Remove event handlers
        (0, _log.default)('DraggableCore: Removing handlers');
        (0, _domFns.removeEvent)(thisNode.ownerDocument, dragEventFor.move, _this.handleDrag);
        (0, _domFns.removeEvent)(thisNode.ownerDocument, dragEventFor.stop, _this.handleDragStop);
      }
    });

    _defineProperty(_assertThisInitialized(_this), "onMouseDown", function (e) {
      dragEventFor = eventsFor.mouse; // on touchscreen laptops we could switch back to mouse

      return _this.handleDragStart(e);
    });

    _defineProperty(_assertThisInitialized(_this), "onMouseUp", function (e) {
      dragEventFor = eventsFor.mouse;
      return _this.handleDragStop(e);
    });

    _defineProperty(_assertThisInitialized(_this), "onTouchStart", function (e) {
      // We're on a touch device now, so change the event handlers
      dragEventFor = eventsFor.touch;
      return _this.handleDragStart(e);
    });

    _defineProperty(_assertThisInitialized(_this), "onTouchEnd", function (e) {
      // We're on a touch device now, so change the event handlers
      dragEventFor = eventsFor.touch;
      return _this.handleDragStop(e);
    });

    return _this;
  }

  _createClass(DraggableCore, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this.mounted = true; // Touch handlers must be added with {passive: false} to be cancelable.
      // https://developers.google.com/web/updates/2017/01/scrolling-intervention

      var thisNode = this.findDOMNode();

      if (thisNode) {
        (0, _domFns.addEvent)(thisNode, eventsFor.touch.start, this.onTouchStart, {
          passive: false
        });
      }
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      this.mounted = false; // Remove any leftover event handlers. Remove both touch and mouse handlers in case
      // some browser quirk caused a touch event to fire during a mouse move, or vice versa.

      var thisNode = this.findDOMNode();

      if (thisNode) {
        var ownerDocument = thisNode.ownerDocument;
        (0, _domFns.removeEvent)(ownerDocument, eventsFor.mouse.move, this.handleDrag);
        (0, _domFns.removeEvent)(ownerDocument, eventsFor.touch.move, this.handleDrag);
        (0, _domFns.removeEvent)(ownerDocument, eventsFor.mouse.stop, this.handleDragStop);
        (0, _domFns.removeEvent)(ownerDocument, eventsFor.touch.stop, this.handleDragStop);
        (0, _domFns.removeEvent)(thisNode, eventsFor.touch.start, this.onTouchStart, {
          passive: false
        });
        if (this.props.enableUserSelectHack) (0, _domFns.removeUserSelectStyles)(ownerDocument);
      }
    } // React Strict Mode compatibility: if `nodeRef` is passed, we will use it instead of trying to find
    // the underlying DOM node ourselves. See the README for more information.

  }, {
    key: "findDOMNode",
    value: function findDOMNode()
    /*: ?HTMLElement*/
    {
      var _this$props, _this$props2, _this$props2$nodeRef;

      return (_this$props = this.props) !== null && _this$props !== void 0 && _this$props.nodeRef ? (_this$props2 = this.props) === null || _this$props2 === void 0 ? void 0 : (_this$props2$nodeRef = _this$props2.nodeRef) === null || _this$props2$nodeRef === void 0 ? void 0 : _this$props2$nodeRef.current : _reactDom.default.findDOMNode(this);
    }
  }, {
    key: "render",
    value: function render()
    /*: React.Element<any>*/
    {
      // Reuse the child provided
      // This makes it flexible to use whatever element is wanted (div, ul, etc)
      return /*#__PURE__*/React.cloneElement(React.Children.only(this.props.children), {
        // Note: mouseMove handler is attached to document so it will still function
        // when the user drags quickly and leaves the bounds of the element.
        onMouseDown: this.onMouseDown,
        onMouseUp: this.onMouseUp,
        // onTouchStart is added on `componentDidMount` so they can be added with
        // {passive: false}, which allows it to cancel. See
        // https://developers.google.com/web/updates/2017/01/scrolling-intervention
        onTouchEnd: this.onTouchEnd
      });
    }
  }]);

  return DraggableCore;
}(React.Component);

DraggableCore$2.default = DraggableCore$1;

_defineProperty(DraggableCore$1, "displayName", 'DraggableCore');

_defineProperty(DraggableCore$1, "propTypes", {
  /**
   * `allowAnyClick` allows dragging using any mouse button.
   * By default, we only accept the left button.
   *
   * Defaults to `false`.
   */
  allowAnyClick: _propTypes.default.bool,

  /**
   * `disabled`, if true, stops the <Draggable> from dragging. All handlers,
   * with the exception of `onMouseDown`, will not fire.
   */
  disabled: _propTypes.default.bool,

  /**
   * By default, we add 'user-select:none' attributes to the document body
   * to prevent ugly text selection during drag. If this is causing problems
   * for your app, set this to `false`.
   */
  enableUserSelectHack: _propTypes.default.bool,

  /**
   * `offsetParent`, if set, uses the passed DOM node to compute drag offsets
   * instead of using the parent node.
   */
  offsetParent: function offsetParent(props
  /*: DraggableCoreProps*/
  , propName
  /*: $Keys<DraggableCoreProps>*/
  ) {
    if (props[propName] && props[propName].nodeType !== 1) {
      throw new Error('Draggable\'s offsetParent must be a DOM Node.');
    }
  },

  /**
   * `grid` specifies the x and y that dragging should snap to.
   */
  grid: _propTypes.default.arrayOf(_propTypes.default.number),

  /**
   * `handle` specifies a selector to be used as the handle that initiates drag.
   *
   * Example:
   *
   * ```jsx
   *   let App = React.createClass({
   *       render: function () {
   *         return (
   *            <Draggable handle=".handle">
   *              <div>
   *                  <div className="handle">Click me to drag</div>
   *                  <div>This is some other content</div>
   *              </div>
   *           </Draggable>
   *         );
   *       }
   *   });
   * ```
   */
  handle: _propTypes.default.string,

  /**
   * `cancel` specifies a selector to be used to prevent drag initialization.
   *
   * Example:
   *
   * ```jsx
   *   let App = React.createClass({
   *       render: function () {
   *           return(
   *               <Draggable cancel=".cancel">
   *                   <div>
   *                     <div className="cancel">You can't drag from here</div>
   *                     <div>Dragging here works fine</div>
   *                   </div>
   *               </Draggable>
   *           );
   *       }
   *   });
   * ```
   */
  cancel: _propTypes.default.string,

  /* If running in React Strict mode, ReactDOM.findDOMNode() is deprecated.
   * Unfortunately, in order for <Draggable> to work properly, we need raw access
   * to the underlying DOM node. If you want to avoid the warning, pass a `nodeRef`
   * as in this example:
   *
   * function MyComponent() {
   *   const nodeRef = React.useRef(null);
   *   return (
   *     <Draggable nodeRef={nodeRef}>
   *       <div ref={nodeRef}>Example Target</div>
   *     </Draggable>
   *   );
   * }
   *
   * This can be used for arbitrarily nested components, so long as the ref ends up
   * pointing to the actual child DOM node and not a custom component.
   */
  nodeRef: _propTypes.default.object,

  /**
   * Called when dragging starts.
   * If this function returns the boolean false, dragging will be canceled.
   */
  onStart: _propTypes.default.func,

  /**
   * Called while dragging.
   * If this function returns the boolean false, dragging will be canceled.
   */
  onDrag: _propTypes.default.func,

  /**
   * Called when dragging stops.
   * If this function returns the boolean false, the drag will remain active.
   */
  onStop: _propTypes.default.func,

  /**
   * A workaround option which can be passed if onMouseDown needs to be accessed,
   * since it'll always be blocked (as there is internal use of onMouseDown)
   */
  onMouseDown: _propTypes.default.func,

  /**
   * `scale`, if set, applies scaling while dragging an element
   */
  scale: _propTypes.default.number,

  /**
   * These properties should be defined on the child, not here.
   */
  className: _shims.dontSetMe,
  style: _shims.dontSetMe,
  transform: _shims.dontSetMe
});

_defineProperty(DraggableCore$1, "defaultProps", {
  allowAnyClick: false,
  // by default only accept left click
  disabled: false,
  enableUserSelectHack: true,
  onStart: function onStart() {},
  onDrag: function onDrag() {},
  onStop: function onStop() {},
  onMouseDown: function onMouseDown() {},
  scale: 1
});

(function (exports) {

	function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	Object.defineProperty(exports, "DraggableCore", {
	  enumerable: true,
	  get: function get() {
	    return _DraggableCore.default;
	  }
	});
	exports.default = void 0;

	var React = _interopRequireWildcard(React__default);

	var _propTypes = _interopRequireDefault(PropTypes);

	var _reactDom = _interopRequireDefault(require$$2);

	var _clsx2 = _interopRequireDefault(require$$3);

	var _domFns = domFns;

	var _positionFns = positionFns;

	var _shims = shims;

	var _DraggableCore = _interopRequireDefault(DraggableCore$2);

	var _log = _interopRequireDefault(log$1);

	var _excluded = ["axis", "bounds", "children", "defaultPosition", "defaultClassName", "defaultClassNameDragging", "defaultClassNameDragged", "position", "positionOffset", "scale"];

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

	function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

	function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

	function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

	function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

	function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

	function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }

	function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

	function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

	function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

	function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

	function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

	function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

	function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, "prototype", { writable: false }); return Constructor; }

	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, "prototype", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }

	function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

	function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

	function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } else if (call !== void 0) { throw new TypeError("Derived constructors may only return object or undefined"); } return _assertThisInitialized(self); }

	function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

	function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

	function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

	function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

	//
	// Define <Draggable>
	//
	var Draggable = /*#__PURE__*/function (_React$Component) {
	  _inherits(Draggable, _React$Component);

	  var _super = _createSuper(Draggable);

	  function Draggable(props
	  /*: DraggableProps*/
	  ) {
	    var _this;

	    _classCallCheck(this, Draggable);

	    _this = _super.call(this, props);

	    _defineProperty(_assertThisInitialized(_this), "onDragStart", function (e, coreData) {
	      (0, _log.default)('Draggable: onDragStart: %j', coreData); // Short-circuit if user's callback killed it.

	      var shouldStart = _this.props.onStart(e, (0, _positionFns.createDraggableData)(_assertThisInitialized(_this), coreData)); // Kills start event on core as well, so move handlers are never bound.


	      if (shouldStart === false) return false;

	      _this.setState({
	        dragging: true,
	        dragged: true
	      });
	    });

	    _defineProperty(_assertThisInitialized(_this), "onDrag", function (e, coreData) {
	      if (!_this.state.dragging) return false;
	      (0, _log.default)('Draggable: onDrag: %j', coreData);
	      var uiData = (0, _positionFns.createDraggableData)(_assertThisInitialized(_this), coreData);
	      var newState
	      /*: $Shape<DraggableState>*/
	      = {
	        x: uiData.x,
	        y: uiData.y
	      }; // Keep within bounds.

	      if (_this.props.bounds) {
	        // Save original x and y.
	        var x = newState.x,
	            y = newState.y; // Add slack to the values used to calculate bound position. This will ensure that if
	        // we start removing slack, the element won't react to it right away until it's been
	        // completely removed.

	        newState.x += _this.state.slackX;
	        newState.y += _this.state.slackY; // Get bound position. This will ceil/floor the x and y within the boundaries.

	        var _getBoundPosition = (0, _positionFns.getBoundPosition)(_assertThisInitialized(_this), newState.x, newState.y),
	            _getBoundPosition2 = _slicedToArray(_getBoundPosition, 2),
	            newStateX = _getBoundPosition2[0],
	            newStateY = _getBoundPosition2[1];

	        newState.x = newStateX;
	        newState.y = newStateY; // Recalculate slack by noting how much was shaved by the boundPosition handler.

	        newState.slackX = _this.state.slackX + (x - newState.x);
	        newState.slackY = _this.state.slackY + (y - newState.y); // Update the event we fire to reflect what really happened after bounds took effect.

	        uiData.x = newState.x;
	        uiData.y = newState.y;
	        uiData.deltaX = newState.x - _this.state.x;
	        uiData.deltaY = newState.y - _this.state.y;
	      } // Short-circuit if user's callback killed it.


	      var shouldUpdate = _this.props.onDrag(e, uiData);

	      if (shouldUpdate === false) return false;

	      _this.setState(newState);
	    });

	    _defineProperty(_assertThisInitialized(_this), "onDragStop", function (e, coreData) {
	      if (!_this.state.dragging) return false; // Short-circuit if user's callback killed it.

	      var shouldContinue = _this.props.onStop(e, (0, _positionFns.createDraggableData)(_assertThisInitialized(_this), coreData));

	      if (shouldContinue === false) return false;
	      (0, _log.default)('Draggable: onDragStop: %j', coreData);
	      var newState
	      /*: $Shape<DraggableState>*/
	      = {
	        dragging: false,
	        slackX: 0,
	        slackY: 0
	      }; // If this is a controlled component, the result of this operation will be to
	      // revert back to the old position. We expect a handler on `onDragStop`, at the least.

	      var controlled = Boolean(_this.props.position);

	      if (controlled) {
	        var _this$props$position = _this.props.position,
	            x = _this$props$position.x,
	            y = _this$props$position.y;
	        newState.x = x;
	        newState.y = y;
	      }

	      _this.setState(newState);
	    });

	    _this.state = {
	      // Whether or not we are currently dragging.
	      dragging: false,
	      // Whether or not we have been dragged before.
	      dragged: false,
	      // Current transform x and y.
	      x: props.position ? props.position.x : props.defaultPosition.x,
	      y: props.position ? props.position.y : props.defaultPosition.y,
	      prevPropsPosition: _objectSpread({}, props.position),
	      // Used for compensating for out-of-bounds drags
	      slackX: 0,
	      slackY: 0,
	      // Can only determine if SVG after mounting
	      isElementSVG: false
	    };

	    if (props.position && !(props.onDrag || props.onStop)) {
	      // eslint-disable-next-line no-console
	      console.warn('A `position` was applied to this <Draggable>, without drag handlers. This will make this ' + 'component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the ' + '`position` of this element.');
	    }

	    return _this;
	  }

	  _createClass(Draggable, [{
	    key: "componentDidMount",
	    value: function componentDidMount() {
	      // Check to see if the element passed is an instanceof SVGElement
	      if (typeof window.SVGElement !== 'undefined' && this.findDOMNode() instanceof window.SVGElement) {
	        this.setState({
	          isElementSVG: true
	        });
	      }
	    }
	  }, {
	    key: "componentWillUnmount",
	    value: function componentWillUnmount() {
	      this.setState({
	        dragging: false
	      }); // prevents invariant if unmounted while dragging
	    } // React Strict Mode compatibility: if `nodeRef` is passed, we will use it instead of trying to find
	    // the underlying DOM node ourselves. See the README for more information.

	  }, {
	    key: "findDOMNode",
	    value: function findDOMNode()
	    /*: ?HTMLElement*/
	    {
	      var _this$props$nodeRef$c, _this$props, _this$props$nodeRef;

	      return (_this$props$nodeRef$c = (_this$props = this.props) === null || _this$props === void 0 ? void 0 : (_this$props$nodeRef = _this$props.nodeRef) === null || _this$props$nodeRef === void 0 ? void 0 : _this$props$nodeRef.current) !== null && _this$props$nodeRef$c !== void 0 ? _this$props$nodeRef$c : _reactDom.default.findDOMNode(this);
	    }
	  }, {
	    key: "render",
	    value: function render()
	    /*: ReactElement<any>*/
	    {
	      var _clsx;

	      var _this$props2 = this.props;
	          _this$props2.axis;
	          _this$props2.bounds;
	          var children = _this$props2.children,
	          defaultPosition = _this$props2.defaultPosition,
	          defaultClassName = _this$props2.defaultClassName,
	          defaultClassNameDragging = _this$props2.defaultClassNameDragging,
	          defaultClassNameDragged = _this$props2.defaultClassNameDragged,
	          position = _this$props2.position,
	          positionOffset = _this$props2.positionOffset;
	          _this$props2.scale;
	          var draggableCoreProps = _objectWithoutProperties(_this$props2, _excluded);

	      var style = {};
	      var svgTransform = null; // If this is controlled, we don't want to move it - unless it's dragging.

	      var controlled = Boolean(position);
	      var draggable = !controlled || this.state.dragging;
	      var validPosition = position || defaultPosition;
	      var transformOpts = {
	        // Set left if horizontal drag is enabled
	        x: (0, _positionFns.canDragX)(this) && draggable ? this.state.x : validPosition.x,
	        // Set top if vertical drag is enabled
	        y: (0, _positionFns.canDragY)(this) && draggable ? this.state.y : validPosition.y
	      }; // If this element was SVG, we use the `transform` attribute.

	      if (this.state.isElementSVG) {
	        svgTransform = (0, _domFns.createSVGTransform)(transformOpts, positionOffset);
	      } else {
	        // Add a CSS transform to move the element around. This allows us to move the element around
	        // without worrying about whether or not it is relatively or absolutely positioned.
	        // If the item you are dragging already has a transform set, wrap it in a <span> so <Draggable>
	        // has a clean slate.
	        style = (0, _domFns.createCSSTransform)(transformOpts, positionOffset);
	      } // Mark with class while dragging


	      var className = (0, _clsx2.default)(children.props.className || '', defaultClassName, (_clsx = {}, _defineProperty(_clsx, defaultClassNameDragging, this.state.dragging), _defineProperty(_clsx, defaultClassNameDragged, this.state.dragged), _clsx)); // Reuse the child provided
	      // This makes it flexible to use whatever element is wanted (div, ul, etc)

	      return /*#__PURE__*/React.createElement(_DraggableCore.default, _extends({}, draggableCoreProps, {
	        onStart: this.onDragStart,
	        onDrag: this.onDrag,
	        onStop: this.onDragStop
	      }), /*#__PURE__*/React.cloneElement(React.Children.only(children), {
	        className: className,
	        style: _objectSpread(_objectSpread({}, children.props.style), style),
	        transform: svgTransform
	      }));
	    }
	  }], [{
	    key: "getDerivedStateFromProps",
	    value: // React 16.3+
	    // Arity (props, state)
	    function getDerivedStateFromProps(_ref, _ref2)
	    /*: ?$Shape<DraggableState>*/
	    {
	      var position = _ref.position;
	      var prevPropsPosition = _ref2.prevPropsPosition;

	      // Set x/y if a new position is provided in props that is different than the previous.
	      if (position && (!prevPropsPosition || position.x !== prevPropsPosition.x || position.y !== prevPropsPosition.y)) {
	        (0, _log.default)('Draggable: getDerivedStateFromProps %j', {
	          position: position,
	          prevPropsPosition: prevPropsPosition
	        });
	        return {
	          x: position.x,
	          y: position.y,
	          prevPropsPosition: _objectSpread({}, position)
	        };
	      }

	      return null;
	    }
	  }]);

	  return Draggable;
	}(React.Component);

	exports.default = Draggable;

	_defineProperty(Draggable, "displayName", 'Draggable');

	_defineProperty(Draggable, "propTypes", _objectSpread(_objectSpread({}, _DraggableCore.default.propTypes), {}, {
	  /**
	   * `axis` determines which axis the draggable can move.
	   *
	   *  Note that all callbacks will still return data as normal. This only
	   *  controls flushing to the DOM.
	   *
	   * 'both' allows movement horizontally and vertically.
	   * 'x' limits movement to horizontal axis.
	   * 'y' limits movement to vertical axis.
	   * 'none' limits all movement.
	   *
	   * Defaults to 'both'.
	   */
	  axis: _propTypes.default.oneOf(['both', 'x', 'y', 'none']),

	  /**
	   * `bounds` determines the range of movement available to the element.
	   * Available values are:
	   *
	   * 'parent' restricts movement within the Draggable's parent node.
	   *
	   * Alternatively, pass an object with the following properties, all of which are optional:
	   *
	   * {left: LEFT_BOUND, right: RIGHT_BOUND, bottom: BOTTOM_BOUND, top: TOP_BOUND}
	   *
	   * All values are in px.
	   *
	   * Example:
	   *
	   * ```jsx
	   *   let App = React.createClass({
	   *       render: function () {
	   *         return (
	   *            <Draggable bounds={{right: 300, bottom: 300}}>
	   *              <div>Content</div>
	   *           </Draggable>
	   *         );
	   *       }
	   *   });
	   * ```
	   */
	  bounds: _propTypes.default.oneOfType([_propTypes.default.shape({
	    left: _propTypes.default.number,
	    right: _propTypes.default.number,
	    top: _propTypes.default.number,
	    bottom: _propTypes.default.number
	  }), _propTypes.default.string, _propTypes.default.oneOf([false])]),
	  defaultClassName: _propTypes.default.string,
	  defaultClassNameDragging: _propTypes.default.string,
	  defaultClassNameDragged: _propTypes.default.string,

	  /**
	   * `defaultPosition` specifies the x and y that the dragged item should start at
	   *
	   * Example:
	   *
	   * ```jsx
	   *      let App = React.createClass({
	   *          render: function () {
	   *              return (
	   *                  <Draggable defaultPosition={{x: 25, y: 25}}>
	   *                      <div>I start with transformX: 25px and transformY: 25px;</div>
	   *                  </Draggable>
	   *              );
	   *          }
	   *      });
	   * ```
	   */
	  defaultPosition: _propTypes.default.shape({
	    x: _propTypes.default.number,
	    y: _propTypes.default.number
	  }),
	  positionOffset: _propTypes.default.shape({
	    x: _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.string]),
	    y: _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.string])
	  }),

	  /**
	   * `position`, if present, defines the current position of the element.
	   *
	   *  This is similar to how form elements in React work - if no `position` is supplied, the component
	   *  is uncontrolled.
	   *
	   * Example:
	   *
	   * ```jsx
	   *      let App = React.createClass({
	   *          render: function () {
	   *              return (
	   *                  <Draggable position={{x: 25, y: 25}}>
	   *                      <div>I start with transformX: 25px and transformY: 25px;</div>
	   *                  </Draggable>
	   *              );
	   *          }
	   *      });
	   * ```
	   */
	  position: _propTypes.default.shape({
	    x: _propTypes.default.number,
	    y: _propTypes.default.number
	  }),

	  /**
	   * These properties should be defined on the child, not here.
	   */
	  className: _shims.dontSetMe,
	  style: _shims.dontSetMe,
	  transform: _shims.dontSetMe
	}));

	_defineProperty(Draggable, "defaultProps", _objectSpread(_objectSpread({}, _DraggableCore.default.defaultProps), {}, {
	  axis: 'both',
	  bounds: false,
	  defaultClassName: 'react-draggable',
	  defaultClassNameDragging: 'react-draggable-dragging',
	  defaultClassNameDragged: 'react-draggable-dragged',
	  defaultPosition: {
	    x: 0,
	    y: 0
	  },
	  scale: 1
	})); 
} (Draggable$2));

var _require = Draggable$2,
    Draggable = _require.default,
    DraggableCore = _require.DraggableCore; // Previous versions of this lib exported <Draggable> as the root export. As to no-// them, or TypeScript, we export *both* as the root and as 'default'.
// See https://github.com/mzabriskie/react-draggable/pull/254
// and https://github.com/mzabriskie/react-draggable/issues/266


cjs.exports = Draggable;
cjs.exports.default = Draggable;
cjs.exports.DraggableCore = DraggableCore;

var cjsExports = cjs.exports;
var Draggable$1 = /*@__PURE__*/getDefaultExportFromCjs(cjsExports);

const GenericScreenPlotContainer = ({ disp, svgId }) => {
    const nodeRef = useRef(null);
    return (jsx(Draggable$1, { nodeRef: nodeRef, defaultPosition: { x: window.innerWidth / 1.5, y: -window.innerHeight / 1.5 }, children: jsx("div", { ref: nodeRef, className: "drag-box", style: { display: disp ? 'block' : 'none', boxShadow: "0px 5px 15px rgba(0, 0, 0, 0.35)", overflow: "auto", maxWidth: window.innerWidth / 2, maxHeight: window.innerHeight }, children: jsx("div", { id: svgId }) }) }));
};

function _objectWithoutPropertiesLoose(source, excluded) {
  if (source == null) return {};
  var target = {};
  var sourceKeys = Object.keys(source);
  var key, i;
  for (i = 0; i < sourceKeys.length; i++) {
    key = sourceKeys[i];
    if (excluded.indexOf(key) >= 0) continue;
    target[key] = source[key];
  }
  return target;
}

function _extends() {
  _extends = Object.assign ? Object.assign.bind() : function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];
      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }
    return target;
  };
  return _extends.apply(this, arguments);
}

function chainPropTypes(propType1, propType2) {
  if (process.env.NODE_ENV === 'production') {
    return () => null;
  }
  return function validate(...args) {
    return propType1(...args) || propType2(...args);
  };
}

function isPlainObject(item) {
  return item !== null && typeof item === 'object' && item.constructor === Object;
}
function deepClone(source) {
  if (!isPlainObject(source)) {
    return source;
  }
  const output = {};
  Object.keys(source).forEach(key => {
    output[key] = deepClone(source[key]);
  });
  return output;
}
function deepmerge(target, source, options = {
  clone: true
}) {
  const output = options.clone ? _extends({}, target) : target;
  if (isPlainObject(target) && isPlainObject(source)) {
    Object.keys(source).forEach(key => {
      // Avoid prototype pollution
      if (key === '__proto__') {
        return;
      }
      if (isPlainObject(source[key]) && key in target && isPlainObject(target[key])) {
        // Since `output` is a clone of `target` and we have narrowed `target` in this block we can cast to the same type.
        output[key] = deepmerge(target[key], source[key], options);
      } else if (options.clone) {
        output[key] = isPlainObject(source[key]) ? deepClone(source[key]) : source[key];
      } else {
        output[key] = source[key];
      }
    });
  }
  return output;
}

/**
 * WARNING: Don't import this directly.
 * Use `MuiError` from `@mui/utils/macros/MuiError.macro` instead.
 * @param {number} code
 */
function formatMuiErrorMessage(code) {
  // Apply babel-plugin-transform-template-literals in loose mode
  // loose mode is safe iff we're concatenating primitives
  // see https://babeljs.io/docs/en/babel-plugin-transform-template-literals#loose
  /* eslint-disable prefer-template */
  let url = 'https://mui.com/production-error/?code=' + code;
  for (let i = 1; i < arguments.length; i += 1) {
    // rest params over-transpile for this case
    // eslint-disable-next-line prefer-rest-params
    url += '&args[]=' + encodeURIComponent(arguments[i]);
  }
  return 'Minified MUI error #' + code + '; visit ' + url + ' for the full message.';
  /* eslint-enable prefer-template */
}

var reactIs = {exports: {}};

var reactIs_production_min = {};

/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

var hasRequiredReactIs_production_min;

function requireReactIs_production_min () {
	if (hasRequiredReactIs_production_min) return reactIs_production_min;
	hasRequiredReactIs_production_min = 1;
var b=Symbol.for("react.element"),c=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),e=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),h=Symbol.for("react.context"),k=Symbol.for("react.server_context"),l=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),n=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),t=Symbol.for("react.offscreen"),u;u=Symbol.for("react.module.reference");
	function v(a){if("object"===typeof a&&null!==a){var r=a.$$typeof;switch(r){case b:switch(a=a.type,a){case d:case f:case e:case m:case n:return a;default:switch(a=a&&a.$$typeof,a){case k:case h:case l:case q:case p:case g:return a;default:return r}}case c:return r}}}reactIs_production_min.ContextConsumer=h;reactIs_production_min.ContextProvider=g;reactIs_production_min.Element=b;reactIs_production_min.ForwardRef=l;reactIs_production_min.Fragment=d;reactIs_production_min.Lazy=q;reactIs_production_min.Memo=p;reactIs_production_min.Portal=c;reactIs_production_min.Profiler=f;reactIs_production_min.StrictMode=e;reactIs_production_min.Suspense=m;
	reactIs_production_min.SuspenseList=n;reactIs_production_min.isAsyncMode=function(){return !1};reactIs_production_min.isConcurrentMode=function(){return !1};reactIs_production_min.isContextConsumer=function(a){return v(a)===h};reactIs_production_min.isContextProvider=function(a){return v(a)===g};reactIs_production_min.isElement=function(a){return "object"===typeof a&&null!==a&&a.$$typeof===b};reactIs_production_min.isForwardRef=function(a){return v(a)===l};reactIs_production_min.isFragment=function(a){return v(a)===d};reactIs_production_min.isLazy=function(a){return v(a)===q};reactIs_production_min.isMemo=function(a){return v(a)===p};
	reactIs_production_min.isPortal=function(a){return v(a)===c};reactIs_production_min.isProfiler=function(a){return v(a)===f};reactIs_production_min.isStrictMode=function(a){return v(a)===e};reactIs_production_min.isSuspense=function(a){return v(a)===m};reactIs_production_min.isSuspenseList=function(a){return v(a)===n};
	reactIs_production_min.isValidElementType=function(a){return "string"===typeof a||"function"===typeof a||a===d||a===f||a===e||a===m||a===n||a===t||"object"===typeof a&&null!==a&&(a.$$typeof===q||a.$$typeof===p||a.$$typeof===g||a.$$typeof===h||a.$$typeof===l||a.$$typeof===u||void 0!==a.getModuleId)?!0:!1};reactIs_production_min.typeOf=v;
	return reactIs_production_min;
}

var reactIs_development = {};

/**
 * @license React
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

var hasRequiredReactIs_development;

function requireReactIs_development () {
	if (hasRequiredReactIs_development) return reactIs_development;
	hasRequiredReactIs_development = 1;

	if (process.env.NODE_ENV !== "production") {
	  (function() {

	// ATTENTION
	// When adding new symbols to this file,
	// Please consider also adding to 'react-devtools-shared/src/backend/ReactSymbols'
	// The Symbol used to tag the ReactElement-like types.
	var REACT_ELEMENT_TYPE = Symbol.for('react.element');
	var REACT_PORTAL_TYPE = Symbol.for('react.portal');
	var REACT_FRAGMENT_TYPE = Symbol.for('react.fragment');
	var REACT_STRICT_MODE_TYPE = Symbol.for('react.strict_mode');
	var REACT_PROFILER_TYPE = Symbol.for('react.profiler');
	var REACT_PROVIDER_TYPE = Symbol.for('react.provider');
	var REACT_CONTEXT_TYPE = Symbol.for('react.context');
	var REACT_SERVER_CONTEXT_TYPE = Symbol.for('react.server_context');
	var REACT_FORWARD_REF_TYPE = Symbol.for('react.forward_ref');
	var REACT_SUSPENSE_TYPE = Symbol.for('react.suspense');
	var REACT_SUSPENSE_LIST_TYPE = Symbol.for('react.suspense_list');
	var REACT_MEMO_TYPE = Symbol.for('react.memo');
	var REACT_LAZY_TYPE = Symbol.for('react.lazy');
	var REACT_OFFSCREEN_TYPE = Symbol.for('react.offscreen');

	// -----------------------------------------------------------------------------

	var enableScopeAPI = false; // Experimental Create Event Handle API.
	var enableCacheElement = false;
	var enableTransitionTracing = false; // No known bugs, but needs performance testing

	var enableLegacyHidden = false; // Enables unstable_avoidThisFallback feature in Fiber
	// stuff. Intended to enable React core members to more easily debug scheduling
	// issues in DEV builds.

	var enableDebugTracing = false; // Track which Fiber(s) schedule render work.

	var REACT_MODULE_REFERENCE;

	{
	  REACT_MODULE_REFERENCE = Symbol.for('react.module.reference');
	}

	function isValidElementType(type) {
	  if (typeof type === 'string' || typeof type === 'function') {
	    return true;
	  } // Note: typeof might be other than 'symbol' or 'number' (e.g. if it's a polyfill).


	  if (type === REACT_FRAGMENT_TYPE || type === REACT_PROFILER_TYPE || enableDebugTracing  || type === REACT_STRICT_MODE_TYPE || type === REACT_SUSPENSE_TYPE || type === REACT_SUSPENSE_LIST_TYPE || enableLegacyHidden  || type === REACT_OFFSCREEN_TYPE || enableScopeAPI  || enableCacheElement  || enableTransitionTracing ) {
	    return true;
	  }

	  if (typeof type === 'object' && type !== null) {
	    if (type.$$typeof === REACT_LAZY_TYPE || type.$$typeof === REACT_MEMO_TYPE || type.$$typeof === REACT_PROVIDER_TYPE || type.$$typeof === REACT_CONTEXT_TYPE || type.$$typeof === REACT_FORWARD_REF_TYPE || // This needs to include all possible module reference object
	    // types supported by any Flight configuration anywhere since
	    // we don't know which Flight build this will end up being used
	    // with.
	    type.$$typeof === REACT_MODULE_REFERENCE || type.getModuleId !== undefined) {
	      return true;
	    }
	  }

	  return false;
	}

	function typeOf(object) {
	  if (typeof object === 'object' && object !== null) {
	    var $$typeof = object.$$typeof;

	    switch ($$typeof) {
	      case REACT_ELEMENT_TYPE:
	        var type = object.type;

	        switch (type) {
	          case REACT_FRAGMENT_TYPE:
	          case REACT_PROFILER_TYPE:
	          case REACT_STRICT_MODE_TYPE:
	          case REACT_SUSPENSE_TYPE:
	          case REACT_SUSPENSE_LIST_TYPE:
	            return type;

	          default:
	            var $$typeofType = type && type.$$typeof;

	            switch ($$typeofType) {
	              case REACT_SERVER_CONTEXT_TYPE:
	              case REACT_CONTEXT_TYPE:
	              case REACT_FORWARD_REF_TYPE:
	              case REACT_LAZY_TYPE:
	              case REACT_MEMO_TYPE:
	              case REACT_PROVIDER_TYPE:
	                return $$typeofType;

	              default:
	                return $$typeof;
	            }

	        }

	      case REACT_PORTAL_TYPE:
	        return $$typeof;
	    }
	  }

	  return undefined;
	}
	var ContextConsumer = REACT_CONTEXT_TYPE;
	var ContextProvider = REACT_PROVIDER_TYPE;
	var Element = REACT_ELEMENT_TYPE;
	var ForwardRef = REACT_FORWARD_REF_TYPE;
	var Fragment = REACT_FRAGMENT_TYPE;
	var Lazy = REACT_LAZY_TYPE;
	var Memo = REACT_MEMO_TYPE;
	var Portal = REACT_PORTAL_TYPE;
	var Profiler = REACT_PROFILER_TYPE;
	var StrictMode = REACT_STRICT_MODE_TYPE;
	var Suspense = REACT_SUSPENSE_TYPE;
	var SuspenseList = REACT_SUSPENSE_LIST_TYPE;
	var hasWarnedAboutDeprecatedIsAsyncMode = false;
	var hasWarnedAboutDeprecatedIsConcurrentMode = false; // AsyncMode should be deprecated

	function isAsyncMode(object) {
	  {
	    if (!hasWarnedAboutDeprecatedIsAsyncMode) {
	      hasWarnedAboutDeprecatedIsAsyncMode = true; // Using console['warn'] to evade Babel and ESLint

	      console['warn']('The ReactIs.isAsyncMode() alias has been deprecated, ' + 'and will be removed in React 18+.');
	    }
	  }

	  return false;
	}
	function isConcurrentMode(object) {
	  {
	    if (!hasWarnedAboutDeprecatedIsConcurrentMode) {
	      hasWarnedAboutDeprecatedIsConcurrentMode = true; // Using console['warn'] to evade Babel and ESLint

	      console['warn']('The ReactIs.isConcurrentMode() alias has been deprecated, ' + 'and will be removed in React 18+.');
	    }
	  }

	  return false;
	}
	function isContextConsumer(object) {
	  return typeOf(object) === REACT_CONTEXT_TYPE;
	}
	function isContextProvider(object) {
	  return typeOf(object) === REACT_PROVIDER_TYPE;
	}
	function isElement(object) {
	  return typeof object === 'object' && object !== null && object.$$typeof === REACT_ELEMENT_TYPE;
	}
	function isForwardRef(object) {
	  return typeOf(object) === REACT_FORWARD_REF_TYPE;
	}
	function isFragment(object) {
	  return typeOf(object) === REACT_FRAGMENT_TYPE;
	}
	function isLazy(object) {
	  return typeOf(object) === REACT_LAZY_TYPE;
	}
	function isMemo(object) {
	  return typeOf(object) === REACT_MEMO_TYPE;
	}
	function isPortal(object) {
	  return typeOf(object) === REACT_PORTAL_TYPE;
	}
	function isProfiler(object) {
	  return typeOf(object) === REACT_PROFILER_TYPE;
	}
	function isStrictMode(object) {
	  return typeOf(object) === REACT_STRICT_MODE_TYPE;
	}
	function isSuspense(object) {
	  return typeOf(object) === REACT_SUSPENSE_TYPE;
	}
	function isSuspenseList(object) {
	  return typeOf(object) === REACT_SUSPENSE_LIST_TYPE;
	}

	reactIs_development.ContextConsumer = ContextConsumer;
	reactIs_development.ContextProvider = ContextProvider;
	reactIs_development.Element = Element;
	reactIs_development.ForwardRef = ForwardRef;
	reactIs_development.Fragment = Fragment;
	reactIs_development.Lazy = Lazy;
	reactIs_development.Memo = Memo;
	reactIs_development.Portal = Portal;
	reactIs_development.Profiler = Profiler;
	reactIs_development.StrictMode = StrictMode;
	reactIs_development.Suspense = Suspense;
	reactIs_development.SuspenseList = SuspenseList;
	reactIs_development.isAsyncMode = isAsyncMode;
	reactIs_development.isConcurrentMode = isConcurrentMode;
	reactIs_development.isContextConsumer = isContextConsumer;
	reactIs_development.isContextProvider = isContextProvider;
	reactIs_development.isElement = isElement;
	reactIs_development.isForwardRef = isForwardRef;
	reactIs_development.isFragment = isFragment;
	reactIs_development.isLazy = isLazy;
	reactIs_development.isMemo = isMemo;
	reactIs_development.isPortal = isPortal;
	reactIs_development.isProfiler = isProfiler;
	reactIs_development.isStrictMode = isStrictMode;
	reactIs_development.isSuspense = isSuspense;
	reactIs_development.isSuspenseList = isSuspenseList;
	reactIs_development.isValidElementType = isValidElementType;
	reactIs_development.typeOf = typeOf;
	  })();
	}
	return reactIs_development;
}

if (process.env.NODE_ENV === 'production') {
  reactIs.exports = requireReactIs_production_min();
} else {
  reactIs.exports = requireReactIs_development();
}

var reactIsExports = reactIs.exports;

// Simplified polyfill for IE11 support
// https://github.com/JamesMGreene/Function.name/blob/58b314d4a983110c3682f1228f845d39ccca1817/Function.name.js#L3
const fnNameMatchRegex = /^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;
function getFunctionName(fn) {
  const match = `${fn}`.match(fnNameMatchRegex);
  const name = match && match[1];
  return name || '';
}
function getFunctionComponentName(Component, fallback = '') {
  return Component.displayName || Component.name || getFunctionName(Component) || fallback;
}
function getWrappedName(outerType, innerType, wrapperName) {
  const functionName = getFunctionComponentName(innerType);
  return outerType.displayName || (functionName !== '' ? `${wrapperName}(${functionName})` : wrapperName);
}

/**
 * cherry-pick from
 * https://github.com/facebook/react/blob/769b1f270e1251d9dbdce0fcbd9e92e502d059b8/packages/shared/getComponentName.js
 * originally forked from recompose/getDisplayName with added IE11 support
 */
function getDisplayName(Component) {
  if (Component == null) {
    return undefined;
  }
  if (typeof Component === 'string') {
    return Component;
  }
  if (typeof Component === 'function') {
    return getFunctionComponentName(Component, 'Component');
  }

  // TypeScript can't have components as objects but they exist in the form of `memo` or `Suspense`
  if (typeof Component === 'object') {
    switch (Component.$$typeof) {
      case reactIsExports.ForwardRef:
        return getWrappedName(Component, Component.render, 'ForwardRef');
      case reactIsExports.Memo:
        return getWrappedName(Component, Component.type, 'memo');
      default:
        return undefined;
    }
  }
  return undefined;
}

// It should to be noted that this function isn't equivalent to `text-transform: capitalize`.
//
// A strict capitalization should uppercase the first letter of each word in the sentence.
// We only handle the first word.
function capitalize(string) {
  if (typeof string !== 'string') {
    throw new Error(process.env.NODE_ENV !== "production" ? `MUI: \`capitalize(string)\` expects a string argument.` : formatMuiErrorMessage(7));
  }
  return string.charAt(0).toUpperCase() + string.slice(1);
}

function ownerDocument(node) {
  return node && node.ownerDocument || document;
}

/**
 * TODO v5: consider making it private
 *
 * passes {value} to {ref}
 *
 * WARNING: Be sure to only call this inside a callback that is passed as a ref.
 * Otherwise, make sure to cleanup the previous {ref} if it changes. See
 * https://github.com/mui/material-ui/issues/13539
 *
 * Useful if you want to expose the ref of an inner component to the public API
 * while still using it inside the component.
 * @param ref A ref callback or ref object. If anything falsy, this is a no-op.
 */
function setRef(ref, value) {
  if (typeof ref === 'function') {
    ref(value);
  } else if (ref) {
    ref.current = value;
  }
}

const useEnhancedEffect = typeof window !== 'undefined' ? React$1.useLayoutEffect : React$1.useEffect;
var useEnhancedEffect$1 = useEnhancedEffect;

/* eslint-disable react-hooks/rules-of-hooks, react-hooks/exhaustive-deps */
function useControlled({
  controlled,
  default: defaultProp,
  name,
  state = 'value'
}) {
  // isControlled is ignored in the hook dependency lists as it should never change.
  const {
    current: isControlled
  } = React$1.useRef(controlled !== undefined);
  const [valueState, setValue] = React$1.useState(defaultProp);
  const value = isControlled ? controlled : valueState;
  if (process.env.NODE_ENV !== 'production') {
    React$1.useEffect(() => {
      if (isControlled !== (controlled !== undefined)) {
        console.error([`MUI: A component is changing the ${isControlled ? '' : 'un'}controlled ${state} state of ${name} to be ${isControlled ? 'un' : ''}controlled.`, 'Elements should not switch from uncontrolled to controlled (or vice versa).', `Decide between using a controlled or uncontrolled ${name} ` + 'element for the lifetime of the component.', "The nature of the state is determined during the first render. It's considered controlled if the value is not `undefined`.", 'More info: https://fb.me/react-controlled-components'].join('\n'));
      }
    }, [state, name, controlled]);
    const {
      current: defaultValue
    } = React$1.useRef(defaultProp);
    React$1.useEffect(() => {
      if (!isControlled && defaultValue !== defaultProp) {
        console.error([`MUI: A component is changing the default ${state} state of an uncontrolled ${name} after being initialized. ` + `To suppress this warning opt to use a controlled ${name}.`].join('\n'));
      }
    }, [JSON.stringify(defaultProp)]);
  }
  const setValueIfUncontrolled = React$1.useCallback(newValue => {
    if (!isControlled) {
      setValue(newValue);
    }
  }, []);
  return [value, setValueIfUncontrolled];
}

/**
 * https://github.com/facebook/react/issues/14099#issuecomment-440013892
 */
function useEventCallback(fn) {
  const ref = React$1.useRef(fn);
  useEnhancedEffect$1(() => {
    ref.current = fn;
  });
  return React$1.useCallback((...args) =>
  // @ts-expect-error hide `this`
  // tslint:disable-next-line:ban-comma-operator
  (0, ref.current)(...args), []);
}

function useForkRef(...refs) {
  /**
   * This will create a new function if the refs passed to this hook change and are all defined.
   * This means react will call the old forkRef with `null` and the new forkRef
   * with the ref. Cleanup naturally emerges from this behavior.
   */
  return React$1.useMemo(() => {
    if (refs.every(ref => ref == null)) {
      return null;
    }
    return instance => {
      refs.forEach(ref => {
        setRef(ref, instance);
      });
    };
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, refs);
}

// based on https://github.com/WICG/focus-visible/blob/v4.1.5/src/focus-visible.js
let hadKeyboardEvent = true;
let hadFocusVisibleRecently = false;
let hadFocusVisibleRecentlyTimeout;
const inputTypesWhitelist = {
  text: true,
  search: true,
  url: true,
  tel: true,
  email: true,
  password: true,
  number: true,
  date: true,
  month: true,
  week: true,
  time: true,
  datetime: true,
  'datetime-local': true
};

/**
 * Computes whether the given element should automatically trigger the
 * `focus-visible` class being added, i.e. whether it should always match
 * `:focus-visible` when focused.
 * @param {Element} node
 * @returns {boolean}
 */
function focusTriggersKeyboardModality(node) {
  const {
    type,
    tagName
  } = node;
  if (tagName === 'INPUT' && inputTypesWhitelist[type] && !node.readOnly) {
    return true;
  }
  if (tagName === 'TEXTAREA' && !node.readOnly) {
    return true;
  }
  if (node.isContentEditable) {
    return true;
  }
  return false;
}

/**
 * Keep track of our keyboard modality state with `hadKeyboardEvent`.
 * If the most recent user interaction was via the keyboard;
 * and the key press did not include a meta, alt/option, or control key;
 * then the modality is keyboard. Otherwise, the modality is not keyboard.
 * @param {KeyboardEvent} event
 */
function handleKeyDown(event) {
  if (event.metaKey || event.altKey || event.ctrlKey) {
    return;
  }
  hadKeyboardEvent = true;
}

/**
 * If at any point a user clicks with a pointing device, ensure that we change
 * the modality away from keyboard.
 * This avoids the situation where a user presses a key on an already focused
 * element, and then clicks on a different element, focusing it with a
 * pointing device, while we still think we're in keyboard modality.
 */
function handlePointerDown() {
  hadKeyboardEvent = false;
}
function handleVisibilityChange() {
  if (this.visibilityState === 'hidden') {
    // If the tab becomes active again, the browser will handle calling focus
    // on the element (Safari actually calls it twice).
    // If this tab change caused a blur on an element with focus-visible,
    // re-apply the class when the user switches back to the tab.
    if (hadFocusVisibleRecently) {
      hadKeyboardEvent = true;
    }
  }
}
function prepare(doc) {
  doc.addEventListener('keydown', handleKeyDown, true);
  doc.addEventListener('mousedown', handlePointerDown, true);
  doc.addEventListener('pointerdown', handlePointerDown, true);
  doc.addEventListener('touchstart', handlePointerDown, true);
  doc.addEventListener('visibilitychange', handleVisibilityChange, true);
}
function isFocusVisible(event) {
  const {
    target
  } = event;
  try {
    return target.matches(':focus-visible');
  } catch (error) {
    // Browsers not implementing :focus-visible will throw a SyntaxError.
    // We use our own heuristic for those browsers.
    // Rethrow might be better if it's not the expected error but do we really
    // want to crash if focus-visible malfunctioned?
  }

  // No need for validFocusTarget check. The user does that by attaching it to
  // focusable events only.
  return hadKeyboardEvent || focusTriggersKeyboardModality(target);
}
function useIsFocusVisible() {
  const ref = React$1.useCallback(node => {
    if (node != null) {
      prepare(node.ownerDocument);
    }
  }, []);
  const isFocusVisibleRef = React$1.useRef(false);

  /**
   * Should be called if a blur event is fired
   */
  function handleBlurVisible() {
    // checking against potential state variable does not suffice if we focus and blur synchronously.
    // React wouldn't have time to trigger a re-render so `focusVisible` would be stale.
    // Ideally we would adjust `isFocusVisible(event)` to look at `relatedTarget` for blur events.
    // This doesn't work in IE11 due to https://github.com/facebook/react/issues/3751
    // TODO: check again if React releases their internal changes to focus event handling (https://github.com/facebook/react/pull/19186).
    if (isFocusVisibleRef.current) {
      // To detect a tab/window switch, we look for a blur event followed
      // rapidly by a visibility change.
      // If we don't see a visibility change within 100ms, it's probably a
      // regular focus change.
      hadFocusVisibleRecently = true;
      window.clearTimeout(hadFocusVisibleRecentlyTimeout);
      hadFocusVisibleRecentlyTimeout = window.setTimeout(() => {
        hadFocusVisibleRecently = false;
      }, 100);
      isFocusVisibleRef.current = false;
      return true;
    }
    return false;
  }

  /**
   * Should be called if a blur event is fired
   */
  function handleFocusVisible(event) {
    if (isFocusVisible(event)) {
      isFocusVisibleRef.current = true;
      return true;
    }
    return false;
  }
  return {
    isFocusVisibleRef,
    onFocus: handleFocusVisible,
    onBlur: handleBlurVisible,
    ref
  };
}

const visuallyHidden = {
  border: 0,
  clip: 'rect(0 0 0 0)',
  height: '1px',
  margin: -1,
  overflow: 'hidden',
  padding: 0,
  position: 'absolute',
  whiteSpace: 'nowrap',
  width: '1px'
};
var visuallyHidden$1 = visuallyHidden;

/**
 * Add keys, values of `defaultProps` that does not exist in `props`
 * @param {object} defaultProps
 * @param {object} props
 * @returns {object} resolved props
 */
function resolveProps(defaultProps, props) {
  const output = _extends({}, props);
  Object.keys(defaultProps).forEach(propName => {
    if (propName.toString().match(/^(components|slots)$/)) {
      output[propName] = _extends({}, defaultProps[propName], output[propName]);
    } else if (propName.toString().match(/^(componentsProps|slotProps)$/)) {
      const defaultSlotProps = defaultProps[propName] || {};
      const slotProps = props[propName];
      output[propName] = {};
      if (!slotProps || !Object.keys(slotProps)) {
        // Reduce the iteration if the slot props is empty
        output[propName] = defaultSlotProps;
      } else if (!defaultSlotProps || !Object.keys(defaultSlotProps)) {
        // Reduce the iteration if the default slot props is empty
        output[propName] = slotProps;
      } else {
        output[propName] = _extends({}, slotProps);
        Object.keys(defaultSlotProps).forEach(slotPropName => {
          output[propName][slotPropName] = resolveProps(defaultSlotProps[slotPropName], slotProps[slotPropName]);
        });
      }
    } else if (output[propName] === undefined) {
      output[propName] = defaultProps[propName];
    }
  });
  return output;
}

function composeClasses(slots, getUtilityClass, classes = undefined) {
  const output = {};
  Object.keys(slots).forEach(
  // `Objet.keys(slots)` can't be wider than `T` because we infer `T` from `slots`.
  // @ts-expect-error https://github.com/microsoft/TypeScript/pull/12253#issuecomment-263132208
  slot => {
    output[slot] = slots[slot].reduce((acc, key) => {
      if (key) {
        const utilityClass = getUtilityClass(key);
        if (utilityClass !== '') {
          acc.push(utilityClass);
        }
        if (classes && classes[key]) {
          acc.push(classes[key]);
        }
      }
      return acc;
    }, []).join(' ');
  });
  return output;
}

const defaultGenerator = componentName => componentName;
const createClassNameGenerator = () => {
  let generate = defaultGenerator;
  return {
    configure(generator) {
      generate = generator;
    },
    generate(componentName) {
      return generate(componentName);
    },
    reset() {
      generate = defaultGenerator;
    }
  };
};
const ClassNameGenerator = createClassNameGenerator();
var ClassNameGenerator$1 = ClassNameGenerator;

const globalStateClassesMapping = {
  active: 'active',
  checked: 'checked',
  completed: 'completed',
  disabled: 'disabled',
  readOnly: 'readOnly',
  error: 'error',
  expanded: 'expanded',
  focused: 'focused',
  focusVisible: 'focusVisible',
  required: 'required',
  selected: 'selected'
};
function generateUtilityClass(componentName, slot, globalStatePrefix = 'Mui') {
  const globalStateClass = globalStateClassesMapping[slot];
  return globalStateClass ? `${globalStatePrefix}-${globalStateClass}` : `${ClassNameGenerator$1.generate(componentName)}-${slot}`;
}

function generateUtilityClasses(componentName, slots, globalStatePrefix = 'Mui') {
  const result = {};
  slots.forEach(slot => {
    result[slot] = generateUtilityClass(componentName, slot, globalStatePrefix);
  });
  return result;
}

/**
 * Determines if a given element is a DOM element name (i.e. not a React component).
 */
function isHostComponent(element) {
  return typeof element === 'string';
}

/**
 * Type of the ownerState based on the type of an element it applies to.
 * This resolves to the provided OwnerState for React components and `undefined` for host components.
 * Falls back to `OwnerState | undefined` when the exact type can't be determined in development time.
 */

/**
 * Appends the ownerState object to the props, merging with the existing one if necessary.
 *
 * @param elementType Type of the element that owns the `existingProps`. If the element is a DOM node or undefined, `ownerState` is not applied.
 * @param otherProps Props of the element.
 * @param ownerState
 */
function appendOwnerState(elementType, otherProps, ownerState) {
  if (elementType === undefined || isHostComponent(elementType)) {
    return otherProps;
  }
  return _extends({}, otherProps, {
    ownerState: _extends({}, otherProps.ownerState, ownerState)
  });
}

function areArraysEqual(array1, array2, itemComparer = (a, b) => a === b) {
  return array1.length === array2.length && array1.every((value, index) => itemComparer(value, array2[index]));
}

/**
 * Extracts event handlers from a given object.
 * A prop is considered an event handler if it is a function and its name starts with `on`.
 *
 * @param object An object to extract event handlers from.
 * @param excludeKeys An array of keys to exclude from the returned object.
 */
function extractEventHandlers(object, excludeKeys = []) {
  if (object === undefined) {
    return {};
  }
  const result = {};
  Object.keys(object).filter(prop => prop.match(/^on[A-Z]/) && typeof object[prop] === 'function' && !excludeKeys.includes(prop)).forEach(prop => {
    result[prop] = object[prop];
  });
  return result;
}

/**
 * If `componentProps` is a function, calls it with the provided `ownerState`.
 * Otherwise, just returns `componentProps`.
 */
function resolveComponentProps(componentProps, ownerState) {
  if (typeof componentProps === 'function') {
    return componentProps(ownerState);
  }
  return componentProps;
}

/**
 * Removes event handlers from the given object.
 * A field is considered an event handler if it is a function with a name beginning with `on`.
 *
 * @param object Object to remove event handlers from.
 * @returns Object with event handlers removed.
 */
function omitEventHandlers(object) {
  if (object === undefined) {
    return {};
  }
  const result = {};
  Object.keys(object).filter(prop => !(prop.match(/^on[A-Z]/) && typeof object[prop] === 'function')).forEach(prop => {
    result[prop] = object[prop];
  });
  return result;
}

/**
 * Merges the slot component internal props (usually coming from a hook)
 * with the externally provided ones.
 *
 * The merge order is (the latter overrides the former):
 * 1. The internal props (specified as a getter function to work with get*Props hook result)
 * 2. Additional props (specified internally on a Base UI component)
 * 3. External props specified on the owner component. These should only be used on a root slot.
 * 4. External props specified in the `slotProps.*` prop.
 * 5. The `className` prop - combined from all the above.
 * @param parameters
 * @returns
 */
function mergeSlotProps(parameters) {
  const {
    getSlotProps,
    additionalProps,
    externalSlotProps,
    externalForwardedProps,
    className
  } = parameters;
  if (!getSlotProps) {
    // The simpler case - getSlotProps is not defined, so no internal event handlers are defined,
    // so we can simply merge all the props without having to worry about extracting event handlers.
    const joinedClasses = clsx(externalForwardedProps == null ? void 0 : externalForwardedProps.className, externalSlotProps == null ? void 0 : externalSlotProps.className, className, additionalProps == null ? void 0 : additionalProps.className);
    const mergedStyle = _extends({}, additionalProps == null ? void 0 : additionalProps.style, externalForwardedProps == null ? void 0 : externalForwardedProps.style, externalSlotProps == null ? void 0 : externalSlotProps.style);
    const props = _extends({}, additionalProps, externalForwardedProps, externalSlotProps);
    if (joinedClasses.length > 0) {
      props.className = joinedClasses;
    }
    if (Object.keys(mergedStyle).length > 0) {
      props.style = mergedStyle;
    }
    return {
      props,
      internalRef: undefined
    };
  }

  // In this case, getSlotProps is responsible for calling the external event handlers.
  // We don't need to include them in the merged props because of this.

  const eventHandlers = extractEventHandlers(_extends({}, externalForwardedProps, externalSlotProps));
  const componentsPropsWithoutEventHandlers = omitEventHandlers(externalSlotProps);
  const otherPropsWithoutEventHandlers = omitEventHandlers(externalForwardedProps);
  const internalSlotProps = getSlotProps(eventHandlers);

  // The order of classes is important here.
  // Emotion (that we use in libraries consuming Base UI) depends on this order
  // to properly override style. It requires the most important classes to be last
  // (see https://github.com/mui/material-ui/pull/33205) for the related discussion.
  const joinedClasses = clsx(internalSlotProps == null ? void 0 : internalSlotProps.className, additionalProps == null ? void 0 : additionalProps.className, className, externalForwardedProps == null ? void 0 : externalForwardedProps.className, externalSlotProps == null ? void 0 : externalSlotProps.className);
  const mergedStyle = _extends({}, internalSlotProps == null ? void 0 : internalSlotProps.style, additionalProps == null ? void 0 : additionalProps.style, externalForwardedProps == null ? void 0 : externalForwardedProps.style, externalSlotProps == null ? void 0 : externalSlotProps.style);
  const props = _extends({}, internalSlotProps, additionalProps, otherPropsWithoutEventHandlers, componentsPropsWithoutEventHandlers);
  if (joinedClasses.length > 0) {
    props.className = joinedClasses;
  }
  if (Object.keys(mergedStyle).length > 0) {
    props.style = mergedStyle;
  }
  return {
    props,
    internalRef: internalSlotProps.ref
  };
}

const _excluded$9 = ["elementType", "externalSlotProps", "ownerState"];
/**
 * @ignore - do not document.
 * Builds the props to be passed into the slot of an unstyled component.
 * It merges the internal props of the component with the ones supplied by the user, allowing to customize the behavior.
 * If the slot component is not a host component, it also merges in the `ownerState`.
 *
 * @param parameters.getSlotProps - A function that returns the props to be passed to the slot component.
 */
function useSlotProps(parameters) {
  var _parameters$additiona;
  const {
      elementType,
      externalSlotProps,
      ownerState
    } = parameters,
    rest = _objectWithoutPropertiesLoose(parameters, _excluded$9);
  const resolvedComponentsProps = resolveComponentProps(externalSlotProps, ownerState);
  const {
    props: mergedProps,
    internalRef
  } = mergeSlotProps(_extends({}, rest, {
    externalSlotProps: resolvedComponentsProps
  }));
  const ref = useForkRef(internalRef, resolvedComponentsProps == null ? void 0 : resolvedComponentsProps.ref, (_parameters$additiona = parameters.additionalProps) == null ? void 0 : _parameters$additiona.ref);
  const props = appendOwnerState(elementType, _extends({}, mergedProps, {
    ref
  }), ownerState);
  return props;
}

const INTENTIONAL_DRAG_COUNT_THRESHOLD = 2;
function asc(a, b) {
  return a - b;
}
function clamp$1(value, min, max) {
  if (value == null) {
    return min;
  }
  return Math.min(Math.max(min, value), max);
}
function findClosest(values, currentValue) {
  var _values$reduce;
  const {
    index: closestIndex
  } = (_values$reduce = values.reduce((acc, value, index) => {
    const distance = Math.abs(currentValue - value);
    if (acc === null || distance < acc.distance || distance === acc.distance) {
      return {
        distance,
        index
      };
    }
    return acc;
  }, null)) != null ? _values$reduce : {};
  return closestIndex;
}
function trackFinger(event, touchId) {
  // The event is TouchEvent
  if (touchId.current !== undefined && event.changedTouches) {
    const touchEvent = event;
    for (let i = 0; i < touchEvent.changedTouches.length; i += 1) {
      const touch = touchEvent.changedTouches[i];
      if (touch.identifier === touchId.current) {
        return {
          x: touch.clientX,
          y: touch.clientY
        };
      }
    }
    return false;
  }

  // The event is MouseEvent
  return {
    x: event.clientX,
    y: event.clientY
  };
}
function valueToPercent(value, min, max) {
  return (value - min) * 100 / (max - min);
}
function percentToValue(percent, min, max) {
  return (max - min) * percent + min;
}
function getDecimalPrecision(num) {
  // This handles the case when num is very small (0.00000001), js will turn this into 1e-8.
  // When num is bigger than 1 or less than -1 it won't get converted to this notation so it's fine.
  if (Math.abs(num) < 1) {
    const parts = num.toExponential().split('e-');
    const matissaDecimalPart = parts[0].split('.')[1];
    return (matissaDecimalPart ? matissaDecimalPart.length : 0) + parseInt(parts[1], 10);
  }
  const decimalPart = num.toString().split('.')[1];
  return decimalPart ? decimalPart.length : 0;
}
function roundValueToStep(value, step, min) {
  const nearest = Math.round((value - min) / step) * step + min;
  return Number(nearest.toFixed(getDecimalPrecision(step)));
}
function setValueIndex({
  values,
  newValue,
  index
}) {
  const output = values.slice();
  output[index] = newValue;
  return output.sort(asc);
}
function focusThumb({
  sliderRef,
  activeIndex,
  setActive
}) {
  var _sliderRef$current, _doc$activeElement;
  const doc = ownerDocument(sliderRef.current);
  if (!((_sliderRef$current = sliderRef.current) != null && _sliderRef$current.contains(doc.activeElement)) || Number(doc == null ? void 0 : (_doc$activeElement = doc.activeElement) == null ? void 0 : _doc$activeElement.getAttribute('data-index')) !== activeIndex) {
    var _sliderRef$current2;
    (_sliderRef$current2 = sliderRef.current) == null ? void 0 : _sliderRef$current2.querySelector(`[type="range"][data-index="${activeIndex}"]`).focus();
  }
  if (setActive) {
    setActive(activeIndex);
  }
}
function areValuesEqual(newValue, oldValue) {
  if (typeof newValue === 'number' && typeof oldValue === 'number') {
    return newValue === oldValue;
  }
  if (typeof newValue === 'object' && typeof oldValue === 'object') {
    return areArraysEqual(newValue, oldValue);
  }
  return false;
}
const axisProps = {
  horizontal: {
    offset: percent => ({
      left: `${percent}%`
    }),
    leap: percent => ({
      width: `${percent}%`
    })
  },
  'horizontal-reverse': {
    offset: percent => ({
      right: `${percent}%`
    }),
    leap: percent => ({
      width: `${percent}%`
    })
  },
  vertical: {
    offset: percent => ({
      bottom: `${percent}%`
    }),
    leap: percent => ({
      height: `${percent}%`
    })
  }
};
const Identity$1 = x => x;

// TODO: remove support for Safari < 13.
// https://caniuse.com/#search=touch-action
//
// Safari, on iOS, supports touch action since v13.
// Over 80% of the iOS phones are compatible
// in August 2020.
// Utilizing the CSS.supports method to check if touch-action is supported.
// Since CSS.supports is supported on all but Edge@12 and IE and touch-action
// is supported on both Edge@12 and IE if CSS.supports is not available that means that
// touch-action will be supported
let cachedSupportsTouchActionNone;
function doesSupportTouchActionNone() {
  if (cachedSupportsTouchActionNone === undefined) {
    if (typeof CSS !== 'undefined' && typeof CSS.supports === 'function') {
      cachedSupportsTouchActionNone = CSS.supports('touch-action', 'none');
    } else {
      cachedSupportsTouchActionNone = true;
    }
  }
  return cachedSupportsTouchActionNone;
}
/**
 *
 * Demos:
 *
 * - [Slider](https://mui.com/base/react-slider/#hook)
 *
 * API:
 *
 * - [useSlider API](https://mui.com/base/react-slider/hooks-api/#use-slider)
 */
function useSlider(parameters) {
  const {
    'aria-labelledby': ariaLabelledby,
    defaultValue,
    disabled = false,
    disableSwap = false,
    isRtl = false,
    marks: marksProp = false,
    max = 100,
    min = 0,
    name,
    onChange,
    onChangeCommitted,
    orientation = 'horizontal',
    rootRef: ref,
    scale = Identity$1,
    step = 1,
    tabIndex,
    value: valueProp
  } = parameters;
  const touchId = React$1.useRef();
  // We can't use the :active browser pseudo-classes.
  // - The active state isn't triggered when clicking on the rail.
  // - The active state isn't transferred when inversing a range slider.
  const [active, setActive] = React$1.useState(-1);
  const [open, setOpen] = React$1.useState(-1);
  const [dragging, setDragging] = React$1.useState(false);
  const moveCount = React$1.useRef(0);
  const [valueDerived, setValueState] = useControlled({
    controlled: valueProp,
    default: defaultValue != null ? defaultValue : min,
    name: 'Slider'
  });
  const handleChange = onChange && ((event, value, thumbIndex) => {
    // Redefine target to allow name and value to be read.
    // This allows seamless integration with the most popular form libraries.
    // https://github.com/mui/material-ui/issues/13485#issuecomment-676048492
    // Clone the event to not override `target` of the original event.
    const nativeEvent = event.nativeEvent || event;
    // @ts-ignore The nativeEvent is function, not object
    const clonedEvent = new nativeEvent.constructor(nativeEvent.type, nativeEvent);
    Object.defineProperty(clonedEvent, 'target', {
      writable: true,
      value: {
        value,
        name
      }
    });
    onChange(clonedEvent, value, thumbIndex);
  });
  const range = Array.isArray(valueDerived);
  let values = range ? valueDerived.slice().sort(asc) : [valueDerived];
  values = values.map(value => clamp$1(value, min, max));
  const marks = marksProp === true && step !== null ? [...Array(Math.floor((max - min) / step) + 1)].map((_, index) => ({
    value: min + step * index
  })) : marksProp || [];
  const marksValues = marks.map(mark => mark.value);
  const {
    isFocusVisibleRef,
    onBlur: handleBlurVisible,
    onFocus: handleFocusVisible,
    ref: focusVisibleRef
  } = useIsFocusVisible();
  const [focusedThumbIndex, setFocusedThumbIndex] = React$1.useState(-1);
  const sliderRef = React$1.useRef();
  const handleFocusRef = useForkRef(focusVisibleRef, sliderRef);
  const handleRef = useForkRef(ref, handleFocusRef);
  const createHandleHiddenInputFocus = otherHandlers => event => {
    var _otherHandlers$onFocu;
    const index = Number(event.currentTarget.getAttribute('data-index'));
    handleFocusVisible(event);
    if (isFocusVisibleRef.current === true) {
      setFocusedThumbIndex(index);
    }
    setOpen(index);
    otherHandlers == null ? void 0 : (_otherHandlers$onFocu = otherHandlers.onFocus) == null ? void 0 : _otherHandlers$onFocu.call(otherHandlers, event);
  };
  const createHandleHiddenInputBlur = otherHandlers => event => {
    var _otherHandlers$onBlur;
    handleBlurVisible(event);
    if (isFocusVisibleRef.current === false) {
      setFocusedThumbIndex(-1);
    }
    setOpen(-1);
    otherHandlers == null ? void 0 : (_otherHandlers$onBlur = otherHandlers.onBlur) == null ? void 0 : _otherHandlers$onBlur.call(otherHandlers, event);
  };
  useEnhancedEffect$1(() => {
    if (disabled && sliderRef.current.contains(document.activeElement)) {
      var _document$activeEleme;
      // This is necessary because Firefox and Safari will keep focus
      // on a disabled element:
      // https://codesandbox.io/s/mui-pr-22247-forked-h151h?file=/src/App.js
      // @ts-ignore
      (_document$activeEleme = document.activeElement) == null ? void 0 : _document$activeEleme.blur();
    }
  }, [disabled]);
  if (disabled && active !== -1) {
    setActive(-1);
  }
  if (disabled && focusedThumbIndex !== -1) {
    setFocusedThumbIndex(-1);
  }
  const createHandleHiddenInputChange = otherHandlers => event => {
    var _otherHandlers$onChan;
    (_otherHandlers$onChan = otherHandlers.onChange) == null ? void 0 : _otherHandlers$onChan.call(otherHandlers, event);
    const index = Number(event.currentTarget.getAttribute('data-index'));
    const value = values[index];
    const marksIndex = marksValues.indexOf(value);

    // @ts-ignore
    let newValue = event.target.valueAsNumber;
    if (marks && step == null) {
      newValue = newValue < value ? marksValues[marksIndex - 1] : marksValues[marksIndex + 1];
    }
    newValue = clamp$1(newValue, min, max);
    if (marks && step == null) {
      const currentMarkIndex = marksValues.indexOf(values[index]);
      newValue = newValue < values[index] ? marksValues[currentMarkIndex - 1] : marksValues[currentMarkIndex + 1];
    }
    if (range) {
      // Bound the new value to the thumb's neighbours.
      if (disableSwap) {
        newValue = clamp$1(newValue, values[index - 1] || -Infinity, values[index + 1] || Infinity);
      }
      const previousValue = newValue;
      newValue = setValueIndex({
        values,
        newValue,
        index
      });
      let activeIndex = index;

      // Potentially swap the index if needed.
      if (!disableSwap) {
        activeIndex = newValue.indexOf(previousValue);
      }
      focusThumb({
        sliderRef,
        activeIndex
      });
    }
    setValueState(newValue);
    setFocusedThumbIndex(index);
    if (handleChange && !areValuesEqual(newValue, valueDerived)) {
      handleChange(event, newValue, index);
    }
    if (onChangeCommitted) {
      onChangeCommitted(event, newValue);
    }
  };
  const previousIndex = React$1.useRef();
  let axis = orientation;
  if (isRtl && orientation === 'horizontal') {
    axis += '-reverse';
  }
  const getFingerNewValue = ({
    finger,
    move = false
  }) => {
    const {
      current: slider
    } = sliderRef;
    const {
      width,
      height,
      bottom,
      left
    } = slider.getBoundingClientRect();
    let percent;
    if (axis.indexOf('vertical') === 0) {
      percent = (bottom - finger.y) / height;
    } else {
      percent = (finger.x - left) / width;
    }
    if (axis.indexOf('-reverse') !== -1) {
      percent = 1 - percent;
    }
    let newValue;
    newValue = percentToValue(percent, min, max);
    if (step) {
      newValue = roundValueToStep(newValue, step, min);
    } else {
      const closestIndex = findClosest(marksValues, newValue);
      newValue = marksValues[closestIndex];
    }
    newValue = clamp$1(newValue, min, max);
    let activeIndex = 0;
    if (range) {
      if (!move) {
        activeIndex = findClosest(values, newValue);
      } else {
        activeIndex = previousIndex.current;
      }

      // Bound the new value to the thumb's neighbours.
      if (disableSwap) {
        newValue = clamp$1(newValue, values[activeIndex - 1] || -Infinity, values[activeIndex + 1] || Infinity);
      }
      const previousValue = newValue;
      newValue = setValueIndex({
        values,
        newValue,
        index: activeIndex
      });

      // Potentially swap the index if needed.
      if (!(disableSwap && move)) {
        activeIndex = newValue.indexOf(previousValue);
        previousIndex.current = activeIndex;
      }
    }
    return {
      newValue,
      activeIndex
    };
  };
  const handleTouchMove = useEventCallback(nativeEvent => {
    const finger = trackFinger(nativeEvent, touchId);
    if (!finger) {
      return;
    }
    moveCount.current += 1;

    // Cancel move in case some other element consumed a mouseup event and it was not fired.
    // @ts-ignore buttons doesn't not exists on touch event
    if (nativeEvent.type === 'mousemove' && nativeEvent.buttons === 0) {
      // eslint-disable-next-line @typescript-eslint/no-use-before-define
      handleTouchEnd(nativeEvent);
      return;
    }
    const {
      newValue,
      activeIndex
    } = getFingerNewValue({
      finger,
      move: true
    });
    focusThumb({
      sliderRef,
      activeIndex,
      setActive
    });
    setValueState(newValue);
    if (!dragging && moveCount.current > INTENTIONAL_DRAG_COUNT_THRESHOLD) {
      setDragging(true);
    }
    if (handleChange && !areValuesEqual(newValue, valueDerived)) {
      handleChange(nativeEvent, newValue, activeIndex);
    }
  });
  const handleTouchEnd = useEventCallback(nativeEvent => {
    const finger = trackFinger(nativeEvent, touchId);
    setDragging(false);
    if (!finger) {
      return;
    }
    const {
      newValue
    } = getFingerNewValue({
      finger,
      move: true
    });
    setActive(-1);
    if (nativeEvent.type === 'touchend') {
      setOpen(-1);
    }
    if (onChangeCommitted) {
      onChangeCommitted(nativeEvent, newValue);
    }
    touchId.current = undefined;

    // eslint-disable-next-line @typescript-eslint/no-use-before-define
    stopListening();
  });
  const handleTouchStart = useEventCallback(nativeEvent => {
    if (disabled) {
      return;
    }
    // If touch-action: none; is not supported we need to prevent the scroll manually.
    if (!doesSupportTouchActionNone()) {
      nativeEvent.preventDefault();
    }
    const touch = nativeEvent.changedTouches[0];
    if (touch != null) {
      // A number that uniquely identifies the current finger in the touch session.
      touchId.current = touch.identifier;
    }
    const finger = trackFinger(nativeEvent, touchId);
    if (finger !== false) {
      const {
        newValue,
        activeIndex
      } = getFingerNewValue({
        finger
      });
      focusThumb({
        sliderRef,
        activeIndex,
        setActive
      });
      setValueState(newValue);
      if (handleChange && !areValuesEqual(newValue, valueDerived)) {
        handleChange(nativeEvent, newValue, activeIndex);
      }
    }
    moveCount.current = 0;
    const doc = ownerDocument(sliderRef.current);
    doc.addEventListener('touchmove', handleTouchMove);
    doc.addEventListener('touchend', handleTouchEnd);
  });
  const stopListening = React$1.useCallback(() => {
    const doc = ownerDocument(sliderRef.current);
    doc.removeEventListener('mousemove', handleTouchMove);
    doc.removeEventListener('mouseup', handleTouchEnd);
    doc.removeEventListener('touchmove', handleTouchMove);
    doc.removeEventListener('touchend', handleTouchEnd);
  }, [handleTouchEnd, handleTouchMove]);
  React$1.useEffect(() => {
    const {
      current: slider
    } = sliderRef;
    slider.addEventListener('touchstart', handleTouchStart, {
      passive: doesSupportTouchActionNone()
    });
    return () => {
      // @ts-ignore
      slider.removeEventListener('touchstart', handleTouchStart, {
        passive: doesSupportTouchActionNone()
      });
      stopListening();
    };
  }, [stopListening, handleTouchStart]);
  React$1.useEffect(() => {
    if (disabled) {
      stopListening();
    }
  }, [disabled, stopListening]);
  const createHandleMouseDown = otherHandlers => event => {
    var _otherHandlers$onMous;
    (_otherHandlers$onMous = otherHandlers.onMouseDown) == null ? void 0 : _otherHandlers$onMous.call(otherHandlers, event);
    if (disabled) {
      return;
    }
    if (event.defaultPrevented) {
      return;
    }

    // Only handle left clicks
    if (event.button !== 0) {
      return;
    }

    // Avoid text selection
    event.preventDefault();
    const finger = trackFinger(event, touchId);
    if (finger !== false) {
      const {
        newValue,
        activeIndex
      } = getFingerNewValue({
        finger
      });
      focusThumb({
        sliderRef,
        activeIndex,
        setActive
      });
      setValueState(newValue);
      if (handleChange && !areValuesEqual(newValue, valueDerived)) {
        handleChange(event, newValue, activeIndex);
      }
    }
    moveCount.current = 0;
    const doc = ownerDocument(sliderRef.current);
    doc.addEventListener('mousemove', handleTouchMove);
    doc.addEventListener('mouseup', handleTouchEnd);
  };
  const trackOffset = valueToPercent(range ? values[0] : min, min, max);
  const trackLeap = valueToPercent(values[values.length - 1], min, max) - trackOffset;
  const getRootProps = (otherHandlers = {}) => {
    const ownEventHandlers = {
      onMouseDown: createHandleMouseDown(otherHandlers || {})
    };
    const mergedEventHandlers = _extends({}, otherHandlers, ownEventHandlers);
    return _extends({
      ref: handleRef
    }, mergedEventHandlers);
  };
  const createHandleMouseOver = otherHandlers => event => {
    var _otherHandlers$onMous2;
    (_otherHandlers$onMous2 = otherHandlers.onMouseOver) == null ? void 0 : _otherHandlers$onMous2.call(otherHandlers, event);
    const index = Number(event.currentTarget.getAttribute('data-index'));
    setOpen(index);
  };
  const createHandleMouseLeave = otherHandlers => event => {
    var _otherHandlers$onMous3;
    (_otherHandlers$onMous3 = otherHandlers.onMouseLeave) == null ? void 0 : _otherHandlers$onMous3.call(otherHandlers, event);
    setOpen(-1);
  };
  const getThumbProps = (otherHandlers = {}) => {
    const ownEventHandlers = {
      onMouseOver: createHandleMouseOver(otherHandlers || {}),
      onMouseLeave: createHandleMouseLeave(otherHandlers || {})
    };
    return _extends({}, otherHandlers, ownEventHandlers);
  };
  const getHiddenInputProps = (otherHandlers = {}) => {
    var _parameters$step;
    const ownEventHandlers = {
      onChange: createHandleHiddenInputChange(otherHandlers || {}),
      onFocus: createHandleHiddenInputFocus(otherHandlers || {}),
      onBlur: createHandleHiddenInputBlur(otherHandlers || {})
    };
    const mergedEventHandlers = _extends({}, otherHandlers, ownEventHandlers);
    return _extends({
      tabIndex,
      'aria-labelledby': ariaLabelledby,
      'aria-orientation': orientation,
      'aria-valuemax': scale(max),
      'aria-valuemin': scale(min),
      name,
      type: 'range',
      min: parameters.min,
      max: parameters.max,
      step: (_parameters$step = parameters.step) != null ? _parameters$step : undefined,
      disabled
    }, mergedEventHandlers, {
      style: _extends({}, visuallyHidden$1, {
        direction: isRtl ? 'rtl' : 'ltr',
        // So that VoiceOver's focus indicator matches the thumb's dimensions
        width: '100%',
        height: '100%'
      })
    });
  };
  return {
    active,
    axis: axis,
    axisProps,
    dragging,
    focusedThumbIndex,
    getHiddenInputProps,
    getRootProps,
    getThumbProps,
    marks: marks,
    open,
    range,
    rootRef: handleRef,
    trackLeap,
    trackOffset,
    values
  };
}

function memoize$1(fn) {
  var cache = Object.create(null);
  return function (arg) {
    if (cache[arg] === undefined) cache[arg] = fn(arg);
    return cache[arg];
  };
}

var reactPropsRegex = /^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/; // https://esbench.com/bench/5bfee68a4cd7e6009ef61d23

var isPropValid = /* #__PURE__ */memoize$1(function (prop) {
  return reactPropsRegex.test(prop) || prop.charCodeAt(0) === 111
  /* o */
  && prop.charCodeAt(1) === 110
  /* n */
  && prop.charCodeAt(2) < 91;
}
/* Z+1 */
);

/*

Based off glamor's StyleSheet, thanks Sunil 

high performance StyleSheet for css-in-js systems

- uses multiple style tags behind the scenes for millions of rules
- uses `insertRule` for appending in production for *much* faster performance

// usage

import { StyleSheet } from '@emotion/sheet'

let styleSheet = new StyleSheet({ key: '', container: document.head })

styleSheet.insert('#box { border: 1px solid red; }')
- appends a css rule into the stylesheet

styleSheet.flush()
- empties the stylesheet of all its contents

*/
// $FlowFixMe
function sheetForTag(tag) {
  if (tag.sheet) {
    // $FlowFixMe
    return tag.sheet;
  } // this weirdness brought to you by firefox

  /* istanbul ignore next */


  for (var i = 0; i < document.styleSheets.length; i++) {
    if (document.styleSheets[i].ownerNode === tag) {
      // $FlowFixMe
      return document.styleSheets[i];
    }
  }
}

function createStyleElement(options) {
  var tag = document.createElement('style');
  tag.setAttribute('data-emotion', options.key);

  if (options.nonce !== undefined) {
    tag.setAttribute('nonce', options.nonce);
  }

  tag.appendChild(document.createTextNode(''));
  tag.setAttribute('data-s', '');
  return tag;
}

var StyleSheet = /*#__PURE__*/function () {
  // Using Node instead of HTMLElement since container may be a ShadowRoot
  function StyleSheet(options) {
    var _this = this;

    this._insertTag = function (tag) {
      var before;

      if (_this.tags.length === 0) {
        if (_this.insertionPoint) {
          before = _this.insertionPoint.nextSibling;
        } else if (_this.prepend) {
          before = _this.container.firstChild;
        } else {
          before = _this.before;
        }
      } else {
        before = _this.tags[_this.tags.length - 1].nextSibling;
      }

      _this.container.insertBefore(tag, before);

      _this.tags.push(tag);
    };

    this.isSpeedy = options.speedy === undefined ? process.env.NODE_ENV === 'production' : options.speedy;
    this.tags = [];
    this.ctr = 0;
    this.nonce = options.nonce; // key is the value of the data-emotion attribute, it's used to identify different sheets

    this.key = options.key;
    this.container = options.container;
    this.prepend = options.prepend;
    this.insertionPoint = options.insertionPoint;
    this.before = null;
  }

  var _proto = StyleSheet.prototype;

  _proto.hydrate = function hydrate(nodes) {
    nodes.forEach(this._insertTag);
  };

  _proto.insert = function insert(rule) {
    // the max length is how many rules we have per style tag, it's 65000 in speedy mode
    // it's 1 in dev because we insert source maps that map a single rule to a location
    // and you can only have one source map per style tag
    if (this.ctr % (this.isSpeedy ? 65000 : 1) === 0) {
      this._insertTag(createStyleElement(this));
    }

    var tag = this.tags[this.tags.length - 1];

    if (process.env.NODE_ENV !== 'production') {
      var isImportRule = rule.charCodeAt(0) === 64 && rule.charCodeAt(1) === 105;

      if (isImportRule && this._alreadyInsertedOrderInsensitiveRule) {
        // this would only cause problem in speedy mode
        // but we don't want enabling speedy to affect the observable behavior
        // so we report this error at all times
        console.error("You're attempting to insert the following rule:\n" + rule + '\n\n`@import` rules must be before all other types of rules in a stylesheet but other rules have already been inserted. Please ensure that `@import` rules are before all other rules.');
      }
      this._alreadyInsertedOrderInsensitiveRule = this._alreadyInsertedOrderInsensitiveRule || !isImportRule;
    }

    if (this.isSpeedy) {
      var sheet = sheetForTag(tag);

      try {
        // this is the ultrafast version, works across browsers
        // the big drawback is that the css won't be editable in devtools
        sheet.insertRule(rule, sheet.cssRules.length);
      } catch (e) {
        if (process.env.NODE_ENV !== 'production' && !/:(-moz-placeholder|-moz-focus-inner|-moz-focusring|-ms-input-placeholder|-moz-read-write|-moz-read-only|-ms-clear|-ms-expand|-ms-reveal){/.test(rule)) {
          console.error("There was a problem inserting the following rule: \"" + rule + "\"", e);
        }
      }
    } else {
      tag.appendChild(document.createTextNode(rule));
    }

    this.ctr++;
  };

  _proto.flush = function flush() {
    // $FlowFixMe
    this.tags.forEach(function (tag) {
      return tag.parentNode && tag.parentNode.removeChild(tag);
    });
    this.tags = [];
    this.ctr = 0;

    if (process.env.NODE_ENV !== 'production') {
      this._alreadyInsertedOrderInsensitiveRule = false;
    }
  };

  return StyleSheet;
}();

var MS = '-ms-';
var MOZ = '-moz-';
var WEBKIT = '-webkit-';

var COMMENT = 'comm';
var RULESET = 'rule';
var DECLARATION = 'decl';
var IMPORT = '@import';
var KEYFRAMES = '@keyframes';
var LAYER = '@layer';

/**
 * @param {number}
 * @return {number}
 */
var abs = Math.abs;

/**
 * @param {number}
 * @return {string}
 */
var from = String.fromCharCode;

/**
 * @param {object}
 * @return {object}
 */
var assign = Object.assign;

/**
 * @param {string} value
 * @param {number} length
 * @return {number}
 */
function hash (value, length) {
	return charat(value, 0) ^ 45 ? (((((((length << 2) ^ charat(value, 0)) << 2) ^ charat(value, 1)) << 2) ^ charat(value, 2)) << 2) ^ charat(value, 3) : 0
}

/**
 * @param {string} value
 * @return {string}
 */
function trim (value) {
	return value.trim()
}

/**
 * @param {string} value
 * @param {RegExp} pattern
 * @return {string?}
 */
function match (value, pattern) {
	return (value = pattern.exec(value)) ? value[0] : value
}

/**
 * @param {string} value
 * @param {(string|RegExp)} pattern
 * @param {string} replacement
 * @return {string}
 */
function replace (value, pattern, replacement) {
	return value.replace(pattern, replacement)
}

/**
 * @param {string} value
 * @param {string} search
 * @return {number}
 */
function indexof (value, search) {
	return value.indexOf(search)
}

/**
 * @param {string} value
 * @param {number} index
 * @return {number}
 */
function charat (value, index) {
	return value.charCodeAt(index) | 0
}

/**
 * @param {string} value
 * @param {number} begin
 * @param {number} end
 * @return {string}
 */
function substr (value, begin, end) {
	return value.slice(begin, end)
}

/**
 * @param {string} value
 * @return {number}
 */
function strlen (value) {
	return value.length
}

/**
 * @param {any[]} value
 * @return {number}
 */
function sizeof (value) {
	return value.length
}

/**
 * @param {any} value
 * @param {any[]} array
 * @return {any}
 */
function append (value, array) {
	return array.push(value), value
}

/**
 * @param {string[]} array
 * @param {function} callback
 * @return {string}
 */
function combine (array, callback) {
	return array.map(callback).join('')
}

var line = 1;
var column = 1;
var length = 0;
var position = 0;
var character = 0;
var characters = '';

/**
 * @param {string} value
 * @param {object | null} root
 * @param {object | null} parent
 * @param {string} type
 * @param {string[] | string} props
 * @param {object[] | string} children
 * @param {number} length
 */
function node (value, root, parent, type, props, children, length) {
	return {value: value, root: root, parent: parent, type: type, props: props, children: children, line: line, column: column, length: length, return: ''}
}

/**
 * @param {object} root
 * @param {object} props
 * @return {object}
 */
function copy (root, props) {
	return assign(node('', null, null, '', null, null, 0), root, {length: -root.length}, props)
}

/**
 * @return {number}
 */
function char () {
	return character
}

/**
 * @return {number}
 */
function prev () {
	character = position > 0 ? charat(characters, --position) : 0;

	if (column--, character === 10)
		column = 1, line--;

	return character
}

/**
 * @return {number}
 */
function next () {
	character = position < length ? charat(characters, position++) : 0;

	if (column++, character === 10)
		column = 1, line++;

	return character
}

/**
 * @return {number}
 */
function peek () {
	return charat(characters, position)
}

/**
 * @return {number}
 */
function caret () {
	return position
}

/**
 * @param {number} begin
 * @param {number} end
 * @return {string}
 */
function slice (begin, end) {
	return substr(characters, begin, end)
}

/**
 * @param {number} type
 * @return {number}
 */
function token (type) {
	switch (type) {
		// \0 \t \n \r \s whitespace token
		case 0: case 9: case 10: case 13: case 32:
			return 5
		// ! + , / > @ ~ isolate token
		case 33: case 43: case 44: case 47: case 62: case 64: case 126:
		// ; { } breakpoint token
		case 59: case 123: case 125:
			return 4
		// : accompanied token
		case 58:
			return 3
		// " ' ( [ opening delimit token
		case 34: case 39: case 40: case 91:
			return 2
		// ) ] closing delimit token
		case 41: case 93:
			return 1
	}

	return 0
}

/**
 * @param {string} value
 * @return {any[]}
 */
function alloc (value) {
	return line = column = 1, length = strlen(characters = value), position = 0, []
}

/**
 * @param {any} value
 * @return {any}
 */
function dealloc (value) {
	return characters = '', value
}

/**
 * @param {number} type
 * @return {string}
 */
function delimit (type) {
	return trim(slice(position - 1, delimiter(type === 91 ? type + 2 : type === 40 ? type + 1 : type)))
}

/**
 * @param {number} type
 * @return {string}
 */
function whitespace (type) {
	while (character = peek())
		if (character < 33)
			next();
		else
			break

	return token(type) > 2 || token(character) > 3 ? '' : ' '
}

/**
 * @param {number} index
 * @param {number} count
 * @return {string}
 */
function escaping (index, count) {
	while (--count && next())
		// not 0-9 A-F a-f
		if (character < 48 || character > 102 || (character > 57 && character < 65) || (character > 70 && character < 97))
			break

	return slice(index, caret() + (count < 6 && peek() == 32 && next() == 32))
}

/**
 * @param {number} type
 * @return {number}
 */
function delimiter (type) {
	while (next())
		switch (character) {
			// ] ) " '
			case type:
				return position
			// " '
			case 34: case 39:
				if (type !== 34 && type !== 39)
					delimiter(character);
				break
			// (
			case 40:
				if (type === 41)
					delimiter(type);
				break
			// \
			case 92:
				next();
				break
		}

	return position
}

/**
 * @param {number} type
 * @param {number} index
 * @return {number}
 */
function commenter (type, index) {
	while (next())
		// //
		if (type + character === 47 + 10)
			break
		// /*
		else if (type + character === 42 + 42 && peek() === 47)
			break

	return '/*' + slice(index, position - 1) + '*' + from(type === 47 ? type : next())
}

/**
 * @param {number} index
 * @return {string}
 */
function identifier (index) {
	while (!token(peek()))
		next();

	return slice(index, position)
}

/**
 * @param {string} value
 * @return {object[]}
 */
function compile (value) {
	return dealloc(parse('', null, null, null, [''], value = alloc(value), 0, [0], value))
}

/**
 * @param {string} value
 * @param {object} root
 * @param {object?} parent
 * @param {string[]} rule
 * @param {string[]} rules
 * @param {string[]} rulesets
 * @param {number[]} pseudo
 * @param {number[]} points
 * @param {string[]} declarations
 * @return {object}
 */
function parse (value, root, parent, rule, rules, rulesets, pseudo, points, declarations) {
	var index = 0;
	var offset = 0;
	var length = pseudo;
	var atrule = 0;
	var property = 0;
	var previous = 0;
	var variable = 1;
	var scanning = 1;
	var ampersand = 1;
	var character = 0;
	var type = '';
	var props = rules;
	var children = rulesets;
	var reference = rule;
	var characters = type;

	while (scanning)
		switch (previous = character, character = next()) {
			// (
			case 40:
				if (previous != 108 && charat(characters, length - 1) == 58) {
					if (indexof(characters += replace(delimit(character), '&', '&\f'), '&\f') != -1)
						ampersand = -1;
					break
				}
			// " ' [
			case 34: case 39: case 91:
				characters += delimit(character);
				break
			// \t \n \r \s
			case 9: case 10: case 13: case 32:
				characters += whitespace(previous);
				break
			// \
			case 92:
				characters += escaping(caret() - 1, 7);
				continue
			// /
			case 47:
				switch (peek()) {
					case 42: case 47:
						append(comment(commenter(next(), caret()), root, parent), declarations);
						break
					default:
						characters += '/';
				}
				break
			// {
			case 123 * variable:
				points[index++] = strlen(characters) * ampersand;
			// } ; \0
			case 125 * variable: case 59: case 0:
				switch (character) {
					// \0 }
					case 0: case 125: scanning = 0;
					// ;
					case 59 + offset: if (ampersand == -1) characters = replace(characters, /\f/g, '');
						if (property > 0 && (strlen(characters) - length))
							append(property > 32 ? declaration(characters + ';', rule, parent, length - 1) : declaration(replace(characters, ' ', '') + ';', rule, parent, length - 2), declarations);
						break
					// @ ;
					case 59: characters += ';';
					// { rule/at-rule
					default:
						append(reference = ruleset(characters, root, parent, index, offset, rules, points, type, props = [], children = [], length), rulesets);

						if (character === 123)
							if (offset === 0)
								parse(characters, root, reference, reference, props, rulesets, length, points, children);
							else
								switch (atrule === 99 && charat(characters, 3) === 110 ? 100 : atrule) {
									// d l m s
									case 100: case 108: case 109: case 115:
										parse(value, reference, reference, rule && append(ruleset(value, reference, reference, 0, 0, rules, points, type, rules, props = [], length), children), rules, children, length, points, rule ? props : children);
										break
									default:
										parse(characters, reference, reference, reference, [''], children, 0, points, children);
								}
				}

				index = offset = property = 0, variable = ampersand = 1, type = characters = '', length = pseudo;
				break
			// :
			case 58:
				length = 1 + strlen(characters), property = previous;
			default:
				if (variable < 1)
					if (character == 123)
						--variable;
					else if (character == 125 && variable++ == 0 && prev() == 125)
						continue

				switch (characters += from(character), character * variable) {
					// &
					case 38:
						ampersand = offset > 0 ? 1 : (characters += '\f', -1);
						break
					// ,
					case 44:
						points[index++] = (strlen(characters) - 1) * ampersand, ampersand = 1;
						break
					// @
					case 64:
						// -
						if (peek() === 45)
							characters += delimit(next());

						atrule = peek(), offset = length = strlen(type = characters += identifier(caret())), character++;
						break
					// -
					case 45:
						if (previous === 45 && strlen(characters) == 2)
							variable = 0;
				}
		}

	return rulesets
}

/**
 * @param {string} value
 * @param {object} root
 * @param {object?} parent
 * @param {number} index
 * @param {number} offset
 * @param {string[]} rules
 * @param {number[]} points
 * @param {string} type
 * @param {string[]} props
 * @param {string[]} children
 * @param {number} length
 * @return {object}
 */
function ruleset (value, root, parent, index, offset, rules, points, type, props, children, length) {
	var post = offset - 1;
	var rule = offset === 0 ? rules : [''];
	var size = sizeof(rule);

	for (var i = 0, j = 0, k = 0; i < index; ++i)
		for (var x = 0, y = substr(value, post + 1, post = abs(j = points[i])), z = value; x < size; ++x)
			if (z = trim(j > 0 ? rule[x] + ' ' + y : replace(y, /&\f/g, rule[x])))
				props[k++] = z;

	return node(value, root, parent, offset === 0 ? RULESET : type, props, children, length)
}

/**
 * @param {number} value
 * @param {object} root
 * @param {object?} parent
 * @return {object}
 */
function comment (value, root, parent) {
	return node(value, root, parent, COMMENT, from(char()), substr(value, 2, -2), 0)
}

/**
 * @param {string} value
 * @param {object} root
 * @param {object?} parent
 * @param {number} length
 * @return {object}
 */
function declaration (value, root, parent, length) {
	return node(value, root, parent, DECLARATION, substr(value, 0, length), substr(value, length + 1, -1), length)
}

/**
 * @param {object[]} children
 * @param {function} callback
 * @return {string}
 */
function serialize (children, callback) {
	var output = '';
	var length = sizeof(children);

	for (var i = 0; i < length; i++)
		output += callback(children[i], i, children, callback) || '';

	return output
}

/**
 * @param {object} element
 * @param {number} index
 * @param {object[]} children
 * @param {function} callback
 * @return {string}
 */
function stringify (element, index, children, callback) {
	switch (element.type) {
		case LAYER: if (element.children.length) break
		case IMPORT: case DECLARATION: return element.return = element.return || element.value
		case COMMENT: return ''
		case KEYFRAMES: return element.return = element.value + '{' + serialize(element.children, callback) + '}'
		case RULESET: element.value = element.props.join(',');
	}

	return strlen(children = serialize(element.children, callback)) ? element.return = element.value + '{' + children + '}' : ''
}

/**
 * @param {function[]} collection
 * @return {function}
 */
function middleware (collection) {
	var length = sizeof(collection);

	return function (element, index, children, callback) {
		var output = '';

		for (var i = 0; i < length; i++)
			output += collection[i](element, index, children, callback) || '';

		return output
	}
}

/**
 * @param {function} callback
 * @return {function}
 */
function rulesheet (callback) {
	return function (element) {
		if (!element.root)
			if (element = element.return)
				callback(element);
	}
}

var weakMemoize = function weakMemoize(func) {
  // $FlowFixMe flow doesn't include all non-primitive types as allowed for weakmaps
  var cache = new WeakMap();
  return function (arg) {
    if (cache.has(arg)) {
      // $FlowFixMe
      return cache.get(arg);
    }

    var ret = func(arg);
    cache.set(arg, ret);
    return ret;
  };
};

var identifierWithPointTracking = function identifierWithPointTracking(begin, points, index) {
  var previous = 0;
  var character = 0;

  while (true) {
    previous = character;
    character = peek(); // &\f

    if (previous === 38 && character === 12) {
      points[index] = 1;
    }

    if (token(character)) {
      break;
    }

    next();
  }

  return slice(begin, position);
};

var toRules = function toRules(parsed, points) {
  // pretend we've started with a comma
  var index = -1;
  var character = 44;

  do {
    switch (token(character)) {
      case 0:
        // &\f
        if (character === 38 && peek() === 12) {
          // this is not 100% correct, we don't account for literal sequences here - like for example quoted strings
          // stylis inserts \f after & to know when & where it should replace this sequence with the context selector
          // and when it should just concatenate the outer and inner selectors
          // it's very unlikely for this sequence to actually appear in a different context, so we just leverage this fact here
          points[index] = 1;
        }

        parsed[index] += identifierWithPointTracking(position - 1, points, index);
        break;

      case 2:
        parsed[index] += delimit(character);
        break;

      case 4:
        // comma
        if (character === 44) {
          // colon
          parsed[++index] = peek() === 58 ? '&\f' : '';
          points[index] = parsed[index].length;
          break;
        }

      // fallthrough

      default:
        parsed[index] += from(character);
    }
  } while (character = next());

  return parsed;
};

var getRules = function getRules(value, points) {
  return dealloc(toRules(alloc(value), points));
}; // WeakSet would be more appropriate, but only WeakMap is supported in IE11


var fixedElements = /* #__PURE__ */new WeakMap();
var compat = function compat(element) {
  if (element.type !== 'rule' || !element.parent || // positive .length indicates that this rule contains pseudo
  // negative .length indicates that this rule has been already prefixed
  element.length < 1) {
    return;
  }

  var value = element.value,
      parent = element.parent;
  var isImplicitRule = element.column === parent.column && element.line === parent.line;

  while (parent.type !== 'rule') {
    parent = parent.parent;
    if (!parent) return;
  } // short-circuit for the simplest case


  if (element.props.length === 1 && value.charCodeAt(0) !== 58
  /* colon */
  && !fixedElements.get(parent)) {
    return;
  } // if this is an implicitly inserted rule (the one eagerly inserted at the each new nested level)
  // then the props has already been manipulated beforehand as they that array is shared between it and its "rule parent"


  if (isImplicitRule) {
    return;
  }

  fixedElements.set(element, true);
  var points = [];
  var rules = getRules(value, points);
  var parentRules = parent.props;

  for (var i = 0, k = 0; i < rules.length; i++) {
    for (var j = 0; j < parentRules.length; j++, k++) {
      element.props[k] = points[i] ? rules[i].replace(/&\f/g, parentRules[j]) : parentRules[j] + " " + rules[i];
    }
  }
};
var removeLabel = function removeLabel(element) {
  if (element.type === 'decl') {
    var value = element.value;

    if ( // charcode for l
    value.charCodeAt(0) === 108 && // charcode for b
    value.charCodeAt(2) === 98) {
      // this ignores label
      element["return"] = '';
      element.value = '';
    }
  }
};
var ignoreFlag = 'emotion-disable-server-rendering-unsafe-selector-warning-please-do-not-use-this-the-warning-exists-for-a-reason';

var isIgnoringComment = function isIgnoringComment(element) {
  return element.type === 'comm' && element.children.indexOf(ignoreFlag) > -1;
};

var createUnsafeSelectorsAlarm = function createUnsafeSelectorsAlarm(cache) {
  return function (element, index, children) {
    if (element.type !== 'rule' || cache.compat) return;
    var unsafePseudoClasses = element.value.match(/(:first|:nth|:nth-last)-child/g);

    if (unsafePseudoClasses) {
      var isNested = !!element.parent; // in nested rules comments become children of the "auto-inserted" rule and that's always the `element.parent`
      //
      // considering this input:
      // .a {
      //   .b /* comm */ {}
      //   color: hotpink;
      // }
      // we get output corresponding to this:
      // .a {
      //   & {
      //     /* comm */
      //     color: hotpink;
      //   }
      //   .b {}
      // }

      var commentContainer = isNested ? element.parent.children : // global rule at the root level
      children;

      for (var i = commentContainer.length - 1; i >= 0; i--) {
        var node = commentContainer[i];

        if (node.line < element.line) {
          break;
        } // it is quite weird but comments are *usually* put at `column: element.column - 1`
        // so we seek *from the end* for the node that is earlier than the rule's `element` and check that
        // this will also match inputs like this:
        // .a {
        //   /* comm */
        //   .b {}
        // }
        //
        // but that is fine
        //
        // it would be the easiest to change the placement of the comment to be the first child of the rule:
        // .a {
        //   .b { /* comm */ }
        // }
        // with such inputs we wouldn't have to search for the comment at all
        // TODO: consider changing this comment placement in the next major version


        if (node.column < element.column) {
          if (isIgnoringComment(node)) {
            return;
          }

          break;
        }
      }

      unsafePseudoClasses.forEach(function (unsafePseudoClass) {
        console.error("The pseudo class \"" + unsafePseudoClass + "\" is potentially unsafe when doing server-side rendering. Try changing it to \"" + unsafePseudoClass.split('-child')[0] + "-of-type\".");
      });
    }
  };
};

var isImportRule = function isImportRule(element) {
  return element.type.charCodeAt(1) === 105 && element.type.charCodeAt(0) === 64;
};

var isPrependedWithRegularRules = function isPrependedWithRegularRules(index, children) {
  for (var i = index - 1; i >= 0; i--) {
    if (!isImportRule(children[i])) {
      return true;
    }
  }

  return false;
}; // use this to remove incorrect elements from further processing
// so they don't get handed to the `sheet` (or anything else)
// as that could potentially lead to additional logs which in turn could be overhelming to the user


var nullifyElement = function nullifyElement(element) {
  element.type = '';
  element.value = '';
  element["return"] = '';
  element.children = '';
  element.props = '';
};

var incorrectImportAlarm = function incorrectImportAlarm(element, index, children) {
  if (!isImportRule(element)) {
    return;
  }

  if (element.parent) {
    console.error("`@import` rules can't be nested inside other rules. Please move it to the top level and put it before regular rules. Keep in mind that they can only be used within global styles.");
    nullifyElement(element);
  } else if (isPrependedWithRegularRules(index, children)) {
    console.error("`@import` rules can't be after other rules. Please put your `@import` rules before your other rules.");
    nullifyElement(element);
  }
};

/* eslint-disable no-fallthrough */

function prefix(value, length) {
  switch (hash(value, length)) {
    // color-adjust
    case 5103:
      return WEBKIT + 'print-' + value + value;
    // animation, animation-(delay|direction|duration|fill-mode|iteration-count|name|play-state|timing-function)

    case 5737:
    case 4201:
    case 3177:
    case 3433:
    case 1641:
    case 4457:
    case 2921: // text-decoration, filter, clip-path, backface-visibility, column, box-decoration-break

    case 5572:
    case 6356:
    case 5844:
    case 3191:
    case 6645:
    case 3005: // mask, mask-image, mask-(mode|clip|size), mask-(repeat|origin), mask-position, mask-composite,

    case 6391:
    case 5879:
    case 5623:
    case 6135:
    case 4599:
    case 4855: // background-clip, columns, column-(count|fill|gap|rule|rule-color|rule-style|rule-width|span|width)

    case 4215:
    case 6389:
    case 5109:
    case 5365:
    case 5621:
    case 3829:
      return WEBKIT + value + value;
    // appearance, user-select, transform, hyphens, text-size-adjust

    case 5349:
    case 4246:
    case 4810:
    case 6968:
    case 2756:
      return WEBKIT + value + MOZ + value + MS + value + value;
    // flex, flex-direction

    case 6828:
    case 4268:
      return WEBKIT + value + MS + value + value;
    // order

    case 6165:
      return WEBKIT + value + MS + 'flex-' + value + value;
    // align-items

    case 5187:
      return WEBKIT + value + replace(value, /(\w+).+(:[^]+)/, WEBKIT + 'box-$1$2' + MS + 'flex-$1$2') + value;
    // align-self

    case 5443:
      return WEBKIT + value + MS + 'flex-item-' + replace(value, /flex-|-self/, '') + value;
    // align-content

    case 4675:
      return WEBKIT + value + MS + 'flex-line-pack' + replace(value, /align-content|flex-|-self/, '') + value;
    // flex-shrink

    case 5548:
      return WEBKIT + value + MS + replace(value, 'shrink', 'negative') + value;
    // flex-basis

    case 5292:
      return WEBKIT + value + MS + replace(value, 'basis', 'preferred-size') + value;
    // flex-grow

    case 6060:
      return WEBKIT + 'box-' + replace(value, '-grow', '') + WEBKIT + value + MS + replace(value, 'grow', 'positive') + value;
    // transition

    case 4554:
      return WEBKIT + replace(value, /([^-])(transform)/g, '$1' + WEBKIT + '$2') + value;
    // cursor

    case 6187:
      return replace(replace(replace(value, /(zoom-|grab)/, WEBKIT + '$1'), /(image-set)/, WEBKIT + '$1'), value, '') + value;
    // background, background-image

    case 5495:
    case 3959:
      return replace(value, /(image-set\([^]*)/, WEBKIT + '$1' + '$`$1');
    // justify-content

    case 4968:
      return replace(replace(value, /(.+:)(flex-)?(.*)/, WEBKIT + 'box-pack:$3' + MS + 'flex-pack:$3'), /s.+-b[^;]+/, 'justify') + WEBKIT + value + value;
    // (margin|padding)-inline-(start|end)

    case 4095:
    case 3583:
    case 4068:
    case 2532:
      return replace(value, /(.+)-inline(.+)/, WEBKIT + '$1$2') + value;
    // (min|max)?(width|height|inline-size|block-size)

    case 8116:
    case 7059:
    case 5753:
    case 5535:
    case 5445:
    case 5701:
    case 4933:
    case 4677:
    case 5533:
    case 5789:
    case 5021:
    case 4765:
      // stretch, max-content, min-content, fill-available
      if (strlen(value) - 1 - length > 6) switch (charat(value, length + 1)) {
        // (m)ax-content, (m)in-content
        case 109:
          // -
          if (charat(value, length + 4) !== 45) break;
        // (f)ill-available, (f)it-content

        case 102:
          return replace(value, /(.+:)(.+)-([^]+)/, '$1' + WEBKIT + '$2-$3' + '$1' + MOZ + (charat(value, length + 3) == 108 ? '$3' : '$2-$3')) + value;
        // (s)tretch

        case 115:
          return ~indexof(value, 'stretch') ? prefix(replace(value, 'stretch', 'fill-available'), length) + value : value;
      }
      break;
    // position: sticky

    case 4949:
      // (s)ticky?
      if (charat(value, length + 1) !== 115) break;
    // display: (flex|inline-flex)

    case 6444:
      switch (charat(value, strlen(value) - 3 - (~indexof(value, '!important') && 10))) {
        // stic(k)y
        case 107:
          return replace(value, ':', ':' + WEBKIT) + value;
        // (inline-)?fl(e)x

        case 101:
          return replace(value, /(.+:)([^;!]+)(;|!.+)?/, '$1' + WEBKIT + (charat(value, 14) === 45 ? 'inline-' : '') + 'box$3' + '$1' + WEBKIT + '$2$3' + '$1' + MS + '$2box$3') + value;
      }

      break;
    // writing-mode

    case 5936:
      switch (charat(value, length + 11)) {
        // vertical-l(r)
        case 114:
          return WEBKIT + value + MS + replace(value, /[svh]\w+-[tblr]{2}/, 'tb') + value;
        // vertical-r(l)

        case 108:
          return WEBKIT + value + MS + replace(value, /[svh]\w+-[tblr]{2}/, 'tb-rl') + value;
        // horizontal(-)tb

        case 45:
          return WEBKIT + value + MS + replace(value, /[svh]\w+-[tblr]{2}/, 'lr') + value;
      }

      return WEBKIT + value + MS + value + value;
  }

  return value;
}

var prefixer = function prefixer(element, index, children, callback) {
  if (element.length > -1) if (!element["return"]) switch (element.type) {
    case DECLARATION:
      element["return"] = prefix(element.value, element.length);
      break;

    case KEYFRAMES:
      return serialize([copy(element, {
        value: replace(element.value, '@', '@' + WEBKIT)
      })], callback);

    case RULESET:
      if (element.length) return combine(element.props, function (value) {
        switch (match(value, /(::plac\w+|:read-\w+)/)) {
          // :read-(only|write)
          case ':read-only':
          case ':read-write':
            return serialize([copy(element, {
              props: [replace(value, /:(read-\w+)/, ':' + MOZ + '$1')]
            })], callback);
          // :placeholder

          case '::placeholder':
            return serialize([copy(element, {
              props: [replace(value, /:(plac\w+)/, ':' + WEBKIT + 'input-$1')]
            }), copy(element, {
              props: [replace(value, /:(plac\w+)/, ':' + MOZ + '$1')]
            }), copy(element, {
              props: [replace(value, /:(plac\w+)/, MS + 'input-$1')]
            })], callback);
        }

        return '';
      });
  }
};

var isBrowser$4 = typeof document !== 'undefined';
var getServerStylisCache = isBrowser$4 ? undefined : weakMemoize(function () {
  return memoize$1(function () {
    var cache = {};
    return function (name) {
      return cache[name];
    };
  });
});
var defaultStylisPlugins = [prefixer];

var createCache = function createCache(options) {
  var key = options.key;

  if (process.env.NODE_ENV !== 'production' && !key) {
    throw new Error("You have to configure `key` for your cache. Please make sure it's unique (and not equal to 'css') as it's used for linking styles to your cache.\n" + "If multiple caches share the same key they might \"fight\" for each other's style elements.");
  }

  if (isBrowser$4 && key === 'css') {
    var ssrStyles = document.querySelectorAll("style[data-emotion]:not([data-s])"); // get SSRed styles out of the way of React's hydration
    // document.head is a safe place to move them to(though note document.head is not necessarily the last place they will be)
    // note this very very intentionally targets all style elements regardless of the key to ensure
    // that creating a cache works inside of render of a React component

    Array.prototype.forEach.call(ssrStyles, function (node) {
      // we want to only move elements which have a space in the data-emotion attribute value
      // because that indicates that it is an Emotion 11 server-side rendered style elements
      // while we will already ignore Emotion 11 client-side inserted styles because of the :not([data-s]) part in the selector
      // Emotion 10 client-side inserted styles did not have data-s (but importantly did not have a space in their data-emotion attributes)
      // so checking for the space ensures that loading Emotion 11 after Emotion 10 has inserted some styles
      // will not result in the Emotion 10 styles being destroyed
      var dataEmotionAttribute = node.getAttribute('data-emotion');

      if (dataEmotionAttribute.indexOf(' ') === -1) {
        return;
      }
      document.head.appendChild(node);
      node.setAttribute('data-s', '');
    });
  }

  var stylisPlugins = options.stylisPlugins || defaultStylisPlugins;

  if (process.env.NODE_ENV !== 'production') {
    // $FlowFixMe
    if (/[^a-z-]/.test(key)) {
      throw new Error("Emotion key must only contain lower case alphabetical characters and - but \"" + key + "\" was passed");
    }
  }

  var inserted = {};
  var container;
  var nodesToHydrate = [];

  if (isBrowser$4) {
    container = options.container || document.head;
    Array.prototype.forEach.call( // this means we will ignore elements which don't have a space in them which
    // means that the style elements we're looking at are only Emotion 11 server-rendered style elements
    document.querySelectorAll("style[data-emotion^=\"" + key + " \"]"), function (node) {
      var attrib = node.getAttribute("data-emotion").split(' '); // $FlowFixMe

      for (var i = 1; i < attrib.length; i++) {
        inserted[attrib[i]] = true;
      }

      nodesToHydrate.push(node);
    });
  }

  var _insert;

  var omnipresentPlugins = [compat, removeLabel];

  if (process.env.NODE_ENV !== 'production') {
    omnipresentPlugins.push(createUnsafeSelectorsAlarm({
      get compat() {
        return cache.compat;
      }

    }), incorrectImportAlarm);
  }

  if (isBrowser$4) {
    var currentSheet;
    var finalizingPlugins = [stringify, process.env.NODE_ENV !== 'production' ? function (element) {
      if (!element.root) {
        if (element["return"]) {
          currentSheet.insert(element["return"]);
        } else if (element.value && element.type !== COMMENT) {
          // insert empty rule in non-production environments
          // so @emotion/jest can grab `key` from the (JS)DOM for caches without any rules inserted yet
          currentSheet.insert(element.value + "{}");
        }
      }
    } : rulesheet(function (rule) {
      currentSheet.insert(rule);
    })];
    var serializer = middleware(omnipresentPlugins.concat(stylisPlugins, finalizingPlugins));

    var stylis = function stylis(styles) {
      return serialize(compile(styles), serializer);
    };

    _insert = function insert(selector, serialized, sheet, shouldCache) {
      currentSheet = sheet;

      if (process.env.NODE_ENV !== 'production' && serialized.map !== undefined) {
        currentSheet = {
          insert: function insert(rule) {
            sheet.insert(rule + serialized.map);
          }
        };
      }

      stylis(selector ? selector + "{" + serialized.styles + "}" : serialized.styles);

      if (shouldCache) {
        cache.inserted[serialized.name] = true;
      }
    };
  } else {
    var _finalizingPlugins = [stringify];

    var _serializer = middleware(omnipresentPlugins.concat(stylisPlugins, _finalizingPlugins));

    var _stylis = function _stylis(styles) {
      return serialize(compile(styles), _serializer);
    }; // $FlowFixMe


    var serverStylisCache = getServerStylisCache(stylisPlugins)(key);

    var getRules = function getRules(selector, serialized) {
      var name = serialized.name;

      if (serverStylisCache[name] === undefined) {
        serverStylisCache[name] = _stylis(selector ? selector + "{" + serialized.styles + "}" : serialized.styles);
      }

      return serverStylisCache[name];
    };

    _insert = function _insert(selector, serialized, sheet, shouldCache) {
      var name = serialized.name;
      var rules = getRules(selector, serialized);

      if (cache.compat === undefined) {
        // in regular mode, we don't set the styles on the inserted cache
        // since we don't need to and that would be wasting memory
        // we return them so that they are rendered in a style tag
        if (shouldCache) {
          cache.inserted[name] = true;
        }

        if ( // using === development instead of !== production
        // because if people do ssr in tests, the source maps showing up would be annoying
        process.env.NODE_ENV === 'development' && serialized.map !== undefined) {
          return rules + serialized.map;
        }

        return rules;
      } else {
        // in compat mode, we put the styles on the inserted cache so
        // that emotion-server can pull out the styles
        // except when we don't want to cache it which was in Global but now
        // is nowhere but we don't want to do a major right now
        // and just in case we're going to leave the case here
        // it's also not affecting client side bundle size
        // so it's really not a big deal
        if (shouldCache) {
          cache.inserted[name] = rules;
        } else {
          return rules;
        }
      }
    };
  }

  var cache = {
    key: key,
    sheet: new StyleSheet({
      key: key,
      container: container,
      nonce: options.nonce,
      speedy: options.speedy,
      prepend: options.prepend,
      insertionPoint: options.insertionPoint
    }),
    nonce: options.nonce,
    inserted: inserted,
    registered: {},
    insert: _insert
  };
  cache.sheet.hydrate(nodesToHydrate);
  return cache;
};

var isBrowser$3 = typeof document !== 'undefined';
function getRegisteredStyles(registered, registeredStyles, classNames) {
  var rawClassName = '';
  classNames.split(' ').forEach(function (className) {
    if (registered[className] !== undefined) {
      registeredStyles.push(registered[className] + ";");
    } else {
      rawClassName += className + " ";
    }
  });
  return rawClassName;
}
var registerStyles = function registerStyles(cache, serialized, isStringTag) {
  var className = cache.key + "-" + serialized.name;

  if ( // we only need to add the styles to the registered cache if the
  // class name could be used further down
  // the tree but if it's a string tag, we know it won't
  // so we don't have to add it to registered cache.
  // this improves memory usage since we can avoid storing the whole style string
  (isStringTag === false || // we need to always store it if we're in compat mode and
  // in node since emotion-server relies on whether a style is in
  // the registered cache to know whether a style is global or not
  // also, note that this check will be dead code eliminated in the browser
  isBrowser$3 === false && cache.compat !== undefined) && cache.registered[className] === undefined) {
    cache.registered[className] = serialized.styles;
  }
};
var insertStyles = function insertStyles(cache, serialized, isStringTag) {
  registerStyles(cache, serialized, isStringTag);
  var className = cache.key + "-" + serialized.name;

  if (cache.inserted[serialized.name] === undefined) {
    var stylesForSSR = '';
    var current = serialized;

    do {
      var maybeStyles = cache.insert(serialized === current ? "." + className : '', current, cache.sheet, true);

      if (!isBrowser$3 && maybeStyles !== undefined) {
        stylesForSSR += maybeStyles;
      }

      current = current.next;
    } while (current !== undefined);

    if (!isBrowser$3 && stylesForSSR.length !== 0) {
      return stylesForSSR;
    }
  }
};

/* eslint-disable */
// Inspired by https://github.com/garycourt/murmurhash-js
// Ported from https://github.com/aappleby/smhasher/blob/61a0530f28277f2e850bfc39600ce61d02b518de/src/MurmurHash2.cpp#L37-L86
function murmur2(str) {
  // 'm' and 'r' are mixing constants generated offline.
  // They're not really 'magic', they just happen to work well.
  // const m = 0x5bd1e995;
  // const r = 24;
  // Initialize the hash
  var h = 0; // Mix 4 bytes at a time into the hash

  var k,
      i = 0,
      len = str.length;

  for (; len >= 4; ++i, len -= 4) {
    k = str.charCodeAt(i) & 0xff | (str.charCodeAt(++i) & 0xff) << 8 | (str.charCodeAt(++i) & 0xff) << 16 | (str.charCodeAt(++i) & 0xff) << 24;
    k =
    /* Math.imul(k, m): */
    (k & 0xffff) * 0x5bd1e995 + ((k >>> 16) * 0xe995 << 16);
    k ^=
    /* k >>> r: */
    k >>> 24;
    h =
    /* Math.imul(k, m): */
    (k & 0xffff) * 0x5bd1e995 + ((k >>> 16) * 0xe995 << 16) ^
    /* Math.imul(h, m): */
    (h & 0xffff) * 0x5bd1e995 + ((h >>> 16) * 0xe995 << 16);
  } // Handle the last few bytes of the input array


  switch (len) {
    case 3:
      h ^= (str.charCodeAt(i + 2) & 0xff) << 16;

    case 2:
      h ^= (str.charCodeAt(i + 1) & 0xff) << 8;

    case 1:
      h ^= str.charCodeAt(i) & 0xff;
      h =
      /* Math.imul(h, m): */
      (h & 0xffff) * 0x5bd1e995 + ((h >>> 16) * 0xe995 << 16);
  } // Do a few final mixes of the hash to ensure the last few
  // bytes are well-incorporated.


  h ^= h >>> 13;
  h =
  /* Math.imul(h, m): */
  (h & 0xffff) * 0x5bd1e995 + ((h >>> 16) * 0xe995 << 16);
  return ((h ^ h >>> 15) >>> 0).toString(36);
}

var unitlessKeys = {
  animationIterationCount: 1,
  aspectRatio: 1,
  borderImageOutset: 1,
  borderImageSlice: 1,
  borderImageWidth: 1,
  boxFlex: 1,
  boxFlexGroup: 1,
  boxOrdinalGroup: 1,
  columnCount: 1,
  columns: 1,
  flex: 1,
  flexGrow: 1,
  flexPositive: 1,
  flexShrink: 1,
  flexNegative: 1,
  flexOrder: 1,
  gridRow: 1,
  gridRowEnd: 1,
  gridRowSpan: 1,
  gridRowStart: 1,
  gridColumn: 1,
  gridColumnEnd: 1,
  gridColumnSpan: 1,
  gridColumnStart: 1,
  msGridRow: 1,
  msGridRowSpan: 1,
  msGridColumn: 1,
  msGridColumnSpan: 1,
  fontWeight: 1,
  lineHeight: 1,
  opacity: 1,
  order: 1,
  orphans: 1,
  tabSize: 1,
  widows: 1,
  zIndex: 1,
  zoom: 1,
  WebkitLineClamp: 1,
  // SVG-related properties
  fillOpacity: 1,
  floodOpacity: 1,
  stopOpacity: 1,
  strokeDasharray: 1,
  strokeDashoffset: 1,
  strokeMiterlimit: 1,
  strokeOpacity: 1,
  strokeWidth: 1
};

var ILLEGAL_ESCAPE_SEQUENCE_ERROR$1 = "You have illegal escape sequence in your template literal, most likely inside content's property value.\nBecause you write your CSS inside a JavaScript string you actually have to do double escaping, so for example \"content: '\\00d7';\" should become \"content: '\\\\00d7';\".\nYou can read more about this here:\nhttps://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals#ES2018_revision_of_illegal_escape_sequences";
var UNDEFINED_AS_OBJECT_KEY_ERROR = "You have passed in falsy value as style object's key (can happen when in example you pass unexported component as computed key).";
var hyphenateRegex = /[A-Z]|^ms/g;
var animationRegex = /_EMO_([^_]+?)_([^]*?)_EMO_/g;

var isCustomProperty = function isCustomProperty(property) {
  return property.charCodeAt(1) === 45;
};

var isProcessableValue = function isProcessableValue(value) {
  return value != null && typeof value !== 'boolean';
};

var processStyleName = /* #__PURE__ */memoize$1(function (styleName) {
  return isCustomProperty(styleName) ? styleName : styleName.replace(hyphenateRegex, '-$&').toLowerCase();
});

var processStyleValue = function processStyleValue(key, value) {
  switch (key) {
    case 'animation':
    case 'animationName':
      {
        if (typeof value === 'string') {
          return value.replace(animationRegex, function (match, p1, p2) {
            cursor = {
              name: p1,
              styles: p2,
              next: cursor
            };
            return p1;
          });
        }
      }
  }

  if (unitlessKeys[key] !== 1 && !isCustomProperty(key) && typeof value === 'number' && value !== 0) {
    return value + 'px';
  }

  return value;
};

if (process.env.NODE_ENV !== 'production') {
  var contentValuePattern = /(var|attr|counters?|url|element|(((repeating-)?(linear|radial))|conic)-gradient)\(|(no-)?(open|close)-quote/;
  var contentValues = ['normal', 'none', 'initial', 'inherit', 'unset'];
  var oldProcessStyleValue = processStyleValue;
  var msPattern = /^-ms-/;
  var hyphenPattern = /-(.)/g;
  var hyphenatedCache = {};

  processStyleValue = function processStyleValue(key, value) {
    if (key === 'content') {
      if (typeof value !== 'string' || contentValues.indexOf(value) === -1 && !contentValuePattern.test(value) && (value.charAt(0) !== value.charAt(value.length - 1) || value.charAt(0) !== '"' && value.charAt(0) !== "'")) {
        throw new Error("You seem to be using a value for 'content' without quotes, try replacing it with `content: '\"" + value + "\"'`");
      }
    }

    var processed = oldProcessStyleValue(key, value);

    if (processed !== '' && !isCustomProperty(key) && key.indexOf('-') !== -1 && hyphenatedCache[key] === undefined) {
      hyphenatedCache[key] = true;
      console.error("Using kebab-case for css properties in objects is not supported. Did you mean " + key.replace(msPattern, 'ms-').replace(hyphenPattern, function (str, _char) {
        return _char.toUpperCase();
      }) + "?");
    }

    return processed;
  };
}

var noComponentSelectorMessage = 'Component selectors can only be used in conjunction with ' + '@emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware ' + 'compiler transform.';

function handleInterpolation(mergedProps, registered, interpolation) {
  if (interpolation == null) {
    return '';
  }

  if (interpolation.__emotion_styles !== undefined) {
    if (process.env.NODE_ENV !== 'production' && interpolation.toString() === 'NO_COMPONENT_SELECTOR') {
      throw new Error(noComponentSelectorMessage);
    }

    return interpolation;
  }

  switch (typeof interpolation) {
    case 'boolean':
      {
        return '';
      }

    case 'object':
      {
        if (interpolation.anim === 1) {
          cursor = {
            name: interpolation.name,
            styles: interpolation.styles,
            next: cursor
          };
          return interpolation.name;
        }

        if (interpolation.styles !== undefined) {
          var next = interpolation.next;

          if (next !== undefined) {
            // not the most efficient thing ever but this is a pretty rare case
            // and there will be very few iterations of this generally
            while (next !== undefined) {
              cursor = {
                name: next.name,
                styles: next.styles,
                next: cursor
              };
              next = next.next;
            }
          }

          var styles = interpolation.styles + ";";

          if (process.env.NODE_ENV !== 'production' && interpolation.map !== undefined) {
            styles += interpolation.map;
          }

          return styles;
        }

        return createStringFromObject(mergedProps, registered, interpolation);
      }

    case 'function':
      {
        if (mergedProps !== undefined) {
          var previousCursor = cursor;
          var result = interpolation(mergedProps);
          cursor = previousCursor;
          return handleInterpolation(mergedProps, registered, result);
        } else if (process.env.NODE_ENV !== 'production') {
          console.error('Functions that are interpolated in css calls will be stringified.\n' + 'If you want to have a css call based on props, create a function that returns a css call like this\n' + 'let dynamicStyle = (props) => css`color: ${props.color}`\n' + 'It can be called directly with props or interpolated in a styled call like this\n' + "let SomeComponent = styled('div')`${dynamicStyle}`");
        }

        break;
      }

    case 'string':
      if (process.env.NODE_ENV !== 'production') {
        var matched = [];
        var replaced = interpolation.replace(animationRegex, function (match, p1, p2) {
          var fakeVarName = "animation" + matched.length;
          matched.push("const " + fakeVarName + " = keyframes`" + p2.replace(/^@keyframes animation-\w+/, '') + "`");
          return "${" + fakeVarName + "}";
        });

        if (matched.length) {
          console.error('`keyframes` output got interpolated into plain string, please wrap it with `css`.\n\n' + 'Instead of doing this:\n\n' + [].concat(matched, ["`" + replaced + "`"]).join('\n') + '\n\nYou should wrap it with `css` like this:\n\n' + ("css`" + replaced + "`"));
        }
      }

      break;
  } // finalize string values (regular strings and functions interpolated into css calls)


  if (registered == null) {
    return interpolation;
  }

  var cached = registered[interpolation];
  return cached !== undefined ? cached : interpolation;
}

function createStringFromObject(mergedProps, registered, obj) {
  var string = '';

  if (Array.isArray(obj)) {
    for (var i = 0; i < obj.length; i++) {
      string += handleInterpolation(mergedProps, registered, obj[i]) + ";";
    }
  } else {
    for (var _key in obj) {
      var value = obj[_key];

      if (typeof value !== 'object') {
        if (registered != null && registered[value] !== undefined) {
          string += _key + "{" + registered[value] + "}";
        } else if (isProcessableValue(value)) {
          string += processStyleName(_key) + ":" + processStyleValue(_key, value) + ";";
        }
      } else {
        if (_key === 'NO_COMPONENT_SELECTOR' && process.env.NODE_ENV !== 'production') {
          throw new Error(noComponentSelectorMessage);
        }

        if (Array.isArray(value) && typeof value[0] === 'string' && (registered == null || registered[value[0]] === undefined)) {
          for (var _i = 0; _i < value.length; _i++) {
            if (isProcessableValue(value[_i])) {
              string += processStyleName(_key) + ":" + processStyleValue(_key, value[_i]) + ";";
            }
          }
        } else {
          var interpolated = handleInterpolation(mergedProps, registered, value);

          switch (_key) {
            case 'animation':
            case 'animationName':
              {
                string += processStyleName(_key) + ":" + interpolated + ";";
                break;
              }

            default:
              {
                if (process.env.NODE_ENV !== 'production' && _key === 'undefined') {
                  console.error(UNDEFINED_AS_OBJECT_KEY_ERROR);
                }

                string += _key + "{" + interpolated + "}";
              }
          }
        }
      }
    }
  }

  return string;
}

var labelPattern = /label:\s*([^\s;\n{]+)\s*(;|$)/g;
var sourceMapPattern;

if (process.env.NODE_ENV !== 'production') {
  sourceMapPattern = /\/\*#\ssourceMappingURL=data:application\/json;\S+\s+\*\//g;
} // this is the cursor for keyframes
// keyframes are stored on the SerializedStyles object as a linked list


var cursor;
var serializeStyles = function serializeStyles(args, registered, mergedProps) {
  if (args.length === 1 && typeof args[0] === 'object' && args[0] !== null && args[0].styles !== undefined) {
    return args[0];
  }

  var stringMode = true;
  var styles = '';
  cursor = undefined;
  var strings = args[0];

  if (strings == null || strings.raw === undefined) {
    stringMode = false;
    styles += handleInterpolation(mergedProps, registered, strings);
  } else {
    if (process.env.NODE_ENV !== 'production' && strings[0] === undefined) {
      console.error(ILLEGAL_ESCAPE_SEQUENCE_ERROR$1);
    }

    styles += strings[0];
  } // we start at 1 since we've already handled the first arg


  for (var i = 1; i < args.length; i++) {
    styles += handleInterpolation(mergedProps, registered, args[i]);

    if (stringMode) {
      if (process.env.NODE_ENV !== 'production' && strings[i] === undefined) {
        console.error(ILLEGAL_ESCAPE_SEQUENCE_ERROR$1);
      }

      styles += strings[i];
    }
  }

  var sourceMap;

  if (process.env.NODE_ENV !== 'production') {
    styles = styles.replace(sourceMapPattern, function (match) {
      sourceMap = match;
      return '';
    });
  } // using a global regex with .exec is stateful so lastIndex has to be reset each time


  labelPattern.lastIndex = 0;
  var identifierName = '';
  var match; // https://esbench.com/bench/5b809c2cf2949800a0f61fb5

  while ((match = labelPattern.exec(styles)) !== null) {
    identifierName += '-' + // $FlowFixMe we know it's not null
    match[1];
  }

  var name = murmur2(styles) + identifierName;

  if (process.env.NODE_ENV !== 'production') {
    // $FlowFixMe SerializedStyles type doesn't have toString property (and we don't want to add it)
    return {
      name: name,
      styles: styles,
      map: sourceMap,
      next: cursor,
      toString: function toString() {
        return "You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).";
      }
    };
  }

  return {
    name: name,
    styles: styles,
    next: cursor
  };
};

var isBrowser$2 = typeof document !== 'undefined';

var syncFallback = function syncFallback(create) {
  return create();
};

var useInsertionEffect = React$1['useInsertion' + 'Effect'] ? React$1['useInsertion' + 'Effect'] : false;
var useInsertionEffectAlwaysWithSyncFallback = !isBrowser$2 ? syncFallback : useInsertionEffect || syncFallback;

var isBrowser$1 = typeof document !== 'undefined';
var hasOwnProperty$1 = {}.hasOwnProperty;

var EmotionCacheContext = /* #__PURE__ */React$1.createContext( // we're doing this to avoid preconstruct's dead code elimination in this one case
// because this module is primarily intended for the browser and node
// but it's also required in react native and similar environments sometimes
// and we could have a special build just for that
// but this is much easier and the native packages
// might use a different theme context in the future anyway
typeof HTMLElement !== 'undefined' ? /* #__PURE__ */createCache({
  key: 'css'
}) : null);

if (process.env.NODE_ENV !== 'production') {
  EmotionCacheContext.displayName = 'EmotionCacheContext';
}

EmotionCacheContext.Provider;

var withEmotionCache = function withEmotionCache(func) {
  // $FlowFixMe
  return /*#__PURE__*/forwardRef(function (props, ref) {
    // the cache will never be null in the browser
    var cache = useContext(EmotionCacheContext);
    return func(props, cache, ref);
  });
};

if (!isBrowser$1) {
  withEmotionCache = function withEmotionCache(func) {
    return function (props) {
      var cache = useContext(EmotionCacheContext);

      if (cache === null) {
        // yes, we're potentially creating this on every render
        // it doesn't actually matter though since it's only on the server
        // so there will only every be a single render
        // that could change in the future because of suspense and etc. but for now,
        // this works and i don't want to optimise for a future thing that we aren't sure about
        cache = createCache({
          key: 'css'
        });
        return /*#__PURE__*/React$1.createElement(EmotionCacheContext.Provider, {
          value: cache
        }, func(props, cache));
      } else {
        return func(props, cache);
      }
    };
  };
}

var ThemeContext = /* #__PURE__ */React$1.createContext({});

if (process.env.NODE_ENV !== 'production') {
  ThemeContext.displayName = 'EmotionThemeContext';
}

var typePropName = '__EMOTION_TYPE_PLEASE_DO_NOT_USE__';
var labelPropName = '__EMOTION_LABEL_PLEASE_DO_NOT_USE__';

var Insertion$1 = function Insertion(_ref) {
  var cache = _ref.cache,
      serialized = _ref.serialized,
      isStringTag = _ref.isStringTag;
  registerStyles(cache, serialized, isStringTag);
  var rules = useInsertionEffectAlwaysWithSyncFallback(function () {
    return insertStyles(cache, serialized, isStringTag);
  });

  if (!isBrowser$1 && rules !== undefined) {
    var _ref2;

    var serializedNames = serialized.name;
    var next = serialized.next;

    while (next !== undefined) {
      serializedNames += ' ' + next.name;
      next = next.next;
    }

    return /*#__PURE__*/React$1.createElement("style", (_ref2 = {}, _ref2["data-emotion"] = cache.key + " " + serializedNames, _ref2.dangerouslySetInnerHTML = {
      __html: rules
    }, _ref2.nonce = cache.sheet.nonce, _ref2));
  }

  return null;
};

var Emotion = /* #__PURE__ */withEmotionCache(function (props, cache, ref) {
  var cssProp = props.css; // so that using `css` from `emotion` and passing the result to the css prop works
  // not passing the registered cache to serializeStyles because it would
  // make certain babel optimisations not possible

  if (typeof cssProp === 'string' && cache.registered[cssProp] !== undefined) {
    cssProp = cache.registered[cssProp];
  }

  var WrappedComponent = props[typePropName];
  var registeredStyles = [cssProp];
  var className = '';

  if (typeof props.className === 'string') {
    className = getRegisteredStyles(cache.registered, registeredStyles, props.className);
  } else if (props.className != null) {
    className = props.className + " ";
  }

  var serialized = serializeStyles(registeredStyles, undefined, React$1.useContext(ThemeContext));

  if (process.env.NODE_ENV !== 'production' && serialized.name.indexOf('-') === -1) {
    var labelFromStack = props[labelPropName];

    if (labelFromStack) {
      serialized = serializeStyles([serialized, 'label:' + labelFromStack + ';']);
    }
  }

  className += cache.key + "-" + serialized.name;
  var newProps = {};

  for (var key in props) {
    if (hasOwnProperty$1.call(props, key) && key !== 'css' && key !== typePropName && (process.env.NODE_ENV === 'production' || key !== labelPropName)) {
      newProps[key] = props[key];
    }
  }

  newProps.ref = ref;
  newProps.className = className;
  return /*#__PURE__*/React$1.createElement(React$1.Fragment, null, /*#__PURE__*/React$1.createElement(Insertion$1, {
    cache: cache,
    serialized: serialized,
    isStringTag: typeof WrappedComponent === 'string'
  }), /*#__PURE__*/React$1.createElement(WrappedComponent, newProps));
});

if (process.env.NODE_ENV !== 'production') {
  Emotion.displayName = 'EmotionCssPropInternal';
}

var testOmitPropsOnStringTag = isPropValid;

var testOmitPropsOnComponent = function testOmitPropsOnComponent(key) {
  return key !== 'theme';
};

var getDefaultShouldForwardProp = function getDefaultShouldForwardProp(tag) {
  return typeof tag === 'string' && // 96 is one less than the char code
  // for "a" so this is checking that
  // it's a lowercase character
  tag.charCodeAt(0) > 96 ? testOmitPropsOnStringTag : testOmitPropsOnComponent;
};
var composeShouldForwardProps = function composeShouldForwardProps(tag, options, isReal) {
  var shouldForwardProp;

  if (options) {
    var optionsShouldForwardProp = options.shouldForwardProp;
    shouldForwardProp = tag.__emotion_forwardProp && optionsShouldForwardProp ? function (propName) {
      return tag.__emotion_forwardProp(propName) && optionsShouldForwardProp(propName);
    } : optionsShouldForwardProp;
  }

  if (typeof shouldForwardProp !== 'function' && isReal) {
    shouldForwardProp = tag.__emotion_forwardProp;
  }

  return shouldForwardProp;
};

var ILLEGAL_ESCAPE_SEQUENCE_ERROR = "You have illegal escape sequence in your template literal, most likely inside content's property value.\nBecause you write your CSS inside a JavaScript string you actually have to do double escaping, so for example \"content: '\\00d7';\" should become \"content: '\\\\00d7';\".\nYou can read more about this here:\nhttps://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals#ES2018_revision_of_illegal_escape_sequences";
var isBrowser = typeof document !== 'undefined';

var Insertion = function Insertion(_ref) {
  var cache = _ref.cache,
      serialized = _ref.serialized,
      isStringTag = _ref.isStringTag;
  registerStyles(cache, serialized, isStringTag);
  var rules = useInsertionEffectAlwaysWithSyncFallback(function () {
    return insertStyles(cache, serialized, isStringTag);
  });

  if (!isBrowser && rules !== undefined) {
    var _ref2;

    var serializedNames = serialized.name;
    var next = serialized.next;

    while (next !== undefined) {
      serializedNames += ' ' + next.name;
      next = next.next;
    }

    return /*#__PURE__*/React$1.createElement("style", (_ref2 = {}, _ref2["data-emotion"] = cache.key + " " + serializedNames, _ref2.dangerouslySetInnerHTML = {
      __html: rules
    }, _ref2.nonce = cache.sheet.nonce, _ref2));
  }

  return null;
};

var createStyled$1 = function createStyled(tag, options) {
  if (process.env.NODE_ENV !== 'production') {
    if (tag === undefined) {
      throw new Error('You are trying to create a styled element with an undefined component.\nYou may have forgotten to import it.');
    }
  }

  var isReal = tag.__emotion_real === tag;
  var baseTag = isReal && tag.__emotion_base || tag;
  var identifierName;
  var targetClassName;

  if (options !== undefined) {
    identifierName = options.label;
    targetClassName = options.target;
  }

  var shouldForwardProp = composeShouldForwardProps(tag, options, isReal);
  var defaultShouldForwardProp = shouldForwardProp || getDefaultShouldForwardProp(baseTag);
  var shouldUseAs = !defaultShouldForwardProp('as');
  return function () {
    var args = arguments;
    var styles = isReal && tag.__emotion_styles !== undefined ? tag.__emotion_styles.slice(0) : [];

    if (identifierName !== undefined) {
      styles.push("label:" + identifierName + ";");
    }

    if (args[0] == null || args[0].raw === undefined) {
      styles.push.apply(styles, args);
    } else {
      if (process.env.NODE_ENV !== 'production' && args[0][0] === undefined) {
        console.error(ILLEGAL_ESCAPE_SEQUENCE_ERROR);
      }

      styles.push(args[0][0]);
      var len = args.length;
      var i = 1;

      for (; i < len; i++) {
        if (process.env.NODE_ENV !== 'production' && args[0][i] === undefined) {
          console.error(ILLEGAL_ESCAPE_SEQUENCE_ERROR);
        }

        styles.push(args[i], args[0][i]);
      }
    } // $FlowFixMe: we need to cast StatelessFunctionalComponent to our PrivateStyledComponent class


    var Styled = withEmotionCache(function (props, cache, ref) {
      var FinalTag = shouldUseAs && props.as || baseTag;
      var className = '';
      var classInterpolations = [];
      var mergedProps = props;

      if (props.theme == null) {
        mergedProps = {};

        for (var key in props) {
          mergedProps[key] = props[key];
        }

        mergedProps.theme = React$1.useContext(ThemeContext);
      }

      if (typeof props.className === 'string') {
        className = getRegisteredStyles(cache.registered, classInterpolations, props.className);
      } else if (props.className != null) {
        className = props.className + " ";
      }

      var serialized = serializeStyles(styles.concat(classInterpolations), cache.registered, mergedProps);
      className += cache.key + "-" + serialized.name;

      if (targetClassName !== undefined) {
        className += " " + targetClassName;
      }

      var finalShouldForwardProp = shouldUseAs && shouldForwardProp === undefined ? getDefaultShouldForwardProp(FinalTag) : defaultShouldForwardProp;
      var newProps = {};

      for (var _key in props) {
        if (shouldUseAs && _key === 'as') continue;

        if ( // $FlowFixMe
        finalShouldForwardProp(_key)) {
          newProps[_key] = props[_key];
        }
      }

      newProps.className = className;
      newProps.ref = ref;
      return /*#__PURE__*/React$1.createElement(React$1.Fragment, null, /*#__PURE__*/React$1.createElement(Insertion, {
        cache: cache,
        serialized: serialized,
        isStringTag: typeof FinalTag === 'string'
      }), /*#__PURE__*/React$1.createElement(FinalTag, newProps));
    });
    Styled.displayName = identifierName !== undefined ? identifierName : "Styled(" + (typeof baseTag === 'string' ? baseTag : baseTag.displayName || baseTag.name || 'Component') + ")";
    Styled.defaultProps = tag.defaultProps;
    Styled.__emotion_real = Styled;
    Styled.__emotion_base = baseTag;
    Styled.__emotion_styles = styles;
    Styled.__emotion_forwardProp = shouldForwardProp;
    Object.defineProperty(Styled, 'toString', {
      value: function value() {
        if (targetClassName === undefined && process.env.NODE_ENV !== 'production') {
          return 'NO_COMPONENT_SELECTOR';
        } // $FlowFixMe: coerce undefined to string


        return "." + targetClassName;
      }
    });

    Styled.withComponent = function (nextTag, nextOptions) {
      return createStyled(nextTag, _extends({}, options, nextOptions, {
        shouldForwardProp: composeShouldForwardProps(Styled, nextOptions, true)
      })).apply(void 0, styles);
    };

    return Styled;
  };
};

var tags = ['a', 'abbr', 'address', 'area', 'article', 'aside', 'audio', 'b', 'base', 'bdi', 'bdo', 'big', 'blockquote', 'body', 'br', 'button', 'canvas', 'caption', 'cite', 'code', 'col', 'colgroup', 'data', 'datalist', 'dd', 'del', 'details', 'dfn', 'dialog', 'div', 'dl', 'dt', 'em', 'embed', 'fieldset', 'figcaption', 'figure', 'footer', 'form', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'head', 'header', 'hgroup', 'hr', 'html', 'i', 'iframe', 'img', 'input', 'ins', 'kbd', 'keygen', 'label', 'legend', 'li', 'link', 'main', 'map', 'mark', 'marquee', 'menu', 'menuitem', 'meta', 'meter', 'nav', 'noscript', 'object', 'ol', 'optgroup', 'option', 'output', 'p', 'param', 'picture', 'pre', 'progress', 'q', 'rp', 'rt', 'ruby', 's', 'samp', 'script', 'section', 'select', 'small', 'source', 'span', 'strong', 'style', 'sub', 'summary', 'sup', 'table', 'tbody', 'td', 'textarea', 'tfoot', 'th', 'thead', 'time', 'title', 'tr', 'track', 'u', 'ul', 'var', 'video', 'wbr', // SVG
'circle', 'clipPath', 'defs', 'ellipse', 'foreignObject', 'g', 'image', 'line', 'linearGradient', 'mask', 'path', 'pattern', 'polygon', 'polyline', 'radialGradient', 'rect', 'stop', 'svg', 'text', 'tspan'];

var newStyled = createStyled$1.bind();
tags.forEach(function (tagName) {
  // $FlowFixMe: we can ignore this because its exposed type is defined by the CreateStyled type
  newStyled[tagName] = newStyled(tagName);
});

/**
 * @mui/styled-engine v5.12.3
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
function styled$2(tag, options) {
  const stylesFactory = newStyled(tag, options);
  if (process.env.NODE_ENV !== 'production') {
    return (...styles) => {
      const component = typeof tag === 'string' ? `"${tag}"` : 'component';
      if (styles.length === 0) {
        console.error([`MUI: Seems like you called \`styled(${component})()\` without a \`style\` argument.`, 'You must provide a `styles` argument: `styled("div")(styleYouForgotToPass)`.'].join('\n'));
      } else if (styles.some(style => style === undefined)) {
        console.error(`MUI: the styled(${component})(...args) API requires all its args to be defined.`);
      }
      return stylesFactory(...styles);
    };
  }
  return stylesFactory;
}

// eslint-disable-next-line @typescript-eslint/naming-convention
const internal_processStyles = (tag, processor) => {
  // Emotion attaches all the styles as `__emotion_styles`.
  // Ref: https://github.com/emotion-js/emotion/blob/16d971d0da229596d6bcc39d282ba9753c9ee7cf/packages/styled/src/base.js#L186
  if (Array.isArray(tag.__emotion_styles)) {
    tag.__emotion_styles = processor(tag.__emotion_styles);
  }
};

const _excluded$8 = ["values", "unit", "step"];
const sortBreakpointsValues = values => {
  const breakpointsAsArray = Object.keys(values).map(key => ({
    key,
    val: values[key]
  })) || [];
  // Sort in ascending order
  breakpointsAsArray.sort((breakpoint1, breakpoint2) => breakpoint1.val - breakpoint2.val);
  return breakpointsAsArray.reduce((acc, obj) => {
    return _extends({}, acc, {
      [obj.key]: obj.val
    });
  }, {});
};

// Keep in mind that @media is inclusive by the CSS specification.
function createBreakpoints(breakpoints) {
  const {
      // The breakpoint **start** at this value.
      // For instance with the first breakpoint xs: [xs, sm).
      values = {
        xs: 0,
        // phone
        sm: 600,
        // tablet
        md: 900,
        // small laptop
        lg: 1200,
        // desktop
        xl: 1536 // large screen
      },

      unit = 'px',
      step = 5
    } = breakpoints,
    other = _objectWithoutPropertiesLoose(breakpoints, _excluded$8);
  const sortedValues = sortBreakpointsValues(values);
  const keys = Object.keys(sortedValues);
  function up(key) {
    const value = typeof values[key] === 'number' ? values[key] : key;
    return `@media (min-width:${value}${unit})`;
  }
  function down(key) {
    const value = typeof values[key] === 'number' ? values[key] : key;
    return `@media (max-width:${value - step / 100}${unit})`;
  }
  function between(start, end) {
    const endIndex = keys.indexOf(end);
    return `@media (min-width:${typeof values[start] === 'number' ? values[start] : start}${unit}) and ` + `(max-width:${(endIndex !== -1 && typeof values[keys[endIndex]] === 'number' ? values[keys[endIndex]] : end) - step / 100}${unit})`;
  }
  function only(key) {
    if (keys.indexOf(key) + 1 < keys.length) {
      return between(key, keys[keys.indexOf(key) + 1]);
    }
    return up(key);
  }
  function not(key) {
    // handle first and last key separately, for better readability
    const keyIndex = keys.indexOf(key);
    if (keyIndex === 0) {
      return up(keys[1]);
    }
    if (keyIndex === keys.length - 1) {
      return down(keys[keyIndex]);
    }
    return between(key, keys[keys.indexOf(key) + 1]).replace('@media', '@media not all and');
  }
  return _extends({
    keys,
    values: sortedValues,
    up,
    down,
    between,
    only,
    not,
    unit
  }, other);
}

const shape = {
  borderRadius: 4
};
var shape$1 = shape;

const responsivePropType = process.env.NODE_ENV !== 'production' ? PropTypes.oneOfType([PropTypes.number, PropTypes.string, PropTypes.object, PropTypes.array]) : {};
var responsivePropType$1 = responsivePropType;

function merge(acc, item) {
  if (!item) {
    return acc;
  }
  return deepmerge(acc, item, {
    clone: false // No need to clone deep, it's way faster.
  });
}

// The breakpoint **start** at this value.
// For instance with the first breakpoint xs: [xs, sm[.
const values = {
  xs: 0,
  // phone
  sm: 600,
  // tablet
  md: 900,
  // small laptop
  lg: 1200,
  // desktop
  xl: 1536 // large screen
};

const defaultBreakpoints = {
  // Sorted ASC by size. That's important.
  // It can't be configured as it's used statically for propTypes.
  keys: ['xs', 'sm', 'md', 'lg', 'xl'],
  up: key => `@media (min-width:${values[key]}px)`
};
function handleBreakpoints(props, propValue, styleFromPropValue) {
  const theme = props.theme || {};
  if (Array.isArray(propValue)) {
    const themeBreakpoints = theme.breakpoints || defaultBreakpoints;
    return propValue.reduce((acc, item, index) => {
      acc[themeBreakpoints.up(themeBreakpoints.keys[index])] = styleFromPropValue(propValue[index]);
      return acc;
    }, {});
  }
  if (typeof propValue === 'object') {
    const themeBreakpoints = theme.breakpoints || defaultBreakpoints;
    return Object.keys(propValue).reduce((acc, breakpoint) => {
      // key is breakpoint
      if (Object.keys(themeBreakpoints.values || values).indexOf(breakpoint) !== -1) {
        const mediaKey = themeBreakpoints.up(breakpoint);
        acc[mediaKey] = styleFromPropValue(propValue[breakpoint], breakpoint);
      } else {
        const cssKey = breakpoint;
        acc[cssKey] = propValue[cssKey];
      }
      return acc;
    }, {});
  }
  const output = styleFromPropValue(propValue);
  return output;
}
function createEmptyBreakpointObject(breakpointsInput = {}) {
  var _breakpointsInput$key;
  const breakpointsInOrder = (_breakpointsInput$key = breakpointsInput.keys) == null ? void 0 : _breakpointsInput$key.reduce((acc, key) => {
    const breakpointStyleKey = breakpointsInput.up(key);
    acc[breakpointStyleKey] = {};
    return acc;
  }, {});
  return breakpointsInOrder || {};
}
function removeUnusedBreakpoints(breakpointKeys, style) {
  return breakpointKeys.reduce((acc, key) => {
    const breakpointOutput = acc[key];
    const isBreakpointUnused = !breakpointOutput || Object.keys(breakpointOutput).length === 0;
    if (isBreakpointUnused) {
      delete acc[key];
    }
    return acc;
  }, style);
}

function getPath(obj, path, checkVars = true) {
  if (!path || typeof path !== 'string') {
    return null;
  }

  // Check if CSS variables are used
  if (obj && obj.vars && checkVars) {
    const val = `vars.${path}`.split('.').reduce((acc, item) => acc && acc[item] ? acc[item] : null, obj);
    if (val != null) {
      return val;
    }
  }
  return path.split('.').reduce((acc, item) => {
    if (acc && acc[item] != null) {
      return acc[item];
    }
    return null;
  }, obj);
}
function getStyleValue(themeMapping, transform, propValueFinal, userValue = propValueFinal) {
  let value;
  if (typeof themeMapping === 'function') {
    value = themeMapping(propValueFinal);
  } else if (Array.isArray(themeMapping)) {
    value = themeMapping[propValueFinal] || userValue;
  } else {
    value = getPath(themeMapping, propValueFinal) || userValue;
  }
  if (transform) {
    value = transform(value, userValue, themeMapping);
  }
  return value;
}
function style$1(options) {
  const {
    prop,
    cssProperty = options.prop,
    themeKey,
    transform
  } = options;

  // false positive
  // eslint-disable-next-line react/function-component-definition
  const fn = props => {
    if (props[prop] == null) {
      return null;
    }
    const propValue = props[prop];
    const theme = props.theme;
    const themeMapping = getPath(theme, themeKey) || {};
    const styleFromPropValue = propValueFinal => {
      let value = getStyleValue(themeMapping, transform, propValueFinal);
      if (propValueFinal === value && typeof propValueFinal === 'string') {
        // Haven't found value
        value = getStyleValue(themeMapping, transform, `${prop}${propValueFinal === 'default' ? '' : capitalize(propValueFinal)}`, propValueFinal);
      }
      if (cssProperty === false) {
        return value;
      }
      return {
        [cssProperty]: value
      };
    };
    return handleBreakpoints(props, propValue, styleFromPropValue);
  };
  fn.propTypes = process.env.NODE_ENV !== 'production' ? {
    [prop]: responsivePropType$1
  } : {};
  fn.filterProps = [prop];
  return fn;
}

function memoize(fn) {
  const cache = {};
  return arg => {
    if (cache[arg] === undefined) {
      cache[arg] = fn(arg);
    }
    return cache[arg];
  };
}

const properties$1 = {
  m: 'margin',
  p: 'padding'
};
const directions = {
  t: 'Top',
  r: 'Right',
  b: 'Bottom',
  l: 'Left',
  x: ['Left', 'Right'],
  y: ['Top', 'Bottom']
};
const aliases = {
  marginX: 'mx',
  marginY: 'my',
  paddingX: 'px',
  paddingY: 'py'
};

// memoize() impact:
// From 300,000 ops/sec
// To 350,000 ops/sec
const getCssProperties = memoize(prop => {
  // It's not a shorthand notation.
  if (prop.length > 2) {
    if (aliases[prop]) {
      prop = aliases[prop];
    } else {
      return [prop];
    }
  }
  const [a, b] = prop.split('');
  const property = properties$1[a];
  const direction = directions[b] || '';
  return Array.isArray(direction) ? direction.map(dir => property + dir) : [property + direction];
});
const marginKeys = ['m', 'mt', 'mr', 'mb', 'ml', 'mx', 'my', 'margin', 'marginTop', 'marginRight', 'marginBottom', 'marginLeft', 'marginX', 'marginY', 'marginInline', 'marginInlineStart', 'marginInlineEnd', 'marginBlock', 'marginBlockStart', 'marginBlockEnd'];
const paddingKeys = ['p', 'pt', 'pr', 'pb', 'pl', 'px', 'py', 'padding', 'paddingTop', 'paddingRight', 'paddingBottom', 'paddingLeft', 'paddingX', 'paddingY', 'paddingInline', 'paddingInlineStart', 'paddingInlineEnd', 'paddingBlock', 'paddingBlockStart', 'paddingBlockEnd'];
const spacingKeys = [...marginKeys, ...paddingKeys];
function createUnaryUnit(theme, themeKey, defaultValue, propName) {
  var _getPath;
  const themeSpacing = (_getPath = getPath(theme, themeKey, false)) != null ? _getPath : defaultValue;
  if (typeof themeSpacing === 'number') {
    return abs => {
      if (typeof abs === 'string') {
        return abs;
      }
      if (process.env.NODE_ENV !== 'production') {
        if (typeof abs !== 'number') {
          console.error(`MUI: Expected ${propName} argument to be a number or a string, got ${abs}.`);
        }
      }
      return themeSpacing * abs;
    };
  }
  if (Array.isArray(themeSpacing)) {
    return abs => {
      if (typeof abs === 'string') {
        return abs;
      }
      if (process.env.NODE_ENV !== 'production') {
        if (!Number.isInteger(abs)) {
          console.error([`MUI: The \`theme.${themeKey}\` array type cannot be combined with non integer values.` + `You should either use an integer value that can be used as index, or define the \`theme.${themeKey}\` as a number.`].join('\n'));
        } else if (abs > themeSpacing.length - 1) {
          console.error([`MUI: The value provided (${abs}) overflows.`, `The supported values are: ${JSON.stringify(themeSpacing)}.`, `${abs} > ${themeSpacing.length - 1}, you need to add the missing values.`].join('\n'));
        }
      }
      return themeSpacing[abs];
    };
  }
  if (typeof themeSpacing === 'function') {
    return themeSpacing;
  }
  if (process.env.NODE_ENV !== 'production') {
    console.error([`MUI: The \`theme.${themeKey}\` value (${themeSpacing}) is invalid.`, 'It should be a number, an array or a function.'].join('\n'));
  }
  return () => undefined;
}
function createUnarySpacing(theme) {
  return createUnaryUnit(theme, 'spacing', 8, 'spacing');
}
function getValue(transformer, propValue) {
  if (typeof propValue === 'string' || propValue == null) {
    return propValue;
  }
  const abs = Math.abs(propValue);
  const transformed = transformer(abs);
  if (propValue >= 0) {
    return transformed;
  }
  if (typeof transformed === 'number') {
    return -transformed;
  }
  return `-${transformed}`;
}
function getStyleFromPropValue(cssProperties, transformer) {
  return propValue => cssProperties.reduce((acc, cssProperty) => {
    acc[cssProperty] = getValue(transformer, propValue);
    return acc;
  }, {});
}
function resolveCssProperty(props, keys, prop, transformer) {
  // Using a hash computation over an array iteration could be faster, but with only 28 items,
  // it's doesn't worth the bundle size.
  if (keys.indexOf(prop) === -1) {
    return null;
  }
  const cssProperties = getCssProperties(prop);
  const styleFromPropValue = getStyleFromPropValue(cssProperties, transformer);
  const propValue = props[prop];
  return handleBreakpoints(props, propValue, styleFromPropValue);
}
function style(props, keys) {
  const transformer = createUnarySpacing(props.theme);
  return Object.keys(props).map(prop => resolveCssProperty(props, keys, prop, transformer)).reduce(merge, {});
}
function margin(props) {
  return style(props, marginKeys);
}
margin.propTypes = process.env.NODE_ENV !== 'production' ? marginKeys.reduce((obj, key) => {
  obj[key] = responsivePropType$1;
  return obj;
}, {}) : {};
margin.filterProps = marginKeys;
function padding(props) {
  return style(props, paddingKeys);
}
padding.propTypes = process.env.NODE_ENV !== 'production' ? paddingKeys.reduce((obj, key) => {
  obj[key] = responsivePropType$1;
  return obj;
}, {}) : {};
padding.filterProps = paddingKeys;
process.env.NODE_ENV !== 'production' ? spacingKeys.reduce((obj, key) => {
  obj[key] = responsivePropType$1;
  return obj;
}, {}) : {};

// The different signatures imply different meaning for their arguments that can't be expressed structurally.
// We express the difference with variable names.
/* tslint:disable:unified-signatures */
/* tslint:enable:unified-signatures */

function createSpacing(spacingInput = 8) {
  // Already transformed.
  if (spacingInput.mui) {
    return spacingInput;
  }

  // Material Design layouts are visually balanced. Most measurements align to an 8dp grid, which aligns both spacing and the overall layout.
  // Smaller components, such as icons, can align to a 4dp grid.
  // https://m2.material.io/design/layout/understanding-layout.html
  const transform = createUnarySpacing({
    spacing: spacingInput
  });
  const spacing = (...argsInput) => {
    if (process.env.NODE_ENV !== 'production') {
      if (!(argsInput.length <= 4)) {
        console.error(`MUI: Too many arguments provided, expected between 0 and 4, got ${argsInput.length}`);
      }
    }
    const args = argsInput.length === 0 ? [1] : argsInput;
    return args.map(argument => {
      const output = transform(argument);
      return typeof output === 'number' ? `${output}px` : output;
    }).join(' ');
  };
  spacing.mui = true;
  return spacing;
}

function compose(...styles) {
  const handlers = styles.reduce((acc, style) => {
    style.filterProps.forEach(prop => {
      acc[prop] = style;
    });
    return acc;
  }, {});

  // false positive
  // eslint-disable-next-line react/function-component-definition
  const fn = props => {
    return Object.keys(props).reduce((acc, prop) => {
      if (handlers[prop]) {
        return merge(acc, handlers[prop](props));
      }
      return acc;
    }, {});
  };
  fn.propTypes = process.env.NODE_ENV !== 'production' ? styles.reduce((acc, style) => Object.assign(acc, style.propTypes), {}) : {};
  fn.filterProps = styles.reduce((acc, style) => acc.concat(style.filterProps), []);
  return fn;
}

function borderTransform(value) {
  if (typeof value !== 'number') {
    return value;
  }
  return `${value}px solid`;
}
const border = style$1({
  prop: 'border',
  themeKey: 'borders',
  transform: borderTransform
});
const borderTop = style$1({
  prop: 'borderTop',
  themeKey: 'borders',
  transform: borderTransform
});
const borderRight = style$1({
  prop: 'borderRight',
  themeKey: 'borders',
  transform: borderTransform
});
const borderBottom = style$1({
  prop: 'borderBottom',
  themeKey: 'borders',
  transform: borderTransform
});
const borderLeft = style$1({
  prop: 'borderLeft',
  themeKey: 'borders',
  transform: borderTransform
});
const borderColor = style$1({
  prop: 'borderColor',
  themeKey: 'palette'
});
const borderTopColor = style$1({
  prop: 'borderTopColor',
  themeKey: 'palette'
});
const borderRightColor = style$1({
  prop: 'borderRightColor',
  themeKey: 'palette'
});
const borderBottomColor = style$1({
  prop: 'borderBottomColor',
  themeKey: 'palette'
});
const borderLeftColor = style$1({
  prop: 'borderLeftColor',
  themeKey: 'palette'
});

// false positive
// eslint-disable-next-line react/function-component-definition
const borderRadius = props => {
  if (props.borderRadius !== undefined && props.borderRadius !== null) {
    const transformer = createUnaryUnit(props.theme, 'shape.borderRadius', 4, 'borderRadius');
    const styleFromPropValue = propValue => ({
      borderRadius: getValue(transformer, propValue)
    });
    return handleBreakpoints(props, props.borderRadius, styleFromPropValue);
  }
  return null;
};
borderRadius.propTypes = process.env.NODE_ENV !== 'production' ? {
  borderRadius: responsivePropType$1
} : {};
borderRadius.filterProps = ['borderRadius'];
compose(border, borderTop, borderRight, borderBottom, borderLeft, borderColor, borderTopColor, borderRightColor, borderBottomColor, borderLeftColor, borderRadius);

// false positive
// eslint-disable-next-line react/function-component-definition
const gap = props => {
  if (props.gap !== undefined && props.gap !== null) {
    const transformer = createUnaryUnit(props.theme, 'spacing', 8, 'gap');
    const styleFromPropValue = propValue => ({
      gap: getValue(transformer, propValue)
    });
    return handleBreakpoints(props, props.gap, styleFromPropValue);
  }
  return null;
};
gap.propTypes = process.env.NODE_ENV !== 'production' ? {
  gap: responsivePropType$1
} : {};
gap.filterProps = ['gap'];

// false positive
// eslint-disable-next-line react/function-component-definition
const columnGap = props => {
  if (props.columnGap !== undefined && props.columnGap !== null) {
    const transformer = createUnaryUnit(props.theme, 'spacing', 8, 'columnGap');
    const styleFromPropValue = propValue => ({
      columnGap: getValue(transformer, propValue)
    });
    return handleBreakpoints(props, props.columnGap, styleFromPropValue);
  }
  return null;
};
columnGap.propTypes = process.env.NODE_ENV !== 'production' ? {
  columnGap: responsivePropType$1
} : {};
columnGap.filterProps = ['columnGap'];

// false positive
// eslint-disable-next-line react/function-component-definition
const rowGap = props => {
  if (props.rowGap !== undefined && props.rowGap !== null) {
    const transformer = createUnaryUnit(props.theme, 'spacing', 8, 'rowGap');
    const styleFromPropValue = propValue => ({
      rowGap: getValue(transformer, propValue)
    });
    return handleBreakpoints(props, props.rowGap, styleFromPropValue);
  }
  return null;
};
rowGap.propTypes = process.env.NODE_ENV !== 'production' ? {
  rowGap: responsivePropType$1
} : {};
rowGap.filterProps = ['rowGap'];
const gridColumn = style$1({
  prop: 'gridColumn'
});
const gridRow = style$1({
  prop: 'gridRow'
});
const gridAutoFlow = style$1({
  prop: 'gridAutoFlow'
});
const gridAutoColumns = style$1({
  prop: 'gridAutoColumns'
});
const gridAutoRows = style$1({
  prop: 'gridAutoRows'
});
const gridTemplateColumns = style$1({
  prop: 'gridTemplateColumns'
});
const gridTemplateRows = style$1({
  prop: 'gridTemplateRows'
});
const gridTemplateAreas = style$1({
  prop: 'gridTemplateAreas'
});
const gridArea = style$1({
  prop: 'gridArea'
});
compose(gap, columnGap, rowGap, gridColumn, gridRow, gridAutoFlow, gridAutoColumns, gridAutoRows, gridTemplateColumns, gridTemplateRows, gridTemplateAreas, gridArea);

function paletteTransform(value, userValue) {
  if (userValue === 'grey') {
    return userValue;
  }
  return value;
}
const color = style$1({
  prop: 'color',
  themeKey: 'palette',
  transform: paletteTransform
});
const bgcolor = style$1({
  prop: 'bgcolor',
  cssProperty: 'backgroundColor',
  themeKey: 'palette',
  transform: paletteTransform
});
const backgroundColor = style$1({
  prop: 'backgroundColor',
  themeKey: 'palette',
  transform: paletteTransform
});
compose(color, bgcolor, backgroundColor);

function sizingTransform(value) {
  return value <= 1 && value !== 0 ? `${value * 100}%` : value;
}
const width = style$1({
  prop: 'width',
  transform: sizingTransform
});
const maxWidth = props => {
  if (props.maxWidth !== undefined && props.maxWidth !== null) {
    const styleFromPropValue = propValue => {
      var _props$theme, _props$theme$breakpoi, _props$theme$breakpoi2;
      const breakpoint = ((_props$theme = props.theme) == null ? void 0 : (_props$theme$breakpoi = _props$theme.breakpoints) == null ? void 0 : (_props$theme$breakpoi2 = _props$theme$breakpoi.values) == null ? void 0 : _props$theme$breakpoi2[propValue]) || values[propValue];
      return {
        maxWidth: breakpoint || sizingTransform(propValue)
      };
    };
    return handleBreakpoints(props, props.maxWidth, styleFromPropValue);
  }
  return null;
};
maxWidth.filterProps = ['maxWidth'];
const minWidth = style$1({
  prop: 'minWidth',
  transform: sizingTransform
});
const height = style$1({
  prop: 'height',
  transform: sizingTransform
});
const maxHeight = style$1({
  prop: 'maxHeight',
  transform: sizingTransform
});
const minHeight = style$1({
  prop: 'minHeight',
  transform: sizingTransform
});
style$1({
  prop: 'size',
  cssProperty: 'width',
  transform: sizingTransform
});
style$1({
  prop: 'size',
  cssProperty: 'height',
  transform: sizingTransform
});
const boxSizing = style$1({
  prop: 'boxSizing'
});
compose(width, maxWidth, minWidth, height, maxHeight, minHeight, boxSizing);

const defaultSxConfig = {
  // borders
  border: {
    themeKey: 'borders',
    transform: borderTransform
  },
  borderTop: {
    themeKey: 'borders',
    transform: borderTransform
  },
  borderRight: {
    themeKey: 'borders',
    transform: borderTransform
  },
  borderBottom: {
    themeKey: 'borders',
    transform: borderTransform
  },
  borderLeft: {
    themeKey: 'borders',
    transform: borderTransform
  },
  borderColor: {
    themeKey: 'palette'
  },
  borderTopColor: {
    themeKey: 'palette'
  },
  borderRightColor: {
    themeKey: 'palette'
  },
  borderBottomColor: {
    themeKey: 'palette'
  },
  borderLeftColor: {
    themeKey: 'palette'
  },
  borderRadius: {
    themeKey: 'shape.borderRadius',
    style: borderRadius
  },
  // palette
  color: {
    themeKey: 'palette',
    transform: paletteTransform
  },
  bgcolor: {
    themeKey: 'palette',
    cssProperty: 'backgroundColor',
    transform: paletteTransform
  },
  backgroundColor: {
    themeKey: 'palette',
    transform: paletteTransform
  },
  // spacing
  p: {
    style: padding
  },
  pt: {
    style: padding
  },
  pr: {
    style: padding
  },
  pb: {
    style: padding
  },
  pl: {
    style: padding
  },
  px: {
    style: padding
  },
  py: {
    style: padding
  },
  padding: {
    style: padding
  },
  paddingTop: {
    style: padding
  },
  paddingRight: {
    style: padding
  },
  paddingBottom: {
    style: padding
  },
  paddingLeft: {
    style: padding
  },
  paddingX: {
    style: padding
  },
  paddingY: {
    style: padding
  },
  paddingInline: {
    style: padding
  },
  paddingInlineStart: {
    style: padding
  },
  paddingInlineEnd: {
    style: padding
  },
  paddingBlock: {
    style: padding
  },
  paddingBlockStart: {
    style: padding
  },
  paddingBlockEnd: {
    style: padding
  },
  m: {
    style: margin
  },
  mt: {
    style: margin
  },
  mr: {
    style: margin
  },
  mb: {
    style: margin
  },
  ml: {
    style: margin
  },
  mx: {
    style: margin
  },
  my: {
    style: margin
  },
  margin: {
    style: margin
  },
  marginTop: {
    style: margin
  },
  marginRight: {
    style: margin
  },
  marginBottom: {
    style: margin
  },
  marginLeft: {
    style: margin
  },
  marginX: {
    style: margin
  },
  marginY: {
    style: margin
  },
  marginInline: {
    style: margin
  },
  marginInlineStart: {
    style: margin
  },
  marginInlineEnd: {
    style: margin
  },
  marginBlock: {
    style: margin
  },
  marginBlockStart: {
    style: margin
  },
  marginBlockEnd: {
    style: margin
  },
  // display
  displayPrint: {
    cssProperty: false,
    transform: value => ({
      '@media print': {
        display: value
      }
    })
  },
  display: {},
  overflow: {},
  textOverflow: {},
  visibility: {},
  whiteSpace: {},
  // flexbox
  flexBasis: {},
  flexDirection: {},
  flexWrap: {},
  justifyContent: {},
  alignItems: {},
  alignContent: {},
  order: {},
  flex: {},
  flexGrow: {},
  flexShrink: {},
  alignSelf: {},
  justifyItems: {},
  justifySelf: {},
  // grid
  gap: {
    style: gap
  },
  rowGap: {
    style: rowGap
  },
  columnGap: {
    style: columnGap
  },
  gridColumn: {},
  gridRow: {},
  gridAutoFlow: {},
  gridAutoColumns: {},
  gridAutoRows: {},
  gridTemplateColumns: {},
  gridTemplateRows: {},
  gridTemplateAreas: {},
  gridArea: {},
  // positions
  position: {},
  zIndex: {
    themeKey: 'zIndex'
  },
  top: {},
  right: {},
  bottom: {},
  left: {},
  // shadows
  boxShadow: {
    themeKey: 'shadows'
  },
  // sizing
  width: {
    transform: sizingTransform
  },
  maxWidth: {
    style: maxWidth
  },
  minWidth: {
    transform: sizingTransform
  },
  height: {
    transform: sizingTransform
  },
  maxHeight: {
    transform: sizingTransform
  },
  minHeight: {
    transform: sizingTransform
  },
  boxSizing: {},
  // typography
  fontFamily: {
    themeKey: 'typography'
  },
  fontSize: {
    themeKey: 'typography'
  },
  fontStyle: {
    themeKey: 'typography'
  },
  fontWeight: {
    themeKey: 'typography'
  },
  letterSpacing: {},
  textTransform: {},
  lineHeight: {},
  textAlign: {},
  typography: {
    cssProperty: false,
    themeKey: 'typography'
  }
};
var defaultSxConfig$1 = defaultSxConfig;

function objectsHaveSameKeys(...objects) {
  const allKeys = objects.reduce((keys, object) => keys.concat(Object.keys(object)), []);
  const union = new Set(allKeys);
  return objects.every(object => union.size === Object.keys(object).length);
}
function callIfFn(maybeFn, arg) {
  return typeof maybeFn === 'function' ? maybeFn(arg) : maybeFn;
}

// eslint-disable-next-line @typescript-eslint/naming-convention
function unstable_createStyleFunctionSx() {
  function getThemeValue(prop, val, theme, config) {
    const props = {
      [prop]: val,
      theme
    };
    const options = config[prop];
    if (!options) {
      return {
        [prop]: val
      };
    }
    const {
      cssProperty = prop,
      themeKey,
      transform,
      style
    } = options;
    if (val == null) {
      return null;
    }
    if (themeKey === 'typography' && val === 'inherit') {
      return {
        [prop]: val
      };
    }
    const themeMapping = getPath(theme, themeKey) || {};
    if (style) {
      return style(props);
    }
    const styleFromPropValue = propValueFinal => {
      let value = getStyleValue(themeMapping, transform, propValueFinal);
      if (propValueFinal === value && typeof propValueFinal === 'string') {
        // Haven't found value
        value = getStyleValue(themeMapping, transform, `${prop}${propValueFinal === 'default' ? '' : capitalize(propValueFinal)}`, propValueFinal);
      }
      if (cssProperty === false) {
        return value;
      }
      return {
        [cssProperty]: value
      };
    };
    return handleBreakpoints(props, val, styleFromPropValue);
  }
  function styleFunctionSx(props) {
    var _theme$unstable_sxCon;
    const {
      sx,
      theme = {}
    } = props || {};
    if (!sx) {
      return null; // Emotion & styled-components will neglect null
    }

    const config = (_theme$unstable_sxCon = theme.unstable_sxConfig) != null ? _theme$unstable_sxCon : defaultSxConfig$1;

    /*
     * Receive `sxInput` as object or callback
     * and then recursively check keys & values to create media query object styles.
     * (the result will be used in `styled`)
     */
    function traverse(sxInput) {
      let sxObject = sxInput;
      if (typeof sxInput === 'function') {
        sxObject = sxInput(theme);
      } else if (typeof sxInput !== 'object') {
        // value
        return sxInput;
      }
      if (!sxObject) {
        return null;
      }
      const emptyBreakpoints = createEmptyBreakpointObject(theme.breakpoints);
      const breakpointsKeys = Object.keys(emptyBreakpoints);
      let css = emptyBreakpoints;
      Object.keys(sxObject).forEach(styleKey => {
        const value = callIfFn(sxObject[styleKey], theme);
        if (value !== null && value !== undefined) {
          if (typeof value === 'object') {
            if (config[styleKey]) {
              css = merge(css, getThemeValue(styleKey, value, theme, config));
            } else {
              const breakpointsValues = handleBreakpoints({
                theme
              }, value, x => ({
                [styleKey]: x
              }));
              if (objectsHaveSameKeys(breakpointsValues, value)) {
                css[styleKey] = styleFunctionSx({
                  sx: value,
                  theme
                });
              } else {
                css = merge(css, breakpointsValues);
              }
            }
          } else {
            css = merge(css, getThemeValue(styleKey, value, theme, config));
          }
        }
      });
      return removeUnusedBreakpoints(breakpointsKeys, css);
    }
    return Array.isArray(sx) ? sx.map(traverse) : traverse(sx);
  }
  return styleFunctionSx;
}
const styleFunctionSx = unstable_createStyleFunctionSx();
styleFunctionSx.filterProps = ['sx'];
var styleFunctionSx$1 = styleFunctionSx;

const _excluded$7 = ["breakpoints", "palette", "spacing", "shape"];
function createTheme$1(options = {}, ...args) {
  const {
      breakpoints: breakpointsInput = {},
      palette: paletteInput = {},
      spacing: spacingInput,
      shape: shapeInput = {}
    } = options,
    other = _objectWithoutPropertiesLoose(options, _excluded$7);
  const breakpoints = createBreakpoints(breakpointsInput);
  const spacing = createSpacing(spacingInput);
  let muiTheme = deepmerge({
    breakpoints,
    direction: 'ltr',
    components: {},
    // Inject component definitions.
    palette: _extends({
      mode: 'light'
    }, paletteInput),
    spacing,
    shape: _extends({}, shape$1, shapeInput)
  }, other);
  muiTheme = args.reduce((acc, argument) => deepmerge(acc, argument), muiTheme);
  muiTheme.unstable_sxConfig = _extends({}, defaultSxConfig$1, other == null ? void 0 : other.unstable_sxConfig);
  muiTheme.unstable_sx = function sx(props) {
    return styleFunctionSx$1({
      sx: props,
      theme: this
    });
  };
  return muiTheme;
}

function isObjectEmpty(obj) {
  return Object.keys(obj).length === 0;
}
function useTheme$2(defaultTheme = null) {
  const contextTheme = React$1.useContext(ThemeContext);
  return !contextTheme || isObjectEmpty(contextTheme) ? defaultTheme : contextTheme;
}

const systemDefaultTheme$1 = createTheme$1();
function useTheme$1(defaultTheme = systemDefaultTheme$1) {
  return useTheme$2(defaultTheme);
}

const _excluded$6 = ["variant"];
function isEmpty$1(string) {
  return string.length === 0;
}

/**
 * Generates string classKey based on the properties provided. It starts with the
 * variant if defined, and then it appends all other properties in alphabetical order.
 * @param {object} props - the properties for which the classKey should be created.
 */
function propsToClassKey(props) {
  const {
      variant
    } = props,
    other = _objectWithoutPropertiesLoose(props, _excluded$6);
  let classKey = variant || '';
  Object.keys(other).sort().forEach(key => {
    if (key === 'color') {
      classKey += isEmpty$1(classKey) ? props[key] : capitalize(props[key]);
    } else {
      classKey += `${isEmpty$1(classKey) ? key : capitalize(key)}${capitalize(props[key].toString())}`;
    }
  });
  return classKey;
}

const _excluded$5 = ["name", "slot", "skipVariantsResolver", "skipSx", "overridesResolver"];
function isEmpty(obj) {
  return Object.keys(obj).length === 0;
}

// https://github.com/emotion-js/emotion/blob/26ded6109fcd8ca9875cc2ce4564fee678a3f3c5/packages/styled/src/utils.js#L40
function isStringTag(tag) {
  return typeof tag === 'string' &&
  // 96 is one less than the char code
  // for "a" so this is checking that
  // it's a lowercase character
  tag.charCodeAt(0) > 96;
}
const getStyleOverrides = (name, theme) => {
  if (theme.components && theme.components[name] && theme.components[name].styleOverrides) {
    return theme.components[name].styleOverrides;
  }
  return null;
};
const getVariantStyles = (name, theme) => {
  let variants = [];
  if (theme && theme.components && theme.components[name] && theme.components[name].variants) {
    variants = theme.components[name].variants;
  }
  const variantsStyles = {};
  variants.forEach(definition => {
    const key = propsToClassKey(definition.props);
    variantsStyles[key] = definition.style;
  });
  return variantsStyles;
};
const variantsResolver = (props, styles, theme, name) => {
  var _theme$components, _theme$components$nam;
  const {
    ownerState = {}
  } = props;
  const variantsStyles = [];
  const themeVariants = theme == null ? void 0 : (_theme$components = theme.components) == null ? void 0 : (_theme$components$nam = _theme$components[name]) == null ? void 0 : _theme$components$nam.variants;
  if (themeVariants) {
    themeVariants.forEach(themeVariant => {
      let isMatch = true;
      Object.keys(themeVariant.props).forEach(key => {
        if (ownerState[key] !== themeVariant.props[key] && props[key] !== themeVariant.props[key]) {
          isMatch = false;
        }
      });
      if (isMatch) {
        variantsStyles.push(styles[propsToClassKey(themeVariant.props)]);
      }
    });
  }
  return variantsStyles;
};

// Update /system/styled/#api in case if this changes
function shouldForwardProp(prop) {
  return prop !== 'ownerState' && prop !== 'theme' && prop !== 'sx' && prop !== 'as';
}
const systemDefaultTheme = createTheme$1();
const lowercaseFirstLetter = string => {
  return string.charAt(0).toLowerCase() + string.slice(1);
};
function resolveTheme({
  defaultTheme,
  theme,
  themeId
}) {
  return isEmpty(theme) ? defaultTheme : theme[themeId] || theme;
}
function createStyled(input = {}) {
  const {
    themeId,
    defaultTheme = systemDefaultTheme,
    rootShouldForwardProp = shouldForwardProp,
    slotShouldForwardProp = shouldForwardProp
  } = input;
  const systemSx = props => {
    return styleFunctionSx$1(_extends({}, props, {
      theme: resolveTheme(_extends({}, props, {
        defaultTheme,
        themeId
      }))
    }));
  };
  systemSx.__mui_systemSx = true;
  return (tag, inputOptions = {}) => {
    // Filter out the `sx` style function from the previous styled component to prevent unnecessary styles generated by the composite components.
    internal_processStyles(tag, styles => styles.filter(style => !(style != null && style.__mui_systemSx)));
    const {
        name: componentName,
        slot: componentSlot,
        skipVariantsResolver: inputSkipVariantsResolver,
        skipSx: inputSkipSx,
        overridesResolver
      } = inputOptions,
      options = _objectWithoutPropertiesLoose(inputOptions, _excluded$5);

    // if skipVariantsResolver option is defined, take the value, otherwise, true for root and false for other slots.
    const skipVariantsResolver = inputSkipVariantsResolver !== undefined ? inputSkipVariantsResolver : componentSlot && componentSlot !== 'Root' || false;
    const skipSx = inputSkipSx || false;
    let label;
    if (process.env.NODE_ENV !== 'production') {
      if (componentName) {
        label = `${componentName}-${lowercaseFirstLetter(componentSlot || 'Root')}`;
      }
    }
    let shouldForwardPropOption = shouldForwardProp;
    if (componentSlot === 'Root') {
      shouldForwardPropOption = rootShouldForwardProp;
    } else if (componentSlot) {
      // any other slot specified
      shouldForwardPropOption = slotShouldForwardProp;
    } else if (isStringTag(tag)) {
      // for string (html) tag, preserve the behavior in emotion & styled-components.
      shouldForwardPropOption = undefined;
    }
    const defaultStyledResolver = styled$2(tag, _extends({
      shouldForwardProp: shouldForwardPropOption,
      label
    }, options));
    const muiStyledResolver = (styleArg, ...expressions) => {
      const expressionsWithDefaultTheme = expressions ? expressions.map(stylesArg => {
        // On the server Emotion doesn't use React.forwardRef for creating components, so the created
        // component stays as a function. This condition makes sure that we do not interpolate functions
        // which are basically components used as a selectors.
        return typeof stylesArg === 'function' && stylesArg.__emotion_real !== stylesArg ? props => {
          return stylesArg(_extends({}, props, {
            theme: resolveTheme(_extends({}, props, {
              defaultTheme,
              themeId
            }))
          }));
        } : stylesArg;
      }) : [];
      let transformedStyleArg = styleArg;
      if (componentName && overridesResolver) {
        expressionsWithDefaultTheme.push(props => {
          const theme = resolveTheme(_extends({}, props, {
            defaultTheme,
            themeId
          }));
          const styleOverrides = getStyleOverrides(componentName, theme);
          if (styleOverrides) {
            const resolvedStyleOverrides = {};
            Object.entries(styleOverrides).forEach(([slotKey, slotStyle]) => {
              resolvedStyleOverrides[slotKey] = typeof slotStyle === 'function' ? slotStyle(_extends({}, props, {
                theme
              })) : slotStyle;
            });
            return overridesResolver(props, resolvedStyleOverrides);
          }
          return null;
        });
      }
      if (componentName && !skipVariantsResolver) {
        expressionsWithDefaultTheme.push(props => {
          const theme = resolveTheme(_extends({}, props, {
            defaultTheme,
            themeId
          }));
          return variantsResolver(props, getVariantStyles(componentName, theme), theme, componentName);
        });
      }
      if (!skipSx) {
        expressionsWithDefaultTheme.push(systemSx);
      }
      const numOfCustomFnsApplied = expressionsWithDefaultTheme.length - expressions.length;
      if (Array.isArray(styleArg) && numOfCustomFnsApplied > 0) {
        const placeholders = new Array(numOfCustomFnsApplied).fill('');
        // If the type is array, than we need to add placeholders in the template for the overrides, variants and the sx styles.
        transformedStyleArg = [...styleArg, ...placeholders];
        transformedStyleArg.raw = [...styleArg.raw, ...placeholders];
      } else if (typeof styleArg === 'function' &&
      // On the server Emotion doesn't use React.forwardRef for creating components, so the created
      // component stays as a function. This condition makes sure that we do not interpolate functions
      // which are basically components used as a selectors.
      styleArg.__emotion_real !== styleArg) {
        // If the type is function, we need to define the default theme.
        transformedStyleArg = props => styleArg(_extends({}, props, {
          theme: resolveTheme(_extends({}, props, {
            defaultTheme,
            themeId
          }))
        }));
      }
      const Component = defaultStyledResolver(transformedStyleArg, ...expressionsWithDefaultTheme);
      if (process.env.NODE_ENV !== 'production') {
        let displayName;
        if (componentName) {
          displayName = `${componentName}${componentSlot || ''}`;
        }
        if (displayName === undefined) {
          displayName = `Styled(${getDisplayName(tag)})`;
        }
        Component.displayName = displayName;
      }
      if (tag.muiName) {
        Component.muiName = tag.muiName;
      }
      return Component;
    };
    if (defaultStyledResolver.withConfig) {
      muiStyledResolver.withConfig = defaultStyledResolver.withConfig;
    }
    return muiStyledResolver;
  };
}

function getThemeProps(params) {
  const {
    theme,
    name,
    props
  } = params;
  if (!theme || !theme.components || !theme.components[name] || !theme.components[name].defaultProps) {
    return props;
  }
  return resolveProps(theme.components[name].defaultProps, props);
}

function useThemeProps$1({
  props,
  name,
  defaultTheme,
  themeId
}) {
  let theme = useTheme$1(defaultTheme);
  if (themeId) {
    theme = theme[themeId] || theme;
  }
  const mergedProps = getThemeProps({
    theme,
    name,
    props
  });
  return mergedProps;
}

/* eslint-disable @typescript-eslint/naming-convention */
/**
 * Returns a number whose value is limited to the given range.
 * @param {number} value The value to be clamped
 * @param {number} min The lower boundary of the output range
 * @param {number} max The upper boundary of the output range
 * @returns {number} A number in the range [min, max]
 */
function clamp(value, min = 0, max = 1) {
  if (process.env.NODE_ENV !== 'production') {
    if (value < min || value > max) {
      console.error(`MUI: The value provided ${value} is out of range [${min}, ${max}].`);
    }
  }
  return Math.min(Math.max(min, value), max);
}

/**
 * Converts a color from CSS hex format to CSS rgb format.
 * @param {string} color - Hex color, i.e. #nnn or #nnnnnn
 * @returns {string} A CSS rgb color string
 */
function hexToRgb(color) {
  color = color.slice(1);
  const re = new RegExp(`.{1,${color.length >= 6 ? 2 : 1}}`, 'g');
  let colors = color.match(re);
  if (colors && colors[0].length === 1) {
    colors = colors.map(n => n + n);
  }
  return colors ? `rgb${colors.length === 4 ? 'a' : ''}(${colors.map((n, index) => {
    return index < 3 ? parseInt(n, 16) : Math.round(parseInt(n, 16) / 255 * 1000) / 1000;
  }).join(', ')})` : '';
}

/**
 * Returns an object with the type and values of a color.
 *
 * Note: Does not support rgb % values.
 * @param {string} color - CSS color, i.e. one of: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color()
 * @returns {object} - A MUI color object: {type: string, values: number[]}
 */
function decomposeColor(color) {
  // Idempotent
  if (color.type) {
    return color;
  }
  if (color.charAt(0) === '#') {
    return decomposeColor(hexToRgb(color));
  }
  const marker = color.indexOf('(');
  const type = color.substring(0, marker);
  if (['rgb', 'rgba', 'hsl', 'hsla', 'color'].indexOf(type) === -1) {
    throw new Error(process.env.NODE_ENV !== "production" ? `MUI: Unsupported \`${color}\` color.
The following formats are supported: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color().` : formatMuiErrorMessage(9, color));
  }
  let values = color.substring(marker + 1, color.length - 1);
  let colorSpace;
  if (type === 'color') {
    values = values.split(' ');
    colorSpace = values.shift();
    if (values.length === 4 && values[3].charAt(0) === '/') {
      values[3] = values[3].slice(1);
    }
    if (['srgb', 'display-p3', 'a98-rgb', 'prophoto-rgb', 'rec-2020'].indexOf(colorSpace) === -1) {
      throw new Error(process.env.NODE_ENV !== "production" ? `MUI: unsupported \`${colorSpace}\` color space.
The following color spaces are supported: srgb, display-p3, a98-rgb, prophoto-rgb, rec-2020.` : formatMuiErrorMessage(10, colorSpace));
    }
  } else {
    values = values.split(',');
  }
  values = values.map(value => parseFloat(value));
  return {
    type,
    values,
    colorSpace
  };
}

/**
 * Converts a color object with type and values to a string.
 * @param {object} color - Decomposed color
 * @param {string} color.type - One of: 'rgb', 'rgba', 'hsl', 'hsla', 'color'
 * @param {array} color.values - [n,n,n] or [n,n,n,n]
 * @returns {string} A CSS color string
 */
function recomposeColor(color) {
  const {
    type,
    colorSpace
  } = color;
  let {
    values
  } = color;
  if (type.indexOf('rgb') !== -1) {
    // Only convert the first 3 values to int (i.e. not alpha)
    values = values.map((n, i) => i < 3 ? parseInt(n, 10) : n);
  } else if (type.indexOf('hsl') !== -1) {
    values[1] = `${values[1]}%`;
    values[2] = `${values[2]}%`;
  }
  if (type.indexOf('color') !== -1) {
    values = `${colorSpace} ${values.join(' ')}`;
  } else {
    values = `${values.join(', ')}`;
  }
  return `${type}(${values})`;
}

/**
 * Converts a color from hsl format to rgb format.
 * @param {string} color - HSL color values
 * @returns {string} rgb color values
 */
function hslToRgb(color) {
  color = decomposeColor(color);
  const {
    values
  } = color;
  const h = values[0];
  const s = values[1] / 100;
  const l = values[2] / 100;
  const a = s * Math.min(l, 1 - l);
  const f = (n, k = (n + h / 30) % 12) => l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
  let type = 'rgb';
  const rgb = [Math.round(f(0) * 255), Math.round(f(8) * 255), Math.round(f(4) * 255)];
  if (color.type === 'hsla') {
    type += 'a';
    rgb.push(values[3]);
  }
  return recomposeColor({
    type,
    values: rgb
  });
}
/**
 * The relative brightness of any point in a color space,
 * normalized to 0 for darkest black and 1 for lightest white.
 *
 * Formula: https://www.w3.org/TR/WCAG20-TECHS/G17.html#G17-tests
 * @param {string} color - CSS color, i.e. one of: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color()
 * @returns {number} The relative brightness of the color in the range 0 - 1
 */
function getLuminance(color) {
  color = decomposeColor(color);
  let rgb = color.type === 'hsl' || color.type === 'hsla' ? decomposeColor(hslToRgb(color)).values : color.values;
  rgb = rgb.map(val => {
    if (color.type !== 'color') {
      val /= 255; // normalized
    }

    return val <= 0.03928 ? val / 12.92 : ((val + 0.055) / 1.055) ** 2.4;
  });

  // Truncate at 3 digits
  return Number((0.2126 * rgb[0] + 0.7152 * rgb[1] + 0.0722 * rgb[2]).toFixed(3));
}

/**
 * Calculates the contrast ratio between two colors.
 *
 * Formula: https://www.w3.org/TR/WCAG20-TECHS/G17.html#G17-tests
 * @param {string} foreground - CSS color, i.e. one of: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla()
 * @param {string} background - CSS color, i.e. one of: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla()
 * @returns {number} A contrast ratio value in the range 0 - 21.
 */
function getContrastRatio(foreground, background) {
  const lumA = getLuminance(foreground);
  const lumB = getLuminance(background);
  return (Math.max(lumA, lumB) + 0.05) / (Math.min(lumA, lumB) + 0.05);
}

/**
 * Sets the absolute transparency of a color.
 * Any existing alpha values are overwritten.
 * @param {string} color - CSS color, i.e. one of: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color()
 * @param {number} value - value to set the alpha channel to in the range 0 - 1
 * @returns {string} A CSS color string. Hex input values are returned as rgb
 */
function alpha(color, value) {
  color = decomposeColor(color);
  value = clamp(value);
  if (color.type === 'rgb' || color.type === 'hsl') {
    color.type += 'a';
  }
  if (color.type === 'color') {
    color.values[3] = `/${value}`;
  } else {
    color.values[3] = value;
  }
  return recomposeColor(color);
}

/**
 * Darkens a color.
 * @param {string} color - CSS color, i.e. one of: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color()
 * @param {number} coefficient - multiplier in the range 0 - 1
 * @returns {string} A CSS color string. Hex input values are returned as rgb
 */
function darken(color, coefficient) {
  color = decomposeColor(color);
  coefficient = clamp(coefficient);
  if (color.type.indexOf('hsl') !== -1) {
    color.values[2] *= 1 - coefficient;
  } else if (color.type.indexOf('rgb') !== -1 || color.type.indexOf('color') !== -1) {
    for (let i = 0; i < 3; i += 1) {
      color.values[i] *= 1 - coefficient;
    }
  }
  return recomposeColor(color);
}

/**
 * Lightens a color.
 * @param {string} color - CSS color, i.e. one of: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color()
 * @param {number} coefficient - multiplier in the range 0 - 1
 * @returns {string} A CSS color string. Hex input values are returned as rgb
 */
function lighten(color, coefficient) {
  color = decomposeColor(color);
  coefficient = clamp(coefficient);
  if (color.type.indexOf('hsl') !== -1) {
    color.values[2] += (100 - color.values[2]) * coefficient;
  } else if (color.type.indexOf('rgb') !== -1) {
    for (let i = 0; i < 3; i += 1) {
      color.values[i] += (255 - color.values[i]) * coefficient;
    }
  } else if (color.type.indexOf('color') !== -1) {
    for (let i = 0; i < 3; i += 1) {
      color.values[i] += (1 - color.values[i]) * coefficient;
    }
  }
  return recomposeColor(color);
}

function createMixins(breakpoints, mixins) {
  return _extends({
    toolbar: {
      minHeight: 56,
      [breakpoints.up('xs')]: {
        '@media (orientation: landscape)': {
          minHeight: 48
        }
      },
      [breakpoints.up('sm')]: {
        minHeight: 64
      }
    }
  }, mixins);
}

const common = {
  black: '#000',
  white: '#fff'
};
var common$1 = common;

const grey = {
  50: '#fafafa',
  100: '#f5f5f5',
  200: '#eeeeee',
  300: '#e0e0e0',
  400: '#bdbdbd',
  500: '#9e9e9e',
  600: '#757575',
  700: '#616161',
  800: '#424242',
  900: '#212121',
  A100: '#f5f5f5',
  A200: '#eeeeee',
  A400: '#bdbdbd',
  A700: '#616161'
};
var grey$1 = grey;

const purple = {
  50: '#f3e5f5',
  100: '#e1bee7',
  200: '#ce93d8',
  300: '#ba68c8',
  400: '#ab47bc',
  500: '#9c27b0',
  600: '#8e24aa',
  700: '#7b1fa2',
  800: '#6a1b9a',
  900: '#4a148c',
  A100: '#ea80fc',
  A200: '#e040fb',
  A400: '#d500f9',
  A700: '#aa00ff'
};
var purple$1 = purple;

const red = {
  50: '#ffebee',
  100: '#ffcdd2',
  200: '#ef9a9a',
  300: '#e57373',
  400: '#ef5350',
  500: '#f44336',
  600: '#e53935',
  700: '#d32f2f',
  800: '#c62828',
  900: '#b71c1c',
  A100: '#ff8a80',
  A200: '#ff5252',
  A400: '#ff1744',
  A700: '#d50000'
};
var red$1 = red;

const orange = {
  50: '#fff3e0',
  100: '#ffe0b2',
  200: '#ffcc80',
  300: '#ffb74d',
  400: '#ffa726',
  500: '#ff9800',
  600: '#fb8c00',
  700: '#f57c00',
  800: '#ef6c00',
  900: '#e65100',
  A100: '#ffd180',
  A200: '#ffab40',
  A400: '#ff9100',
  A700: '#ff6d00'
};
var orange$1 = orange;

const blue = {
  50: '#e3f2fd',
  100: '#bbdefb',
  200: '#90caf9',
  300: '#64b5f6',
  400: '#42a5f5',
  500: '#2196f3',
  600: '#1e88e5',
  700: '#1976d2',
  800: '#1565c0',
  900: '#0d47a1',
  A100: '#82b1ff',
  A200: '#448aff',
  A400: '#2979ff',
  A700: '#2962ff'
};
var blue$1 = blue;

const lightBlue = {
  50: '#e1f5fe',
  100: '#b3e5fc',
  200: '#81d4fa',
  300: '#4fc3f7',
  400: '#29b6f6',
  500: '#03a9f4',
  600: '#039be5',
  700: '#0288d1',
  800: '#0277bd',
  900: '#01579b',
  A100: '#80d8ff',
  A200: '#40c4ff',
  A400: '#00b0ff',
  A700: '#0091ea'
};
var lightBlue$1 = lightBlue;

const green = {
  50: '#e8f5e9',
  100: '#c8e6c9',
  200: '#a5d6a7',
  300: '#81c784',
  400: '#66bb6a',
  500: '#4caf50',
  600: '#43a047',
  700: '#388e3c',
  800: '#2e7d32',
  900: '#1b5e20',
  A100: '#b9f6ca',
  A200: '#69f0ae',
  A400: '#00e676',
  A700: '#00c853'
};
var green$1 = green;

const _excluded$4 = ["mode", "contrastThreshold", "tonalOffset"];
const light = {
  // The colors used to style the text.
  text: {
    // The most important text.
    primary: 'rgba(0, 0, 0, 0.87)',
    // Secondary text.
    secondary: 'rgba(0, 0, 0, 0.6)',
    // Disabled text have even lower visual prominence.
    disabled: 'rgba(0, 0, 0, 0.38)'
  },
  // The color used to divide different elements.
  divider: 'rgba(0, 0, 0, 0.12)',
  // The background colors used to style the surfaces.
  // Consistency between these values is important.
  background: {
    paper: common$1.white,
    default: common$1.white
  },
  // The colors used to style the action elements.
  action: {
    // The color of an active action like an icon button.
    active: 'rgba(0, 0, 0, 0.54)',
    // The color of an hovered action.
    hover: 'rgba(0, 0, 0, 0.04)',
    hoverOpacity: 0.04,
    // The color of a selected action.
    selected: 'rgba(0, 0, 0, 0.08)',
    selectedOpacity: 0.08,
    // The color of a disabled action.
    disabled: 'rgba(0, 0, 0, 0.26)',
    // The background color of a disabled action.
    disabledBackground: 'rgba(0, 0, 0, 0.12)',
    disabledOpacity: 0.38,
    focus: 'rgba(0, 0, 0, 0.12)',
    focusOpacity: 0.12,
    activatedOpacity: 0.12
  }
};
const dark = {
  text: {
    primary: common$1.white,
    secondary: 'rgba(255, 255, 255, 0.7)',
    disabled: 'rgba(255, 255, 255, 0.5)',
    icon: 'rgba(255, 255, 255, 0.5)'
  },
  divider: 'rgba(255, 255, 255, 0.12)',
  background: {
    paper: '#121212',
    default: '#121212'
  },
  action: {
    active: common$1.white,
    hover: 'rgba(255, 255, 255, 0.08)',
    hoverOpacity: 0.08,
    selected: 'rgba(255, 255, 255, 0.16)',
    selectedOpacity: 0.16,
    disabled: 'rgba(255, 255, 255, 0.3)',
    disabledBackground: 'rgba(255, 255, 255, 0.12)',
    disabledOpacity: 0.38,
    focus: 'rgba(255, 255, 255, 0.12)',
    focusOpacity: 0.12,
    activatedOpacity: 0.24
  }
};
function addLightOrDark(intent, direction, shade, tonalOffset) {
  const tonalOffsetLight = tonalOffset.light || tonalOffset;
  const tonalOffsetDark = tonalOffset.dark || tonalOffset * 1.5;
  if (!intent[direction]) {
    if (intent.hasOwnProperty(shade)) {
      intent[direction] = intent[shade];
    } else if (direction === 'light') {
      intent.light = lighten(intent.main, tonalOffsetLight);
    } else if (direction === 'dark') {
      intent.dark = darken(intent.main, tonalOffsetDark);
    }
  }
}
function getDefaultPrimary(mode = 'light') {
  if (mode === 'dark') {
    return {
      main: blue$1[200],
      light: blue$1[50],
      dark: blue$1[400]
    };
  }
  return {
    main: blue$1[700],
    light: blue$1[400],
    dark: blue$1[800]
  };
}
function getDefaultSecondary(mode = 'light') {
  if (mode === 'dark') {
    return {
      main: purple$1[200],
      light: purple$1[50],
      dark: purple$1[400]
    };
  }
  return {
    main: purple$1[500],
    light: purple$1[300],
    dark: purple$1[700]
  };
}
function getDefaultError(mode = 'light') {
  if (mode === 'dark') {
    return {
      main: red$1[500],
      light: red$1[300],
      dark: red$1[700]
    };
  }
  return {
    main: red$1[700],
    light: red$1[400],
    dark: red$1[800]
  };
}
function getDefaultInfo(mode = 'light') {
  if (mode === 'dark') {
    return {
      main: lightBlue$1[400],
      light: lightBlue$1[300],
      dark: lightBlue$1[700]
    };
  }
  return {
    main: lightBlue$1[700],
    light: lightBlue$1[500],
    dark: lightBlue$1[900]
  };
}
function getDefaultSuccess(mode = 'light') {
  if (mode === 'dark') {
    return {
      main: green$1[400],
      light: green$1[300],
      dark: green$1[700]
    };
  }
  return {
    main: green$1[800],
    light: green$1[500],
    dark: green$1[900]
  };
}
function getDefaultWarning(mode = 'light') {
  if (mode === 'dark') {
    return {
      main: orange$1[400],
      light: orange$1[300],
      dark: orange$1[700]
    };
  }
  return {
    main: '#ed6c02',
    // closest to orange[800] that pass 3:1.
    light: orange$1[500],
    dark: orange$1[900]
  };
}
function createPalette(palette) {
  const {
      mode = 'light',
      contrastThreshold = 3,
      tonalOffset = 0.2
    } = palette,
    other = _objectWithoutPropertiesLoose(palette, _excluded$4);
  const primary = palette.primary || getDefaultPrimary(mode);
  const secondary = palette.secondary || getDefaultSecondary(mode);
  const error = palette.error || getDefaultError(mode);
  const info = palette.info || getDefaultInfo(mode);
  const success = palette.success || getDefaultSuccess(mode);
  const warning = palette.warning || getDefaultWarning(mode);

  // Use the same logic as
  // Bootstrap: https://github.com/twbs/bootstrap/blob/1d6e3710dd447de1a200f29e8fa521f8a0908f70/scss/_functions.scss#L59
  // and material-components-web https://github.com/material-components/material-components-web/blob/ac46b8863c4dab9fc22c4c662dc6bd1b65dd652f/packages/mdc-theme/_functions.scss#L54
  function getContrastText(background) {
    const contrastText = getContrastRatio(background, dark.text.primary) >= contrastThreshold ? dark.text.primary : light.text.primary;
    if (process.env.NODE_ENV !== 'production') {
      const contrast = getContrastRatio(background, contrastText);
      if (contrast < 3) {
        console.error([`MUI: The contrast ratio of ${contrast}:1 for ${contrastText} on ${background}`, 'falls below the WCAG recommended absolute minimum contrast ratio of 3:1.', 'https://www.w3.org/TR/2008/REC-WCAG20-20081211/#visual-audio-contrast-contrast'].join('\n'));
      }
    }
    return contrastText;
  }
  const augmentColor = ({
    color,
    name,
    mainShade = 500,
    lightShade = 300,
    darkShade = 700
  }) => {
    color = _extends({}, color);
    if (!color.main && color[mainShade]) {
      color.main = color[mainShade];
    }
    if (!color.hasOwnProperty('main')) {
      throw new Error(process.env.NODE_ENV !== "production" ? `MUI: The color${name ? ` (${name})` : ''} provided to augmentColor(color) is invalid.
The color object needs to have a \`main\` property or a \`${mainShade}\` property.` : formatMuiErrorMessage(11, name ? ` (${name})` : '', mainShade));
    }
    if (typeof color.main !== 'string') {
      throw new Error(process.env.NODE_ENV !== "production" ? `MUI: The color${name ? ` (${name})` : ''} provided to augmentColor(color) is invalid.
\`color.main\` should be a string, but \`${JSON.stringify(color.main)}\` was provided instead.

Did you intend to use one of the following approaches?

import { green } from "@mui/material/colors";

const theme1 = createTheme({ palette: {
  primary: green,
} });

const theme2 = createTheme({ palette: {
  primary: { main: green[500] },
} });` : formatMuiErrorMessage(12, name ? ` (${name})` : '', JSON.stringify(color.main)));
    }
    addLightOrDark(color, 'light', lightShade, tonalOffset);
    addLightOrDark(color, 'dark', darkShade, tonalOffset);
    if (!color.contrastText) {
      color.contrastText = getContrastText(color.main);
    }
    return color;
  };
  const modes = {
    dark,
    light
  };
  if (process.env.NODE_ENV !== 'production') {
    if (!modes[mode]) {
      console.error(`MUI: The palette mode \`${mode}\` is not supported.`);
    }
  }
  const paletteOutput = deepmerge(_extends({
    // A collection of common colors.
    common: _extends({}, common$1),
    // prevent mutable object.
    // The palette mode, can be light or dark.
    mode,
    // The colors used to represent primary interface elements for a user.
    primary: augmentColor({
      color: primary,
      name: 'primary'
    }),
    // The colors used to represent secondary interface elements for a user.
    secondary: augmentColor({
      color: secondary,
      name: 'secondary',
      mainShade: 'A400',
      lightShade: 'A200',
      darkShade: 'A700'
    }),
    // The colors used to represent interface elements that the user should be made aware of.
    error: augmentColor({
      color: error,
      name: 'error'
    }),
    // The colors used to represent potentially dangerous actions or important messages.
    warning: augmentColor({
      color: warning,
      name: 'warning'
    }),
    // The colors used to present information to the user that is neutral and not necessarily important.
    info: augmentColor({
      color: info,
      name: 'info'
    }),
    // The colors used to indicate the successful completion of an action that user triggered.
    success: augmentColor({
      color: success,
      name: 'success'
    }),
    // The grey colors.
    grey: grey$1,
    // Used by `getContrastText()` to maximize the contrast between
    // the background and the text.
    contrastThreshold,
    // Takes a background color and returns the text color that maximizes the contrast.
    getContrastText,
    // Generate a rich color object.
    augmentColor,
    // Used by the functions below to shift a color's luminance by approximately
    // two indexes within its tonal palette.
    // E.g., shift from Red 500 to Red 300 or Red 700.
    tonalOffset
  }, modes[mode]), other);
  return paletteOutput;
}

const _excluded$3 = ["fontFamily", "fontSize", "fontWeightLight", "fontWeightRegular", "fontWeightMedium", "fontWeightBold", "htmlFontSize", "allVariants", "pxToRem"];
function round(value) {
  return Math.round(value * 1e5) / 1e5;
}
const caseAllCaps = {
  textTransform: 'uppercase'
};
const defaultFontFamily = '"Roboto", "Helvetica", "Arial", sans-serif';

/**
 * @see @link{https://m2.material.io/design/typography/the-type-system.html}
 * @see @link{https://m2.material.io/design/typography/understanding-typography.html}
 */
function createTypography(palette, typography) {
  const _ref = typeof typography === 'function' ? typography(palette) : typography,
    {
      fontFamily = defaultFontFamily,
      // The default font size of the Material Specification.
      fontSize = 14,
      // px
      fontWeightLight = 300,
      fontWeightRegular = 400,
      fontWeightMedium = 500,
      fontWeightBold = 700,
      // Tell MUI what's the font-size on the html element.
      // 16px is the default font-size used by browsers.
      htmlFontSize = 16,
      // Apply the CSS properties to all the variants.
      allVariants,
      pxToRem: pxToRem2
    } = _ref,
    other = _objectWithoutPropertiesLoose(_ref, _excluded$3);
  if (process.env.NODE_ENV !== 'production') {
    if (typeof fontSize !== 'number') {
      console.error('MUI: `fontSize` is required to be a number.');
    }
    if (typeof htmlFontSize !== 'number') {
      console.error('MUI: `htmlFontSize` is required to be a number.');
    }
  }
  const coef = fontSize / 14;
  const pxToRem = pxToRem2 || (size => `${size / htmlFontSize * coef}rem`);
  const buildVariant = (fontWeight, size, lineHeight, letterSpacing, casing) => _extends({
    fontFamily,
    fontWeight,
    fontSize: pxToRem(size),
    // Unitless following https://meyerweb.com/eric/thoughts/2006/02/08/unitless-line-heights/
    lineHeight
  }, fontFamily === defaultFontFamily ? {
    letterSpacing: `${round(letterSpacing / size)}em`
  } : {}, casing, allVariants);
  const variants = {
    h1: buildVariant(fontWeightLight, 96, 1.167, -1.5),
    h2: buildVariant(fontWeightLight, 60, 1.2, -0.5),
    h3: buildVariant(fontWeightRegular, 48, 1.167, 0),
    h4: buildVariant(fontWeightRegular, 34, 1.235, 0.25),
    h5: buildVariant(fontWeightRegular, 24, 1.334, 0),
    h6: buildVariant(fontWeightMedium, 20, 1.6, 0.15),
    subtitle1: buildVariant(fontWeightRegular, 16, 1.75, 0.15),
    subtitle2: buildVariant(fontWeightMedium, 14, 1.57, 0.1),
    body1: buildVariant(fontWeightRegular, 16, 1.5, 0.15),
    body2: buildVariant(fontWeightRegular, 14, 1.43, 0.15),
    button: buildVariant(fontWeightMedium, 14, 1.75, 0.4, caseAllCaps),
    caption: buildVariant(fontWeightRegular, 12, 1.66, 0.4),
    overline: buildVariant(fontWeightRegular, 12, 2.66, 1, caseAllCaps),
    inherit: {
      fontFamily: 'inherit',
      fontWeight: 'inherit',
      fontSize: 'inherit',
      lineHeight: 'inherit',
      letterSpacing: 'inherit'
    }
  };
  return deepmerge(_extends({
    htmlFontSize,
    pxToRem,
    fontFamily,
    fontSize,
    fontWeightLight,
    fontWeightRegular,
    fontWeightMedium,
    fontWeightBold
  }, variants), other, {
    clone: false // No need to clone deep
  });
}

const shadowKeyUmbraOpacity = 0.2;
const shadowKeyPenumbraOpacity = 0.14;
const shadowAmbientShadowOpacity = 0.12;
function createShadow(...px) {
  return [`${px[0]}px ${px[1]}px ${px[2]}px ${px[3]}px rgba(0,0,0,${shadowKeyUmbraOpacity})`, `${px[4]}px ${px[5]}px ${px[6]}px ${px[7]}px rgba(0,0,0,${shadowKeyPenumbraOpacity})`, `${px[8]}px ${px[9]}px ${px[10]}px ${px[11]}px rgba(0,0,0,${shadowAmbientShadowOpacity})`].join(',');
}

// Values from https://github.com/material-components/material-components-web/blob/be8747f94574669cb5e7add1a7c54fa41a89cec7/packages/mdc-elevation/_variables.scss
const shadows = ['none', createShadow(0, 2, 1, -1, 0, 1, 1, 0, 0, 1, 3, 0), createShadow(0, 3, 1, -2, 0, 2, 2, 0, 0, 1, 5, 0), createShadow(0, 3, 3, -2, 0, 3, 4, 0, 0, 1, 8, 0), createShadow(0, 2, 4, -1, 0, 4, 5, 0, 0, 1, 10, 0), createShadow(0, 3, 5, -1, 0, 5, 8, 0, 0, 1, 14, 0), createShadow(0, 3, 5, -1, 0, 6, 10, 0, 0, 1, 18, 0), createShadow(0, 4, 5, -2, 0, 7, 10, 1, 0, 2, 16, 1), createShadow(0, 5, 5, -3, 0, 8, 10, 1, 0, 3, 14, 2), createShadow(0, 5, 6, -3, 0, 9, 12, 1, 0, 3, 16, 2), createShadow(0, 6, 6, -3, 0, 10, 14, 1, 0, 4, 18, 3), createShadow(0, 6, 7, -4, 0, 11, 15, 1, 0, 4, 20, 3), createShadow(0, 7, 8, -4, 0, 12, 17, 2, 0, 5, 22, 4), createShadow(0, 7, 8, -4, 0, 13, 19, 2, 0, 5, 24, 4), createShadow(0, 7, 9, -4, 0, 14, 21, 2, 0, 5, 26, 4), createShadow(0, 8, 9, -5, 0, 15, 22, 2, 0, 6, 28, 5), createShadow(0, 8, 10, -5, 0, 16, 24, 2, 0, 6, 30, 5), createShadow(0, 8, 11, -5, 0, 17, 26, 2, 0, 6, 32, 5), createShadow(0, 9, 11, -5, 0, 18, 28, 2, 0, 7, 34, 6), createShadow(0, 9, 12, -6, 0, 19, 29, 2, 0, 7, 36, 6), createShadow(0, 10, 13, -6, 0, 20, 31, 3, 0, 8, 38, 7), createShadow(0, 10, 13, -6, 0, 21, 33, 3, 0, 8, 40, 7), createShadow(0, 10, 14, -6, 0, 22, 35, 3, 0, 8, 42, 7), createShadow(0, 11, 14, -7, 0, 23, 36, 3, 0, 9, 44, 8), createShadow(0, 11, 15, -7, 0, 24, 38, 3, 0, 9, 46, 8)];
var shadows$1 = shadows;

const _excluded$2 = ["duration", "easing", "delay"];
// Follow https://material.google.com/motion/duration-easing.html#duration-easing-natural-easing-curves
// to learn the context in which each easing should be used.
const easing = {
  // This is the most common easing curve.
  easeInOut: 'cubic-bezier(0.4, 0, 0.2, 1)',
  // Objects enter the screen at full velocity from off-screen and
  // slowly decelerate to a resting point.
  easeOut: 'cubic-bezier(0.0, 0, 0.2, 1)',
  // Objects leave the screen at full velocity. They do not decelerate when off-screen.
  easeIn: 'cubic-bezier(0.4, 0, 1, 1)',
  // The sharp curve is used by objects that may return to the screen at any time.
  sharp: 'cubic-bezier(0.4, 0, 0.6, 1)'
};

// Follow https://m2.material.io/guidelines/motion/duration-easing.html#duration-easing-common-durations
// to learn when use what timing
const duration = {
  shortest: 150,
  shorter: 200,
  short: 250,
  // most basic recommended timing
  standard: 300,
  // this is to be used in complex animations
  complex: 375,
  // recommended when something is entering screen
  enteringScreen: 225,
  // recommended when something is leaving screen
  leavingScreen: 195
};
function formatMs(milliseconds) {
  return `${Math.round(milliseconds)}ms`;
}
function getAutoHeightDuration(height) {
  if (!height) {
    return 0;
  }
  const constant = height / 36;

  // https://www.wolframalpha.com/input/?i=(4+%2B+15+*+(x+%2F+36+)+**+0.25+%2B+(x+%2F+36)+%2F+5)+*+10
  return Math.round((4 + 15 * constant ** 0.25 + constant / 5) * 10);
}
function createTransitions(inputTransitions) {
  const mergedEasing = _extends({}, easing, inputTransitions.easing);
  const mergedDuration = _extends({}, duration, inputTransitions.duration);
  const create = (props = ['all'], options = {}) => {
    const {
        duration: durationOption = mergedDuration.standard,
        easing: easingOption = mergedEasing.easeInOut,
        delay = 0
      } = options,
      other = _objectWithoutPropertiesLoose(options, _excluded$2);
    if (process.env.NODE_ENV !== 'production') {
      const isString = value => typeof value === 'string';
      // IE11 support, replace with Number.isNaN
      // eslint-disable-next-line no-restricted-globals
      const isNumber = value => !isNaN(parseFloat(value));
      if (!isString(props) && !Array.isArray(props)) {
        console.error('MUI: Argument "props" must be a string or Array.');
      }
      if (!isNumber(durationOption) && !isString(durationOption)) {
        console.error(`MUI: Argument "duration" must be a number or a string but found ${durationOption}.`);
      }
      if (!isString(easingOption)) {
        console.error('MUI: Argument "easing" must be a string.');
      }
      if (!isNumber(delay) && !isString(delay)) {
        console.error('MUI: Argument "delay" must be a number or a string.');
      }
      if (Object.keys(other).length !== 0) {
        console.error(`MUI: Unrecognized argument(s) [${Object.keys(other).join(',')}].`);
      }
    }
    return (Array.isArray(props) ? props : [props]).map(animatedProp => `${animatedProp} ${typeof durationOption === 'string' ? durationOption : formatMs(durationOption)} ${easingOption} ${typeof delay === 'string' ? delay : formatMs(delay)}`).join(',');
  };
  return _extends({
    getAutoHeightDuration,
    create
  }, inputTransitions, {
    easing: mergedEasing,
    duration: mergedDuration
  });
}

// We need to centralize the zIndex definitions as they work
// like global values in the browser.
const zIndex = {
  mobileStepper: 1000,
  fab: 1050,
  speedDial: 1050,
  appBar: 1100,
  drawer: 1200,
  modal: 1300,
  snackbar: 1400,
  tooltip: 1500
};
var zIndex$1 = zIndex;

const _excluded$1 = ["breakpoints", "mixins", "spacing", "palette", "transitions", "typography", "shape"];
function createTheme(options = {}, ...args) {
  const {
      mixins: mixinsInput = {},
      palette: paletteInput = {},
      transitions: transitionsInput = {},
      typography: typographyInput = {}
    } = options,
    other = _objectWithoutPropertiesLoose(options, _excluded$1);
  if (options.vars) {
    throw new Error(process.env.NODE_ENV !== "production" ? `MUI: \`vars\` is a private field used for CSS variables support.
Please use another name.` : formatMuiErrorMessage(18));
  }
  const palette = createPalette(paletteInput);
  const systemTheme = createTheme$1(options);
  let muiTheme = deepmerge(systemTheme, {
    mixins: createMixins(systemTheme.breakpoints, mixinsInput),
    palette,
    // Don't use [...shadows] until you've verified its transpiled code is not invoking the iterator protocol.
    shadows: shadows$1.slice(),
    typography: createTypography(palette, typographyInput),
    transitions: createTransitions(transitionsInput),
    zIndex: _extends({}, zIndex$1)
  });
  muiTheme = deepmerge(muiTheme, other);
  muiTheme = args.reduce((acc, argument) => deepmerge(acc, argument), muiTheme);
  if (process.env.NODE_ENV !== 'production') {
    // TODO v6: Refactor to use globalStateClassesMapping from @mui/utils once `readOnly` state class is used in Rating component.
    const stateClasses = ['active', 'checked', 'completed', 'disabled', 'error', 'expanded', 'focused', 'focusVisible', 'required', 'selected'];
    const traverse = (node, component) => {
      let key;

      // eslint-disable-next-line guard-for-in, no-restricted-syntax
      for (key in node) {
        const child = node[key];
        if (stateClasses.indexOf(key) !== -1 && Object.keys(child).length > 0) {
          if (process.env.NODE_ENV !== 'production') {
            const stateClass = generateUtilityClass('', key);
            console.error([`MUI: The \`${component}\` component increases ` + `the CSS specificity of the \`${key}\` internal state.`, 'You can not override it like this: ', JSON.stringify(node, null, 2), '', `Instead, you need to use the '&.${stateClass}' syntax:`, JSON.stringify({
              root: {
                [`&.${stateClass}`]: child
              }
            }, null, 2), '', 'https://mui.com/r/state-classes-guide'].join('\n'));
          }
          // Remove the style to prevent global conflicts.
          node[key] = {};
        }
      }
    };
    Object.keys(muiTheme.components).forEach(component => {
      const styleOverrides = muiTheme.components[component].styleOverrides;
      if (styleOverrides && component.indexOf('Mui') === 0) {
        traverse(styleOverrides, component);
      }
    });
  }
  muiTheme.unstable_sxConfig = _extends({}, defaultSxConfig$1, other == null ? void 0 : other.unstable_sxConfig);
  muiTheme.unstable_sx = function sx(props) {
    return styleFunctionSx$1({
      sx: props,
      theme: this
    });
  };
  return muiTheme;
}

const defaultTheme = createTheme();
var defaultTheme$1 = defaultTheme;

var THEME_ID = '$$material';

function useThemeProps({
  props,
  name
}) {
  return useThemeProps$1({
    props,
    name,
    defaultTheme: defaultTheme$1,
    themeId: THEME_ID
  });
}

const rootShouldForwardProp = prop => shouldForwardProp(prop) && prop !== 'classes';
const slotShouldForwardProp = shouldForwardProp;
const styled = createStyled({
  themeId: THEME_ID,
  defaultTheme: defaultTheme$1,
  rootShouldForwardProp
});
var styled$1 = styled;

function useTheme() {
  const theme = useTheme$1(defaultTheme$1);
  if (process.env.NODE_ENV !== 'production') {
    // eslint-disable-next-line react-hooks/rules-of-hooks
    React$1.useDebugValue(theme);
  }
  return theme[THEME_ID] || theme;
}

const shouldSpreadAdditionalProps = Slot => {
  return !Slot || !isHostComponent(Slot);
};
var shouldSpreadAdditionalProps$1 = shouldSpreadAdditionalProps;

function getSliderUtilityClass(slot) {
  return generateUtilityClass('MuiSlider', slot);
}
const sliderClasses = generateUtilityClasses('MuiSlider', ['root', 'active', 'colorPrimary', 'colorSecondary', 'disabled', 'dragging', 'focusVisible', 'mark', 'markActive', 'marked', 'markLabel', 'markLabelActive', 'rail', 'sizeSmall', 'thumb', 'thumbColorPrimary', 'thumbColorSecondary', 'track', 'trackInverted', 'trackFalse', 'thumbSizeSmall', 'valueLabel', 'valueLabelOpen', 'valueLabelCircle', 'valueLabelLabel', 'vertical']);
var sliderClasses$1 = sliderClasses;

const useValueLabelClasses = props => {
  const {
    open
  } = props;
  const utilityClasses = {
    offset: clsx(open && sliderClasses$1.valueLabelOpen),
    circle: sliderClasses$1.valueLabelCircle,
    label: sliderClasses$1.valueLabelLabel
  };
  return utilityClasses;
};

/**
 * @ignore - internal component.
 */
function SliderValueLabel(props) {
  const {
    children,
    className,
    value
  } = props;
  const classes = useValueLabelClasses(props);
  if (!children) {
    return null;
  }
  return /*#__PURE__*/React$1.cloneElement(children, {
    className: clsx(children.props.className)
  }, /*#__PURE__*/jsxs(React$1.Fragment, {
    children: [children.props.children, /*#__PURE__*/jsx("span", {
      className: clsx(classes.offset, className),
      "aria-hidden": true,
      children: /*#__PURE__*/jsx("span", {
        className: classes.circle,
        children: /*#__PURE__*/jsx("span", {
          className: classes.label,
          children: value
        })
      })
    })]
  }));
}
process.env.NODE_ENV !== "production" ? SliderValueLabel.propTypes = {
  children: PropTypes.element.isRequired,
  className: PropTypes.string,
  value: PropTypes.node
} : void 0;

const _excluded = ["aria-label", "aria-valuetext", "aria-labelledby", "component", "components", "componentsProps", "color", "classes", "className", "disableSwap", "disabled", "getAriaLabel", "getAriaValueText", "marks", "max", "min", "name", "onChange", "onChangeCommitted", "orientation", "size", "step", "scale", "slotProps", "slots", "tabIndex", "track", "value", "valueLabelDisplay", "valueLabelFormat"];
function Identity(x) {
  return x;
}
const SliderRoot = styled$1('span', {
  name: 'MuiSlider',
  slot: 'Root',
  overridesResolver: (props, styles) => {
    const {
      ownerState
    } = props;
    return [styles.root, styles[`color${capitalize(ownerState.color)}`], ownerState.size !== 'medium' && styles[`size${capitalize(ownerState.size)}`], ownerState.marked && styles.marked, ownerState.orientation === 'vertical' && styles.vertical, ownerState.track === 'inverted' && styles.trackInverted, ownerState.track === false && styles.trackFalse];
  }
})(({
  theme,
  ownerState
}) => _extends({
  borderRadius: 12,
  boxSizing: 'content-box',
  display: 'inline-block',
  position: 'relative',
  cursor: 'pointer',
  touchAction: 'none',
  color: (theme.vars || theme).palette[ownerState.color].main,
  WebkitTapHighlightColor: 'transparent'
}, ownerState.orientation === 'horizontal' && _extends({
  height: 4,
  width: '100%',
  padding: '13px 0',
  // The primary input mechanism of the device includes a pointing device of limited accuracy.
  '@media (pointer: coarse)': {
    // Reach 42px touch target, about ~8mm on screen.
    padding: '20px 0'
  }
}, ownerState.size === 'small' && {
  height: 2
}, ownerState.marked && {
  marginBottom: 20
}), ownerState.orientation === 'vertical' && _extends({
  height: '100%',
  width: 4,
  padding: '0 13px',
  // The primary input mechanism of the device includes a pointing device of limited accuracy.
  '@media (pointer: coarse)': {
    // Reach 42px touch target, about ~8mm on screen.
    padding: '0 20px'
  }
}, ownerState.size === 'small' && {
  width: 2
}, ownerState.marked && {
  marginRight: 44
}), {
  '@media print': {
    colorAdjust: 'exact'
  },
  [`&.${sliderClasses$1.disabled}`]: {
    pointerEvents: 'none',
    cursor: 'default',
    color: (theme.vars || theme).palette.grey[400]
  },
  [`&.${sliderClasses$1.dragging}`]: {
    [`& .${sliderClasses$1.thumb}, & .${sliderClasses$1.track}`]: {
      transition: 'none'
    }
  }
}));
process.env.NODE_ENV !== "production" ? SliderRoot.propTypes /* remove-proptypes */ = {
  // ----------------------------- Warning --------------------------------
  // | These PropTypes are generated from the TypeScript type definitions |
  // |     To update them edit the d.ts file and run "yarn proptypes"     |
  // ----------------------------------------------------------------------
  /**
   * @ignore
   */
  children: PropTypes.node
} : void 0;
const SliderRail = styled$1('span', {
  name: 'MuiSlider',
  slot: 'Rail',
  overridesResolver: (props, styles) => styles.rail
})(({
  ownerState
}) => _extends({
  display: 'block',
  position: 'absolute',
  borderRadius: 'inherit',
  backgroundColor: 'currentColor',
  opacity: 0.38
}, ownerState.orientation === 'horizontal' && {
  width: '100%',
  height: 'inherit',
  top: '50%',
  transform: 'translateY(-50%)'
}, ownerState.orientation === 'vertical' && {
  height: '100%',
  width: 'inherit',
  left: '50%',
  transform: 'translateX(-50%)'
}, ownerState.track === 'inverted' && {
  opacity: 1
}));
process.env.NODE_ENV !== "production" ? SliderRail.propTypes /* remove-proptypes */ = {
  // ----------------------------- Warning --------------------------------
  // | These PropTypes are generated from the TypeScript type definitions |
  // |     To update them edit the d.ts file and run "yarn proptypes"     |
  // ----------------------------------------------------------------------
  /**
   * @ignore
   */
  children: PropTypes.node
} : void 0;
const SliderTrack = styled$1('span', {
  name: 'MuiSlider',
  slot: 'Track',
  overridesResolver: (props, styles) => styles.track
})(({
  theme,
  ownerState
}) => {
  const color =
  // Same logic as the LinearProgress track color
  theme.palette.mode === 'light' ? lighten(theme.palette[ownerState.color].main, 0.62) : darken(theme.palette[ownerState.color].main, 0.5);
  return _extends({
    display: 'block',
    position: 'absolute',
    borderRadius: 'inherit',
    border: '1px solid currentColor',
    backgroundColor: 'currentColor',
    transition: theme.transitions.create(['left', 'width', 'bottom', 'height'], {
      duration: theme.transitions.duration.shortest
    })
  }, ownerState.size === 'small' && {
    border: 'none'
  }, ownerState.orientation === 'horizontal' && {
    height: 'inherit',
    top: '50%',
    transform: 'translateY(-50%)'
  }, ownerState.orientation === 'vertical' && {
    width: 'inherit',
    left: '50%',
    transform: 'translateX(-50%)'
  }, ownerState.track === false && {
    display: 'none'
  }, ownerState.track === 'inverted' && {
    backgroundColor: theme.vars ? theme.vars.palette.Slider[`${ownerState.color}Track`] : color,
    borderColor: theme.vars ? theme.vars.palette.Slider[`${ownerState.color}Track`] : color
  });
});
process.env.NODE_ENV !== "production" ? SliderTrack.propTypes /* remove-proptypes */ = {
  // ----------------------------- Warning --------------------------------
  // | These PropTypes are generated from the TypeScript type definitions |
  // |     To update them edit the d.ts file and run "yarn proptypes"     |
  // ----------------------------------------------------------------------
  /**
   * @ignore
   */
  children: PropTypes.node
} : void 0;
const SliderThumb = styled$1('span', {
  name: 'MuiSlider',
  slot: 'Thumb',
  overridesResolver: (props, styles) => {
    const {
      ownerState
    } = props;
    return [styles.thumb, styles[`thumbColor${capitalize(ownerState.color)}`], ownerState.size !== 'medium' && styles[`thumbSize${capitalize(ownerState.size)}`]];
  }
})(({
  theme,
  ownerState
}) => _extends({
  position: 'absolute',
  width: 20,
  height: 20,
  boxSizing: 'border-box',
  borderRadius: '50%',
  outline: 0,
  backgroundColor: 'currentColor',
  display: 'flex',
  alignItems: 'center',
  justifyContent: 'center',
  transition: theme.transitions.create(['box-shadow', 'left', 'bottom'], {
    duration: theme.transitions.duration.shortest
  })
}, ownerState.size === 'small' && {
  width: 12,
  height: 12
}, ownerState.orientation === 'horizontal' && {
  top: '50%',
  transform: 'translate(-50%, -50%)'
}, ownerState.orientation === 'vertical' && {
  left: '50%',
  transform: 'translate(-50%, 50%)'
}, {
  '&:before': _extends({
    position: 'absolute',
    content: '""',
    borderRadius: 'inherit',
    width: '100%',
    height: '100%',
    boxShadow: (theme.vars || theme).shadows[2]
  }, ownerState.size === 'small' && {
    boxShadow: 'none'
  }),
  '&::after': {
    position: 'absolute',
    content: '""',
    borderRadius: '50%',
    // 42px is the hit target
    width: 42,
    height: 42,
    top: '50%',
    left: '50%',
    transform: 'translate(-50%, -50%)'
  },
  [`&:hover, &.${sliderClasses$1.focusVisible}`]: {
    boxShadow: `0px 0px 0px 8px ${theme.vars ? `rgba(${theme.vars.palette[ownerState.color].mainChannel} / 0.16)` : alpha(theme.palette[ownerState.color].main, 0.16)}`,
    '@media (hover: none)': {
      boxShadow: 'none'
    }
  },
  [`&.${sliderClasses$1.active}`]: {
    boxShadow: `0px 0px 0px 14px ${theme.vars ? `rgba(${theme.vars.palette[ownerState.color].mainChannel} / 0.16)` : alpha(theme.palette[ownerState.color].main, 0.16)}`
  },
  [`&.${sliderClasses$1.disabled}`]: {
    '&:hover': {
      boxShadow: 'none'
    }
  }
}));
process.env.NODE_ENV !== "production" ? SliderThumb.propTypes /* remove-proptypes */ = {
  // ----------------------------- Warning --------------------------------
  // | These PropTypes are generated from the TypeScript type definitions |
  // |     To update them edit the d.ts file and run "yarn proptypes"     |
  // ----------------------------------------------------------------------
  /**
   * @ignore
   */
  children: PropTypes.node
} : void 0;
const StyledSliderValueLabel = styled$1(SliderValueLabel, {
  name: 'MuiSlider',
  slot: 'ValueLabel',
  overridesResolver: (props, styles) => styles.valueLabel
})(({
  theme,
  ownerState
}) => _extends({
  [`&.${sliderClasses$1.valueLabelOpen}`]: {
    transform: `${ownerState.orientation === 'vertical' ? 'translateY(-50%)' : 'translateY(-100%)'} scale(1)`
  },
  zIndex: 1,
  whiteSpace: 'nowrap'
}, theme.typography.body2, {
  fontWeight: 500,
  transition: theme.transitions.create(['transform'], {
    duration: theme.transitions.duration.shortest
  }),
  transform: `${ownerState.orientation === 'vertical' ? 'translateY(-50%)' : 'translateY(-100%)'} scale(0)`,
  position: 'absolute',
  backgroundColor: (theme.vars || theme).palette.grey[600],
  borderRadius: 2,
  color: (theme.vars || theme).palette.common.white,
  display: 'flex',
  alignItems: 'center',
  justifyContent: 'center',
  padding: '0.25rem 0.75rem'
}, ownerState.orientation === 'horizontal' && {
  top: '-10px',
  transformOrigin: 'bottom center',
  '&:before': {
    position: 'absolute',
    content: '""',
    width: 8,
    height: 8,
    transform: 'translate(-50%, 50%) rotate(45deg)',
    backgroundColor: 'inherit',
    bottom: 0,
    left: '50%'
  }
}, ownerState.orientation === 'vertical' && {
  right: ownerState.size === 'small' ? '20px' : '30px',
  top: '50%',
  transformOrigin: 'right center',
  '&:before': {
    position: 'absolute',
    content: '""',
    width: 8,
    height: 8,
    transform: 'translate(-50%, -50%) rotate(45deg)',
    backgroundColor: 'inherit',
    right: '-20%',
    top: '50%'
  }
}, ownerState.size === 'small' && {
  fontSize: theme.typography.pxToRem(12),
  padding: '0.25rem 0.5rem'
}));
process.env.NODE_ENV !== "production" ? StyledSliderValueLabel.propTypes /* remove-proptypes */ = {
  // ----------------------------- Warning --------------------------------
  // | These PropTypes are generated from the TypeScript type definitions |
  // |     To update them edit the d.ts file and run "yarn proptypes"     |
  // ----------------------------------------------------------------------
  /**
   * @ignore
   */
  children: PropTypes.node
} : void 0;
const SliderMark = styled$1('span', {
  name: 'MuiSlider',
  slot: 'Mark',
  shouldForwardProp: prop => slotShouldForwardProp(prop) && prop !== 'markActive',
  overridesResolver: (props, styles) => {
    const {
      markActive
    } = props;
    return [styles.mark, markActive && styles.markActive];
  }
})(({
  theme,
  ownerState,
  markActive
}) => _extends({
  position: 'absolute',
  width: 2,
  height: 2,
  borderRadius: 1,
  backgroundColor: 'currentColor'
}, ownerState.orientation === 'horizontal' && {
  top: '50%',
  transform: 'translate(-1px, -50%)'
}, ownerState.orientation === 'vertical' && {
  left: '50%',
  transform: 'translate(-50%, 1px)'
}, markActive && {
  backgroundColor: (theme.vars || theme).palette.background.paper,
  opacity: 0.8
}));
process.env.NODE_ENV !== "production" ? SliderMark.propTypes /* remove-proptypes */ = {
  // ----------------------------- Warning --------------------------------
  // | These PropTypes are generated from the TypeScript type definitions |
  // |     To update them edit the d.ts file and run "yarn proptypes"     |
  // ----------------------------------------------------------------------
  /**
   * @ignore
   */
  children: PropTypes.node
} : void 0;
const SliderMarkLabel = styled$1('span', {
  name: 'MuiSlider',
  slot: 'MarkLabel',
  shouldForwardProp: prop => slotShouldForwardProp(prop) && prop !== 'markLabelActive',
  overridesResolver: (props, styles) => styles.markLabel
})(({
  theme,
  ownerState,
  markLabelActive
}) => _extends({}, theme.typography.body2, {
  color: (theme.vars || theme).palette.text.secondary,
  position: 'absolute',
  whiteSpace: 'nowrap'
}, ownerState.orientation === 'horizontal' && {
  top: 30,
  transform: 'translateX(-50%)',
  '@media (pointer: coarse)': {
    top: 40
  }
}, ownerState.orientation === 'vertical' && {
  left: 36,
  transform: 'translateY(50%)',
  '@media (pointer: coarse)': {
    left: 44
  }
}, markLabelActive && {
  color: (theme.vars || theme).palette.text.primary
}));
process.env.NODE_ENV !== "production" ? SliderMarkLabel.propTypes /* remove-proptypes */ = {
  // ----------------------------- Warning --------------------------------
  // | These PropTypes are generated from the TypeScript type definitions |
  // |     To update them edit the d.ts file and run "yarn proptypes"     |
  // ----------------------------------------------------------------------
  /**
   * @ignore
   */
  children: PropTypes.node
} : void 0;
const useUtilityClasses = ownerState => {
  const {
    disabled,
    dragging,
    marked,
    orientation,
    track,
    classes,
    color,
    size
  } = ownerState;
  const slots = {
    root: ['root', disabled && 'disabled', dragging && 'dragging', marked && 'marked', orientation === 'vertical' && 'vertical', track === 'inverted' && 'trackInverted', track === false && 'trackFalse', color && `color${capitalize(color)}`, size && `size${capitalize(size)}`],
    rail: ['rail'],
    track: ['track'],
    mark: ['mark'],
    markActive: ['markActive'],
    markLabel: ['markLabel'],
    markLabelActive: ['markLabelActive'],
    valueLabel: ['valueLabel'],
    thumb: ['thumb', disabled && 'disabled', size && `thumbSize${capitalize(size)}`, color && `thumbColor${capitalize(color)}`],
    active: ['active'],
    disabled: ['disabled'],
    focusVisible: ['focusVisible']
  };
  return composeClasses(slots, getSliderUtilityClass, classes);
};
const Forward = ({
  children
}) => children;
const Slider = /*#__PURE__*/React$1.forwardRef(function Slider(inputProps, ref) {
  var _ref, _slots$root, _ref2, _slots$rail, _ref3, _slots$track, _ref4, _slots$thumb, _ref5, _slots$valueLabel, _ref6, _slots$mark, _ref7, _slots$markLabel, _ref8, _slots$input, _slotProps$root, _slotProps$rail, _slotProps$track, _slotProps$thumb, _slotProps$valueLabel, _slotProps$mark, _slotProps$markLabel, _slotProps$input;
  const props = useThemeProps({
    props: inputProps,
    name: 'MuiSlider'
  });
  const theme = useTheme();
  const isRtl = theme.direction === 'rtl';
  const {
      'aria-label': ariaLabel,
      'aria-valuetext': ariaValuetext,
      'aria-labelledby': ariaLabelledby,
      // eslint-disable-next-line react/prop-types
      component = 'span',
      components = {},
      componentsProps = {},
      color = 'primary',
      classes: classesProp,
      className,
      disableSwap = false,
      disabled = false,
      getAriaLabel,
      getAriaValueText,
      marks: marksProp = false,
      max = 100,
      min = 0,
      orientation = 'horizontal',
      size = 'medium',
      step = 1,
      scale = Identity,
      slotProps,
      slots,
      track = 'normal',
      valueLabelDisplay = 'off',
      valueLabelFormat = Identity
    } = props,
    other = _objectWithoutPropertiesLoose(props, _excluded);
  const ownerState = _extends({}, props, {
    isRtl,
    max,
    min,
    classes: classesProp,
    disabled,
    disableSwap,
    orientation,
    marks: marksProp,
    color,
    size,
    step,
    scale,
    track,
    valueLabelDisplay,
    valueLabelFormat
  });
  const {
    axisProps,
    getRootProps,
    getHiddenInputProps,
    getThumbProps,
    open,
    active,
    axis,
    focusedThumbIndex,
    range,
    dragging,
    marks,
    values,
    trackOffset,
    trackLeap
  } = useSlider(_extends({}, ownerState, {
    rootRef: ref
  }));
  ownerState.marked = marks.length > 0 && marks.some(mark => mark.label);
  ownerState.dragging = dragging;
  ownerState.focusedThumbIndex = focusedThumbIndex;
  const classes = useUtilityClasses(ownerState);

  // support both `slots` and `components` for backward compatibility
  const RootSlot = (_ref = (_slots$root = slots == null ? void 0 : slots.root) != null ? _slots$root : components.Root) != null ? _ref : SliderRoot;
  const RailSlot = (_ref2 = (_slots$rail = slots == null ? void 0 : slots.rail) != null ? _slots$rail : components.Rail) != null ? _ref2 : SliderRail;
  const TrackSlot = (_ref3 = (_slots$track = slots == null ? void 0 : slots.track) != null ? _slots$track : components.Track) != null ? _ref3 : SliderTrack;
  const ThumbSlot = (_ref4 = (_slots$thumb = slots == null ? void 0 : slots.thumb) != null ? _slots$thumb : components.Thumb) != null ? _ref4 : SliderThumb;
  const ValueLabelSlot = (_ref5 = (_slots$valueLabel = slots == null ? void 0 : slots.valueLabel) != null ? _slots$valueLabel : components.ValueLabel) != null ? _ref5 : StyledSliderValueLabel;
  const MarkSlot = (_ref6 = (_slots$mark = slots == null ? void 0 : slots.mark) != null ? _slots$mark : components.Mark) != null ? _ref6 : SliderMark;
  const MarkLabelSlot = (_ref7 = (_slots$markLabel = slots == null ? void 0 : slots.markLabel) != null ? _slots$markLabel : components.MarkLabel) != null ? _ref7 : SliderMarkLabel;
  const InputSlot = (_ref8 = (_slots$input = slots == null ? void 0 : slots.input) != null ? _slots$input : components.Input) != null ? _ref8 : 'input';
  const rootSlotProps = (_slotProps$root = slotProps == null ? void 0 : slotProps.root) != null ? _slotProps$root : componentsProps.root;
  const railSlotProps = (_slotProps$rail = slotProps == null ? void 0 : slotProps.rail) != null ? _slotProps$rail : componentsProps.rail;
  const trackSlotProps = (_slotProps$track = slotProps == null ? void 0 : slotProps.track) != null ? _slotProps$track : componentsProps.track;
  const thumbSlotProps = (_slotProps$thumb = slotProps == null ? void 0 : slotProps.thumb) != null ? _slotProps$thumb : componentsProps.thumb;
  const valueLabelSlotProps = (_slotProps$valueLabel = slotProps == null ? void 0 : slotProps.valueLabel) != null ? _slotProps$valueLabel : componentsProps.valueLabel;
  const markSlotProps = (_slotProps$mark = slotProps == null ? void 0 : slotProps.mark) != null ? _slotProps$mark : componentsProps.mark;
  const markLabelSlotProps = (_slotProps$markLabel = slotProps == null ? void 0 : slotProps.markLabel) != null ? _slotProps$markLabel : componentsProps.markLabel;
  const inputSlotProps = (_slotProps$input = slotProps == null ? void 0 : slotProps.input) != null ? _slotProps$input : componentsProps.input;
  const rootProps = useSlotProps({
    elementType: RootSlot,
    getSlotProps: getRootProps,
    externalSlotProps: rootSlotProps,
    externalForwardedProps: other,
    additionalProps: _extends({}, shouldSpreadAdditionalProps$1(RootSlot) && {
      as: component
    }),
    ownerState: _extends({}, ownerState, rootSlotProps == null ? void 0 : rootSlotProps.ownerState),
    className: [classes.root, className]
  });
  const railProps = useSlotProps({
    elementType: RailSlot,
    externalSlotProps: railSlotProps,
    ownerState,
    className: classes.rail
  });
  const trackProps = useSlotProps({
    elementType: TrackSlot,
    externalSlotProps: trackSlotProps,
    additionalProps: {
      style: _extends({}, axisProps[axis].offset(trackOffset), axisProps[axis].leap(trackLeap))
    },
    ownerState: _extends({}, ownerState, trackSlotProps == null ? void 0 : trackSlotProps.ownerState),
    className: classes.track
  });
  const thumbProps = useSlotProps({
    elementType: ThumbSlot,
    getSlotProps: getThumbProps,
    externalSlotProps: thumbSlotProps,
    ownerState: _extends({}, ownerState, thumbSlotProps == null ? void 0 : thumbSlotProps.ownerState),
    className: classes.thumb
  });
  const valueLabelProps = useSlotProps({
    elementType: ValueLabelSlot,
    externalSlotProps: valueLabelSlotProps,
    ownerState: _extends({}, ownerState, valueLabelSlotProps == null ? void 0 : valueLabelSlotProps.ownerState),
    className: classes.valueLabel
  });
  const markProps = useSlotProps({
    elementType: MarkSlot,
    externalSlotProps: markSlotProps,
    ownerState,
    className: classes.mark
  });
  const markLabelProps = useSlotProps({
    elementType: MarkLabelSlot,
    externalSlotProps: markLabelSlotProps,
    ownerState,
    className: classes.markLabel
  });
  const inputSliderProps = useSlotProps({
    elementType: InputSlot,
    getSlotProps: getHiddenInputProps,
    externalSlotProps: inputSlotProps,
    ownerState
  });
  return /*#__PURE__*/jsxs(RootSlot, _extends({}, rootProps, {
    children: [/*#__PURE__*/jsx(RailSlot, _extends({}, railProps)), /*#__PURE__*/jsx(TrackSlot, _extends({}, trackProps)), marks.filter(mark => mark.value >= min && mark.value <= max).map((mark, index) => {
      const percent = valueToPercent(mark.value, min, max);
      const style = axisProps[axis].offset(percent);
      let markActive;
      if (track === false) {
        markActive = values.indexOf(mark.value) !== -1;
      } else {
        markActive = track === 'normal' && (range ? mark.value >= values[0] && mark.value <= values[values.length - 1] : mark.value <= values[0]) || track === 'inverted' && (range ? mark.value <= values[0] || mark.value >= values[values.length - 1] : mark.value >= values[0]);
      }
      return /*#__PURE__*/jsxs(React$1.Fragment, {
        children: [/*#__PURE__*/jsx(MarkSlot, _extends({
          "data-index": index
        }, markProps, !isHostComponent(MarkSlot) && {
          markActive
        }, {
          style: _extends({}, style, markProps.style),
          className: clsx(markProps.className, markActive && classes.markActive)
        })), mark.label != null ? /*#__PURE__*/jsx(MarkLabelSlot, _extends({
          "aria-hidden": true,
          "data-index": index
        }, markLabelProps, !isHostComponent(MarkLabelSlot) && {
          markLabelActive: markActive
        }, {
          style: _extends({}, style, markLabelProps.style),
          className: clsx(classes.markLabel, markLabelProps.className, markActive && classes.markLabelActive),
          children: mark.label
        })) : null]
      }, index);
    }), values.map((value, index) => {
      const percent = valueToPercent(value, min, max);
      const style = axisProps[axis].offset(percent);
      const ValueLabelComponent = valueLabelDisplay === 'off' ? Forward : ValueLabelSlot;
      return (
        /*#__PURE__*/
        /* TODO v6: Change component structure. It will help in avoiding the complicated React.cloneElement API added in SliderValueLabel component. Should be: Thumb -> Input, ValueLabel. Follow Joy UI's Slider structure. */
        jsx(ValueLabelComponent, _extends({}, !isHostComponent(ValueLabelComponent) && {
          valueLabelFormat,
          valueLabelDisplay,
          value: typeof valueLabelFormat === 'function' ? valueLabelFormat(scale(value), index) : valueLabelFormat,
          index,
          open: open === index || active === index || valueLabelDisplay === 'on',
          disabled
        }, valueLabelProps, {
          children: /*#__PURE__*/jsx(ThumbSlot, _extends({
            "data-index": index
          }, thumbProps, {
            className: clsx(classes.thumb, thumbProps.className, active === index && classes.active, focusedThumbIndex === index && classes.focusVisible),
            style: _extends({}, style, {
              pointerEvents: disableSwap && active !== index ? 'none' : undefined
            }, thumbProps.style),
            children: /*#__PURE__*/jsx(InputSlot, _extends({
              "data-index": index,
              "aria-label": getAriaLabel ? getAriaLabel(index) : ariaLabel,
              "aria-valuenow": scale(value),
              "aria-labelledby": ariaLabelledby,
              "aria-valuetext": getAriaValueText ? getAriaValueText(scale(value), index) : ariaValuetext,
              value: values[index]
            }, inputSliderProps))
          }))
        }), index)
      );
    })]
  }));
});
process.env.NODE_ENV !== "production" ? Slider.propTypes /* remove-proptypes */ = {
  // ----------------------------- Warning --------------------------------
  // | These PropTypes are generated from the TypeScript type definitions |
  // |     To update them edit the d.ts file and run "yarn proptypes"     |
  // ----------------------------------------------------------------------
  /**
   * The label of the slider.
   */
  'aria-label': chainPropTypes(PropTypes.string, props => {
    const range = Array.isArray(props.value || props.defaultValue);
    if (range && props['aria-label'] != null) {
      return new Error('MUI: You need to use the `getAriaLabel` prop instead of `aria-label` when using a range slider.');
    }
    return null;
  }),
  /**
   * The id of the element containing a label for the slider.
   */
  'aria-labelledby': PropTypes.string,
  /**
   * A string value that provides a user-friendly name for the current value of the slider.
   */
  'aria-valuetext': chainPropTypes(PropTypes.string, props => {
    const range = Array.isArray(props.value || props.defaultValue);
    if (range && props['aria-valuetext'] != null) {
      return new Error('MUI: You need to use the `getAriaValueText` prop instead of `aria-valuetext` when using a range slider.');
    }
    return null;
  }),
  /**
   * @ignore
   */
  children: PropTypes.node,
  /**
   * Override or extend the styles applied to the component.
   */
  classes: PropTypes.object,
  /**
   * @ignore
   */
  className: PropTypes.string,
  /**
   * The color of the component.
   * It supports both default and custom theme colors, which can be added as shown in the
   * [palette customization guide](https://mui.com/material-ui/customization/palette/#adding-new-colors).
   * @default 'primary'
   */
  color: PropTypes /* @typescript-to-proptypes-ignore */.oneOfType([PropTypes.oneOf(['primary', 'secondary']), PropTypes.string]),
  /**
   * The components used for each slot inside.
   *
   * This prop is an alias for the `slots` prop.
   * It's recommended to use the `slots` prop instead.
   *
   * @default {}
   */
  components: PropTypes.shape({
    Input: PropTypes.elementType,
    Mark: PropTypes.elementType,
    MarkLabel: PropTypes.elementType,
    Rail: PropTypes.elementType,
    Root: PropTypes.elementType,
    Thumb: PropTypes.elementType,
    Track: PropTypes.elementType,
    ValueLabel: PropTypes.elementType
  }),
  /**
   * The extra props for the slot components.
   * You can override the existing props or add new ones.
   *
   * This prop is an alias for the `slotProps` prop.
   * It's recommended to use the `slotProps` prop instead, as `componentsProps` will be deprecated in the future.
   *
   * @default {}
   */
  componentsProps: PropTypes.shape({
    input: PropTypes.oneOfType([PropTypes.func, PropTypes.object]),
    mark: PropTypes.oneOfType([PropTypes.func, PropTypes.object]),
    markLabel: PropTypes.oneOfType([PropTypes.func, PropTypes.object]),
    rail: PropTypes.oneOfType([PropTypes.func, PropTypes.object]),
    root: PropTypes.oneOfType([PropTypes.func, PropTypes.object]),
    thumb: PropTypes.oneOfType([PropTypes.func, PropTypes.object]),
    track: PropTypes.oneOfType([PropTypes.func, PropTypes.object]),
    valueLabel: PropTypes.oneOfType([PropTypes.func, PropTypes.shape({
      children: PropTypes.element,
      className: PropTypes.string,
      open: PropTypes.bool,
      style: PropTypes.object,
      value: PropTypes.number,
      valueLabelDisplay: PropTypes.oneOf(['auto', 'off', 'on'])
    })])
  }),
  /**
   * The default value. Use when the component is not controlled.
   */
  defaultValue: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.number), PropTypes.number]),
  /**
   * If `true`, the component is disabled.
   * @default false
   */
  disabled: PropTypes.bool,
  /**
   * If `true`, the active thumb doesn't swap when moving pointer over a thumb while dragging another thumb.
   * @default false
   */
  disableSwap: PropTypes.bool,
  /**
   * Accepts a function which returns a string value that provides a user-friendly name for the thumb labels of the slider.
   * This is important for screen reader users.
   * @param {number} index The thumb label's index to format.
   * @returns {string}
   */
  getAriaLabel: PropTypes.func,
  /**
   * Accepts a function which returns a string value that provides a user-friendly name for the current value of the slider.
   * This is important for screen reader users.
   * @param {number} value The thumb label's value to format.
   * @param {number} index The thumb label's index to format.
   * @returns {string}
   */
  getAriaValueText: PropTypes.func,
  /**
   * Marks indicate predetermined values to which the user can move the slider.
   * If `true` the marks are spaced according the value of the `step` prop.
   * If an array, it should contain objects with `value` and an optional `label` keys.
   * @default false
   */
  marks: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.shape({
    label: PropTypes.node,
    value: PropTypes.number.isRequired
  })), PropTypes.bool]),
  /**
   * The maximum allowed value of the slider.
   * Should not be equal to min.
   * @default 100
   */
  max: PropTypes.number,
  /**
   * The minimum allowed value of the slider.
   * Should not be equal to max.
   * @default 0
   */
  min: PropTypes.number,
  /**
   * Name attribute of the hidden `input` element.
   */
  name: PropTypes.string,
  /**
   * Callback function that is fired when the slider's value changed.
   *
   * @param {Event} event The event source of the callback.
   * You can pull out the new value by accessing `event.target.value` (any).
   * **Warning**: This is a generic event not a change event.
   * @param {number | number[]} value The new value.
   * @param {number} activeThumb Index of the currently moved thumb.
   */
  onChange: PropTypes.func,
  /**
   * Callback function that is fired when the `mouseup` is triggered.
   *
   * @param {React.SyntheticEvent | Event} event The event source of the callback. **Warning**: This is a generic event not a change event.
   * @param {number | number[]} value The new value.
   */
  onChangeCommitted: PropTypes.func,
  /**
   * The component orientation.
   * @default 'horizontal'
   */
  orientation: PropTypes.oneOf(['horizontal', 'vertical']),
  /**
   * A transformation function, to change the scale of the slider.
   * @param {any} x
   * @returns {any}
   * @default function Identity(x) {
   *   return x;
   * }
   */
  scale: PropTypes.func,
  /**
   * The size of the slider.
   * @default 'medium'
   */
  size: PropTypes /* @typescript-to-proptypes-ignore */.oneOfType([PropTypes.oneOf(['small', 'medium']), PropTypes.string]),
  /**
   * The props used for each slot inside the Slider.
   * @default {}
   */
  slotProps: PropTypes.shape({
    input: PropTypes.oneOfType([PropTypes.func, PropTypes.object]),
    mark: PropTypes.oneOfType([PropTypes.func, PropTypes.object]),
    markLabel: PropTypes.oneOfType([PropTypes.func, PropTypes.object]),
    rail: PropTypes.oneOfType([PropTypes.func, PropTypes.object]),
    root: PropTypes.oneOfType([PropTypes.func, PropTypes.object]),
    thumb: PropTypes.oneOfType([PropTypes.func, PropTypes.object]),
    track: PropTypes.oneOfType([PropTypes.func, PropTypes.object]),
    valueLabel: PropTypes.oneOfType([PropTypes.func, PropTypes.shape({
      children: PropTypes.element,
      className: PropTypes.string,
      open: PropTypes.bool,
      style: PropTypes.object,
      value: PropTypes.number,
      valueLabelDisplay: PropTypes.oneOf(['auto', 'off', 'on'])
    })])
  }),
  /**
   * The components used for each slot inside the Slider.
   * Either a string to use a HTML element or a component.
   * @default {}
   */
  slots: PropTypes.shape({
    input: PropTypes.elementType,
    mark: PropTypes.elementType,
    markLabel: PropTypes.elementType,
    rail: PropTypes.elementType,
    root: PropTypes.elementType,
    thumb: PropTypes.elementType,
    track: PropTypes.elementType,
    valueLabel: PropTypes.elementType
  }),
  /**
   * The granularity with which the slider can step through values. (A "discrete" slider.)
   * The `min` prop serves as the origin for the valid values.
   * We recommend (max - min) to be evenly divisible by the step.
   *
   * When step is `null`, the thumb can only be slid onto marks provided with the `marks` prop.
   * @default 1
   */
  step: PropTypes.number,
  /**
   * The system prop that allows defining system overrides as well as additional CSS styles.
   */
  sx: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.func, PropTypes.object, PropTypes.bool])), PropTypes.func, PropTypes.object]),
  /**
   * Tab index attribute of the hidden `input` element.
   */
  tabIndex: PropTypes.number,
  /**
   * The track presentation:
   *
   * - `normal` the track will render a bar representing the slider value.
   * - `inverted` the track will render a bar representing the remaining slider value.
   * - `false` the track will render without a bar.
   * @default 'normal'
   */
  track: PropTypes.oneOf(['inverted', 'normal', false]),
  /**
   * The value of the slider.
   * For ranged sliders, provide an array with two values.
   */
  value: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.number), PropTypes.number]),
  /**
   * Controls when the value label is displayed:
   *
   * - `auto` the value label will display when the thumb is hovered or focused.
   * - `on` will display persistently.
   * - `off` will never display.
   * @default 'off'
   */
  valueLabelDisplay: PropTypes.oneOf(['auto', 'off', 'on']),
  /**
   * The format function the value label's value.
   *
   * When a function is provided, it should have the following signature:
   *
   * - {number} value The value label's value to format
   * - {number} index The value label's index to format
   * @param {any} x
   * @returns {any}
   * @default function Identity(x) {
   *   return x;
   * }
   */
  valueLabelFormat: PropTypes.oneOfType([PropTypes.func, PropTypes.string])
} : void 0;
var Slider$1 = Slider;

const ToggleKnotsWidget = ({ obj, title, subtitle, listLayers, knotVisibility, viewId, grammarDefinition }) => {
    // Animation ====================================================
    const [initialTime, setInitialTime] = useState(Date.now());
    const [fps, _setFps] = useState(5);
    const fpsRef = useRef(fps);
    // current ranges
    const [range, _setRange] = useState({});
    const rangeRef = useRef(range);
    const setRange = (data) => {
        rangeRef.current = data;
        _setRange(data);
    };
    // persisting listLayers to get inside interval
    const [listLayersState, _setListLayersState] = useState({});
    const listLayersStateRef = useRef(listLayersState);
    const setListLayersState = (data) => {
        listLayersStateRef.current = data;
        _setListLayersState(data);
    };
    useEffect(() => {
        console.log("listLayersState", listLayersState);
        console.log("listLayersStateRef.current", listLayersStateRef.current);
        const intervalId = window.setInterval(function () {
            let div = document.getElementById("toggle_widget_" + viewId);
            if (div == null || Object.keys(listLayersStateRef.current).length == 0)
                return;
            let children = div.childNodes;
            let groupsToAnimate = [];
            for (let i = 0; i < children.length; i++) {
                const child = children[i];
                let inputs = child.querySelectorAll("div input");
                for (let j = 0; j < inputs.length; j++) {
                    let input = inputs[j];
                    if (input.checked && listLayersStateRef.current[input.id].length > 1) {
                        groupsToAnimate.push(input.id);
                    }
                }
            }
            for (const group of groupsToAnimate) {
                let knotsToConsider = [];
                let range = rangeRef.current[group];
                knotsToConsider = listLayersStateRef.current[group].slice(0, range + 1);
                if (knotsToConsider.length == 0) // should not do any animation
                    return;
                let elapsedTime = Date.now() - initialTime;
                let changeEvery = 1000 / fpsRef.current;
                let indexLayer = Math.round((elapsedTime % (changeEvery * (knotsToConsider.length))) / changeEvery);
                if (indexLayer > knotsToConsider.length - 1) {
                    indexLayer = 0;
                }
                let layerToShow = knotsToConsider[indexLayer];
                for (let i = 0; i < listLayersStateRef.current[group].length; i++) {
                    let key = listLayersStateRef.current[group][i];
                    if (key == layerToShow) {
                        obj.toggleKnot(layerToShow, true);
                    }
                    else {
                        obj.toggleKnot(key, false);
                    }
                }
            }
        }, 50);
        return () => {
            window.clearInterval(intervalId);
        };
    }, [listLayersState]);
    useEffect(() => {
        setListLayersState(listLayers);
    }, [listLayers]);
    // =================================================
    const groupVisibility = (groupedList, visibilityList, id) => {
        for (const layer of groupedList[id]) {
            if (visibilityList[layer]) {
                return true;
            }
        }
        return false;
    };
    // if activated uncheck all elements of the group. If not activated activate the first element
    const toggleGroup = (groupedList, visibilityList, id, value = null) => {
        if (value == null) {
            let activated = false;
            for (const layer of groupedList[id]) { // deactivate all activated sub knots
                if (visibilityList[layer]) {
                    obj.toggleKnot(layer, false);
                    activated = true;
                }
            }
            if (!activated) { // activate the first sub knot if no sub knot was activated
                obj.toggleKnot(groupedList[id][0], true);
            }
        }
        else {
            for (let i = 0; i < groupedList[id].length; i++) {
                let layer = groupedList[id][i];
                if (value) {
                    if (i == 0)
                        obj.toggleKnot(layer, true);
                    else
                        obj.toggleKnot(layer, false);
                }
                else {
                    obj.toggleKnot(layer, false);
                }
            }
        }
    };
    const getMarks = (layers) => {
        let marks = [];
        for (let i = 0; i < layers.length; i++) {
            let mark = {
                value: Math.round((i / layers.length) * 100),
                label: '' + i
            };
            marks.push(mark);
        }
        return marks;
    };
    const handleChangeSlides = (e, group, step) => {
        let newObj = {};
        let exists = false;
        for (const key of Object.keys(rangeRef.current)) {
            if (key != group) {
                newObj[key] = rangeRef.current[key];
            }
            else {
                exists = true;
                newObj[key] = Math.round(e.target.value / step);
            }
        }
        if (!exists) {
            newObj[group] = Math.round(e.target.value / step);
        }
        setRange(newObj);
    };
    const [collapsedItems, setCollapsedItems] = useState([]);
    const toggleCollapse = (item) => {
        if (collapsedItems.includes(item)) {
            setCollapsedItems(collapsedItems.filter((id) => id !== item));
        }
        else {
            setCollapsedItems([...collapsedItems, item]);
        }
    };
    const getCategoryHtml = (category, listLayers, knotVisibility) => {
        if (Object.keys(listLayers).length == 0 || knotVisibility.length == 0)
            return;
        return jsxs("li", { children: [jsx("div", { style: { margin: "5px", fontWeight: "bold", cursor: "pointer", color: collapsedItems.includes(category.category_name) ? 'black' : '#009687' }, onClick: () => toggleCollapse(category.category_name), children: category.category_name }, category.category_name + "_span"), jsx("ul", { style: { listStyleType: "none", display: collapsedItems.includes(category.category_name) ? 'none' : 'block' }, children: category.elements.map((element, index) => (typeof element === 'string' ? jsx("li", { children: getGroupHtml(element, listLayers, knotVisibility) }, element + "_li" + "_" + index) : getCategoryHtml(element, listLayers, knotVisibility))) }, category.category_name + "_ul")] }, category.category_name + "_li");
    };
    const getNotInCategoriesHtml = (categories, listLayers, knotVisibility) => {
        if (Object.keys(listLayers).length == 0 || knotVisibility.length == 0)
            return;
        let categorizedKnots = [];
        const getKnotsFromCategory = (category) => {
            let knots = [];
            for (const element of category.elements) {
                if (typeof element === 'string') {
                    knots.push(element);
                }
                else {
                    knots = knots.concat(getKnotsFromCategory(element));
                }
            }
            return knots;
        };
        if (categories != undefined) {
            for (const category of categories) {
                categorizedKnots = categorizedKnots.concat(getKnotsFromCategory(category));
            }
        }
        return Object.keys(listLayers).map((item, index) => (!categorizedKnots.includes(item) ? jsx("li", { children: getGroupHtml(item, listLayers, knotVisibility) }, item + "_li_" + "_non_cat") : jsx("span", {}, item + "_empty")));
    };
    const getGroupHtml = (item, listLayers, knotVisibility) => {
        return jsx(React__default.Fragment, { children: jsxs(Row, { style: { paddingTop: "10px", paddingBottom: "10px", borderBottom: '1px solid #e2e1e6' }, className: "align-items-center", children: [jsx(Col, { md: 5, children: jsx(Form.Check, { checked: groupVisibility(listLayers, knotVisibility, item), type: "checkbox", label: item, id: item, onChange: () => { toggleGroup(listLayers, knotVisibility, item); } }, item + "_check") }), listLayers[item].length > 1 ?
                        jsx(Col, { children: jsx(Row, { style: { padding: 0 }, className: "align-items-center", children: jsx(Col, { md: 12, children: jsx(Slider$1, { defaultValue: 0, valueLabelDisplay: "off", step: Math.round((1 / listLayers[item].length) * 100), marks: getMarks(listLayers[item]), onChange: (e) => { handleChangeSlides(e, item, Math.round((1 / listLayers[item].length) * 100)); }, disabled: !groupVisibility(listLayers, knotVisibility, item) }, item + "_slider") }) }) }) : jsx(Fragment, {})] }) }, item + "_fragment");
    };
    return (jsxs(React__default.Fragment, { children: [title != undefined ? jsx("div", { style: { margin: "4px", height: "11%", display: "flex", alignItems: "center" }, children: jsx("p", { style: { fontWeight: "bold", fontSize: "20px" }, children: title }) }) : jsx(Fragment, {}), subtitle != undefined ? jsx("div", { style: { marginBottom: "4px", height: "5%" }, children: jsx("p", { style: { color: "#bfbec2", fontSize: "16px", fontWeight: "bold" }, children: subtitle }) }) : jsx(Fragment, {}), jsx("div", { style: { overflowY: "auto", overflowX: "clip", height: "73%", padding: "10px" }, id: "toggle_widget_" + viewId, children: jsxs("ul", { style: { listStyleType: "none", padding: 0, margin: 0 }, children: [
                        // Object.keys(listLayers).map((item, index) => (
                        // <React.Fragment key={item+"_fragment"}>
                        //     <Row style={{paddingTop: "10px", paddingBottom: "10px", borderBottom: '1px solid #e2e1e6'}} className="align-items-center">
                        //         <Col>
                        //             <Form.Check key={item+"_check"} checked={groupVisibility(listLayers, knotVisibility, item)} type="checkbox" label={item} id={item} onChange={() => {toggleGroup(listLayers, knotVisibility, item)}}/> 
                        //         </Col>
                        //         {
                        //             listLayers[item].length > 1 ?
                        //             <Col>
                        //                 <Row style={{padding: 0}} className="align-items-center">
                        //                     <Col md={9}>
                        //                         <Slider
                        //                             key={item+"_slider"}
                        //                             defaultValue={0}
                        //                             valueLabelDisplay="off"
                        //                             step={Math.round((1/listLayers[item].length)*100)}
                        //                             marks = {getMarks(listLayers[item])}
                        //                             onChange={(e) => {handleChangeSlides(e, item, Math.round((1/listLayers[item].length)*100))}}
                        //                             disabled = {!groupVisibility(listLayers, knotVisibility, item)}
                        //                         />
                        //                     </Col>
                        //                     <Col md={3} style={{paddingLeft: 0}}>
                        //                         <Form.Control placeholder="FPS" type="text" onChange={(e) => {if(e.target.value != ''){setFps(parseInt(e.target.value))}}}/>
                        //                     </Col>
                        //             </Row></Col> : <></>
                        //         }
                        //     </Row>
                        // </React.Fragment>
                        // ))
                        grammarDefinition.categories != undefined ? grammarDefinition.categories.map((category) => (getCategoryHtml(category, listLayers, knotVisibility))) : jsx(Fragment, {}), getNotInCategoriesHtml(grammarDefinition.categories, listLayers, knotVisibility)] }) })] }));
};

const SearchWidget = ({ obj, inputId, viewId, title, subtitle }) => {
    return (jsxs(React__default.Fragment, { children: [title != undefined ? jsx("p", { children: title }) : jsx(Fragment, {}), subtitle != undefined ? jsx("p", { children: subtitle }) : jsx(Fragment, {}), jsx("input", { type: "text", className: inputId, name: "searchBar", placeholder: 'Search place' })] }));
};

function Views({ viewObjs, viewIds, grammar, mainDivSize }) {
    const [camera, setCamera] = useState({ position: [], direction: { right: [], lookAt: [], up: [] } }); // TODO: if we have multiple map instances we have multiple cameras
    const [filterKnots, setFilterKnots] = useState([]);
    const [systemMessages, setSystemMessages] = useState([]);
    const [genericPlots, setGenericPlots] = useState([]);
    const [knotVisibility, setKnotVisibility] = useState({});
    const [currentPlotId, setCurrentPlotId] = useState(0);
    const [layersIds, setLayersIds] = useState({});
    let inputBarId = "searchBar";
    const nodeRef = useRef(null);
    const addNewMessage = (msg, color) => {
        setSystemMessages([{ text: msg, color: color }]);
    };
    const linkedContainerGenerator = (n, names = []) => {
        let createdIds = [];
        createdIds = addNewGenericPlot(n, names);
        // promise is only resolved when the container is created
        return new Promise(async function (resolve, reject) {
            let checkContainer = async () => {
                let allContainersCreated = true;
                for (const id of createdIds) {
                    if (select("#" + "genericPlotSvg" + id).empty()) {
                        allContainersCreated = false;
                        break;
                    }
                }
                if (!allContainersCreated) { // the container was not create yet or the state still needs to be updated
                    await new Promise(r => setTimeout(r, 100));
                    checkContainer();
                }
            };
            await checkContainer();
            let returnIds = [];
            for (const id of createdIds) {
                returnIds.push("genericPlotSvg" + id);
            }
            resolve(returnIds);
        });
    };
    const addNewGenericPlot = (n = 1, names = []) => {
        let createdIds = [];
        let tempPlots = [];
        let tempId = 0;
        for (let i = 0; i < n; i++) {
            if (names.length > 0 && names[i] != '' && names[i] != undefined) {
                tempPlots.push({ id: tempId, hidden: false, svgId: "genericPlotSvg" + tempId, label: names[i], checked: false, edit: false });
            }
            else {
                tempPlots.push({ id: tempId, hidden: false, svgId: "genericPlotSvg" + tempId, label: "Plot " + tempId, checked: false, edit: false });
            }
            createdIds.push(tempId);
            tempId += 1;
        }
        setGenericPlots(tempPlots);
        setCurrentPlotId(tempId);
        return createdIds;
    };
    /**
     * Summarize callbacks
     */
    const updateStatus = (state, value) => {
        if (state == "camera") {
            setCamera(value);
        }
        else if (state == "filterKnots") {
            setFilterKnots(value);
        }
        else if (state == "systemMessages") {
            setSystemMessages(value);
        }
        else if (state == "genericPlots") {
            setGenericPlots(value);
        }
        else if (state == "layersIds") {
            setLayersIds(value);
        }
        else if (state == "knotVisibility") {
            setKnotVisibility(value);
        }
        else if (state == "containerGenerator") {
            return linkedContainerGenerator(value.n, value.names);
        }
    };
    const getSizes = (position) => {
        let widthPercentage = (position.width[1] + 1 - position.width[0]) / grammar.grid.width;
        let heightPercentage = (position.height[1] + 1 - position.height[0]) / grammar.grid.height;
        let margin = 14;
        return { width: widthPercentage * mainDivSize.width - margin, height: heightPercentage * mainDivSize.height - margin };
    };
    const getTopLeft = (position) => {
        let leftPercentange = (position.width[0] - 1) / grammar.grid.width;
        let topPercentange = (position.height[0] - 1) / grammar.grid.height;
        let margin = 14;
        return { top: topPercentange * mainDivSize.height + (margin / 2), left: leftPercentange * mainDivSize.width + (margin / 2) };
    };
    // Executes after component rendered
    useEffect(() => {
        for (let i = 0; i < viewObjs.length; i++) {
            let viewObj = viewObjs[i].obj;
            let viewId = viewIds[i];
            viewObj.init(viewId, updateStatus);
        }
    }, []);
    return (jsxs(React__default.Fragment, { children: [jsx("div", { style: { backgroundColor: "#EAEAEA", height: "100%", width: "100%" }, children: viewObjs.map((component, index) => {
                    if (component.type == ComponentIdentifier.MAP) {
                        return jsx(React__default.Fragment, { children: jsx("div", { className: 'component', style: { padding: 0, position: "absolute", left: getTopLeft(component.position).left, top: getTopLeft(component.position).top, width: getSizes(component.position).width, height: getSizes(component.position).height }, children: jsx(MapRendererContainer, { obj: component.obj, viewId: viewIds[index] }) }) }, viewIds[index]);
                    }
                    else if (component.type == WidgetType.GRAMMAR) {
                        return jsx(React__default.Fragment, { children: jsx("div", { className: 'component', style: { position: "absolute", left: getTopLeft(component.position).left, top: getTopLeft(component.position).top, width: getSizes(component.position).width, height: getSizes(component.position).height }, children: jsx(GrammarPanelContainer, { obj: component.obj, viewId: viewIds[index], initialGrammar: grammar, camera: camera, filterKnots: filterKnots, inputId: inputBarId, setCamera: setCamera, addNewMessage: addNewMessage, applyGrammarButtonId: "applyGrammarButton", linkMapAndGrammarId: "linkMapAndGrammar" }) }) }, viewIds[index]);
                    }
                    else if (component.type == WidgetType.TOGGLE_KNOT) {
                        return jsx(React__default.Fragment, { children: jsx("div", { className: 'component', style: { position: "absolute", left: getTopLeft(component.position).left, top: getTopLeft(component.position).top, width: getSizes(component.position).width, height: getSizes(component.position).height }, children: jsx(ToggleKnotsWidget, { obj: component.obj, listLayers: layersIds, knotVisibility: knotVisibility, title: component.title, subtitle: component.subtitle, viewId: viewIds[index], grammarDefinition: component.grammarDefinition }) }) }, viewIds[index]);
                    }
                    else if (component.type == WidgetType.RESOLUTION) ;
                    else if (component.type == WidgetType.SEARCH) {
                        return jsx(Draggable$1, { nodeRef: nodeRef, defaultPosition: { x: getTopLeft(component.position).left + 15, y: getTopLeft(component.position).top + 15 }, children: jsx("div", { ref: nodeRef, className: "drag-box", style: { borderRadius: "8px 8px 8px 8px" }, children: jsx(SearchWidget, { obj: component.obj, viewId: viewIds[index], inputId: inputBarId, title: component.title, subtitle: component.subtitle }) }) }, viewIds[index]);
                    }
                }) }), genericPlots.map((item) => (jsx(GenericScreenPlotContainer, { disp: !item.hidden, svgId: item.svgId }, item.id)))] }));
}

var $id$1 = "https://urbantk.org/grammar";
var title = "Grammar";
var description$1 = "A grammar to produce visual analytics systems";
var type$1 = "object";
var properties = {
	components: {
		description: "Stores the components that will visually compose the dashboard",
		type: "array",
		items: {
			type: "object",
			properties: {
				map: {
					type: "object",
					properties: {
						camera: {
							type: "object",
							properties: {
								position: {
									type: "array",
									minItems: 3,
									maxItems: 3,
									items: {
										type: "number"
									}
								},
								direction: {
									type: "object",
									properties: {
										right: {
											type: "array",
											minItems: 3,
											maxItems: 3,
											items: {
												type: "number"
											}
										},
										lookAt: {
											type: "array",
											minItems: 3,
											maxItems: 3,
											items: {
												type: "number"
											}
										},
										up: {
											type: "array",
											minItems: 3,
											maxItems: 3,
											items: {
												type: "number"
											}
										}
									}
								}
							}
						},
						knots: {
							type: "array",
							items: {
								type: "string"
							}
						},
						interactions: {
							type: "array",
							items: {
								type: "string"
							}
						},
						filterKnots: {
							type: "array",
							minItems: 4,
							maxItems: 4,
							items: {
								type: "number"
							}
						},
						knotVisibility: {
							type: "array",
							items: {
								type: "object",
								properties: {
									knot: {
										type: "string"
									},
									test: {
										type: "string"
									}
								},
								required: [
									"knot",
									"test"
								]
							}
						}
					},
					required: [
						"camera",
						"knots",
						"interactions"
					]
				},
				plots: {
					type: "array",
					items: {
						type: "object",
						properties: {
							name: {
								type: "string"
							},
							plot: {
								type: "object",
								additionalProperties: true
							},
							knots: {
								type: "array",
								items: {
									type: "string"
								}
							},
							arrangement: {
								type: "string"
							},
							interaction: {
								type: "string"
							},
							args: {
								type: "object",
								properties: {
									bins: {
										type: "number"
									}
								}
							}
						},
						required: [
							"plot",
							"knots",
							"arrangement"
						]
					}
				},
				knots: {
					type: "array",
					items: {
						type: "object",
						properties: {
							id: {
								type: "string"
							},
							group: {
								type: "object",
								properties: {
									group_name: {
										type: "string"
									},
									position: {
										type: "number"
									}
								},
								required: [
									"group_name",
									"position"
								]
							},
							knotOp: {
								type: "boolean"
							},
							colorMap: {
								type: "string"
							},
							integration_scheme: {
								type: "array",
								items: {
									type: "object",
									properties: {
										spatial_relation: {
											type: "string"
										},
										out: {
											type: "object",
											properties: {
												name: {
													type: "string"
												},
												level: {
													type: "string"
												}
											}
										},
										"in": {
											type: "object",
											properties: {
												name: {
													type: "string"
												},
												level: {
													type: "string"
												}
											}
										},
										operation: {
											type: "string"
										},
										abstract: {
											type: "boolean"
										},
										op: {
											type: "string"
										},
										maxDistance: {
											type: "number"
										},
										defaultValue: {
											type: "number"
										}
									},
									required: [
										"out"
									],
									dependentRequired: {
										"in": [
											"spatial_relation"
										]
									}
								}
							}
						},
						required: [
							"id",
							"integration_scheme"
						]
					}
				},
				position: {
					type: "object",
					properties: {
						width: {
							type: "array",
							minItems: 2,
							maxItems: 2,
							items: {
								type: "integer"
							}
						},
						height: {
							type: "array",
							minItems: 2,
							maxItems: 2,
							items: {
								type: "integer"
							}
						}
					},
					required: [
						"width",
						"height"
					]
				},
				type: {
					type: "string"
				},
				map_id: {
					type: "integer"
				},
				title: {
					type: "string"
				},
				subtitle: {
					type: "string"
				},
				categories: {
					"#ref": "categories"
				}
			},
			required: [
				"position"
			],
			dependentRequired: {
				map: [
					"plots",
					"knots"
				],
				plots: [
					"map",
					"knots"
				],
				knots: [
					"map",
					"plots"
				]
			}
		}
	},
	grid: {
		description: "Defines how the screen should be divided",
		type: "object",
		properties: {
			width: {
				type: "integer"
			},
			height: {
				type: "integer"
			}
		},
		required: [
			"width",
			"height"
		]
	}
};
var required = [
	"grid",
	"components"
];
var schema = {
	$id: $id$1,
	title: title,
	description: description$1,
	type: type$1,
	properties: properties,
	required: required
};

var $id = "https://urbantk.org/categories";
var description = "Categories schema";
var type = "array";
var items = {
	type: "object",
	properties: {
		category_name: {
			type: "string"
		},
		elements: {
			type: "array",
			items: {
				anyOf: [
					{
						type: "string"
					},
					{
						"#ref": "#"
					}
				]
			}
		}
	}
};
var schema_categories = {
	$id: $id,
	description: description,
	type: type,
	items: items
};

/// <reference types="@types/webgl2" />
const Ajv = require("ajv");
class GrammarInterpreter {
    _preProcessedGrammar;
    _processedGrammar;
    _lastValidationTimestep;
    _components = [];
    _frontEndCallback;
    _mainDiv;
    _url;
    _root;
    _ajv;
    _cameraUpdateCallback;
    resetGrammarInterpreter(grammar, mainDiv) {
        // =============================
        this._ajv = new Ajv({ schemas: [schema, schema_categories] });
        // =============================
        this._url = process.env.REACT_APP_BACKEND_SERVICE_URL;
        this._frontEndCallback = null;
        this._mainDiv = mainDiv;
        this.processGrammar(grammar);
    }
    // TODO: it should be possible to create more than one map. So map should not be a singleton
    initViews(mainDiv, grammar) {
        this._components = [];
        for (const component of grammar.components) {
            if ("map" in component) { // It is a map view
                this._components.push({ type: ComponentIdentifier.MAP, obj: MapViewFactory.getInstance(mainDiv, this), position: component.position, title: undefined, subtitle: undefined, grammarDefinition: component });
            }
            else if ("type" in component && component.type == WidgetType.GRAMMAR) { // It is a grammar editor
                this._components.push({ type: WidgetType.GRAMMAR, obj: this, position: component.position, title: component.title, subtitle: component.subtitle, grammarDefinition: component });
            }
        }
        // widgets that depend on maps
        for (const component of grammar.components) {
            if ("type" in component) {
                if (component.type == WidgetType.TOGGLE_KNOT) {
                    this._components.push({ type: WidgetType.TOGGLE_KNOT, obj: this._components[component.map_id].obj, position: component.position, title: component.title, subtitle: component.subtitle, grammarDefinition: component });
                }
                else if (component.type == WidgetType.RESOLUTION) {
                    this._components.push({ type: WidgetType.RESOLUTION, obj: this._components[component.map_id].obj, position: component.position, title: component.title, subtitle: component.subtitle, grammarDefinition: component });
                }
                else if (component.type == WidgetType.SEARCH) {
                    this._components.push({ type: WidgetType.SEARCH, obj: this._components[component.map_id].obj, position: this._components[component.map_id].position, title: component.title, subtitle: component.subtitle, grammarDefinition: component });
                }
            }
        }
        this.renderViews(mainDiv, grammar);
    }
    validateGrammar(grammar) {
        // TODO: checking conflicting types of interactions for the knots. One knot cannot be in plots with different arrangements
        // TODO: ensure that the widgets have all the attributes they should have
        // TODO: check if the knots references in the categories are correct
        // TODO: enforce that if a knot is groupped it can only be referenced by its group name in the categories
        // TODO: one knot cannot be in more than one category at the same time
        // TODO: cannot have two categories with the same name
        const validate = this._ajv.getSchema("https://urbantk.org/grammar");
        const valid = validate(grammar);
        if (!valid) {
            for (const error of validate.errors) {
                alert("Invalid grammar: " + error.message + "at " + error.dataPath);
            }
            return false;
        }
        this._lastValidationTimestep = Date.now();
        for (let componentId = 0; componentId < grammar['components'].length; componentId++) {
            if ("map" in grammar.components[componentId]) { // if it is a map component
                let numFootEmbeddedPlots = 0;
                let numSurEmbeddedPlots = 0;
                let component = grammar.components[componentId];
                for (const plot of component.plots) {
                    if (plot.arrangement == PlotArrangementType.FOOT_EMBEDDED || plot.arrangement == PlotArrangementType.SUR_EMBEDDED) {
                        if (plot.arrangement == PlotArrangementType.FOOT_EMBEDDED) {
                            numFootEmbeddedPlots += 1;
                        }
                        if (plot.arrangement == PlotArrangementType.SUR_EMBEDDED) {
                            numSurEmbeddedPlots += 1;
                        }
                    }
                    if (plot.arrangement == PlotArrangementType.FOOT_EMBEDDED && plot.args == undefined) {
                        throw Error("bins need to be specified when arrangement FOOT_EMBEDDED is used");
                    }
                }
                if (numFootEmbeddedPlots > 1 || numSurEmbeddedPlots > 1) {
                    throw Error("There can only be one embedded plot of each type");
                }
                let allKnotsIds = [];
                for (const knot of component.knots) {
                    if (allKnotsIds.includes(knot.id)) {
                        throw Error("Duplicated knot id");
                    }
                    else {
                        if (knot.knotOp != true)
                            allKnotsIds.push(knot.id);
                    }
                }
                for (const knot of component.knots) {
                    if (knot.knotOp == true) {
                        for (const integration_scheme of knot.integration_scheme) {
                            let operation = integration_scheme.operation;
                            if (operation != OperationType.NONE) {
                                throw Error("All operation for knots with knotOp = true should be NONE");
                            }
                        }
                        for (const scheme of knot.integration_scheme) {
                            if (scheme.in == undefined) {
                                throw Error("in must be defined when knotOp = true");
                            }
                            if (!allKnotsIds.includes(scheme.out.name) || !allKnotsIds.includes(scheme.in.name)) {
                                throw Error("When using knotOp out and in must make reference to the id of other knots (that doesnt have knotOp = true)");
                            }
                            if (scheme.op == undefined) {
                                throw Error("If knotOp = true each step of the integration_scheme must have a defined op");
                            }
                            if ((scheme.maxDistance != undefined || scheme.defaultValue != undefined) && (scheme.spatial_relation != "NEAREST" || scheme.abstract != true)) {
                                throw Error("The maxDistance and defaultValue fields can only be used with the NEAREST spatial_relation in abstract links");
                            }
                            if (scheme.maxDistance != undefined && scheme.defaultValue == undefined) {
                                throw Error("If maxDistance is used defaultValue must be specified");
                            }
                        }
                    }
                }
            }
        }
        return true;
    }
    async processGrammar(grammar) {
        if (this.validateGrammar(grammar)) {
            this._preProcessedGrammar = grammar;
            // this._processedGrammar = this.processConditionBlocks(JSON.parse(JSON.stringify(this._preProcessedGrammar))); // Making a deep copy of the grammar before processing it
            await this.createSpatialJoins(this._url, this._preProcessedGrammar);
            this._processedGrammar = this._preProcessedGrammar;
            this.initViews(this._mainDiv, this._processedGrammar);
        }
    }
    // Called by views
    init(id, updateStatus) {
        return;
    }
    createSpatialJoins = async (url, grammar) => {
        for (const component of grammar.components) {
            if ("map" in component) {
                for (const knot of component.knots) {
                    if (knot.knotOp != true) {
                        for (let i = 0; i < knot.integration_scheme.length; i++) {
                            if (knot.integration_scheme[i].spatial_relation != 'INNERAGG' && knot.integration_scheme[i].in != undefined) {
                                let spatial_relation = knot.integration_scheme[i].spatial_relation.toLowerCase();
                                let out = knot.integration_scheme[i].out.name;
                                let outLevel = knot.integration_scheme[i].out.level.toLowerCase();
                                let inLevel = knot.integration_scheme[i].in.level.toLowerCase();
                                let maxDistance = knot.integration_scheme[i].maxDistance;
                                let defaultValue = knot.integration_scheme[i].defaultValue;
                                let operation = knot.integration_scheme[i].operation.toLowerCase();
                                if (operation == 'none') {
                                    operation = 'avg'; // there must be an operation to solve conflicts in the join
                                }
                                let inData = knot.integration_scheme[i].in.name;
                                let abstract = knot.integration_scheme[i].abstract;
                                // addNewMessage("Joining "+out+" with "+inData, "red");
                                if (maxDistance != undefined) {
                                    await fetch(url + "/linkLayers?spatial_relation=" + spatial_relation + "&out=" + out + "&operation=" + operation + "&in=" + inData + "&abstract=" + abstract + "&outLevel=" + outLevel + "&inLevel=" + inLevel + "&maxDistance=" + maxDistance + "&defaultValue=" + defaultValue);
                                }
                                else {
                                    await fetch(url + "/linkLayers?spatial_relation=" + spatial_relation + "&out=" + out + "&operation=" + operation + "&in=" + inData + "&abstract=" + abstract + "&outLevel=" + outLevel + "&inLevel=" + inLevel).catch(error => {
                                        // Handle any errors here
                                        console.error(error);
                                    });
                                }
                                // addNewMessage("Join finished in " +(elapsed/1000)+" seconds", "green");
                            }
                        }
                    }
                }
            }
        }
    };
    // private processConditionBlocks(grammar: IGrammar){
    //     let _this = this;
    //     const replaceConditionBlocks = (obj: any) => {
    //         const recursiveSearch = (obj: any) => {
    //             if (!obj || typeof obj !== 'object') {return};
    //             Object.keys(obj).forEach(function (k) {
    //                 if(obj && typeof obj === 'object' && obj[k].condition != undefined){ // it is a condition block
    //                     obj[k] = _this.processConditionBlock(obj[k]); // replace the condition block with its evaluation
    //                 }else{
    //                     recursiveSearch(obj[k]);
    //                 }
    //             });
    //         } 
    //         recursiveSearch(obj);
    //     } 
    //     replaceConditionBlocks(grammar);
    //     return grammar;
    // }
    // private processConditionBlock(conditionBlock: IConditionBlock){
    //     let zoom = this._map.camera.getZoomLevel();
    //     let timeElapsed = Date.now() - this._lastValidationTimestep;
    //     for(let i = 0; i < conditionBlock.condition.length; i++){
    //         let conditionElement = conditionBlock.condition[i];
    //         if(conditionElement.test == undefined) // there is no test to evaluate
    //             return conditionElement.value
    //         let testString = conditionElement.test;
    //         testString = testString.replaceAll("zoom", zoom+'');
    //         testString = testString.replaceAll("timeElapsed", timeElapsed+'');
    //         let testResult = eval(testString);
    //         if(testResult == true){
    //             return conditionElement.value;
    //         }
    //     }
    //     throw Error("Condition block does not have a default value");
    // }
    getCamera(view = 0) {
        if ("map" in this._processedGrammar['components'][view]) {
            return this._processedGrammar['components'][view].map.camera;
        }
        else {
            throw new Error("The component is not a map");
        }
    }
    getPlots(view = 0) {
        if ("map" in this._processedGrammar['components'][view]) {
            return this._processedGrammar['components'][view].plots;
        }
        else {
            throw new Error("The component is not a map");
        }
    }
    getKnots(view = 0) {
        if ("map" in this._processedGrammar['components'][view]) {
            return this._processedGrammar['components'][view].knots;
        }
        else {
            throw new Error("The component is not a map");
        }
    }
    getMap(view = 0) {
        if ("map" in this._processedGrammar['components'][view]) {
            return this._processedGrammar['components'][view].map;
        }
        else {
            throw new Error("The component is not a map");
        }
    }
    getFilterKnots(view = 0) {
        if ("map" in this._processedGrammar['components'][view]) {
            return this._processedGrammar['components'][view].map.filterKnots;
        }
        else {
            throw new Error("The component is not a map");
        }
    }
    getProcessedGrammar() {
        return this._processedGrammar;
    }
    evaluateLayerVisibility(layerId, view) {
        if (!("map" in this._processedGrammar['components'])) {
            throw new Error("The component is not a map");
        }
        if (this._processedGrammar['components'][view].map.knotVisibility == undefined)
            return true;
        let map = this._components[view];
        let zoom = map.camera.getZoomLevel();
        let timeElapsed = Date.now() - this._lastValidationTimestep;
        let knotId = ''; // TODO: the layer could appear in more than one Knot. Create knot structure
        for (const knot of this._processedGrammar['components'][view].knots) {
            if (this.getKnotOutputLayer(knot, view) == layerId) {
                knotId = knot.id;
                break;
            }
        }
        for (const visibility of this._processedGrammar['components'][view].map.knotVisibility) {
            if (visibility.knot == knotId) {
                let testString = visibility.test;
                testString = testString.replaceAll("zoom", zoom + '');
                testString = testString.replaceAll("timeElapsed", timeElapsed + '');
                let testResult = eval(testString);
                return testResult;
            }
        }
        return true;
    }
    evaluateKnotVisibility(knot, view) {
        if (!("map" in this._processedGrammar['components'])) {
            throw new Error("The component is not a map");
        }
        if (this._processedGrammar['components'][view].map.knotVisibility == undefined)
            return knot.visible;
        let map = this._components[view].obj;
        let zoom = map.camera.getZoomLevel();
        let timeElapsed = Date.now() - this._lastValidationTimestep;
        for (const visibility of this._processedGrammar['components'][view].map.knotVisibility) {
            if (visibility.knot == knot.id) {
                let testString = visibility.test;
                testString = testString.replaceAll("zoom", zoom + '');
                testString = testString.replaceAll("timeElapsed", timeElapsed + '');
                let testResult = eval(testString);
                return testResult;
            }
        }
        return knot.visible;
    }
    getKnotById(knotId, view) {
        for (let i = 0; i < this.getKnots(view).length; i++) {
            let knot = this.getKnots(view)[i];
            if (knotId == knot.id) {
                return knot;
            }
        }
    }
    getKnotOutputLayer(knot, view) {
        if (knot.knotOp == true) {
            let lastKnotId = knot.integration_scheme[knot.integration_scheme.length - 1].out.name;
            let lastKnot = this.getKnotById(lastKnotId, view);
            if (lastKnot == undefined) {
                throw Error("Could not process knot " + lastKnotId);
            }
            return lastKnot.integration_scheme[lastKnot.integration_scheme.length - 1].out.name;
        }
        else {
            return knot.integration_scheme[knot.integration_scheme.length - 1].out.name;
        }
    }
    getKnotLastLink(knot, view) {
        if (knot.knotOp == true) {
            let lastKnotId = knot.integration_scheme[knot.integration_scheme.length - 1].out.name;
            let lastKnot = this.getKnotById(lastKnotId, view);
            if (lastKnot == undefined) {
                throw Error("Could not process knot " + lastKnotId);
            }
            return lastKnot.integration_scheme[lastKnot.integration_scheme.length - 1];
        }
        else {
            return knot.integration_scheme[knot.integration_scheme.length - 1];
        }
    }
    // /**
    //  * The callback is called everytime some data that can impact the front end changes
    //  */
    // private setFrontEndCallback(frontEndCallback: any){
    //     this._frontEndCallback = frontEndCallback;
    // }
    // /**
    //  * The state of the data in the back end changed. Need to propagate change to the front-end
    //  */
    // private stateChanged(){
    //     let states: any[] = [];
    // }
    // TODO: more than one view should be rendered but inside a single div provided by the front end
    renderViews(mainDiv, grammar) {
        // mainDiv.innerHTML = ""; // empty all content
        if (this._root == undefined) {
            this._root = createRoot(mainDiv);
        }
        else {
            this._root.unmount();
            this._root = createRoot(mainDiv);
        }
        let viewIds = [];
        for (let i = 0; i < this._components.length; i++) {
            viewIds.push(this._components[i].type + i);
        }
        this._root.render(React__default.createElement(Views, { viewObjs: this._components, viewIds: viewIds, grammar: grammar, mainDivSize: { width: mainDiv.offsetWidth, height: mainDiv.offsetHeight } }));
    }
}
var GrammarInterpreterFactory = (function () {
    var instance;
    return {
        getInstance: function () {
            if (instance == null) {
                instance = new GrammarInterpreter();
            }
            return instance;
        }
    };
})();

class Pointset {
    constructor() { }
}

class Polyline {
    constructor() { }
}

export { BuildingsLayer, CameraFactory, ColorMap, ComponentIdentifier, DataApi, DataLoader, Environment, GeoUtils, GrammarInterpreterFactory, InteractionType, KeyEventsFactory, Layer, LayerManager, LayerType, LevelType, LinesLayer, MapStyle, MapViewFactory, MapViewStatu, Mesh, MeshComponent, MouseEventsFactory, OperationType, PlotArrangementType, PlotInteractionType, PointsLayer, Pointset, Polyline, RenderStyle, Shader, ShaderFlatColor, SpatialRelationType, TrianglesLayer, ViewArrangementType, WidgetType };
//# sourceMappingURL=urbantkmap.js.map
